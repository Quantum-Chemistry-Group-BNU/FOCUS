
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Sun Jan 12 11:15:33 2025

GIT_HASH = ab3ee787337c6f54282df185169c09ba74b96954

mpisize = 1 maxthreads = 112

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNSz
maxdets 10 #0 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  1 100 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
alg_a2p 3
alg_b2q 3
ifdist1
ifdistc
ifnccl
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
ciroots = 
maxdets = 10
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
svd_iop = 13
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
maxidx = -1
schedule: isweep, dots, dcut, eps, noise
0 1 100 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 0
alg_a2p = 3
alg_b2q = 3
notrunc = 0
ifoutcore = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
ifdists = 0
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 0
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0
mpisize_debug = 1
debug_gpumem = 0

io::create_scratch scratch=./scratch

gpu_init
rank=0 deviceCount=2
CUDA Runtime version: 11080
CUBLAS version: 111103
nccl init: rank=0 size=1

mem_check: ifgpu=1
rank=0 CPUmem(GB): avail=4.774e+02 total=5.033e+02
min=4.774e+02 max=4.774e+02 diff=0.000e+00
rank=0 GPUmem(GB): avail=6.426e+00 total=3.945e+01
min=6.426e+00 max=6.426e+00 diff=0.000e+00
rank=0 CPUmem(GB): used=1.001e+00 pageheap_free=6.180e-02 change=1.001e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=10 ifortho=1
 iroot=0 <CI[trunc]|CI>=6.112239740347e-01

ctns::init_rbases rdm_svd=1.500e+00 svd_iop=13 thresh_proj=1.000e-10

idx=
idx=
idx=
idx=43 node=
idx=
idx= node=
idx=
idx=
idx=
idx=
idx=18
idx=
idx=
idx= node=( node=17(16 node=16(10
idx=2 node=0(11,0) type=(( node=12(18,0) type=
idx=1719 node= node=14,1,( node=9(05,130) rsupport=,0) type=1 node= rsupport=515)1419, 15,0) type=1 rsupport=11 12 13 14 ( type=15 12
7 node=3 type=0 rsupport=0
idx= (130,0), 14 15  node=(
159 node=( type= node=1210(0 rsupport=70 1 (2,0) type=1 rsupport=12 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
)
 type=1 rsupport=13 14 15 
,0) type=1 rsupport=18 19 5 6 7 8 9 10 11 12 13 14 15 
 2 3 4 16 17 18 19 5 6 7 8 9 10 11 rsupport= 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=01.000e-10
1 node= rsupport=7 8 9 10,(14,0) type= 1 rsupport=10 11 12 node=110 )12  type=13 114 rsupport= 8 9 (ctns::right_projection<Qm,Tm> thresh_proj=15 ,166 
,00ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=)101.000e-10 type=)
13) type=1 rsupport=17 18 19  0)5 type=1 rsupport=6 7 8 9 10 11  41.000e-1012,0) type=1 rsupport=4  16 1714 15  
1.000e-1017 13 14 15 
1 rsupport=3 4 16 17 18 19 5 6  7 8 9 10 11 1112 13 14 6
15 12 13 14 15 
18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj= 
ctns::right_projection<Qm,Tm> thresh_proj= 18 19 5 6 7 8 9 10 11 12 13 14 15 
 type=ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1 rsupport=5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=
1.000e-10
1.000e-10ctns::right_projection<Qm,Tm> thresh_proj=
1.000e-101.000e-10
1.000e-10

ctns::right_projection<Qm,Tm> thresh_proj= 7 8 9 10 11 12 13 14 15 
1.000e-10
1.000e-10ctns::right_projection<Qm,Tm> thresh_proj=
1.000e-10ctns::right_projection<Qm,Tm> thresh_proj=
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

idx=18 node=(1,0) type=1 rsupport=1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

idx=11 node=(8,0) type=1 rsupport=19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
15 

idx=6 node=(13,0) type=1 rsupport=9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,1,10 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
 dim(space,lspace,rspace)= dim(space,lspace,rspace)=10 dim(space,lspace,rspace)=10,101, dim(space,lspace,rspace)=,----- TIMING FOR ctns::right_projection<Qm,Tm>102, : ,1,10104 dimBc= dimBc=2 1-popBc=1.302e-021 1-popBc=, S -----10
 dimBc=1 1-popBc=0.000e+00, SvN= dim(space,lspace,rspace)=10010
0 SvN=0 dim(space,lspace,rspace)=
 dim(space,lspace,rspace)=2.22e-16 SvN=1010 dim(space,lspace,rspace)=10, dim(space,lspace,rspace)=6----- TIMING FOR  dim(space,lspace,rspace)= dim(space,lspace,rspace)=10,107----- TIMING FOR ctns::right_projection<Qm,Tm> dimBc= : 4 1-popBc= dim(space,lspace,rspace)=1.442e-02 S -----0
10, dim(space,lspace,rspace)= dim(space,lspace,rspace)=,10, dim(space,lspace,rspace)=,87,,10410,10, dimBc= dim(space,lspace,rspace)=0.237,,,3 1-popBc=3,10,0
10 dimBc=58 SvN=10496 dimBc=7,6ctns::right_projection<Qm,Tm>9,,,7 1-popBc=,10 dimBc=6 1-popBc=, :  SvN=30.4951.425e-02 dimBc= dimBc=3 1-popBc=
0.7226,0.000e+00----- TIMING FOR 
6,----- TIMING FOR ----- TIMING FOR 10 S ----- dimBc=ctns::right_projection<Qm,Tm>,6 1-popBc= 1-popBc=103
 dimBc=50 dimBc=103 1-popBc= dimBc= dim(space,lspace,rspace)= SvN=01.1403ctns::right_projection<Qm,Tm>2 1-popBc=1.11e-160 dim(space,lspace,rspace)= SvN= : 1.14 SvN=ctns::right_projection<Qm,Tm>610 1-popBc= 1-popBc= SvN=1.11e-16 : 
1.401e-02,7
5.721e-01 : 
0.000e+00 SvN= dimBc= S -----1.467e-02----- TIMING FOR ctns::right_projection<Qm,Tm> :  S -----
 dimBc=4 1-popBc=1.110e-162.22e-16 SvN= SvN=0.692
 SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.454e-022.912e-01 S -----

----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.489e-02 S -----
----- TIMING FOR ctns::right_projection<Qm,Tm> : 7
 1-popBc=0.000e+00 SvN=1.399e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 9.257e-011.424e-02 S -----
0.454
----- TIMING FOR ctns::right_projection<Qm,Tm> : 0.5721.439e-02 S -----
1.396e-02,----- TIMING FOR  S -----ctns::right_projection<Qm,Tm>
 SvN=0.0148 S -----

 : ----- TIMING FOR 1.498e-02ctns::right_projection<Qm,Tm>1.412e-02 S ----- : 10 S -----1.061.490e-02 S -----

,
7 SvN=,
1.14
----- TIMING FOR ctns::right_projection<Qm,Tm> : 91.286e-02 S -----
----- TIMING FOR ctns::right_projection<Qm,Tm> : 9.419e-03 S -----
 dimBc=7 1-popBc=
0 SvN=1.25
----- TIMING FOR ctns::right_projection<Qm,Tm> : ----- TIMING FOR ctns::right_projection<Qm,Tm>10 :  dimBc=7 1-popBc=1.429e-02 S -----
1.483e-02 S -----
0.000e+00 SvN=1.4
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.491e-02 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=2 node=(17,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=3 node=(16,0) type=1 shape=4,3 1-popBc=0.000e+00
 idx=4 node=(15,0) type=1 shape=4,2 1-popBc=1.110e-16
 idx=5 node=(14,0) type=1 shape=6,4 1-popBc=2.220e-16
 idx=6 node=(13,0) type=1 shape=8,6 1-popBc=1.110e-16
 idx=7 node=(12,0) type=1 shape=9,7 1-popBc=0.000e+00
 idx=8 node=(11,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=9 node=(10,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=10 node=(9,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=11 node=(8,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=12 node=(7,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=13 node=(6,0) type=1 shape=10,5 1-popBc=0.000e+00
 idx=14 node=(5,0) type=1 shape=10,4 1-popBc=0.000e+00
 idx=15 node=(4,0) type=1 shape=10,3 1-popBc=1.110e-16
 idx=16 node=(3,0) type=1 shape=10,2 1-popBc=2.220e-16
 idx=17 node=(2,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=18 node=(1,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=19 node=(0,0) type=0 shape=10,1 1-popBc=0.000e+00
maximum bond dimension = 7
----- TIMING FOR ctns::init_rbases : 3.244e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=6.722e-05 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(3,4,4) maxdiff=1.570e-16 deviate=0 TIMING=2.315e-02 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(3,3,4) maxdiff=3.140e-16 deviate=0 TIMING=2.013e-02 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(3,3,4) maxdiff=5.565e-16 deviate=0 TIMING=1.764e-02 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(2,3,4) maxdiff=3.433e-16 deviate=0 TIMING=1.660e-02 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(4,2,4) maxdiff=1.129e-15 deviate=0 TIMING=1.532e-02 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(6,4,4) maxdiff=4.470e-16 deviate=0 TIMING=1.441e-02 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(7,6,4) maxdiff=5.648e-16 deviate=0 TIMING=1.364e-02 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(7,7,4) maxdiff=4.441e-16 deviate=0 TIMING=1.296e-02 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(7,7,4) maxdiff=0.000e+00 deviate=0 TIMING=1.228e-02 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(6,7,4) maxdiff=2.220e-16 deviate=0 TIMING=1.181e-02 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(6,6,4) maxdiff=4.441e-16 deviate=0 TIMING=1.137e-02 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(6,6,4) maxdiff=4.441e-16 deviate=0 TIMING=1.064e-02 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(5,6,4) maxdiff=2.220e-16 deviate=0 TIMING=1.023e-02 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(4,5,4) maxdiff=0.000e+00 deviate=0 TIMING=9.926e-03 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(3,4,4) maxdiff=6.661e-16 deviate=0 TIMING=9.612e-03 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(2,3,4) maxdiff=1.110e-16 deviate=0 TIMING=9.365e-03 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(1,2,4) maxdiff=2.220e-16 deviate=0 TIMING=9.154e-03 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=9.184e-03 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=9.148e-03 S
----- TIMING FOR ctns::init_rsites : 2.472e-01 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x463c5eb0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 0
----- TIMING FOR ctns::init_rwfuns : 2.095e-04 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=7
----- TIMING FOR ctns::rcanon_canonicalize : 3.652e-01 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.377e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=7.064e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=1.115e-15 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.140e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=4.711e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=1.570e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=1.110e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=1.110e-16 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=3.331e-16 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x463c58a8
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x463c58a8
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 3.162e-04 S -----
----- TIMING FOR ctns::rcanon_init : 6.631e-01 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci T(save)=0.0008S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.377e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=7.064e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=1.115e-15 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.140e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=4.711e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=1.570e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=1.110e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=1.110e-16 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=3.331e-16 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x463c2c00
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x463c2c00
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 3.131e-04 S -----
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.001e+00 pageheap_free=6.130e-02 change=2.126e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:1.221e-02MB:1.192e-05GB
 size(int2e) = 305370:2.330e+00MB:2.275e-03GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 1.098e-01 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNSz
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.899e-02 change=2.292e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=1.782e-02MB:1.740e-05GB
fname=./scratch/sweep/cop(19,0) size=1.74e-05GB T[save](info/data/tot)=0.000148,6.9e-05,0.000217 speed=0.0803GB/S disk[used]=1.77e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/rop(19,0) size=1.74e-05GB T[save](info/data/tot)=0.000101,5.83e-05,0.00016 speed=0.109GB/S disk[used]=3.54e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(18,0) size=1.74e-05GB T[save](info/data/tot)=9.67e-05,5.15e-05,0.000148 speed=0.117GB/S disk[used]=5.31e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(17,0) size=1.74e-05GB T[save](info/data/tot)=0.000106,5.58e-05,0.000162 speed=0.108GB/S disk[used]=7.08e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(16,0) size=1.74e-05GB T[save](info/data/tot)=9.71e-05,5.43e-05,0.000151 speed=0.115GB/S disk[used]=8.84e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(15,0) size=1.74e-05GB T[save](info/data/tot)=0.000141,6.2e-05,0.000203 speed=0.0856GB/S disk[used]=0.000106GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(14,0) size=1.74e-05GB T[save](info/data/tot)=9.93e-05,5.7e-05,0.000156 speed=0.111GB/S disk[used]=0.000124GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(13,0) size=1.74e-05GB T[save](info/data/tot)=0.000103,5.54e-05,0.000159 speed=0.11GB/S disk[used]=0.000142GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(12,0) size=1.74e-05GB T[save](info/data/tot)=0.000107,5.59e-05,0.000163 speed=0.107GB/S disk[used]=0.000159GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(11,0) size=1.74e-05GB T[save](info/data/tot)=0.0001,5.51e-05,0.000155 speed=0.112GB/S disk[used]=0.000177GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(10,0) size=1.74e-05GB T[save](info/data/tot)=0.000101,5.43e-05,0.000155 speed=0.112GB/S disk[used]=0.000195GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(9,0) size=1.74e-05GB T[save](info/data/tot)=0.000105,6.09e-05,0.000166 speed=0.105GB/S disk[used]=0.000212GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(8,0) size=1.74e-05GB T[save](info/data/tot)=0.000102,5.85e-05,0.000161 speed=0.108GB/S disk[used]=0.00023GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(7,0) size=1.74e-05GB T[save](info/data/tot)=0.000101,5.42e-05,0.000155 speed=0.112GB/S disk[used]=0.000248GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(6,0) size=1.74e-05GB T[save](info/data/tot)=0.000102,5.61e-05,0.000158 speed=0.11GB/S disk[used]=0.000265GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(5,0) size=1.74e-05GB T[save](info/data/tot)=0.000107,5.23e-05,0.000159 speed=0.109GB/S disk[used]=0.000283GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(4,0) size=1.74e-05GB T[save](info/data/tot)=0.000102,5.46e-05,0.000156 speed=0.111GB/S disk[used]=0.000301GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(3,0) size=1.74e-05GB T[save](info/data/tot)=0.000103,5.83e-05,0.000162 speed=0.108GB/S disk[used]=0.000318GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(2,0) size=1.74e-05GB T[save](info/data/tot)=0.000101,5.35e-05,0.000155 speed=0.112GB/S disk[used]=0.000336GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(1,0) size=1.74e-05GB T[save](info/data/tot)=0.000101,5.58e-05,0.000157 speed=0.111GB/S disk[used]=0.000354GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(0,0) size=1.74e-05GB T[save](info/data/tot)=9.99e-05,5.61e-05,0.000156 speed=0.112GB/S disk[used]=0.000371GB
----- TIMING FOR ctns::oper_init_dotCR : 2.254e-01 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.208,0.00513,0.213

idx=1 coord=(18,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.815e-02 change=1.192e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.727e-02 change=1.775e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.634e-03 S -----
rank=0 GPUmem(GB): used=3.537e-05 (oper)=3.537e-05
rank=0 GPUmem(GB): used=3.541e-05 (oper,site)=3.537e-05,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=3.541e-05 (oper,site,rinter)=3.537e-05,3.725e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 1.040e-03 S size(rtasks)=57 size(Rlst2)=4 T(Rmu/Rlist)=7.029e-04,3.366e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.061e-03 S size(rtasks)=57 size(Rlst)=109 -----
rank=0 GPUmem(GB): used=3.541e-05 avail=6.176e+00 total=6.176e+00 batch[need]=7.309e-06 blksize=4 blksize0=0 batchsize=109
rank=0 GPUmem(GB): used=4.271e-05 (oper,site,rinter,batch)=3.537e-05,3.725e-08,0.000e+00,7.309e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.459e-04,2.242e-02,9.877e-03
----- TIMING FOR renorm : t_inter=7.5e-04 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.3e-02 -----
 renorm[inter] counter=1 t=7.5e-04 per=2.3e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.3e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=7.6e-03 per=2.3e+01 cost=1.2e+02 flops=1.6e+04
 renorm[gemm] counter=1 i=3 t=7.4e-03 per=2.3e+01 cost=1.8e+02 flops=2.4e+04
 renorm[gemm] counter=1 i=4 t=1.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=7.4e-03 per=2.2e+01 cost=5.2e+02 flops=7.1e+04
 renorm[gemm] counter=1 total t=2.2e-02 per=6.8e+01 cost=8.3e+02 flops=3.7e+04
 renorm[red] counter=1 t=9.9e-03 per=3.0e+01 cost=5.2e+02 flops=5.3e+04
----- TIMING FOR renorm_tot : t_inter=7.5e-04 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.3e-02 -----
 renorm_tot[inter] counter=1 t=7.5e-04 per=2.3e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.3e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=7.6e-03 per=2.3e+01 cost=1.2e+02 flops=1.6e+04
 renorm_tot[gemm] counter=1 i=3 t=7.4e-03 per=2.3e+01 cost=1.8e+02 flops=2.4e+04
 renorm_tot[gemm] counter=1 i=4 t=1.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=7.4e-03 per=2.2e+01 cost=5.2e+02 flops=7.1e+04
 renorm_tot[gemm] counter=1 total t=2.2e-02 per=6.8e+01 cost=8.3e+02 flops=3.7e+04
 renorm_tot[red] counter=1 t=9.9e-03 per=3.0e+01 cost=5.2e+02 flops=5.3e+04
qops.to_cpu: size(tot)=75:5.7e-04MB:5.6e-07GB T(to_cpu)=8.6e-05S speed=6.5e-03GB/S
check ||H-H.dagger||=1.256e-15 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.0374 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=5.714e-02 change=1.113e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.715e-02 change=-1.852e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=2.980e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.002e-02 S #####
 T(local oper_env: fetch) = 2.060e-02 S  per = 34.3  per(accum) = 34.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(local oper_env: renrm) = 3.928e-02 S  per = 65.4  per(accum) = 99.8
 T(local oper_env: save ) = 1.415e-04 S  per = 0.236  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.928e-02 S  T(sum) = 3.928e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.340e-05 S  per = 0.0341  per(accum) = 0.0341
 T(local oper_env: qops init                    ) = 4.391e-04 S  per = 1.12  per(accum) = 1.15
 T(local oper_env: symbolic_formulae_renorm     ) = 1.644e-03 S  per = 4.19  per(accum) = 5.34
 T(local oper_env: allocate qops on gpu         ) = 7.724e-05 S  per = 0.197  per(accum) = 5.53
 T(local oper_env: site memcpy cpu2gpu          ) = 2.180e-04 S  per = 0.555  per(accum) = 6.09
 T(local oper_env: rintermediate init           ) = 3.616e-05 S  per = 0.0921  per(accum) = 6.18
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.071e-03 S  per = 2.73  per(accum) = 8.91
 T(local oper_env: rmmtasks init                ) = 6.643e-04 S  per = 1.69  per(accum) = 10.6
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 8.66e-05  per(accum) = 10.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.313e-02 S  per = 84.4  per(accum) = 95
 T(local oper_env: deallocate cpu and gpu memory) = 3.453e-05 S  per = 0.0879  per(accum) = 95
 T(local oper_env: construct opS [ifdists=true] ) = 4.800e-08 S  per = 0.000122  per(accum) = 95
 T(local oper_env: reduction of opS & opH [nccl]) = 4.100e-08 S  per = 0.000104  per(accum) = 95
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.715e-05 S  per = 0.247  per(accum) = 95.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.137e-05 S  per = 0.0544  per(accum) = 95.3
 T(local oper_env: qops_pool join and erase     ) = 1.828e-03 S  per = 4.65  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.890e-07 S  per = 0.00175  per(accum) = 100
##### sweep oper_env: 6.002e-02 S #####
 T(sweep oper_env: fetch) = 2.060e-02 S  per = 34.3  per(accum) = 34.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.3
 T(sweep oper_env: renrm) = 3.928e-02 S  per = 65.4  per(accum) = 99.8
 T(sweep oper_env: save ) = 1.415e-04 S  per = 0.236  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(sweep oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.928e-02 S  T(sum) = 3.928e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.340e-05 S  per = 0.0341  per(accum) = 0.0341
 T(sweep oper_env: qops init                    ) = 4.391e-04 S  per = 1.12  per(accum) = 1.15
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.644e-03 S  per = 4.19  per(accum) = 5.34
 T(sweep oper_env: allocate qops on gpu         ) = 7.724e-05 S  per = 0.197  per(accum) = 5.53
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.180e-04 S  per = 0.555  per(accum) = 6.09
 T(sweep oper_env: rintermediate init           ) = 3.616e-05 S  per = 0.0921  per(accum) = 6.18
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.071e-03 S  per = 2.73  per(accum) = 8.91
 T(sweep oper_env: rmmtasks init                ) = 6.643e-04 S  per = 1.69  per(accum) = 10.6
 T(sweep oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 8.66e-05  per(accum) = 10.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.313e-02 S  per = 84.4  per(accum) = 95
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.453e-05 S  per = 0.0879  per(accum) = 95
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.800e-08 S  per = 0.000122  per(accum) = 95
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.100e-08 S  per = 0.000104  per(accum) = 95
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 9.715e-05 S  per = 0.247  per(accum) = 95.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.137e-05 S  per = 0.0544  per(accum) = 95.3
 T(sweep oper_env: qops_pool join and erase     ) = 1.828e-03 S  per = 4.65  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 6.890e-07 S  per = 0.00175  per(accum) = 100

idx=2 coord=(17,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.073e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.440e-03 S -----
rank=0 GPUmem(GB): used=1.875e-05 (oper)=1.875e-05
rank=0 GPUmem(GB): used=1.880e-05 (oper,site)=1.875e-05,5.215e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:5.684e-03MB:5.551e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.464e-03 S -----
rank=0 GPUmem(GB): used=2.435e-05 (oper,site,rinter)=1.875e-05,5.215e-08,5.551e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.750e-03 S size(rtasks)=77 size(Rlst2)=4 T(Rmu/Rlist)=1.320e-03,4.301e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.781e-03 S size(rtasks)=77 size(Rlst)=163 -----
rank=0 GPUmem(GB): used=2.435e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.579e-05 blksize=4 blksize0=4 batchsize=163
rank=0 GPUmem(GB): used=4.014e-05 (oper,site,rinter,batch)=1.875e-05,5.215e-08,5.551e-06,1.579e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.121e-03,2.258e-02,1.002e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=2 t=7.1e-03 per=1.8e+01 cost=7.4e+02 flops=1.0e+05
 renorm[gemm] counter=2 i=0 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=7.5e-03 per=1.9e+01 cost=4.5e+02 flops=6.1e+04
 renorm[gemm] counter=2 i=3 t=7.5e-03 per=1.9e+01 cost=4.4e+02 flops=5.9e+04
 renorm[gemm] counter=2 i=4 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=6 t=7.6e-03 per=1.9e+01 cost=9.5e+02 flops=1.3e+05
 renorm[gemm] counter=2 total t=2.3e-02 per=5.7e+01 cost=1.8e+03 flops=8.2e+04
 renorm[red] counter=2 t=1.0e-02 per=2.5e+01 cost=7.9e+02 flops=7.9e+04
----- TIMING FOR renorm_tot : t_inter=7.9e-03 t_gemm=4.5e-02 t_reduction=2.0e-02 tot=7.3e-02 -----
 renorm_tot[inter] counter=2 t=7.9e-03 per=1.1e+01 cost=7.4e+02 flops=9.5e+04
 renorm_tot[gemm] counter=2 i=0 t=4.8e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=2.6e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=1.5e-02 per=2.1e+01 cost=5.8e+02 flops=3.8e+04
 renorm_tot[gemm] counter=2 i=3 t=1.5e-02 per=2.1e+01 cost=6.2e+02 flops=4.2e+04
 renorm_tot[gemm] counter=2 i=4 t=2.6e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=5 t=2.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=6 t=1.5e-02 per=2.1e+01 cost=1.5e+03 flops=9.8e+04
 renorm_tot[gemm] counter=2 total t=4.5e-02 per=6.2e+01 cost=2.7e+03 flops=5.9e+04
 renorm_tot[red] counter=2 t=2.0e-02 per=2.7e+01 cost=1.3e+03 flops=6.6e+04
qops.to_cpu: size(tot)=105:8.0e-04MB:7.8e-07GB T(to_cpu)=9.1e-05S speed=8.6e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.0496 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.192e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=9.155e-05 change=-1.110e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.114e-02 S #####
 T(local oper_env: fetch) = 1.023e-02 S  per = 16.7  per(accum) = 16.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(local oper_env: renrm) = 5.078e-02 S  per =   83  per(accum) = 99.8
 T(local oper_env: save ) = 1.363e-04 S  per = 0.223  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.078e-02 S  T(sum) = 5.078e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.992e-06 S  per = 0.0177  per(accum) = 0.0177
 T(local oper_env: qops init                    ) = 4.925e-04 S  per = 0.97  per(accum) = 0.987
 T(local oper_env: symbolic_formulae_renorm     ) = 3.450e-03 S  per = 6.79  per(accum) = 7.78
 T(local oper_env: allocate qops on gpu         ) = 4.783e-05 S  per = 0.0942  per(accum) = 7.87
 T(local oper_env: site memcpy cpu2gpu          ) = 4.681e-04 S  per = 0.922  per(accum) = 8.8
 T(local oper_env: rintermediate init           ) = 2.473e-03 S  per = 4.87  per(accum) = 13.7
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.790e-03 S  per = 3.53  per(accum) = 17.2
 T(local oper_env: rmmtasks init                ) = 9.571e-04 S  per = 1.88  per(accum) = 19.1
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 6.7e-05  per(accum) = 19.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.981e-02 S  per = 78.4  per(accum) = 97.5
 T(local oper_env: deallocate cpu and gpu memory) = 3.104e-05 S  per = 0.0611  per(accum) = 97.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.600e-08 S  per = 9.06e-05  per(accum) = 97.5
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 8.47e-05  per(accum) = 97.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.770e-05 S  per = 0.192  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.603e-05 S  per = 0.0316  per(accum) = 97.8
 T(local oper_env: qops_pool join and erase     ) = 1.141e-03 S  per = 2.25  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.140e-07 S  per = 0.00141  per(accum) = 100
##### sweep oper_env: 1.212e-01 S #####
 T(sweep oper_env: fetch) = 3.083e-02 S  per = 25.4  per(accum) = 25.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(sweep oper_env: renrm) = 9.006e-02 S  per = 74.3  per(accum) = 99.8
 T(sweep oper_env: save ) = 2.778e-04 S  per = 0.229  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.473e+09 S  per = -3.473e+31
 T(sweep oper_env: preprocess                  ) = -3.473e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.006e-02 S  T(sum) = 9.006e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.239e-05 S  per = 0.0249  per(accum) = 0.0249
 T(sweep oper_env: qops init                    ) = 9.316e-04 S  per = 1.03  per(accum) = 1.06
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.094e-03 S  per = 5.66  per(accum) = 6.72
 T(sweep oper_env: allocate qops on gpu         ) = 1.251e-04 S  per = 0.139  per(accum) = 6.85
 T(sweep oper_env: site memcpy cpu2gpu          ) = 6.861e-04 S  per = 0.762  per(accum) = 7.62
 T(sweep oper_env: rintermediate init           ) = 2.510e-03 S  per = 2.79  per(accum) = 10.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.861e-03 S  per = 3.18  per(accum) = 13.6
 T(sweep oper_env: rmmtasks init                ) = 1.621e-03 S  per =  1.8  per(accum) = 15.4
 T(sweep oper_env: qops memset on cpu           ) = 6.800e-08 S  per = 7.55e-05  per(accum) = 15.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.294e-02 S  per =   81  per(accum) = 96.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.557e-05 S  per = 0.0728  per(accum) = 96.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 9.400e-08 S  per = 0.000104  per(accum) = 96.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.400e-08 S  per = 9.33e-05  per(accum) = 96.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.949e-04 S  per = 0.216  per(accum) = 96.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.740e-05 S  per = 0.0415  per(accum) = 96.7
 T(sweep oper_env: qops_pool join and erase     ) = 2.969e-03 S  per =  3.3  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.403e-06 S  per = 0.00156  per(accum) = 100

idx=3 coord=(16,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.181e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 4.763e-03 S -----
rank=0 GPUmem(GB): used=1.927e-05 (oper)=1.927e-05
rank=0 GPUmem(GB): used=1.933e-05 (oper,site)=1.927e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:1.442e-02MB:1.408e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.475e-03 S -----
rank=0 GPUmem(GB): used=3.341e-05 (oper,site,rinter)=1.927e-05,5.960e-08,1.408e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.902e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.487e-03,4.147e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.951e-03 S size(rtasks)=105 size(Rlst)=184 -----
rank=0 GPUmem(GB): used=3.341e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.782e-05 blksize=4 blksize0=4 batchsize=184
rank=0 GPUmem(GB): used=5.123e-05 (oper,site,rinter,batch)=1.927e-05,5.960e-08,1.408e-05,1.782e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.806e-03,2.239e-02,1.002e-02
----- TIMING FOR renorm : t_inter=6.8e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=3 t=6.8e-03 per=1.7e+01 cost=4.8e+03 flops=7.1e+05
 renorm[gemm] counter=3 i=0 t=1.6e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=7.5e-03 per=1.9e+01 cost=4.2e+02 flops=5.6e+04
 renorm[gemm] counter=3 i=3 t=7.5e-03 per=1.9e+01 cost=6.9e+02 flops=9.3e+04
 renorm[gemm] counter=3 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=5 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=6 t=7.5e-03 per=1.9e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=3 total t=2.2e-02 per=5.7e+01 cost=2.5e+03 flops=1.1e+05
 renorm[red] counter=3 t=1.0e-02 per=2.6e+01 cost=9.2e+02 flops=9.1e+04
----- TIMING FOR renorm_tot : t_inter=1.5e-02 t_gemm=6.7e-02 t_reduction=3.0e-02 tot=1.1e-01 -----
 renorm_tot[inter] counter=3 t=1.5e-02 per=1.3e+01 cost=5.5e+03 flops=3.8e+05
 renorm_tot[gemm] counter=3 i=0 t=6.4e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=3.9e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=2.3e-02 per=2.0e+01 cost=1.0e+03 flops=4.4e+04
 renorm_tot[gemm] counter=3 i=3 t=2.2e-02 per=2.0e+01 cost=1.3e+03 flops=5.9e+04
 renorm_tot[gemm] counter=3 i=4 t=4.0e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=5 t=3.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=6 t=2.2e-02 per=2.0e+01 cost=2.8e+03 flops=1.3e+05
 renorm_tot[gemm] counter=3 total t=6.7e-02 per=6.0e+01 cost=5.2e+03 flops=7.7e+04
 renorm_tot[red] counter=3 t=3.0e-02 per=2.7e+01 cost=2.2e+03 flops=7.5e+04
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.2e-04S speed=9.4e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0528 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.526e-05 change=2.896e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.526e-05 change=-1.187e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.400e-02 S #####
 T(local oper_env: fetch) = 1.000e-02 S  per = 15.6  per(accum) = 15.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.6
 T(local oper_env: renrm) = 5.380e-02 S  per = 84.1  per(accum) = 99.7
 T(local oper_env: save ) = 2.019e-04 S  per = 0.315  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.380e-02 S  T(sum) = 5.380e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.811e-06 S  per = 0.0164  per(accum) = 0.0164
 T(local oper_env: qops init                    ) = 5.873e-04 S  per = 1.09  per(accum) = 1.11
 T(local oper_env: symbolic_formulae_renorm     ) = 4.774e-03 S  per = 8.87  per(accum) = 9.98
 T(local oper_env: allocate qops on gpu         ) = 4.584e-05 S  per = 0.0852  per(accum) = 10.1
 T(local oper_env: site memcpy cpu2gpu          ) = 2.292e-03 S  per = 4.26  per(accum) = 14.3
 T(local oper_env: rintermediate init           ) = 2.485e-03 S  per = 4.62  per(accum) = 18.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.966e-03 S  per = 3.65  per(accum) = 22.6
 T(local oper_env: rmmtasks init                ) = 1.138e-03 S  per = 2.11  per(accum) = 24.7
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 6.32e-05  per(accum) = 24.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.931e-02 S  per = 73.1  per(accum) = 97.8
 T(local oper_env: deallocate cpu and gpu memory) = 3.203e-05 S  per = 0.0595  per(accum) = 97.8
 T(local oper_env: construct opS [ifdists=true] ) = 6.400e-08 S  per = 0.000119  per(accum) = 97.8
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 7.99e-05  per(accum) = 97.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.222e-04 S  per = 0.227  per(accum) = 98.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.603e-05 S  per = 0.0298  per(accum) = 98.1
 T(local oper_env: qops_pool join and erase     ) = 1.023e-03 S  per =  1.9  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.360e-07 S  per = 0.00137  per(accum) = 100
##### sweep oper_env: 1.852e-01 S #####
 T(sweep oper_env: fetch) = 4.083e-02 S  per = 22.1  per(accum) = 22.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(sweep oper_env: renrm) = 1.439e-01 S  per = 77.7  per(accum) = 99.7
 T(sweep oper_env: save ) = 4.797e-04 S  per = 0.259  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.210e+09 S  per = -5.210e+31
 T(sweep oper_env: preprocess                  ) = -5.210e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.439e-01 S  T(sum) = 1.439e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.120e-05 S  per = 0.0217  per(accum) = 0.0217
 T(sweep oper_env: qops init                    ) = 1.519e-03 S  per = 1.06  per(accum) = 1.08
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.867e-03 S  per = 6.86  per(accum) = 7.94
 T(sweep oper_env: allocate qops on gpu         ) = 1.709e-04 S  per = 0.119  per(accum) = 8.06
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.978e-03 S  per = 2.07  per(accum) = 10.1
 T(sweep oper_env: rintermediate init           ) = 4.995e-03 S  per = 3.47  per(accum) = 13.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.826e-03 S  per = 3.35  per(accum) = 17
 T(sweep oper_env: rmmtasks init                ) = 2.759e-03 S  per = 1.92  per(accum) = 18.9
 T(sweep oper_env: qops memset on cpu           ) = 1.020e-07 S  per = 7.09e-05  per(accum) = 18.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.123e-01 S  per =   78  per(accum) = 96.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.760e-05 S  per = 0.0678  per(accum) = 97
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.580e-07 S  per = 0.00011  per(accum) = 97
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.270e-07 S  per = 8.83e-05  per(accum) = 97
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.171e-04 S  per = 0.22  per(accum) = 97.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 5.342e-05 S  per = 0.0371  per(accum) = 97.2
 T(sweep oper_env: qops_pool join and erase     ) = 3.992e-03 S  per = 2.78  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.139e-06 S  per = 0.00149  per(accum) = 100

idx=4 coord=(15,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.239e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 6.062e-03 S -----
rank=0 GPUmem(GB): used=1.941e-05 (oper)=1.941e-05
rank=0 GPUmem(GB): used=1.945e-05 (oper,site)=1.941e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:2.237e-02MB:2.185e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.479e-03 S -----
rank=0 GPUmem(GB): used=4.130e-05 (oper,site,rinter)=1.941e-05,4.470e-08,2.185e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.749e-03 S size(rtasks)=141 size(Rlst2)=1 T(Rmu/Rlist)=1.480e-03,2.693e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.770e-03 S size(rtasks)=141 size(Rlst)=77 -----
rank=0 GPUmem(GB): used=4.130e-05 avail=6.176e+00 total=6.176e+00 batch[need]=7.458e-06 blksize=4 blksize0=4 batchsize=77
rank=0 GPUmem(GB): used=4.876e-05 (oper,site,rinter,batch)=1.941e-05,4.470e-08,2.185e-05,7.458e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.888e-03,2.233e-02,9.931e-03
----- TIMING FOR renorm : t_inter=7.9e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=4 t=7.9e-03 per=2.0e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=4 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=7.5e-03 per=1.9e+01 cost=1.6e+02 flops=2.2e+04
 renorm[gemm] counter=4 i=3 t=7.4e-03 per=1.8e+01 cost=5.3e+02 flops=7.2e+04
 renorm[gemm] counter=4 i=4 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=7.4e-03 per=1.9e+01 cost=9.6e+02 flops=1.3e+05
 renorm[gemm] counter=4 total t=2.2e-02 per=5.6e+01 cost=1.7e+03 flops=7.4e+04
 renorm[red] counter=4 t=9.9e-03 per=2.5e+01 cost=6.2e+02 flops=6.2e+04
----- TIMING FOR renorm_tot : t_inter=2.3e-02 t_gemm=9.0e-02 t_reduction=4.0e-02 tot=1.5e-01 -----
 renorm_tot[inter] counter=4 t=2.3e-02 per=1.5e+01 cost=7.0e+03 flops=3.1e+05
 renorm_tot[gemm] counter=4 i=0 t=7.9e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=5.2e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=3.0e-02 per=2.0e+01 cost=1.2e+03 flops=3.9e+04
 renorm_tot[gemm] counter=4 i=3 t=3.0e-02 per=2.0e+01 cost=1.8e+03 flops=6.2e+04
 renorm_tot[gemm] counter=4 i=4 t=5.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=5 t=5.0e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=6 t=3.0e-02 per=2.0e+01 cost=3.8e+03 flops=1.3e+05
 renorm_tot[gemm] counter=4 total t=9.0e-02 per=5.9e+01 cost=6.8e+03 flops=7.6e+04
 renorm_tot[red] counter=4 t=4.0e-02 per=2.6e+01 cost=2.8e+03 flops=7.1e+04
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB T(to_cpu)=1.5e-04S speed=6.2e-03GB/S
check ||H-H.dagger||=9.421e-16 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0531 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.282e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.242e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.421e-02 S #####
 T(local oper_env: fetch) = 9.915e-03 S  per = 15.4  per(accum) = 15.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(local oper_env: renrm) = 5.415e-02 S  per = 84.3  per(accum) = 99.8
 T(local oper_env: save ) = 1.400e-04 S  per = 0.218  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.415e-02 S  T(sum) = 5.415e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.650e-06 S  per = 0.016  per(accum) = 0.016
 T(local oper_env: qops init                    ) = 6.974e-04 S  per = 1.29  per(accum) = 1.3
 T(local oper_env: symbolic_formulae_renorm     ) = 6.074e-03 S  per = 11.2  per(accum) = 12.5
 T(local oper_env: allocate qops on gpu         ) = 4.811e-05 S  per = 0.0888  per(accum) = 12.6
 T(local oper_env: site memcpy cpu2gpu          ) = 1.106e-03 S  per = 2.04  per(accum) = 14.7
 T(local oper_env: rintermediate init           ) = 2.490e-03 S  per =  4.6  per(accum) = 19.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.777e-03 S  per = 3.28  per(accum) = 22.5
 T(local oper_env: rmmtasks init                ) = 4.536e-04 S  per = 0.838  per(accum) = 23.4
 T(local oper_env: qops memset on cpu           ) = 5.200e-08 S  per = 9.6e-05  per(accum) = 23.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.025e-02 S  per = 74.3  per(accum) = 97.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.642e-05 S  per = 0.0488  per(accum) = 97.7
 T(local oper_env: construct opS [ifdists=true] ) = 4.600e-08 S  per = 8.49e-05  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 7.94e-05  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.551e-04 S  per = 0.287  per(accum) = 98
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.547e-05 S  per = 0.0286  per(accum) = 98.1
 T(local oper_env: qops_pool join and erase     ) = 1.052e-03 S  per = 1.94  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.720e-07 S  per = 0.00124  per(accum) = 100
##### sweep oper_env: 2.494e-01 S #####
 T(sweep oper_env: fetch) = 5.075e-02 S  per = 20.3  per(accum) = 20.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.3
 T(sweep oper_env: renrm) = 1.980e-01 S  per = 79.4  per(accum) = 99.8
 T(sweep oper_env: save ) = 6.197e-04 S  per = 0.248  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.947e+09 S  per = -6.947e+31
 T(sweep oper_env: preprocess                  ) = -6.947e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.980e-01 S  T(sum) = 1.980e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.985e-05 S  per = 0.0201  per(accum) = 0.0201
 T(sweep oper_env: qops init                    ) = 2.216e-03 S  per = 1.12  per(accum) = 1.14
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.594e-02 S  per = 8.05  per(accum) = 9.19
 T(sweep oper_env: allocate qops on gpu         ) = 2.190e-04 S  per = 0.111  per(accum) = 9.3
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.085e-03 S  per = 2.06  per(accum) = 11.4
 T(sweep oper_env: rintermediate init           ) = 7.484e-03 S  per = 3.78  per(accum) = 15.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.603e-03 S  per = 3.33  per(accum) = 18.5
 T(sweep oper_env: rmmtasks init                ) = 3.213e-03 S  per = 1.62  per(accum) = 20.1
 T(sweep oper_env: qops memset on cpu           ) = 1.540e-07 S  per = 7.78e-05  per(accum) = 20.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.525e-01 S  per =   77  per(accum) = 97.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.240e-04 S  per = 0.0626  per(accum) = 97.2
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.040e-07 S  per = 0.000103  per(accum) = 97.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.700e-07 S  per = 8.59e-05  per(accum) = 97.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.722e-04 S  per = 0.238  per(accum) = 97.4
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 6.889e-05 S  per = 0.0348  per(accum) = 97.5
 T(sweep oper_env: qops_pool join and erase     ) = 5.045e-03 S  per = 2.55  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.811e-06 S  per = 0.00142  per(accum) = 100

idx=5 coord=(14,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.716e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 7.377e-03 S -----
rank=0 GPUmem(GB): used=2.111e-05 (oper)=2.111e-05
rank=0 GPUmem(GB): used=2.117e-05 (oper,site)=2.111e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:3.120e-02MB:3.047e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.479e-03 S -----
rank=0 GPUmem(GB): used=5.165e-05 (oper,site,rinter)=2.111e-05,5.960e-08,3.047e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.014e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=1.527e-03,4.873e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.053e-03 S size(rtasks)=185 size(Rlst)=209 -----
rank=0 GPUmem(GB): used=5.165e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.024e-05 blksize=4 blksize0=4 batchsize=209
rank=0 GPUmem(GB): used=7.189e-05 (oper,site,rinter,batch)=2.111e-05,5.960e-08,3.047e-05,2.024e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.663e-03,2.235e-02,9.933e-03
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=5 t=6.7e-03 per=1.7e+01 cost=1.7e+04 flops=2.6e+06
 renorm[gemm] counter=5 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=7.5e-03 per=1.9e+01 cost=5.8e+02 flops=7.7e+04
 renorm[gemm] counter=5 i=3 t=7.4e-03 per=1.9e+01 cost=1.5e+03 flops=2.1e+05
 renorm[gemm] counter=5 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=7.4e-03 per=1.9e+01 cost=1.7e+03 flops=2.3e+05
 renorm[gemm] counter=5 total t=2.2e-02 per=5.7e+01 cost=3.8e+03 flops=1.7e+05
 renorm[red] counter=5 t=9.9e-03 per=2.6e+01 cost=8.5e+02 flops=8.6e+04
----- TIMING FOR renorm_tot : t_inter=2.9e-02 t_gemm=1.1e-01 t_reduction=5.0e-02 tot=1.9e-01 -----
 renorm_tot[inter] counter=5 t=2.9e-02 per=1.5e+01 cost=2.4e+04 flops=8.3e+05
 renorm_tot[gemm] counter=5 i=0 t=9.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=6.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=3.7e-02 per=2.0e+01 cost=1.7e+03 flops=4.6e+04
 renorm_tot[gemm] counter=5 i=3 t=3.7e-02 per=2.0e+01 cost=3.4e+03 flops=9.1e+04
 renorm_tot[gemm] counter=5 i=4 t=6.6e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=5 t=6.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=6 t=3.7e-02 per=2.0e+01 cost=5.5e+03 flops=1.5e+05
 renorm_tot[gemm] counter=5 total t=1.1e-01 per=5.9e+01 cost=1.1e+04 flops=9.5e+04
 renorm_tot[red] counter=5 t=5.0e-02 per=2.6e+01 cost=3.7e+03 flops=7.4e+04
qops.to_cpu: size(tot)=374:2.9e-03MB:2.8e-06GB T(to_cpu)=1.9e-04S speed=1.5e-02GB/S
check ||H-H.dagger||=3.140e-16 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0552 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=4.465e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.364e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.632e-02 S #####
 T(local oper_env: fetch) = 9.918e-03 S  per =   15  per(accum) = 15
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: renrm) = 5.627e-02 S  per = 84.8  per(accum) = 99.8
 T(local oper_env: save ) = 1.390e-04 S  per = 0.21  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.627e-02 S  T(sum) = 5.627e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.783e-06 S  per = 0.0156  per(accum) = 0.0156
 T(local oper_env: qops init                    ) = 1.039e-03 S  per = 1.85  per(accum) = 1.86
 T(local oper_env: symbolic_formulae_renorm     ) = 7.390e-03 S  per = 13.1  per(accum) = 15
 T(local oper_env: allocate qops on gpu         ) = 4.714e-05 S  per = 0.0838  per(accum) = 15.1
 T(local oper_env: site memcpy cpu2gpu          ) = 1.539e-03 S  per = 2.74  per(accum) = 17.8
 T(local oper_env: rintermediate init           ) = 2.490e-03 S  per = 4.43  per(accum) = 22.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.064e-03 S  per = 3.67  per(accum) = 25.9
 T(local oper_env: rmmtasks init                ) = 1.304e-03 S  per = 2.32  per(accum) = 28.2
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 6.04e-05  per(accum) = 28.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.904e-02 S  per = 69.4  per(accum) = 97.6
 T(local oper_env: deallocate cpu and gpu memory) = 3.020e-05 S  per = 0.0537  per(accum) = 97.7
 T(local oper_env: construct opS [ifdists=true] ) = 4.700e-08 S  per = 8.35e-05  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 4.900e-08 S  per = 8.71e-05  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.973e-04 S  per = 0.351  per(accum) = 98
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.149e-05 S  per = 0.0382  per(accum) = 98.1
 T(local oper_env: qops_pool join and erase     ) = 1.090e-03 S  per = 1.94  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.800e-07 S  per = 0.00121  per(accum) = 100
##### sweep oper_env: 3.157e-01 S #####
 T(sweep oper_env: fetch) = 6.067e-02 S  per = 19.2  per(accum) = 19.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: renrm) = 2.543e-01 S  per = 80.5  per(accum) = 99.8
 T(sweep oper_env: save ) = 7.587e-04 S  per = 0.24  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.683e+09 S  per = -8.683e+31
 T(sweep oper_env: preprocess                  ) = -8.683e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.543e-01 S  T(sum) = 2.543e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.864e-05 S  per = 0.0191  per(accum) = 0.0191
 T(sweep oper_env: qops init                    ) = 3.255e-03 S  per = 1.28  per(accum) = 1.3
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.333e-02 S  per = 9.18  per(accum) = 10.5
 T(sweep oper_env: allocate qops on gpu         ) = 2.662e-04 S  per = 0.105  per(accum) = 10.6
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.624e-03 S  per = 2.21  per(accum) = 12.8
 T(sweep oper_env: rintermediate init           ) = 9.975e-03 S  per = 3.92  per(accum) = 16.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.667e-03 S  per = 3.41  per(accum) = 20.1
 T(sweep oper_env: rmmtasks init                ) = 4.517e-03 S  per = 1.78  per(accum) = 21.9
 T(sweep oper_env: qops memset on cpu           ) = 1.880e-07 S  per = 7.39e-05  per(accum) = 21.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.915e-01 S  per = 75.3  per(accum) = 97.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.542e-04 S  per = 0.0607  per(accum) = 97.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.510e-07 S  per = 9.87e-05  per(accum) = 97.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.190e-07 S  per = 8.61e-05  per(accum) = 97.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.695e-04 S  per = 0.263  per(accum) = 97.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 9.038e-05 S  per = 0.0355  per(accum) = 97.6
 T(sweep oper_env: qops_pool join and erase     ) = 6.135e-03 S  per = 2.41  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.491e-06 S  per = 0.00137  per(accum) = 100

idx=6 coord=(13,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.983e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 8.936e-03 S -----
rank=0 GPUmem(GB): used=2.794e-05 (oper)=2.794e-05
rank=0 GPUmem(GB): used=2.806e-05 (oper,site)=2.794e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:4.051e-02MB:3.956e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.551e-03 S -----
rank=0 GPUmem(GB): used=6.762e-05 (oper,site,rinter)=2.794e-05,1.192e-07,3.956e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.463e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=1.557e-03,9.059e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.591e-03 S size(rtasks)=237 size(Rlst)=529 -----
rank=0 GPUmem(GB): used=6.762e-05 avail=6.176e+00 total=6.176e+00 batch[need]=5.124e-05 blksize=4 blksize0=4 batchsize=529
rank=0 GPUmem(GB): used=1.189e-04 (oper,site,rinter,batch)=2.794e-05,1.192e-07,3.956e-05,5.124e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.680e-03,2.268e-02,9.936e-03
----- TIMING FOR renorm : t_inter=5.7e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=6 t=5.7e-03 per=1.5e+01 cost=2.5e+04 flops=4.5e+06
 renorm[gemm] counter=6 i=0 t=1.4e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=7.6e-03 per=2.0e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=6 i=3 t=7.6e-03 per=2.0e+01 cost=3.5e+03 flops=4.6e+05
 renorm[gemm] counter=6 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=7.5e-03 per=2.0e+01 cost=6.4e+03 flops=8.5e+05
 renorm[gemm] counter=6 total t=2.3e-02 per=5.9e+01 cost=1.1e+04 flops=5.0e+05
 renorm[red] counter=6 t=9.9e-03 per=2.6e+01 cost=4.2e+03 flops=4.3e+05
----- TIMING FOR renorm_tot : t_inter=3.5e-02 t_gemm=1.3e-01 t_reduction=6.0e-02 tot=2.3e-01 -----
 renorm_tot[inter] counter=6 t=3.5e-02 per=1.5e+01 cost=5.0e+04 flops=1.4e+06
 renorm_tot[gemm] counter=6 i=0 t=1.1e-05 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=7.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=4.5e-02 per=2.0e+01 cost=3.1e+03 flops=6.9e+04
 renorm_tot[gemm] counter=6 i=3 t=4.5e-02 per=2.0e+01 cost=6.9e+03 flops=1.5e+05
 renorm_tot[gemm] counter=6 i=4 t=7.9e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=5 t=7.4e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=6 t=4.5e-02 per=2.0e+01 cost=1.2e+04 flops=2.7e+05
 renorm_tot[gemm] counter=6 total t=1.3e-01 per=5.9e+01 cost=2.2e+04 flops=1.6e+05
 renorm_tot[red] counter=6 t=6.0e-02 per=2.6e+01 cost=7.9e+03 flops=1.3e+05
qops.to_cpu: size(tot)=1040:7.9e-03MB:7.7e-06GB T(to_cpu)=2.4e-04S speed=3.2e-02GB/S
check ||H-H.dagger||=1.570e-16 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0599 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=6.034e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=6.409e-04 change=-1.563e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 7.122e-02 S #####
 T(local oper_env: fetch) = 9.926e-03 S  per = 13.9  per(accum) = 13.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(local oper_env: renrm) = 6.115e-02 S  per = 85.9  per(accum) = 99.8
 T(local oper_env: save ) = 1.452e-04 S  per = 0.204  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.115e-02 S  T(sum) = 6.115e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.654e-06 S  per = 0.0142  per(accum) = 0.0142
 T(local oper_env: qops init                    ) = 1.280e-03 S  per = 2.09  per(accum) = 2.11
 T(local oper_env: symbolic_formulae_renorm     ) = 8.950e-03 S  per = 14.6  per(accum) = 16.7
 T(local oper_env: allocate qops on gpu         ) = 6.587e-05 S  per = 0.108  per(accum) = 16.9
 T(local oper_env: site memcpy cpu2gpu          ) = 1.832e-03 S  per =    3  per(accum) = 19.8
 T(local oper_env: rintermediate init           ) = 2.563e-03 S  per = 4.19  per(accum) = 24
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.613e-03 S  per = 4.27  per(accum) = 28.3
 T(local oper_env: rmmtasks init                ) = 3.863e-03 S  per = 6.32  per(accum) = 34.6
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 5.4e-05  per(accum) = 34.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.839e-02 S  per = 62.8  per(accum) = 97.4
 T(local oper_env: deallocate cpu and gpu memory) = 4.243e-05 S  per = 0.0694  per(accum) = 97.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.700e-08 S  per = 7.69e-05  per(accum) = 97.5
 T(local oper_env: reduction of opS & opH [nccl]) = 4.200e-08 S  per = 6.87e-05  per(accum) = 97.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.466e-04 S  per = 0.403  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.752e-05 S  per = 0.0286  per(accum) = 97.9
 T(local oper_env: qops_pool join and erase     ) = 1.272e-03 S  per = 2.08  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.170e-07 S  per = 0.00117  per(accum) = 100
##### sweep oper_env: 3.869e-01 S #####
 T(sweep oper_env: fetch) = 7.059e-02 S  per = 18.2  per(accum) = 18.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(sweep oper_env: renrm) = 3.154e-01 S  per = 81.5  per(accum) = 99.8
 T(sweep oper_env: save ) = 9.039e-04 S  per = 0.234  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.042e+10 S  per = -1.042e+32
 T(sweep oper_env: preprocess                  ) = -1.042e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.154e-01 S  T(sum) = 3.154e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 5.729e-05 S  per = 0.0182  per(accum) = 0.0182
 T(sweep oper_env: qops init                    ) = 4.535e-03 S  per = 1.44  per(accum) = 1.46
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.228e-02 S  per = 10.2  per(accum) = 11.7
 T(sweep oper_env: allocate qops on gpu         ) = 3.320e-04 S  per = 0.105  per(accum) = 11.8
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.456e-03 S  per = 2.36  per(accum) = 14.2
 T(sweep oper_env: rintermediate init           ) = 1.254e-02 S  per = 3.97  per(accum) = 18.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.128e-02 S  per = 3.58  per(accum) = 21.7
 T(sweep oper_env: rmmtasks init                ) = 8.380e-03 S  per = 2.66  per(accum) = 24.4
 T(sweep oper_env: qops memset on cpu           ) = 2.210e-07 S  per = 7.01e-05  per(accum) = 24.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.299e-01 S  per = 72.9  per(accum) = 97.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.966e-04 S  per = 0.0623  per(accum) = 97.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.980e-07 S  per = 9.45e-05  per(accum) = 97.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.610e-07 S  per = 8.27e-05  per(accum) = 97.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 9.161e-04 S  per = 0.29  per(accum) = 97.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.079e-04 S  per = 0.0342  per(accum) = 97.7
 T(sweep oper_env: qops_pool join and erase     ) = 7.407e-03 S  per = 2.35  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 4.208e-06 S  per = 0.00133  per(accum) = 100

idx=7 coord=(12,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.029e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 1.039e-02 S -----
rank=0 GPUmem(GB): used=3.875e-05 (oper)=3.875e-05
rank=0 GPUmem(GB): used=3.893e-05 (oper,site)=3.875e-05,1.788e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:4.988e-02MB:4.871e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.563e-03 S -----
rank=0 GPUmem(GB): used=8.764e-05 (oper,site,rinter)=3.875e-05,1.788e-07,4.871e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.711e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=1.657e-03,1.055e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.793e-03 S size(rtasks)=297 size(Rlst)=610 -----
rank=0 GPUmem(GB): used=8.764e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.045e-04 blksize=9 blksize0=4 batchsize=610
rank=0 GPUmem(GB): used=1.922e-04 (oper,site,rinter,batch)=3.875e-05,1.788e-07,4.871e-05,1.045e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.509e-03,2.279e-02,1.006e-02
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=7 t=5.5e-03 per=1.4e+01 cost=3.9e+04 flops=7.0e+06
 renorm[gemm] counter=7 i=0 t=1.5e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=7.5e-03 per=2.0e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=7 i=3 t=7.6e-03 per=2.0e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=7 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=7.7e-03 per=2.0e+01 cost=1.4e+04 flops=1.8e+06
 renorm[gemm] counter=7 total t=2.3e-02 per=5.9e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=7 t=1.0e-02 per=2.6e+01 cost=7.0e+03 flops=7.0e+05
----- TIMING FOR renorm_tot : t_inter=4.0e-02 t_gemm=1.6e-01 t_reduction=7.0e-02 tot=2.7e-01 -----
 renorm_tot[inter] counter=7 t=4.0e-02 per=1.5e+01 cost=8.8e+04 flops=2.2e+06
 renorm_tot[gemm] counter=7 i=0 t=1.2e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=9.2e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=5.3e-02 per=2.0e+01 cost=5.5e+03 flops=1.1e+05
 renorm_tot[gemm] counter=7 i=3 t=5.2e-02 per=2.0e+01 cost=1.5e+04 flops=2.9e+05
 renorm_tot[gemm] counter=7 i=4 t=9.2e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=5 t=8.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=6 t=5.2e-02 per=2.0e+01 cost=2.6e+04 flops=4.9e+05
 renorm_tot[gemm] counter=7 total t=1.6e-01 per=5.9e+01 cost=4.6e+04 flops=3.0e+05
 renorm_tot[red] counter=7 t=7.0e-02 per=2.6e+01 cost=1.5e+04 flops=2.1e+05
qops.to_cpu: size(tot)=1825:1.4e-02MB:1.4e-05GB T(to_cpu)=3.0e-04S speed=4.5e-02GB/S
check ||H-H.dagger||=6.280e-16 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0618 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.468e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.373e-04 change=-1.732e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 7.319e-02 S #####
 T(local oper_env: fetch) = 9.979e-03 S  per = 13.6  per(accum) = 13.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.6
 T(local oper_env: renrm) = 6.306e-02 S  per = 86.2  per(accum) = 99.8
 T(local oper_env: save ) = 1.476e-04 S  per = 0.202  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.306e-02 S  T(sum) = 6.306e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.610e-06 S  per = 0.0137  per(accum) = 0.0137
 T(local oper_env: qops init                    ) = 1.573e-03 S  per = 2.49  per(accum) = 2.51
 T(local oper_env: symbolic_formulae_renorm     ) = 1.040e-02 S  per = 16.5  per(accum) = 19
 T(local oper_env: allocate qops on gpu         ) = 5.119e-05 S  per = 0.0812  per(accum) = 19.1
 T(local oper_env: site memcpy cpu2gpu          ) = 1.778e-03 S  per = 2.82  per(accum) = 21.9
 T(local oper_env: rintermediate init           ) = 2.576e-03 S  per = 4.09  per(accum) = 26
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.817e-03 S  per = 4.47  per(accum) = 30.5
 T(local oper_env: rmmtasks init                ) = 3.812e-03 S  per = 6.04  per(accum) = 36.5
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 5.23e-05  per(accum) = 36.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.845e-02 S  per =   61  per(accum) = 97.5
 T(local oper_env: deallocate cpu and gpu memory) = 4.385e-05 S  per = 0.0695  per(accum) = 97.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.800e-08 S  per = 7.61e-05  per(accum) = 97.5
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 6.82e-05  per(accum) = 97.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.120e-04 S  per = 0.495  per(accum) = 98
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.799e-05 S  per = 0.0285  per(accum) = 98.1
 T(local oper_env: qops_pool join and erase     ) = 1.215e-03 S  per = 1.93  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.300e-07 S  per = 0.00116  per(accum) = 100
##### sweep oper_env: 4.601e-01 S #####
 T(sweep oper_env: fetch) = 8.057e-02 S  per = 17.5  per(accum) = 17.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(sweep oper_env: renrm) = 3.785e-01 S  per = 82.3  per(accum) = 99.8
 T(sweep oper_env: save ) = 1.051e-03 S  per = 0.229  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.216e+10 S  per = -1.216e+32
 T(sweep oper_env: preprocess                  ) = -1.216e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.785e-01 S  T(sum) = 3.785e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.590e-05 S  per = 0.0174  per(accum) = 0.0174
 T(sweep oper_env: qops init                    ) = 6.107e-03 S  per = 1.61  per(accum) = 1.63
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.268e-02 S  per = 11.3  per(accum) = 12.9
 T(sweep oper_env: allocate qops on gpu         ) = 3.832e-04 S  per = 0.101  per(accum) = 13
 T(sweep oper_env: site memcpy cpu2gpu          ) = 9.235e-03 S  per = 2.44  per(accum) = 15.4
 T(sweep oper_env: rintermediate init           ) = 1.511e-02 S  per = 3.99  per(accum) = 19.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.410e-02 S  per = 3.72  per(accum) = 23.2
 T(sweep oper_env: rmmtasks init                ) = 1.219e-02 S  per = 3.22  per(accum) = 26.4
 T(sweep oper_env: qops memset on cpu           ) = 2.540e-07 S  per = 6.71e-05  per(accum) = 26.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.684e-01 S  per = 70.9  per(accum) = 97.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.405e-04 S  per = 0.0635  per(accum) = 97.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.460e-07 S  per = 9.14e-05  per(accum) = 97.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.040e-07 S  per = 8.03e-05  per(accum) = 97.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.228e-03 S  per = 0.324  per(accum) = 97.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.259e-04 S  per = 0.0333  per(accum) = 97.7
 T(sweep oper_env: qops_pool join and erase     ) = 8.622e-03 S  per = 2.28  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 4.938e-06 S  per = 0.0013  per(accum) = 100

idx=8 coord=(11,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.064e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.176e-02 S -----
rank=0 GPUmem(GB): used=5.096e-05 (oper)=5.096e-05
rank=0 GPUmem(GB): used=5.119e-05 (oper,site)=5.096e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:5.890e-02MB:5.752e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.102e-03 S -----
rank=0 GPUmem(GB): used=1.087e-04 (oper,site,rinter)=5.096e-05,2.235e-07,5.752e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.855e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=1.745e-03,1.110e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.949e-03 S size(rtasks)=365 size(Rlst)=703 -----
rank=0 GPUmem(GB): used=1.087e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.200e-04 blksize=16 blksize0=9 batchsize=703
rank=0 GPUmem(GB): used=3.287e-04 (oper,site,rinter,batch)=5.096e-05,2.235e-07,5.752e-05,2.200e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.071e-03,2.275e-02,9.976e-03
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=8 t=7.1e-03 per=1.8e+01 cost=5.3e+04 flops=7.5e+06
 renorm[gemm] counter=8 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=7.6e-03 per=1.9e+01 cost=2.8e+03 flops=3.6e+05
 renorm[gemm] counter=8 i=3 t=7.6e-03 per=1.9e+01 cost=1.5e+04 flops=1.9e+06
 renorm[gemm] counter=8 i=4 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=7.5e-03 per=1.9e+01 cost=2.4e+04 flops=3.2e+06
 renorm[gemm] counter=8 total t=2.3e-02 per=5.7e+01 cost=4.2e+04 flops=1.8e+06
 renorm[red] counter=8 t=1.0e-02 per=2.5e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=4.7e-02 t_gemm=1.8e-01 t_reduction=8.0e-02 tot=3.1e-01 -----
 renorm_tot[inter] counter=8 t=4.7e-02 per=1.5e+01 cost=1.4e+05 flops=3.0e+06
 renorm_tot[gemm] counter=8 i=0 t=1.4e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=1.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=6.0e-02 per=2.0e+01 cost=8.3e+03 flops=1.4e+05
 renorm_tot[gemm] counter=8 i=3 t=6.0e-02 per=2.0e+01 cost=3.0e+04 flops=4.9e+05
 renorm_tot[gemm] counter=8 i=4 t=1.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=5 t=9.9e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=6 t=6.0e-02 per=2.0e+01 cost=5.0e+04 flops=8.4e+05
 renorm_tot[gemm] counter=8 total t=1.8e-01 per=5.9e+01 cost=8.8e+04 flops=4.9e+05
 renorm_tot[red] counter=8 t=8.0e-02 per=2.6e+01 cost=2.5e+04 flops=3.1e+05
qops.to_cpu: size(tot)=2679:2.0e-02MB:2.0e-05GB T(to_cpu)=3.7e-04S speed=5.3e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0654 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.204e-04 change=-1.835e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 7.681e-02 S #####
 T(local oper_env: fetch) = 9.977e-03 S  per =   13  per(accum) = 13
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: renrm) = 6.668e-02 S  per = 86.8  per(accum) = 99.8
 T(local oper_env: save ) = 1.555e-04 S  per = 0.202  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.668e-02 S  T(sum) = 6.668e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.664e-06 S  per = 0.013  per(accum) = 0.013
 T(local oper_env: qops init                    ) = 1.902e-03 S  per = 2.85  per(accum) = 2.87
 T(local oper_env: symbolic_formulae_renorm     ) = 1.177e-02 S  per = 17.7  per(accum) = 20.5
 T(local oper_env: allocate qops on gpu         ) = 5.186e-05 S  per = 0.0778  per(accum) = 20.6
 T(local oper_env: site memcpy cpu2gpu          ) = 2.123e-03 S  per = 3.18  per(accum) = 23.8
 T(local oper_env: rintermediate init           ) = 2.116e-03 S  per = 3.17  per(accum) = 27
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.976e-03 S  per = 4.46  per(accum) = 31.4
 T(local oper_env: rmmtasks init                ) = 4.118e-03 S  per = 6.18  per(accum) = 37.6
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 4.95e-05  per(accum) = 37.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.989e-02 S  per = 59.8  per(accum) = 97.4
 T(local oper_env: deallocate cpu and gpu memory) = 4.697e-05 S  per = 0.0704  per(accum) = 97.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.600e-08 S  per = 6.9e-05  per(accum) = 97.5
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 6.45e-05  per(accum) = 97.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.821e-04 S  per = 0.573  per(accum) = 98.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.906e-05 S  per = 0.0286  per(accum) = 98.1
 T(local oper_env: qops_pool join and erase     ) = 1.272e-03 S  per = 1.91  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.050e-07 S  per = 0.00106  per(accum) = 100
##### sweep oper_env: 5.369e-01 S #####
 T(sweep oper_env: fetch) = 9.055e-02 S  per = 16.9  per(accum) = 16.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: renrm) = 4.452e-01 S  per = 82.9  per(accum) = 99.8
 T(sweep oper_env: save ) = 1.207e-03 S  per = 0.225  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.389e+10 S  per = -1.389e+32
 T(sweep oper_env: preprocess                  ) = -1.389e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.452e-01 S  T(sum) = 4.452e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.457e-05 S  per = 0.0167  per(accum) = 0.0167
 T(sweep oper_env: qops init                    ) = 8.009e-03 S  per =  1.8  per(accum) = 1.82
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.445e-02 S  per = 12.2  per(accum) = 14
 T(sweep oper_env: allocate qops on gpu         ) = 4.351e-04 S  per = 0.0977  per(accum) = 14.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.136e-02 S  per = 2.55  per(accum) = 16.7
 T(sweep oper_env: rintermediate init           ) = 1.723e-02 S  per = 3.87  per(accum) = 20.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.707e-02 S  per = 3.84  per(accum) = 24.4
 T(sweep oper_env: rmmtasks init                ) = 1.631e-02 S  per = 3.66  per(accum) = 28.1
 T(sweep oper_env: qops memset on cpu           ) = 2.870e-07 S  per = 6.45e-05  per(accum) = 28.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.083e-01 S  per = 69.3  per(accum) = 97.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.875e-04 S  per = 0.0646  per(accum) = 97.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.920e-07 S  per = 8.81e-05  per(accum) = 97.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.470e-07 S  per = 7.79e-05  per(accum) = 97.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.610e-03 S  per = 0.362  per(accum) = 97.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.449e-04 S  per = 0.0326  per(accum) = 97.8
 T(sweep oper_env: qops_pool join and erase     ) = 9.894e-03 S  per = 2.22  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.643e-06 S  per = 0.00127  per(accum) = 100

idx=9 coord=(10,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:20 S:20 A:190 B:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 A:0 B:95.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.103e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=441 : 2.089e-02 S -----
rank=0 GPUmem(GB): used=6.159e-05 (oper)=6.159e-05
rank=0 GPUmem(GB): used=6.185e-05 (oper,site)=6.159e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:6.715e-02MB:6.558e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.597e-03 S -----
rank=0 GPUmem(GB): used=1.274e-04 (oper,site,rinter)=6.159e-05,2.608e-07,6.558e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.805e-03 S size(rtasks)=441 size(Rlst2)=9 T(Rmu/Rlist)=3.913e-03,2.892e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.032e-03 S size(rtasks)=441 size(Rlst)=965 -----
rank=0 GPUmem(GB): used=1.274e-04 avail=6.176e+00 total=6.176e+00 batch[need]=3.523e-04 blksize=16 blksize0=16 batchsize=965
rank=0 GPUmem(GB): used=4.797e-04 (oper,site,rinter,batch)=6.159e-05,2.608e-07,6.558e-05,3.523e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.460e-03,2.251e-02,9.974e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=9 t=6.5e-03 per=1.7e+01 cost=1.9e+05 flops=2.9e+07
 renorm[gemm] counter=9 i=0 t=2.9e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=2.4e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=7.4e-03 per=1.9e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=9 i=3 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.8e+06
 renorm[gemm] counter=9 i=4 t=2.1e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=5 t=2.0e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=6 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=9 total t=2.3e-02 per=5.8e+01 cost=5.9e+04 flops=2.6e+06
 renorm[red] counter=9 t=1.0e-02 per=2.6e+01 cost=8.9e+03 flops=8.9e+05
----- TIMING FOR renorm_tot : t_inter=5.4e-02 t_gemm=2.0e-01 t_reduction=9.0e-02 tot=3.5e-01 -----
 renorm_tot[inter] counter=9 t=5.4e-02 per=1.6e+01 cost=3.3e+05 flops=6.1e+06
 renorm_tot[gemm] counter=9 i=0 t=1.7e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=1.3e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=6.8e-02 per=2.0e+01 cost=1.1e+04 flops=1.6e+05
 renorm_tot[gemm] counter=9 i=3 t=6.8e-02 per=2.0e+01 cost=5.8e+04 flops=8.6e+05
 renorm_tot[gemm] counter=9 i=4 t=1.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=5 t=1.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=6 t=6.8e-02 per=1.9e+01 cost=7.8e+04 flops=1.2e+06
 renorm_tot[gemm] counter=9 total t=2.0e-01 per=5.9e+01 cost=1.5e+05 flops=7.3e+05
 renorm_tot[red] counter=9 t=9.0e-02 per=2.6e+01 cost=3.4e+04 flops=3.8e+05
----- TIMING FOR oper_renorm : 8.4e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.927e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.198e-03 change=-2.057e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.198e-03 change=2.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.198e-03 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=1 ifkr=0 maxsize=3110:2.317e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3110:2.373e-02MB:2.317e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.0016 tinit=0.0016
   copy opB to qops_tmps: dt=0.00254 tcopy=0.00254
   bcast: size(opB)=3110:2.32e-05GB dt=6.8e-08 speed=341GB/s tcomm=6.8e-08
   compute opQ from opB: dt=0.00756 tcomp=0.00756
iproc=0
 qops_tmp: oplist=N nops=N:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3110:0.0237MB:2.32e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.00139 tinit=0.00299
   from opB to opB.H(): dt=0.00808 tadjt=0.00808
   bcast: size(opN)=3110:2.32e-05GB dt=6.4e-08 speed=362GB/s tcomm=1.32e-07
   compute opQ from opB.H(): dt=0.00752 tcomp=0.0151
----- TIMING FOR oper_b2qGPU : 0.0292 S T(init/copy/adjt+bcast/comp/rest)=0.00299,0.00254,0.00808,0.0151,0.000554 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.091e-03 change=2.071e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.091e-03 change=2.480e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.091e-03 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 before move
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.091e-03 change=-2.289e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=2.422e-05 avail=6.176e+00 after move
check ||H-H.dagger||=0.000e+00 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0344 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00367,7.76e-05,1.08e-05,0.0292,0,0.000842,0.00056 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.091e-03 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 1.313e-01 S #####
 T(local oper_env: fetch) = 9.963e-03 S  per = 7.59  per(accum) = 7.59
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 7.59
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 7.59
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 7.59
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 7.59
 T(local oper_env: renrm) = 1.210e-01 S  per = 92.2  per(accum) = 99.8
 T(local oper_env: save ) = 2.704e-04 S  per = 0.206  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.210e-01 S  T(sum) = 1.210e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.697e-06 S  per = 0.00719  per(accum) = 0.00719
 T(local oper_env: qops init                    ) = 2.291e-03 S  per = 1.89  per(accum) = 1.9
 T(local oper_env: symbolic_formulae_renorm     ) = 2.092e-02 S  per = 17.3  per(accum) = 19.2
 T(local oper_env: allocate qops on gpu         ) = 1.365e-04 S  per = 0.113  per(accum) = 19.3
 T(local oper_env: site memcpy cpu2gpu          ) = 7.957e-04 S  per = 0.658  per(accum) = 20
 T(local oper_env: rintermediate init           ) = 2.628e-03 S  per = 2.17  per(accum) = 22.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.098e-03 S  per = 5.87  per(accum) = 28
 T(local oper_env: rmmtasks init                ) = 1.052e-02 S  per = 8.69  per(accum) = 36.7
 T(local oper_env: qops memset on cpu           ) = 1.150e-07 S  per = 9.5e-05  per(accum) = 36.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.909e-02 S  per = 32.3  per(accum) = 69
 T(local oper_env: deallocate cpu and gpu memory) = 1.312e-04 S  per = 0.108  per(accum) = 69.1
 T(local oper_env: construct opS [ifdists=true] ) = 1.410e-07 S  per = 0.000117  per(accum) = 69.1
 T(local oper_env: reduction of opS & opH [nccl]) = 6.600e-08 S  per = 5.45e-05  per(accum) = 69.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.800e-08 S  per = 3.97e-05  per(accum) = 69.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.220e-07 S  per = 0.000101  per(accum) = 69.1
 T(local oper_env: qops_pool join and erase     ) = 2.876e-03 S  per = 2.38  per(accum) = 71.5
 T(local oper_env: conversion from opAB to opPQ ) = 3.452e-02 S  per = 28.5  per(accum) = 100
##### sweep oper_env: 6.682e-01 S #####
 T(sweep oper_env: fetch) = 1.005e-01 S  per =   15  per(accum) = 15
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15
 T(sweep oper_env: renrm) = 5.662e-01 S  per = 84.7  per(accum) = 99.8
 T(sweep oper_env: save ) = 1.477e-03 S  per = 0.221  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.563e+10 S  per = -1.563e+32
 T(sweep oper_env: preprocess                  ) = -1.563e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.662e-01 S  T(sum) = 5.662e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 8.326e-05 S  per = 0.0147  per(accum) = 0.0147
 T(sweep oper_env: qops init                    ) = 1.030e-02 S  per = 1.82  per(accum) = 1.83
 T(sweep oper_env: symbolic_formulae_renorm     ) = 7.538e-02 S  per = 13.3  per(accum) = 15.1
 T(sweep oper_env: allocate qops on gpu         ) = 5.715e-04 S  per = 0.101  per(accum) = 15.2
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.215e-02 S  per = 2.15  per(accum) = 17.4
 T(sweep oper_env: rintermediate init           ) = 1.986e-02 S  per = 3.51  per(accum) = 20.9
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.417e-02 S  per = 4.27  per(accum) = 25.2
 T(sweep oper_env: rmmtasks init                ) = 2.683e-02 S  per = 4.74  per(accum) = 29.9
 T(sweep oper_env: qops memset on cpu           ) = 4.020e-07 S  per = 7.1e-05  per(accum) = 29.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.474e-01 S  per = 61.4  per(accum) = 91.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.187e-04 S  per = 0.0739  per(accum) = 91.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 5.330e-07 S  per = 9.41e-05  per(accum) = 91.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.130e-07 S  per = 7.29e-05  per(accum) = 91.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.610e-03 S  per = 0.284  per(accum) = 91.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.451e-04 S  per = 0.0256  per(accum) = 91.6
 T(sweep oper_env: qops_pool join and erase     ) = 1.277e-02 S  per = 2.26  per(accum) = 93.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per =  6.1  per(accum) = 100

idx=10 coord=(9,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.064e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 3.131e-02 S -----
rank=0 GPUmem(GB): used=5.548e-05 (oper)=5.548e-05
rank=0 GPUmem(GB): used=5.572e-05 (oper,site)=5.548e-05,2.310e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.506e-03 S -----
rank=0 GPUmem(GB): used=1.174e-04 (oper,site,rinter)=5.548e-05,2.310e-07,6.169e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 9.463e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=5.406e-03,4.057e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.707e-03 S size(rtasks)=365 size(Rlst)=2015 -----
rank=0 GPUmem(GB): used=1.174e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.354e-04 blksize=12 blksize0=4 batchsize=2015
rank=0 GPUmem(GB): used=5.528e-04 (oper,site,rinter,batch)=5.548e-05,2.310e-07,6.169e-05,4.354e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.767e-03,2.271e-02,9.995e-03
----- TIMING FOR renorm : t_inter=6.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=10 t=6.8e-03 per=1.7e+01 cost=4.5e+04 flops=6.7e+06
 renorm[gemm] counter=10 i=0 t=1.6e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=7.6e-03 per=1.9e+01 cost=4.8e+03 flops=6.3e+05
 renorm[gemm] counter=10 i=3 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=10 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=5 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=6 t=7.5e-03 per=1.9e+01 cost=4.3e+04 flops=5.7e+06
 renorm[gemm] counter=10 total t=2.3e-02 per=5.8e+01 cost=7.6e+04 flops=3.4e+06
 renorm[red] counter=10 t=1.0e-02 per=2.5e+01 cost=1.5e+04 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=6.1e-02 t_gemm=2.3e-01 t_reduction=1.0e-01 tot=3.9e-01 -----
 renorm_tot[inter] counter=10 t=6.1e-02 per=1.6e+01 cost=3.7e+05 flops=6.1e+06
 renorm_tot[gemm] counter=10 i=0 t=1.8e-05 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.4e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=7.5e-02 per=2.0e+01 cost=1.6e+04 flops=2.1e+05
 renorm_tot[gemm] counter=10 i=3 t=7.5e-02 per=1.9e+01 cost=8.6e+04 flops=1.2e+06
 renorm_tot[gemm] counter=10 i=4 t=1.4e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=5 t=1.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=6 t=7.5e-02 per=1.9e+01 cost=1.2e+05 flops=1.6e+06
 renorm_tot[gemm] counter=10 total t=2.3e-01 per=5.8e+01 cost=2.2e+05 flops=9.9e+05
 renorm_tot[red] counter=10 t=1.0e-01 per=2.6e+01 cost=4.9e+04 flops=4.9e+05
qops.to_cpu: size(tot)=1860:1.4e-02MB:1.4e-05GB T(to_cpu)=5.1e-04S speed=2.7e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.102 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.387e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.549e-03 change=-2.481e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 1.192e-01 S #####
 T(local oper_env: fetch) = 1.347e-02 S  per = 11.3  per(accum) = 11.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: renrm) = 1.055e-01 S  per = 88.5  per(accum) = 99.8
 T(local oper_env: save ) = 1.829e-04 S  per = 0.153  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.055e-01 S  T(sum) = 1.055e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.079e-05 S  per = 0.0102  per(accum) = 0.0102
 T(local oper_env: qops init                    ) = 2.502e-03 S  per = 2.37  per(accum) = 2.38
 T(local oper_env: symbolic_formulae_renorm     ) = 3.132e-02 S  per = 29.7  per(accum) = 32.1
 T(local oper_env: allocate qops on gpu         ) = 5.891e-05 S  per = 0.0558  per(accum) = 32.1
 T(local oper_env: site memcpy cpu2gpu          ) = 1.175e-03 S  per = 1.11  per(accum) = 33.2
 T(local oper_env: rintermediate init           ) = 2.522e-03 S  per = 2.39  per(accum) = 35.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 9.785e-03 S  per = 9.27  per(accum) = 44.9
 T(local oper_env: rmmtasks init                ) = 1.412e-02 S  per = 13.4  per(accum) = 58.3
 T(local oper_env: qops memset on cpu           ) = 5.800e-08 S  per = 5.5e-05  per(accum) = 58.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.958e-02 S  per = 37.5  per(accum) = 95.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.646e-04 S  per = 0.156  per(accum) = 95.9
 T(local oper_env: construct opS [ifdists=true] ) = 4.700e-08 S  per = 4.45e-05  per(accum) = 95.9
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 4.07e-05  per(accum) = 95.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.239e-04 S  per = 0.496  per(accum) = 96.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.534e-05 S  per = 0.024  per(accum) = 96.5
 T(local oper_env: qops_pool join and erase     ) = 3.741e-03 S  per = 3.54  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 1.173e-06 S  per = 0.00111  per(accum) = 100
##### sweep oper_env: 7.874e-01 S #####
 T(sweep oper_env: fetch) = 1.140e-01 S  per = 14.5  per(accum) = 14.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: renrm) = 6.717e-01 S  per = 85.3  per(accum) = 99.8
 T(sweep oper_env: save ) = 1.660e-03 S  per = 0.211  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+10 S  per = -1.737e+32
 T(sweep oper_env: preprocess                  ) = -1.737e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.717e-01 S  T(sum) = 6.717e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.405e-05 S  per = 0.014  per(accum) = 0.014
 T(sweep oper_env: qops init                    ) = 1.280e-02 S  per = 1.91  per(accum) = 1.92
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.067e-01 S  per = 15.9  per(accum) = 17.8
 T(sweep oper_env: allocate qops on gpu         ) = 6.304e-04 S  per = 0.0939  per(accum) = 17.9
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.333e-02 S  per = 1.98  per(accum) = 19.9
 T(sweep oper_env: rintermediate init           ) = 2.238e-02 S  per = 3.33  per(accum) = 23.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.396e-02 S  per = 5.06  per(accum) = 28.3
 T(sweep oper_env: rmmtasks init                ) = 4.095e-02 S  per =  6.1  per(accum) = 34.4
 T(sweep oper_env: qops memset on cpu           ) = 4.600e-07 S  per = 6.85e-05  per(accum) = 34.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.870e-01 S  per = 57.6  per(accum) = 92
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.832e-04 S  per = 0.0868  per(accum) = 92.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 5.800e-07 S  per = 8.63e-05  per(accum) = 92.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.560e-07 S  per = 6.79e-05  per(accum) = 92.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.134e-03 S  per = 0.318  per(accum) = 92.4
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.704e-04 S  per = 0.0254  per(accum) = 92.4
 T(sweep oper_env: qops_pool join and erase     ) = 1.651e-02 S  per = 2.46  per(accum) = 94.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 5.14  per(accum) = 100

idx=11 coord=(8,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.029e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.124e-02 S -----
rank=0 GPUmem(GB): used=4.248e-05 (oper)=4.248e-05
rank=0 GPUmem(GB): used=4.262e-05 (oper,site)=4.248e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.496e-03 S -----
rank=0 GPUmem(GB): used=9.704e-05 (oper,site,rinter)=4.248e-05,1.416e-07,5.442e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.094e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=3.685e-03,2.410e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.415e-03 S size(rtasks)=297 size(Rlst)=1452 -----
rank=0 GPUmem(GB): used=9.704e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.380e-04 blksize=9 blksize0=3 batchsize=1452
rank=0 GPUmem(GB): used=3.350e-04 (oper,site,rinter,batch)=4.248e-05,1.416e-07,5.442e-05,2.380e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.249e-03,2.296e-02,1.007e-02
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=11 t=7.2e-03 per=1.8e+01 cost=2.5e+04 flops=3.4e+06
 renorm[gemm] counter=11 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=7.7e-03 per=1.9e+01 cost=3.3e+03 flops=4.4e+05
 renorm[gemm] counter=11 i=3 t=7.6e-03 per=1.9e+01 cost=1.2e+04 flops=1.5e+06
 renorm[gemm] counter=11 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=5 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=6 t=7.7e-03 per=1.9e+01 cost=2.9e+04 flops=3.8e+06
 renorm[gemm] counter=11 total t=2.3e-02 per=5.7e+01 cost=4.4e+04 flops=1.9e+06
 renorm[red] counter=11 t=1.0e-02 per=2.5e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=6.8e-02 t_gemm=2.5e-01 t_reduction=1.1e-01 tot=4.3e-01 -----
 renorm_tot[inter] counter=11 t=6.8e-02 per=1.6e+01 cost=4.0e+05 flops=5.8e+06
 renorm_tot[gemm] counter=11 i=0 t=2.0e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.6e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=8.3e-02 per=1.9e+01 cost=1.9e+04 flops=2.3e+05
 renorm_tot[gemm] counter=11 i=3 t=8.3e-02 per=1.9e+01 cost=9.8e+04 flops=1.2e+06
 renorm_tot[gemm] counter=11 i=4 t=1.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=5 t=1.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=6 t=8.3e-02 per=1.9e+01 cost=1.5e+05 flops=1.8e+06
 renorm_tot[gemm] counter=11 total t=2.5e-01 per=5.8e+01 cost=2.7e+05 flops=1.1e+06
 renorm_tot[red] counter=11 t=1.1e-01 per=2.6e+01 cost=6.5e+04 flops=5.9e+05
qops.to_cpu: size(tot)=1506:1.1e-02MB:1.1e-05GB T(to_cpu)=2.9e-04S speed=3.8e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0825 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.126e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.404e-03 change=-2.178e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 9.604e-02 S #####
 T(local oper_env: fetch) = 1.156e-02 S  per =   12  per(accum) = 12
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12
 T(local oper_env: renrm) = 8.433e-02 S  per = 87.8  per(accum) = 99.8
 T(local oper_env: save ) = 1.498e-04 S  per = 0.156  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.433e-02 S  T(sum) = 8.433e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.014e-05 S  per = 0.012  per(accum) = 0.012
 T(local oper_env: qops init                    ) = 1.861e-03 S  per = 2.21  per(accum) = 2.22
 T(local oper_env: symbolic_formulae_renorm     ) = 2.125e-02 S  per = 25.2  per(accum) = 27.4
 T(local oper_env: allocate qops on gpu         ) = 5.941e-05 S  per = 0.0705  per(accum) = 27.5
 T(local oper_env: site memcpy cpu2gpu          ) = 6.503e-04 S  per = 0.771  per(accum) = 28.3
 T(local oper_env: rintermediate init           ) = 2.512e-03 S  per = 2.98  per(accum) = 31.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.470e-03 S  per = 7.67  per(accum) = 38.9
 T(local oper_env: rmmtasks init                ) = 8.883e-03 S  per = 10.5  per(accum) = 49.4
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 3.91e-05  per(accum) = 49.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.038e-02 S  per = 47.9  per(accum) = 97.3
 T(local oper_env: deallocate cpu and gpu memory) = 8.126e-05 S  per = 0.0964  per(accum) = 97.4
 T(local oper_env: construct opS [ifdists=true] ) = 6.500e-08 S  per = 7.71e-05  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 3.79e-05  per(accum) = 97.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.024e-04 S  per = 0.359  per(accum) = 97.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.886e-05 S  per = 0.0224  per(accum) = 97.8
 T(local oper_env: qops_pool join and erase     ) = 1.847e-03 S  per = 2.19  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.970e-07 S  per = 0.000945  per(accum) = 100
##### sweep oper_env: 8.834e-01 S #####
 T(sweep oper_env: fetch) = 1.255e-01 S  per = 14.2  per(accum) = 14.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: renrm) = 7.561e-01 S  per = 85.6  per(accum) = 99.8
 T(sweep oper_env: save ) = 1.810e-03 S  per = 0.205  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.910e+10 S  per = -1.910e+32
 T(sweep oper_env: preprocess                  ) = -1.910e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.561e-01 S  T(sum) = 7.561e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.042e-04 S  per = 0.0138  per(accum) = 0.0138
 T(sweep oper_env: qops init                    ) = 1.466e-02 S  per = 1.94  per(accum) = 1.95
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.280e-01 S  per = 16.9  per(accum) = 18.9
 T(sweep oper_env: allocate qops on gpu         ) = 6.898e-04 S  per = 0.0912  per(accum) = 19
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.398e-02 S  per = 1.85  per(accum) = 20.8
 T(sweep oper_env: rintermediate init           ) = 2.489e-02 S  per = 3.29  per(accum) = 24.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.043e-02 S  per = 5.35  per(accum) = 29.5
 T(sweep oper_env: rmmtasks init                ) = 4.983e-02 S  per = 6.59  per(accum) = 36
 T(sweep oper_env: qops memset on cpu           ) = 4.930e-07 S  per = 6.52e-05  per(accum) = 36
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.273e-01 S  per = 56.5  per(accum) = 92.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.645e-04 S  per = 0.0879  per(accum) = 92.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.450e-07 S  per = 8.53e-05  per(accum) = 92.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.880e-07 S  per = 6.45e-05  per(accum) = 92.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.437e-03 S  per = 0.322  per(accum) = 93
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.893e-04 S  per = 0.025  per(accum) = 93
 T(sweep oper_env: qops_pool join and erase     ) = 1.836e-02 S  per = 2.43  per(accum) = 95.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 4.57  per(accum) = 100

idx=12 coord=(7,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.983e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 1.769e-02 S -----
rank=0 GPUmem(GB): used=3.751e-05 (oper)=3.751e-05
rank=0 GPUmem(GB): used=3.765e-05 (oper,site)=3.751e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.496e-03 S -----
rank=0 GPUmem(GB): used=8.396e-05 (oper,site,rinter)=3.751e-05,1.416e-07,4.631e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 4.585e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=2.836e-03,1.749e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.793e-03 S size(rtasks)=237 size(Rlst)=1164 -----
rank=0 GPUmem(GB): used=8.396e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.908e-04 blksize=9 blksize0=3 batchsize=1164
rank=0 GPUmem(GB): used=2.748e-04 (oper,site,rinter,batch)=3.751e-05,1.416e-07,4.631e-05,1.908e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.051e-03,2.294e-02,1.012e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=12 t=7.1e-03 per=1.8e+01 cost=2.1e+04 flops=3.0e+06
 renorm[gemm] counter=12 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=7.7e-03 per=1.9e+01 cost=2.8e+03 flops=3.6e+05
 renorm[gemm] counter=12 i=3 t=7.6e-03 per=1.9e+01 cost=9.2e+03 flops=1.2e+06
 renorm[gemm] counter=12 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=6 t=7.6e-03 per=1.9e+01 cost=2.3e+04 flops=3.0e+06
 renorm[gemm] counter=12 total t=2.3e-02 per=5.7e+01 cost=3.5e+04 flops=1.5e+06
 renorm[red] counter=12 t=1.0e-02 per=2.5e+01 cost=1.3e+04 flops=1.3e+06
----- TIMING FOR renorm_tot : t_inter=7.5e-02 t_gemm=2.7e-01 t_reduction=1.2e-01 tot=4.7e-01 -----
 renorm_tot[inter] counter=12 t=7.5e-02 per=1.6e+01 cost=4.2e+05 flops=5.6e+06
 renorm_tot[gemm] counter=12 i=0 t=2.1e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.7e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=9.1e-02 per=1.9e+01 cost=2.2e+04 flops=2.4e+05
 renorm_tot[gemm] counter=12 i=3 t=9.0e-02 per=1.9e+01 cost=1.1e+05 flops=1.2e+06
 renorm_tot[gemm] counter=12 i=4 t=1.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=5 t=1.6e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=6 t=9.0e-02 per=1.9e+01 cost=1.7e+05 flops=1.9e+06
 renorm_tot[gemm] counter=12 total t=2.7e-01 per=5.8e+01 cost=3.0e+05 flops=1.1e+06
 renorm_tot[red] counter=12 t=1.2e-01 per=2.6e+01 cost=7.8e+04 flops=6.5e+05
qops.to_cpu: size(tot)=1192:9.1e-03MB:8.9e-06GB T(to_cpu)=2.4e-04S speed=3.8e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0756 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.137e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=4.883e-04 change=-1.930e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 8.729e-02 S #####
 T(local oper_env: fetch) = 1.027e-02 S  per = 11.8  per(accum) = 11.8
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.8
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.8
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.8
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.8
 T(local oper_env: renrm) = 7.687e-02 S  per = 88.1  per(accum) = 99.8
 T(local oper_env: save ) = 1.470e-04 S  per = 0.168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.687e-02 S  T(sum) = 7.687e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.140e-06 S  per = 0.0119  per(accum) = 0.0119
 T(local oper_env: qops init                    ) = 1.359e-03 S  per = 1.77  per(accum) = 1.78
 T(local oper_env: symbolic_formulae_renorm     ) = 1.771e-02 S  per =   23  per(accum) = 24.8
 T(local oper_env: allocate qops on gpu         ) = 5.479e-05 S  per = 0.0713  per(accum) = 24.9
 T(local oper_env: site memcpy cpu2gpu          ) = 2.009e-03 S  per = 2.61  per(accum) = 27.5
 T(local oper_env: rintermediate init           ) = 2.511e-03 S  per = 3.27  per(accum) = 30.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.832e-03 S  per = 6.29  per(accum) = 37.1
 T(local oper_env: rmmtasks init                ) = 6.586e-03 S  per = 8.57  per(accum) = 45.6
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 4.03e-05  per(accum) = 45.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.021e-02 S  per = 52.3  per(accum) = 97.9
 T(local oper_env: deallocate cpu and gpu memory) = 5.997e-05 S  per = 0.078  per(accum) = 98
 T(local oper_env: construct opS [ifdists=true] ) = 4.300e-08 S  per = 5.59e-05  per(accum) = 98
 T(local oper_env: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 4.16e-05  per(accum) = 98
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.448e-04 S  per = 0.319  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.878e-05 S  per = 0.0244  per(accum) = 98.4
 T(local oper_env: qops_pool join and erase     ) = 1.263e-03 S  per = 1.64  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.680e-07 S  per = 0.000999  per(accum) = 100
##### sweep oper_env: 9.707e-01 S #####
 T(sweep oper_env: fetch) = 1.358e-01 S  per =   14  per(accum) = 14
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14
 T(sweep oper_env: renrm) = 8.329e-01 S  per = 85.8  per(accum) = 99.8
 T(sweep oper_env: save ) = 1.957e-03 S  per = 0.202  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.084e+10 S  per = -2.084e+32
 T(sweep oper_env: preprocess                  ) = -2.084e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.329e-01 S  T(sum) = 8.329e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.133e-04 S  per = 0.0136  per(accum) = 0.0136
 T(sweep oper_env: qops init                    ) = 1.602e-02 S  per = 1.92  per(accum) = 1.94
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.457e-01 S  per = 17.5  per(accum) = 19.4
 T(sweep oper_env: allocate qops on gpu         ) = 7.446e-04 S  per = 0.0894  per(accum) = 19.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.599e-02 S  per = 1.92  per(accum) = 21.4
 T(sweep oper_env: rintermediate init           ) = 2.740e-02 S  per = 3.29  per(accum) = 24.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.526e-02 S  per = 5.43  per(accum) = 30.2
 T(sweep oper_env: rmmtasks init                ) = 5.642e-02 S  per = 6.77  per(accum) = 36.9
 T(sweep oper_env: qops memset on cpu           ) = 5.240e-07 S  per = 6.29e-05  per(accum) = 36.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.675e-01 S  per = 56.1  per(accum) = 93.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.244e-04 S  per = 0.087  per(accum) = 93.2
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.880e-07 S  per = 8.26e-05  per(accum) = 93.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.200e-07 S  per = 6.24e-05  per(accum) = 93.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.681e-03 S  per = 0.322  per(accum) = 93.5
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.080e-04 S  per = 0.025  per(accum) = 93.5
 T(sweep oper_env: qops_pool join and erase     ) = 1.962e-02 S  per = 2.36  per(accum) = 95.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 4.15  per(accum) = 100

idx=13 coord=(6,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.717e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.385e-02 S -----
rank=0 GPUmem(GB): used=3.121e-05 (oper)=3.121e-05
rank=0 GPUmem(GB): used=3.138e-05 (oper,site)=3.121e-05,1.714e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.495e-03 S -----
rank=0 GPUmem(GB): used=6.916e-05 (oper,site,rinter)=3.121e-05,1.714e-07,3.777e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.636e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=2.135e-03,1.501e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.854e-03 S size(rtasks)=185 size(Rlst)=1049 -----
rank=0 GPUmem(GB): used=6.916e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.719e-04 blksize=9 blksize0=3 batchsize=1049
rank=0 GPUmem(GB): used=2.411e-04 (oper,site,rinter,batch)=3.121e-05,1.714e-07,3.777e-05,1.719e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.492e-03,1.400e-02,2.490e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=1.4e-02 t_reduction=2.5e-03 tot=2.3e-02 -----
 renorm[inter] counter=13 t=6.5e-03 per=2.8e+01 cost=1.9e+04 flops=2.9e+06
 renorm[gemm] counter=13 i=0 t=1.4e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=7.7e-03 per=3.3e+01 cost=2.5e+03 flops=3.2e+05
 renorm[gemm] counter=13 i=3 t=5.2e-03 per=2.3e+01 cost=8.0e+03 flops=1.5e+06
 renorm[gemm] counter=13 i=4 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=5 t=1.2e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=6 t=1.2e-03 per=5.0e+00 cost=1.9e+04 flops=1.7e+07
 renorm[gemm] counter=13 total t=1.4e-02 per=6.1e+01 cost=3.0e+04 flops=2.1e+06
 renorm[red] counter=13 t=2.5e-03 per=1.1e+01 cost=1.0e+04 flops=4.0e+06
----- TIMING FOR renorm_tot : t_inter=8.1e-02 t_gemm=2.9e-01 t_reduction=1.2e-01 tot=4.9e-01 -----
 renorm_tot[inter] counter=13 t=8.1e-02 per=1.7e+01 cost=4.4e+05 flops=5.4e+06
 renorm_tot[gemm] counter=13 i=0 t=2.3e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.8e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=9.8e-02 per=2.0e+01 cost=2.4e+04 flops=2.5e+05
 renorm_tot[gemm] counter=13 i=3 t=9.6e-02 per=2.0e+01 cost=1.2e+05 flops=1.2e+06
 renorm_tot[gemm] counter=13 i=4 t=1.7e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=5 t=1.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=6 t=9.1e-02 per=1.9e+01 cost=1.9e+05 flops=2.1e+06
 renorm_tot[gemm] counter=13 total t=2.9e-01 per=5.8e+01 cost=3.3e+05 flops=1.2e+06
 renorm_tot[red] counter=13 t=1.2e-01 per=2.5e+01 cost=8.8e+04 flops=7.2e+05
qops.to_cpu: size(tot)=661:5.0e-03MB:4.9e-06GB T(to_cpu)=1.8e-04S speed=2.7e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0517 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.889e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.510e-04 change=-1.773e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.302e-02 S #####
 T(local oper_env: fetch) = 9.881e-03 S  per = 15.7  per(accum) = 15.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: renrm) = 5.291e-02 S  per =   84  per(accum) = 99.6
 T(local oper_env: save ) = 2.329e-04 S  per = 0.37  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.291e-02 S  T(sum) = 5.291e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.899e-06 S  per = 0.0168  per(accum) = 0.0168
 T(local oper_env: qops init                    ) = 1.051e-03 S  per = 1.99  per(accum) = 2
 T(local oper_env: symbolic_formulae_renorm     ) = 1.386e-02 S  per = 26.2  per(accum) = 28.2
 T(local oper_env: allocate qops on gpu         ) = 5.583e-05 S  per = 0.106  per(accum) = 28.3
 T(local oper_env: site memcpy cpu2gpu          ) = 1.062e-03 S  per = 2.01  per(accum) = 30.3
 T(local oper_env: rintermediate init           ) = 2.508e-03 S  per = 4.74  per(accum) = 35.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.891e-03 S  per = 7.35  per(accum) = 42.4
 T(local oper_env: rmmtasks init                ) = 5.935e-03 S  per = 11.2  per(accum) = 53.6
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 5.67e-05  per(accum) = 53.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.308e-02 S  per = 43.6  per(accum) = 97.3
 T(local oper_env: deallocate cpu and gpu memory) = 6.136e-05 S  per = 0.116  per(accum) = 97.4
 T(local oper_env: construct opS [ifdists=true] ) = 4.200e-08 S  per = 7.94e-05  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [nccl]) = 3.300e-08 S  per = 6.24e-05  per(accum) = 97.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.886e-04 S  per = 0.356  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.842e-05 S  per = 0.0348  per(accum) = 97.8
 T(local oper_env: qops_pool join and erase     ) = 1.181e-03 S  per = 2.23  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 8.140e-07 S  per = 0.00154  per(accum) = 100
##### sweep oper_env: 1.034e+00 S #####
 T(sweep oper_env: fetch) = 1.457e-01 S  per = 14.1  per(accum) = 14.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: renrm) = 8.858e-01 S  per = 85.7  per(accum) = 99.8
 T(sweep oper_env: save ) = 2.190e-03 S  per = 0.212  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.258e+10 S  per = -2.258e+32
 T(sweep oper_env: preprocess                  ) = -2.258e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.858e-01 S  T(sum) = 8.858e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.222e-04 S  per = 0.0138  per(accum) = 0.0138
 T(sweep oper_env: qops init                    ) = 1.707e-02 S  per = 1.93  per(accum) = 1.94
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.595e-01 S  per =   18  per(accum) = 20
 T(sweep oper_env: allocate qops on gpu         ) = 8.005e-04 S  per = 0.0904  per(accum) = 20
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.705e-02 S  per = 1.92  per(accum) = 22
 T(sweep oper_env: rintermediate init           ) = 2.991e-02 S  per = 3.38  per(accum) = 25.3
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.915e-02 S  per = 5.55  per(accum) = 30.9
 T(sweep oper_env: rmmtasks init                ) = 6.235e-02 S  per = 7.04  per(accum) = 37.9
 T(sweep oper_env: qops memset on cpu           ) = 5.540e-07 S  per = 6.25e-05  per(accum) = 37.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.906e-01 S  per = 55.4  per(accum) = 93.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.858e-04 S  per = 0.0887  per(accum) = 93.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 7.300e-07 S  per = 8.24e-05  per(accum) = 93.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.530e-07 S  per = 6.24e-05  per(accum) = 93.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.870e-03 S  per = 0.324  per(accum) = 93.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.265e-04 S  per = 0.0256  per(accum) = 93.8
 T(sweep oper_env: qops_pool join and erase     ) = 2.080e-02 S  per = 2.35  per(accum) = 96.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per =  3.9  per(accum) = 100

idx=14 coord=(5,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.324e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.024e-02 S -----
rank=0 GPUmem(GB): used=2.509e-05 (oper)=2.509e-05
rank=0 GPUmem(GB): used=2.521e-05 (oper,site)=2.509e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.471e-03 S -----
rank=0 GPUmem(GB): used=5.442e-05 (oper,site,rinter)=2.509e-05,1.267e-07,2.921e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.426e-03 S size(rtasks)=141 size(Rlst2)=4 T(Rmu/Rlist)=1.518e-03,9.079e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.517e-03 S size(rtasks)=141 size(Rlst)=631 -----
rank=0 GPUmem(GB): used=5.442e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.034e-04 blksize=9 blksize0=3 batchsize=631
rank=0 GPUmem(GB): used=1.578e-04 (oper,site,rinter,batch)=2.509e-05,1.267e-07,2.921e-05,1.034e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.085e-03,2.224e-02,9.918e-03
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=14 t=6.1e-03 per=1.6e+01 cost=9.1e+03 flops=1.5e+06
 renorm[gemm] counter=14 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=7.5e-03 per=1.9e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=14 i=3 t=7.4e-03 per=1.9e+01 cost=3.8e+03 flops=5.1e+05
 renorm[gemm] counter=14 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=6 t=7.4e-03 per=1.9e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=14 total t=2.2e-02 per=5.8e+01 cost=1.6e+04 flops=7.4e+05
 renorm[red] counter=14 t=9.9e-03 per=2.6e+01 cost=7.0e+03 flops=7.1e+05
----- TIMING FOR renorm_tot : t_inter=8.8e-02 t_gemm=3.1e-01 t_reduction=1.3e-01 tot=5.3e-01 -----
 renorm_tot[inter] counter=14 t=8.8e-02 per=1.7e+01 cost=4.5e+05 flops=5.1e+06
 renorm_tot[gemm] counter=14 i=0 t=2.4e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.9e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=1.1e-01 per=2.0e+01 cost=2.6e+04 flops=2.4e+05
 renorm_tot[gemm] counter=14 i=3 t=1.0e-01 per=2.0e+01 cost=1.2e+05 flops=1.2e+06
 renorm_tot[gemm] counter=14 i=4 t=1.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=5 t=1.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=6 t=9.9e-02 per=1.9e+01 cost=2.0e+05 flops=2.1e+06
 renorm_tot[gemm] counter=14 total t=3.1e-01 per=5.8e+01 cost=3.5e+05 flops=1.1e+06
 renorm_tot[red] counter=14 t=1.3e-01 per=2.5e+01 cost=9.5e+04 flops=7.2e+05
qops.to_cpu: size(tot)=370:2.8e-03MB:2.8e-06GB T(to_cpu)=1.4e-04S speed=2.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0586 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=5.399e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=6.027e-04 change=-1.508e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.984e-02 S #####
 T(local oper_env: fetch) = 9.889e-03 S  per = 14.2  per(accum) = 14.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(local oper_env: renrm) = 5.973e-02 S  per = 85.5  per(accum) = 99.7
 T(local oper_env: save ) = 2.236e-04 S  per = 0.32  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.973e-02 S  T(sum) = 5.973e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.984e-06 S  per = 0.015  per(accum) = 0.015
 T(local oper_env: qops init                    ) = 7.640e-04 S  per = 1.28  per(accum) = 1.29
 T(local oper_env: symbolic_formulae_renorm     ) = 1.025e-02 S  per = 17.2  per(accum) = 18.5
 T(local oper_env: allocate qops on gpu         ) = 5.209e-05 S  per = 0.0872  per(accum) = 18.5
 T(local oper_env: site memcpy cpu2gpu          ) = 6.371e-04 S  per = 1.07  per(accum) = 19.6
 T(local oper_env: rintermediate init           ) = 2.482e-03 S  per = 4.16  per(accum) = 23.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.540e-03 S  per = 4.25  per(accum) = 28
 T(local oper_env: rmmtasks init                ) = 3.359e-03 S  per = 5.62  per(accum) = 33.6
 T(local oper_env: qops memset on cpu           ) = 4.700e-08 S  per = 7.87e-05  per(accum) = 33.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.833e-02 S  per = 64.2  per(accum) = 97.8
 T(local oper_env: deallocate cpu and gpu memory) = 6.342e-05 S  per = 0.106  per(accum) = 97.9
 T(local oper_env: construct opS [ifdists=true] ) = 6.100e-08 S  per = 0.000102  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 6.36e-05  per(accum) = 97.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.483e-04 S  per = 0.248  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.720e-05 S  per = 0.0288  per(accum) = 98.2
 T(local oper_env: qops_pool join and erase     ) = 1.068e-03 S  per = 1.79  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.270e-07 S  per = 0.00122  per(accum) = 100
##### sweep oper_env: 1.104e+00 S #####
 T(sweep oper_env: fetch) = 1.556e-01 S  per = 14.1  per(accum) = 14.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: renrm) = 9.456e-01 S  per = 85.7  per(accum) = 99.8
 T(sweep oper_env: save ) = 2.414e-03 S  per = 0.219  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.431e+10 S  per = -2.431e+32
 T(sweep oper_env: preprocess                  ) = -2.431e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.456e-01 S  T(sum) = 9.456e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.312e-04 S  per = 0.0139  per(accum) = 0.0139
 T(sweep oper_env: qops init                    ) = 1.784e-02 S  per = 1.89  per(accum) = 1.9
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.698e-01 S  per =   18  per(accum) = 19.9
 T(sweep oper_env: allocate qops on gpu         ) = 8.526e-04 S  per = 0.0902  per(accum) = 19.9
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.769e-02 S  per = 1.87  per(accum) = 21.8
 T(sweep oper_env: rintermediate init           ) = 3.239e-02 S  per = 3.43  per(accum) = 25.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.169e-02 S  per = 5.47  per(accum) = 30.7
 T(sweep oper_env: rmmtasks init                ) = 6.571e-02 S  per = 6.95  per(accum) = 37.7
 T(sweep oper_env: qops memset on cpu           ) = 6.010e-07 S  per = 6.36e-05  per(accum) = 37.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.290e-01 S  per = 55.9  per(accum) = 93.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.492e-04 S  per = 0.0898  per(accum) = 93.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 7.910e-07 S  per = 8.37e-05  per(accum) = 93.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.910e-07 S  per = 6.25e-05  per(accum) = 93.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.018e-03 S  per = 0.319  per(accum) = 94
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.437e-04 S  per = 0.0258  per(accum) = 94
 T(sweep oper_env: qops_pool join and erase     ) = 2.187e-02 S  per = 2.31  per(accum) = 96.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 3.65  per(accum) = 100

idx=15 coord=(4,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.181e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 6.939e-03 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper)=2.124e-05
rank=0 GPUmem(GB): used=2.132e-05 (oper,site)=2.124e-05,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.451e-03 S -----
rank=0 GPUmem(GB): used=4.233e-05 (oper,site,rinter)=2.124e-05,7.451e-08,2.101e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.407e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.013e-03,3.937e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.462e-03 S size(rtasks)=105 size(Rlst)=244 -----
rank=0 GPUmem(GB): used=4.233e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.909e-05 blksize=6 blksize0=3 batchsize=244
rank=0 GPUmem(GB): used=7.141e-05 (oper,site,rinter,batch)=2.124e-05,7.451e-08,2.101e-05,2.909e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.230e-03,2.237e-02,1.003e-02
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=15 t=7.2e-03 per=1.8e+01 cost=4.0e+03 flops=5.5e+05
 renorm[gemm] counter=15 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=7.4e-03 per=1.9e+01 cost=3.7e+02 flops=5.0e+04
 renorm[gemm] counter=15 i=3 t=7.5e-03 per=1.9e+01 cost=1.7e+03 flops=2.3e+05
 renorm[gemm] counter=15 i=4 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=5 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=6 t=7.5e-03 per=1.9e+01 cost=2.0e+03 flops=2.7e+05
 renorm[gemm] counter=15 total t=2.2e-02 per=5.6e+01 cost=4.1e+03 flops=1.9e+05
 renorm[red] counter=15 t=1.0e-02 per=2.5e+01 cost=8.3e+02 flops=8.3e+04
----- TIMING FOR renorm_tot : t_inter=9.5e-02 t_gemm=3.3e-01 t_reduction=1.4e-01 tot=5.7e-01 -----
 renorm_tot[inter] counter=15 t=9.5e-02 per=1.7e+01 cost=4.5e+05 flops=4.7e+06
 renorm_tot[gemm] counter=15 i=0 t=2.5e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=2.0e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=1.1e-01 per=2.0e+01 cost=2.6e+04 flops=2.3e+05
 renorm_tot[gemm] counter=15 i=3 t=1.1e-01 per=1.9e+01 cost=1.2e+05 flops=1.1e+06
 renorm_tot[gemm] counter=15 i=4 t=2.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=5 t=1.9e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=6 t=1.1e-01 per=1.9e+01 cost=2.1e+05 flops=1.9e+06
 renorm_tot[gemm] counter=15 total t=3.3e-01 per=5.8e+01 cost=3.5e+05 flops=1.1e+06
 renorm_tot[red] counter=15 t=1.4e-01 per=2.5e+01 cost=9.6e+04 flops=6.7e+05
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.0e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0532 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.533e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.280e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.372e-02 S #####
 T(local oper_env: fetch) = 9.364e-03 S  per = 14.7  per(accum) = 14.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: renrm) = 5.414e-02 S  per =   85  per(accum) = 99.7
 T(local oper_env: save ) = 2.177e-04 S  per = 0.342  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.414e-02 S  T(sum) = 5.414e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.348e-06 S  per = 0.0154  per(accum) = 0.0154
 T(local oper_env: qops init                    ) = 5.824e-04 S  per = 1.08  per(accum) = 1.09
 T(local oper_env: symbolic_formulae_renorm     ) = 6.952e-03 S  per = 12.8  per(accum) = 13.9
 T(local oper_env: allocate qops on gpu         ) = 4.824e-05 S  per = 0.0891  per(accum) = 14
 T(local oper_env: site memcpy cpu2gpu          ) = 7.112e-04 S  per = 1.31  per(accum) = 15.3
 T(local oper_env: rintermediate init           ) = 2.462e-03 S  per = 4.55  per(accum) = 19.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.473e-03 S  per = 2.72  per(accum) = 22.6
 T(local oper_env: rmmtasks init                ) = 1.122e-03 S  per = 2.07  per(accum) = 24.7
 T(local oper_env: qops memset on cpu           ) = 6.300e-08 S  per = 0.000116  per(accum) = 24.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.972e-02 S  per = 73.4  per(accum) = 98
 T(local oper_env: deallocate cpu and gpu memory) = 2.875e-05 S  per = 0.0531  per(accum) = 98.1
 T(local oper_env: construct opS [ifdists=true] ) = 4.000e-08 S  per = 7.39e-05  per(accum) = 98.1
 T(local oper_env: reduction of opS & opH [nccl]) = 2.900e-08 S  per = 5.36e-05  per(accum) = 98.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.120e-04 S  per = 0.207  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.629e-05 S  per = 0.0301  per(accum) = 98.3
 T(local oper_env: qops_pool join and erase     ) = 9.030e-04 S  per = 1.67  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.400e-07 S  per = 0.00137  per(accum) = 100
##### sweep oper_env: 1.167e+00 S #####
 T(sweep oper_env: fetch) = 1.649e-01 S  per = 14.1  per(accum) = 14.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(sweep oper_env: renrm) = 9.997e-01 S  per = 85.6  per(accum) = 99.8
 T(sweep oper_env: save ) = 2.631e-03 S  per = 0.225  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.605e+10 S  per = -2.605e+32
 T(sweep oper_env: preprocess                  ) = -2.605e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.997e-01 S  T(sum) = 9.997e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.396e-04 S  per = 0.014  per(accum) = 0.014
 T(sweep oper_env: qops init                    ) = 1.842e-02 S  per = 1.84  per(accum) = 1.86
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.767e-01 S  per = 17.7  per(accum) = 19.5
 T(sweep oper_env: allocate qops on gpu         ) = 9.008e-04 S  per = 0.0901  per(accum) = 19.6
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.840e-02 S  per = 1.84  per(accum) = 21.5
 T(sweep oper_env: rintermediate init           ) = 3.485e-02 S  per = 3.49  per(accum) = 25
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.316e-02 S  per = 5.32  per(accum) = 30.3
 T(sweep oper_env: rmmtasks init                ) = 6.683e-02 S  per = 6.69  per(accum) = 37
 T(sweep oper_env: qops memset on cpu           ) = 6.640e-07 S  per = 6.64e-05  per(accum) = 37
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.687e-01 S  per = 56.9  per(accum) = 93.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.780e-04 S  per = 0.0878  per(accum) = 93.9
 T(sweep oper_env: construct opS [ifdists=true] ) = 8.310e-07 S  per = 8.31e-05  per(accum) = 93.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.200e-07 S  per = 6.2e-05  per(accum) = 93.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.130e-03 S  per = 0.313  per(accum) = 94.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.600e-04 S  per = 0.026  per(accum) = 94.3
 T(sweep oper_env: qops_pool join and erase     ) = 2.277e-02 S  per = 2.28  per(accum) = 96.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 3.45  per(accum) = 100

idx=16 coord=(3,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): H:4.35 C:37 S:6.52 P:0 Q:52.2 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.074e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 4.377e-03 S -----
rank=0 GPUmem(GB): used=1.883e-05 (oper)=1.883e-05
rank=0 GPUmem(GB): used=1.886e-05 (oper,site)=1.883e-05,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.454e-03 S -----
rank=0 GPUmem(GB): used=3.245e-05 (oper,site,rinter)=1.883e-05,3.725e-08,1.359e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 9.196e-04 S size(rtasks)=77 size(Rlst2)=4 T(Rmu/Rlist)=6.385e-04,2.811e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.609e-04 S size(rtasks)=77 size(Rlst)=179 -----
rank=0 GPUmem(GB): used=3.245e-05 avail=6.176e+00 total=6.176e+00 batch[need]=9.336e-06 blksize=2 blksize0=2 batchsize=179
rank=0 GPUmem(GB): used=4.179e-05 (oper,site,rinter,batch)=1.883e-05,3.725e-08,1.359e-05,9.336e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.273e-03,2.252e-02,9.992e-03
----- TIMING FOR renorm : t_inter=8.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.1e-02 -----
 renorm[inter] counter=16 t=8.3e-03 per=2.0e+01 cost=1.7e+03 flops=2.1e+05
 renorm[gemm] counter=16 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=7.5e-03 per=1.8e+01 cost=1.7e+02 flops=2.3e+04
 renorm[gemm] counter=16 i=3 t=7.5e-03 per=1.8e+01 cost=4.8e+02 flops=6.4e+04
 renorm[gemm] counter=16 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=5 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=6 t=7.5e-03 per=1.8e+01 cost=5.7e+02 flops=7.5e+04
 renorm[gemm] counter=16 total t=2.3e-02 per=5.5e+01 cost=1.2e+03 flops=5.4e+04
 renorm[red] counter=16 t=1.0e-02 per=2.5e+01 cost=3.6e+02 flops=3.6e+04
----- TIMING FOR renorm_tot : t_inter=1.0e-01 t_gemm=3.5e-01 t_reduction=1.5e-01 tot=6.1e-01 -----
 renorm_tot[inter] counter=16 t=1.0e-01 per=1.7e+01 cost=4.5e+05 flops=4.4e+06
 renorm_tot[gemm] counter=16 i=0 t=2.7e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=2.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=1.2e-01 per=2.0e+01 cost=2.6e+04 flops=2.2e+05
 renorm_tot[gemm] counter=16 i=3 t=1.2e-01 per=1.9e+01 cost=1.2e+05 flops=1.0e+06
 renorm_tot[gemm] counter=16 i=4 t=2.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=5 t=2.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=6 t=1.1e-01 per=1.9e+01 cost=2.1e+05 flops=1.8e+06
 renorm_tot[gemm] counter=16 total t=3.5e-01 per=5.8e+01 cost=3.5e+05 flops=1.0e+06
 renorm_tot[red] counter=16 t=1.5e-01 per=2.5e+01 cost=9.6e+04 flops=6.3e+05
qops.to_cpu: size(tot)=46:3.5e-04MB:3.4e-07GB T(to_cpu)=7.7e-05S speed=4.4e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0521 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.382e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.153e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.236e-02 S #####
 T(local oper_env: fetch) = 9.137e-03 S  per = 14.7  per(accum) = 14.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: renrm) = 5.301e-02 S  per =   85  per(accum) = 99.7
 T(local oper_env: save ) = 2.168e-04 S  per = 0.348  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.301e-02 S  T(sum) = 5.301e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.371e-06 S  per = 0.0158  per(accum) = 0.0158
 T(local oper_env: qops init                    ) = 4.480e-04 S  per = 0.845  per(accum) = 0.861
 T(local oper_env: symbolic_formulae_renorm     ) = 4.388e-03 S  per = 8.28  per(accum) = 9.14
 T(local oper_env: allocate qops on gpu         ) = 4.558e-05 S  per = 0.086  per(accum) = 9.22
 T(local oper_env: site memcpy cpu2gpu          ) = 1.936e-03 S  per = 3.65  per(accum) = 12.9
 T(local oper_env: rintermediate init           ) = 2.463e-03 S  per = 4.65  per(accum) = 17.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 9.701e-04 S  per = 1.83  per(accum) = 19.4
 T(local oper_env: rmmtasks init                ) = 8.984e-04 S  per = 1.69  per(accum) = 21
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 5.66e-05  per(accum) = 21
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.087e-02 S  per = 77.1  per(accum) = 98.2
 T(local oper_env: deallocate cpu and gpu memory) = 2.511e-05 S  per = 0.0474  per(accum) = 98.2
 T(local oper_env: construct opS [ifdists=true] ) = 3.900e-08 S  per = 7.36e-05  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 5.66e-05  per(accum) = 98.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.427e-05 S  per = 0.159  per(accum) = 98.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.596e-05 S  per = 0.0301  per(accum) = 98.4
 T(local oper_env: qops_pool join and erase     ) = 8.541e-04 S  per = 1.61  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.960e-07 S  per = 0.00131  per(accum) = 100
##### sweep oper_env: 1.230e+00 S #####
 T(sweep oper_env: fetch) = 1.741e-01 S  per = 14.2  per(accum) = 14.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: renrm) = 1.053e+00 S  per = 85.6  per(accum) = 99.8
 T(sweep oper_env: save ) = 2.848e-03 S  per = 0.232  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.779e+10 S  per = -2.779e+32
 T(sweep oper_env: preprocess                  ) = -2.779e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.053e+00 S  T(sum) = 1.053e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.479e-04 S  per = 0.0141  per(accum) = 0.0141
 T(sweep oper_env: qops init                    ) = 1.887e-02 S  per = 1.79  per(accum) = 1.81
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.811e-01 S  per = 17.2  per(accum) = 19
 T(sweep oper_env: allocate qops on gpu         ) = 9.464e-04 S  per = 0.0899  per(accum) = 19.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.033e-02 S  per = 1.93  per(accum) = 21
 T(sweep oper_env: rintermediate init           ) = 3.732e-02 S  per = 3.55  per(accum) = 24.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.413e-02 S  per = 5.14  per(accum) = 29.7
 T(sweep oper_env: rmmtasks init                ) = 6.773e-02 S  per = 6.43  per(accum) = 36.2
 T(sweep oper_env: qops memset on cpu           ) = 6.940e-07 S  per = 6.59e-05  per(accum) = 36.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.096e-01 S  per = 57.9  per(accum) = 94.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.031e-04 S  per = 0.0858  per(accum) = 94.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 8.700e-07 S  per = 8.26e-05  per(accum) = 94.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.500e-07 S  per = 6.17e-05  per(accum) = 94.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.215e-03 S  per = 0.305  per(accum) = 94.4
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.759e-04 S  per = 0.0262  per(accum) = 94.5
 T(sweep oper_env: qops_pool join and erase     ) = 2.363e-02 S  per = 2.24  per(accum) = 96.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 3.28  per(accum) = 100

idx=17 coord=(2,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): H:4.35 C:37 S:6.52 P:0 Q:52.2 
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=7:5.34e-05MB:5.22e-08GB
        per(mem): H:14.3 C:0 S:0 P:0 Q:85.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.960e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.461e-03 S -----
rank=0 GPUmem(GB): used=1.780e-05 (oper)=1.780e-05
rank=0 GPUmem(GB): used=1.781e-05 (oper,site)=1.780e-05,1.490e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.481e-03 S -----
rank=0 GPUmem(GB): used=2.516e-05 (oper,site,rinter)=1.780e-05,1.490e-08,7.346e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.943e-04 S size(rtasks)=57 size(Rlst2)=1 T(Rmu/Rlist)=4.321e-04,1.621e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.114e-04 S size(rtasks)=57 size(Rlst)=86 -----
rank=0 GPUmem(GB): used=2.516e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.563e-06 blksize=1 blksize0=1 batchsize=86
rank=0 GPUmem(GB): used=2.772e-05 (oper,site,rinter,batch)=1.780e-05,1.490e-08,7.346e-06,2.563e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.913e-03,2.271e-02,9.954e-03
----- TIMING FOR renorm : t_inter=8.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.2e-02 -----
 renorm[inter] counter=17 t=8.9e-03 per=2.1e+01 cost=4.1e+02 flops=4.6e+04
 renorm[gemm] counter=17 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=7.6e-03 per=1.8e+01 cost=5.8e+01 flops=7.7e+03
 renorm[gemm] counter=17 i=3 t=7.6e-03 per=1.8e+01 cost=8.2e+01 flops=1.1e+04
 renorm[gemm] counter=17 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=5 t=1.0e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=6 t=7.5e-03 per=1.8e+01 cost=1.7e+02 flops=2.3e+04
 renorm[gemm] counter=17 total t=2.3e-02 per=5.5e+01 cost=3.1e+02 flops=1.4e+04
 renorm[red] counter=17 t=1.0e-02 per=2.4e+01 cost=1.7e+02 flops=1.7e+04
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=3.8e-01 t_reduction=1.6e-01 tot=6.5e-01 -----
 renorm_tot[inter] counter=17 t=1.1e-01 per=1.7e+01 cost=4.5e+05 flops=4.0e+06
 renorm_tot[gemm] counter=17 i=0 t=2.8e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=2.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=1.3e-01 per=2.0e+01 cost=2.6e+04 flops=2.1e+05
 renorm_tot[gemm] counter=17 i=3 t=1.3e-01 per=1.9e+01 cost=1.2e+05 flops=9.7e+05
 renorm_tot[gemm] counter=17 i=4 t=2.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=5 t=2.1e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=6 t=1.2e-01 per=1.9e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=17 total t=3.8e-01 per=5.8e+01 cost=3.5e+05 flops=9.5e+05
 renorm_tot[red] counter=17 t=1.6e-01 per=2.5e+01 cost=9.6e+04 flops=5.9e+05
qops.to_cpu: size(tot)=7:5.3e-05MB:5.2e-08GB T(to_cpu)=9.1e-05S speed=5.7e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0501 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.353e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.041e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.056e-02 S #####
 T(local oper_env: fetch) = 9.199e-03 S  per = 15.2  per(accum) = 15.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: renrm) = 5.115e-02 S  per = 84.5  per(accum) = 99.6
 T(local oper_env: save ) = 2.136e-04 S  per = 0.353  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.115e-02 S  T(sum) = 5.115e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.479e-06 S  per = 0.0166  per(accum) = 0.0166
 T(local oper_env: qops init                    ) = 3.386e-04 S  per = 0.662  per(accum) = 0.678
 T(local oper_env: symbolic_formulae_renorm     ) = 2.472e-03 S  per = 4.83  per(accum) = 5.51
 T(local oper_env: allocate qops on gpu         ) = 4.837e-05 S  per = 0.0946  per(accum) = 5.61
 T(local oper_env: site memcpy cpu2gpu          ) = 1.829e-03 S  per = 3.57  per(accum) = 9.18
 T(local oper_env: rintermediate init           ) = 2.492e-03 S  per = 4.87  per(accum) = 14.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.178e-04 S  per = 1.21  per(accum) = 15.3
 T(local oper_env: rmmtasks init                ) = 4.765e-04 S  per = 0.932  per(accum) = 16.2
 T(local oper_env: qops memset on cpu           ) = 4.200e-08 S  per = 8.21e-05  per(accum) = 16.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.166e-02 S  per = 81.4  per(accum) = 97.6
 T(local oper_env: deallocate cpu and gpu memory) = 4.022e-05 S  per = 0.0786  per(accum) = 97.7
 T(local oper_env: construct opS [ifdists=true] ) = 4.100e-08 S  per = 8.02e-05  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 6.84e-05  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.013e-04 S  per = 0.198  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.614e-05 S  per = 0.0315  per(accum) = 97.9
 T(local oper_env: qops_pool join and erase     ) = 1.048e-03 S  per = 2.05  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.120e-07 S  per = 0.00139  per(accum) = 100
##### sweep oper_env: 1.290e+00 S #####
 T(sweep oper_env: fetch) = 1.833e-01 S  per = 14.2  per(accum) = 14.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: renrm) = 1.104e+00 S  per = 85.6  per(accum) = 99.8
 T(sweep oper_env: save ) = 3.062e-03 S  per = 0.237  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.952e+10 S  per = -2.952e+32
 T(sweep oper_env: preprocess                  ) = -2.952e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.104e+00 S  T(sum) = 1.104e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.564e-04 S  per = 0.0142  per(accum) = 0.0142
 T(sweep oper_env: qops init                    ) = 1.921e-02 S  per = 1.74  per(accum) = 1.75
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.836e-01 S  per = 16.6  per(accum) = 18.4
 T(sweep oper_env: allocate qops on gpu         ) = 9.947e-04 S  per = 0.0901  per(accum) = 18.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.216e-02 S  per = 2.01  per(accum) = 20.5
 T(sweep oper_env: rintermediate init           ) = 3.981e-02 S  per = 3.61  per(accum) = 24.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.475e-02 S  per = 4.96  per(accum) = 29
 T(sweep oper_env: rmmtasks init                ) = 6.821e-02 S  per = 6.18  per(accum) = 35.2
 T(sweep oper_env: qops memset on cpu           ) = 7.360e-07 S  per = 6.67e-05  per(accum) = 35.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.512e-01 S  per =   59  per(accum) = 94.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.433e-04 S  per = 0.0855  per(accum) = 94.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 9.110e-07 S  per = 8.25e-05  per(accum) = 94.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.850e-07 S  per = 6.21e-05  per(accum) = 94.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.316e-03 S  per =  0.3  per(accum) = 94.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.921e-04 S  per = 0.0265  per(accum) = 94.6
 T(sweep oper_env: qops_pool join and erase     ) = 2.468e-02 S  per = 2.24  per(accum) = 96.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 3.13  per(accum) = 100

idx=18 coord=(1,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=7:5.34e-05MB:5.22e-08GB
        per(mem): H:14.3 C:0 S:0 P:0 Q:85.7 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=3:2.29e-05MB:2.24e-08GB
        per(mem): H:33.3 C:0 S:0 P:0 Q:66.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.919e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 1.147e-03 S -----
rank=0 GPUmem(GB): used=1.748e-05 (oper)=1.748e-05
rank=0 GPUmem(GB): used=1.749e-05 (oper,site)=1.748e-05,7.451e-09
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=45
 no. of rintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.012e-04 S -----
rank=0 GPUmem(GB): used=2.017e-05 (oper,site,rinter)=1.748e-05,7.451e-09,2.682e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.874e-04 S size(rtasks)=45 size(Rlst2)=1 T(Rmu/Rlist)=2.366e-04,5.084e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.981e-04 S size(rtasks)=45 size(Rlst)=12 -----
rank=0 GPUmem(GB): used=2.017e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.682e-07 blksize=1 blksize0=0 batchsize=12
rank=0 GPUmem(GB): used=2.044e-05 (oper,site,rinter,batch)=1.748e-05,7.451e-09,2.682e-06,2.682e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=4.791e-04,1.347e-02,3.532e-03
----- TIMING FOR renorm : t_inter=4.8e-04 t_gemm=1.3e-02 t_reduction=3.5e-03 tot=1.7e-02 -----
 renorm[inter] counter=18 t=4.8e-04 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=1.5e-06 per=8.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.0e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=5.6e-03 per=3.2e+01 cost=6.0e+00 flops=1.1e+03
 renorm[gemm] counter=18 i=3 t=4.6e-03 per=2.6e+01 cost=1.0e+01 flops=2.2e+03
 renorm[gemm] counter=18 i=4 t=1.1e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.1e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=3.3e-03 per=1.9e+01 cost=2.4e+01 flops=7.2e+03
 renorm[gemm] counter=18 total t=1.3e-02 per=7.7e+01 cost=4.0e+01 flops=3.0e+03
 renorm[red] counter=18 t=3.5e-03 per=2.0e+01 cost=2.4e+01 flops=6.8e+03
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=3.9e-01 t_reduction=1.7e-01 tot=6.7e-01 -----
 renorm_tot[inter] counter=18 t=1.1e-01 per=1.7e+01 cost=4.5e+05 flops=4.0e+06
 renorm_tot[gemm] counter=18 i=0 t=2.9e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=1.3e-01 per=2.0e+01 cost=2.6e+04 flops=2.0e+05
 renorm_tot[gemm] counter=18 i=3 t=1.3e-01 per=2.0e+01 cost=1.2e+05 flops=9.3e+05
 renorm_tot[gemm] counter=18 i=4 t=2.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=5 t=2.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=6 t=1.2e-01 per=1.9e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=18 total t=3.9e-01 per=5.8e+01 cost=3.5e+05 flops=9.1e+05
 renorm_tot[red] counter=18 t=1.7e-01 per=2.5e+01 cost=9.6e+04 flops=5.8e+05
qops.to_cpu: size(tot)=3:2.3e-05MB:2.2e-08GB T(to_cpu)=4.7e-05S speed=4.7e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0202 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=6.008e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.550e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 3.051e-02 S #####
 T(local oper_env: fetch) = 9.317e-03 S  per = 30.5  per(accum) = 30.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 30.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 30.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 30.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 30.5
 T(local oper_env: renrm) = 2.101e-02 S  per = 68.9  per(accum) = 99.4
 T(local oper_env: save ) = 1.755e-04 S  per = 0.575  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.101e-02 S  T(sum) = 2.101e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.257e-06 S  per = 0.0393  per(accum) = 0.0393
 T(local oper_env: qops init                    ) = 2.915e-04 S  per = 1.39  per(accum) = 1.43
 T(local oper_env: symbolic_formulae_renorm     ) = 1.158e-03 S  per = 5.51  per(accum) = 6.94
 T(local oper_env: allocate qops on gpu         ) = 4.745e-05 S  per = 0.226  per(accum) = 7.16
 T(local oper_env: site memcpy cpu2gpu          ) = 4.205e-05 S  per =  0.2  per(accum) = 7.36
 T(local oper_env: rintermediate init           ) = 6.108e-04 S  per = 2.91  per(accum) = 10.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.023e-04 S  per = 1.44  per(accum) = 11.7
 T(local oper_env: rmmtasks init                ) = 1.089e-04 S  per = 0.518  per(accum) = 12.2
 T(local oper_env: qops memset on cpu           ) = 3.800e-08 S  per = 0.000181  per(accum) = 12.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.757e-02 S  per = 83.6  per(accum) = 95.8
 T(local oper_env: deallocate cpu and gpu memory) = 2.005e-05 S  per = 0.0954  per(accum) = 95.9
 T(local oper_env: construct opS [ifdists=true] ) = 4.200e-08 S  per = 0.0002  per(accum) = 95.9
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 0.000143  per(accum) = 95.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.438e-05 S  per = 0.259  per(accum) = 96.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.483e-05 S  per = 0.0706  per(accum) = 96.2
 T(local oper_env: qops_pool join and erase     ) = 7.884e-04 S  per = 3.75  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.090e-07 S  per = 0.00337  per(accum) = 100
##### sweep oper_env: 1.321e+00 S #####
 T(sweep oper_env: fetch) = 1.926e-01 S  per = 14.6  per(accum) = 14.6
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(sweep oper_env: renrm) = 1.125e+00 S  per = 85.2  per(accum) = 99.8
 T(sweep oper_env: save ) = 3.237e-03 S  per = 0.245  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.126e+10 S  per = -3.126e+32
 T(sweep oper_env: preprocess                  ) = -3.126e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.125e+00 S  T(sum) = 1.125e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.647e-04 S  per = 0.0146  per(accum) = 0.0146
 T(sweep oper_env: qops init                    ) = 1.950e-02 S  per = 1.73  per(accum) = 1.75
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.847e-01 S  per = 16.4  per(accum) = 18.2
 T(sweep oper_env: allocate qops on gpu         ) = 1.042e-03 S  per = 0.0927  per(accum) = 18.3
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.220e-02 S  per = 1.97  per(accum) = 20.2
 T(sweep oper_env: rintermediate init           ) = 4.042e-02 S  per = 3.59  per(accum) = 23.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.505e-02 S  per = 4.89  per(accum) = 28.7
 T(sweep oper_env: rmmtasks init                ) = 6.832e-02 S  per = 6.07  per(accum) = 34.8
 T(sweep oper_env: qops memset on cpu           ) = 7.740e-07 S  per = 6.88e-05  per(accum) = 34.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.688e-01 S  per = 59.5  per(accum) = 94.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.634e-04 S  per = 0.0856  per(accum) = 94.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 9.530e-07 S  per = 8.47e-05  per(accum) = 94.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.150e-07 S  per = 6.36e-05  per(accum) = 94.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.370e-03 S  per =  0.3  per(accum) = 94.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.069e-04 S  per = 0.0273  per(accum) = 94.7
 T(sweep oper_env: qops_pool join and erase     ) = 2.546e-02 S  per = 2.26  per(accum) = 96.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.453e-02 S  per = 3.07  per(accum) = 100

idx=19 coord=(0,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=3:2.29e-05MB:2.24e-08GB
        per(mem): H:33.3 C:0 S:0 P:0 Q:66.7 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:40 S:0 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.897e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 3.772e-04 S -----
rank=0 GPUmem(GB): used=1.743e-05 (oper)=1.743e-05
rank=0 GPUmem(GB): used=1.744e-05 (oper,site)=1.743e-05,7.451e-09
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.744e-05 (oper,site,rinter)=1.743e-05,7.451e-09,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.018e-04 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=1.610e-04,4.081e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.108e-04 S size(rtasks)=41 size(Rlst)=8 -----
rank=0 GPUmem(GB): used=1.744e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.788e-07 blksize=1 blksize0=0 batchsize=8
rank=0 GPUmem(GB): used=1.762e-05 (oper,site,rinter,batch)=1.743e-05,7.451e-09,0.000e+00,1.788e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.125e-03,2.228e-02,9.873e-03
----- TIMING FOR renorm : t_inter=2.1e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.4e-02 -----
 renorm[inter] counter=19 t=2.1e-03 per=6.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=0 t=1.8e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=7.5e-03 per=2.2e+01 cost=6.0e+00 flops=8.0e+02
 renorm[gemm] counter=19 i=3 t=7.4e-03 per=2.2e+01 cost=6.0e+00 flops=8.1e+02
 renorm[gemm] counter=19 i=4 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=1.1e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=7.3e-03 per=2.1e+01 cost=1.6e+01 flops=2.2e+03
 renorm[gemm] counter=19 total t=2.2e-02 per=6.5e+01 cost=2.8e+01 flops=1.3e+03
 renorm[red] counter=19 t=9.9e-03 per=2.9e+01 cost=1.6e+01 flops=1.6e+03
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.1e-01 t_reduction=1.8e-01 tot=7.0e-01 -----
 renorm_tot[inter] counter=19 t=1.1e-01 per=1.6e+01 cost=4.5e+05 flops=3.9e+06
 renorm_tot[gemm] counter=19 i=0 t=3.1e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=1.4e-01 per=2.0e+01 cost=2.6e+04 flops=1.9e+05
 renorm_tot[gemm] counter=19 i=3 t=1.4e-01 per=2.0e+01 cost=1.2e+05 flops=8.8e+05
 renorm_tot[gemm] counter=19 i=4 t=2.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=5 t=2.3e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=6 t=1.3e-01 per=1.9e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=19 total t=4.1e-01 per=5.9e+01 cost=3.5e+05 flops=8.6e+05
 renorm_tot[red] counter=19 t=1.8e-01 per=2.5e+01 cost=9.6e+04 flops=5.5e+05
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=3.9e-05S speed=1.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0357 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.774e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.188e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 4.578e-02 S #####
 T(local oper_env: fetch) = 9.162e-03 S  per =   20  per(accum) = 20
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: renrm) = 3.648e-02 S  per = 79.7  per(accum) = 99.7
 T(local oper_env: save ) = 1.309e-04 S  per = 0.286  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.648e-02 S  T(sum) = 3.648e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.237e-06 S  per = 0.0226  per(accum) = 0.0226
 T(local oper_env: qops init                    ) = 2.962e-04 S  per = 0.812  per(accum) = 0.834
 T(local oper_env: symbolic_formulae_renorm     ) = 3.846e-04 S  per = 1.05  per(accum) = 1.89
 T(local oper_env: allocate qops on gpu         ) = 4.354e-05 S  per = 0.119  per(accum) = 2.01
 T(local oper_env: site memcpy cpu2gpu          ) = 2.130e-04 S  per = 0.584  per(accum) = 2.59
 T(local oper_env: rintermediate init           ) = 1.724e-05 S  per = 0.0472  per(accum) = 2.64
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.150e-04 S  per = 0.589  per(accum) = 3.23
 T(local oper_env: rmmtasks init                ) = 1.002e-04 S  per = 0.275  per(accum) = 3.5
 T(local oper_env: qops memset on cpu           ) = 4.200e-08 S  per = 0.000115  per(accum) = 3.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.435e-02 S  per = 94.2  per(accum) = 97.7
 T(local oper_env: deallocate cpu and gpu memory) = 1.854e-05 S  per = 0.0508  per(accum) = 97.7
 T(local oper_env: construct opS [ifdists=true] ) = 4.000e-08 S  per = 0.00011  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 2.900e-08 S  per = 7.95e-05  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.555e-05 S  per = 0.125  per(accum) = 97.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.543e-05 S  per = 0.0423  per(accum) = 97.9
 T(local oper_env: qops_pool join and erase     ) = 7.702e-04 S  per = 2.11  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.040e-07 S  per = 0.00193  per(accum) = 100
##### sweep oper_env: 1.366e+00 S #####
 T(sweep oper_env: fetch) = 2.018e-01 S  per = 14.8  per(accum) = 14.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: renrm) = 1.161e+00 S  per =   85  per(accum) = 99.8
 T(sweep oper_env: save ) = 3.368e-03 S  per = 0.246  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.300e+10 S  per = -3.300e+32
 T(sweep oper_env: preprocess                  ) = -3.300e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.161e+00 S  T(sum) = 1.161e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.729e-04 S  per = 0.0149  per(accum) = 0.0149
 T(sweep oper_env: qops init                    ) = 1.979e-02 S  per =  1.7  per(accum) = 1.72
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.851e-01 S  per = 15.9  per(accum) = 17.7
 T(sweep oper_env: allocate qops on gpu         ) = 1.086e-03 S  per = 0.0935  per(accum) = 17.8
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.242e-02 S  per = 1.93  per(accum) = 19.7
 T(sweep oper_env: rintermediate init           ) = 4.044e-02 S  per = 3.48  per(accum) = 23.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.527e-02 S  per = 4.76  per(accum) = 27.9
 T(sweep oper_env: rmmtasks init                ) = 6.842e-02 S  per = 5.89  per(accum) = 33.8
 T(sweep oper_env: qops memset on cpu           ) = 8.160e-07 S  per = 7.03e-05  per(accum) = 33.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.031e-01 S  per = 60.5  per(accum) = 94.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.819e-04 S  per = 0.0845  per(accum) = 94.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 9.930e-07 S  per = 8.55e-05  per(accum) = 94.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.440e-07 S  per = 6.41e-05  per(accum) = 94.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.416e-03 S  per = 0.294  per(accum) = 94.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.223e-04 S  per = 0.0278  per(accum) = 94.8
 T(sweep oper_env: qops_pool join and erase     ) = 2.623e-02 S  per = 2.26  per(accum) = 97
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.454e-02 S  per = 2.97  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 1.599e+00 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.225,0.202,1.11,0.0571,1.59
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.732e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=7.451e-09GB T[load](info/setup/data/tot)=2.732e-05,1.836e-04,8.311e-06,2.192e-04 speed=3.398e-05GB/S
matrix: Hij size=(1,1)
     -1.161485695499e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.980e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::oper_init_dotL isym=2 ifkr=0 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=1.782e-02MB:1.740e-05GB
fname=./scratch/sweep/lop(0,0) size=1.74e-05GB T[save](info/data/tot)=0.000102,5.23e-05,0.000155 speed=0.112GB/S disk[used]=0.000509GB
----- TIMING FOR ctns::oper_init_dotL : 9.720e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=1 dcut=100 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x3a652de0
qinfo3: site0new sym=(0,0) dir=1,0,1
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=16 size=4:3.05e-05MB
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=274:0.00209MB:2.04e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=323:0.00246MB:2.41e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=2.369e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=0/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-6.706e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=274:2.090e-03MB:2.041e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1:7.629e-06MB:7.451e-09GB
total mem of comb=323:2.464e-03MB:2.407e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=1,18,1
 suppl= 0
 suppr= 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 1
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(2,0)
 fqop[2]=./scratch/sweep/cop(1,0)
qops info: rank=0
 lqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=7:5.34e-05MB:5.22e-08GB
        per(mem): H:14.3 C:0 S:0 P:0 Q:85.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4679:0.0357MB:3.49e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.772e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.878e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,1,4) nnz=1:7.629e-06MB
qtensor3: wf3 own=1 _data=0x463c4ed0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=1 dimAll=1
 (26,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=1 nblocks=16 size=1:7.629e-06MB
### DIAG TIMING: total=2.216e-02 t1=2.607e-05, t2=2.147e-03, t3=2.474e-03, t4=1.747e-02, t5=4.442e-06, t6=3.121e-05, t7=3.275e-06
duration_diagGPU:2.217e-02
duration_diagreduce:4.300e-08
duration_diagtransform:2.400e-07
----- TIMING FOR symbolic_formulae_onedot with size=123 : 1.284e-03 S -----
rank=0 GPUmem(GB): used=3.486e-05 (oper)=3.486e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=123
 no. of hintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.994e-05 S -----
rank=0 GPUmem(GB): used=3.754e-05 (oper,hinter)=3.486e-05,2.682e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.911e-04 S size(H_formulae)=123 size(Hxlst2)=1 T(Hmu/Hxlist)=2.306e-04,6.047e-05 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.009e-04 S size(H_formulae)=123 size(Hxlst)=18 -----
rank=0 GPUmem(GB): used=3.754e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.490e-08 batch[need]=4.023e-07 blksize=1 blksize0=0 batchsize=18
rank=0 GPUmem(GB): used=3.796e-05 (oper,hinter,dvdson,batch)=3.486e-05,2.682e-06,1.490e-08,4.023e-07
ctns::pdvdsonSolver_nkr::solve_iter ndim=1 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.750e-04,2.444e-03,2.967e-02,1.240e-02,4.501e-02
 analyze_tgpu[Hx]: ndim=1:7.451e-09GB T(cpu-gpu)=4.545e-04 speed=3.279e-05GB/S T(nccl)=2.052e-05 speed=7.261e-04GB/S
----- TIMING FOR sigma : t_inter=2.4e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=1 t=2.4e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=0 t=1.8e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=1.2e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.4e+03
 sigma[gemm] counter=1 i=3 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma[gemm] counter=1 i=4 t=7.5e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma[gemm] counter=1 i=5 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.4e+03
 sigma[gemm] counter=1 total t=3.0e-02 per=6.7e+01 cost=4.0e+01 flops=1.3e+03
 sigma[red] counter=1 t=1.2e-02 per=2.8e+01 cost=3.6e+01 flops=2.9e+03
----- TIMING FOR sigma_tot : t_inter=2.4e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma_tot[inter] counter=1 t=2.4e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=0 t=1.8e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=1.2e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.4e+03
 sigma_tot[gemm] counter=1 i=3 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma_tot[gemm] counter=1 i=4 t=7.5e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma_tot[gemm] counter=1 i=5 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.4e+03
 sigma_tot[gemm] counter=1 total t=3.0e-02 per=6.7e+01 cost=4.0e+01 flops=1.3e+03
 sigma_tot[red] counter=1 t=1.2e-02 per=2.8e+01 cost=3.6e+01 flops=2.9e+03
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.2e-05,1.2e-05,4.4e-07,1.7e-07
settings: ndim=1 neig=1 maxcycle=30 nbuff=4 memory=2e-08GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.148569549899 -1.116e+03  0.000e+00    1     1  4.519e-02 4.519e-02 4.512e-02
TIMING FOR Davidson : 4.521e-02  T(cal/comm/rest)=4.512e-02,1.170e-07,9.709e-05
decomposed t_rest=9.709e-05
 T(sub)    =5.525e-05 per=5.691e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =4.390e-07 per=4.522e-01
 T(xnrm2)  =1.389e-06 per=1.431e+00
 T(other)  =4.001e-05 per=4.121e+01
optimized energies: isweep=0 ibond=0 dots=1 e[0]=-116.148569549899 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.572e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=0 mpisize=1
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 1.4e-04 S T(wf/decim)=9.0e-05,4.7e-05 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1352:1.0e-02MB:1.0e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.509e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.418e-03 S -----
rank=0 GPUmem(GB): used=4.756e-05 (oper)=4.488e-05
rank=0 GPUmem(GB): used=4.783e-05 (oper,site)=4.488e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=4.783e-05 (oper,site,rinter)=4.488e-05,2.682e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.733e-03 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=6.990e-04,2.034e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.550e-03 S size(rtasks)=57 size(Rlst)=1636 -----
rank=0 GPUmem(GB): used=4.783e-05 avail=6.176e+00 total=6.176e+00 batch[need]=4.022e-04 blksize=16 blksize0=0 batchsize=1636
rank=0 GPUmem(GB): used=4.501e-04 (oper,site,rinter,batch)=4.488e-05,2.682e-07,0.000e+00,4.022e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.010e-05,2.048e-02,9.849e-03
----- TIMING FOR renorm : t_inter=9.8e-06 t_gemm=2.0e-02 t_reduction=9.8e-03 tot=3.0e-02 -----
 renorm[inter] counter=1 t=9.8e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=1.6e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=1.1e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.1e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=5.5e-03 per=1.8e+01 cost=3.7e+03 flops=6.8e+05
 renorm[gemm] counter=1 i=5 t=7.5e-03 per=2.5e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=1 i=6 t=7.4e-03 per=2.5e+01 cost=1.9e+04 flops=2.5e+06
 renorm[gemm] counter=1 total t=2.0e-02 per=6.8e+01 cost=2.5e+04 flops=1.2e+06
 renorm[red] counter=1 t=9.8e-03 per=3.2e+01 cost=1.9e+04 flops=1.9e+06
----- TIMING FOR renorm_tot : t_inter=9.8e-06 t_gemm=2.0e-02 t_reduction=9.8e-03 tot=3.0e-02 -----
 renorm_tot[inter] counter=1 t=9.8e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=1.6e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=1.1e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.1e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=5.5e-03 per=1.8e+01 cost=3.7e+03 flops=6.8e+05
 renorm_tot[gemm] counter=1 i=5 t=7.5e-03 per=2.5e+01 cost=2.4e+03 flops=3.2e+05
 renorm_tot[gemm] counter=1 i=6 t=7.4e-03 per=2.5e+01 cost=1.9e+04 flops=2.5e+06
 renorm_tot[gemm] counter=1 total t=2.0e-02 per=6.8e+01 cost=2.5e+04 flops=1.2e+06
 renorm_tot[red] counter=1 t=9.8e-03 per=3.2e+01 cost=1.9e+04 flops=1.9e+06
qops.to_cpu: size(tot)=1352:1.0e-02MB:1.0e-05GB T(to_cpu)=6.9e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0475 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.709e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.503e-03 change=-2.200e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.503e-03 change=-1.520e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.410e-01 S #####
 T(local opt: fetch) = 2.177e-02 S  per = 15.4  per(accum) = 15.4
 T(local opt: hdiag) = 2.221e-02 S  per = 15.7  per(accum) = 31.2
 T(local opt: dvdsn) = 4.729e-02 S  per = 33.5  per(accum) = 64.7
 T(local opt: decim) = 1.542e-04 S  per = 0.109  per(accum) = 64.8
 T(local opt: guess) = 6.470e-05 S  per = 0.0459  per(accum) = 64.9
 T(local opt: renrm) = 4.934e-02 S  per =   35  per(accum) = 99.9
 T(local opt: save ) = 2.089e-04 S  per = 0.148  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.729e-02 S  T(sum) = 4.710e-02 S  per = 9.960e+01
 T(local opt: preprocess                  ) = 7.690e-05 S  per = 0.163  per(accum) = 0.163
 T(local opt: symbolic_formulae           ) = 1.293e-03 S  per = 2.75  per(accum) = 2.91
 T(local opt: hintermediate init          ) = 8.187e-05 S  per = 0.174  per(accum) = 3.08
 T(local opt: preprocess_hformulae_Hxlist ) = 3.050e-04 S  per = 0.648  per(accum) = 3.73
 T(local opt: hmmtasks init               ) = 1.251e-04 S  per = 0.266  per(accum) = 4
 T(local opt: initial guess for dvdson    ) = 2.839e-06 S  per = 0.00603  per(accum) = 4
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.464e-02 S  per = 94.8  per(accum) = 98.8
 T(local opt: dvdson [cpu-gpu]            ) = 4.545e-04 S  per = 0.965  per(accum) = 99.8
 T(local opt: dvdson [nccl]               ) = 2.052e-05 S  per = 0.0436  per(accum) = 99.8
 T(local opt: dvdson [mpi]                ) = 1.170e-07 S  per = 0.000248  per(accum) = 99.8
 T(local opt: dvdson [rest part(linalg)]  ) = 9.709e-05 S  per = 0.206  per(accum) = 100
Detailed decomposition of T(renrm) = 4.934e-02 S  T(sum) = 4.934e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.268e-05 S  per = 0.168  per(accum) = 0.168
 T(local opt: qops init                    ) = 7.668e-04 S  per = 1.55  per(accum) = 1.72
 T(local opt: symbolic_formulae_renorm     ) = 1.427e-03 S  per = 2.89  per(accum) = 4.61
 T(local opt: allocate qops on gpu         ) = 5.558e-05 S  per = 0.113  per(accum) = 4.73
 T(local opt: site memcpy cpu2gpu          ) = 1.717e-03 S  per = 3.48  per(accum) = 8.21
 T(local opt: rintermediate init           ) = 2.833e-05 S  per = 0.0574  per(accum) = 8.26
 T(local opt: preprocess_formulae_Rlist2   ) = 3.611e-03 S  per = 7.32  per(accum) = 15.6
 T(local opt: rmmtasks init                ) = 9.310e-03 S  per = 18.9  per(accum) = 34.5
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 5.88e-05  per(accum) = 34.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.043e-02 S  per = 61.7  per(accum) = 96.1
 T(local opt: deallocate cpu and gpu memory) = 7.197e-05 S  per = 0.146  per(accum) = 96.3
 T(local opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 0.000113  per(accum) = 96.3
 T(local opt: reduction of opS & opH [nccl]) = 3.100e-08 S  per = 6.28e-05  per(accum) = 96.3
 T(local opt: qops memcpy gpu2cpu          ) = 7.666e-05 S  per = 0.155  per(accum) = 96.4
 T(local opt: reduction of opS & opH [mpi] ) = 2.519e-05 S  per = 0.0511  per(accum) = 96.5
 T(local opt: qops_pool join and erase     ) = 1.737e-03 S  per = 3.52  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.248e-06 S  per = 0.00456  per(accum) = 100
##### sweep opt: 1.410e-01 S #####
 T(sweep opt: fetch) = 2.177e-02 S  per = 15.4  per(accum) = 15.4
 T(sweep opt: hdiag) = 2.221e-02 S  per = 15.7  per(accum) = 31.2
 T(sweep opt: dvdsn) = 4.729e-02 S  per = 33.5  per(accum) = 64.7
 T(sweep opt: decim) = 1.542e-04 S  per = 0.109  per(accum) = 64.8
 T(sweep opt: guess) = 6.470e-05 S  per = 0.0459  per(accum) = 64.9
 T(sweep opt: renrm) = 4.934e-02 S  per =   35  per(accum) = 99.9
 T(sweep opt: save ) = 2.089e-04 S  per = 0.148  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.729e-02 S  T(sum) = 4.710e-02 S  per = 9.960e+01
 T(sweep opt: preprocess                  ) = 7.690e-05 S  per = 0.163  per(accum) = 0.163
 T(sweep opt: symbolic_formulae           ) = 1.293e-03 S  per = 2.75  per(accum) = 2.91
 T(sweep opt: hintermediate init          ) = 8.187e-05 S  per = 0.174  per(accum) = 3.08
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.050e-04 S  per = 0.648  per(accum) = 3.73
 T(sweep opt: hmmtasks init               ) = 1.251e-04 S  per = 0.266  per(accum) = 4
 T(sweep opt: initial guess for dvdson    ) = 2.839e-06 S  per = 0.00603  per(accum) = 4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.464e-02 S  per = 94.8  per(accum) = 98.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.545e-04 S  per = 0.965  per(accum) = 99.8
 T(sweep opt: dvdson [nccl]               ) = 2.052e-05 S  per = 0.0436  per(accum) = 99.8
 T(sweep opt: dvdson [mpi]                ) = 1.170e-07 S  per = 0.000248  per(accum) = 99.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.709e-05 S  per = 0.206  per(accum) = 100
Detailed decomposition of T(renrm) = 4.934e-02 S  T(sum) = 4.934e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.268e-05 S  per = 0.168  per(accum) = 0.168
 T(sweep opt: qops init                    ) = 7.668e-04 S  per = 1.55  per(accum) = 1.72
 T(sweep opt: symbolic_formulae_renorm     ) = 1.427e-03 S  per = 2.89  per(accum) = 4.61
 T(sweep opt: allocate qops on gpu         ) = 5.558e-05 S  per = 0.113  per(accum) = 4.73
 T(sweep opt: site memcpy cpu2gpu          ) = 1.717e-03 S  per = 3.48  per(accum) = 8.21
 T(sweep opt: rintermediate init           ) = 2.833e-05 S  per = 0.0574  per(accum) = 8.26
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.611e-03 S  per = 7.32  per(accum) = 15.6
 T(sweep opt: rmmtasks init                ) = 9.310e-03 S  per = 18.9  per(accum) = 34.5
 T(sweep opt: qops memset on cpu           ) = 2.900e-08 S  per = 5.88e-05  per(accum) = 34.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.043e-02 S  per = 61.7  per(accum) = 96.1
 T(sweep opt: deallocate cpu and gpu memory) = 7.197e-05 S  per = 0.146  per(accum) = 96.3
 T(sweep opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 0.000113  per(accum) = 96.3
 T(sweep opt: reduction of opS & opH [nccl]) = 3.100e-08 S  per = 6.28e-05  per(accum) = 96.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.666e-05 S  per = 0.155  per(accum) = 96.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.519e-05 S  per = 0.0511  per(accum) = 96.5
 T(sweep opt: qops_pool join and erase     ) = 1.737e-03 S  per = 3.52  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 2.248e-06 S  per = 0.00456  per(accum) = 100
##### global opt: 1.410e-01 S #####
 T(global opt: fetch) = 2.177e-02 S  per = 15.4  per(accum) = 15.4
 T(global opt: hdiag) = 2.221e-02 S  per = 15.7  per(accum) = 31.2
 T(global opt: dvdsn) = 4.729e-02 S  per = 33.5  per(accum) = 64.7
 T(global opt: decim) = 1.542e-04 S  per = 0.109  per(accum) = 64.8
 T(global opt: guess) = 6.470e-05 S  per = 0.0459  per(accum) = 64.9
 T(global opt: renrm) = 4.934e-02 S  per =   35  per(accum) = 99.9
 T(global opt: save ) = 2.089e-04 S  per = 0.148  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.729e-02 S  T(sum) = 4.710e-02 S  per = 9.960e+01
 T(global opt: preprocess                  ) = 7.690e-05 S  per = 0.163  per(accum) = 0.163
 T(global opt: symbolic_formulae           ) = 1.293e-03 S  per = 2.75  per(accum) = 2.91
 T(global opt: hintermediate init          ) = 8.187e-05 S  per = 0.174  per(accum) = 3.08
 T(global opt: preprocess_hformulae_Hxlist ) = 3.050e-04 S  per = 0.648  per(accum) = 3.73
 T(global opt: hmmtasks init               ) = 1.251e-04 S  per = 0.266  per(accum) = 4
 T(global opt: initial guess for dvdson    ) = 2.839e-06 S  per = 0.00603  per(accum) = 4
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.464e-02 S  per = 94.8  per(accum) = 98.8
 T(global opt: dvdson [cpu-gpu]            ) = 4.545e-04 S  per = 0.965  per(accum) = 99.8
 T(global opt: dvdson [nccl]               ) = 2.052e-05 S  per = 0.0436  per(accum) = 99.8
 T(global opt: dvdson [mpi]                ) = 1.170e-07 S  per = 0.000248  per(accum) = 99.8
 T(global opt: dvdson [rest part(linalg)]  ) = 9.709e-05 S  per = 0.206  per(accum) = 100
Detailed decomposition of T(renrm) = 4.934e-02 S  T(sum) = 4.934e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.268e-05 S  per = 0.168  per(accum) = 0.168
 T(global opt: qops init                    ) = 7.668e-04 S  per = 1.55  per(accum) = 1.72
 T(global opt: symbolic_formulae_renorm     ) = 1.427e-03 S  per = 2.89  per(accum) = 4.61
 T(global opt: allocate qops on gpu         ) = 5.558e-05 S  per = 0.113  per(accum) = 4.73
 T(global opt: site memcpy cpu2gpu          ) = 1.717e-03 S  per = 3.48  per(accum) = 8.21
 T(global opt: rintermediate init           ) = 2.833e-05 S  per = 0.0574  per(accum) = 8.26
 T(global opt: preprocess_formulae_Rlist2   ) = 3.611e-03 S  per = 7.32  per(accum) = 15.6
 T(global opt: rmmtasks init                ) = 9.310e-03 S  per = 18.9  per(accum) = 34.5
 T(global opt: qops memset on cpu           ) = 2.900e-08 S  per = 5.88e-05  per(accum) = 34.5
 T(global opt: preprocess_renorm_batchGPU   ) = 3.043e-02 S  per = 61.7  per(accum) = 96.1
 T(global opt: deallocate cpu and gpu memory) = 7.197e-05 S  per = 0.146  per(accum) = 96.3
 T(global opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 0.000113  per(accum) = 96.3
 T(global opt: reduction of opS & opH [nccl]) = 3.100e-08 S  per = 6.28e-05  per(accum) = 96.3
 T(global opt: qops memcpy gpu2cpu          ) = 7.666e-05 S  per = 0.155  per(accum) = 96.4
 T(global opt: reduction of opS & opH [mpi] ) = 2.519e-05 S  per = 0.0511  per(accum) = 96.5
 T(global opt: qops_pool join and erase     ) = 1.737e-03 S  per = 3.52  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 2.248e-06 S  per = 0.00456  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-7.498e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=1/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=309:2.357e-03MB:2.302e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=4:3.052e-05MB:2.980e-08GB
total mem of comb=361:2.754e-03MB:2.690e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=1352:1.031e-02MB:1.007e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
 rqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): H:4.35 C:37 S:6.52 P:0 Q:52.2 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3734:0.0285MB:2.78e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.091e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(16,2,4) nnz=4:3.052e-05MB
qtensor3: wf3 own=1 _data=0x456424a0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=2 dimAll=2
 (25,-1):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=72 size=4:3.052e-05MB
### DIAG TIMING: total=4.220e-02 t1=2.466e-05, t2=2.189e-03, t3=2.488e-03, t4=3.747e-02, t5=5.043e-06, t6=1.444e-05, t7=3.134e-06
duration_diagGPU:4.221e-02
duration_diagreduce:5.700e-08
duration_diagtransform:2.600e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 2.784e-03 S -----
rank=0 GPUmem(GB): used=2.782e-05 (oper)=2.782e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.472e-05 S -----
rank=0 GPUmem(GB): used=3.517e-05 (oper,hinter)=2.782e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.301e-04 S size(H_formulae)=193 size(Hxlst2)=3 T(Hmu/Hxlist)=3.840e-04,3.461e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.540e-04 S size(H_formulae)=193 size(Hxlst)=216 -----
rank=0 GPUmem(GB): used=3.517e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=5.960e-08 batch[need]=9.656e-06 blksize=2 blksize0=1 batchsize=216
rank=0 GPUmem(GB): used=4.488e-05 (oper,hinter,dvdson,batch)=2.782e-05,7.346e-06,5.960e-08,9.656e-06
ctns::pdvdsonSolver_nkr::solve_iter ndim=4 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.390e-03,1.002e-02,2.999e-02,1.238e-02,5.479e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=2.384e-03 speed=2.500e-05GB/S T(nccl)=5.575e-06 speed=1.069e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=2 t=1.0e-02 per=1.9e+01 cost=1.1e+03 flops=1.1e+05
 sigma[gemm] counter=2 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=7.6e-03 per=1.4e+01 cost=2.2e+02 flops=2.9e+04
 sigma[gemm] counter=2 i=3 t=7.6e-03 per=1.4e+01 cost=1.9e+02 flops=2.5e+04
 sigma[gemm] counter=2 i=4 t=7.4e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=2 i=5 t=7.4e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=2 total t=3.0e-02 per=5.7e+01 cost=9.9e+02 flops=3.3e+04
 sigma[red] counter=2 t=1.2e-02 per=2.4e+01 cost=5.6e+02 flops=4.5e+04
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.0e-02 t_reduction=2.5e-02 tot=9.7e-02 -----
 sigma_tot[inter] counter=2 t=1.2e-02 per=1.3e+01 cost=1.1e+03 flops=8.7e+04
 sigma_tot[gemm] counter=2 i=0 t=3.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=2.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=1.5e-02 per=1.5e+01 cost=2.3e+02 flops=1.6e+04
 sigma_tot[gemm] counter=2 i=3 t=1.5e-02 per=1.5e+01 cost=2.0e+02 flops=1.3e+04
 sigma_tot[gemm] counter=2 i=4 t=1.5e-02 per=1.5e+01 cost=3.0e+02 flops=2.0e+04
 sigma_tot[gemm] counter=2 i=5 t=1.5e-02 per=1.5e+01 cost=3.0e+02 flops=2.0e+04
 sigma_tot[gemm] counter=2 total t=6.0e-02 per=6.2e+01 cost=1.0e+03 flops=1.7e+04
 sigma_tot[red] counter=2 t=2.5e-02 per=2.6e+01 cost=5.9e+02 flops=2.4e+04
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.4e-06,2.0e-06,2.3e-06,1.5e-07
settings: ndim=4 neig=1 maxcycle=30 nbuff=4 memory=4e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.148569549899 -1.116e+03  5.980e-02    1     1  5.490e-02 5.490e-02 5.488e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.939e-03,9.963e-03,3.004e-02,1.247e-02,5.442e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=1.932e-03 speed=3.086e-05GB/S T(nccl)=6.909e-06 speed=8.627e-03GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=3 t=1.0e-02 per=1.9e+01 cost=1.1e+03 flops=1.1e+05
 sigma[gemm] counter=3 i=0 t=2.0e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=1.7e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=7.5e-03 per=1.4e+01 cost=2.2e+02 flops=2.9e+04
 sigma[gemm] counter=3 i=3 t=7.6e-03 per=1.4e+01 cost=1.9e+02 flops=2.5e+04
 sigma[gemm] counter=3 i=4 t=7.5e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=3 i=5 t=7.5e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=3 total t=3.0e-02 per=5.7e+01 cost=9.9e+02 flops=3.3e+04
 sigma[red] counter=3 t=1.2e-02 per=2.4e+01 cost=5.6e+02 flops=4.5e+04
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=9.0e-02 t_reduction=3.7e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=3 t=2.2e-02 per=1.5e+01 cost=2.2e+03 flops=9.7e+04
 sigma_tot[gemm] counter=3 i=0 t=5.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=4.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=2.3e-02 per=1.5e+01 cost=4.5e+02 flops=2.0e+04
 sigma_tot[gemm] counter=3 i=3 t=2.3e-02 per=1.5e+01 cost=3.9e+02 flops=1.7e+04
 sigma_tot[gemm] counter=3 i=4 t=2.2e-02 per=1.5e+01 cost=5.9e+02 flops=2.7e+04
 sigma_tot[gemm] counter=3 i=5 t=2.2e-02 per=1.5e+01 cost=5.9e+02 flops=2.7e+04
 sigma_tot[gemm] counter=3 total t=9.0e-02 per=6.0e+01 cost=2.0e+03 flops=2.3e+04
 sigma_tot[red] counter=3 t=3.7e-02 per=2.5e+01 cost=1.1e+03 flops=3.1e+04
T(sub)=9.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-05,5.3e-05,4.0e-06,1.4e-06,1.7e-07
    2   0 -    -116.178903884613 -3.033e-02  3.333e-03    2     2  1.226e-01 6.129e-02 5.470e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.515e-03,1.009e-02,3.020e-02,1.255e-02,5.436e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=1.507e-03 speed=3.954e-05GB/S T(nccl)=7.307e-06 speed=8.157e-03GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=4 t=1.0e-02 per=1.9e+01 cost=1.1e+03 flops=1.1e+05
 sigma[gemm] counter=4 i=0 t=2.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=1.7e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=7.5e-03 per=1.4e+01 cost=2.2e+02 flops=3.0e+04
 sigma[gemm] counter=4 i=3 t=7.5e-03 per=1.4e+01 cost=1.9e+02 flops=2.5e+04
 sigma[gemm] counter=4 i=4 t=7.6e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=4 i=5 t=7.6e-03 per=1.4e+01 cost=2.9e+02 flops=3.8e+04
 sigma[gemm] counter=4 total t=3.0e-02 per=5.7e+01 cost=9.9e+02 flops=3.3e+04
 sigma[red] counter=4 t=1.3e-02 per=2.4e+01 cost=5.6e+02 flops=4.4e+04
----- TIMING FOR sigma_tot : t_inter=3.3e-02 t_gemm=1.2e-01 t_reduction=5.0e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=4 t=3.3e-02 per=1.6e+01 cost=3.3e+03 flops=1.0e+05
 sigma_tot[gemm] counter=4 i=0 t=7.3e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=5.7e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=3.0e-02 per=1.5e+01 cost=6.8e+02 flops=2.3e+04
 sigma_tot[gemm] counter=4 i=3 t=3.0e-02 per=1.5e+01 cost=5.7e+02 flops=1.9e+04
 sigma_tot[gemm] counter=4 i=4 t=3.0e-02 per=1.5e+01 cost=8.9e+02 flops=3.0e+04
 sigma_tot[gemm] counter=4 i=5 t=3.0e-02 per=1.5e+01 cost=8.9e+02 flops=3.0e+04
 sigma_tot[gemm] counter=4 total t=1.2e-01 per=5.9e+01 cost=3.0e+03 flops=2.5e+04
 sigma_tot[red] counter=4 t=5.0e-02 per=2.5e+01 cost=1.7e+03 flops=3.4e+04
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,3.2e-05,3.3e-06,1.2e-06,2.1e-07
    3   0 +    -116.178979049791 -7.517e-05  3.004e-07    3     3  1.904e-01 6.348e-02 5.462e-02
TIMING FOR Davidson : 1.905e-01  T(cal/comm/rest)=1.639e-01,3.800e-07,2.659e-02
decomposed t_rest=2.659e-02
 T(sub)    =1.482e-04 per=5.574e-01
 T(precond)=2.635e-02 per=9.908e+01
 T(ortho)  =1.932e-05 per=7.266e-02
 T(xcopy)  =6.460e-07 per=2.429e-03
 T(xnrm2)  =1.524e-06 per=5.731e-03
 T(other)  =7.415e-05 per=2.788e-01
optimized energies: isweep=0 ibond=1 dots=1 e[0]=-116.178979049791 nmvp=3
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.025e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=0 mpisize=1
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 1.7e-04 S T(wf/decim)=7.5e-05,9.3e-05 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=21970:1.7e-01MB:1.6e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.974e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.070e-03 S -----
rank=0 GPUmem(GB): used=1.985e-04 (oper)=1.912e-04
rank=0 GPUmem(GB): used=2.015e-04 (oper,site)=1.912e-04,2.980e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:5.684e-03MB:5.551e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.478e-03 S -----
rank=0 GPUmem(GB): used=2.070e-04 (oper,site,rinter)=1.912e-04,2.980e-06,5.551e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.274e-03 S size(rtasks)=77 size(Rlst2)=256 T(Rmu/Rlist)=1.179e-03,7.095e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.260e-03 S size(rtasks)=77 size(Rlst)=6692 -----
rank=0 GPUmem(GB): used=2.070e-04 avail=6.176e+00 total=6.176e+00 batch[need]=8.925e-03 blksize=81 blksize0=16 batchsize=6692
rank=0 GPUmem(GB): used=9.132e-03 (oper,site,rinter,batch)=1.912e-04,2.980e-06,5.551e-06,8.925e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.030e-03,2.275e-02,1.004e-02
----- TIMING FOR renorm : t_inter=7.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=2 t=7.0e-03 per=1.8e+01 cost=8.5e+04 flops=1.2e+07
 renorm[gemm] counter=2 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=7.6e-03 per=1.9e+01 cost=1.7e+05 flops=2.3e+07
 renorm[gemm] counter=2 i=5 t=7.6e-03 per=1.9e+01 cost=1.5e+05 flops=2.0e+07
 renorm[gemm] counter=2 i=6 t=7.6e-03 per=1.9e+01 cost=1.2e+06 flops=1.6e+08
 renorm[gemm] counter=2 total t=2.3e-02 per=5.7e+01 cost=1.5e+06 flops=6.6e+07
 renorm[red] counter=2 t=1.0e-02 per=2.5e+01 cost=5.3e+05 flops=5.3e+07
----- TIMING FOR renorm_tot : t_inter=7.0e-03 t_gemm=4.3e-02 t_reduction=2.0e-02 tot=7.0e-02 -----
 renorm_tot[inter] counter=2 t=7.0e-03 per=1.0e+01 cost=8.5e+04 flops=1.2e+07
 renorm_tot[gemm] counter=2 i=0 t=2.9e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=2.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=2.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=2.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=1.3e-02 per=1.9e+01 cost=1.8e+05 flops=1.3e+07
 renorm_tot[gemm] counter=2 i=5 t=1.5e-02 per=2.2e+01 cost=1.6e+05 flops=1.0e+07
 renorm_tot[gemm] counter=2 i=6 t=1.5e-02 per=2.1e+01 cost=1.2e+06 flops=8.0e+07
 renorm_tot[gemm] counter=2 total t=4.3e-02 per=6.2e+01 cost=1.5e+06 flops=3.5e+07
 renorm_tot[red] counter=2 t=2.0e-02 per=2.8e+01 cost=5.5e+05 flops=2.8e+07
qops.to_cpu: size(tot)=21970:1.7e-01MB:1.6e-04GB T(to_cpu)=1.4e-04S speed=1.2e+00GB/S
check ||H-H.dagger||=1.178e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.107 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.304e-03 change=1.868e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.754e-03 change=-2.683e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.754e-03 change=-6.437e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 3.562e-01 S #####
 T(local opt: fetch) = 1.011e-02 S  per = 2.84  per(accum) = 2.84
 T(local opt: hdiag) = 4.225e-02 S  per = 11.9  per(accum) = 14.7
 T(local opt: dvdsn) = 1.953e-01 S  per = 54.8  per(accum) = 69.5
 T(local opt: decim) = 1.758e-04 S  per = 0.0493  per(accum) = 69.6
 T(local opt: guess) = 1.145e-04 S  per = 0.0321  per(accum) = 69.6
 T(local opt: renrm) = 1.079e-01 S  per = 30.3  per(accum) = 99.9
 T(local opt: save ) = 3.086e-04 S  per = 0.0866  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.953e-01 S  T(sum) = 1.952e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 1.453e-04 S  per = 0.0744  per(accum) = 0.0744
 T(local opt: symbolic_formulae           ) = 2.793e-03 S  per = 1.43  per(accum) = 1.51
 T(local opt: hintermediate init          ) = 9.905e-05 S  per = 0.0508  per(accum) = 1.56
 T(local opt: preprocess_hformulae_Hxlist ) = 7.636e-04 S  per = 0.391  per(accum) = 1.95
 T(local opt: hmmtasks init               ) = 9.037e-04 S  per = 0.463  per(accum) = 2.41
 T(local opt: initial guess for dvdson    ) = 5.138e-06 S  per = 0.00263  per(accum) = 2.41
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.580e-01 S  per =   81  per(accum) = 83.4
 T(local opt: dvdson [cpu-gpu]            ) = 5.823e-03 S  per = 2.98  per(accum) = 86.4
 T(local opt: dvdson [nccl]               ) = 1.979e-05 S  per = 0.0101  per(accum) = 86.4
 T(local opt: dvdson [mpi]                ) = 3.800e-07 S  per = 0.000195  per(accum) = 86.4
 T(local opt: dvdson [rest part(linalg)]  ) = 2.659e-02 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 1.079e-01 S  T(sum) = 1.079e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.391e-04 S  per = 0.129  per(accum) = 0.129
 T(local opt: qops init                    ) = 1.909e-03 S  per = 1.77  per(accum) = 1.9
 T(local opt: symbolic_formulae_renorm     ) = 3.080e-03 S  per = 2.85  per(accum) = 4.75
 T(local opt: allocate qops on gpu         ) = 5.236e-05 S  per = 0.0485  per(accum) = 4.8
 T(local opt: site memcpy cpu2gpu          ) = 9.056e-04 S  per = 0.839  per(accum) = 5.64
 T(local opt: rintermediate init           ) = 2.491e-03 S  per = 2.31  per(accum) = 7.95
 T(local opt: preprocess_formulae_Rlist2   ) = 9.619e-03 S  per = 8.92  per(accum) = 16.9
 T(local opt: rmmtasks init                ) = 4.800e-02 S  per = 44.5  per(accum) = 61.4
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 3.71e-05  per(accum) = 61.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.991e-02 S  per =   37  per(accum) = 98.3
 T(local opt: deallocate cpu and gpu memory) = 4.906e-04 S  per = 0.455  per(accum) = 98.8
 T(local opt: construct opS [ifdists=true] ) = 6.000e-08 S  per = 5.56e-05  per(accum) = 98.8
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 3.34e-05  per(accum) = 98.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.507e-04 S  per = 0.14  per(accum) = 98.9
 T(local opt: reduction of opS & opH [mpi] ) = 5.144e-05 S  per = 0.0477  per(accum) = 99
 T(local opt: qops_pool join and erase     ) = 1.086e-03 S  per = 1.01  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.897e-06 S  per = 0.00176  per(accum) = 100
##### sweep opt: 4.972e-01 S #####
 T(sweep opt: fetch) = 3.188e-02 S  per = 6.41  per(accum) = 6.41
 T(sweep opt: hdiag) = 6.446e-02 S  per =   13  per(accum) = 19.4
 T(sweep opt: dvdsn) = 2.426e-01 S  per = 48.8  per(accum) = 68.2
 T(sweep opt: decim) = 3.300e-04 S  per = 0.0664  per(accum) = 68.2
 T(sweep opt: guess) = 1.792e-04 S  per = 0.036  per(accum) = 68.3
 T(sweep opt: renrm) = 1.572e-01 S  per = 31.6  per(accum) = 99.9
 T(sweep opt: save ) = 5.174e-04 S  per = 0.104  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.426e-01 S  T(sum) = 2.423e-01 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 2.222e-04 S  per = 0.0917  per(accum) = 0.0917
 T(sweep opt: symbolic_formulae           ) = 4.086e-03 S  per = 1.69  per(accum) = 1.78
 T(sweep opt: hintermediate init          ) = 1.809e-04 S  per = 0.0747  per(accum) = 1.85
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.069e-03 S  per = 0.441  per(accum) = 2.29
 T(sweep opt: hmmtasks init               ) = 1.029e-03 S  per = 0.425  per(accum) = 2.72
 T(sweep opt: initial guess for dvdson    ) = 7.977e-06 S  per = 0.00329  per(accum) = 2.72
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.027e-01 S  per = 83.7  per(accum) = 86.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.278e-03 S  per = 2.59  per(accum) = 89
 T(sweep opt: dvdson [nccl]               ) = 4.031e-05 S  per = 0.0166  per(accum) = 89
 T(sweep opt: dvdson [mpi]                ) = 4.970e-07 S  per = 0.000205  per(accum) = 89
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.669e-02 S  per =   11  per(accum) = 100
Detailed decomposition of T(renrm) = 1.572e-01 S  T(sum) = 1.572e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.218e-04 S  per = 0.141  per(accum) = 0.141
 T(sweep opt: qops init                    ) = 2.676e-03 S  per =  1.7  per(accum) = 1.84
 T(sweep opt: symbolic_formulae_renorm     ) = 4.507e-03 S  per = 2.87  per(accum) = 4.71
 T(sweep opt: allocate qops on gpu         ) = 1.079e-04 S  per = 0.0686  per(accum) = 4.78
 T(sweep opt: site memcpy cpu2gpu          ) = 2.622e-03 S  per = 1.67  per(accum) = 6.45
 T(sweep opt: rintermediate init           ) = 2.519e-03 S  per =  1.6  per(accum) = 8.05
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.323e-02 S  per = 8.41  per(accum) = 16.5
 T(sweep opt: rmmtasks init                ) = 5.731e-02 S  per = 36.5  per(accum) = 52.9
 T(sweep opt: qops memset on cpu           ) = 6.900e-08 S  per = 4.39e-05  per(accum) = 52.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.034e-02 S  per = 44.7  per(accum) = 97.7
 T(sweep opt: deallocate cpu and gpu memory) = 5.626e-04 S  per = 0.358  per(accum) = 98
 T(sweep opt: construct opS [ifdists=true] ) = 1.160e-07 S  per = 7.38e-05  per(accum) = 98
 T(sweep opt: reduction of opS & opH [nccl]) = 6.700e-08 S  per = 4.26e-05  per(accum) = 98
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.273e-04 S  per = 0.145  per(accum) = 98.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.663e-05 S  per = 0.0487  per(accum) = 98.2
 T(sweep opt: qops_pool join and erase     ) = 2.823e-03 S  per =  1.8  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 4.145e-06 S  per = 0.00264  per(accum) = 100
##### global opt: 4.972e-01 S #####
 T(global opt: fetch) = 3.188e-02 S  per = 6.41  per(accum) = 6.41
 T(global opt: hdiag) = 6.446e-02 S  per =   13  per(accum) = 19.4
 T(global opt: dvdsn) = 2.426e-01 S  per = 48.8  per(accum) = 68.2
 T(global opt: decim) = 3.300e-04 S  per = 0.0664  per(accum) = 68.2
 T(global opt: guess) = 1.792e-04 S  per = 0.036  per(accum) = 68.3
 T(global opt: renrm) = 1.572e-01 S  per = 31.6  per(accum) = 99.9
 T(global opt: save ) = 5.174e-04 S  per = 0.104  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.426e-01 S  T(sum) = 2.423e-01 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 2.222e-04 S  per = 0.0917  per(accum) = 0.0917
 T(global opt: symbolic_formulae           ) = 4.086e-03 S  per = 1.69  per(accum) = 1.78
 T(global opt: hintermediate init          ) = 1.809e-04 S  per = 0.0747  per(accum) = 1.85
 T(global opt: preprocess_hformulae_Hxlist ) = 1.069e-03 S  per = 0.441  per(accum) = 2.29
 T(global opt: hmmtasks init               ) = 1.029e-03 S  per = 0.425  per(accum) = 2.72
 T(global opt: initial guess for dvdson    ) = 7.977e-06 S  per = 0.00329  per(accum) = 2.72
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.027e-01 S  per = 83.7  per(accum) = 86.4
 T(global opt: dvdson [cpu-gpu]            ) = 6.278e-03 S  per = 2.59  per(accum) = 89
 T(global opt: dvdson [nccl]               ) = 4.031e-05 S  per = 0.0166  per(accum) = 89
 T(global opt: dvdson [mpi]                ) = 4.970e-07 S  per = 0.000205  per(accum) = 89
 T(global opt: dvdson [rest part(linalg)]  ) = 2.669e-02 S  per =   11  per(accum) = 100
Detailed decomposition of T(renrm) = 1.572e-01 S  T(sum) = 1.572e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.218e-04 S  per = 0.141  per(accum) = 0.141
 T(global opt: qops init                    ) = 2.676e-03 S  per =  1.7  per(accum) = 1.84
 T(global opt: symbolic_formulae_renorm     ) = 4.507e-03 S  per = 2.87  per(accum) = 4.71
 T(global opt: allocate qops on gpu         ) = 1.079e-04 S  per = 0.0686  per(accum) = 4.78
 T(global opt: site memcpy cpu2gpu          ) = 2.622e-03 S  per = 1.67  per(accum) = 6.45
 T(global opt: rintermediate init           ) = 2.519e-03 S  per =  1.6  per(accum) = 8.05
 T(global opt: preprocess_formulae_Rlist2   ) = 1.323e-02 S  per = 8.41  per(accum) = 16.5
 T(global opt: rmmtasks init                ) = 5.731e-02 S  per = 36.5  per(accum) = 52.9
 T(global opt: qops memset on cpu           ) = 6.900e-08 S  per = 4.39e-05  per(accum) = 52.9
 T(global opt: preprocess_renorm_batchGPU   ) = 7.034e-02 S  per = 44.7  per(accum) = 97.7
 T(global opt: deallocate cpu and gpu memory) = 5.626e-04 S  per = 0.358  per(accum) = 98
 T(global opt: construct opS [ifdists=true] ) = 1.160e-07 S  per = 7.38e-05  per(accum) = 98
 T(global opt: reduction of opS & opH [nccl]) = 6.700e-08 S  per = 4.26e-05  per(accum) = 98
 T(global opt: qops memcpy gpu2cpu          ) = 2.273e-04 S  per = 0.145  per(accum) = 98.2
 T(global opt: reduction of opS & opH [mpi] ) = 7.663e-05 S  per = 0.0487  per(accum) = 98.2
 T(global opt: qops_pool join and erase     ) = 2.823e-03 S  per =  1.8  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 4.145e-06 S  per = 0.00264  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.985e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=2/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=707:5.394e-03MB:5.268e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=769:5.867e-03MB:5.729e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=21970:1.676e-01MB:1.637e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
 rqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=24451:0.187MB:0.000182GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(64,3,4) nnz=14:1.068e-04MB
qtensor3: wf3 own=1 _data=0x44fc8ee0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=2 dimAll=3
 (23,-1):2 (24,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=128 size=14:1.068e-04MB
### DIAG TIMING: total=7.179e-02 t1=2.534e-05, t2=2.220e-03, t3=2.515e-03, t4=6.701e-02, t5=4.766e-06, t6=1.476e-05, t7=3.604e-06
duration_diagGPU:7.181e-02
duration_diagreduce:4.300e-08
duration_diagtransform:4.270e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 4.898e-03 S -----
rank=0 GPUmem(GB): used=1.822e-04 (oper)=1.822e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.250e-04 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper,hinter)=1.822e-04,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.254e-03 S size(H_formulae)=297 size(Hxlst2)=4 T(Hmu/Hxlist)=6.330e-04,6.209e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.330e-03 S size(H_formulae)=297 size(Hxlst)=438 -----
rank=0 GPUmem(GB): used=1.958e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.086e-07 batch[need]=4.895e-05 blksize=6 blksize0=2 batchsize=438
rank=0 GPUmem(GB): used=2.449e-04 (oper,hinter,dvdson,batch)=1.822e-04,1.359e-05,2.086e-07,4.895e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=14 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.214e-04,1.001e-02,2.954e-02,1.254e-02,5.282e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=7.157e-04 speed=2.915e-04GB/S T(nccl)=5.753e-06 speed=3.626e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=5 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=5 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=5 i=3 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=5 i=4 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.1e+05
 sigma[gemm] counter=5 i=5 t=7.4e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=5 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=5 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=4.3e-02 t_gemm=1.5e-01 t_reduction=6.2e-02 tot=2.5e-01 -----
 sigma_tot[inter] counter=5 t=4.3e-02 per=1.7e+01 cost=7.9e+03 flops=1.9e+05
 sigma_tot[gemm] counter=5 i=0 t=8.6e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=7.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=3.7e-02 per=1.5e+01 cost=2.4e+03 flops=6.5e+04
 sigma_tot[gemm] counter=5 i=3 t=3.7e-02 per=1.5e+01 cost=2.2e+03 flops=5.9e+04
 sigma_tot[gemm] counter=5 i=4 t=3.7e-02 per=1.5e+01 cost=4.6e+03 flops=1.2e+05
 sigma_tot[gemm] counter=5 i=5 t=3.7e-02 per=1.5e+01 cost=4.5e+03 flops=1.2e+05
 sigma_tot[gemm] counter=5 total t=1.5e-01 per=5.9e+01 cost=1.4e+04 flops=9.2e+04
 sigma_tot[red] counter=5 t=6.2e-02 per=2.5e+01 cost=4.9e+03 flops=7.9e+04
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,4.7e-06,2.0e-06,8.3e-07,1.9e-07
settings: ndim=14 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.178979049791 -1.116e+03  6.213e-02    1     1  5.294e-02 5.294e-02 5.291e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.698e-03,9.916e-03,3.003e-02,1.229e-02,5.394e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.693e-03 speed=1.232e-04GB/S T(nccl)=5.212e-06 speed=4.003e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=6 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=6 i=0 t=2.0e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=6 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=6 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=6 i=5 t=7.4e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=6 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=6 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=5.2e-02 t_gemm=1.8e-01 t_reduction=7.5e-02 tot=3.1e-01 -----
 sigma_tot[inter] counter=6 t=5.2e-02 per=1.7e+01 cost=1.2e+04 flops=2.4e+05
 sigma_tot[gemm] counter=6 i=0 t=1.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=8.7e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=4.5e-02 per=1.5e+01 cost=4.2e+03 flops=9.3e+04
 sigma_tot[gemm] counter=6 i=3 t=4.5e-02 per=1.5e+01 cost=3.9e+03 flops=8.6e+04
 sigma_tot[gemm] counter=6 i=4 t=4.5e-02 per=1.5e+01 cost=8.4e+03 flops=1.9e+05
 sigma_tot[gemm] counter=6 i=5 t=4.5e-02 per=1.5e+01 cost=8.0e+03 flops=1.8e+05
 sigma_tot[gemm] counter=6 total t=1.8e-01 per=5.9e+01 cost=2.4e+04 flops=1.4e+05
 sigma_tot[red] counter=6 t=7.5e-02 per=2.4e+01 cost=8.2e+03 flops=1.1e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.4e-05,3.5e-06,1.2e-06,1.8e-07
    2   0 -    -116.200644405681 -2.167e-02  1.866e-02    2     2  1.119e-01 5.593e-02 5.347e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.234e-04,9.920e-03,2.992e-02,1.252e-02,5.289e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=5.178e-04 speed=4.029e-04GB/S T(nccl)=5.588e-06 speed=3.733e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=7 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=7 i=0 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=7 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=7 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=7 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=7 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=7 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=6.2e-02 t_gemm=2.1e-01 t_reduction=8.7e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=7 t=6.2e-02 per=1.7e+01 cost=1.7e+04 flops=2.7e+05
 sigma_tot[gemm] counter=7 i=0 t=1.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=1.0e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=5.2e-02 per=1.5e+01 cost=5.9e+03 flops=1.1e+05
 sigma_tot[gemm] counter=7 i=3 t=5.2e-02 per=1.5e+01 cost=5.5e+03 flops=1.1e+05
 sigma_tot[gemm] counter=7 i=4 t=5.2e-02 per=1.5e+01 cost=1.2e+04 flops=2.3e+05
 sigma_tot[gemm] counter=7 i=5 t=5.2e-02 per=1.5e+01 cost=1.2e+04 flops=2.2e+05
 sigma_tot[gemm] counter=7 total t=2.1e-01 per=5.8e+01 cost=3.5e+04 flops=1.7e+05
 sigma_tot[red] counter=7 t=8.7e-02 per=2.4e+01 cost=1.1e+04 flops=1.3e+05
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.8e-05,3.1e-06,1.1e-06,2.5e-07
    3   0 -    -116.201758145098 -1.114e-03  2.853e-03    3     3  1.772e-01 5.905e-02 5.331e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.314e-03,9.977e-03,2.980e-02,1.252e-02,5.362e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.309e-03 speed=1.594e-04GB/S T(nccl)=5.454e-06 speed=3.825e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=8 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=8 i=0 t=2.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=8 i=3 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=8 i=4 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=8 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=8 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=8 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=7.2e-02 t_gemm=2.4e-01 t_reduction=1.0e-01 tot=4.1e-01 -----
 sigma_tot[inter] counter=8 t=7.2e-02 per=1.8e+01 cost=2.2e+04 flops=3.0e+05
 sigma_tot[gemm] counter=8 i=0 t=1.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=1.2e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=6.0e-02 per=1.5e+01 cost=7.7e+03 flops=1.3e+05
 sigma_tot[gemm] counter=8 i=3 t=6.0e-02 per=1.5e+01 cost=7.2e+03 flops=1.2e+05
 sigma_tot[gemm] counter=8 i=4 t=6.0e-02 per=1.5e+01 cost=1.6e+04 flops=2.7e+05
 sigma_tot[gemm] counter=8 i=5 t=6.0e-02 per=1.5e+01 cost=1.5e+04 flops=2.5e+05
 sigma_tot[gemm] counter=8 total t=2.4e-01 per=5.8e+01 cost=4.6e+04 flops=1.9e+05
 sigma_tot[red] counter=8 t=1.0e-01 per=2.4e+01 cost=1.5e+04 flops=1.5e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.1e-06,1.1e-06,2.2e-07
    4   0 -    -116.201797957106 -3.981e-05  6.831e-04    3     4  2.425e-01 6.062e-02 5.341e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.245e-03,1.005e-02,2.996e-02,1.268e-02,5.494e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.238e-03 speed=9.323e-05GB/S T(nccl)=6.851e-06 speed=3.045e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=9 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=9 i=0 t=1.9e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=9 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=9 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=9 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=9 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=9 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.2e-02 t_gemm=2.7e-01 t_reduction=1.1e-01 tot=4.6e-01 -----
 sigma_tot[inter] counter=9 t=8.2e-02 per=1.8e+01 cost=2.6e+04 flops=3.2e+05
 sigma_tot[gemm] counter=9 i=0 t=1.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=1.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=6.7e-02 per=1.4e+01 cost=9.5e+03 flops=1.4e+05
 sigma_tot[gemm] counter=9 i=3 t=6.7e-02 per=1.5e+01 cost=8.8e+03 flops=1.3e+05
 sigma_tot[gemm] counter=9 i=4 t=6.7e-02 per=1.4e+01 cost=2.0e+04 flops=2.9e+05
 sigma_tot[gemm] counter=9 i=5 t=6.7e-02 per=1.5e+01 cost=1.9e+04 flops=2.8e+05
 sigma_tot[gemm] counter=9 total t=2.7e-01 per=5.8e+01 cost=5.7e+04 flops=2.1e+05
 sigma_tot[red] counter=9 t=1.1e-01 per=2.4e+01 cost=1.8e+04 flops=1.6e+05
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.6e-05,3.4e-06,1.3e-06,2.4e-07
    5   0 -    -116.201799666704 -1.710e-06  1.803e-04    3     5  3.103e-01 6.206e-02 5.374e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.854e-04,1.002e-02,3.012e-02,1.247e-02,5.360e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=9.798e-04 speed=2.129e-04GB/S T(nccl)=5.635e-06 speed=3.702e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=10 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=10 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=10 i=3 t=7.6e-03 per=1.5e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=10 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=10 i=5 t=7.4e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=10 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=10 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=9.2e-02 t_gemm=3.0e-01 t_reduction=1.2e-01 tot=5.2e-01 -----
 sigma_tot[inter] counter=10 t=9.2e-02 per=1.8e+01 cost=3.1e+04 flops=3.3e+05
 sigma_tot[gemm] counter=10 i=0 t=1.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=1.5e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=7.5e-02 per=1.4e+01 cost=1.1e+04 flops=1.5e+05
 sigma_tot[gemm] counter=10 i=3 t=7.5e-02 per=1.5e+01 cost=1.0e+04 flops=1.4e+05
 sigma_tot[gemm] counter=10 i=4 t=7.5e-02 per=1.4e+01 cost=2.3e+04 flops=3.1e+05
 sigma_tot[gemm] counter=10 i=5 t=7.5e-02 per=1.4e+01 cost=2.2e+04 flops=3.0e+05
 sigma_tot[gemm] counter=10 total t=3.0e-01 per=5.8e+01 cost=6.7e+04 flops=2.3e+05
 sigma_tot[red] counter=10 t=1.2e-01 per=2.4e+01 cost=2.1e+04 flops=1.7e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.1e-06,1.1e-06,2.3e-07
    6   0 +    -116.201799839537 -1.728e-07  3.861e-05    3     6  3.759e-01 6.265e-02 5.373e-02
TIMING FOR Davidson : 3.759e-01  T(cal/comm/rest)=3.224e-01,6.500e-07,5.352e-02
decomposed t_rest=5.352e-02
 T(sub)    =1.342e-04 per=2.508e-01
 T(precond)=5.318e-02 per=9.936e+01
 T(ortho)  =4.998e-05 per=9.339e-02
 T(xcopy)  =9.100e-07 per=1.700e-03
 T(xnrm2)  =3.436e-06 per=6.420e-03
 T(other)  =1.541e-04 per=2.880e-01
optimized energies: isweep=0 ibond=2 dots=1 e[0]=-116.201799839537 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.490e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=1.4e-05
timing for compute=1.1e-02
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-05,1.1e-02,0.0e+00,5.4e-06,1.5e-05 -----
decimation summary: 256->3 dwt=+1.110e-16 SvN=3.282e-01
 qbond: qkept nsym=2 dimAll=3
 (7,1):2 (6,2):1
----- TIMING for decimation_row(nkr): 1.171e-02 S T(decim/select/formRot)=1.145e-02,2.353e-04,2.627e-05 -----
----- TIMING FOR onedot_decimation: 1.185e-02 S T(wf/decim)=1.211e-04,1.173e-02 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.479e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 5.431e-03 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper)=1.822e-04
rank=0 GPUmem(GB): used=1.959e-04 (oper,site)=1.822e-04,1.043e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:1.442e-02MB:1.408e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.496e-03 S -----
rank=0 GPUmem(GB): used=2.099e-04 (oper,site,rinter)=1.822e-04,1.043e-07,1.408e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.027e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.458e-03,5.692e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.069e-03 S size(rtasks)=105 size(Rlst)=267 -----
rank=0 GPUmem(GB): used=2.099e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.376e-05 blksize=6 blksize0=9 batchsize=267
rank=0 GPUmem(GB): used=2.537e-04 (oper,site,rinter,batch)=1.822e-04,1.043e-07,1.408e-05,4.376e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.403e-03,2.287e-02,1.004e-02
----- TIMING FOR renorm : t_inter=6.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=3 t=6.4e-03 per=1.6e+01 cost=1.4e+04 flops=2.1e+06
 renorm[gemm] counter=3 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=7.6e-03 per=1.9e+01 cost=2.6e+03 flops=3.4e+05
 renorm[gemm] counter=3 i=5 t=7.6e-03 per=1.9e+01 cost=2.9e+03 flops=3.8e+05
 renorm[gemm] counter=3 i=6 t=7.7e-03 per=1.9e+01 cost=3.1e+03 flops=4.0e+05
 renorm[gemm] counter=3 total t=2.3e-02 per=5.8e+01 cost=8.5e+03 flops=3.7e+05
 renorm[red] counter=3 t=1.0e-02 per=2.6e+01 cost=1.2e+03 flops=1.2e+05
----- TIMING FOR renorm_tot : t_inter=1.3e-02 t_gemm=6.6e-02 t_reduction=3.0e-02 tot=1.1e-01 -----
 renorm_tot[inter] counter=3 t=1.3e-02 per=1.2e+01 cost=9.8e+04 flops=7.3e+06
 renorm_tot[gemm] counter=3 i=0 t=4.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=3.6e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=3.4e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=3.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=2.1e-02 per=1.9e+01 cost=1.8e+05 flops=8.7e+06
 renorm_tot[gemm] counter=3 i=5 t=2.3e-02 per=2.1e+01 cost=1.6e+05 flops=7.0e+06
 renorm_tot[gemm] counter=3 i=6 t=2.3e-02 per=2.1e+01 cost=1.2e+06 flops=5.3e+07
 renorm_tot[gemm] counter=3 total t=6.6e-02 per=6.0e+01 cost=1.5e+06 flops=2.3e+07
 renorm_tot[red] counter=3 t=3.0e-02 per=2.7e+01 cost=5.5e+05 flops=1.8e+07
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.0e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0547 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.059e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.204e-04 change=-1.663e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.204e-04 change=-1.125e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.358e-01 S #####
 T(local opt: fetch) = 1.140e-02 S  per = 2.13  per(accum) = 2.13
 T(local opt: hdiag) = 7.185e-02 S  per = 13.4  per(accum) = 15.5
 T(local opt: dvdsn) = 3.844e-01 S  per = 71.7  per(accum) = 87.3
 T(local opt: decim) = 1.186e-02 S  per = 2.21  per(accum) = 89.5
 T(local opt: guess) = 1.620e-04 S  per = 0.0302  per(accum) = 89.5
 T(local opt: renrm) = 5.594e-02 S  per = 10.4  per(accum) = 100
 T(local opt: save ) = 1.911e-04 S  per = 0.0357  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.844e-01 S  T(sum) = 3.843e-01 S  per = 9.996e+01
 T(local opt: preprocess                  ) = 1.958e-04 S  per = 0.051  per(accum) = 0.051
 T(local opt: symbolic_formulae           ) = 4.909e-03 S  per = 1.28  per(accum) = 1.33
 T(local opt: hintermediate init          ) = 1.400e-04 S  per = 0.0364  per(accum) = 1.36
 T(local opt: preprocess_hformulae_Hxlist ) = 1.346e-03 S  per = 0.35  per(accum) = 1.72
 T(local opt: hmmtasks init               ) = 1.765e-03 S  per = 0.459  per(accum) = 2.17
 T(local opt: initial guess for dvdson    ) = 2.993e-06 S  per = 0.000779  per(accum) = 2.18
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.149e-01 S  per = 81.9  per(accum) = 84.1
 T(local opt: dvdson [cpu-gpu]            ) = 7.453e-03 S  per = 1.94  per(accum) = 86.1
 T(local opt: dvdson [nccl]               ) = 3.449e-05 S  per = 0.00898  per(accum) = 86.1
 T(local opt: dvdson [mpi]                ) = 6.500e-07 S  per = 0.000169  per(accum) = 86.1
 T(local opt: dvdson [rest part(linalg)]  ) = 5.352e-02 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 5.594e-02 S  T(sum) = 5.594e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.860e-04 S  per = 0.332  per(accum) = 0.332
 T(local opt: qops init                    ) = 1.069e-03 S  per = 1.91  per(accum) = 2.24
 T(local opt: symbolic_formulae_renorm     ) = 5.444e-03 S  per = 9.73  per(accum) = 12
 T(local opt: allocate qops on gpu         ) = 5.338e-05 S  per = 0.0954  per(accum) = 12.1
 T(local opt: site memcpy cpu2gpu          ) = 2.367e-03 S  per = 4.23  per(accum) = 16.3
 T(local opt: rintermediate init           ) = 2.507e-03 S  per = 4.48  per(accum) = 20.8
 T(local opt: preprocess_formulae_Rlist2   ) = 2.082e-03 S  per = 3.72  per(accum) = 24.5
 T(local opt: rmmtasks init                ) = 1.627e-03 S  per = 2.91  per(accum) = 27.4
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 7.87e-05  per(accum) = 27.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.941e-02 S  per = 70.4  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 3.218e-05 S  per = 0.0575  per(accum) = 97.9
 T(local opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 0.0001  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 6.61e-05  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.122e-04 S  per = 0.201  per(accum) = 98.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.676e-05 S  per = 0.03  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 1.032e-03 S  per = 1.85  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.142e-06 S  per = 0.00383  per(accum) = 100
##### sweep opt: 1.033e+00 S #####
 T(sweep opt: fetch) = 4.327e-02 S  per = 4.19  per(accum) = 4.19
 T(sweep opt: hdiag) = 1.363e-01 S  per = 13.2  per(accum) = 17.4
 T(sweep opt: dvdsn) = 6.270e-01 S  per = 60.7  per(accum) = 78.1
 T(sweep opt: decim) = 1.219e-02 S  per = 1.18  per(accum) = 79.3
 T(sweep opt: guess) = 3.411e-04 S  per = 0.033  per(accum) = 79.3
 T(sweep opt: renrm) = 2.132e-01 S  per = 20.6  per(accum) = 99.9
 T(sweep opt: save ) = 7.086e-04 S  per = 0.0686  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.270e-01 S  T(sum) = 6.265e-01 S  per = 9.992e+01
 T(sweep opt: preprocess                  ) = 4.180e-04 S  per = 0.0667  per(accum) = 0.0667
 T(sweep opt: symbolic_formulae           ) = 8.995e-03 S  per = 1.44  per(accum) = 1.5
 T(sweep opt: hintermediate init          ) = 3.210e-04 S  per = 0.0512  per(accum) = 1.55
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.415e-03 S  per = 0.385  per(accum) = 1.94
 T(sweep opt: hmmtasks init               ) = 2.793e-03 S  per = 0.446  per(accum) = 2.38
 T(sweep opt: initial guess for dvdson    ) = 1.097e-05 S  per = 0.00175  per(accum) = 2.39
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.176e-01 S  per = 82.6  per(accum) = 85
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.373e-02 S  per = 2.19  per(accum) = 87.2
 T(sweep opt: dvdson [nccl]               ) = 7.480e-05 S  per = 0.0119  per(accum) = 87.2
 T(sweep opt: dvdson [mpi]                ) = 1.147e-06 S  per = 0.000183  per(accum) = 87.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.021e-02 S  per = 12.8  per(accum) = 100
Detailed decomposition of T(renrm) = 2.132e-01 S  T(sum) = 2.132e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.078e-04 S  per = 0.191  per(accum) = 0.191
 T(sweep opt: qops init                    ) = 3.745e-03 S  per = 1.76  per(accum) = 1.95
 T(sweep opt: symbolic_formulae_renorm     ) = 9.951e-03 S  per = 4.67  per(accum) = 6.62
 T(sweep opt: allocate qops on gpu         ) = 1.613e-04 S  per = 0.0757  per(accum) = 6.69
 T(sweep opt: site memcpy cpu2gpu          ) = 4.989e-03 S  per = 2.34  per(accum) = 9.03
 T(sweep opt: rintermediate init           ) = 5.026e-03 S  per = 2.36  per(accum) = 11.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.531e-02 S  per = 7.18  per(accum) = 18.6
 T(sweep opt: rmmtasks init                ) = 5.894e-02 S  per = 27.6  per(accum) = 46.2
 T(sweep opt: qops memset on cpu           ) = 1.130e-07 S  per = 5.3e-05  per(accum) = 46.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.097e-01 S  per = 51.5  per(accum) = 97.7
 T(sweep opt: deallocate cpu and gpu memory) = 5.948e-04 S  per = 0.279  per(accum) = 98
 T(sweep opt: construct opS [ifdists=true] ) = 1.720e-07 S  per = 8.07e-05  per(accum) = 98
 T(sweep opt: reduction of opS & opH [nccl]) = 1.040e-07 S  per = 4.88e-05  per(accum) = 98
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.396e-04 S  per = 0.159  per(accum) = 98.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 9.339e-05 S  per = 0.0438  per(accum) = 98.2
 T(sweep opt: qops_pool join and erase     ) = 3.856e-03 S  per = 1.81  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 6.287e-06 S  per = 0.00295  per(accum) = 100
##### global opt: 1.033e+00 S #####
 T(global opt: fetch) = 4.327e-02 S  per = 4.19  per(accum) = 4.19
 T(global opt: hdiag) = 1.363e-01 S  per = 13.2  per(accum) = 17.4
 T(global opt: dvdsn) = 6.270e-01 S  per = 60.7  per(accum) = 78.1
 T(global opt: decim) = 1.219e-02 S  per = 1.18  per(accum) = 79.3
 T(global opt: guess) = 3.411e-04 S  per = 0.033  per(accum) = 79.3
 T(global opt: renrm) = 2.132e-01 S  per = 20.6  per(accum) = 99.9
 T(global opt: save ) = 7.086e-04 S  per = 0.0686  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.270e-01 S  T(sum) = 6.265e-01 S  per = 9.992e+01
 T(global opt: preprocess                  ) = 4.180e-04 S  per = 0.0667  per(accum) = 0.0667
 T(global opt: symbolic_formulae           ) = 8.995e-03 S  per = 1.44  per(accum) = 1.5
 T(global opt: hintermediate init          ) = 3.210e-04 S  per = 0.0512  per(accum) = 1.55
 T(global opt: preprocess_hformulae_Hxlist ) = 2.415e-03 S  per = 0.385  per(accum) = 1.94
 T(global opt: hmmtasks init               ) = 2.793e-03 S  per = 0.446  per(accum) = 2.38
 T(global opt: initial guess for dvdson    ) = 1.097e-05 S  per = 0.00175  per(accum) = 2.39
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.176e-01 S  per = 82.6  per(accum) = 85
 T(global opt: dvdson [cpu-gpu]            ) = 1.373e-02 S  per = 2.19  per(accum) = 87.2
 T(global opt: dvdson [nccl]               ) = 7.480e-05 S  per = 0.0119  per(accum) = 87.2
 T(global opt: dvdson [mpi]                ) = 1.147e-06 S  per = 0.000183  per(accum) = 87.2
 T(global opt: dvdson [rest part(linalg)]  ) = 8.021e-02 S  per = 12.8  per(accum) = 100
Detailed decomposition of T(renrm) = 2.132e-01 S  T(sum) = 2.132e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.078e-04 S  per = 0.191  per(accum) = 0.191
 T(global opt: qops init                    ) = 3.745e-03 S  per = 1.76  per(accum) = 1.95
 T(global opt: symbolic_formulae_renorm     ) = 9.951e-03 S  per = 4.67  per(accum) = 6.62
 T(global opt: allocate qops on gpu         ) = 1.613e-04 S  per = 0.0757  per(accum) = 6.69
 T(global opt: site memcpy cpu2gpu          ) = 4.989e-03 S  per = 2.34  per(accum) = 9.03
 T(global opt: rintermediate init           ) = 5.026e-03 S  per = 2.36  per(accum) = 11.4
 T(global opt: preprocess_formulae_Rlist2   ) = 1.531e-02 S  per = 7.18  per(accum) = 18.6
 T(global opt: rmmtasks init                ) = 5.894e-02 S  per = 27.6  per(accum) = 46.2
 T(global opt: qops memset on cpu           ) = 1.130e-07 S  per = 5.3e-05  per(accum) = 46.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.097e-01 S  per = 51.5  per(accum) = 97.7
 T(global opt: deallocate cpu and gpu memory) = 5.948e-04 S  per = 0.279  per(accum) = 98
 T(global opt: construct opS [ifdists=true] ) = 1.720e-07 S  per = 8.07e-05  per(accum) = 98
 T(global opt: reduction of opS & opH [nccl]) = 1.040e-07 S  per = 4.88e-05  per(accum) = 98
 T(global opt: qops memcpy gpu2cpu          ) = 3.396e-04 S  per = 0.159  per(accum) = 98.1
 T(global opt: reduction of opS & opH [mpi] ) = 9.339e-05 S  per = 0.0438  per(accum) = 98.2
 T(global opt: qops_pool join and erase     ) = 3.856e-03 S  per = 1.81  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 6.287e-06 S  per = 0.00295  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.402e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=3/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=10:7.629e-05MB:7.451e-08GB
total mem of comb=774:5.905e-03MB:5.767e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 rqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2851:0.0218MB:2.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.366e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,4,4) nnz=10:7.629e-05MB
qtensor3: wf3 own=1 _data=0x3ab8d6d0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (7,1):2 (6,2):1
 qbond: qcol nsym=2 dimAll=4
 (22,-2):3 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=10:7.629e-05MB
### DIAG TIMING: total=5.728e-02 t1=2.532e-05, t2=2.208e-03, t3=2.501e-03, t4=5.252e-02, t5=4.920e-06, t6=1.410e-05, t7=3.535e-06
duration_diagGPU:5.729e-02
duration_diagreduce:4.300e-08
duration_diagtransform:4.260e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 7.681e-03 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper)=2.124e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.838e-04 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper,hinter)=2.124e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.622e-03 S size(H_formulae)=435 size(Hxlst2)=3 T(Hmu/Hxlist)=1.007e-03,6.149e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.668e-03 S size(H_formulae)=435 size(Hxlst)=442 -----
rank=0 GPUmem(GB): used=4.225e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.490e-07 batch[need]=5.269e-05 blksize=6 blksize0=3 batchsize=442
rank=0 GPUmem(GB): used=9.509e-05 (oper,hinter,dvdson,batch)=2.124e-05,2.101e-05,1.490e-07,5.269e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=10 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.856e-03,9.925e-03,2.976e-02,1.250e-02,5.405e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.851e-03 speed=8.052e-05GB/S T(nccl)=5.570e-06 speed=2.675e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=11 t=9.9e-03 per=1.9e+01 cost=7.9e+03 flops=8.0e+05
 sigma[gemm] counter=11 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=7.4e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=11 i=3 t=7.4e-03 per=1.4e+01 cost=1.9e+03 flops=2.6e+05
 sigma[gemm] counter=11 i=4 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=11 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=11 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.5e+05
 sigma[red] counter=11 t=1.3e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.0e-01 t_gemm=3.3e-01 t_reduction=1.4e-01 tot=5.7e-01 -----
 sigma_tot[inter] counter=11 t=1.0e-01 per=1.8e+01 cost=3.9e+04 flops=3.8e+05
 sigma_tot[gemm] counter=11 i=0 t=1.9e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=1.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=8.2e-02 per=1.4e+01 cost=1.3e+04 flops=1.6e+05
 sigma_tot[gemm] counter=11 i=3 t=8.2e-02 per=1.4e+01 cost=1.2e+04 flops=1.5e+05
 sigma_tot[gemm] counter=11 i=4 t=8.2e-02 per=1.4e+01 cost=2.5e+04 flops=3.1e+05
 sigma_tot[gemm] counter=11 i=5 t=8.2e-02 per=1.4e+01 cost=2.4e+04 flops=2.9e+05
 sigma_tot[gemm] counter=11 total t=3.3e-01 per=5.8e+01 cost=7.5e+04 flops=2.3e+05
 sigma_tot[red] counter=11 t=1.4e-01 per=2.4e+01 cost=2.4e+04 flops=1.7e+05
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.3e-06,2.1e-06,6.7e-07,2.1e-07
settings: ndim=10 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.201799839536 -1.116e+03  3.965e-02    1     1  5.417e-02 5.417e-02 5.414e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.170e-03,1.232e-02,2.961e-02,1.247e-02,5.558e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.162e-03 speed=1.282e-04GB/S T(nccl)=7.413e-06 speed=2.010e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.4e-02 -----
 sigma[inter] counter=12 t=1.2e-02 per=2.3e+01 cost=7.9e+03 flops=6.4e+05
 sigma[gemm] counter=12 i=0 t=4.6e-06 per=8.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=3.7e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=7.1e-03 per=1.3e+01 cost=1.9e+03 flops=2.7e+05
 sigma[gemm] counter=12 i=3 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=12 i=4 t=7.6e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=12 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=12 total t=3.0e-02 per=5.4e+01 cost=7.3e+03 flops=2.5e+05
 sigma[red] counter=12 t=1.2e-02 per=2.3e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.1e-01 t_gemm=3.6e-01 t_reduction=1.5e-01 tot=6.2e-01 -----
 sigma_tot[inter] counter=12 t=1.1e-01 per=1.8e+01 cost=4.7e+04 flops=4.1e+05
 sigma_tot[gemm] counter=12 i=0 t=2.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=2.0e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=8.9e-02 per=1.4e+01 cost=1.5e+04 flops=1.7e+05
 sigma_tot[gemm] counter=12 i=3 t=9.0e-02 per=1.4e+01 cost=1.4e+04 flops=1.6e+05
 sigma_tot[gemm] counter=12 i=4 t=9.0e-02 per=1.4e+01 cost=2.7e+04 flops=3.0e+05
 sigma_tot[gemm] counter=12 i=5 t=9.0e-02 per=1.4e+01 cost=2.6e+04 flops=2.9e+05
 sigma_tot[gemm] counter=12 total t=3.6e-01 per=5.8e+01 cost=8.2e+04 flops=2.3e+05
 sigma_tot[red] counter=12 t=1.5e-01 per=2.4e+01 cost=2.7e+04 flops=1.8e+05
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=7.7e-06,2.1e-05,2.0e-05,1.9e-06,4.6e-07
    2   0 -    -116.206813881637 -5.014e-03  1.586e-02    2     2  1.196e-01 5.980e-02 5.497e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.082e-03,9.838e-03,2.969e-02,1.243e-02,5.305e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.076e-03 speed=1.385e-04GB/S T(nccl)=5.857e-06 speed=2.544e-02GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=13 t=9.8e-03 per=1.9e+01 cost=7.9e+03 flops=8.1e+05
 sigma[gemm] counter=13 i=0 t=2.3e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=1.9e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=7.4e-03 per=1.4e+01 cost=1.9e+03 flops=2.6e+05
 sigma[gemm] counter=13 i=3 t=7.4e-03 per=1.4e+01 cost=1.9e+03 flops=2.6e+05
 sigma[gemm] counter=13 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=13 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=13 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.5e+05
 sigma[red] counter=13 t=1.2e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.2e-01 t_gemm=3.9e-01 t_reduction=1.6e-01 tot=6.8e-01 -----
 sigma_tot[inter] counter=13 t=1.2e-01 per=1.8e+01 cost=5.5e+04 flops=4.4e+05
 sigma_tot[gemm] counter=13 i=0 t=2.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=2.2e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=9.7e-02 per=1.4e+01 cost=1.7e+04 flops=1.7e+05
 sigma_tot[gemm] counter=13 i=3 t=9.7e-02 per=1.4e+01 cost=1.6e+04 flops=1.7e+05
 sigma_tot[gemm] counter=13 i=4 t=9.7e-02 per=1.4e+01 cost=2.9e+04 flops=3.0e+05
 sigma_tot[gemm] counter=13 i=5 t=9.7e-02 per=1.4e+01 cost=2.8e+04 flops=2.8e+05
 sigma_tot[gemm] counter=13 total t=3.9e-01 per=5.8e+01 cost=8.9e+04 flops=2.3e+05
 sigma_tot[red] counter=13 t=1.6e-01 per=2.4e+01 cost=2.9e+04 flops=1.8e+05
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.7e-05,3.8e-06,1.3e-06,2.8e-07
    3   0 -    -116.207969611591 -1.156e-03  1.425e-03    3     3  1.907e-01 6.355e-02 5.437e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.411e-03,9.998e-03,3.010e-02,1.237e-02,5.389e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.405e-03 speed=1.060e-04GB/S T(nccl)=5.579e-06 speed=2.671e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=14 t=1.0e-02 per=1.9e+01 cost=7.9e+03 flops=7.9e+05
 sigma[gemm] counter=14 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=14 i=3 t=7.6e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=14 i=4 t=7.6e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=14 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=14 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.4e+05
 sigma[red] counter=14 t=1.2e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.3e-01 t_gemm=4.2e-01 t_reduction=1.7e-01 tot=7.3e-01 -----
 sigma_tot[inter] counter=14 t=1.3e-01 per=1.8e+01 cost=6.3e+04 flops=4.7e+05
 sigma_tot[gemm] counter=14 i=0 t=2.8e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=2.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=1.0e-01 per=1.4e+01 cost=1.9e+04 flops=1.8e+05
 sigma_tot[gemm] counter=14 i=3 t=1.0e-01 per=1.4e+01 cost=1.8e+04 flops=1.7e+05
 sigma_tot[gemm] counter=14 i=4 t=1.0e-01 per=1.4e+01 cost=3.1e+04 flops=2.9e+05
 sigma_tot[gemm] counter=14 i=5 t=1.0e-01 per=1.4e+01 cost=2.9e+04 flops=2.8e+05
 sigma_tot[gemm] counter=14 total t=4.2e-01 per=5.8e+01 cost=9.7e+04 flops=2.3e+05
 sigma_tot[red] counter=14 t=1.7e-01 per=2.4e+01 cost=3.2e+04 flops=1.8e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,2.9e-06,9.2e-07,1.7e-07
    4   0 -    -116.207979547961 -9.936e-06  1.341e-04    3     4  2.561e-01 6.403e-02 5.428e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.223e-03,1.435e-02,3.023e-02,1.241e-02,5.822e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.217e-03 speed=1.225e-04GB/S T(nccl)=6.573e-06 speed=2.267e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.7e-02 -----
 sigma[inter] counter=15 t=1.4e-02 per=2.5e+01 cost=7.9e+03 flops=5.5e+05
 sigma[gemm] counter=15 i=0 t=4.4e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=3.8e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=7.4e-03 per=1.3e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=15 i=3 t=7.6e-03 per=1.3e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=15 i=4 t=7.6e-03 per=1.3e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=15 i=5 t=7.6e-03 per=1.3e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=15 total t=3.0e-02 per=5.3e+01 cost=7.3e+03 flops=2.4e+05
 sigma[red] counter=15 t=1.2e-02 per=2.2e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.5e-01 t_gemm=4.5e-01 t_reduction=1.9e-01 tot=7.8e-01 -----
 sigma_tot[inter] counter=15 t=1.5e-01 per=1.9e+01 cost=7.1e+04 flops=4.7e+05
 sigma_tot[gemm] counter=15 i=0 t=3.2e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=2.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=1.1e-01 per=1.4e+01 cost=2.1e+04 flops=1.9e+05
 sigma_tot[gemm] counter=15 i=3 t=1.1e-01 per=1.4e+01 cost=2.0e+04 flops=1.8e+05
 sigma_tot[gemm] counter=15 i=4 t=1.1e-01 per=1.4e+01 cost=3.2e+04 flops=2.9e+05
 sigma_tot[gemm] counter=15 i=5 t=1.1e-01 per=1.4e+01 cost=3.1e+04 flops=2.8e+05
 sigma_tot[gemm] counter=15 total t=4.5e-01 per=5.7e+01 cost=1.0e+05 flops=2.3e+05
 sigma_tot[red] counter=15 t=1.9e-01 per=2.4e+01 cost=3.5e+04 flops=1.9e+05
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,2.7e-05,6.0e-06,1.9e-06,3.6e-07
    5   0 +    -116.207979653445 -1.055e-07  3.101e-05    3     5  3.241e-01 6.483e-02 5.511e-02
TIMING FOR Davidson : 3.242e-01  T(cal/comm/rest)=2.755e-01,8.140e-07,4.862e-02
decomposed t_rest=4.862e-02
 T(sub)    =1.537e-04 per=3.162e-01
 T(precond)=4.831e-02 per=9.935e+01
 T(ortho)  =1.630e-05 per=3.353e-02
 T(xcopy)  =1.028e-06 per=2.114e-03
 T(xnrm2)  =3.005e-06 per=6.180e-03
 T(other)  =1.428e-04 per=2.936e-01
optimized energies: isweep=0 ibond=3 dots=1 e[0]=-116.207979653445 nmvp=5
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=4.391e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=6 dimAll=12
 (7,1):3 (9,1):2 (8,2):3 (8,0):2 (6,2):1 (7,3):1
timing for divide=1.6e-05
timing for compute=1.7e-02
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 1.7e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.6e-05,1.7e-02,0.0e+00,9.1e-06,1.8e-05 -----
decimation summary: 12->4 dwt=+0.000e+00 SvN=4.937e-01
 qbond: qkept nsym=2 dimAll=4
 (8,2):3 (7,3):1
----- TIMING for decimation_row(nkr): 1.708e-02 S T(decim/select/formRot)=1.680e-02,2.564e-04,2.438e-05 -----
----- TIMING FOR onedot_decimation: 1.718e-02 S T(wf/decim)=8.256e-05,1.709e-02 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:4.05 S:12.2 A:0 B:81.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=5.782e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.074e-02 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper)=2.124e-05
rank=0 GPUmem(GB): used=4.233e-05 (oper,site)=2.124e-05,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:2.237e-02MB:2.185e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.503e-03 S -----
rank=0 GPUmem(GB): used=6.417e-05 (oper,site,rinter)=2.124e-05,7.451e-08,2.185e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.112e-03 S size(rtasks)=141 size(Rlst2)=4 T(Rmu/Rlist)=2.423e-03,6.893e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.197e-03 S size(rtasks)=141 size(Rlst)=186 -----
rank=0 GPUmem(GB): used=6.417e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.187e-05 blksize=9 blksize0=4 batchsize=186
rank=0 GPUmem(GB): used=9.605e-05 (oper,site,rinter,batch)=2.124e-05,7.451e-08,2.185e-05,3.187e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.228e-03,2.272e-02,9.945e-03
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=4 t=7.2e-03 per=1.8e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=4 i=0 t=2.2e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.9e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=1.9e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=3 t=1.9e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=4 t=7.5e-03 per=1.9e+01 cost=4.4e+02 flops=5.8e+04
 renorm[gemm] counter=4 i=5 t=7.6e-03 per=1.9e+01 cost=1.1e+03 flops=1.5e+05
 renorm[gemm] counter=4 i=6 t=7.6e-03 per=1.9e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=4 total t=2.3e-02 per=5.7e+01 cost=4.2e+03 flops=1.9e+05
 renorm[red] counter=4 t=9.9e-03 per=2.5e+01 cost=1.9e+03 flops=1.9e+05
----- TIMING FOR renorm_tot : t_inter=2.1e-02 t_gemm=8.9e-02 t_reduction=4.0e-02 tot=1.5e-01 -----
 renorm_tot[inter] counter=4 t=2.1e-02 per=1.4e+01 cost=1.0e+05 flops=4.9e+06
 renorm_tot[gemm] counter=4 i=0 t=6.5e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=5.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=5.3e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=3 t=5.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=4 t=2.8e-02 per=1.9e+01 cost=1.8e+05 flops=6.4e+06
 renorm_tot[gemm] counter=4 i=5 t=3.0e-02 per=2.0e+01 cost=1.6e+05 flops=5.3e+06
 renorm_tot[gemm] counter=4 i=6 t=3.0e-02 per=2.0e+01 cost=1.2e+06 flops=4.0e+07
 renorm_tot[gemm] counter=4 total t=8.9e-02 per=5.9e+01 cost=1.5e+06 flops=1.7e+07
 renorm_tot[red] counter=4 t=4.0e-02 per=2.7e+01 cost=5.6e+05 flops=1.4e+07
qops.to_cpu: size(tot)=370:2.8e-03MB:2.8e-06GB T(to_cpu)=2.1e-04S speed=1.3e-02GB/S
check ||H-H.dagger||=2.963e-15 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0617 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.611e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.327e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.502e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.847e-01 S #####
 T(local opt: fetch) = 1.074e-02 S  per = 2.22  per(accum) = 2.22
 T(local opt: hdiag) = 5.733e-02 S  per = 11.8  per(accum) = 14
 T(local opt: dvdsn) = 3.359e-01 S  per = 69.3  per(accum) = 83.3
 T(local opt: decim) = 1.719e-02 S  per = 3.55  per(accum) = 86.9
 T(local opt: guess) = 8.656e-05 S  per = 0.0179  per(accum) = 86.9
 T(local opt: renrm) = 6.323e-02 S  per =   13  per(accum) = 99.9
 T(local opt: save ) = 2.801e-04 S  per = 0.0578  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.359e-01 S  T(sum) = 3.356e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 7.653e-05 S  per = 0.0228  per(accum) = 0.0228
 T(local opt: symbolic_formulae           ) = 7.693e-03 S  per = 2.29  per(accum) = 2.32
 T(local opt: hintermediate init          ) = 2.001e-04 S  per = 0.0596  per(accum) = 2.37
 T(local opt: preprocess_hformulae_Hxlist ) = 1.684e-03 S  per = 0.502  per(accum) = 2.88
 T(local opt: hmmtasks init               ) = 1.781e-03 S  per = 0.531  per(accum) = 3.41
 T(local opt: initial guess for dvdson    ) = 2.874e-06 S  per = 0.000856  per(accum) = 3.41
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.688e-01 S  per = 80.1  per(accum) = 83.5
 T(local opt: dvdson [cpu-gpu]            ) = 6.711e-03 S  per =    2  per(accum) = 85.5
 T(local opt: dvdson [nccl]               ) = 3.099e-05 S  per = 0.00924  per(accum) = 85.5
 T(local opt: dvdson [mpi]                ) = 8.140e-07 S  per = 0.000243  per(accum) = 85.5
 T(local opt: dvdson [rest part(linalg)]  ) = 4.862e-02 S  per = 14.5  per(accum) = 100
Detailed decomposition of T(renrm) = 6.323e-02 S  T(sum) = 6.323e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.349e-05 S  per = 0.132  per(accum) = 0.132
 T(local opt: qops init                    ) = 1.637e-03 S  per = 2.59  per(accum) = 2.72
 T(local opt: symbolic_formulae_renorm     ) = 1.076e-02 S  per =   17  per(accum) = 19.7
 T(local opt: allocate qops on gpu         ) = 6.855e-05 S  per = 0.108  per(accum) = 19.8
 T(local opt: site memcpy cpu2gpu          ) = 1.459e-03 S  per = 2.31  per(accum) = 22.1
 T(local opt: rintermediate init           ) = 2.521e-03 S  per = 3.99  per(accum) = 26.1
 T(local opt: preprocess_formulae_Rlist2   ) = 3.213e-03 S  per = 5.08  per(accum) = 31.2
 T(local opt: rmmtasks init                ) = 1.726e-03 S  per = 2.73  per(accum) = 33.9
 T(local opt: qops memset on cpu           ) = 6.200e-08 S  per = 9.81e-05  per(accum) = 33.9
 T(local opt: preprocess_renorm_batchGPU   ) = 4.002e-02 S  per = 63.3  per(accum) = 97.2
 T(local opt: deallocate cpu and gpu memory) = 3.710e-05 S  per = 0.0587  per(accum) = 97.3
 T(local opt: construct opS [ifdists=true] ) = 6.500e-08 S  per = 0.000103  per(accum) = 97.3
 T(local opt: reduction of opS & opH [nccl]) = 6.800e-08 S  per = 0.000108  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 2.156e-04 S  per = 0.341  per(accum) = 97.6
 T(local opt: reduction of opS & opH [mpi] ) = 2.111e-05 S  per = 0.0334  per(accum) = 97.7
 T(local opt: qops_pool join and erase     ) = 1.466e-03 S  per = 2.32  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.937e-06 S  per = 0.00306  per(accum) = 100
##### sweep opt: 1.518e+00 S #####
 T(sweep opt: fetch) = 5.401e-02 S  per = 3.56  per(accum) = 3.56
 T(sweep opt: hdiag) = 1.936e-01 S  per = 12.8  per(accum) = 16.3
 T(sweep opt: dvdsn) = 9.629e-01 S  per = 63.4  per(accum) = 79.8
 T(sweep opt: decim) = 2.938e-02 S  per = 1.94  per(accum) = 81.7
 T(sweep opt: guess) = 4.277e-04 S  per = 0.0282  per(accum) = 81.7
 T(sweep opt: renrm) = 2.764e-01 S  per = 18.2  per(accum) = 99.9
 T(sweep opt: save ) = 9.887e-04 S  per = 0.0651  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.629e-01 S  T(sum) = 9.621e-01 S  per = 9.992e+01
 T(sweep opt: preprocess                  ) = 4.945e-04 S  per = 0.0514  per(accum) = 0.0514
 T(sweep opt: symbolic_formulae           ) = 1.669e-02 S  per = 1.73  per(accum) = 1.79
 T(sweep opt: hintermediate init          ) = 5.210e-04 S  per = 0.0542  per(accum) = 1.84
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.098e-03 S  per = 0.426  per(accum) = 2.27
 T(sweep opt: hmmtasks init               ) = 4.574e-03 S  per = 0.475  per(accum) = 2.74
 T(sweep opt: initial guess for dvdson    ) = 1.384e-05 S  per = 0.00144  per(accum) = 2.74
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.863e-01 S  per = 81.7  per(accum) = 84.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.044e-02 S  per = 2.12  per(accum) = 86.6
 T(sweep opt: dvdson [nccl]               ) = 1.058e-04 S  per = 0.011  per(accum) = 86.6
 T(sweep opt: dvdson [mpi]                ) = 1.961e-06 S  per = 0.000204  per(accum) = 86.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.288e-01 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.764e-01 S  T(sum) = 2.764e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.913e-04 S  per = 0.178  per(accum) = 0.178
 T(sweep opt: qops init                    ) = 5.382e-03 S  per = 1.95  per(accum) = 2.12
 T(sweep opt: symbolic_formulae_renorm     ) = 2.071e-02 S  per = 7.49  per(accum) = 9.62
 T(sweep opt: allocate qops on gpu         ) = 2.299e-04 S  per = 0.0832  per(accum) = 9.7
 T(sweep opt: site memcpy cpu2gpu          ) = 6.448e-03 S  per = 2.33  per(accum) = 12
 T(sweep opt: rintermediate init           ) = 7.547e-03 S  per = 2.73  per(accum) = 14.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.853e-02 S  per =  6.7  per(accum) = 21.5
 T(sweep opt: rmmtasks init                ) = 6.067e-02 S  per = 21.9  per(accum) = 43.4
 T(sweep opt: qops memset on cpu           ) = 1.750e-07 S  per = 6.33e-05  per(accum) = 43.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.498e-01 S  per = 54.2  per(accum) = 97.6
 T(sweep opt: deallocate cpu and gpu memory) = 6.319e-04 S  per = 0.229  per(accum) = 97.8
 T(sweep opt: construct opS [ifdists=true] ) = 2.370e-07 S  per = 8.57e-05  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.720e-07 S  per = 6.22e-05  per(accum) = 97.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.552e-04 S  per = 0.201  per(accum) = 98
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.145e-04 S  per = 0.0414  per(accum) = 98.1
 T(sweep opt: qops_pool join and erase     ) = 5.322e-03 S  per = 1.93  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 8.224e-06 S  per = 0.00298  per(accum) = 100
##### global opt: 1.518e+00 S #####
 T(global opt: fetch) = 5.401e-02 S  per = 3.56  per(accum) = 3.56
 T(global opt: hdiag) = 1.936e-01 S  per = 12.8  per(accum) = 16.3
 T(global opt: dvdsn) = 9.629e-01 S  per = 63.4  per(accum) = 79.8
 T(global opt: decim) = 2.938e-02 S  per = 1.94  per(accum) = 81.7
 T(global opt: guess) = 4.277e-04 S  per = 0.0282  per(accum) = 81.7
 T(global opt: renrm) = 2.764e-01 S  per = 18.2  per(accum) = 99.9
 T(global opt: save ) = 9.887e-04 S  per = 0.0651  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.629e-01 S  T(sum) = 9.621e-01 S  per = 9.992e+01
 T(global opt: preprocess                  ) = 4.945e-04 S  per = 0.0514  per(accum) = 0.0514
 T(global opt: symbolic_formulae           ) = 1.669e-02 S  per = 1.73  per(accum) = 1.79
 T(global opt: hintermediate init          ) = 5.210e-04 S  per = 0.0542  per(accum) = 1.84
 T(global opt: preprocess_hformulae_Hxlist ) = 4.098e-03 S  per = 0.426  per(accum) = 2.27
 T(global opt: hmmtasks init               ) = 4.574e-03 S  per = 0.475  per(accum) = 2.74
 T(global opt: initial guess for dvdson    ) = 1.384e-05 S  per = 0.00144  per(accum) = 2.74
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.863e-01 S  per = 81.7  per(accum) = 84.5
 T(global opt: dvdson [cpu-gpu]            ) = 2.044e-02 S  per = 2.12  per(accum) = 86.6
 T(global opt: dvdson [nccl]               ) = 1.058e-04 S  per = 0.011  per(accum) = 86.6
 T(global opt: dvdson [mpi]                ) = 1.961e-06 S  per = 0.000204  per(accum) = 86.6
 T(global opt: dvdson [rest part(linalg)]  ) = 1.288e-01 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.764e-01 S  T(sum) = 2.764e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.913e-04 S  per = 0.178  per(accum) = 0.178
 T(global opt: qops init                    ) = 5.382e-03 S  per = 1.95  per(accum) = 2.12
 T(global opt: symbolic_formulae_renorm     ) = 2.071e-02 S  per = 7.49  per(accum) = 9.62
 T(global opt: allocate qops on gpu         ) = 2.299e-04 S  per = 0.0832  per(accum) = 9.7
 T(global opt: site memcpy cpu2gpu          ) = 6.448e-03 S  per = 2.33  per(accum) = 12
 T(global opt: rintermediate init           ) = 7.547e-03 S  per = 2.73  per(accum) = 14.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.853e-02 S  per =  6.7  per(accum) = 21.5
 T(global opt: rmmtasks init                ) = 6.067e-02 S  per = 21.9  per(accum) = 43.4
 T(global opt: qops memset on cpu           ) = 1.750e-07 S  per = 6.33e-05  per(accum) = 43.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.498e-01 S  per = 54.2  per(accum) = 97.6
 T(global opt: deallocate cpu and gpu memory) = 6.319e-04 S  per = 0.229  per(accum) = 97.8
 T(global opt: construct opS [ifdists=true] ) = 2.370e-07 S  per = 8.57e-05  per(accum) = 97.8
 T(global opt: reduction of opS & opH [nccl]) = 1.720e-07 S  per = 6.22e-05  per(accum) = 97.8
 T(global opt: qops memcpy gpu2cpu          ) = 5.552e-04 S  per = 0.201  per(accum) = 98
 T(global opt: reduction of opS & opH [mpi] ) = 1.145e-04 S  per = 0.0414  per(accum) = 98.1
 T(global opt: qops_pool join and erase     ) = 5.322e-03 S  per = 1.93  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 8.224e-06 S  per = 0.00298  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-4.324e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=4/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=17:1.297e-04MB:1.267e-07GB
total mem of comb=781:5.959e-03MB:5.819e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:4.05 S:12.2 A:0 B:81.1 
 rqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3367:0.0257MB:2.51e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.789e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.364e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,5,4) nnz=17:1.297e-04MB
qtensor3: wf3 own=1 _data=0x3a5d97a0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=4
 (8,2):3 (7,3):1
 qbond: qcol nsym=3 dimAll=5
 (21,-1):3 (22,-2):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=24 size=17:1.297e-04MB
### DIAG TIMING: total=1.049e-01 t1=3.058e-05, t2=2.128e-03, t3=2.513e-03, t4=1.002e-01, t5=5.571e-06, t6=1.410e-05, t7=4.994e-06
duration_diagGPU:1.049e-01
duration_diagreduce:8.100e-08
duration_diagtransform:3.690e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.160e-02 S -----
rank=0 GPUmem(GB): used=2.509e-05 (oper)=2.509e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.669e-04 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper,hinter)=2.509e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.074e-03 S size(H_formulae)=607 size(Hxlst2)=5 T(Hmu/Hxlist)=1.554e-03,1.520e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.285e-03 S size(H_formulae)=607 size(Hxlst)=1152 -----
rank=0 GPUmem(GB): used=5.429e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.533e-07 batch[need]=1.888e-04 blksize=9 blksize0=3 batchsize=1152
rank=0 GPUmem(GB): used=2.434e-04 (oper,hinter,dvdson,batch)=2.509e-05,2.921e-05,2.533e-07,1.888e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=17 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.073e-04,9.931e-03,2.980e-02,1.246e-02,5.280e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=6.026e-04 speed=4.204e-04GB/S T(nccl)=4.702e-06 speed=5.387e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=16 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=16 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=16 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=16 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=16 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=16 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=16 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.6e-01 t_gemm=4.8e-01 t_reduction=2.0e-01 tot=8.4e-01 -----
 sigma_tot[inter] counter=16 t=1.6e-01 per=1.9e+01 cost=8.9e+04 flops=5.6e+05
 sigma_tot[gemm] counter=16 i=0 t=3.4e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=2.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=1.2e-01 per=1.4e+01 cost=2.5e+04 flops=2.1e+05
 sigma_tot[gemm] counter=16 i=3 t=1.2e-01 per=1.4e+01 cost=2.5e+04 flops=2.1e+05
 sigma_tot[gemm] counter=16 i=4 t=1.2e-01 per=1.4e+01 cost=4.1e+04 flops=3.5e+05
 sigma_tot[gemm] counter=16 i=5 t=1.2e-01 per=1.4e+01 cost=4.0e+04 flops=3.4e+05
 sigma_tot[gemm] counter=16 total t=4.8e-01 per=5.7e+01 cost=1.3e+05 flops=2.7e+05
 sigma_tot[red] counter=16 t=2.0e-01 per=2.4e+01 cost=4.2e+04 flops=2.1e+05
T(sub)=9.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.0e-06,1.9e-06,6.6e-07,2.0e-07
settings: ndim=17 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.207979653445 -1.116e+03  4.933e-03    1     1  5.291e-02 5.291e-02 5.289e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.204e-03,9.947e-03,2.971e-02,1.248e-02,5.336e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.199e-03 speed=2.112e-04GB/S T(nccl)=4.724e-06 speed=5.362e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=17 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=17 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=17 i=3 t=7.4e-03 per=1.4e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=17 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=17 i=5 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=17 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=17 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.7e-01 t_gemm=5.1e-01 t_reduction=2.1e-01 tot=8.9e-01 -----
 sigma_tot[inter] counter=17 t=1.7e-01 per=1.9e+01 cost=1.1e+05 flops=6.3e+05
 sigma_tot[gemm] counter=17 i=0 t=3.6e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=3.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=1.3e-01 per=1.4e+01 cost=3.0e+04 flops=2.4e+05
 sigma_tot[gemm] counter=17 i=3 t=1.3e-01 per=1.4e+01 cost=2.9e+04 flops=2.3e+05
 sigma_tot[gemm] counter=17 i=4 t=1.3e-01 per=1.4e+01 cost=5.0e+04 flops=4.0e+05
 sigma_tot[gemm] counter=17 i=5 t=1.3e-01 per=1.4e+01 cost=4.9e+04 flops=3.9e+05
 sigma_tot[gemm] counter=17 total t=5.1e-01 per=5.7e+01 cost=1.6e+05 flops=3.1e+05
 sigma_tot[red] counter=17 t=2.1e-01 per=2.4e+01 cost=5.0e+04 flops=2.4e+05
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.1e-05,3.1e-06,8.0e-07,2.1e-07
    2   0 -    -116.208079427065 -9.977e-05  1.636e-03    2     2  1.160e-01 5.798e-02 5.317e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.207e-03,1.000e-02,2.991e-02,1.234e-02,5.346e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.203e-03 speed=2.107e-04GB/S T(nccl)=4.370e-06 speed=5.797e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=18 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=18 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+03 flops=6.1e+05
 sigma[gemm] counter=18 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=18 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=18 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=18 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=18 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.8e-01 t_gemm=5.4e-01 t_reduction=2.2e-01 tot=9.4e-01 -----
 sigma_tot[inter] counter=18 t=1.8e-01 per=1.9e+01 cost=1.3e+05 flops=7.0e+05
 sigma_tot[gemm] counter=18 i=0 t=3.7e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=3.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=1.3e-01 per=1.4e+01 cost=3.4e+04 flops=2.6e+05
 sigma_tot[gemm] counter=18 i=3 t=1.3e-01 per=1.4e+01 cost=3.4e+04 flops=2.5e+05
 sigma_tot[gemm] counter=18 i=4 t=1.3e-01 per=1.4e+01 cost=6.0e+04 flops=4.4e+05
 sigma_tot[gemm] counter=18 i=5 t=1.3e-01 per=1.4e+01 cost=5.8e+04 flops=4.3e+05
 sigma_tot[gemm] counter=18 total t=5.4e-01 per=5.7e+01 cost=1.9e+05 flops=3.5e+05
 sigma_tot[red] counter=18 t=2.2e-01 per=2.4e+01 cost=5.8e+04 flops=2.6e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,2.7e-06,9.1e-07,2.0e-07
    3   0 -    -116.208089811987 -1.038e-05  1.346e-04    3     3  1.791e-01 5.969e-02 5.329e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.182e-04,9.939e-03,3.010e-02,1.258e-02,5.324e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=6.133e-04 speed=4.131e-04GB/S T(nccl)=4.967e-06 speed=5.100e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=19 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=19 i=0 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=19 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=19 i=4 t=7.6e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=19 i=5 t=7.6e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=19 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=19 t=1.3e-02 per=2.4e+01 cost=7.8e+03 flops=6.2e+05
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=5.7e-01 t_reduction=2.4e-01 tot=9.9e-01 -----
 sigma_tot[inter] counter=19 t=1.9e-01 per=1.9e+01 cost=1.4e+05 flops=7.6e+05
 sigma_tot[gemm] counter=19 i=0 t=3.9e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=3.3e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=1.4e-01 per=1.4e+01 cost=3.9e+04 flops=2.8e+05
 sigma_tot[gemm] counter=19 i=3 t=1.4e-01 per=1.4e+01 cost=3.9e+04 flops=2.7e+05
 sigma_tot[gemm] counter=19 i=4 t=1.4e-01 per=1.4e+01 cost=6.9e+04 flops=4.8e+05
 sigma_tot[gemm] counter=19 i=5 t=1.4e-01 per=1.4e+01 cost=6.7e+04 flops=4.7e+05
 sigma_tot[gemm] counter=19 total t=5.7e-01 per=5.7e+01 cost=2.1e+05 flops=3.8e+05
 sigma_tot[red] counter=19 t=2.4e-01 per=2.4e+01 cost=6.6e+04 flops=2.8e+05
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,2.7e-06,8.1e-07,2.0e-07
    4   0 +    -116.208089881617 -6.963e-08  6.534e-06    3     4  2.446e-01 6.116e-02 5.330e-02
TIMING FOR Davidson : 2.447e-01  T(cal/comm/rest)=2.132e-01,3.920e-07,3.145e-02
decomposed t_rest=3.145e-02
 T(sub)    =7.168e-05 per=2.279e-01
 T(precond)=3.125e-02 per=9.938e+01
 T(ortho)  =1.002e-05 per=3.185e-02
 T(xcopy)  =6.640e-07 per=2.111e-03
 T(xnrm2)  =2.015e-06 per=6.407e-03
 T(other)  =1.102e-04 per=3.503e-01
optimized energies: isweep=0 ibond=4 dots=1 e[0]=-116.208089881617 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.166e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=6 dimAll=16
 (8,2):4 (10,2):3 (9,3):4 (9,1):3 (7,3):1 (8,4):1
timing for divide=8.2e-06
timing for compute=1.4e-02
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.4e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.2e-06,1.4e-02,0.0e+00,4.1e-06,1.4e-05 -----
decimation summary: 16->5 dwt=-2.220e-16 SvN=7.464e-01
 qbond: qkept nsym=3 dimAll=5
 (9,1):3 (8,2):1 (9,3):1
----- TIMING for decimation_row(nkr): 1.439e-02 S T(decim/select/formRot)=1.419e-02,1.784e-04,2.119e-05 -----
----- TIMING FOR onedot_decimation: 1.444e-02 S T(wf/decim)=3.863e-05,1.440e-02 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:3.63 S:8.47 A:0 B:86.2 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.739e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 8.577e-03 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper)=2.509e-05
rank=0 GPUmem(GB): used=5.442e-05 (oper,site)=2.509e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:3.120e-02MB:3.047e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.491e-03 S -----
rank=0 GPUmem(GB): used=8.489e-05 (oper,site,rinter)=2.509e-05,1.267e-07,3.047e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.164e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=1.447e-03,7.175e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.268e-03 S size(rtasks)=185 size(Rlst)=423 -----
rank=0 GPUmem(GB): used=8.489e-05 avail=6.176e+00 total=6.176e+00 batch[need]=8.824e-05 blksize=9 blksize0=9 batchsize=423
rank=0 GPUmem(GB): used=1.731e-04 (oper,site,rinter,batch)=2.509e-05,1.267e-07,3.047e-05,8.824e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.313e-03,2.268e-02,1.008e-02
----- TIMING FOR renorm : t_inter=7.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=5 t=7.3e-03 per=1.8e+01 cost=3.8e+04 flops=5.2e+06
 renorm[gemm] counter=5 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=3 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=4 t=7.5e-03 per=1.9e+01 cost=1.7e+03 flops=2.2e+05
 renorm[gemm] counter=5 i=5 t=7.7e-03 per=1.9e+01 cost=4.6e+03 flops=6.1e+05
 renorm[gemm] counter=5 i=6 t=7.5e-03 per=1.9e+01 cost=4.4e+03 flops=6.0e+05
 renorm[gemm] counter=5 total t=2.3e-02 per=5.7e+01 cost=1.1e+04 flops=4.8e+05
 renorm[red] counter=5 t=1.0e-02 per=2.5e+01 cost=1.8e+03 flops=1.8e+05
----- TIMING FOR renorm_tot : t_inter=2.8e-02 t_gemm=1.1e-01 t_reduction=5.0e-02 tot=1.9e-01 -----
 renorm_tot[inter] counter=5 t=2.8e-02 per=1.5e+01 cost=1.4e+05 flops=5.0e+06
 renorm_tot[gemm] counter=5 i=0 t=7.9e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=6.7e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=6.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=3 t=6.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=4 t=3.6e-02 per=1.9e+01 cost=1.8e+05 flops=5.1e+06
 renorm_tot[gemm] counter=5 i=5 t=3.8e-02 per=2.0e+01 cost=1.6e+05 flops=4.3e+06
 renorm_tot[gemm] counter=5 i=6 t=3.8e-02 per=2.0e+01 cost=1.2e+06 flops=3.2e+07
 renorm_tot[gemm] counter=5 total t=1.1e-01 per=5.9e+01 cost=1.6e+06 flops=1.4e+07
 renorm_tot[red] counter=5 t=5.0e-02 per=2.6e+01 cost=5.6e+05 flops=1.1e+07
qops.to_cpu: size(tot)=661:5.0e-03MB:4.9e-06GB T(to_cpu)=1.8e-04S speed=2.7e-02GB/S
check ||H-H.dagger||=3.538e-17 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0583 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=5.012e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=9.918e-05 change=-1.519e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=9.918e-05 change=-5.066e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.617e-01 S #####
 T(local opt: fetch) = 1.632e-02 S  per = 3.53  per(accum) = 3.53
 T(local opt: hdiag) = 1.049e-01 S  per = 22.7  per(accum) = 26.3
 T(local opt: dvdsn) = 2.662e-01 S  per = 57.7  per(accum) = 83.9
 T(local opt: decim) = 1.445e-02 S  per = 3.13  per(accum) = 87.1
 T(local opt: guess) = 6.634e-05 S  per = 0.0144  per(accum) = 87.1
 T(local opt: renrm) = 5.949e-02 S  per = 12.9  per(accum) = 100
 T(local opt: save ) = 1.983e-04 S  per = 0.043  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.662e-01 S  T(sum) = 2.661e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 8.762e-05 S  per = 0.0329  per(accum) = 0.0329
 T(local opt: symbolic_formulae           ) = 1.161e-02 S  per = 4.36  per(accum) = 4.4
 T(local opt: hintermediate init          ) = 2.828e-04 S  per = 0.106  per(accum) = 4.5
 T(local opt: preprocess_hformulae_Hxlist ) = 3.321e-03 S  per = 1.25  per(accum) = 5.75
 T(local opt: hmmtasks init               ) = 6.098e-03 S  per = 2.29  per(accum) = 8.04
 T(local opt: initial guess for dvdson    ) = 2.536e-06 S  per = 0.000953  per(accum) = 8.04
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.096e-01 S  per = 78.8  per(accum) = 86.8
 T(local opt: dvdson [cpu-gpu]            ) = 3.618e-03 S  per = 1.36  per(accum) = 88.2
 T(local opt: dvdson [nccl]               ) = 1.876e-05 S  per = 0.00705  per(accum) = 88.2
 T(local opt: dvdson [mpi]                ) = 3.920e-07 S  per = 0.000147  per(accum) = 88.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.145e-02 S  per = 11.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.949e-02 S  T(sum) = 5.949e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.752e-05 S  per = 0.147  per(accum) = 0.147
 T(local opt: qops init                    ) = 1.446e-03 S  per = 2.43  per(accum) = 2.58
 T(local opt: symbolic_formulae_renorm     ) = 8.591e-03 S  per = 14.4  per(accum) = 17
 T(local opt: allocate qops on gpu         ) = 5.255e-05 S  per = 0.0883  per(accum) = 17.1
 T(local opt: site memcpy cpu2gpu          ) = 5.783e-04 S  per = 0.972  per(accum) = 18.1
 T(local opt: rintermediate init           ) = 2.503e-03 S  per = 4.21  per(accum) = 22.3
 T(local opt: preprocess_formulae_Rlist2   ) = 2.286e-03 S  per = 3.84  per(accum) = 26.1
 T(local opt: rmmtasks init                ) = 2.472e-03 S  per = 4.16  per(accum) = 30.3
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 5.55e-05  per(accum) = 30.3
 T(local opt: preprocess_renorm_batchGPU   ) = 4.015e-02 S  per = 67.5  per(accum) = 97.8
 T(local opt: deallocate cpu and gpu memory) = 3.344e-05 S  per = 0.0562  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 5.400e-08 S  per = 9.08e-05  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 6.22e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.863e-04 S  per = 0.313  per(accum) = 98.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.621e-05 S  per = 0.0273  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 1.086e-03 S  per = 1.82  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.452e-06 S  per = 0.00244  per(accum) = 100
##### sweep opt: 1.979e+00 S #####
 T(sweep opt: fetch) = 7.033e-02 S  per = 3.55  per(accum) = 3.55
 T(sweep opt: hdiag) = 2.986e-01 S  per = 15.1  per(accum) = 18.6
 T(sweep opt: dvdsn) = 1.229e+00 S  per = 62.1  per(accum) = 80.7
 T(sweep opt: decim) = 4.383e-02 S  per = 2.21  per(accum) = 82.9
 T(sweep opt: guess) = 4.940e-04 S  per = 0.025  per(accum) = 83
 T(sweep opt: renrm) = 3.359e-01 S  per =   17  per(accum) = 99.9
 T(sweep opt: save ) = 1.187e-03 S  per = 0.06  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.229e+00 S  T(sum) = 1.228e+00 S  per = 9.992e+01
 T(sweep opt: preprocess                  ) = 5.821e-04 S  per = 0.0474  per(accum) = 0.0474
 T(sweep opt: symbolic_formulae           ) = 2.830e-02 S  per =  2.3  per(accum) = 2.35
 T(sweep opt: hintermediate init          ) = 8.038e-04 S  per = 0.0654  per(accum) = 2.42
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.420e-03 S  per = 0.604  per(accum) = 3.02
 T(sweep opt: hmmtasks init               ) = 1.067e-02 S  per = 0.869  per(accum) = 3.89
 T(sweep opt: initial guess for dvdson    ) = 1.638e-05 S  per = 0.00133  per(accum) = 3.89
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 9.959e-01 S  per = 81.1  per(accum) = 85
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.406e-02 S  per = 1.96  per(accum) = 86.9
 T(sweep opt: dvdson [nccl]               ) = 1.246e-04 S  per = 0.0101  per(accum) = 86.9
 T(sweep opt: dvdson [mpi]                ) = 2.353e-06 S  per = 0.000192  per(accum) = 86.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.603e-01 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 3.359e-01 S  T(sum) = 3.359e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.788e-04 S  per = 0.172  per(accum) = 0.172
 T(sweep opt: qops init                    ) = 6.828e-03 S  per = 2.03  per(accum) = 2.21
 T(sweep opt: symbolic_formulae_renorm     ) = 2.930e-02 S  per = 8.72  per(accum) = 10.9
 T(sweep opt: allocate qops on gpu         ) = 2.824e-04 S  per = 0.0841  per(accum) = 11
 T(sweep opt: site memcpy cpu2gpu          ) = 7.026e-03 S  per = 2.09  per(accum) = 13.1
 T(sweep opt: rintermediate init           ) = 1.005e-02 S  per = 2.99  per(accum) = 16.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.081e-02 S  per =  6.2  per(accum) = 22.3
 T(sweep opt: rmmtasks init                ) = 6.314e-02 S  per = 18.8  per(accum) = 41.1
 T(sweep opt: qops memset on cpu           ) = 2.080e-07 S  per = 6.19e-05  per(accum) = 41.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.899e-01 S  per = 56.5  per(accum) = 97.6
 T(sweep opt: deallocate cpu and gpu memory) = 6.653e-04 S  per = 0.198  per(accum) = 97.8
 T(sweep opt: construct opS [ifdists=true] ) = 2.910e-07 S  per = 8.66e-05  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [nccl]) = 2.090e-07 S  per = 6.22e-05  per(accum) = 97.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.415e-04 S  per = 0.221  per(accum) = 98.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.307e-04 S  per = 0.0389  per(accum) = 98.1
 T(sweep opt: qops_pool join and erase     ) = 6.408e-03 S  per = 1.91  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 9.676e-06 S  per = 0.00288  per(accum) = 100
##### global opt: 1.979e+00 S #####
 T(global opt: fetch) = 7.033e-02 S  per = 3.55  per(accum) = 3.55
 T(global opt: hdiag) = 2.986e-01 S  per = 15.1  per(accum) = 18.6
 T(global opt: dvdsn) = 1.229e+00 S  per = 62.1  per(accum) = 80.7
 T(global opt: decim) = 4.383e-02 S  per = 2.21  per(accum) = 82.9
 T(global opt: guess) = 4.940e-04 S  per = 0.025  per(accum) = 83
 T(global opt: renrm) = 3.359e-01 S  per =   17  per(accum) = 99.9
 T(global opt: save ) = 1.187e-03 S  per = 0.06  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.229e+00 S  T(sum) = 1.228e+00 S  per = 9.992e+01
 T(global opt: preprocess                  ) = 5.821e-04 S  per = 0.0474  per(accum) = 0.0474
 T(global opt: symbolic_formulae           ) = 2.830e-02 S  per =  2.3  per(accum) = 2.35
 T(global opt: hintermediate init          ) = 8.038e-04 S  per = 0.0654  per(accum) = 2.42
 T(global opt: preprocess_hformulae_Hxlist ) = 7.420e-03 S  per = 0.604  per(accum) = 3.02
 T(global opt: hmmtasks init               ) = 1.067e-02 S  per = 0.869  per(accum) = 3.89
 T(global opt: initial guess for dvdson    ) = 1.638e-05 S  per = 0.00133  per(accum) = 3.89
 T(global opt: dvdson [Hx_batchGPU]        ) = 9.959e-01 S  per = 81.1  per(accum) = 85
 T(global opt: dvdson [cpu-gpu]            ) = 2.406e-02 S  per = 1.96  per(accum) = 86.9
 T(global opt: dvdson [nccl]               ) = 1.246e-04 S  per = 0.0101  per(accum) = 86.9
 T(global opt: dvdson [mpi]                ) = 2.353e-06 S  per = 0.000192  per(accum) = 86.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.603e-01 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 3.359e-01 S  T(sum) = 3.359e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.788e-04 S  per = 0.172  per(accum) = 0.172
 T(global opt: qops init                    ) = 6.828e-03 S  per = 2.03  per(accum) = 2.21
 T(global opt: symbolic_formulae_renorm     ) = 2.930e-02 S  per = 8.72  per(accum) = 10.9
 T(global opt: allocate qops on gpu         ) = 2.824e-04 S  per = 0.0841  per(accum) = 11
 T(global opt: site memcpy cpu2gpu          ) = 7.026e-03 S  per = 2.09  per(accum) = 13.1
 T(global opt: rintermediate init           ) = 1.005e-02 S  per = 2.99  per(accum) = 16.1
 T(global opt: preprocess_formulae_Rlist2   ) = 2.081e-02 S  per =  6.2  per(accum) = 22.3
 T(global opt: rmmtasks init                ) = 6.314e-02 S  per = 18.8  per(accum) = 41.1
 T(global opt: qops memset on cpu           ) = 2.080e-07 S  per = 6.19e-05  per(accum) = 41.1
 T(global opt: preprocess_renorm_batchGPU   ) = 1.899e-01 S  per = 56.5  per(accum) = 97.6
 T(global opt: deallocate cpu and gpu memory) = 6.653e-04 S  per = 0.198  per(accum) = 97.8
 T(global opt: construct opS [ifdists=true] ) = 2.910e-07 S  per = 8.66e-05  per(accum) = 97.8
 T(global opt: reduction of opS & opH [nccl]) = 2.090e-07 S  per = 6.22e-05  per(accum) = 97.8
 T(global opt: qops memcpy gpu2cpu          ) = 7.415e-04 S  per = 0.221  per(accum) = 98.1
 T(global opt: reduction of opS & opH [mpi] ) = 1.307e-04 S  per = 0.0389  per(accum) = 98.1
 T(global opt: qops_pool join and erase     ) = 6.408e-03 S  per = 1.91  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 9.676e-06 S  per = 0.00288  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-7.082e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=5/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=787:6.004e-03MB:5.864e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:3.63 S:8.47 A:0 B:86.2 
 rqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4189:0.032MB:3.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.009e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-9.179e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(5,6,4) nnz=23:1.755e-04MB
qtensor3: wf3 own=1 _data=0x3af52480
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=5
 (9,1):3 (8,2):1 (9,3):1
 qbond: qcol nsym=3 dimAll=6
 (20,0):3 (20,-2):2 (21,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=23:1.755e-04MB
### DIAG TIMING: total=2.139e-01 t1=2.300e-05, t2=2.213e-03, t3=2.490e-03, t4=2.092e-01, t5=5.165e-06, t6=1.379e-05, t7=4.001e-06
duration_diagGPU:2.139e-01
duration_diagreduce:4.300e-08
duration_diagtransform:3.810e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.413e-02 S -----
rank=0 GPUmem(GB): used=3.121e-05 (oper)=3.121e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.451e-04 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper,hinter)=3.121e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.507e-03 S size(H_formulae)=813 size(Hxlst2)=6 T(Hmu/Hxlist)=2.024e-03,2.483e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.801e-03 S size(H_formulae)=813 size(Hxlst)=1990 -----
rank=0 GPUmem(GB): used=6.898e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.427e-07 batch[need]=3.262e-04 blksize=9 blksize0=3 batchsize=1990
rank=0 GPUmem(GB): used=3.955e-04 (oper,hinter,dvdson,batch)=3.121e-05,3.777e-05,3.427e-07,3.262e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=23 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.623e-03,1.001e-02,2.982e-02,1.230e-02,5.376e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=1.619e-03 speed=2.117e-04GB/S T(nccl)=4.423e-06 speed=7.749e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=20 t=1.0e-02 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=20 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=7.5e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=20 i=3 t=7.4e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=20 i=4 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=20 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=20 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=20 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.3e+06
----- TIMING FOR sigma_tot : t_inter=2.0e-01 t_gemm=6.0e-01 t_reduction=2.5e-01 tot=1.0e+00 -----
 sigma_tot[inter] counter=20 t=2.0e-01 per=1.9e+01 cost=1.8e+05 flops=9.1e+05
 sigma_tot[gemm] counter=20 i=0 t=4.1e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=3.4e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=1.5e-01 per=1.4e+01 cost=4.9e+04 flops=3.3e+05
 sigma_tot[gemm] counter=20 i=3 t=1.5e-01 per=1.4e+01 cost=4.8e+04 flops=3.2e+05
 sigma_tot[gemm] counter=20 i=4 t=1.5e-01 per=1.4e+01 cost=8.6e+04 flops=5.7e+05
 sigma_tot[gemm] counter=20 i=5 t=1.5e-01 per=1.4e+01 cost=8.4e+04 flops=5.6e+05
 sigma_tot[gemm] counter=20 total t=6.0e-01 per=5.7e+01 cost=2.7e+05 flops=4.5e+05
 sigma_tot[red] counter=20 t=2.5e-01 per=2.4e+01 cost=8.1e+04 flops=3.3e+05
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.0e-06,1.9e-06,6.5e-07,1.6e-07
settings: ndim=23 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.208089881617 -1.116e+03  9.302e-03    1     1  5.387e-02 5.387e-02 5.384e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.234e-03,1.195e-02,2.964e-02,1.246e-02,5.529e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=1.227e-03 speed=2.793e-04GB/S T(nccl)=6.894e-06 speed=4.971e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.4e-02 -----
 sigma[inter] counter=21 t=1.2e-02 per=2.2e+01 cost=3.7e+04 flops=3.1e+06
 sigma[gemm] counter=21 i=0 t=5.5e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=4.7e-06 per=8.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=7.4e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=21 i=3 t=7.4e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=21 i=4 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=21 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=21 total t=3.0e-02 per=5.5e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=21 t=1.2e-02 per=2.3e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=2.1e-01 t_gemm=6.3e-01 t_reduction=2.6e-01 tot=1.1e+00 -----
 sigma_tot[inter] counter=21 t=2.1e-01 per=1.9e+01 cost=2.2e+05 flops=1.0e+06
 sigma_tot[gemm] counter=21 i=0 t=4.6e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=3.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=1.6e-01 per=1.4e+01 cost=5.9e+04 flops=3.8e+05
 sigma_tot[gemm] counter=21 i=3 t=1.6e-01 per=1.4e+01 cost=5.8e+04 flops=3.7e+05
 sigma_tot[gemm] counter=21 i=4 t=1.6e-01 per=1.4e+01 cost=1.0e+05 flops=6.5e+05
 sigma_tot[gemm] counter=21 i=5 t=1.6e-01 per=1.4e+01 cost=1.0e+05 flops=6.5e+05
 sigma_tot[gemm] counter=21 total t=6.3e-01 per=5.7e+01 cost=3.2e+05 flops=5.1e+05
 sigma_tot[red] counter=21 t=2.6e-01 per=2.4e+01 cost=9.7e+04 flops=3.7e+05
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=9.6e-06,3.6e-05,7.3e-06,2.0e-06,4.9e-07
    2   0 -    -116.208814694433 -7.248e-04  1.720e-03    2     2  1.190e-01 5.951e-02 5.468e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.533e-03,1.233e-02,2.965e-02,1.247e-02,5.968e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=2.519e-03 speed=1.361e-04GB/S T(nccl)=1.401e-05 speed=2.446e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.4e-02 -----
 sigma[inter] counter=22 t=1.2e-02 per=2.3e+01 cost=3.7e+04 flops=3.0e+06
 sigma[gemm] counter=22 i=0 t=8.3e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=7.3e-03 per=1.3e+01 cost=9.9e+03 flops=1.4e+06
 sigma[gemm] counter=22 i=3 t=7.4e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=22 i=4 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=22 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=22 total t=3.0e-02 per=5.4e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=22 t=1.2e-02 per=2.3e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=2.2e-01 t_gemm=6.6e-01 t_reduction=2.7e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=22 t=2.2e-01 per=1.9e+01 cost=2.5e+05 flops=1.1e+06
 sigma_tot[gemm] counter=22 i=0 t=5.4e-05 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=4.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=1.6e-01 per=1.4e+01 cost=6.9e+04 flops=4.2e+05
 sigma_tot[gemm] counter=22 i=3 t=1.6e-01 per=1.4e+01 cost=6.8e+04 flops=4.1e+05
 sigma_tot[gemm] counter=22 i=4 t=1.6e-01 per=1.4e+01 cost=1.2e+05 flops=7.3e+05
 sigma_tot[gemm] counter=22 i=5 t=1.6e-01 per=1.4e+01 cost=1.2e+05 flops=7.2e+05
 sigma_tot[gemm] counter=22 total t=6.6e-01 per=5.7e+01 cost=3.7e+05 flops=5.7e+05
 sigma_tot[red] counter=22 t=2.7e-01 per=2.4e+01 cost=1.1e+05 flops=4.1e+05
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=9.7e-06,2.7e-05,4.4e-06,1.7e-06,2.1e-07
    3   0 -    -116.208827574025 -1.288e-05  4.129e-04    3     3  1.987e-01 6.623e-02 5.639e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.380e-04,1.009e-02,3.009e-02,1.239e-02,5.333e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=7.321e-04 speed=4.681e-04GB/S T(nccl)=5.874e-06 speed=5.835e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=23 t=1.0e-02 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=23 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=7.5e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=23 i=3 t=7.4e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=23 i=4 t=7.6e-03 per=1.4e+01 cost=1.7e+04 flops=2.2e+06
 sigma[gemm] counter=23 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=23 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=23 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=2.3e-01 t_gemm=6.9e-01 t_reduction=2.9e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=23 t=2.3e-01 per=1.9e+01 cost=2.9e+05 flops=1.3e+06
 sigma_tot[gemm] counter=23 i=0 t=5.6e-05 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=4.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=1.7e-01 per=1.4e+01 cost=7.9e+04 flops=4.6e+05
 sigma_tot[gemm] counter=23 i=3 t=1.7e-01 per=1.4e+01 cost=7.7e+04 flops=4.5e+05
 sigma_tot[gemm] counter=23 i=4 t=1.7e-01 per=1.4e+01 cost=1.4e+05 flops=7.9e+05
 sigma_tot[gemm] counter=23 i=5 t=1.7e-01 per=1.4e+01 cost=1.4e+05 flops=7.9e+05
 sigma_tot[gemm] counter=23 total t=6.9e-01 per=5.7e+01 cost=4.3e+05 flops=6.2e+05
 sigma_tot[red] counter=23 t=2.9e-01 per=2.4e+01 cost=1.3e+05 flops=4.5e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.6e-05,3.2e-06,9.4e-07,2.1e-07
    4   0 +    -116.208828591192 -1.017e-06  5.775e-05    3     4  2.642e-01 6.605e-02 5.565e-02
TIMING FOR Davidson : 2.642e-01  T(cal/comm/rest)=2.226e-01,6.670e-07,4.160e-02
decomposed t_rest=4.160e-02
 T(sub)    =1.325e-04 per=3.186e-01
 T(precond)=4.123e-02 per=9.910e+01
 T(ortho)  =1.150e-04 per=2.764e-01
 T(xcopy)  =6.720e-07 per=1.615e-03
 T(xnrm2)  =2.414e-06 per=5.803e-03
 T(other)  =1.240e-04 per=2.980e-01
optimized energies: isweep=0 ibond=5 dots=1 e[0]=-116.208828591192 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.061e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=8 dimAll=20
 (9,1):4 (11,1):3 (10,2):5 (10,0):3 (8,2):1 (9,3):2 (11,3):1 (10,4):1
timing for divide=1.1e-05
timing for compute=1.1e-02
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,1.1e-02,0.0e+00,4.3e-06,1.6e-05 -----
decimation summary: 20->6 dwt=+0.000e+00 SvN=1.007e+00
 qbond: qkept nsym=3 dimAll=6
 (10,0):3 (10,2):2 (9,1):1
----- TIMING for decimation_row(nkr): 1.184e-02 S T(decim/select/formRot)=1.156e-02,2.589e-04,2.014e-05 -----
----- TIMING FOR onedot_decimation: 1.191e-02 S T(wf/decim)=5.742e-05,1.185e-02 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:2.94 S:5.45 A:0 B:90.4 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.243e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 9.561e-03 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper)=3.121e-05
rank=0 GPUmem(GB): used=6.916e-05 (oper,site)=3.121e-05,1.714e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:4.051e-02MB:3.956e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.495e-03 S -----
rank=0 GPUmem(GB): used=1.087e-04 (oper,site,rinter)=3.121e-05,1.714e-07,3.956e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.662e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=1.594e-03,1.068e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.816e-03 S size(rtasks)=237 size(Rlst)=647 -----
rank=0 GPUmem(GB): used=1.087e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.350e-04 blksize=9 blksize0=9 batchsize=647
rank=0 GPUmem(GB): used=2.437e-04 (oper,site,rinter,batch)=3.121e-05,1.714e-07,3.956e-05,1.350e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.969e-03,2.251e-02,1.042e-02
----- TIMING FOR renorm : t_inter=7.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=6 t=7.0e-03 per=1.7e+01 cost=5.4e+04 flops=7.7e+06
 renorm[gemm] counter=6 i=0 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=4 t=7.6e-03 per=1.9e+01 cost=2.3e+03 flops=3.1e+05
 renorm[gemm] counter=6 i=5 t=7.5e-03 per=1.9e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=6 i=6 t=7.5e-03 per=1.9e+01 cost=9.2e+03 flops=1.2e+06
 renorm[gemm] counter=6 total t=2.3e-02 per=5.6e+01 cost=2.0e+04 flops=8.7e+05
 renorm[red] counter=6 t=1.0e-02 per=2.6e+01 cost=4.4e+03 flops=4.2e+05
----- TIMING FOR renorm_tot : t_inter=3.5e-02 t_gemm=1.3e-01 t_reduction=6.0e-02 tot=2.3e-01 -----
 renorm_tot[inter] counter=6 t=3.5e-02 per=1.5e+01 cost=1.9e+05 flops=5.5e+06
 renorm_tot[gemm] counter=6 i=0 t=9.4e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=7.9e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=7.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=3 t=7.5e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=4 t=4.3e-02 per=1.9e+01 cost=1.8e+05 flops=4.2e+06
 renorm_tot[gemm] counter=6 i=5 t=4.5e-02 per=2.0e+01 cost=1.7e+05 flops=3.8e+06
 renorm_tot[gemm] counter=6 i=6 t=4.5e-02 per=2.0e+01 cost=1.2e+06 flops=2.7e+07
 renorm_tot[gemm] counter=6 total t=1.3e-01 per=5.8e+01 cost=1.6e+06 flops=1.2e+07
 renorm_tot[red] counter=6 t=6.0e-02 per=2.6e+01 cost=5.6e+05 flops=9.3e+06
qops.to_cpu: size(tot)=1192:9.1e-03MB:8.9e-06GB T(to_cpu)=2.3e-04S speed=3.8e-02GB/S
check ||H-H.dagger||=5.025e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0626 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=6.447e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.129e-03 change=-1.721e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.129e-03 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.961e-01 S #####
 T(local opt: fetch) = 1.044e-02 S  per = 1.75  per(accum) = 1.75
 T(local opt: hdiag) = 2.140e-01 S  per = 35.9  per(accum) = 37.6
 T(local opt: dvdsn) = 2.942e-01 S  per = 49.4  per(accum) = 87
 T(local opt: decim) = 1.192e-02 S  per =    2  per(accum) = 89
 T(local opt: guess) = 7.955e-05 S  per = 0.0133  per(accum) = 89
 T(local opt: renrm) = 6.524e-02 S  per = 10.9  per(accum) = 100
 T(local opt: save ) = 2.793e-04 S  per = 0.0468  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.942e-01 S  T(sum) = 2.939e-01 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 9.495e-05 S  per = 0.0323  per(accum) = 0.0323
 T(local opt: symbolic_formulae           ) = 1.414e-02 S  per = 4.81  per(accum) = 4.84
 T(local opt: hintermediate init          ) = 3.610e-04 S  per = 0.123  per(accum) = 4.97
 T(local opt: preprocess_hformulae_Hxlist ) = 4.858e-03 S  per = 1.65  per(accum) = 6.62
 T(local opt: hmmtasks init               ) = 1.023e-02 S  per = 3.48  per(accum) = 10.1
 T(local opt: initial guess for dvdson    ) = 2.593e-06 S  per = 0.000882  per(accum) = 10.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.165e-01 S  per = 73.7  per(accum) = 83.8
 T(local opt: dvdson [cpu-gpu]            ) = 6.097e-03 S  per = 2.07  per(accum) = 85.8
 T(local opt: dvdson [nccl]               ) = 3.120e-05 S  per = 0.0106  per(accum) = 85.8
 T(local opt: dvdson [mpi]                ) = 6.670e-07 S  per = 0.000227  per(accum) = 85.8
 T(local opt: dvdson [rest part(linalg)]  ) = 4.160e-02 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 6.524e-02 S  T(sum) = 6.524e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.782e-04 S  per = 1.04  per(accum) = 1.04
 T(local opt: qops init                    ) = 1.781e-03 S  per = 2.73  per(accum) = 3.77
 T(local opt: symbolic_formulae_renorm     ) = 9.576e-03 S  per = 14.7  per(accum) = 18.4
 T(local opt: allocate qops on gpu         ) = 6.566e-05 S  per = 0.101  per(accum) = 18.5
 T(local opt: site memcpy cpu2gpu          ) = 1.050e-03 S  per = 1.61  per(accum) = 20.2
 T(local opt: rintermediate init           ) = 2.507e-03 S  per = 3.84  per(accum) = 24
 T(local opt: preprocess_formulae_Rlist2   ) = 2.841e-03 S  per = 4.35  per(accum) = 28.4
 T(local opt: rmmtasks init                ) = 4.499e-03 S  per =  6.9  per(accum) = 35.2
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 6.59e-05  per(accum) = 35.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.999e-02 S  per = 61.3  per(accum) = 96.6
 T(local opt: deallocate cpu and gpu memory) = 4.791e-05 S  per = 0.0734  per(accum) = 96.6
 T(local opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 8.58e-05  per(accum) = 96.6
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 5.82e-05  per(accum) = 96.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.408e-04 S  per = 0.369  per(accum) = 97
 T(local opt: reduction of opS & opH [mpi] ) = 1.686e-05 S  per = 0.0258  per(accum) = 97
 T(local opt: qops_pool join and erase     ) = 1.943e-03 S  per = 2.98  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.662e-06 S  per = 0.00255  per(accum) = 100
##### sweep opt: 2.576e+00 S #####
 T(sweep opt: fetch) = 8.077e-02 S  per = 3.14  per(accum) = 3.14
 T(sweep opt: hdiag) = 5.125e-01 S  per = 19.9  per(accum) = 23
 T(sweep opt: dvdsn) = 1.523e+00 S  per = 59.1  per(accum) = 82.2
 T(sweep opt: decim) = 5.575e-02 S  per = 2.16  per(accum) = 84.3
 T(sweep opt: guess) = 5.736e-04 S  per = 0.0223  per(accum) = 84.4
 T(sweep opt: renrm) = 4.011e-01 S  per = 15.6  per(accum) = 99.9
 T(sweep opt: save ) = 1.466e-03 S  per = 0.0569  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.523e+00 S  T(sum) = 1.522e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 6.771e-04 S  per = 0.0445  per(accum) = 0.0445
 T(sweep opt: symbolic_formulae           ) = 4.244e-02 S  per = 2.79  per(accum) = 2.83
 T(sweep opt: hintermediate init          ) = 1.165e-03 S  per = 0.0765  per(accum) = 2.91
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.228e-02 S  per = 0.807  per(accum) = 3.72
 T(sweep opt: hmmtasks init               ) = 2.090e-02 S  per = 1.37  per(accum) = 5.09
 T(sweep opt: initial guess for dvdson    ) = 1.897e-05 S  per = 0.00125  per(accum) = 5.09
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.212e+00 S  per = 79.7  per(accum) = 84.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.016e-02 S  per = 1.98  per(accum) = 86.7
 T(sweep opt: dvdson [nccl]               ) = 1.558e-04 S  per = 0.0102  per(accum) = 86.7
 T(sweep opt: dvdson [mpi]                ) = 3.020e-06 S  per = 0.000198  per(accum) = 86.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.019e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 4.011e-01 S  T(sum) = 4.011e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.257e-03 S  per = 0.313  per(accum) = 0.313
 T(sweep opt: qops init                    ) = 8.609e-03 S  per = 2.15  per(accum) = 2.46
 T(sweep opt: symbolic_formulae_renorm     ) = 3.887e-02 S  per = 9.69  per(accum) = 12.2
 T(sweep opt: allocate qops on gpu         ) = 3.481e-04 S  per = 0.0868  per(accum) = 12.2
 T(sweep opt: site memcpy cpu2gpu          ) = 8.076e-03 S  per = 2.01  per(accum) = 14.3
 T(sweep opt: rintermediate init           ) = 1.256e-02 S  per = 3.13  per(accum) = 17.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.365e-02 S  per =  5.9  per(accum) = 23.3
 T(sweep opt: rmmtasks init                ) = 6.764e-02 S  per = 16.9  per(accum) = 40.1
 T(sweep opt: qops memset on cpu           ) = 2.510e-07 S  per = 6.26e-05  per(accum) = 40.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.299e-01 S  per = 57.3  per(accum) = 97.5
 T(sweep opt: deallocate cpu and gpu memory) = 7.132e-04 S  per = 0.178  per(accum) = 97.6
 T(sweep opt: construct opS [ifdists=true] ) = 3.470e-07 S  per = 8.65e-05  per(accum) = 97.6
 T(sweep opt: reduction of opS & opH [nccl]) = 2.470e-07 S  per = 6.16e-05  per(accum) = 97.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.822e-04 S  per = 0.245  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.476e-04 S  per = 0.0368  per(accum) = 97.9
 T(sweep opt: qops_pool join and erase     ) = 8.351e-03 S  per = 2.08  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.134e-05 S  per = 0.00283  per(accum) = 100
##### global opt: 2.576e+00 S #####
 T(global opt: fetch) = 8.077e-02 S  per = 3.14  per(accum) = 3.14
 T(global opt: hdiag) = 5.125e-01 S  per = 19.9  per(accum) = 23
 T(global opt: dvdsn) = 1.523e+00 S  per = 59.1  per(accum) = 82.2
 T(global opt: decim) = 5.575e-02 S  per = 2.16  per(accum) = 84.3
 T(global opt: guess) = 5.736e-04 S  per = 0.0223  per(accum) = 84.4
 T(global opt: renrm) = 4.011e-01 S  per = 15.6  per(accum) = 99.9
 T(global opt: save ) = 1.466e-03 S  per = 0.0569  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.523e+00 S  T(sum) = 1.522e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 6.771e-04 S  per = 0.0445  per(accum) = 0.0445
 T(global opt: symbolic_formulae           ) = 4.244e-02 S  per = 2.79  per(accum) = 2.83
 T(global opt: hintermediate init          ) = 1.165e-03 S  per = 0.0765  per(accum) = 2.91
 T(global opt: preprocess_hformulae_Hxlist ) = 1.228e-02 S  per = 0.807  per(accum) = 3.72
 T(global opt: hmmtasks init               ) = 2.090e-02 S  per = 1.37  per(accum) = 5.09
 T(global opt: initial guess for dvdson    ) = 1.897e-05 S  per = 0.00125  per(accum) = 5.09
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.212e+00 S  per = 79.7  per(accum) = 84.7
 T(global opt: dvdson [cpu-gpu]            ) = 3.016e-02 S  per = 1.98  per(accum) = 86.7
 T(global opt: dvdson [nccl]               ) = 1.558e-04 S  per = 0.0102  per(accum) = 86.7
 T(global opt: dvdson [mpi]                ) = 3.020e-06 S  per = 0.000198  per(accum) = 86.7
 T(global opt: dvdson [rest part(linalg)]  ) = 2.019e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 4.011e-01 S  T(sum) = 4.011e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.257e-03 S  per = 0.313  per(accum) = 0.313
 T(global opt: qops init                    ) = 8.609e-03 S  per = 2.15  per(accum) = 2.46
 T(global opt: symbolic_formulae_renorm     ) = 3.887e-02 S  per = 9.69  per(accum) = 12.2
 T(global opt: allocate qops on gpu         ) = 3.481e-04 S  per = 0.0868  per(accum) = 12.2
 T(global opt: site memcpy cpu2gpu          ) = 8.076e-03 S  per = 2.01  per(accum) = 14.3
 T(global opt: rintermediate init           ) = 1.256e-02 S  per = 3.13  per(accum) = 17.4
 T(global opt: preprocess_formulae_Rlist2   ) = 2.365e-02 S  per =  5.9  per(accum) = 23.3
 T(global opt: rmmtasks init                ) = 6.764e-02 S  per = 16.9  per(accum) = 40.1
 T(global opt: qops memset on cpu           ) = 2.510e-07 S  per = 6.26e-05  per(accum) = 40.1
 T(global opt: preprocess_renorm_batchGPU   ) = 2.299e-01 S  per = 57.3  per(accum) = 97.5
 T(global opt: deallocate cpu and gpu memory) = 7.132e-04 S  per = 0.178  per(accum) = 97.6
 T(global opt: construct opS [ifdists=true] ) = 3.470e-07 S  per = 8.65e-05  per(accum) = 97.6
 T(global opt: reduction of opS & opH [nccl]) = 2.470e-07 S  per = 6.16e-05  per(accum) = 97.6
 T(global opt: qops memcpy gpu2cpu          ) = 9.822e-04 S  per = 0.245  per(accum) = 97.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.476e-04 S  per = 0.0368  per(accum) = 97.9
 T(global opt: qops_pool join and erase     ) = 8.351e-03 S  per = 2.08  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.134e-05 S  per = 0.00283  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.038e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=6/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=783:5.974e-03MB:5.834e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:2.94 S:5.45 A:0 B:90.4 
 rqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5034:0.0384MB:3.75e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.042e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.109e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x3ab6a000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (10,0):3 (10,2):2 (9,1):1
 qbond: qcol nsym=3 dimAll=6
 (18,0):3 (18,-2):2 (19,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=2.523e-01 t1=2.943e-05, t2=2.253e-03, t3=2.555e-03, t4=2.474e-01, t5=1.232e-05, t6=1.402e-05, t7=1.338e-05
duration_diagGPU:2.523e-01
duration_diagreduce:7.600e-08
duration_diagtransform:5.060e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.811e-02 S -----
rank=0 GPUmem(GB): used=3.751e-05 (oper)=3.751e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.518e-04 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper,hinter)=3.751e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.320e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.619e-03,2.701e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.676e-03 S size(H_formulae)=1053 size(Hxlst)=2250 -----
rank=0 GPUmem(GB): used=8.382e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=3.688e-04 blksize=9 blksize0=3 batchsize=2250
rank=0 GPUmem(GB): used=4.529e-04 (oper,hinter,dvdson,batch)=3.751e-05,4.631e-05,2.831e-07,3.688e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.077e-04,9.875e-03,3.003e-02,1.255e-02,5.317e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=6.880e-04 speed=4.115e-04GB/S T(nccl)=1.966e-05 speed=1.440e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=24 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.3e+06
 sigma[gemm] counter=24 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=24 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=24 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=24 i=5 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=24 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=24 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=2.4e-01 t_gemm=7.2e-01 t_reduction=3.0e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=24 t=2.4e-01 per=1.9e+01 cost=3.3e+05 flops=1.4e+06
 sigma_tot[gemm] counter=24 i=0 t=5.8e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=4.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=1.8e-01 per=1.4e+01 cost=9.0e+04 flops=5.0e+05
 sigma_tot[gemm] counter=24 i=3 t=1.8e-01 per=1.4e+01 cost=8.9e+04 flops=5.0e+05
 sigma_tot[gemm] counter=24 i=4 t=1.8e-01 per=1.4e+01 cost=1.6e+05 flops=8.8e+05
 sigma_tot[gemm] counter=24 i=5 t=1.8e-01 per=1.4e+01 cost=1.6e+05 flops=8.7e+05
 sigma_tot[gemm] counter=24 total t=7.2e-01 per=5.7e+01 cost=4.9e+05 flops=6.9e+05
 sigma_tot[red] counter=24 t=3.0e-01 per=2.4e+01 cost=1.5e+05 flops=4.9e+05
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.1e-06,1.9e-06,6.7e-07,1.7e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.208828591192 -1.116e+03  4.959e-02    1     1  5.328e-02 5.328e-02 5.326e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.493e-03,9.946e-03,2.961e-02,1.241e-02,5.346e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.489e-03 speed=1.902e-04GB/S T(nccl)=4.474e-06 speed=6.328e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=25 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=25 i=0 t=1.9e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=7.4e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=25 i=3 t=7.4e-03 per=1.4e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=25 i=4 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=25 i=5 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=25 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=25 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=2.5e-01 t_gemm=7.5e-01 t_reduction=3.1e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=25 t=2.5e-01 per=1.9e+01 cost=3.8e+05 flops=1.5e+06
 sigma_tot[gemm] counter=25 i=0 t=6.0e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=4.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=1.9e-01 per=1.4e+01 cost=1.0e+05 flops=5.4e+05
 sigma_tot[gemm] counter=25 i=3 t=1.9e-01 per=1.4e+01 cost=1.0e+05 flops=5.4e+05
 sigma_tot[gemm] counter=25 i=4 t=1.9e-01 per=1.4e+01 cost=1.8e+05 flops=9.6e+05
 sigma_tot[gemm] counter=25 i=5 t=1.9e-01 per=1.4e+01 cost=1.8e+05 flops=9.5e+05
 sigma_tot[gemm] counter=25 total t=7.5e-01 per=5.7e+01 cost=5.6e+05 flops=7.5e+05
 sigma_tot[red] counter=25 t=3.1e-01 per=2.4e+01 cost=1.6e+05 flops=5.3e+05
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=8.3e-06,1.1e-05,3.3e-06,8.7e-07,1.8e-07
    2   0 -    -116.221269861784 -1.244e-02  6.706e-03    2     2  1.162e-01 5.808e-02 5.340e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.424e-03,1.007e-02,3.007e-02,1.248e-02,5.405e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.417e-03 speed=1.997e-04GB/S T(nccl)=6.908e-06 speed=4.098e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=26 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=26 i=0 t=2.0e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=26 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=26 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=26 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=26 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=26 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=2.6e-01 t_gemm=7.8e-01 t_reduction=3.2e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=26 t=2.6e-01 per=1.9e+01 cost=4.2e+05 flops=1.6e+06
 sigma_tot[gemm] counter=26 i=0 t=6.2e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=4.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=1.9e-01 per=1.4e+01 cost=1.1e+05 flops=5.8e+05
 sigma_tot[gemm] counter=26 i=3 t=1.9e-01 per=1.4e+01 cost=1.1e+05 flops=5.8e+05
 sigma_tot[gemm] counter=26 i=4 t=1.9e-01 per=1.4e+01 cost=2.0e+05 flops=1.0e+06
 sigma_tot[gemm] counter=26 i=5 t=1.9e-01 per=1.4e+01 cost=2.0e+05 flops=1.0e+06
 sigma_tot[gemm] counter=26 total t=7.8e-01 per=5.7e+01 cost=6.2e+05 flops=8.0e+05
 sigma_tot[red] counter=26 t=3.2e-01 per=2.4e+01 cost=1.8e+05 flops=5.6e+05
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.7e-05,2.9e-06,9.4e-07,2.0e-07
    3   0 -    -116.221542303165 -2.724e-04  1.927e-03    3     3  1.797e-01 5.989e-02 5.365e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.425e-04,1.002e-02,3.012e-02,1.250e-02,5.299e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=3.374e-04 speed=8.392e-04GB/S T(nccl)=5.168e-06 speed=5.478e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=27 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=27 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=27 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=27 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=27 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=27 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=27 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=2.7e-01 t_gemm=8.1e-01 t_reduction=3.4e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=27 t=2.7e-01 per=1.9e+01 cost=4.6e+05 flops=1.7e+06
 sigma_tot[gemm] counter=27 i=0 t=6.3e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=4.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=2.0e-01 per=1.4e+01 cost=1.2e+05 flops=6.1e+05
 sigma_tot[gemm] counter=27 i=3 t=2.0e-01 per=1.4e+01 cost=1.2e+05 flops=6.1e+05
 sigma_tot[gemm] counter=27 i=4 t=2.0e-01 per=1.4e+01 cost=2.2e+05 flops=1.1e+06
 sigma_tot[gemm] counter=27 i=5 t=2.0e-01 per=1.4e+01 cost=2.2e+05 flops=1.1e+06
 sigma_tot[gemm] counter=27 total t=8.1e-01 per=5.7e+01 cost=6.9e+05 flops=8.5e+05
 sigma_tot[red] counter=27 t=3.4e-01 per=2.4e+01 cost=2.0e+05 flops=5.9e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,2.9e-06,9.4e-07,2.1e-07
    4   0 -    -116.221563718018 -2.141e-05  2.777e-04    3     4  2.473e-01 6.184e-02 5.351e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.092e-04,9.912e-03,3.042e-02,1.263e-02,5.338e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=4.044e-04 speed=7.001e-04GB/S T(nccl)=4.811e-06 speed=5.885e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=28 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=28 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=28 i=3 t=7.7e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=28 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=28 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=28 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=28 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=2.8e-01 t_gemm=8.4e-01 t_reduction=3.5e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=28 t=2.8e-01 per=1.9e+01 cost=5.0e+05 flops=1.8e+06
 sigma_tot[gemm] counter=28 i=0 t=6.5e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=5.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=2.1e-01 per=1.4e+01 cost=1.3e+05 flops=6.5e+05
 sigma_tot[gemm] counter=28 i=3 t=2.1e-01 per=1.4e+01 cost=1.4e+05 flops=6.5e+05
 sigma_tot[gemm] counter=28 i=4 t=2.1e-01 per=1.4e+01 cost=2.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=28 i=5 t=2.1e-01 per=1.4e+01 cost=2.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=28 total t=8.4e-01 per=5.7e+01 cost=7.6e+05 flops=9.0e+05
 sigma_tot[red] counter=28 t=3.5e-01 per=2.4e+01 cost=2.2e+05 flops=6.2e+05
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.3e-05,2.8e-06,9.1e-07,2.1e-07
    5   0 +    -116.221564167486 -4.495e-07  6.231e-05    3     5  3.133e-01 6.265e-02 5.350e-02
TIMING FOR Davidson : 3.133e-01  T(cal/comm/rest)=2.675e-01,4.540e-07,4.579e-02
decomposed t_rest=4.579e-02
 T(sub)    =1.013e-04 per=2.213e-01
 T(precond)=4.556e-02 per=9.948e+01
 T(ortho)  =1.589e-05 per=3.471e-02
 T(xcopy)  =7.250e-07 per=1.583e-03
 T(xnrm2)  =2.941e-06 per=6.422e-03
 T(other)  =1.169e-04 per=2.552e-01
optimized energies: isweep=0 ibond=6 dots=1 e[0]=-116.221564167486 nmvp=5
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.269e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=8 dimAll=24
 (10,0):4 (12,0):3 (11,1):6 (11,-1):3 (10,2):3 (12,2):2 (11,3):2 (9,1):1
timing for divide=9.3e-06
timing for compute=1.3e-02
timing for collect=4.2e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.3e-06,1.3e-02,0.0e+00,4.4e-06,4.2e-05 -----
decimation summary: 24->6 dwt=+0.000e+00 SvN=9.121e-01
 qbond: qkept nsym=3 dimAll=6
 (12,0):3 (12,2):2 (11,1):1
----- TIMING for decimation_row(nkr): 1.346e-02 S T(decim/select/formRot)=1.323e-02,2.150e-04,2.093e-05 -----
----- TIMING FOR onedot_decimation: 1.353e-02 S T(wf/decim)=5.438e-05,1.348e-02 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:2.66 S:3.98 A:0 B:92.4 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.546e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 1.209e-02 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper)=3.751e-05
rank=0 GPUmem(GB): used=8.396e-05 (oper,site)=3.751e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:4.988e-02MB:4.871e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.483e-03 S -----
rank=0 GPUmem(GB): used=1.327e-04 (oper,site,rinter)=3.751e-05,1.416e-07,4.871e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.718e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=1.664e-03,1.055e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.872e-03 S size(rtasks)=297 size(Rlst)=647 -----
rank=0 GPUmem(GB): used=1.327e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.350e-04 blksize=9 blksize0=9 batchsize=647
rank=0 GPUmem(GB): used=2.676e-04 (oper,site,rinter,batch)=3.751e-05,1.416e-07,4.871e-05,1.350e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.598e-03,2.278e-02,1.008e-02
----- TIMING FOR renorm : t_inter=5.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=7 t=5.6e-03 per=1.5e+01 cost=7.0e+04 flops=1.3e+07
 renorm[gemm] counter=7 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=3 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=4 t=7.6e-03 per=2.0e+01 cost=2.7e+03 flops=3.6e+05
 renorm[gemm] counter=7 i=5 t=7.6e-03 per=2.0e+01 cost=9.6e+03 flops=1.2e+06
 renorm[gemm] counter=7 i=6 t=7.6e-03 per=2.0e+01 cost=9.4e+03 flops=1.2e+06
 renorm[gemm] counter=7 total t=2.3e-02 per=5.9e+01 cost=2.2e+04 flops=9.5e+05
 renorm[red] counter=7 t=1.0e-02 per=2.6e+01 cost=3.9e+03 flops=3.9e+05
----- TIMING FOR renorm_tot : t_inter=4.1e-02 t_gemm=1.6e-01 t_reduction=7.0e-02 tot=2.7e-01 -----
 renorm_tot[inter] counter=7 t=4.1e-02 per=1.5e+01 cost=2.6e+05 flops=6.5e+06
 renorm_tot[gemm] counter=7 i=0 t=1.1e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=9.1e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=8.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=3 t=8.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=4 t=5.1e-02 per=1.9e+01 cost=1.9e+05 flops=3.7e+06
 renorm_tot[gemm] counter=7 i=5 t=5.3e-02 per=2.0e+01 cost=1.8e+05 flops=3.4e+06
 renorm_tot[gemm] counter=7 i=6 t=5.3e-02 per=2.0e+01 cost=1.2e+06 flops=2.3e+07
 renorm_tot[gemm] counter=7 total t=1.6e-01 per=5.9e+01 cost=1.6e+06 flops=1.0e+07
 renorm_tot[red] counter=7 t=7.0e-02 per=2.6e+01 cost=5.7e+05 flops=8.0e+06
qops.to_cpu: size(tot)=1506:1.1e-02MB:1.1e-05GB T(to_cpu)=2.8e-04S speed=4.0e-02GB/S
check ||H-H.dagger||=1.533e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0634 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.613e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.122e-03 change=-1.895e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.122e-03 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.939e-01 S #####
 T(local opt: fetch) = 1.312e-02 S  per = 1.89  per(accum) = 1.89
 T(local opt: hdiag) = 2.523e-01 S  per = 36.4  per(accum) = 38.3
 T(local opt: dvdsn) = 3.492e-01 S  per = 50.3  per(accum) = 88.6
 T(local opt: decim) = 1.354e-02 S  per = 1.95  per(accum) = 90.5
 T(local opt: guess) = 2.283e-04 S  per = 0.0329  per(accum) = 90.6
 T(local opt: renrm) = 6.514e-02 S  per = 9.39  per(accum) = 100
 T(local opt: save ) = 2.399e-04 S  per = 0.0346  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.492e-01 S  T(sum) = 3.489e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 9.812e-05 S  per = 0.0281  per(accum) = 0.0281
 T(local opt: symbolic_formulae           ) = 1.812e-02 S  per = 5.19  per(accum) = 5.22
 T(local opt: hintermediate init          ) = 4.688e-04 S  per = 0.134  per(accum) = 5.36
 T(local opt: preprocess_hformulae_Hxlist ) = 5.746e-03 S  per = 1.65  per(accum) = 7
 T(local opt: hmmtasks init               ) = 1.121e-02 S  per = 3.21  per(accum) = 10.2
 T(local opt: initial guess for dvdson    ) = 2.532e-06 S  per = 0.000726  per(accum) = 10.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.631e-01 S  per = 75.4  per(accum) = 85.6
 T(local opt: dvdson [cpu-gpu]            ) = 4.336e-03 S  per = 1.24  per(accum) = 86.9
 T(local opt: dvdson [nccl]               ) = 4.102e-05 S  per = 0.0118  per(accum) = 86.9
 T(local opt: dvdson [mpi]                ) = 4.540e-07 S  per = 0.00013  per(accum) = 86.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.579e-02 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 6.514e-02 S  T(sum) = 6.514e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.395e-04 S  per = 0.214  per(accum) = 0.214
 T(local opt: qops init                    ) = 2.463e-03 S  per = 3.78  per(accum) = 4
 T(local opt: symbolic_formulae_renorm     ) = 1.211e-02 S  per = 18.6  per(accum) = 22.6
 T(local opt: allocate qops on gpu         ) = 5.740e-05 S  per = 0.0881  per(accum) = 22.7
 T(local opt: site memcpy cpu2gpu          ) = 7.914e-04 S  per = 1.21  per(accum) = 23.9
 T(local opt: rintermediate init           ) = 2.497e-03 S  per = 3.83  per(accum) = 27.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.899e-03 S  per = 4.45  per(accum) = 32.2
 T(local opt: rmmtasks init                ) = 3.701e-03 S  per = 5.68  per(accum) = 37.9
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 4.91e-05  per(accum) = 37.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.855e-02 S  per = 59.2  per(accum) = 97
 T(local opt: deallocate cpu and gpu memory) = 4.143e-05 S  per = 0.0636  per(accum) = 97.1
 T(local opt: construct opS [ifdists=true] ) = 5.500e-08 S  per = 8.44e-05  per(accum) = 97.1
 T(local opt: reduction of opS & opH [nccl]) = 4.500e-08 S  per = 6.91e-05  per(accum) = 97.1
 T(local opt: qops memcpy gpu2cpu          ) = 2.890e-04 S  per = 0.444  per(accum) = 97.5
 T(local opt: reduction of opS & opH [mpi] ) = 2.034e-05 S  per = 0.0312  per(accum) = 97.6
 T(local opt: qops_pool join and erase     ) = 1.586e-03 S  per = 2.44  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.625e-06 S  per = 0.00249  per(accum) = 100
##### sweep opt: 3.269e+00 S #####
 T(sweep opt: fetch) = 9.389e-02 S  per = 2.87  per(accum) = 2.87
 T(sweep opt: hdiag) = 7.649e-01 S  per = 23.4  per(accum) = 26.3
 T(sweep opt: dvdsn) = 1.873e+00 S  per = 57.3  per(accum) = 83.5
 T(sweep opt: decim) = 6.929e-02 S  per = 2.12  per(accum) = 85.7
 T(sweep opt: guess) = 8.019e-04 S  per = 0.0245  per(accum) = 85.7
 T(sweep opt: renrm) = 4.663e-01 S  per = 14.3  per(accum) = 99.9
 T(sweep opt: save ) = 1.706e-03 S  per = 0.0522  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.873e+00 S  T(sum) = 1.871e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 7.752e-04 S  per = 0.0414  per(accum) = 0.0414
 T(sweep opt: symbolic_formulae           ) = 6.056e-02 S  per = 3.24  per(accum) = 3.28
 T(sweep opt: hintermediate init          ) = 1.634e-03 S  per = 0.0873  per(accum) = 3.37
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.802e-02 S  per = 0.963  per(accum) = 4.33
 T(sweep opt: hmmtasks init               ) = 3.211e-02 S  per = 1.72  per(accum) = 6.05
 T(sweep opt: initial guess for dvdson    ) = 2.151e-05 S  per = 0.00115  per(accum) = 6.05
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.476e+00 S  per = 78.9  per(accum) = 84.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.449e-02 S  per = 1.84  per(accum) = 86.8
 T(sweep opt: dvdson [nccl]               ) = 1.968e-04 S  per = 0.0105  per(accum) = 86.8
 T(sweep opt: dvdson [mpi]                ) = 3.474e-06 S  per = 0.000186  per(accum) = 86.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.477e-01 S  per = 13.2  per(accum) = 100
Detailed decomposition of T(renrm) = 4.663e-01 S  T(sum) = 4.663e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.396e-03 S  per = 0.299  per(accum) = 0.299
 T(sweep opt: qops init                    ) = 1.107e-02 S  per = 2.37  per(accum) = 2.67
 T(sweep opt: symbolic_formulae_renorm     ) = 5.098e-02 S  per = 10.9  per(accum) = 13.6
 T(sweep opt: allocate qops on gpu         ) = 4.055e-04 S  per = 0.087  per(accum) = 13.7
 T(sweep opt: site memcpy cpu2gpu          ) = 8.867e-03 S  per =  1.9  per(accum) = 15.6
 T(sweep opt: rintermediate init           ) = 1.505e-02 S  per = 3.23  per(accum) = 18.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.655e-02 S  per = 5.69  per(accum) = 24.5
 T(sweep opt: rmmtasks init                ) = 7.134e-02 S  per = 15.3  per(accum) = 39.8
 T(sweep opt: qops memset on cpu           ) = 2.830e-07 S  per = 6.07e-05  per(accum) = 39.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.685e-01 S  per = 57.6  per(accum) = 97.4
 T(sweep opt: deallocate cpu and gpu memory) = 7.546e-04 S  per = 0.162  per(accum) = 97.6
 T(sweep opt: construct opS [ifdists=true] ) = 4.020e-07 S  per = 8.62e-05  per(accum) = 97.6
 T(sweep opt: reduction of opS & opH [nccl]) = 2.920e-07 S  per = 6.26e-05  per(accum) = 97.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.271e-03 S  per = 0.273  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.679e-04 S  per = 0.036  per(accum) = 97.9
 T(sweep opt: qops_pool join and erase     ) = 9.937e-03 S  per = 2.13  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.296e-05 S  per = 0.00278  per(accum) = 100
##### global opt: 3.269e+00 S #####
 T(global opt: fetch) = 9.389e-02 S  per = 2.87  per(accum) = 2.87
 T(global opt: hdiag) = 7.649e-01 S  per = 23.4  per(accum) = 26.3
 T(global opt: dvdsn) = 1.873e+00 S  per = 57.3  per(accum) = 83.5
 T(global opt: decim) = 6.929e-02 S  per = 2.12  per(accum) = 85.7
 T(global opt: guess) = 8.019e-04 S  per = 0.0245  per(accum) = 85.7
 T(global opt: renrm) = 4.663e-01 S  per = 14.3  per(accum) = 99.9
 T(global opt: save ) = 1.706e-03 S  per = 0.0522  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.873e+00 S  T(sum) = 1.871e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 7.752e-04 S  per = 0.0414  per(accum) = 0.0414
 T(global opt: symbolic_formulae           ) = 6.056e-02 S  per = 3.24  per(accum) = 3.28
 T(global opt: hintermediate init          ) = 1.634e-03 S  per = 0.0873  per(accum) = 3.37
 T(global opt: preprocess_hformulae_Hxlist ) = 1.802e-02 S  per = 0.963  per(accum) = 4.33
 T(global opt: hmmtasks init               ) = 3.211e-02 S  per = 1.72  per(accum) = 6.05
 T(global opt: initial guess for dvdson    ) = 2.151e-05 S  per = 0.00115  per(accum) = 6.05
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.476e+00 S  per = 78.9  per(accum) = 84.9
 T(global opt: dvdson [cpu-gpu]            ) = 3.449e-02 S  per = 1.84  per(accum) = 86.8
 T(global opt: dvdson [nccl]               ) = 1.968e-04 S  per = 0.0105  per(accum) = 86.8
 T(global opt: dvdson [mpi]                ) = 3.474e-06 S  per = 0.000186  per(accum) = 86.8
 T(global opt: dvdson [rest part(linalg)]  ) = 2.477e-01 S  per = 13.2  per(accum) = 100
Detailed decomposition of T(renrm) = 4.663e-01 S  T(sum) = 4.663e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.396e-03 S  per = 0.299  per(accum) = 0.299
 T(global opt: qops init                    ) = 1.107e-02 S  per = 2.37  per(accum) = 2.67
 T(global opt: symbolic_formulae_renorm     ) = 5.098e-02 S  per = 10.9  per(accum) = 13.6
 T(global opt: allocate qops on gpu         ) = 4.055e-04 S  per = 0.087  per(accum) = 13.7
 T(global opt: site memcpy cpu2gpu          ) = 8.867e-03 S  per =  1.9  per(accum) = 15.6
 T(global opt: rintermediate init           ) = 1.505e-02 S  per = 3.23  per(accum) = 18.8
 T(global opt: preprocess_formulae_Rlist2   ) = 2.655e-02 S  per = 5.69  per(accum) = 24.5
 T(global opt: rmmtasks init                ) = 7.134e-02 S  per = 15.3  per(accum) = 39.8
 T(global opt: qops memset on cpu           ) = 2.830e-07 S  per = 6.07e-05  per(accum) = 39.8
 T(global opt: preprocess_renorm_batchGPU   ) = 2.685e-01 S  per = 57.6  per(accum) = 97.4
 T(global opt: deallocate cpu and gpu memory) = 7.546e-04 S  per = 0.162  per(accum) = 97.6
 T(global opt: construct opS [ifdists=true] ) = 4.020e-07 S  per = 8.62e-05  per(accum) = 97.6
 T(global opt: reduction of opS & opH [nccl]) = 2.920e-07 S  per = 6.26e-05  per(accum) = 97.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.271e-03 S  per = 0.273  per(accum) = 97.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.679e-04 S  per = 0.036  per(accum) = 97.9
 T(global opt: qops_pool join and erase     ) = 9.937e-03 S  per = 2.13  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.296e-05 S  per = 0.00278  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.253e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=7/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=783:5.974e-03MB:5.834e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:2.66 S:3.98 A:0 B:92.4 
 rqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5702:0.0435MB:4.25e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.080e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x3aba86e0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (12,0):3 (12,2):2 (11,1):1
 qbond: qcol nsym=3 dimAll=6
 (16,0):3 (16,-2):2 (17,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=3.034e-01 t1=2.309e-05, t2=2.211e-03, t3=2.499e-03, t4=2.986e-01, t5=7.843e-06, t6=2.078e-05, t7=3.959e-06
duration_diagGPU:3.034e-01
duration_diagreduce:7.550e-07
duration_diagtransform:9.680e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.187e-02 S -----
rank=0 GPUmem(GB): used=4.248e-05 (oper)=4.248e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.731e-04 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper,hinter)=4.248e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.165e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.272e-03,3.892e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.629e-03 S size(H_formulae)=1327 size(Hxlst)=2830 -----
rank=0 GPUmem(GB): used=9.690e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=4.639e-04 blksize=9 blksize0=3 batchsize=2830
rank=0 GPUmem(GB): used=5.611e-04 (oper,hinter,dvdson,batch)=4.248e-05,5.442e-05,2.831e-07,4.639e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.996e-03,1.009e-02,3.027e-02,1.266e-02,5.506e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.989e-03 speed=1.423e-04GB/S T(nccl)=7.066e-06 speed=4.007e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=29 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=29 i=0 t=2.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=7.6e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=29 i=3 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=29 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=29 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=29 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=29 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=2.9e-01 t_gemm=8.7e-01 t_reduction=3.6e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=29 t=2.9e-01 per=1.9e+01 cost=5.5e+05 flops=1.9e+06
 sigma_tot[gemm] counter=29 i=0 t=6.7e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=5.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=2.2e-01 per=1.4e+01 cost=1.5e+05 flops=6.9e+05
 sigma_tot[gemm] counter=29 i=3 t=2.2e-01 per=1.4e+01 cost=1.5e+05 flops=6.9e+05
 sigma_tot[gemm] counter=29 i=4 t=2.2e-01 per=1.4e+01 cost=2.7e+05 flops=1.2e+06
 sigma_tot[gemm] counter=29 i=5 t=2.2e-01 per=1.4e+01 cost=2.7e+05 flops=1.2e+06
 sigma_tot[gemm] counter=29 total t=8.7e-01 per=5.7e+01 cost=8.4e+05 flops=9.7e+05
 sigma_tot[red] counter=29 t=3.6e-01 per=2.4e+01 cost=2.4e+05 flops=6.7e+05
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,8.8e-06,1.9e-06,7.6e-07,1.7e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.221564167486 -1.116e+03  6.158e-02    1     1  5.518e-02 5.518e-02 5.515e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.604e-03,1.211e-02,3.011e-02,1.256e-02,5.638e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.597e-03 speed=1.773e-04GB/S T(nccl)=6.483e-06 speed=4.367e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=30 t=1.2e-02 per=2.2e+01 cost=4.9e+04 flops=4.1e+06
 sigma[gemm] counter=30 i=0 t=4.2e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=3.7e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=30 i=3 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=30 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=30 i=5 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=30 total t=3.0e-02 per=5.5e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=30 t=1.3e-02 per=2.3e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.1e-01 t_gemm=9.0e-01 t_reduction=3.7e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=30 t=3.1e-01 per=1.9e+01 cost=6.0e+05 flops=2.0e+06
 sigma_tot[gemm] counter=30 i=0 t=7.1e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=5.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=2.2e-01 per=1.4e+01 cost=1.6e+05 flops=7.3e+05
 sigma_tot[gemm] counter=30 i=3 t=2.2e-01 per=1.4e+01 cost=1.6e+05 flops=7.3e+05
 sigma_tot[gemm] counter=30 i=4 t=2.2e-01 per=1.4e+01 cost=3.0e+05 flops=1.3e+06
 sigma_tot[gemm] counter=30 i=5 t=2.2e-01 per=1.4e+01 cost=3.0e+05 flops=1.3e+06
 sigma_tot[gemm] counter=30 total t=9.0e-01 per=5.7e+01 cost=9.2e+05 flops=1.0e+06
 sigma_tot[red] counter=30 t=3.7e-01 per=2.4e+01 cost=2.6e+05 flops=7.0e+05
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=8.0e-06,4.2e-05,6.1e-06,1.5e-06,4.3e-07
    2   0 -    -116.238950861197 -1.739e-02  7.936e-03    2     2  1.252e-01 6.258e-02 5.586e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.418e-03,9.947e-03,3.028e-02,1.257e-02,5.422e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.412e-03 speed=2.005e-04GB/S T(nccl)=5.795e-06 speed=4.886e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=31 t=9.9e-03 per=1.9e+01 cost=4.9e+04 flops=5.0e+06
 sigma[gemm] counter=31 i=0 t=2.2e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=1.9e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=31 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=31 i=4 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=31 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=31 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=31 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.1e-01 t_gemm=9.3e-01 t_reduction=3.9e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=31 t=3.1e-01 per=1.9e+01 cost=6.5e+05 flops=2.1e+06
 sigma_tot[gemm] counter=31 i=0 t=7.3e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=5.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=2.3e-01 per=1.4e+01 cost=1.8e+05 flops=7.7e+05
 sigma_tot[gemm] counter=31 i=3 t=2.3e-01 per=1.4e+01 cost=1.8e+05 flops=7.7e+05
 sigma_tot[gemm] counter=31 i=4 t=2.3e-01 per=1.4e+01 cost=3.2e+05 flops=1.4e+06
 sigma_tot[gemm] counter=31 i=5 t=2.3e-01 per=1.4e+01 cost=3.2e+05 flops=1.4e+06
 sigma_tot[gemm] counter=31 total t=9.3e-01 per=5.7e+01 cost=1.0e+06 flops=1.1e+06
 sigma_tot[red] counter=31 t=3.9e-01 per=2.4e+01 cost=2.9e+05 flops=7.4e+05
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,3.6e-05,3.3e-06,1.2e-06,2.1e-07
    3   0 -    -116.239278591874 -3.277e-04  1.988e-03    3     3  1.929e-01 6.430e-02 5.535e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.934e-03,1.012e-02,2.999e-02,1.260e-02,5.465e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.929e-03 speed=1.468e-04GB/S T(nccl)=4.815e-06 speed=5.880e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=32 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=32 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=7.6e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=32 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=32 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=32 i=5 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=32 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=32 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.3e-01 t_gemm=9.6e-01 t_reduction=4.0e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=32 t=3.3e-01 per=1.9e+01 cost=7.0e+05 flops=2.1e+06
 sigma_tot[gemm] counter=32 i=0 t=7.5e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=5.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=2.4e-01 per=1.4e+01 cost=1.9e+05 flops=8.0e+05
 sigma_tot[gemm] counter=32 i=3 t=2.4e-01 per=1.4e+01 cost=1.9e+05 flops=8.1e+05
 sigma_tot[gemm] counter=32 i=4 t=2.4e-01 per=1.4e+01 cost=3.5e+05 flops=1.5e+06
 sigma_tot[gemm] counter=32 i=5 t=2.4e-01 per=1.4e+01 cost=3.5e+05 flops=1.5e+06
 sigma_tot[gemm] counter=32 total t=9.6e-01 per=5.7e+01 cost=1.1e+06 flops=1.1e+06
 sigma_tot[red] counter=32 t=4.0e-01 per=2.4e+01 cost=3.1e+05 flops=7.7e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,2.8e-06,8.7e-07,2.3e-07
    4   0 -    -116.239301759629 -2.317e-05  2.707e-04    3     4  2.586e-01 6.464e-02 5.520e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.709e-03,1.005e-02,2.997e-02,1.241e-02,5.414e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.702e-03 speed=1.664e-04GB/S T(nccl)=7.035e-06 speed=4.024e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=33 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=33 i=0 t=2.1e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=33 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=33 i=4 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=33 i=5 t=7.4e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=33 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=33 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.4e-01 t_gemm=9.9e-01 t_reduction=4.1e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=33 t=3.4e-01 per=1.9e+01 cost=7.5e+05 flops=2.2e+06
 sigma_tot[gemm] counter=33 i=0 t=7.7e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=6.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=2.5e-01 per=1.4e+01 cost=2.1e+05 flops=8.3e+05
 sigma_tot[gemm] counter=33 i=3 t=2.5e-01 per=1.4e+01 cost=2.1e+05 flops=8.4e+05
 sigma_tot[gemm] counter=33 i=4 t=2.5e-01 per=1.4e+01 cost=3.8e+05 flops=1.5e+06
 sigma_tot[gemm] counter=33 i=5 t=2.5e-01 per=1.4e+01 cost=3.8e+05 flops=1.5e+06
 sigma_tot[gemm] counter=33 total t=9.9e-01 per=5.7e+01 cost=1.2e+06 flops=1.2e+06
 sigma_tot[red] counter=33 t=4.1e-01 per=2.4e+01 cost=3.3e+05 flops=8.1e+05
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=7.9e-06,4.1e-05,6.1e-06,2.1e-06,4.5e-07
    5   0 +    -116.239302101363 -3.417e-07  7.746e-05    3     5  3.224e-01 6.447e-02 5.503e-02
TIMING FOR Davidson : 3.224e-01  T(cal/comm/rest)=2.751e-01,8.060e-07,4.725e-02
decomposed t_rest=4.725e-02
 T(sub)    =1.958e-04 per=4.145e-01
 T(precond)=4.688e-02 per=9.923e+01
 T(ortho)  =1.507e-05 per=3.189e-02
 T(xcopy)  =1.037e-06 per=2.195e-03
 T(xnrm2)  =3.026e-06 per=6.405e-03
 T(other)  =1.493e-04 per=3.160e-01
optimized energies: isweep=0 ibond=7 dots=1 e[0]=-116.239302101363 nmvp=5
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.357e-04 change=1.535e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=8 dimAll=24
 (12,0):4 (14,0):3 (13,1):6 (13,-1):3 (12,2):3 (14,2):2 (13,3):2 (11,1):1
timing for divide=2.1e-05
timing for compute=1.0e-02
timing for collect=3.2e-05
----- TMING FOR decimation_genbasis(nkr): 1.0e-02 S T(divide/compute[cpu/gpu/rest]/collect)=2.1e-05,1.0e-02,0.0e+00,1.1e-05,3.2e-05 -----
decimation summary: 24->6 dwt=+0.000e+00 SvN=7.914e-01
 qbond: qkept nsym=3 dimAll=6
 (14,0):3 (14,2):2 (13,1):1
----- TIMING for decimation_row(nkr): 1.069e-02 S T(decim/select/formRot)=1.033e-02,3.265e-04,3.413e-05 -----
----- TIMING FOR onedot_decimation: 1.083e-02 S T(wf/decim)=1.185e-04,1.071e-02 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.42 S:2.96 A:0 B:93.9 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.281e-04 change=1.892e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.871e-02 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper)=4.248e-05
rank=0 GPUmem(GB): used=9.704e-05 (oper,site)=4.248e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:5.890e-02MB:5.752e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.464e-03 S -----
rank=0 GPUmem(GB): used=1.546e-04 (oper,site,rinter)=4.248e-05,1.416e-07,5.752e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.902e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=2.370e-03,1.532e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.129e-03 S size(rtasks)=365 size(Rlst)=734 -----
rank=0 GPUmem(GB): used=1.546e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.531e-04 blksize=9 blksize0=9 batchsize=734
rank=0 GPUmem(GB): used=3.077e-04 (oper,site,rinter,batch)=4.248e-05,1.416e-07,5.752e-05,1.531e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.173e-03,2.251e-02,9.964e-03
----- TIMING FOR renorm : t_inter=6.2e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=8 t=6.2e-03 per=1.6e+01 cost=8.5e+04 flops=1.4e+07
 renorm[gemm] counter=8 i=0 t=2.0e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.7e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=1.6e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=3 t=1.6e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=4 t=7.4e-03 per=1.9e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=8 i=5 t=7.5e-03 per=1.9e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=8 i=6 t=7.6e-03 per=2.0e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=8 total t=2.3e-02 per=5.8e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=8 t=1.0e-02 per=2.6e+01 cost=4.6e+03 flops=4.6e+05
----- TIMING FOR renorm_tot : t_inter=4.7e-02 t_gemm=1.8e-01 t_reduction=8.0e-02 tot=3.1e-01 -----
 renorm_tot[inter] counter=8 t=4.7e-02 per=1.5e+01 cost=3.5e+05 flops=7.4e+06
 renorm_tot[gemm] counter=8 i=0 t=1.3e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=1.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=1.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=3 t=1.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=4 t=5.8e-02 per=1.9e+01 cost=1.9e+05 flops=3.2e+06
 renorm_tot[gemm] counter=8 i=5 t=6.1e-02 per=2.0e+01 cost=1.9e+05 flops=3.2e+06
 renorm_tot[gemm] counter=8 i=6 t=6.0e-02 per=2.0e+01 cost=1.2e+06 flops=2.1e+07
 renorm_tot[gemm] counter=8 total t=1.8e-01 per=5.9e+01 cost=1.6e+06 flops=9.1e+06
 renorm_tot[red] counter=8 t=8.0e-02 per=2.6e+01 cost=5.7e+05 flops=7.1e+06
qops.to_cpu: size(tot)=1860:1.4e-02MB:1.4e-05GB T(to_cpu)=4.3e-04S speed=3.2e-02GB/S
check ||H-H.dagger||=1.005e-14 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0756 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=4.578e-05 change=8.291e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.259e-03 change=-2.029e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.259e-03 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.741e-01 S #####
 T(local opt: fetch) = 1.181e-02 S  per = 1.53  per(accum) = 1.53
 T(local opt: hdiag) = 3.034e-01 S  per = 39.2  per(accum) = 40.7
 T(local opt: dvdsn) = 3.702e-01 S  per = 47.8  per(accum) = 88.5
 T(local opt: decim) = 1.085e-02 S  per =  1.4  per(accum) = 89.9
 T(local opt: guess) = 1.324e-04 S  per = 0.0171  per(accum) = 90
 T(local opt: renrm) = 7.744e-02 S  per =   10  per(accum) = 100
 T(local opt: save ) = 2.871e-04 S  per = 0.0371  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.702e-01 S  T(sum) = 3.694e-01 S  per = 9.979e+01
 T(local opt: preprocess                  ) = 9.659e-05 S  per = 0.0261  per(accum) = 0.0261
 T(local opt: symbolic_formulae           ) = 2.188e-02 S  per = 5.92  per(accum) = 5.95
 T(local opt: hintermediate init          ) = 5.909e-04 S  per = 0.16  per(accum) = 6.11
 T(local opt: preprocess_hformulae_Hxlist ) = 7.713e-03 S  per = 2.09  per(accum) = 8.2
 T(local opt: hmmtasks init               ) = 1.670e-02 S  per = 4.52  per(accum) = 12.7
 T(local opt: initial guess for dvdson    ) = 2.933e-06 S  per = 0.000794  per(accum) = 12.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.665e-01 S  per = 72.1  per(accum) = 84.9
 T(local opt: dvdson [cpu-gpu]            ) = 8.629e-03 S  per = 2.34  per(accum) = 87.2
 T(local opt: dvdson [nccl]               ) = 3.119e-05 S  per = 0.00845  per(accum) = 87.2
 T(local opt: dvdson [mpi]                ) = 8.060e-07 S  per = 0.000218  per(accum) = 87.2
 T(local opt: dvdson [rest part(linalg)]  ) = 4.725e-02 S  per = 12.8  per(accum) = 100
Detailed decomposition of T(renrm) = 7.744e-02 S  T(sum) = 7.744e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.192e-04 S  per = 0.154  per(accum) = 0.154
 T(local opt: qops init                    ) = 3.963e-03 S  per = 5.12  per(accum) = 5.27
 T(local opt: symbolic_formulae_renorm     ) = 1.872e-02 S  per = 24.2  per(accum) = 29.4
 T(local opt: allocate qops on gpu         ) = 7.387e-05 S  per = 0.0954  per(accum) = 29.5
 T(local opt: site memcpy cpu2gpu          ) = 1.074e-03 S  per = 1.39  per(accum) = 30.9
 T(local opt: rintermediate init           ) = 2.481e-03 S  per =  3.2  per(accum) = 34.1
 T(local opt: preprocess_formulae_Rlist2   ) = 4.167e-03 S  per = 5.38  per(accum) = 39.5
 T(local opt: rmmtasks init                ) = 5.801e-03 S  per = 7.49  per(accum) = 47
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 5.68e-05  per(accum) = 47
 T(local opt: preprocess_renorm_batchGPU   ) = 3.876e-02 S  per =   50  per(accum) = 97.1
 T(local opt: deallocate cpu and gpu memory) = 5.341e-05 S  per = 0.069  per(accum) = 97.1
 T(local opt: construct opS [ifdists=true] ) = 7.400e-08 S  per = 9.56e-05  per(accum) = 97.1
 T(local opt: reduction of opS & opH [nccl]) = 4.900e-08 S  per = 6.33e-05  per(accum) = 97.1
 T(local opt: qops memcpy gpu2cpu          ) = 4.425e-04 S  per = 0.571  per(accum) = 97.7
 T(local opt: reduction of opS & opH [mpi] ) = 2.036e-05 S  per = 0.0263  per(accum) = 97.7
 T(local opt: qops_pool join and erase     ) = 1.765e-03 S  per = 2.28  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.491e-06 S  per = 0.00193  per(accum) = 100
##### sweep opt: 4.044e+00 S #####
 T(sweep opt: fetch) = 1.057e-01 S  per = 2.61  per(accum) = 2.61
 T(sweep opt: hdiag) = 1.068e+00 S  per = 26.4  per(accum) = 29
 T(sweep opt: dvdsn) = 2.243e+00 S  per = 55.5  per(accum) = 84.5
 T(sweep opt: decim) = 8.014e-02 S  per = 1.98  per(accum) = 86.5
 T(sweep opt: guess) = 9.343e-04 S  per = 0.0231  per(accum) = 86.5
 T(sweep opt: renrm) = 5.437e-01 S  per = 13.4  per(accum) = 100
 T(sweep opt: save ) = 1.993e-03 S  per = 0.0493  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.243e+00 S  T(sum) = 2.240e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 8.718e-04 S  per = 0.0389  per(accum) = 0.0389
 T(sweep opt: symbolic_formulae           ) = 8.245e-02 S  per = 3.68  per(accum) = 3.72
 T(sweep opt: hintermediate init          ) = 2.224e-03 S  per = 0.0993  per(accum) = 3.82
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.574e-02 S  per = 1.15  per(accum) = 4.97
 T(sweep opt: hmmtasks init               ) = 4.881e-02 S  per = 2.18  per(accum) = 7.15
 T(sweep opt: initial guess for dvdson    ) = 2.444e-05 S  per = 0.00109  per(accum) = 7.15
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.742e+00 S  per = 77.8  per(accum) = 84.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.312e-02 S  per = 1.92  per(accum) = 86.8
 T(sweep opt: dvdson [nccl]               ) = 2.280e-04 S  per = 0.0102  per(accum) = 86.8
 T(sweep opt: dvdson [mpi]                ) = 4.280e-06 S  per = 0.000191  per(accum) = 86.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.949e-01 S  per = 13.2  per(accum) = 100
Detailed decomposition of T(renrm) = 5.437e-01 S  T(sum) = 5.437e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.516e-03 S  per = 0.279  per(accum) = 0.279
 T(sweep opt: qops init                    ) = 1.504e-02 S  per = 2.77  per(accum) = 3.04
 T(sweep opt: symbolic_formulae_renorm     ) = 6.971e-02 S  per = 12.8  per(accum) = 15.9
 T(sweep opt: allocate qops on gpu         ) = 4.794e-04 S  per = 0.0882  per(accum) = 16
 T(sweep opt: site memcpy cpu2gpu          ) = 9.940e-03 S  per = 1.83  per(accum) = 17.8
 T(sweep opt: rintermediate init           ) = 1.753e-02 S  per = 3.23  per(accum) = 21
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.072e-02 S  per = 5.65  per(accum) = 26.7
 T(sweep opt: rmmtasks init                ) = 7.714e-02 S  per = 14.2  per(accum) = 40.8
 T(sweep opt: qops memset on cpu           ) = 3.270e-07 S  per = 6.01e-05  per(accum) = 40.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.072e-01 S  per = 56.5  per(accum) = 97.3
 T(sweep opt: deallocate cpu and gpu memory) = 8.081e-04 S  per = 0.149  per(accum) = 97.5
 T(sweep opt: construct opS [ifdists=true] ) = 4.760e-07 S  per = 8.75e-05  per(accum) = 97.5
 T(sweep opt: reduction of opS & opH [nccl]) = 3.410e-07 S  per = 6.27e-05  per(accum) = 97.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.714e-03 S  per = 0.315  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.883e-04 S  per = 0.0346  per(accum) = 97.8
 T(sweep opt: qops_pool join and erase     ) = 1.170e-02 S  per = 2.15  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.445e-05 S  per = 0.00266  per(accum) = 100
##### global opt: 4.044e+00 S #####
 T(global opt: fetch) = 1.057e-01 S  per = 2.61  per(accum) = 2.61
 T(global opt: hdiag) = 1.068e+00 S  per = 26.4  per(accum) = 29
 T(global opt: dvdsn) = 2.243e+00 S  per = 55.5  per(accum) = 84.5
 T(global opt: decim) = 8.014e-02 S  per = 1.98  per(accum) = 86.5
 T(global opt: guess) = 9.343e-04 S  per = 0.0231  per(accum) = 86.5
 T(global opt: renrm) = 5.437e-01 S  per = 13.4  per(accum) = 100
 T(global opt: save ) = 1.993e-03 S  per = 0.0493  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.243e+00 S  T(sum) = 2.240e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 8.718e-04 S  per = 0.0389  per(accum) = 0.0389
 T(global opt: symbolic_formulae           ) = 8.245e-02 S  per = 3.68  per(accum) = 3.72
 T(global opt: hintermediate init          ) = 2.224e-03 S  per = 0.0993  per(accum) = 3.82
 T(global opt: preprocess_hformulae_Hxlist ) = 2.574e-02 S  per = 1.15  per(accum) = 4.97
 T(global opt: hmmtasks init               ) = 4.881e-02 S  per = 2.18  per(accum) = 7.15
 T(global opt: initial guess for dvdson    ) = 2.444e-05 S  per = 0.00109  per(accum) = 7.15
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.742e+00 S  per = 77.8  per(accum) = 84.9
 T(global opt: dvdson [cpu-gpu]            ) = 4.312e-02 S  per = 1.92  per(accum) = 86.8
 T(global opt: dvdson [nccl]               ) = 2.280e-04 S  per = 0.0102  per(accum) = 86.8
 T(global opt: dvdson [mpi]                ) = 4.280e-06 S  per = 0.000191  per(accum) = 86.8
 T(global opt: dvdson [rest part(linalg)]  ) = 2.949e-01 S  per = 13.2  per(accum) = 100
Detailed decomposition of T(renrm) = 5.437e-01 S  T(sum) = 5.437e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.516e-03 S  per = 0.279  per(accum) = 0.279
 T(global opt: qops init                    ) = 1.504e-02 S  per = 2.77  per(accum) = 3.04
 T(global opt: symbolic_formulae_renorm     ) = 6.971e-02 S  per = 12.8  per(accum) = 15.9
 T(global opt: allocate qops on gpu         ) = 4.794e-04 S  per = 0.0882  per(accum) = 16
 T(global opt: site memcpy cpu2gpu          ) = 9.940e-03 S  per = 1.83  per(accum) = 17.8
 T(global opt: rintermediate init           ) = 1.753e-02 S  per = 3.23  per(accum) = 21
 T(global opt: preprocess_formulae_Rlist2   ) = 3.072e-02 S  per = 5.65  per(accum) = 26.7
 T(global opt: rmmtasks init                ) = 7.714e-02 S  per = 14.2  per(accum) = 40.8
 T(global opt: qops memset on cpu           ) = 3.270e-07 S  per = 6.01e-05  per(accum) = 40.8
 T(global opt: preprocess_renorm_batchGPU   ) = 3.072e-01 S  per = 56.5  per(accum) = 97.3
 T(global opt: deallocate cpu and gpu memory) = 8.081e-04 S  per = 0.149  per(accum) = 97.5
 T(global opt: construct opS [ifdists=true] ) = 4.760e-07 S  per = 8.75e-05  per(accum) = 97.5
 T(global opt: reduction of opS & opH [nccl]) = 3.410e-07 S  per = 6.27e-05  per(accum) = 97.5
 T(global opt: qops memcpy gpu2cpu          ) = 1.714e-03 S  per = 0.315  per(accum) = 97.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.883e-04 S  per = 0.0346  per(accum) = 97.8
 T(global opt: qops_pool join and erase     ) = 1.170e-02 S  per = 2.15  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.445e-05 S  per = 0.00266  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.518e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=8/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=31:2.365e-04MB:2.310e-07GB
total mem of comb=795:6.065e-03MB:5.923e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.42 S:2.96 A:0 B:93.9 
 rqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=7447:0.0568MB:5.55e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.129e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.444e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,7,4) nnz=31:2.365e-04MB
qtensor3: wf3 own=1 _data=0x3ab37f00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (14,0):3 (14,2):2 (13,1):1
 qbond: qcol nsym=3 dimAll=7
 (15,-1):4 (15,-3):2 (16,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=31:2.365e-04MB
### DIAG TIMING: total=4.143e-01 t1=5.016e-04, t2=1.706e-03, t3=2.536e-03, t4=4.095e-01, t5=5.769e-06, t6=1.547e-05, t7=4.361e-06
duration_diagGPU:4.143e-01
duration_diagreduce:8.300e-08
duration_diagtransform:4.670e-07
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.605e-02 S -----
rank=0 GPUmem(GB): used=5.548e-05 (oper)=5.548e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.682e-04 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper,hinter)=5.548e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.114e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=3.991e-03,5.123e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.737e-03 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.172e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.619e-07 batch[need]=8.513e-04 blksize=12 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=9.689e-04 (oper,hinter,dvdson,batch)=5.548e-05,6.169e-05,4.619e-07,8.513e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=31 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.540e-03,9.876e-03,2.983e-02,1.232e-02,5.358e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.534e-03 speed=3.011e-04GB/S T(nccl)=5.432e-06 speed=8.504e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=34 t=9.9e-03 per=1.9e+01 cost=9.0e+04 flops=9.1e+06
 sigma[gemm] counter=34 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=7.5e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=34 i=3 t=7.5e-03 per=1.5e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=34 i=4 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.7e+06
 sigma[gemm] counter=34 i=5 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=34 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=34 t=1.2e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=3.5e-01 t_gemm=1.0e+00 t_reduction=4.2e-01 tot=1.8e+00 -----
 sigma_tot[inter] counter=34 t=3.5e-01 per=1.9e+01 cost=8.4e+05 flops=2.4e+06
 sigma_tot[gemm] counter=34 i=0 t=7.9e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=6.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=2.5e-01 per=1.4e+01 cost=2.4e+05 flops=9.4e+05
 sigma_tot[gemm] counter=34 i=3 t=2.5e-01 per=1.4e+01 cost=2.4e+05 flops=9.5e+05
 sigma_tot[gemm] counter=34 i=4 t=2.5e-01 per=1.4e+01 cost=4.2e+05 flops=1.7e+06
 sigma_tot[gemm] counter=34 i=5 t=2.5e-01 per=1.4e+01 cost=4.2e+05 flops=1.6e+06
 sigma_tot[gemm] counter=34 total t=1.0e+00 per=5.7e+01 cost=1.3e+06 flops=1.3e+06
 sigma_tot[red] counter=34 t=4.2e-01 per=2.4e+01 cost=3.7e+05 flops=8.8e+05
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,5.6e-06,1.8e-06,7.9e-07,1.5e-07
settings: ndim=31 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.239302101363 -1.116e+03  5.368e-02    1     1  5.369e-02 5.369e-02 5.366e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.164e-03,9.915e-03,3.006e-02,1.249e-02,5.363e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.160e-03 speed=3.983e-04GB/S T(nccl)=4.464e-06 speed=1.035e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=35 t=9.9e-03 per=1.9e+01 cost=9.0e+04 flops=9.1e+06
 sigma[gemm] counter=35 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=7.4e-03 per=1.4e+01 cost=3.2e+04 flops=4.4e+06
 sigma[gemm] counter=35 i=3 t=7.6e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=35 i=4 t=7.6e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=35 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=35 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=35 t=1.2e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=3.5e-01 t_gemm=1.0e+00 t_reduction=4.4e-01 tot=1.8e+00 -----
 sigma_tot[inter] counter=35 t=3.5e-01 per=1.9e+01 cost=9.3e+05 flops=2.6e+06
 sigma_tot[gemm] counter=35 i=0 t=8.0e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=6.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=2.6e-01 per=1.4e+01 cost=2.7e+05 flops=1.0e+06
 sigma_tot[gemm] counter=35 i=3 t=2.6e-01 per=1.4e+01 cost=2.8e+05 flops=1.0e+06
 sigma_tot[gemm] counter=35 i=4 t=2.6e-01 per=1.4e+01 cost=4.6e+05 flops=1.8e+06
 sigma_tot[gemm] counter=35 i=5 t=2.6e-01 per=1.4e+01 cost=4.6e+05 flops=1.8e+06
 sigma_tot[gemm] counter=35 total t=1.0e+00 per=5.7e+01 cost=1.5e+06 flops=1.4e+06
 sigma_tot[red] counter=35 t=4.4e-01 per=2.4e+01 cost=4.1e+05 flops=9.5e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.2e-05,3.2e-06,8.8e-07,2.0e-07
    2   0 -    -116.248657223696 -9.355e-03  1.738e-02    2     2  1.170e-01 5.851e-02 5.369e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.198e-03,9.829e-03,2.988e-02,1.260e-02,5.352e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.193e-03 speed=3.871e-04GB/S T(nccl)=4.434e-06 speed=1.042e-01GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=36 t=9.8e-03 per=1.9e+01 cost=9.0e+04 flops=9.2e+06
 sigma[gemm] counter=36 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=7.5e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=36 i=3 t=7.5e-03 per=1.4e+01 cost=3.3e+04 flops=4.5e+06
 sigma[gemm] counter=36 i=4 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=36 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=36 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=36 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=3.6e-01 t_gemm=1.1e+00 t_reduction=4.5e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=36 t=3.6e-01 per=1.9e+01 cost=1.0e+06 flops=2.8e+06
 sigma_tot[gemm] counter=36 i=0 t=8.2e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=6.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=2.7e-01 per=1.4e+01 cost=3.0e+05 flops=1.1e+06
 sigma_tot[gemm] counter=36 i=3 t=2.7e-01 per=1.4e+01 cost=3.1e+05 flops=1.1e+06
 sigma_tot[gemm] counter=36 i=4 t=2.7e-01 per=1.4e+01 cost=5.1e+05 flops=1.9e+06
 sigma_tot[gemm] counter=36 i=5 t=2.7e-01 per=1.4e+01 cost=5.0e+05 flops=1.9e+06
 sigma_tot[gemm] counter=36 total t=1.1e+00 per=5.7e+01 cost=1.6e+06 flops=1.5e+06
 sigma_tot[red] counter=36 t=4.5e-01 per=2.4e+01 cost=4.5e+05 flops=1.0e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.7e-05,2.9e-06,1.1e-06,1.9e-07
    3   0 -    -116.249817092520 -1.160e-03  5.015e-03    3     3  1.802e-01 6.006e-02 5.366e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.684e-03,1.216e-02,2.984e-02,1.250e-02,5.619e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.678e-03 speed=2.753e-04GB/S T(nccl)=6.373e-06 speed=7.248e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.4e-02 -----
 sigma[inter] counter=37 t=1.2e-02 per=2.2e+01 cost=9.0e+04 flops=7.4e+06
 sigma[gemm] counter=37 i=0 t=4.7e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=4.1e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=7.5e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=37 i=3 t=7.4e-03 per=1.4e+01 cost=3.3e+04 flops=4.5e+06
 sigma[gemm] counter=37 i=4 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.7e+06
 sigma[gemm] counter=37 i=5 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=37 total t=3.0e-02 per=5.5e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=37 t=1.2e-02 per=2.3e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=3.8e-01 t_gemm=1.1e+00 t_reduction=4.6e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=37 t=3.8e-01 per=1.9e+01 cost=1.1e+06 flops=2.9e+06
 sigma_tot[gemm] counter=37 i=0 t=8.7e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=6.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=2.8e-01 per=1.4e+01 cost=3.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=37 i=3 t=2.8e-01 per=1.4e+01 cost=3.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=37 i=4 t=2.8e-01 per=1.4e+01 cost=5.5e+05 flops=2.0e+06
 sigma_tot[gemm] counter=37 i=5 t=2.8e-01 per=1.4e+01 cost=5.4e+05 flops=2.0e+06
 sigma_tot[gemm] counter=37 total t=1.1e+00 per=5.7e+01 cost=1.8e+06 flops=1.6e+06
 sigma_tot[red] counter=37 t=4.6e-01 per=2.4e+01 cost=5.0e+05 flops=1.1e+06
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=7.6e-06,2.5e-05,5.5e-06,2.0e-06,4.2e-07
    4   0 -    -116.249939278612 -1.222e-04  6.101e-04    3     4  2.499e-01 6.247e-02 5.434e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.871e-03,1.006e-02,2.997e-02,1.261e-02,5.453e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.863e-03 speed=2.480e-04GB/S T(nccl)=7.711e-06 speed=5.991e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=38 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=8.9e+06
 sigma[gemm] counter=38 i=0 t=2.3e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=2.0e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=7.6e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=38 i=3 t=7.5e-03 per=1.4e+01 cost=3.3e+04 flops=4.5e+06
 sigma[gemm] counter=38 i=4 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.7e+06
 sigma[gemm] counter=38 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=38 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=38 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=3.9e-01 t_gemm=1.1e+00 t_reduction=4.7e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=38 t=3.9e-01 per=1.9e+01 cost=1.2e+06 flops=3.1e+06
 sigma_tot[gemm] counter=38 i=0 t=8.9e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=7.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=2.8e-01 per=1.4e+01 cost=3.7e+05 flops=1.3e+06
 sigma_tot[gemm] counter=38 i=3 t=2.8e-01 per=1.4e+01 cost=3.8e+05 flops=1.3e+06
 sigma_tot[gemm] counter=38 i=4 t=2.8e-01 per=1.4e+01 cost=5.9e+05 flops=2.1e+06
 sigma_tot[gemm] counter=38 i=5 t=2.8e-01 per=1.4e+01 cost=5.9e+05 flops=2.1e+06
 sigma_tot[gemm] counter=38 total t=1.1e+00 per=5.7e+01 cost=1.9e+06 flops=1.7e+06
 sigma_tot[red] counter=38 t=4.7e-01 per=2.4e+01 cost=5.4e+05 flops=1.1e+06
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.8e-05,4.1e-06,1.5e-06,3.1e-07
    5   0 -    -116.249940603011 -1.324e-06  1.326e-04    3     5  3.154e-01 6.309e-02 5.441e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.617e-04,1.003e-02,3.028e-02,1.245e-02,5.344e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=6.567e-04 speed=7.034e-04GB/S T(nccl)=4.993e-06 speed=9.252e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=39 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=9.0e+06
 sigma[gemm] counter=39 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=7.6e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=39 i=3 t=7.5e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=39 i=4 t=7.6e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=39 i=5 t=7.6e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=39 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=39 t=1.2e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=4.0e-01 t_gemm=1.2e+00 t_reduction=4.9e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=39 t=4.0e-01 per=1.9e+01 cost=1.3e+06 flops=3.2e+06
 sigma_tot[gemm] counter=39 i=0 t=9.1e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=7.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=2.9e-01 per=1.4e+01 cost=4.0e+05 flops=1.4e+06
 sigma_tot[gemm] counter=39 i=3 t=2.9e-01 per=1.4e+01 cost=4.1e+05 flops=1.4e+06
 sigma_tot[gemm] counter=39 i=4 t=2.9e-01 per=1.4e+01 cost=6.3e+05 flops=2.2e+06
 sigma_tot[gemm] counter=39 i=5 t=2.9e-01 per=1.4e+01 cost=6.3e+05 flops=2.2e+06
 sigma_tot[gemm] counter=39 total t=1.2e+00 per=5.7e+01 cost=2.1e+06 flops=1.8e+06
 sigma_tot[red] counter=39 t=4.9e-01 per=2.4e+01 cost=5.8e+05 flops=1.2e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.7e-06,9.8e-07,2.1e-07
    6   0 +    -116.249940669273 -6.626e-08  4.928e-05    3     6  3.812e-01 6.353e-02 5.426e-02
TIMING FOR Davidson : 3.812e-01  T(cal/comm/rest)=3.256e-01,7.390e-07,5.561e-02
decomposed t_rest=5.561e-02
 T(sub)    =1.489e-04 per=2.678e-01
 T(precond)=5.526e-02 per=9.939e+01
 T(ortho)  =2.438e-05 per=4.384e-02
 T(xcopy)  =1.218e-06 per=2.190e-03
 T(xnrm2)  =3.135e-06 per=5.638e-03
 T(other)  =1.635e-04 per=2.941e-01
optimized energies: isweep=0 ibond=8 dots=1 e[0]=-116.249940669273 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.076e-03 change=1.914e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=8 dimAll=24
 (14,0):4 (16,0):3 (15,1):6 (15,-1):3 (14,2):3 (16,2):2 (15,3):2 (13,1):1
timing for divide=9.9e-06
timing for compute=1.2e-02
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.9e-06,1.2e-02,0.0e+00,4.5e-06,1.5e-05 -----
decimation summary: 24->7 dwt=+0.000e+00 SvN=1.007e+00
 qbond: qkept nsym=3 dimAll=7
 (15,1):4 (15,3):2 (14,2):1
----- TIMING for decimation_row(nkr): 1.247e-02 S T(decim/select/formRot)=1.224e-02,2.140e-04,1.937e-05 -----
----- TIMING FOR onedot_decimation: 1.253e-02 S T(wf/decim)=4.975e-05,1.248e-02 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:20 S:20 A:190 B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 A:0 B:95.7 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.030e-03 change=2.282e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=441 : 1.471e-02 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper)=5.548e-05
rank=0 GPUmem(GB): used=1.174e-04 (oper,site)=5.548e-05,2.310e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:6.715e-02MB:6.558e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.513e-03 S -----
rank=0 GPUmem(GB): used=1.830e-04 (oper,site,rinter)=5.548e-05,2.310e-07,6.558e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.179e-03 S size(rtasks)=441 size(Rlst2)=9 T(Rmu/Rlist)=1.806e-03,1.373e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.392e-03 S size(rtasks)=441 size(Rlst)=965 -----
rank=0 GPUmem(GB): used=1.830e-04 avail=6.176e+00 total=6.176e+00 batch[need]=3.020e-04 blksize=16 blksize0=9 batchsize=965
rank=0 GPUmem(GB): used=4.850e-04 (oper,site,rinter,batch)=5.548e-05,2.310e-07,6.558e-05,3.020e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.013e-03,2.296e-02,1.002e-02
----- TIMING FOR renorm : t_inter=7.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=9 t=7.0e-03 per=1.8e+01 cost=6.0e+04 flops=8.6e+06
 renorm[gemm] counter=9 i=0 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=3 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=4 t=7.7e-03 per=1.9e+01 cost=2.7e+03 flops=3.5e+05
 renorm[gemm] counter=9 i=5 t=7.7e-03 per=1.9e+01 cost=1.8e+04 flops=2.4e+06
 renorm[gemm] counter=9 i=6 t=7.6e-03 per=1.9e+01 cost=3.1e+04 flops=4.0e+06
 renorm[gemm] counter=9 total t=2.3e-02 per=5.7e+01 cost=5.2e+04 flops=2.2e+06
 renorm[red] counter=9 t=1.0e-02 per=2.5e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=5.4e-02 t_gemm=2.0e-01 t_reduction=9.0e-02 tot=3.5e-01 -----
 renorm_tot[inter] counter=9 t=5.4e-02 per=1.6e+01 cost=4.1e+05 flops=7.6e+06
 renorm_tot[gemm] counter=9 i=0 t=1.4e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=1.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=1.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=3 t=1.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=4 t=6.6e-02 per=1.9e+01 cost=1.9e+05 flops=2.9e+06
 renorm_tot[gemm] counter=9 i=5 t=6.8e-02 per=2.0e+01 cost=2.1e+05 flops=3.1e+06
 renorm_tot[gemm] counter=9 i=6 t=6.8e-02 per=2.0e+01 cost=1.3e+06 flops=1.9e+07
 renorm_tot[gemm] counter=9 total t=2.0e-01 per=5.8e+01 cost=1.7e+06 flops=8.3e+06
 renorm_tot[red] counter=9 t=9.0e-02 per=2.6e+01 cost=5.9e+05 flops=6.5e+06
----- TIMING FOR oper_renorm : 7.0e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=5.341e-04 change=9.900e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.396e-03 change=-2.277e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(9,0) superblock=lc alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.396e-03 change=2.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.396e-03 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=1 ifkr=0 maxsize=3110:2.317e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3110:2.373e-02MB:2.317e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.000896 tinit=0.000896
   copy opB to qops_tmps: dt=0.00236 tcopy=0.00236
   bcast: size(opB)=3110:2.32e-05GB dt=4.1e-08 speed=565GB/s tcomm=4.1e-08
   compute opQ from opB: dt=0.00751 tcomp=0.00751
iproc=0
 qops_tmp: oplist=N nops=N:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3110:0.0237MB:2.32e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.000839 tinit=0.00173
   from opB to opB.H(): dt=0.00664 tadjt=0.00664
   bcast: size(opN)=3110:2.32e-05GB dt=4.1e-08 speed=565GB/s tcomm=8.2e-08
   compute opQ from opB.H(): dt=0.00312 tcomp=0.0106
----- TIMING FOR oper_b2qGPU : 0.0217 S T(init/copy/adjt+bcast/comp/rest)=0.00173,0.00236,0.00664,0.0106,0.000337 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.304e-03 change=4.321e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.304e-03 change=2.480e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.304e-03 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before move
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.304e-03 change=-2.295e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=8.591e-05 avail=6.176e+00 after move
check ||H-H.dagger||=9.669e-15 coord=(9,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0247 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00207,1.7e-05,4.7e-06,0.0217,0,0.000588,0.000337 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.304e-03 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.304e-03 change=-6.855e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 9.797e-01 S #####
 T(local opt: fetch) = 1.525e-02 S  per = 1.56  per(accum) = 1.56
 T(local opt: hdiag) = 4.143e-01 S  per = 42.3  per(accum) = 43.8
 T(local opt: dvdsn) = 4.406e-01 S  per =   45  per(accum) = 88.8
 T(local opt: decim) = 1.254e-02 S  per = 1.28  per(accum) = 90.1
 T(local opt: guess) = 7.740e-05 S  per = 0.0079  per(accum) = 90.1
 T(local opt: renrm) = 9.662e-02 S  per = 9.86  per(accum) = 100
 T(local opt: save ) = 2.718e-04 S  per = 0.0277  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.406e-01 S  T(sum) = 4.402e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 9.986e-05 S  per = 0.0227  per(accum) = 0.0227
 T(local opt: symbolic_formulae           ) = 2.607e-02 S  per = 5.92  per(accum) = 5.94
 T(local opt: hintermediate init          ) = 6.870e-04 S  per = 0.156  per(accum) = 6.1
 T(local opt: preprocess_hformulae_Hxlist ) = 9.854e-03 S  per = 2.24  per(accum) = 8.34
 T(local opt: hmmtasks init               ) = 2.230e-02 S  per = 5.07  per(accum) = 13.4
 T(local opt: initial guess for dvdson    ) = 3.237e-06 S  per = 0.000735  per(accum) = 13.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.175e-01 S  per = 72.1  per(accum) = 85.5
 T(local opt: dvdson [cpu-gpu]            ) = 8.085e-03 S  per = 1.84  per(accum) = 87.4
 T(local opt: dvdson [nccl]               ) = 3.341e-05 S  per = 0.00759  per(accum) = 87.4
 T(local opt: dvdson [mpi]                ) = 7.390e-07 S  per = 0.000168  per(accum) = 87.4
 T(local opt: dvdson [rest part(linalg)]  ) = 5.561e-02 S  per = 12.6  per(accum) = 100
Detailed decomposition of T(renrm) = 9.662e-02 S  T(sum) = 9.662e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.309e-05 S  per = 0.0756  per(accum) = 0.0756
 T(local opt: qops init                    ) = 3.042e-03 S  per = 3.15  per(accum) = 3.22
 T(local opt: symbolic_formulae_renorm     ) = 1.472e-02 S  per = 15.2  per(accum) = 18.5
 T(local opt: allocate qops on gpu         ) = 5.198e-05 S  per = 0.0538  per(accum) = 18.5
 T(local opt: site memcpy cpu2gpu          ) = 8.573e-04 S  per = 0.887  per(accum) = 19.4
 T(local opt: rintermediate init           ) = 2.528e-03 S  per = 2.62  per(accum) = 22
 T(local opt: preprocess_formulae_Rlist2   ) = 3.427e-03 S  per = 3.55  per(accum) = 25.6
 T(local opt: rmmtasks init                ) = 5.481e-03 S  per = 5.67  per(accum) = 31.2
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 3.42e-05  per(accum) = 31.2
 T(local opt: preprocess_renorm_batchGPU   ) = 4.008e-02 S  per = 41.5  per(accum) = 72.7
 T(local opt: deallocate cpu and gpu memory) = 6.208e-05 S  per = 0.0643  per(accum) = 72.8
 T(local opt: construct opS [ifdists=true] ) = 5.700e-08 S  per = 5.9e-05  per(accum) = 72.8
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 3.83e-05  per(accum) = 72.8
 T(local opt: qops memcpy gpu2cpu          ) = 2.700e-08 S  per = 2.79e-05  per(accum) = 72.8
 T(local opt: reduction of opS & opH [mpi] ) = 8.800e-08 S  per = 9.11e-05  per(accum) = 72.8
 T(local opt: qops_pool join and erase     ) = 1.488e-03 S  per = 1.54  per(accum) = 74.3
 T(local opt: conversion from opAB to opPQ ) = 2.482e-02 S  per = 25.7  per(accum) = 100
##### sweep opt: 5.023e+00 S #####
 T(sweep opt: fetch) = 1.209e-01 S  per = 2.41  per(accum) = 2.41
 T(sweep opt: hdiag) = 1.483e+00 S  per = 29.5  per(accum) = 31.9
 T(sweep opt: dvdsn) = 2.683e+00 S  per = 53.4  per(accum) = 85.3
 T(sweep opt: decim) = 9.268e-02 S  per = 1.85  per(accum) = 87.2
 T(sweep opt: guess) = 1.012e-03 S  per = 0.0201  per(accum) = 87.2
 T(sweep opt: renrm) = 6.403e-01 S  per = 12.7  per(accum) = 100
 T(sweep opt: save ) = 2.265e-03 S  per = 0.0451  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.683e+00 S  T(sum) = 2.681e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 9.717e-04 S  per = 0.0362  per(accum) = 0.0362
 T(sweep opt: symbolic_formulae           ) = 1.085e-01 S  per = 4.05  per(accum) = 4.08
 T(sweep opt: hintermediate init          ) = 2.911e-03 S  per = 0.109  per(accum) = 4.19
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.559e-02 S  per = 1.33  per(accum) = 5.52
 T(sweep opt: hmmtasks init               ) = 7.111e-02 S  per = 2.65  per(accum) = 8.17
 T(sweep opt: initial guess for dvdson    ) = 2.768e-05 S  per = 0.00103  per(accum) = 8.17
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.059e+00 S  per = 76.8  per(accum) = 85
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.121e-02 S  per = 1.91  per(accum) = 86.9
 T(sweep opt: dvdson [nccl]               ) = 2.614e-04 S  per = 0.00975  per(accum) = 86.9
 T(sweep opt: dvdson [mpi]                ) = 5.019e-06 S  per = 0.000187  per(accum) = 86.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.505e-01 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 6.403e-01 S  T(sum) = 6.403e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.589e-03 S  per = 0.248  per(accum) = 0.248
 T(sweep opt: qops init                    ) = 1.808e-02 S  per = 2.82  per(accum) = 3.07
 T(sweep opt: symbolic_formulae_renorm     ) = 8.443e-02 S  per = 13.2  per(accum) = 16.3
 T(sweep opt: allocate qops on gpu         ) = 5.313e-04 S  per = 0.083  per(accum) = 16.3
 T(sweep opt: site memcpy cpu2gpu          ) = 1.080e-02 S  per = 1.69  per(accum) = 18
 T(sweep opt: rintermediate init           ) = 2.006e-02 S  per = 3.13  per(accum) = 21.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.415e-02 S  per = 5.33  per(accum) = 26.5
 T(sweep opt: rmmtasks init                ) = 8.262e-02 S  per = 12.9  per(accum) = 39.4
 T(sweep opt: qops memset on cpu           ) = 3.600e-07 S  per = 5.62e-05  per(accum) = 39.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.473e-01 S  per = 54.2  per(accum) = 93.6
 T(sweep opt: deallocate cpu and gpu memory) = 8.701e-04 S  per = 0.136  per(accum) = 93.8
 T(sweep opt: construct opS [ifdists=true] ) = 5.330e-07 S  per = 8.32e-05  per(accum) = 93.8
 T(sweep opt: reduction of opS & opH [nccl]) = 3.780e-07 S  per = 5.9e-05  per(accum) = 93.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.714e-03 S  per = 0.268  per(accum) = 94
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.884e-04 S  per = 0.0294  per(accum) = 94.1
 T(sweep opt: qops_pool join and erase     ) = 1.319e-02 S  per = 2.06  per(accum) = 96.1
 T(sweep opt: conversion from opAB to opPQ ) = 2.483e-02 S  per = 3.88  per(accum) = 100
##### global opt: 5.023e+00 S #####
 T(global opt: fetch) = 1.209e-01 S  per = 2.41  per(accum) = 2.41
 T(global opt: hdiag) = 1.483e+00 S  per = 29.5  per(accum) = 31.9
 T(global opt: dvdsn) = 2.683e+00 S  per = 53.4  per(accum) = 85.3
 T(global opt: decim) = 9.268e-02 S  per = 1.85  per(accum) = 87.2
 T(global opt: guess) = 1.012e-03 S  per = 0.0201  per(accum) = 87.2
 T(global opt: renrm) = 6.403e-01 S  per = 12.7  per(accum) = 100
 T(global opt: save ) = 2.265e-03 S  per = 0.0451  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.683e+00 S  T(sum) = 2.681e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 9.717e-04 S  per = 0.0362  per(accum) = 0.0362
 T(global opt: symbolic_formulae           ) = 1.085e-01 S  per = 4.05  per(accum) = 4.08
 T(global opt: hintermediate init          ) = 2.911e-03 S  per = 0.109  per(accum) = 4.19
 T(global opt: preprocess_hformulae_Hxlist ) = 3.559e-02 S  per = 1.33  per(accum) = 5.52
 T(global opt: hmmtasks init               ) = 7.111e-02 S  per = 2.65  per(accum) = 8.17
 T(global opt: initial guess for dvdson    ) = 2.768e-05 S  per = 0.00103  per(accum) = 8.17
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.059e+00 S  per = 76.8  per(accum) = 85
 T(global opt: dvdson [cpu-gpu]            ) = 5.121e-02 S  per = 1.91  per(accum) = 86.9
 T(global opt: dvdson [nccl]               ) = 2.614e-04 S  per = 0.00975  per(accum) = 86.9
 T(global opt: dvdson [mpi]                ) = 5.019e-06 S  per = 0.000187  per(accum) = 86.9
 T(global opt: dvdson [rest part(linalg)]  ) = 3.505e-01 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 6.403e-01 S  T(sum) = 6.403e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.589e-03 S  per = 0.248  per(accum) = 0.248
 T(global opt: qops init                    ) = 1.808e-02 S  per = 2.82  per(accum) = 3.07
 T(global opt: symbolic_formulae_renorm     ) = 8.443e-02 S  per = 13.2  per(accum) = 16.3
 T(global opt: allocate qops on gpu         ) = 5.313e-04 S  per = 0.083  per(accum) = 16.3
 T(global opt: site memcpy cpu2gpu          ) = 1.080e-02 S  per = 1.69  per(accum) = 18
 T(global opt: rintermediate init           ) = 2.006e-02 S  per = 3.13  per(accum) = 21.2
 T(global opt: preprocess_formulae_Rlist2   ) = 3.415e-02 S  per = 5.33  per(accum) = 26.5
 T(global opt: rmmtasks init                ) = 8.262e-02 S  per = 12.9  per(accum) = 39.4
 T(global opt: qops memset on cpu           ) = 3.600e-07 S  per = 5.62e-05  per(accum) = 39.4
 T(global opt: preprocess_renorm_batchGPU   ) = 3.473e-01 S  per = 54.2  per(accum) = 93.6
 T(global opt: deallocate cpu and gpu memory) = 8.701e-04 S  per = 0.136  per(accum) = 93.8
 T(global opt: construct opS [ifdists=true] ) = 5.330e-07 S  per = 8.32e-05  per(accum) = 93.8
 T(global opt: reduction of opS & opH [nccl]) = 3.780e-07 S  per = 5.9e-05  per(accum) = 93.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.714e-03 S  per = 0.268  per(accum) = 94
 T(global opt: reduction of opS & opH [mpi] ) = 1.884e-04 S  per = 0.0294  per(accum) = 94.1
 T(global opt: qops_pool join and erase     ) = 1.319e-02 S  per = 2.06  per(accum) = 96.1
 T(global opt: conversion from opAB to opPQ ) = 2.483e-02 S  per = 3.88  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=9/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=35:2.670e-04MB:2.608e-07GB
total mem of comb=799:6.096e-03MB:5.953e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 rqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=8266:0.0631MB:6.16e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.088e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.253e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=35:2.670e-04MB
qtensor3: wf3 own=1 _data=0x3877f320
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (15,1):4 (15,3):2 (14,2):1
 qbond: qcol nsym=3 dimAll=7
 (14,-2):4 (14,-4):2 (15,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=35:2.670e-04MB
### DIAG TIMING: total=3.657e-01 t1=2.237e-05, t2=1.397e-03, t3=2.488e-03, t4=3.618e-01, t5=6.726e-06, t6=1.505e-05, t7=2.888e-06
duration_diagGPU:3.657e-01
duration_diagreduce:5.500e-08
duration_diagtransform:5.010e-07
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.583e-02 S -----
rank=0 GPUmem(GB): used=6.159e-05 (oper)=6.159e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.593e-04 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper,hinter)=6.159e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.069e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=4.024e-03,5.045e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.660e-03 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.233e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=5.215e-07 batch[need]=1.086e-03 blksize=16 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=1.210e-03 (oper,hinter,dvdson,batch)=6.159e-05,6.169e-05,5.215e-07,1.086e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=35 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.285e-03,1.007e-02,3.037e-02,1.267e-02,5.440e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.280e-03 speed=4.074e-04GB/S T(nccl)=4.749e-06 speed=1.098e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=40 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.7e+06
 sigma[gemm] counter=40 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=7.7e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=40 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=40 i=4 t=7.6e-03 per=1.4e+01 cost=3.4e+04 flops=4.4e+06
 sigma[gemm] counter=40 i=5 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=40 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.4e+06
 sigma[red] counter=40 t=1.3e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=4.1e-01 t_gemm=1.2e+00 t_reduction=5.0e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=40 t=4.1e-01 per=1.9e+01 cost=1.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=40 i=0 t=9.2e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=7.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=3.0e-01 per=1.4e+01 cost=4.8e+05 flops=1.6e+06
 sigma_tot[gemm] counter=40 i=3 t=3.0e-01 per=1.4e+01 cost=4.9e+05 flops=1.6e+06
 sigma_tot[gemm] counter=40 i=4 t=3.0e-01 per=1.4e+01 cost=6.7e+05 flops=2.2e+06
 sigma_tot[gemm] counter=40 i=5 t=3.0e-01 per=1.4e+01 cost=6.6e+05 flops=2.2e+06
 sigma_tot[gemm] counter=40 total t=1.2e+00 per=5.7e+01 cost=2.3e+06 flops=1.9e+06
 sigma_tot[red] counter=40 t=5.0e-01 per=2.4e+01 cost=6.2e+05 flops=1.3e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,4.5e-06,2.0e-06,1.3e-06,1.8e-07
settings: ndim=35 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.249940669272 -1.116e+03  2.052e-02    1     1  5.451e-02 5.451e-02 5.448e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.139e-03,1.211e-02,2.998e-02,1.273e-02,5.697e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.132e-03 speed=2.446e-04GB/S T(nccl)=6.909e-06 speed=7.549e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=41 t=1.2e-02 per=2.2e+01 cost=6.8e+04 flops=5.6e+06
 sigma[gemm] counter=41 i=0 t=4.7e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=3.9e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=41 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=41 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=41 i=5 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=41 total t=3.0e-02 per=5.5e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=41 t=1.3e-02 per=2.3e+01 cost=4.8e+04 flops=3.7e+06
----- TIMING FOR sigma_tot : t_inter=4.2e-01 t_gemm=1.2e+00 t_reduction=5.1e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=41 t=4.2e-01 per=1.9e+01 cost=1.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=41 i=0 t=9.7e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=7.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=3.1e-01 per=1.4e+01 cost=5.6e+05 flops=1.8e+06
 sigma_tot[gemm] counter=41 i=3 t=3.1e-01 per=1.4e+01 cost=5.6e+05 flops=1.8e+06
 sigma_tot[gemm] counter=41 i=4 t=3.1e-01 per=1.4e+01 cost=7.0e+05 flops=2.3e+06
 sigma_tot[gemm] counter=41 i=5 t=3.1e-01 per=1.4e+01 cost=7.0e+05 flops=2.3e+06
 sigma_tot[gemm] counter=41 total t=1.2e+00 per=5.7e+01 cost=2.5e+06 flops=2.0e+06
 sigma_tot[red] counter=41 t=5.1e-01 per=2.4e+01 cost=6.7e+05 flops=1.3e+06
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=9.7e-06,3.7e-05,6.8e-06,1.8e-06,5.2e-07
    2   0 -    -116.251292325840 -1.352e-03  1.530e-03    2     2  1.246e-01 6.232e-02 5.583e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.757e-04,1.020e-02,3.006e-02,1.273e-02,5.388e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=8.696e-04 speed=5.997e-04GB/S T(nccl)=6.059e-06 speed=8.608e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=42 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.6e+06
 sigma[gemm] counter=42 i=0 t=2.1e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=7.6e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=42 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=42 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=42 i=5 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=42 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=42 t=1.3e-02 per=2.4e+01 cost=4.8e+04 flops=3.7e+06
----- TIMING FOR sigma_tot : t_inter=4.3e-01 t_gemm=1.3e+00 t_reduction=5.2e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=42 t=4.3e-01 per=1.9e+01 cost=1.5e+06 flops=3.5e+06
 sigma_tot[gemm] counter=42 i=0 t=9.9e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=7.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=3.1e-01 per=1.4e+01 cost=6.3e+05 flops=2.0e+06
 sigma_tot[gemm] counter=42 i=3 t=3.1e-01 per=1.4e+01 cost=6.4e+05 flops=2.0e+06
 sigma_tot[gemm] counter=42 i=4 t=3.1e-01 per=1.4e+01 cost=7.3e+05 flops=2.3e+06
 sigma_tot[gemm] counter=42 i=5 t=3.1e-01 per=1.4e+01 cost=7.3e+05 flops=2.3e+06
 sigma_tot[gemm] counter=42 total t=1.3e+00 per=5.7e+01 cost=2.7e+06 flops=2.2e+06
 sigma_tot[red] counter=42 t=5.2e-01 per=2.4e+01 cost=7.2e+05 flops=1.4e+06
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.8e-05,3.8e-06,1.4e-06,3.3e-07
    3   0 -    -116.251300301942 -7.976e-06  5.930e-04    3     3  1.967e-01 6.558e-02 5.522e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.608e-03,1.429e-02,2.994e-02,1.239e-02,5.824e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.601e-03 speed=3.257e-04GB/S T(nccl)=7.099e-06 speed=7.347e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.7e-02 -----
 sigma[inter] counter=43 t=1.4e-02 per=2.5e+01 cost=6.8e+04 flops=4.7e+06
 sigma[gemm] counter=43 i=0 t=4.5e-06 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=3.7e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=7.5e-03 per=1.3e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=43 i=3 t=7.5e-03 per=1.3e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=43 i=4 t=7.4e-03 per=1.3e+01 cost=3.4e+04 flops=4.6e+06
 sigma[gemm] counter=43 i=5 t=7.4e-03 per=1.3e+01 cost=3.5e+04 flops=4.7e+06
 sigma[gemm] counter=43 total t=3.0e-02 per=5.3e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=43 t=1.2e-02 per=2.2e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=4.4e-01 t_gemm=1.3e+00 t_reduction=5.4e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=43 t=4.4e-01 per=2.0e+01 cost=1.6e+06 flops=3.5e+06
 sigma_tot[gemm] counter=43 i=0 t=1.0e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=8.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=3.2e-01 per=1.4e+01 cost=7.1e+05 flops=2.2e+06
 sigma_tot[gemm] counter=43 i=3 t=3.2e-01 per=1.4e+01 cost=7.2e+05 flops=2.2e+06
 sigma_tot[gemm] counter=43 i=4 t=3.2e-01 per=1.4e+01 cost=7.7e+05 flops=2.4e+06
 sigma_tot[gemm] counter=43 i=5 t=3.2e-01 per=1.4e+01 cost=7.7e+05 flops=2.4e+06
 sigma_tot[gemm] counter=43 total t=1.3e+00 per=5.7e+01 cost=3.0e+06 flops=2.3e+06
 sigma_tot[red] counter=43 t=5.4e-01 per=2.4e+01 cost=7.7e+05 flops=1.4e+06
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=8.9e-06,2.9e-05,6.6e-06,2.5e-06,4.1e-07
    4   0 +    -116.251301799857 -1.498e-06  9.479e-05    3     4  2.679e-01 6.698e-02 5.603e-02
TIMING FOR Davidson : 2.679e-01  T(cal/comm/rest)=2.241e-01,7.300e-07,4.381e-02
decomposed t_rest=4.381e-02
 T(sub)    =1.436e-04 per=3.278e-01
 T(precond)=4.353e-02 per=9.937e+01
 T(ortho)  =1.220e-05 per=2.785e-02
 T(xcopy)  =1.150e-06 per=2.625e-03
 T(xnrm2)  =3.002e-06 per=6.852e-03
 T(other)  =1.151e-04 per=2.627e-01
optimized energies: isweep=0 ibond=9 dots=1 e[0]=-116.251301799857 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=4.349e-04 change=1.913e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=8 dimAll=28
 (15,1):5 (17,1):4 (16,2):7 (16,0):4 (15,3):3 (17,3):2 (16,4):2 (14,2):1
timing for divide=2.2e-05
timing for compute=1.1e-02
timing for collect=2.9e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=2.2e-05,1.1e-02,0.0e+00,1.4e-05,2.9e-05 -----
decimation summary: 28->7 dwt=-2.220e-16 SvN=1.013e+00
 qbond: qkept nsym=3 dimAll=7
 (16,2):4 (16,4):2 (15,3):1
----- TIMING for decimation_row(nkr): 1.149e-02 S T(decim/select/formRot)=1.107e-02,3.744e-04,3.643e-05 -----
----- TIMING FOR onedot_decimation: 1.162e-02 S T(wf/decim)=1.081e-04,1.151e-02 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.46 S:2.02 P:0 Q:94.7 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=4.272e-04 change=1.902e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 6.077e-02 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper)=6.159e-05
rank=0 GPUmem(GB): used=1.235e-04 (oper,site)=6.159e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.531e-03 S -----
rank=0 GPUmem(GB): used=1.852e-04 (oper,site,rinter)=6.159e-05,2.608e-07,6.169e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.464e-02 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=9.110e-03,5.525e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.517e-02 S size(rtasks)=365 size(Rlst)=2015 -----
rank=0 GPUmem(GB): used=1.852e-04 avail=6.176e+00 total=6.176e+00 batch[need]=5.555e-04 blksize=16 blksize0=4 batchsize=2015
rank=0 GPUmem(GB): used=7.407e-04 (oper,site,rinter,batch)=6.159e-05,2.608e-07,6.169e-05,5.555e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.708e-03,2.244e-02,9.967e-03
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=10 t=6.7e-03 per=1.7e+01 cost=3.4e+04 flops=5.0e+06
 renorm[gemm] counter=10 i=0 t=2.2e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.9e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=1.9e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=3 t=1.9e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=4 t=7.5e-03 per=1.9e+01 cost=7.6e+03 flops=1.0e+06
 renorm[gemm] counter=10 i=5 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.8e+06
 renorm[gemm] counter=10 i=6 t=7.5e-03 per=1.9e+01 cost=8.2e+04 flops=1.1e+07
 renorm[gemm] counter=10 total t=2.2e-02 per=5.7e+01 cost=1.2e+05 flops=5.3e+06
 renorm[red] counter=10 t=1.0e-02 per=2.5e+01 cost=3.8e+04 flops=3.8e+06
----- TIMING FOR renorm_tot : t_inter=6.0e-02 t_gemm=2.2e-01 t_reduction=1.0e-01 tot=3.9e-01 -----
 renorm_tot[inter] counter=10 t=6.0e-02 per=1.6e+01 cost=4.4e+05 flops=7.3e+06
 renorm_tot[gemm] counter=10 i=0 t=1.6e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.4e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=1.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=3 t=1.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=4 t=7.3e-02 per=1.9e+01 cost=2.0e+05 flops=2.7e+06
 renorm_tot[gemm] counter=10 i=5 t=7.6e-02 per=2.0e+01 cost=2.4e+05 flops=3.2e+06
 renorm_tot[gemm] counter=10 i=6 t=7.5e-02 per=2.0e+01 cost=1.4e+06 flops=1.8e+07
 renorm_tot[gemm] counter=10 total t=2.2e-01 per=5.8e+01 cost=1.8e+06 flops=8.0e+06
 renorm_tot[red] counter=10 t=1.0e-01 per=2.6e+01 cost=6.2e+05 flops=6.2e+06
qops.to_cpu: size(tot)=2679:2.0e-02MB:2.0e-05GB T(to_cpu)=5.3e-04S speed=3.7e-02GB/S
check ||H-H.dagger||=1.922e-15 coord=(10,0) rank=0
----- TIMING FOR oper_renorm : 0.148 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=6.027e-04 change=1.392e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.915e-03 change=-2.671e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.915e-03 change=-7.153e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.660e-01 S #####
 T(local opt: fetch) = 1.097e-02 S  per = 1.27  per(accum) = 1.27
 T(local opt: hdiag) = 3.658e-01 S  per = 42.2  per(accum) = 43.5
 T(local opt: dvdsn) = 3.264e-01 S  per = 37.7  per(accum) = 81.2
 T(local opt: decim) = 1.164e-02 S  per = 1.34  per(accum) = 82.5
 T(local opt: guess) = 1.624e-04 S  per = 0.0188  per(accum) = 82.6
 T(local opt: renrm) = 1.507e-01 S  per = 17.4  per(accum) = 100
 T(local opt: save ) = 3.272e-04 S  per = 0.0378  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.264e-01 S  T(sum) = 3.257e-01 S  per = 9.978e+01
 T(local opt: preprocess                  ) = 9.568e-05 S  per = 0.0294  per(accum) = 0.0294
 T(local opt: symbolic_formulae           ) = 2.584e-02 S  per = 7.93  per(accum) = 7.96
 T(local opt: hintermediate init          ) = 6.781e-04 S  per = 0.208  per(accum) = 8.17
 T(local opt: preprocess_hformulae_Hxlist ) = 9.776e-03 S  per =    3  per(accum) = 11.2
 T(local opt: hmmtasks init               ) = 2.140e-02 S  per = 6.57  per(accum) = 17.7
 T(local opt: initial guess for dvdson    ) = 4.395e-06 S  per = 0.00135  per(accum) = 17.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.182e-01 S  per =   67  per(accum) = 84.7
 T(local opt: dvdson [cpu-gpu]            ) = 5.884e-03 S  per = 1.81  per(accum) = 86.5
 T(local opt: dvdson [nccl]               ) = 2.482e-05 S  per = 0.00762  per(accum) = 86.6
 T(local opt: dvdson [mpi]                ) = 7.300e-07 S  per = 0.000224  per(accum) = 86.6
 T(local opt: dvdson [rest part(linalg)]  ) = 4.381e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.507e-01 S  T(sum) = 1.507e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.259e-04 S  per = 0.0836  per(accum) = 0.0836
 T(local opt: qops init                    ) = 4.225e-03 S  per =  2.8  per(accum) = 2.89
 T(local opt: symbolic_formulae_renorm     ) = 6.080e-02 S  per = 40.3  per(accum) = 43.2
 T(local opt: allocate qops on gpu         ) = 9.556e-05 S  per = 0.0634  per(accum) = 43.3
 T(local opt: site memcpy cpu2gpu          ) = 2.092e-03 S  per = 1.39  per(accum) = 44.7
 T(local opt: rintermediate init           ) = 2.556e-03 S  per =  1.7  per(accum) = 46.4
 T(local opt: preprocess_formulae_Rlist2   ) = 1.529e-02 S  per = 10.1  per(accum) = 56.5
 T(local opt: rmmtasks init                ) = 2.320e-02 S  per = 15.4  per(accum) = 71.9
 T(local opt: qops memset on cpu           ) = 7.600e-08 S  per = 5.04e-05  per(accum) = 71.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.925e-02 S  per =   26  per(accum) = 98
 T(local opt: deallocate cpu and gpu memory) = 1.601e-04 S  per = 0.106  per(accum) = 98.1
 T(local opt: construct opS [ifdists=true] ) = 8.100e-08 S  per = 5.38e-05  per(accum) = 98.1
 T(local opt: reduction of opS & opH [nccl]) = 6.200e-08 S  per = 4.11e-05  per(accum) = 98.1
 T(local opt: qops memcpy gpu2cpu          ) = 5.448e-04 S  per = 0.362  per(accum) = 98.4
 T(local opt: reduction of opS & opH [mpi] ) = 2.379e-05 S  per = 0.0158  per(accum) = 98.5
 T(local opt: qops_pool join and erase     ) = 2.324e-03 S  per = 1.54  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.026e-06 S  per = 0.00134  per(accum) = 100
##### sweep opt: 5.889e+00 S #####
 T(sweep opt: fetch) = 1.319e-01 S  per = 2.24  per(accum) = 2.24
 T(sweep opt: hdiag) = 1.848e+00 S  per = 31.4  per(accum) = 33.6
 T(sweep opt: dvdsn) = 3.010e+00 S  per = 51.1  per(accum) = 84.7
 T(sweep opt: decim) = 1.043e-01 S  per = 1.77  per(accum) = 86.5
 T(sweep opt: guess) = 1.174e-03 S  per = 0.0199  per(accum) = 86.5
 T(sweep opt: renrm) = 7.910e-01 S  per = 13.4  per(accum) = 100
 T(sweep opt: save ) = 2.592e-03 S  per = 0.044  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.010e+00 S  T(sum) = 3.006e+00 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 1.067e-03 S  per = 0.0355  per(accum) = 0.0355
 T(sweep opt: symbolic_formulae           ) = 1.344e-01 S  per = 4.47  per(accum) = 4.5
 T(sweep opt: hintermediate init          ) = 3.590e-03 S  per = 0.119  per(accum) = 4.62
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.537e-02 S  per = 1.51  per(accum) = 6.13
 T(sweep opt: hmmtasks init               ) = 9.251e-02 S  per = 3.08  per(accum) = 9.21
 T(sweep opt: initial guess for dvdson    ) = 3.207e-05 S  per = 0.00107  per(accum) = 9.21
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.278e+00 S  per = 75.8  per(accum) = 85
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.709e-02 S  per =  1.9  per(accum) = 86.9
 T(sweep opt: dvdson [nccl]               ) = 2.862e-04 S  per = 0.00952  per(accum) = 86.9
 T(sweep opt: dvdson [mpi]                ) = 5.749e-06 S  per = 0.000191  per(accum) = 86.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.943e-01 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 7.910e-01 S  T(sum) = 7.910e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.715e-03 S  per = 0.217  per(accum) = 0.217
 T(sweep opt: qops init                    ) = 2.230e-02 S  per = 2.82  per(accum) = 3.04
 T(sweep opt: symbolic_formulae_renorm     ) = 1.452e-01 S  per = 18.4  per(accum) = 21.4
 T(sweep opt: allocate qops on gpu         ) = 6.269e-04 S  per = 0.0792  per(accum) = 21.5
 T(sweep opt: site memcpy cpu2gpu          ) = 1.289e-02 S  per = 1.63  per(accum) = 23.1
 T(sweep opt: rintermediate init           ) = 2.262e-02 S  per = 2.86  per(accum) = 26
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.944e-02 S  per = 6.25  per(accum) = 32.2
 T(sweep opt: rmmtasks init                ) = 1.058e-01 S  per = 13.4  per(accum) = 45.6
 T(sweep opt: qops memset on cpu           ) = 4.360e-07 S  per = 5.51e-05  per(accum) = 45.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.865e-01 S  per = 48.9  per(accum) = 94.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.030e-03 S  per = 0.13  per(accum) = 94.6
 T(sweep opt: construct opS [ifdists=true] ) = 6.140e-07 S  per = 7.76e-05  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [nccl]) = 4.400e-07 S  per = 5.56e-05  per(accum) = 94.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.259e-03 S  per = 0.286  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.122e-04 S  per = 0.0268  per(accum) = 94.9
 T(sweep opt: qops_pool join and erase     ) = 1.551e-02 S  per = 1.96  per(accum) = 96.9
 T(sweep opt: conversion from opAB to opPQ ) = 2.483e-02 S  per = 3.14  per(accum) = 100
##### global opt: 5.889e+00 S #####
 T(global opt: fetch) = 1.319e-01 S  per = 2.24  per(accum) = 2.24
 T(global opt: hdiag) = 1.848e+00 S  per = 31.4  per(accum) = 33.6
 T(global opt: dvdsn) = 3.010e+00 S  per = 51.1  per(accum) = 84.7
 T(global opt: decim) = 1.043e-01 S  per = 1.77  per(accum) = 86.5
 T(global opt: guess) = 1.174e-03 S  per = 0.0199  per(accum) = 86.5
 T(global opt: renrm) = 7.910e-01 S  per = 13.4  per(accum) = 100
 T(global opt: save ) = 2.592e-03 S  per = 0.044  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.010e+00 S  T(sum) = 3.006e+00 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 1.067e-03 S  per = 0.0355  per(accum) = 0.0355
 T(global opt: symbolic_formulae           ) = 1.344e-01 S  per = 4.47  per(accum) = 4.5
 T(global opt: hintermediate init          ) = 3.590e-03 S  per = 0.119  per(accum) = 4.62
 T(global opt: preprocess_hformulae_Hxlist ) = 4.537e-02 S  per = 1.51  per(accum) = 6.13
 T(global opt: hmmtasks init               ) = 9.251e-02 S  per = 3.08  per(accum) = 9.21
 T(global opt: initial guess for dvdson    ) = 3.207e-05 S  per = 0.00107  per(accum) = 9.21
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.278e+00 S  per = 75.8  per(accum) = 85
 T(global opt: dvdson [cpu-gpu]            ) = 5.709e-02 S  per =  1.9  per(accum) = 86.9
 T(global opt: dvdson [nccl]               ) = 2.862e-04 S  per = 0.00952  per(accum) = 86.9
 T(global opt: dvdson [mpi]                ) = 5.749e-06 S  per = 0.000191  per(accum) = 86.9
 T(global opt: dvdson [rest part(linalg)]  ) = 3.943e-01 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 7.910e-01 S  T(sum) = 7.910e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.715e-03 S  per = 0.217  per(accum) = 0.217
 T(global opt: qops init                    ) = 2.230e-02 S  per = 2.82  per(accum) = 3.04
 T(global opt: symbolic_formulae_renorm     ) = 1.452e-01 S  per = 18.4  per(accum) = 21.4
 T(global opt: allocate qops on gpu         ) = 6.269e-04 S  per = 0.0792  per(accum) = 21.5
 T(global opt: site memcpy cpu2gpu          ) = 1.289e-02 S  per = 1.63  per(accum) = 23.1
 T(global opt: rintermediate init           ) = 2.262e-02 S  per = 2.86  per(accum) = 26
 T(global opt: preprocess_formulae_Rlist2   ) = 4.944e-02 S  per = 6.25  per(accum) = 32.2
 T(global opt: rmmtasks init                ) = 1.058e-01 S  per = 13.4  per(accum) = 45.6
 T(global opt: qops memset on cpu           ) = 4.360e-07 S  per = 5.51e-05  per(accum) = 45.6
 T(global opt: preprocess_renorm_batchGPU   ) = 3.865e-01 S  per = 48.9  per(accum) = 94.5
 T(global opt: deallocate cpu and gpu memory) = 1.030e-03 S  per = 0.13  per(accum) = 94.6
 T(global opt: construct opS [ifdists=true] ) = 6.140e-07 S  per = 7.76e-05  per(accum) = 94.6
 T(global opt: reduction of opS & opH [nccl]) = 4.400e-07 S  per = 5.56e-05  per(accum) = 94.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.259e-03 S  per = 0.286  per(accum) = 94.9
 T(global opt: reduction of opS & opH [mpi] ) = 2.122e-04 S  per = 0.0268  per(accum) = 94.9
 T(global opt: qops_pool join and erase     ) = 1.551e-02 S  per = 1.96  per(accum) = 96.9
 T(global opt: conversion from opAB to opPQ ) = 2.483e-02 S  per = 3.14  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=10/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=30:2.289e-04MB:2.235e-07GB
total mem of comb=794:6.058e-03MB:5.916e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.46 S:2.02 P:0 Q:94.7 
 rqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=6840:0.0522MB:5.1e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.046e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=30:2.289e-04MB
qtensor3: wf3 own=1 _data=0x423970e0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (16,2):4 (16,4):2 (15,3):1
 qbond: qcol nsym=3 dimAll=7
 (12,-2):3 (13,-3):2 (12,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=30:2.289e-04MB
### DIAG TIMING: total=3.120e-01 t1=3.106e-05, t2=2.075e-03, t3=2.528e-03, t4=3.073e-01, t5=4.921e-06, t6=1.397e-05, t7=3.462e-06
duration_diagGPU:3.120e-01
duration_diagreduce:3.600e-08
duration_diagtransform:7.700e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.188e-02 S -----
rank=0 GPUmem(GB): used=5.096e-05 (oper)=5.096e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.220e-04 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper,hinter)=5.096e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.434e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.315e-03,3.119e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.793e-03 S size(H_formulae)=1327 size(Hxlst)=2480 -----
rank=0 GPUmem(GB): used=1.054e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.470e-07 batch[need]=5.358e-04 blksize=12 blksize0=4 batchsize=2480
rank=0 GPUmem(GB): used=6.417e-04 (oper,hinter,dvdson,batch)=5.096e-05,5.442e-05,4.470e-07,5.358e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.640e-04,1.003e-02,2.992e-02,1.245e-02,5.307e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=6.591e-04 speed=6.783e-04GB/S T(nccl)=4.916e-06 speed=9.093e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=44 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=44 i=0 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=7.4e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=44 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=44 i=4 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=44 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=44 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=44 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.5e-01 t_gemm=1.3e+00 t_reduction=5.5e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=44 t=4.5e-01 per=2.0e+01 cost=1.6e+06 flops=3.5e+06
 sigma_tot[gemm] counter=44 i=0 t=1.0e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=8.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=3.3e-01 per=1.4e+01 cost=7.4e+05 flops=2.3e+06
 sigma_tot[gemm] counter=44 i=3 t=3.3e-01 per=1.4e+01 cost=7.5e+05 flops=2.3e+06
 sigma_tot[gemm] counter=44 i=4 t=3.3e-01 per=1.4e+01 cost=7.9e+05 flops=2.4e+06
 sigma_tot[gemm] counter=44 i=5 t=3.3e-01 per=1.4e+01 cost=7.9e+05 flops=2.4e+06
 sigma_tot[gemm] counter=44 total t=1.3e+00 per=5.7e+01 cost=3.1e+06 flops=2.3e+06
 sigma_tot[red] counter=44 t=5.5e-01 per=2.4e+01 cost=8.0e+05 flops=1.4e+06
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.1e-06,1.9e-06,9.6e-07,1.8e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.251301799857 -1.116e+03  6.597e-02    1     1  5.318e-02 5.318e-02 5.316e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.469e-04,9.906e-03,3.016e-02,1.261e-02,5.334e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=6.407e-04 speed=6.977e-04GB/S T(nccl)=6.207e-06 speed=7.202e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=45 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.3e+06
 sigma[gemm] counter=45 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=45 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=45 i=4 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=45 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=45 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=45 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.6e-01 t_gemm=1.3e+00 t_reduction=5.6e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=45 t=4.6e-01 per=2.0e+01 cost=1.6e+06 flops=3.5e+06
 sigma_tot[gemm] counter=45 i=0 t=1.1e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=8.5e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=3.4e-01 per=1.4e+01 cost=7.7e+05 flops=2.3e+06
 sigma_tot[gemm] counter=45 i=3 t=3.4e-01 per=1.4e+01 cost=7.8e+05 flops=2.3e+06
 sigma_tot[gemm] counter=45 i=4 t=3.4e-01 per=1.4e+01 cost=8.1e+05 flops=2.4e+06
 sigma_tot[gemm] counter=45 i=5 t=3.4e-01 per=1.4e+01 cost=8.1e+05 flops=2.4e+06
 sigma_tot[gemm] counter=45 total t=1.3e+00 per=5.7e+01 cost=3.2e+06 flops=2.4e+06
 sigma_tot[red] counter=45 t=5.6e-01 per=2.4e+01 cost=8.2e+05 flops=1.5e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.5e-05,3.4e-06,1.0e-06,2.3e-07
    2   0 -    -116.270096750207 -1.879e-02  1.957e-02    2     2  1.188e-01 5.941e-02 5.329e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.145e-04,9.855e-03,2.977e-02,1.249e-02,5.244e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=3.098e-04 speed=1.443e-03GB/S T(nccl)=4.758e-06 speed=9.395e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=46 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.3e+06
 sigma[gemm] counter=46 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=7.4e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=46 i=3 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=46 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=46 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=46 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=46 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.7e-01 t_gemm=1.4e+00 t_reduction=5.7e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=46 t=4.7e-01 per=2.0e+01 cost=1.7e+06 flops=3.6e+06
 sigma_tot[gemm] counter=46 i=0 t=1.1e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=8.6e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=3.4e-01 per=1.4e+01 cost=8.0e+05 flops=2.3e+06
 sigma_tot[gemm] counter=46 i=3 t=3.4e-01 per=1.4e+01 cost=8.1e+05 flops=2.4e+06
 sigma_tot[gemm] counter=46 i=4 t=3.4e-01 per=1.4e+01 cost=8.4e+05 flops=2.4e+06
 sigma_tot[gemm] counter=46 i=5 t=3.4e-01 per=1.4e+01 cost=8.4e+05 flops=2.4e+06
 sigma_tot[gemm] counter=46 total t=1.4e+00 per=5.7e+01 cost=3.3e+06 flops=2.4e+06
 sigma_tot[red] counter=46 t=5.7e-01 per=2.4e+01 cost=8.5e+05 flops=1.5e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.5e-05,3.0e-06,1.1e-06,2.3e-07
    3   0 -    -116.271822298222 -1.726e-03  5.812e-03    3     3  1.839e-01 6.130e-02 5.304e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.931e-03,1.005e-02,3.014e-02,1.240e-02,5.454e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.926e-03 speed=2.322e-04GB/S T(nccl)=5.821e-06 speed=7.680e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=47 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=47 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=47 i=3 t=7.6e-03 per=1.5e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=47 i=4 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=47 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=47 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=47 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.8e-01 t_gemm=1.4e+00 t_reduction=5.9e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=47 t=4.8e-01 per=2.0e+01 cost=1.7e+06 flops=3.6e+06
 sigma_tot[gemm] counter=47 i=0 t=1.1e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=8.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=3.5e-01 per=1.4e+01 cost=8.3e+05 flops=2.4e+06
 sigma_tot[gemm] counter=47 i=3 t=3.5e-01 per=1.4e+01 cost=8.4e+05 flops=2.4e+06
 sigma_tot[gemm] counter=47 i=4 t=3.5e-01 per=1.4e+01 cost=8.6e+05 flops=2.4e+06
 sigma_tot[gemm] counter=47 i=5 t=3.5e-01 per=1.4e+01 cost=8.6e+05 flops=2.4e+06
 sigma_tot[gemm] counter=47 total t=1.4e+00 per=5.7e+01 cost=3.4e+06 flops=2.4e+06
 sigma_tot[red] counter=47 t=5.9e-01 per=2.4e+01 cost=8.8e+05 flops=1.5e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.8e-05,3.1e-06,1.0e-06,2.3e-07
    4   0 -    -116.271893465758 -7.117e-05  1.023e-03    3     4  2.537e-01 6.342e-02 5.344e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.055e-04,1.013e-02,3.032e-02,1.248e-02,5.334e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=4.005e-04 speed=1.116e-03GB/S T(nccl)=4.967e-06 speed=9.000e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=48 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=48 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=48 i=3 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=48 i=4 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=48 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=48 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=48 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.9e-01 t_gemm=1.4e+00 t_reduction=6.0e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=48 t=4.9e-01 per=1.9e+01 cost=1.8e+06 flops=3.6e+06
 sigma_tot[gemm] counter=48 i=0 t=1.1e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=8.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=3.6e-01 per=1.4e+01 cost=8.6e+05 flops=2.4e+06
 sigma_tot[gemm] counter=48 i=3 t=3.6e-01 per=1.4e+01 cost=8.8e+05 flops=2.4e+06
 sigma_tot[gemm] counter=48 i=4 t=3.6e-01 per=1.4e+01 cost=8.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=48 i=5 t=3.6e-01 per=1.4e+01 cost=8.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=48 total t=1.4e+00 per=5.7e+01 cost=3.5e+06 flops=2.4e+06
 sigma_tot[red] counter=48 t=6.0e-01 per=2.4e+01 cost=9.1e+05 flops=1.5e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,2.8e-06,9.8e-07,2.6e-07
    5   0 -    -116.271896238916 -2.773e-06  2.507e-04    3     5  3.175e-01 6.350e-02 5.344e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.428e-04,1.012e-02,3.038e-02,1.269e-02,5.393e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=7.383e-04 speed=6.055e-04GB/S T(nccl)=4.568e-06 speed=9.786e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=49 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=49 i=0 t=1.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=49 i=3 t=7.7e-03 per=1.4e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=49 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=49 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=49 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=49 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=5.0e-01 t_gemm=1.5e+00 t_reduction=6.1e-01 tot=2.6e+00 -----
 sigma_tot[inter] counter=49 t=5.0e-01 per=1.9e+01 cost=1.8e+06 flops=3.6e+06
 sigma_tot[gemm] counter=49 i=0 t=1.1e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=9.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=3.7e-01 per=1.4e+01 cost=8.9e+05 flops=2.4e+06
 sigma_tot[gemm] counter=49 i=3 t=3.7e-01 per=1.4e+01 cost=9.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=49 i=4 t=3.7e-01 per=1.4e+01 cost=9.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=49 i=5 t=3.7e-01 per=1.4e+01 cost=9.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=49 total t=1.5e+00 per=5.7e+01 cost=3.6e+06 flops=2.5e+06
 sigma_tot[red] counter=49 t=6.1e-01 per=2.4e+01 cost=9.3e+05 flops=1.5e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.8e-06,9.3e-07,2.0e-07
    6   0 +    -116.271896441599 -2.027e-07  6.465e-05    3     6  3.816e-01 6.360e-02 5.353e-02
TIMING FOR Davidson : 3.816e-01  T(cal/comm/rest)=3.212e-01,6.360e-07,6.040e-02
decomposed t_rest=6.040e-02
 T(sub)    =1.279e-04 per=2.117e-01
 T(precond)=6.011e-02 per=9.952e+01
 T(ortho)  =3.732e-05 per=6.179e-02
 T(xcopy)  =8.190e-07 per=1.356e-03
 T(xnrm2)  =2.779e-06 per=4.601e-03
 T(other)  =1.196e-04 per=1.980e-01
optimized energies: isweep=0 ibond=10 dots=1 e[0]=-116.271896441599 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.433e-04 change=1.454e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=8 dimAll=28
 (16,2):5 (18,2):4 (17,3):7 (17,1):4 (16,4):3 (18,4):2 (17,5):2 (15,3):1
timing for divide=1.0e-05
timing for compute=1.3e-02
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,1.3e-02,0.0e+00,4.2e-06,1.5e-05 -----
decimation summary: 28->7 dwt=+0.000e+00 SvN=6.106e-01
 qbond: qkept nsym=3 dimAll=7
 (18,2):3 (17,3):2 (18,4):2
----- TIMING for decimation_row(nkr): 1.293e-02 S T(decim/select/formRot)=1.269e-02,2.227e-04,1.967e-05 -----
----- TIMING FOR onedot_decimation: 1.299e-02 S T(wf/decim)=4.881e-05,1.294e-02 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:6.58 S:4.38 P:0 Q:88.1 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.433e-04 change=1.551e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.232e-02 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper)=5.096e-05
rank=0 GPUmem(GB): used=1.056e-04 (oper,site)=5.096e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.530e-03 S -----
rank=0 GPUmem(GB): used=1.600e-04 (oper,site,rinter)=5.096e-05,2.235e-07,5.442e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 5.540e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=3.572e-03,1.968e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.782e-03 S size(rtasks)=297 size(Rlst)=1278 -----
rank=0 GPUmem(GB): used=1.600e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.761e-04 blksize=12 blksize0=4 batchsize=1278
rank=0 GPUmem(GB): used=4.362e-04 (oper,site,rinter,batch)=5.096e-05,2.235e-07,5.442e-05,2.761e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.822e-03,2.284e-02,1.011e-02
----- TIMING FOR renorm : t_inter=5.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=11 t=5.8e-03 per=1.5e+01 cost=2.1e+04 flops=3.6e+06
 renorm[gemm] counter=11 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=4 t=7.6e-03 per=2.0e+01 cost=4.6e+03 flops=6.1e+05
 renorm[gemm] counter=11 i=5 t=7.6e-03 per=1.9e+01 cost=2.0e+04 flops=2.6e+06
 renorm[gemm] counter=11 i=6 t=7.7e-03 per=2.0e+01 cost=3.2e+04 flops=4.2e+06
 renorm[gemm] counter=11 total t=2.3e-02 per=5.9e+01 cost=5.7e+04 flops=2.5e+06
 renorm[red] counter=11 t=1.0e-02 per=2.6e+01 cost=1.2e+04 flops=1.2e+06
----- TIMING FOR renorm_tot : t_inter=6.6e-02 t_gemm=2.5e-01 t_reduction=1.1e-01 tot=4.2e-01 -----
 renorm_tot[inter] counter=11 t=6.6e-02 per=1.6e+01 cost=4.6e+05 flops=7.0e+06
 renorm_tot[gemm] counter=11 i=0 t=1.8e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=1.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=3 t=1.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=4 t=8.1e-02 per=1.9e+01 cost=2.0e+05 flops=2.5e+06
 renorm_tot[gemm] counter=11 i=5 t=8.3e-02 per=2.0e+01 cost=2.6e+05 flops=3.1e+06
 renorm_tot[gemm] counter=11 i=6 t=8.3e-02 per=2.0e+01 cost=1.4e+06 flops=1.7e+07
 renorm_tot[gemm] counter=11 total t=2.5e-01 per=5.8e+01 cost=1.8e+06 flops=7.5e+06
 renorm_tot[red] counter=11 t=1.1e-01 per=2.6e+01 cost=6.4e+05 flops=5.8e+06
qops.to_cpu: size(tot)=1825:1.4e-02MB:1.4e-05GB T(to_cpu)=2.6e-04S speed=5.1e-02GB/S
check ||H-H.dagger||=9.466e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0811 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=6.104e-05 change=1.085e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.045e-03 change=-2.300e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.045e-03 change=-6.706e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.482e-01 S #####
 T(local opt: fetch) = 1.609e-02 S  per =  1.9  per(accum) = 1.9
 T(local opt: hdiag) = 3.121e-01 S  per = 36.8  per(accum) = 38.7
 T(local opt: dvdsn) = 4.240e-01 S  per =   50  per(accum) = 88.7
 T(local opt: decim) = 1.300e-02 S  per = 1.53  per(accum) = 90.2
 T(local opt: guess) = 7.415e-05 S  per = 0.00874  per(accum) = 90.2
 T(local opt: renrm) = 8.276e-02 S  per = 9.76  per(accum) = 100
 T(local opt: save ) = 2.473e-04 S  per = 0.0292  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.240e-01 S  T(sum) = 4.236e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 9.517e-05 S  per = 0.0225  per(accum) = 0.0225
 T(local opt: symbolic_formulae           ) = 2.190e-02 S  per = 5.17  per(accum) = 5.19
 T(local opt: hintermediate init          ) = 5.399e-04 S  per = 0.127  per(accum) = 5.32
 T(local opt: preprocess_hformulae_Hxlist ) = 6.864e-03 S  per = 1.62  per(accum) = 6.94
 T(local opt: hmmtasks init               ) = 1.259e-02 S  per = 2.97  per(accum) = 9.91
 T(local opt: initial guess for dvdson    ) = 2.991e-06 S  per = 0.000706  per(accum) = 9.91
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.165e-01 S  per = 74.7  per(accum) = 84.6
 T(local opt: dvdson [cpu-gpu]            ) = 4.674e-03 S  per =  1.1  per(accum) = 85.7
 T(local opt: dvdson [nccl]               ) = 3.124e-05 S  per = 0.00737  per(accum) = 85.7
 T(local opt: dvdson [mpi]                ) = 6.360e-07 S  per = 0.00015  per(accum) = 85.7
 T(local opt: dvdson [rest part(linalg)]  ) = 6.040e-02 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 8.276e-02 S  T(sum) = 8.276e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.318e-05 S  per = 0.0884  per(accum) = 0.0884
 T(local opt: qops init                    ) = 2.090e-03 S  per = 2.52  per(accum) = 2.61
 T(local opt: symbolic_formulae_renorm     ) = 2.233e-02 S  per =   27  per(accum) = 29.6
 T(local opt: allocate qops on gpu         ) = 5.175e-05 S  per = 0.0625  per(accum) = 29.7
 T(local opt: site memcpy cpu2gpu          ) = 2.139e-03 S  per = 2.58  per(accum) = 32.2
 T(local opt: rintermediate init           ) = 2.543e-03 S  per = 3.07  per(accum) = 35.3
 T(local opt: preprocess_formulae_Rlist2   ) = 5.824e-03 S  per = 7.04  per(accum) = 42.4
 T(local opt: rmmtasks init                ) = 6.869e-03 S  per =  8.3  per(accum) = 50.7
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 3.62e-05  per(accum) = 50.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.886e-02 S  per = 46.9  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 6.217e-05 S  per = 0.0751  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 5.400e-08 S  per = 6.52e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 4.100e-08 S  per = 4.95e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 2.710e-04 S  per = 0.327  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.635e-05 S  per = 0.0198  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.633e-03 S  per = 1.97  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.394e-06 S  per = 0.00168  per(accum) = 100
##### sweep opt: 6.737e+00 S #####
 T(sweep opt: fetch) = 1.480e-01 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: hdiag) = 2.160e+00 S  per = 32.1  per(accum) = 34.3
 T(sweep opt: dvdsn) = 3.434e+00 S  per =   51  per(accum) = 85.2
 T(sweep opt: decim) = 1.173e-01 S  per = 1.74  per(accum) = 87
 T(sweep opt: guess) = 1.248e-03 S  per = 0.0185  per(accum) = 87
 T(sweep opt: renrm) = 8.738e-01 S  per =   13  per(accum) = 100
 T(sweep opt: save ) = 2.840e-03 S  per = 0.0421  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.434e+00 S  T(sum) = 3.430e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 1.163e-03 S  per = 0.0339  per(accum) = 0.0339
 T(sweep opt: symbolic_formulae           ) = 1.562e-01 S  per = 4.56  per(accum) = 4.59
 T(sweep opt: hintermediate init          ) = 4.130e-03 S  per = 0.12  per(accum) = 4.71
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.223e-02 S  per = 1.52  per(accum) = 6.23
 T(sweep opt: hmmtasks init               ) = 1.051e-01 S  per = 3.06  per(accum) = 9.3
 T(sweep opt: initial guess for dvdson    ) = 3.506e-05 S  per = 0.00102  per(accum) = 9.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.594e+00 S  per = 75.6  per(accum) = 84.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.176e-02 S  per =  1.8  per(accum) = 86.7
 T(sweep opt: dvdson [nccl]               ) = 3.174e-04 S  per = 0.00925  per(accum) = 86.7
 T(sweep opt: dvdson [mpi]                ) = 6.385e-06 S  per = 0.000186  per(accum) = 86.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.547e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 8.738e-01 S  T(sum) = 8.738e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.788e-03 S  per = 0.205  per(accum) = 0.205
 T(sweep opt: qops init                    ) = 2.439e-02 S  per = 2.79  per(accum) = 3
 T(sweep opt: symbolic_formulae_renorm     ) = 1.676e-01 S  per = 19.2  per(accum) = 22.2
 T(sweep opt: allocate qops on gpu         ) = 6.786e-04 S  per = 0.0777  per(accum) = 22.3
 T(sweep opt: site memcpy cpu2gpu          ) = 1.503e-02 S  per = 1.72  per(accum) = 24
 T(sweep opt: rintermediate init           ) = 2.516e-02 S  per = 2.88  per(accum) = 26.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.526e-02 S  per = 6.32  per(accum) = 33.2
 T(sweep opt: rmmtasks init                ) = 1.127e-01 S  per = 12.9  per(accum) = 46.1
 T(sweep opt: qops memset on cpu           ) = 4.660e-07 S  per = 5.33e-05  per(accum) = 46.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.254e-01 S  per = 48.7  per(accum) = 94.8
 T(sweep opt: deallocate cpu and gpu memory) = 1.092e-03 S  per = 0.125  per(accum) = 94.9
 T(sweep opt: construct opS [ifdists=true] ) = 6.680e-07 S  per = 7.64e-05  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [nccl]) = 4.810e-07 S  per = 5.5e-05  per(accum) = 94.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.530e-03 S  per = 0.289  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.285e-04 S  per = 0.0262  per(accum) = 95.2
 T(sweep opt: qops_pool join and erase     ) = 1.715e-02 S  per = 1.96  per(accum) = 97.2
 T(sweep opt: conversion from opAB to opPQ ) = 2.483e-02 S  per = 2.84  per(accum) = 100
##### global opt: 6.737e+00 S #####
 T(global opt: fetch) = 1.480e-01 S  per =  2.2  per(accum) = 2.2
 T(global opt: hdiag) = 2.160e+00 S  per = 32.1  per(accum) = 34.3
 T(global opt: dvdsn) = 3.434e+00 S  per =   51  per(accum) = 85.2
 T(global opt: decim) = 1.173e-01 S  per = 1.74  per(accum) = 87
 T(global opt: guess) = 1.248e-03 S  per = 0.0185  per(accum) = 87
 T(global opt: renrm) = 8.738e-01 S  per =   13  per(accum) = 100
 T(global opt: save ) = 2.840e-03 S  per = 0.0421  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.434e+00 S  T(sum) = 3.430e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 1.163e-03 S  per = 0.0339  per(accum) = 0.0339
 T(global opt: symbolic_formulae           ) = 1.562e-01 S  per = 4.56  per(accum) = 4.59
 T(global opt: hintermediate init          ) = 4.130e-03 S  per = 0.12  per(accum) = 4.71
 T(global opt: preprocess_hformulae_Hxlist ) = 5.223e-02 S  per = 1.52  per(accum) = 6.23
 T(global opt: hmmtasks init               ) = 1.051e-01 S  per = 3.06  per(accum) = 9.3
 T(global opt: initial guess for dvdson    ) = 3.506e-05 S  per = 0.00102  per(accum) = 9.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.594e+00 S  per = 75.6  per(accum) = 84.9
 T(global opt: dvdson [cpu-gpu]            ) = 6.176e-02 S  per =  1.8  per(accum) = 86.7
 T(global opt: dvdson [nccl]               ) = 3.174e-04 S  per = 0.00925  per(accum) = 86.7
 T(global opt: dvdson [mpi]                ) = 6.385e-06 S  per = 0.000186  per(accum) = 86.7
 T(global opt: dvdson [rest part(linalg)]  ) = 4.547e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 8.738e-01 S  T(sum) = 8.738e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.788e-03 S  per = 0.205  per(accum) = 0.205
 T(global opt: qops init                    ) = 2.439e-02 S  per = 2.79  per(accum) = 3
 T(global opt: symbolic_formulae_renorm     ) = 1.676e-01 S  per = 19.2  per(accum) = 22.2
 T(global opt: allocate qops on gpu         ) = 6.786e-04 S  per = 0.0777  per(accum) = 22.3
 T(global opt: site memcpy cpu2gpu          ) = 1.503e-02 S  per = 1.72  per(accum) = 24
 T(global opt: rintermediate init           ) = 2.516e-02 S  per = 2.88  per(accum) = 26.8
 T(global opt: preprocess_formulae_Rlist2   ) = 5.526e-02 S  per = 6.32  per(accum) = 33.2
 T(global opt: rmmtasks init                ) = 1.127e-01 S  per = 12.9  per(accum) = 46.1
 T(global opt: qops memset on cpu           ) = 4.660e-07 S  per = 5.33e-05  per(accum) = 46.1
 T(global opt: preprocess_renorm_batchGPU   ) = 4.254e-01 S  per = 48.7  per(accum) = 94.8
 T(global opt: deallocate cpu and gpu memory) = 1.092e-03 S  per = 0.125  per(accum) = 94.9
 T(global opt: construct opS [ifdists=true] ) = 6.680e-07 S  per = 7.64e-05  per(accum) = 94.9
 T(global opt: reduction of opS & opH [nccl]) = 4.810e-07 S  per = 5.5e-05  per(accum) = 94.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.530e-03 S  per = 0.289  per(accum) = 95.2
 T(global opt: reduction of opS & opH [mpi] ) = 2.285e-04 S  per = 0.0262  per(accum) = 95.2
 T(global opt: qops_pool join and erase     ) = 1.715e-02 S  per = 1.96  per(accum) = 97.2
 T(global opt: conversion from opAB to opPQ ) = 2.483e-02 S  per = 2.84  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.442e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=11/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=24:1.831e-04MB:1.788e-07GB
total mem of comb=788:6.012e-03MB:5.871e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:6.58 S:4.38 P:0 Q:88.1 
 rqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5201:0.0397MB:3.88e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.008e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.225e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,6,4) nnz=24:1.831e-04MB
qtensor3: wf3 own=1 _data=0x3ad4a840
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (18,2):3 (17,3):2 (18,4):2
 qbond: qcol nsym=3 dimAll=6
 (11,-3):2 (10,-2):2 (10,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=24:1.831e-04MB
### DIAG TIMING: total=2.060e-01 t1=2.447e-05, t2=2.196e-03, t3=2.493e-03, t4=2.012e-01, t5=4.833e-06, t6=1.390e-05, t7=3.815e-06
duration_diagGPU:2.060e-01
duration_diagreduce:6.200e-08
duration_diagtransform:4.410e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.808e-02 S -----
rank=0 GPUmem(GB): used=3.875e-05 (oper)=3.875e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.234e-04 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper,hinter)=3.875e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.214e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.551e-03,2.663e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.536e-03 S size(H_formulae)=1053 size(Hxlst)=1986 -----
rank=0 GPUmem(GB): used=8.506e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.576e-07 batch[need]=2.811e-04 blksize=6 blksize0=6 batchsize=1986
rank=0 GPUmem(GB): used=3.666e-04 (oper,hinter,dvdson,batch)=3.875e-05,4.631e-05,3.576e-07,2.811e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=24 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.603e-03,9.991e-03,3.021e-02,1.256e-02,5.437e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.598e-03 speed=2.238e-04GB/S T(nccl)=4.560e-06 speed=7.843e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=50 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=50 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=50 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=50 i=4 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=50 i=5 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=50 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=50 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.1e-01 t_gemm=1.5e+00 t_reduction=6.2e-01 tot=2.6e+00 -----
 sigma_tot[inter] counter=50 t=5.1e-01 per=1.9e+01 cost=1.9e+06 flops=3.6e+06
 sigma_tot[gemm] counter=50 i=0 t=1.1e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=9.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=3.7e-01 per=1.4e+01 cost=9.1e+05 flops=2.4e+06
 sigma_tot[gemm] counter=50 i=3 t=3.8e-01 per=1.4e+01 cost=9.2e+05 flops=2.5e+06
 sigma_tot[gemm] counter=50 i=4 t=3.7e-01 per=1.4e+01 cost=9.2e+05 flops=2.5e+06
 sigma_tot[gemm] counter=50 i=5 t=3.7e-01 per=1.4e+01 cost=9.2e+05 flops=2.5e+06
 sigma_tot[gemm] counter=50 total t=1.5e+00 per=5.7e+01 cost=3.7e+06 flops=2.5e+06
 sigma_tot[red] counter=50 t=6.2e-01 per=2.4e+01 cost=9.5e+05 flops=1.5e+06
T(sub)=9.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,3.9e-06,1.8e-06,7.4e-07,1.7e-07
settings: ndim=24 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.271896441600 -1.116e+03  6.710e-02    1     1  5.448e-02 5.448e-02 5.446e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.611e-04,9.923e-03,3.009e-02,1.247e-02,5.326e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=7.563e-04 speed=4.728e-04GB/S T(nccl)=4.766e-06 speed=7.504e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=51 t=9.9e-03 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=51 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=51 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=51 i=4 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=51 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=51 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=51 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.2e-01 t_gemm=1.5e+00 t_reduction=6.4e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=51 t=5.2e-01 per=1.9e+01 cost=1.9e+06 flops=3.7e+06
 sigma_tot[gemm] counter=51 i=0 t=1.2e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=9.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=3.8e-01 per=1.4e+01 cost=9.3e+05 flops=2.4e+06
 sigma_tot[gemm] counter=51 i=3 t=3.8e-01 per=1.4e+01 cost=9.4e+05 flops=2.5e+06
 sigma_tot[gemm] counter=51 i=4 t=3.8e-01 per=1.4e+01 cost=9.4e+05 flops=2.4e+06
 sigma_tot[gemm] counter=51 i=5 t=3.8e-01 per=1.4e+01 cost=9.4e+05 flops=2.5e+06
 sigma_tot[gemm] counter=51 total t=1.5e+00 per=5.7e+01 cost=3.7e+06 flops=2.5e+06
 sigma_tot[red] counter=51 t=6.4e-01 per=2.4e+01 cost=9.7e+05 flops=1.5e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,3.2e-06,8.6e-07,2.0e-07
    2   0 -    -116.290602522307 -1.871e-02  1.627e-02    2     2  1.242e-01 6.208e-02 5.390e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.914e-04,9.926e-03,2.998e-02,1.268e-02,5.298e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=3.861e-04 speed=9.264e-04GB/S T(nccl)=5.372e-06 speed=6.657e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=52 t=9.9e-03 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=52 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=52 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=52 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=52 i=5 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=52 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=52 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.3e-01 t_gemm=1.6e+00 t_reduction=6.5e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=52 t=5.3e-01 per=1.9e+01 cost=2.0e+06 flops=3.7e+06
 sigma_tot[gemm] counter=52 i=0 t=1.2e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=9.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=3.9e-01 per=1.4e+01 cost=9.5e+05 flops=2.4e+06
 sigma_tot[gemm] counter=52 i=3 t=3.9e-01 per=1.4e+01 cost=9.6e+05 flops=2.5e+06
 sigma_tot[gemm] counter=52 i=4 t=3.9e-01 per=1.4e+01 cost=9.5e+05 flops=2.4e+06
 sigma_tot[gemm] counter=52 i=5 t=3.9e-01 per=1.4e+01 cost=9.5e+05 flops=2.4e+06
 sigma_tot[gemm] counter=52 total t=1.6e+00 per=5.7e+01 cost=3.8e+06 flops=2.4e+06
 sigma_tot[red] counter=52 t=6.5e-01 per=2.4e+01 cost=9.9e+05 flops=1.5e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.6e-05,2.9e-06,9.4e-07,2.2e-07
    3   0 -    -116.291783348487 -1.181e-03  5.636e-03    3     3  1.898e-01 6.325e-02 5.363e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.759e-03,1.015e-02,3.008e-02,1.251e-02,5.451e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.753e-03 speed=2.040e-04GB/S T(nccl)=5.907e-06 speed=6.054e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=53 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=53 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=53 i=3 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=53 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=53 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=53 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=53 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.4e-01 t_gemm=1.6e+00 t_reduction=6.6e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=53 t=5.4e-01 per=1.9e+01 cost=2.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=53 i=0 t=1.2e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=9.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=4.0e-01 per=1.4e+01 cost=9.7e+05 flops=2.4e+06
 sigma_tot[gemm] counter=53 i=3 t=4.0e-01 per=1.4e+01 cost=9.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=53 i=4 t=4.0e-01 per=1.4e+01 cost=9.7e+05 flops=2.4e+06
 sigma_tot[gemm] counter=53 i=5 t=4.0e-01 per=1.4e+01 cost=9.7e+05 flops=2.4e+06
 sigma_tot[gemm] counter=53 total t=1.6e+00 per=5.7e+01 cost=3.9e+06 flops=2.4e+06
 sigma_tot[red] counter=53 t=6.6e-01 per=2.4e+01 cost=1.0e+06 flops=1.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.0e-06,1.0e-06,2.3e-07
    4   0 -    -116.291876307608 -9.296e-05  2.067e-03    3     4  2.576e-01 6.440e-02 5.387e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.938e-04,1.008e-02,3.034e-02,1.246e-02,5.350e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=5.877e-04 speed=6.086e-04GB/S T(nccl)=6.152e-06 speed=5.813e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=54 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=54 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=54 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=54 i=4 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=54 i=5 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=54 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=54 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.5e-01 t_gemm=1.6e+00 t_reduction=6.8e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=54 t=5.5e-01 per=1.9e+01 cost=2.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=54 i=0 t=1.2e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=9.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=4.0e-01 per=1.4e+01 cost=9.8e+05 flops=2.4e+06
 sigma_tot[gemm] counter=54 i=3 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=54 i=4 t=4.1e-01 per=1.4e+01 cost=9.8e+05 flops=2.4e+06
 sigma_tot[gemm] counter=54 i=5 t=4.0e-01 per=1.4e+01 cost=9.8e+05 flops=2.4e+06
 sigma_tot[gemm] counter=54 total t=1.6e+00 per=5.7e+01 cost=3.9e+06 flops=2.4e+06
 sigma_tot[red] counter=54 t=6.8e-01 per=2.4e+01 cost=1.0e+06 flops=1.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.0e-06,1.0e-06,2.6e-07
    5   0 -    -116.291888031947 -1.172e-05  3.789e-04    3     5  3.235e-01 6.471e-02 5.382e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.059e-04,1.022e-02,9.326e-03,2.780e-03,2.304e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=6.996e-04 speed=5.112e-04GB/S T(nccl)=6.253e-06 speed=5.719e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=9.3e-03 t_reduction=2.8e-03 tot=2.2e-02 -----
 sigma[inter] counter=55 t=1.0e-02 per=4.6e+01 cost=6.0e+04 flops=5.9e+06
 sigma[gemm] counter=55 i=0 t=1.8e-06 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=1.5e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=4.5e-03 per=2.0e+01 cost=1.8e+04 flops=4.0e+06
 sigma[gemm] counter=55 i=3 t=1.2e-03 per=5.2e+00 cost=1.8e+04 flops=1.5e+07
 sigma[gemm] counter=55 i=4 t=2.5e-03 per=1.1e+01 cost=1.5e+04 flops=6.0e+06
 sigma[gemm] counter=55 i=5 t=1.1e-03 per=5.1e+00 cost=1.5e+04 flops=1.3e+07
 sigma[gemm] counter=55 total t=9.3e-03 per=4.2e+01 cost=6.6e+04 flops=7.1e+06
 sigma[red] counter=55 t=2.8e-03 per=1.2e+01 cost=1.9e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=5.6e-01 t_gemm=1.6e+00 t_reduction=6.8e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=55 t=5.6e-01 per=2.0e+01 cost=2.2e+06 flops=3.9e+06
 sigma_tot[gemm] counter=55 i=0 t=1.2e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=9.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=55 i=3 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=55 i=4 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=55 i=5 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=55 total t=1.6e+00 per=5.7e+01 cost=4.0e+06 flops=2.5e+06
 sigma_tot[red] counter=55 t=6.8e-01 per=2.4e+01 cost=1.0e+06 flops=1.5e+06
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,1.6e-05,3.2e-06,1.2e-06,2.4e-07
    6   0 +    -116.291888550589 -5.186e-07  8.648e-05    3     6  3.589e-01 5.981e-02 4.871e-02
TIMING FOR Davidson : 3.589e-01  T(cal/comm/rest)=2.922e-01,5.990e-07,6.665e-02
decomposed t_rest=6.665e-02
 T(sub)    =1.285e-04 per=1.929e-01
 T(precond)=6.636e-02 per=9.957e+01
 T(ortho)  =3.360e-05 per=5.040e-02
 T(xcopy)  =7.640e-07 per=1.146e-03
 T(xnrm2)  =2.699e-06 per=4.049e-03
 T(other)  =1.243e-04 per=1.865e-01
optimized energies: isweep=0 ibond=11 dots=1 e[0]=-116.291888550589 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.205e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=8 dimAll=28
 (18,2):5 (20,2):3 (19,3):7 (19,1):3 (17,3):2 (18,4):4 (20,4):2 (19,5):2
timing for divide=1.0e-05
timing for compute=9.4e-03
timing for collect=2.9e-05
----- TMING FOR decimation_genbasis(nkr): 9.5e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,9.4e-03,0.0e+00,4.7e-06,2.9e-05 -----
decimation summary: 28->6 dwt=+1.110e-16 SvN=3.112e-01
 qbond: qkept nsym=3 dimAll=6
 (20,2):2 (19,3):2 (20,4):2
----- TIMING for decimation_row(nkr): 9.777e-03 S T(decim/select/formRot)=9.516e-03,2.390e-04,2.148e-05 -----
----- TIMING FOR onedot_decimation: 9.842e-03 S T(wf/decim)=5.213e-05,9.789e-03 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:10 S:5.38 P:0 Q:83.5 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.238e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 2.148e-02 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper)=3.875e-05
rank=0 GPUmem(GB): used=8.524e-05 (oper,site)=3.875e-05,1.788e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.513e-03 S -----
rank=0 GPUmem(GB): used=1.316e-04 (oper,site,rinter)=3.875e-05,1.788e-07,4.631e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 5.030e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=3.217e-03,1.813e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.251e-03 S size(rtasks)=237 size(Rlst)=1033 -----
rank=0 GPUmem(GB): used=1.316e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.462e-04 blksize=6 blksize0=6 batchsize=1033
rank=0 GPUmem(GB): used=2.778e-04 (oper,site,rinter,batch)=3.875e-05,1.788e-07,4.631e-05,1.462e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.088e-03,2.228e-02,1.003e-02
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=12 t=6.1e-03 per=1.6e+01 cost=3.0e+04 flops=5.0e+06
 renorm[gemm] counter=12 i=0 t=1.6e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=3 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=4 t=7.4e-03 per=1.9e+01 cost=4.4e+03 flops=5.8e+05
 renorm[gemm] counter=12 i=5 t=7.5e-03 per=2.0e+01 cost=1.2e+04 flops=1.6e+06
 renorm[gemm] counter=12 i=6 t=7.3e-03 per=1.9e+01 cost=1.9e+04 flops=2.7e+06
 renorm[gemm] counter=12 total t=2.2e-02 per=5.8e+01 cost=3.6e+04 flops=1.6e+06
 renorm[red] counter=12 t=1.0e-02 per=2.6e+01 cost=8.3e+03 flops=8.2e+05
----- TIMING FOR renorm_tot : t_inter=7.2e-02 t_gemm=2.7e-01 t_reduction=1.2e-01 tot=4.6e-01 -----
 renorm_tot[inter] counter=12 t=7.2e-02 per=1.6e+01 cost=4.9e+05 flops=6.8e+06
 renorm_tot[gemm] counter=12 i=0 t=1.9e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=1.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=3 t=1.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=4 t=8.8e-02 per=1.9e+01 cost=2.1e+05 flops=2.4e+06
 renorm_tot[gemm] counter=12 i=5 t=9.1e-02 per=2.0e+01 cost=2.7e+05 flops=3.0e+06
 renorm_tot[gemm] counter=12 i=6 t=9.0e-02 per=2.0e+01 cost=1.4e+06 flops=1.6e+07
 renorm_tot[gemm] counter=12 total t=2.7e-01 per=5.8e+01 cost=1.9e+06 flops=7.0e+06
 renorm_tot[red] counter=12 t=1.2e-01 per=2.6e+01 cost=6.4e+05 flops=5.3e+06
qops.to_cpu: size(tot)=1040:7.9e-03MB:7.7e-06GB T(to_cpu)=2.5e-04S speed=3.2e-02GB/S
check ||H-H.dagger||=3.556e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.079 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.800e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.419e-03 change=-2.034e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.419e-03 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.024e-01 S #####
 T(local opt: fetch) = 1.163e-02 S  per = 1.66  per(accum) = 1.66
 T(local opt: hdiag) = 2.060e-01 S  per = 29.3  per(accum) = 31
 T(local opt: dvdsn) = 3.939e-01 S  per = 56.1  per(accum) = 87.1
 T(local opt: decim) = 9.851e-03 S  per =  1.4  per(accum) = 88.5
 T(local opt: guess) = 7.752e-05 S  per = 0.011  per(accum) = 88.5
 T(local opt: renrm) = 8.071e-02 S  per = 11.5  per(accum) = 100
 T(local opt: save ) = 2.846e-04 S  per = 0.0405  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.939e-01 S  T(sum) = 3.936e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 9.808e-05 S  per = 0.0249  per(accum) = 0.0249
 T(local opt: symbolic_formulae           ) = 1.809e-02 S  per =  4.6  per(accum) = 4.62
 T(local opt: hintermediate init          ) = 4.407e-04 S  per = 0.112  per(accum) = 4.73
 T(local opt: preprocess_hformulae_Hxlist ) = 5.596e-03 S  per = 1.42  per(accum) = 6.16
 T(local opt: hmmtasks init               ) = 1.051e-02 S  per = 2.67  per(accum) = 8.83
 T(local opt: initial guess for dvdson    ) = 2.696e-06 S  per = 0.000685  per(accum) = 8.83
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.864e-01 S  per = 72.8  per(accum) = 81.6
 T(local opt: dvdson [cpu-gpu]            ) = 5.781e-03 S  per = 1.47  per(accum) = 83.1
 T(local opt: dvdson [nccl]               ) = 3.301e-05 S  per = 0.00839  per(accum) = 83.1
 T(local opt: dvdson [mpi]                ) = 5.990e-07 S  per = 0.000152  per(accum) = 83.1
 T(local opt: dvdson [rest part(linalg)]  ) = 6.665e-02 S  per = 16.9  per(accum) = 100
Detailed decomposition of T(renrm) = 8.071e-02 S  T(sum) = 8.071e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.517e-05 S  per = 0.0931  per(accum) = 0.0931
 T(local opt: qops init                    ) = 1.941e-03 S  per =  2.4  per(accum) = 2.5
 T(local opt: symbolic_formulae_renorm     ) = 2.150e-02 S  per = 26.6  per(accum) = 29.1
 T(local opt: allocate qops on gpu         ) = 6.087e-05 S  per = 0.0754  per(accum) = 29.2
 T(local opt: site memcpy cpu2gpu          ) = 1.843e-03 S  per = 2.28  per(accum) = 31.5
 T(local opt: rintermediate init           ) = 2.531e-03 S  per = 3.14  per(accum) = 34.6
 T(local opt: preprocess_formulae_Rlist2   ) = 5.291e-03 S  per = 6.56  per(accum) = 41.2
 T(local opt: rmmtasks init                ) = 6.997e-03 S  per = 8.67  per(accum) = 49.9
 T(local opt: qops memset on cpu           ) = 5.100e-08 S  per = 6.32e-05  per(accum) = 49.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.850e-02 S  per = 47.7  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 5.346e-05 S  per = 0.0662  per(accum) = 97.6
 T(local opt: construct opS [ifdists=true] ) = 5.900e-08 S  per = 7.31e-05  per(accum) = 97.6
 T(local opt: reduction of opS & opH [nccl]) = 4.000e-08 S  per = 4.96e-05  per(accum) = 97.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.530e-04 S  per = 0.314  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.784e-05 S  per = 0.0221  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.649e-03 S  per = 2.04  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.684e-06 S  per = 0.00209  per(accum) = 100
##### sweep opt: 7.440e+00 S #####
 T(sweep opt: fetch) = 1.596e-01 S  per = 2.15  per(accum) = 2.15
 T(sweep opt: hdiag) = 2.366e+00 S  per = 31.8  per(accum) = 34
 T(sweep opt: dvdsn) = 3.828e+00 S  per = 51.4  per(accum) = 85.4
 T(sweep opt: decim) = 1.272e-01 S  per = 1.71  per(accum) = 87.1
 T(sweep opt: guess) = 1.326e-03 S  per = 0.0178  per(accum) = 87.1
 T(sweep opt: renrm) = 9.545e-01 S  per = 12.8  per(accum) = 100
 T(sweep opt: save ) = 3.124e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.828e+00 S  T(sum) = 3.824e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 1.261e-03 S  per = 0.033  per(accum) = 0.033
 T(sweep opt: symbolic_formulae           ) = 1.743e-01 S  per = 4.56  per(accum) = 4.59
 T(sweep opt: hintermediate init          ) = 4.570e-03 S  per = 0.12  per(accum) = 4.71
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.783e-02 S  per = 1.51  per(accum) = 6.22
 T(sweep opt: hmmtasks init               ) = 1.156e-01 S  per = 3.02  per(accum) = 9.25
 T(sweep opt: initial guess for dvdson    ) = 3.776e-05 S  per = 0.000987  per(accum) = 9.25
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.881e+00 S  per = 75.3  per(accum) = 84.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.754e-02 S  per = 1.77  per(accum) = 86.4
 T(sweep opt: dvdson [nccl]               ) = 3.504e-04 S  per = 0.00917  per(accum) = 86.4
 T(sweep opt: dvdson [mpi]                ) = 6.984e-06 S  per = 0.000183  per(accum) = 86.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.214e-01 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 9.545e-01 S  T(sum) = 9.545e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.863e-03 S  per = 0.195  per(accum) = 0.195
 T(sweep opt: qops init                    ) = 2.633e-02 S  per = 2.76  per(accum) = 2.95
 T(sweep opt: symbolic_formulae_renorm     ) = 1.891e-01 S  per = 19.8  per(accum) = 22.8
 T(sweep opt: allocate qops on gpu         ) = 7.395e-04 S  per = 0.0775  per(accum) = 22.8
 T(sweep opt: site memcpy cpu2gpu          ) = 1.687e-02 S  per = 1.77  per(accum) = 24.6
 T(sweep opt: rintermediate init           ) = 2.769e-02 S  per =  2.9  per(accum) = 27.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.055e-02 S  per = 6.34  per(accum) = 33.9
 T(sweep opt: rmmtasks init                ) = 1.197e-01 S  per = 12.5  per(accum) = 46.4
 T(sweep opt: qops memset on cpu           ) = 5.170e-07 S  per = 5.42e-05  per(accum) = 46.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.639e-01 S  per = 48.6  per(accum) = 95
 T(sweep opt: deallocate cpu and gpu memory) = 1.146e-03 S  per = 0.12  per(accum) = 95.1
 T(sweep opt: construct opS [ifdists=true] ) = 7.270e-07 S  per = 7.62e-05  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [nccl]) = 5.210e-07 S  per = 5.46e-05  per(accum) = 95.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.783e-03 S  per = 0.292  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.463e-04 S  per = 0.0258  per(accum) = 95.4
 T(sweep opt: qops_pool join and erase     ) = 1.880e-02 S  per = 1.97  per(accum) = 97.4
 T(sweep opt: conversion from opAB to opPQ ) = 2.484e-02 S  per =  2.6  per(accum) = 100
##### global opt: 7.440e+00 S #####
 T(global opt: fetch) = 1.596e-01 S  per = 2.15  per(accum) = 2.15
 T(global opt: hdiag) = 2.366e+00 S  per = 31.8  per(accum) = 34
 T(global opt: dvdsn) = 3.828e+00 S  per = 51.4  per(accum) = 85.4
 T(global opt: decim) = 1.272e-01 S  per = 1.71  per(accum) = 87.1
 T(global opt: guess) = 1.326e-03 S  per = 0.0178  per(accum) = 87.1
 T(global opt: renrm) = 9.545e-01 S  per = 12.8  per(accum) = 100
 T(global opt: save ) = 3.124e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.828e+00 S  T(sum) = 3.824e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 1.261e-03 S  per = 0.033  per(accum) = 0.033
 T(global opt: symbolic_formulae           ) = 1.743e-01 S  per = 4.56  per(accum) = 4.59
 T(global opt: hintermediate init          ) = 4.570e-03 S  per = 0.12  per(accum) = 4.71
 T(global opt: preprocess_hformulae_Hxlist ) = 5.783e-02 S  per = 1.51  per(accum) = 6.22
 T(global opt: hmmtasks init               ) = 1.156e-01 S  per = 3.02  per(accum) = 9.25
 T(global opt: initial guess for dvdson    ) = 3.776e-05 S  per = 0.000987  per(accum) = 9.25
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.881e+00 S  per = 75.3  per(accum) = 84.6
 T(global opt: dvdson [cpu-gpu]            ) = 6.754e-02 S  per = 1.77  per(accum) = 86.4
 T(global opt: dvdson [nccl]               ) = 3.504e-04 S  per = 0.00917  per(accum) = 86.4
 T(global opt: dvdson [mpi]                ) = 6.984e-06 S  per = 0.000183  per(accum) = 86.4
 T(global opt: dvdson [rest part(linalg)]  ) = 5.214e-01 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 9.545e-01 S  T(sum) = 9.545e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.863e-03 S  per = 0.195  per(accum) = 0.195
 T(global opt: qops init                    ) = 2.633e-02 S  per = 2.76  per(accum) = 2.95
 T(global opt: symbolic_formulae_renorm     ) = 1.891e-01 S  per = 19.8  per(accum) = 22.8
 T(global opt: allocate qops on gpu         ) = 7.395e-04 S  per = 0.0775  per(accum) = 22.8
 T(global opt: site memcpy cpu2gpu          ) = 1.687e-02 S  per = 1.77  per(accum) = 24.6
 T(global opt: rintermediate init           ) = 2.769e-02 S  per =  2.9  per(accum) = 27.5
 T(global opt: preprocess_formulae_Rlist2   ) = 6.055e-02 S  per = 6.34  per(accum) = 33.9
 T(global opt: rmmtasks init                ) = 1.197e-01 S  per = 12.5  per(accum) = 46.4
 T(global opt: qops memset on cpu           ) = 5.170e-07 S  per = 5.42e-05  per(accum) = 46.4
 T(global opt: preprocess_renorm_batchGPU   ) = 4.639e-01 S  per = 48.6  per(accum) = 95
 T(global opt: deallocate cpu and gpu memory) = 1.146e-03 S  per = 0.12  per(accum) = 95.1
 T(global opt: construct opS [ifdists=true] ) = 7.270e-07 S  per = 7.62e-05  per(accum) = 95.1
 T(global opt: reduction of opS & opH [nccl]) = 5.210e-07 S  per = 5.46e-05  per(accum) = 95.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.783e-03 S  per = 0.292  per(accum) = 95.4
 T(global opt: reduction of opS & opH [mpi] ) = 2.463e-04 S  per = 0.0258  per(accum) = 95.4
 T(global opt: qops_pool join and erase     ) = 1.880e-02 S  per = 1.97  per(accum) = 97.4
 T(global opt: conversion from opAB to opPQ ) = 2.484e-02 S  per =  2.6  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.199e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=12/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=780:5.951e-03MB:5.811e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:10 S:5.38 P:0 Q:83.5 
 rqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3750:0.0286MB:2.79e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.760e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,4,4) nnz=16:1.221e-04MB
qtensor3: wf3 own=1 _data=0x3aa88580
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (20,2):2 (19,3):2 (20,4):2
 qbond: qcol nsym=3 dimAll=4
 (9,-3):2 (8,-2):1 (8,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=16:1.221e-04MB
### DIAG TIMING: total=2.216e-01 t1=2.390e-05, t2=2.165e-03, t3=2.460e-03, t4=2.169e-01, t5=5.134e-06, t6=1.293e-05, t7=3.463e-06
duration_diagGPU:2.216e-01
duration_diagreduce:4.300e-08
duration_diagtransform:4.040e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.427e-02 S -----
rank=0 GPUmem(GB): used=2.794e-05 (oper)=2.794e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.328e-04 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper,hinter)=2.794e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.007e-03 S size(H_formulae)=813 size(Hxlst2)=5 T(Hmu/Hxlist)=1.995e-03,2.011e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.250e-03 S size(H_formulae)=813 size(Hxlst)=1552 -----
rank=0 GPUmem(GB): used=6.571e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.384e-07 batch[need]=1.503e-04 blksize=4 blksize0=4 batchsize=1552
rank=0 GPUmem(GB): used=2.163e-04 (oper,hinter,dvdson,batch)=2.794e-05,3.777e-05,2.384e-07,1.503e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=16 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.124e-03,9.966e-03,3.030e-02,1.265e-02,5.405e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.119e-03 speed=2.130e-04GB/S T(nccl)=4.928e-06 speed=4.838e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=56 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=56 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=56 i=3 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=56 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=56 i=5 t=7.7e-03 per=1.4e+01 cost=7.1e+03 flops=9.2e+05
 sigma[gemm] counter=56 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=56 t=1.3e-02 per=2.4e+01 cost=1.0e+04 flops=8.1e+05
----- TIMING FOR sigma_tot : t_inter=5.7e-01 t_gemm=1.7e+00 t_reduction=6.9e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=56 t=5.7e-01 per=2.0e+01 cost=2.2e+06 flops=3.9e+06
 sigma_tot[gemm] counter=56 i=0 t=1.2e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=1.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=56 i=3 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=56 i=4 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=56 i=5 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=56 total t=1.7e+00 per=5.7e+01 cost=4.0e+06 flops=2.4e+06
 sigma_tot[red] counter=56 t=6.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.3e-06,2.0e-06,6.8e-07,1.9e-07
settings: ndim=16 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.291888550589 -1.116e+03  5.401e-02    1     1  5.417e-02 5.417e-02 5.414e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.708e-03,1.016e-02,2.986e-02,1.271e-02,5.447e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.702e-03 speed=1.401e-04GB/S T(nccl)=6.514e-06 speed=3.660e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=57 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=3.9e+06
 sigma[gemm] counter=57 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=1.4e-05 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=57 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=57 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=57 i=5 t=7.5e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=57 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.1e+06
 sigma[red] counter=57 t=1.3e-02 per=2.4e+01 cost=1.0e+04 flops=8.1e+05
----- TIMING FOR sigma_tot : t_inter=5.8e-01 t_gemm=1.7e+00 t_reduction=7.0e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=57 t=5.8e-01 per=2.0e+01 cost=2.3e+06 flops=3.9e+06
 sigma_tot[gemm] counter=57 i=0 t=1.3e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=57 i=3 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=57 i=4 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=57 i=5 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=57 total t=1.7e+00 per=5.7e+01 cost=4.1e+06 flops=2.4e+06
 sigma_tot[red] counter=57 t=7.0e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.2e-05,3.5e-06,8.4e-07,2.1e-07
    2   0 -    -116.300315340199 -8.427e-03  1.529e-02    2     2  1.220e-01 6.102e-02 5.435e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.459e-03,1.008e-02,3.025e-02,1.245e-02,5.424e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.455e-03 speed=1.639e-04GB/S T(nccl)=4.722e-06 speed=5.049e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=58 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=58 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=58 i=3 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=58 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=9.9e+05
 sigma[gemm] counter=58 i=5 t=7.5e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=58 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=58 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=5.9e-01 t_gemm=1.7e+00 t_reduction=7.2e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=58 t=5.9e-01 per=2.0e+01 cost=2.3e+06 flops=3.9e+06
 sigma_tot[gemm] counter=58 i=0 t=1.3e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=58 i=3 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=58 i=4 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=58 i=5 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=58 total t=1.7e+00 per=5.7e+01 cost=4.1e+06 flops=2.4e+06
 sigma_tot[red] counter=58 t=7.2e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,2.9e-06,9.6e-07,1.9e-07
    3   0 -    -116.301344274588 -1.029e-03  3.268e-03    3     3  1.878e-01 6.261e-02 5.434e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.331e-04,5.484e-03,1.531e-02,1.260e-02,3.373e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=3.280e-04 speed=7.269e-04GB/S T(nccl)=5.100e-06 speed=4.675e-02GB/S
----- TIMING FOR sigma : t_inter=5.5e-03 t_gemm=1.5e-02 t_reduction=1.3e-02 tot=3.3e-02 -----
 sigma[inter] counter=59 t=5.5e-03 per=1.6e+01 cost=4.0e+04 flops=7.3e+06
 sigma[gemm] counter=59 i=0 t=1.7e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=1.5e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=1.4e-03 per=4.2e+00 cost=8.4e+03 flops=5.9e+06
 sigma[gemm] counter=59 i=3 t=5.2e-03 per=1.5e+01 cost=8.4e+03 flops=1.6e+06
 sigma[gemm] counter=59 i=4 t=1.3e-03 per=3.8e+00 cost=7.6e+03 flops=6.0e+06
 sigma[gemm] counter=59 i=5 t=7.5e-03 per=2.2e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=59 total t=1.5e-02 per=4.6e+01 cost=3.1e+04 flops=2.1e+06
 sigma[red] counter=59 t=1.3e-02 per=3.8e+01 cost=1.0e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=6.0e-01 t_gemm=1.7e+00 t_reduction=7.3e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=59 t=6.0e-01 per=2.0e+01 cost=2.3e+06 flops=3.9e+06
 sigma_tot[gemm] counter=59 i=0 t=1.3e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 i=3 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 i=4 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 i=5 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 total t=1.7e+00 per=5.7e+01 cost=4.1e+06 flops=2.4e+06
 sigma_tot[red] counter=59 t=7.3e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.4e-05,3.1e-06,9.1e-07,2.0e-07
    4   0 -    -116.301381896987 -3.762e-05  9.727e-04    3     4  2.343e-01 5.857e-02 4.922e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.883e-03,9.991e-03,2.970e-02,1.243e-02,5.402e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.879e-03 speed=1.269e-04GB/S T(nccl)=4.681e-06 speed=5.093e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=60 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=60 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=60 i=3 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=60 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=60 i=5 t=7.4e-03 per=1.4e+01 cost=7.1e+03 flops=9.6e+05
 sigma[gemm] counter=60 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.1e+06
 sigma[red] counter=60 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=6.1e-01 t_gemm=1.8e+00 t_reduction=7.4e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=60 t=6.1e-01 per=2.0e+01 cost=2.4e+06 flops=3.9e+06
 sigma_tot[gemm] counter=60 i=0 t=1.3e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=60 i=3 t=4.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=60 i=4 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=60 i=5 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=60 total t=1.8e+00 per=5.7e+01 cost=4.2e+06 flops=2.4e+06
 sigma_tot[red] counter=60 t=7.4e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,2.9e-06,8.4e-07,1.4e-07
    5   0 -    -116.301384728312 -2.831e-06  2.010e-04    3     5  3.036e-01 6.071e-02 5.019e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.633e-03,9.806e-03,3.001e-02,1.261e-02,5.407e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.628e-03 speed=1.465e-04GB/S T(nccl)=4.740e-06 speed=5.030e-02GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=61 t=9.8e-03 per=1.9e+01 cost=4.0e+04 flops=4.1e+06
 sigma[gemm] counter=61 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=61 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=61 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=61 i=5 t=7.5e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=61 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=61 t=1.3e-02 per=2.4e+01 cost=1.0e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=6.2e-01 t_gemm=1.8e+00 t_reduction=7.5e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=61 t=6.2e-01 per=2.0e+01 cost=2.4e+06 flops=3.9e+06
 sigma_tot[gemm] counter=61 i=0 t=1.3e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=4.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=61 i=3 t=4.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=61 i=4 t=4.5e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=61 i=5 t=4.5e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=61 total t=1.8e+00 per=5.7e+01 cost=4.2e+06 flops=2.3e+06
 sigma_tot[red] counter=61 t=7.5e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.0e-06,8.9e-07,1.6e-07
    6   0 +    -116.301384902089 -1.738e-07  5.402e-05    3     6  3.731e-01 6.219e-02 5.085e-02
TIMING FOR Davidson : 3.732e-01  T(cal/comm/rest)=3.051e-01,6.160e-07,6.803e-02
decomposed t_rest=6.803e-02
 T(sub)    =1.208e-04 per=1.776e-01
 T(precond)=6.774e-02 per=9.958e+01
 T(ortho)  =2.439e-05 per=3.585e-02
 T(xcopy)  =7.100e-07 per=1.044e-03
 T(xnrm2)  =2.662e-06 per=3.913e-03
 T(other)  =1.355e-04 per=1.992e-01
optimized energies: isweep=0 ibond=12 dots=1 e[0]=-116.301384902089 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.432e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=8 dimAll=24
 (20,2):4 (22,2):2 (21,3):6 (21,1):2 (19,3):2 (20,4):4 (22,4):2 (21,5):2
timing for divide=9.2e-06
timing for compute=1.1e-02
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.2e-06,1.1e-02,0.0e+00,4.3e-06,1.6e-05 -----
decimation summary: 24->4 dwt=+0.000e+00 SvN=1.637e-01
 qbond: qkept nsym=3 dimAll=4
 (21,3):2 (22,2):1 (22,4):1
----- TIMING for decimation_row(nkr): 1.128e-02 S T(decim/select/formRot)=1.108e-02,1.827e-04,1.975e-05 -----
----- TIMING FOR onedot_decimation: 1.135e-02 S T(wf/decim)=5.469e-05,1.130e-02 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:15 S:6.42 P:0 Q:77 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.751e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.585e-02 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper)=2.794e-05
rank=0 GPUmem(GB): used=6.583e-05 (oper,site)=2.794e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.458e-03 S -----
rank=0 GPUmem(GB): used=1.036e-04 (oper,site,rinter)=2.794e-05,1.192e-07,3.777e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.404e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=2.166e-03,1.238e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.562e-03 S size(rtasks)=185 size(Rlst)=818 -----
rank=0 GPUmem(GB): used=1.036e-04 avail=6.176e+00 total=6.176e+00 batch[need]=7.923e-05 blksize=4 blksize0=4 batchsize=818
rank=0 GPUmem(GB): used=1.828e-04 (oper,site,rinter,batch)=2.794e-05,1.192e-07,3.777e-05,7.923e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.619e-03,2.235e-02,1.001e-02
----- TIMING FOR renorm : t_inter=5.6e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=13 t=5.6e-03 per=1.5e+01 cost=2.0e+04 flops=3.6e+06
 renorm[gemm] counter=13 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=3 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=4 t=7.4e-03 per=2.0e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=13 i=5 t=7.4e-03 per=2.0e+01 cost=5.5e+03 flops=7.3e+05
 renorm[gemm] counter=13 i=6 t=7.5e-03 per=2.0e+01 cost=9.6e+03 flops=1.3e+06
 renorm[gemm] counter=13 total t=2.2e-02 per=5.9e+01 cost=1.7e+04 flops=7.8e+05
 renorm[red] counter=13 t=1.0e-02 per=2.6e+01 cost=4.8e+03 flops=4.8e+05
----- TIMING FOR renorm_tot : t_inter=7.8e-02 t_gemm=2.9e-01 t_reduction=1.3e-01 tot=5.0e-01 -----
 renorm_tot[inter] counter=13 t=7.8e-02 per=1.6e+01 cost=5.1e+05 flops=6.6e+06
 renorm_tot[gemm] counter=13 i=0 t=2.1e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=1.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=3 t=1.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=4 t=9.6e-02 per=1.9e+01 cost=2.1e+05 flops=2.2e+06
 renorm_tot[gemm] counter=13 i=5 t=9.8e-02 per=2.0e+01 cost=2.8e+05 flops=2.8e+06
 renorm_tot[gemm] counter=13 i=6 t=9.8e-02 per=2.0e+01 cost=1.4e+06 flops=1.4e+07
 renorm_tot[gemm] counter=13 total t=2.9e-01 per=5.8e+01 cost=1.9e+06 flops=6.5e+06
 renorm_tot[red] counter=13 t=1.3e-01 per=2.6e+01 cost=6.5e+05 flops=5.0e+06
qops.to_cpu: size(tot)=374:2.9e-03MB:2.8e-06GB T(to_cpu)=1.7e-04S speed=1.6e-02GB/S
check ||H-H.dagger||=5.024e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0671 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.244e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.204e-04 change=-1.821e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.204e-04 change=-5.662e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.136e-01 S #####
 T(local opt: fetch) = 1.165e-02 S  per = 1.63  per(accum) = 1.63
 T(local opt: hdiag) = 2.216e-01 S  per = 31.1  per(accum) = 32.7
 T(local opt: dvdsn) = 4.003e-01 S  per = 56.1  per(accum) = 88.8
 T(local opt: decim) = 1.136e-02 S  per = 1.59  per(accum) = 90.4
 T(local opt: guess) = 6.758e-05 S  per = 0.00947  per(accum) = 90.4
 T(local opt: renrm) = 6.846e-02 S  per = 9.59  per(accum) = 100
 T(local opt: save ) = 2.212e-04 S  per = 0.031  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.003e-01 S  T(sum) = 4.001e-01 S  per = 9.995e+01
 T(local opt: preprocess                  ) = 9.442e-05 S  per = 0.0236  per(accum) = 0.0236
 T(local opt: symbolic_formulae           ) = 1.428e-02 S  per = 3.57  per(accum) = 3.59
 T(local opt: hintermediate init          ) = 3.487e-04 S  per = 0.0872  per(accum) = 3.68
 T(local opt: preprocess_hformulae_Hxlist ) = 4.295e-03 S  per = 1.07  per(accum) = 4.75
 T(local opt: hmmtasks init               ) = 7.889e-03 S  per = 1.97  per(accum) = 6.73
 T(local opt: initial guess for dvdson    ) = 2.766e-06 S  per = 0.000691  per(accum) = 6.73
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.970e-01 S  per = 74.2  per(accum) = 81
 T(local opt: dvdson [cpu-gpu]            ) = 8.110e-03 S  per = 2.03  per(accum) = 83
 T(local opt: dvdson [nccl]               ) = 3.069e-05 S  per = 0.00767  per(accum) = 83
 T(local opt: dvdson [mpi]                ) = 6.160e-07 S  per = 0.000154  per(accum) = 83
 T(local opt: dvdson [rest part(linalg)]  ) = 6.803e-02 S  per =   17  per(accum) = 100
Detailed decomposition of T(renrm) = 6.846e-02 S  T(sum) = 6.846e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.016e-05 S  per = 0.117  per(accum) = 0.117
 T(local opt: qops init                    ) = 1.424e-03 S  per = 2.08  per(accum) = 2.2
 T(local opt: symbolic_formulae_renorm     ) = 1.586e-02 S  per = 23.2  per(accum) = 25.4
 T(local opt: allocate qops on gpu         ) = 4.823e-05 S  per = 0.0705  per(accum) = 25.4
 T(local opt: site memcpy cpu2gpu          ) = 5.741e-04 S  per = 0.839  per(accum) = 26.3
 T(local opt: rintermediate init           ) = 2.470e-03 S  per = 3.61  per(accum) = 29.9
 T(local opt: preprocess_formulae_Rlist2   ) = 3.591e-03 S  per = 5.25  per(accum) = 35.1
 T(local opt: rmmtasks init                ) = 4.861e-03 S  per =  7.1  per(accum) = 42.2
 T(local opt: qops memset on cpu           ) = 5.000e-08 S  per = 7.3e-05  per(accum) = 42.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.806e-02 S  per = 55.6  per(accum) = 97.8
 T(local opt: deallocate cpu and gpu memory) = 5.522e-05 S  per = 0.0807  per(accum) = 97.9
 T(local opt: construct opS [ifdists=true] ) = 5.500e-08 S  per = 8.03e-05  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 5.26e-05  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.771e-04 S  per = 0.259  per(accum) = 98.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.532e-05 S  per = 0.0224  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 1.236e-03 S  per = 1.81  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.494e-06 S  per = 0.00218  per(accum) = 100
##### sweep opt: 8.154e+00 S #####
 T(sweep opt: fetch) = 1.713e-01 S  per =  2.1  per(accum) = 2.1
 T(sweep opt: hdiag) = 2.588e+00 S  per = 31.7  per(accum) = 33.8
 T(sweep opt: dvdsn) = 4.228e+00 S  per = 51.9  per(accum) = 85.7
 T(sweep opt: decim) = 1.385e-01 S  per =  1.7  per(accum) = 87.4
 T(sweep opt: guess) = 1.393e-03 S  per = 0.0171  per(accum) = 87.4
 T(sweep opt: renrm) = 1.023e+00 S  per = 12.5  per(accum) = 100
 T(sweep opt: save ) = 3.345e-03 S  per = 0.041  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.228e+00 S  T(sum) = 4.224e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.355e-03 S  per = 0.0321  per(accum) = 0.0321
 T(sweep opt: symbolic_formulae           ) = 1.886e-01 S  per = 4.47  per(accum) = 4.5
 T(sweep opt: hintermediate init          ) = 4.919e-03 S  per = 0.116  per(accum) = 4.61
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.212e-02 S  per = 1.47  per(accum) = 6.09
 T(sweep opt: hmmtasks init               ) = 1.235e-01 S  per = 2.92  per(accum) = 9.01
 T(sweep opt: initial guess for dvdson    ) = 4.052e-05 S  per = 0.000959  per(accum) = 9.01
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.178e+00 S  per = 75.2  per(accum) = 84.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 7.565e-02 S  per = 1.79  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 3.811e-04 S  per = 0.00902  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 7.600e-06 S  per = 0.00018  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.894e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.023e+00 S  T(sum) = 1.023e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.943e-03 S  per = 0.19  per(accum) = 0.19
 T(sweep opt: qops init                    ) = 2.776e-02 S  per = 2.71  per(accum) = 2.9
 T(sweep opt: symbolic_formulae_renorm     ) = 2.049e-01 S  per =   20  per(accum) = 22.9
 T(sweep opt: allocate qops on gpu         ) = 7.877e-04 S  per = 0.077  per(accum) = 23
 T(sweep opt: site memcpy cpu2gpu          ) = 1.744e-02 S  per = 1.71  per(accum) = 24.7
 T(sweep opt: rintermediate init           ) = 3.016e-02 S  per = 2.95  per(accum) = 27.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.415e-02 S  per = 6.27  per(accum) = 33.9
 T(sweep opt: rmmtasks init                ) = 1.245e-01 S  per = 12.2  per(accum) = 46.1
 T(sweep opt: qops memset on cpu           ) = 5.670e-07 S  per = 5.54e-05  per(accum) = 46.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.020e-01 S  per = 49.1  per(accum) = 95.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.201e-03 S  per = 0.117  per(accum) = 95.3
 T(sweep opt: construct opS [ifdists=true] ) = 7.820e-07 S  per = 7.64e-05  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [nccl]) = 5.570e-07 S  per = 5.44e-05  per(accum) = 95.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.960e-03 S  per = 0.289  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.617e-04 S  per = 0.0256  per(accum) = 95.6
 T(sweep opt: qops_pool join and erase     ) = 2.003e-02 S  per = 1.96  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.43  per(accum) = 100
##### global opt: 8.154e+00 S #####
 T(global opt: fetch) = 1.713e-01 S  per =  2.1  per(accum) = 2.1
 T(global opt: hdiag) = 2.588e+00 S  per = 31.7  per(accum) = 33.8
 T(global opt: dvdsn) = 4.228e+00 S  per = 51.9  per(accum) = 85.7
 T(global opt: decim) = 1.385e-01 S  per =  1.7  per(accum) = 87.4
 T(global opt: guess) = 1.393e-03 S  per = 0.0171  per(accum) = 87.4
 T(global opt: renrm) = 1.023e+00 S  per = 12.5  per(accum) = 100
 T(global opt: save ) = 3.345e-03 S  per = 0.041  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.228e+00 S  T(sum) = 4.224e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.355e-03 S  per = 0.0321  per(accum) = 0.0321
 T(global opt: symbolic_formulae           ) = 1.886e-01 S  per = 4.47  per(accum) = 4.5
 T(global opt: hintermediate init          ) = 4.919e-03 S  per = 0.116  per(accum) = 4.61
 T(global opt: preprocess_hformulae_Hxlist ) = 6.212e-02 S  per = 1.47  per(accum) = 6.09
 T(global opt: hmmtasks init               ) = 1.235e-01 S  per = 2.92  per(accum) = 9.01
 T(global opt: initial guess for dvdson    ) = 4.052e-05 S  per = 0.000959  per(accum) = 9.01
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.178e+00 S  per = 75.2  per(accum) = 84.2
 T(global opt: dvdson [cpu-gpu]            ) = 7.565e-02 S  per = 1.79  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 3.811e-04 S  per = 0.00902  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 7.600e-06 S  per = 0.00018  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 5.894e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.023e+00 S  T(sum) = 1.023e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.943e-03 S  per = 0.19  per(accum) = 0.19
 T(global opt: qops init                    ) = 2.776e-02 S  per = 2.71  per(accum) = 2.9
 T(global opt: symbolic_formulae_renorm     ) = 2.049e-01 S  per =   20  per(accum) = 22.9
 T(global opt: allocate qops on gpu         ) = 7.877e-04 S  per = 0.077  per(accum) = 23
 T(global opt: site memcpy cpu2gpu          ) = 1.744e-02 S  per = 1.71  per(accum) = 24.7
 T(global opt: rintermediate init           ) = 3.016e-02 S  per = 2.95  per(accum) = 27.7
 T(global opt: preprocess_formulae_Rlist2   ) = 6.415e-02 S  per = 6.27  per(accum) = 33.9
 T(global opt: rmmtasks init                ) = 1.245e-01 S  per = 12.2  per(accum) = 46.1
 T(global opt: qops memset on cpu           ) = 5.670e-07 S  per = 5.54e-05  per(accum) = 46.1
 T(global opt: preprocess_renorm_batchGPU   ) = 5.020e-01 S  per = 49.1  per(accum) = 95.2
 T(global opt: deallocate cpu and gpu memory) = 1.201e-03 S  per = 0.117  per(accum) = 95.3
 T(global opt: construct opS [ifdists=true] ) = 7.820e-07 S  per = 7.64e-05  per(accum) = 95.3
 T(global opt: reduction of opS & opH [nccl]) = 5.570e-07 S  per = 5.44e-05  per(accum) = 95.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.960e-03 S  per = 0.289  per(accum) = 95.6
 T(global opt: reduction of opS & opH [mpi] ) = 2.617e-04 S  per = 0.0256  per(accum) = 95.6
 T(global opt: qops_pool join and erase     ) = 2.003e-02 S  per = 1.96  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.43  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.390e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=13/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=8:6.104e-05MB:5.960e-08GB
total mem of comb=772:5.890e-03MB:5.752e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:15 S:6.42 P:0 Q:77 
 rqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2834:0.0216MB:2.11e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.258e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,2,4) nnz=8:6.104e-05MB
qtensor3: wf3 own=1 _data=0x3acbdc80
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=4
 (21,3):2 (22,2):1 (22,4):1
 qbond: qcol nsym=1 dimAll=2
 (7,-3):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=12 size=8:6.104e-05MB
### DIAG TIMING: total=1.623e-01 t1=3.197e-05, t2=2.204e-03, t3=2.485e-03, t4=1.575e-01, t5=2.355e-05, t6=1.547e-05, t7=6.298e-06
duration_diagGPU:1.623e-01
duration_diagreduce:8.200e-08
duration_diagtransform:9.780e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.131e-02 S -----
rank=0 GPUmem(GB): used=2.111e-05 (oper)=2.111e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.570e-04 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper,hinter)=2.111e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.447e-03 S size(H_formulae)=607 size(Hxlst2)=3 T(Hmu/Hxlist)=1.457e-03,9.903e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.562e-03 S size(H_formulae)=607 size(Hxlst)=688 -----
rank=0 GPUmem(GB): used=5.032e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.192e-07 batch[need]=5.639e-05 blksize=4 blksize0=2 batchsize=688
rank=0 GPUmem(GB): used=1.068e-04 (oper,hinter,dvdson,batch)=2.111e-05,2.921e-05,1.192e-07,5.639e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=8 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.861e-03,9.927e-03,3.011e-02,1.264e-02,5.455e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.856e-03 speed=6.423e-05GB/S T(nccl)=4.912e-06 speed=2.427e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=62 t=9.9e-03 per=1.9e+01 cost=1.3e+04 flops=1.4e+06
 sigma[gemm] counter=62 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=62 i=3 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=62 i=4 t=7.6e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=62 i=5 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=62 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=62 t=1.3e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.3e-01 t_gemm=1.8e+00 t_reduction=7.7e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=62 t=6.3e-01 per=2.0e+01 cost=2.4e+06 flops=3.9e+06
 sigma_tot[gemm] counter=62 i=0 t=1.3e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=4.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=62 i=3 t=4.6e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=62 i=4 t=4.5e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=62 i=5 t=4.6e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=62 total t=1.8e+00 per=5.7e+01 cost=4.2e+06 flops=2.3e+06
 sigma_tot[red] counter=62 t=7.7e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.3e-06,1.9e-06,6.7e-07,1.6e-07
settings: ndim=8 neig=1 maxcycle=30 nbuff=4 memory=9e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.301384902089 -1.116e+03  5.386e-02    1     1  5.466e-02 5.466e-02 5.464e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.542e-04,1.021e-02,3.001e-02,1.221e-02,5.329e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=8.496e-04 speed=1.403e-04GB/S T(nccl)=4.624e-06 speed=2.578e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=63 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=63 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=63 i=3 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=63 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=63 i=5 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=63 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=63 t=1.2e-02 per=2.3e+01 cost=3.9e+03 flops=3.2e+05
----- TIMING FOR sigma_tot : t_inter=6.4e-01 t_gemm=1.9e+00 t_reduction=7.8e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=63 t=6.4e-01 per=2.0e+01 cost=2.4e+06 flops=3.8e+06
 sigma_tot[gemm] counter=63 i=0 t=1.4e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=4.6e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=63 i=3 t=4.6e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=63 i=4 t=4.6e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=63 i=5 t=4.7e-01 per=1.4e+01 cost=1.0e+06 flops=2.2e+06
 sigma_tot[gemm] counter=63 total t=1.9e+00 per=5.7e+01 cost=4.2e+06 flops=2.3e+06
 sigma_tot[red] counter=63 t=7.8e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.5e-06,8.9e-07,2.1e-07
    2   0 -    -116.309193956505 -7.809e-03  1.241e-02    2     2  1.243e-01 6.217e-02 5.401e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.043e-03,9.994e-03,2.987e-02,1.239e-02,5.430e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=2.039e-03 speed=5.847e-05GB/S T(nccl)=4.422e-06 speed=2.696e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=64 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=64 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=64 i=3 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=64 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=64 i=5 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=64 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=64 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.5e-01 t_gemm=1.9e+00 t_reduction=7.9e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=64 t=6.5e-01 per=2.0e+01 cost=2.5e+06 flops=3.8e+06
 sigma_tot[gemm] counter=64 i=0 t=1.4e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=4.7e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=64 i=3 t=4.7e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=64 i=4 t=4.7e-01 per=1.4e+01 cost=1.0e+06 flops=2.2e+06
 sigma_tot[gemm] counter=64 i=5 t=4.7e-01 per=1.4e+01 cost=1.0e+06 flops=2.2e+06
 sigma_tot[gemm] counter=64 total t=1.9e+00 per=5.7e+01 cost=4.2e+06 flops=2.2e+06
 sigma_tot[red] counter=64 t=7.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,2.6e-06,8.9e-07,1.9e-07
    3   0 -    -116.309890005097 -6.960e-04  4.101e-03    3     3  1.940e-01 6.465e-02 5.413e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.365e-03,9.988e-03,2.969e-02,1.248e-02,5.356e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.349e-03 speed=8.839e-05GB/S T(nccl)=1.612e-05 speed=7.393e-03GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=65 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=65 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=65 i=3 t=7.4e-03 per=1.4e+01 cost=3.4e+03 flops=4.6e+05
 sigma[gemm] counter=65 i=4 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=65 i=5 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=65 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=65 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.6e-01 t_gemm=1.9e+00 t_reduction=8.0e-01 tot=3.4e+00 -----
 sigma_tot[inter] counter=65 t=6.6e-01 per=2.0e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=65 i=0 t=1.4e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=65 i=3 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=65 i=4 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=65 i=5 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=65 total t=1.9e+00 per=5.7e+01 cost=4.2e+06 flops=2.2e+06
 sigma_tot[red] counter=65 t=8.0e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,3.3e-05,2.8e-06,8.3e-07,2.1e-07
    4   0 -    -116.309956159530 -6.615e-05  6.064e-04    3     4  2.612e-01 6.530e-02 5.401e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.248e-03,1.002e-02,3.000e-02,1.233e-02,5.461e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=2.243e-03 speed=5.316e-05GB/S T(nccl)=5.866e-06 speed=2.032e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=66 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=66 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=66 i=3 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=66 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=66 i=5 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=66 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=66 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.7e-01 t_gemm=1.9e+00 t_reduction=8.2e-01 tot=3.4e+00 -----
 sigma_tot[inter] counter=66 t=6.7e-01 per=2.0e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=66 i=0 t=1.4e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 i=3 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 i=4 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 i=5 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 total t=1.9e+00 per=5.7e+01 cost=4.3e+06 flops=2.2e+06
 sigma_tot[red] counter=66 t=8.2e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.5e-05,3.1e-06,8.9e-07,2.2e-07
    5   0 +    -116.309956986587 -8.271e-07  8.085e-05    3     5  3.286e-01 6.572e-02 5.415e-02
TIMING FOR Davidson : 3.286e-01  T(cal/comm/rest)=2.708e-01,5.100e-07,5.783e-02
decomposed t_rest=5.783e-02
 T(sub)    =1.283e-04 per=2.219e-01
 T(precond)=5.752e-02 per=9.946e+01
 T(ortho)  =5.394e-05 per=9.328e-02
 T(xcopy)  =2.369e-06 per=4.097e-03
 T(xnrm2)  =2.877e-06 per=4.975e-03
 T(other)  =1.245e-04 per=2.153e-01
optimized energies: isweep=0 ibond=13 dots=1 e[0]=-116.309956986587 nmvp=5
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=6.112e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=8 dimAll=16
 (21,3):2 (23,3):4 (22,4):3 (22,2):3 (24,2):1 (23,1):1 (24,4):1 (23,5):1
timing for divide=7.2e-06
timing for compute=1.3e-02
timing for collect=3.7e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=7.2e-06,1.3e-02,0.0e+00,4.3e-06,3.7e-05 -----
decimation summary: 16->2 dwt=+0.000e+00 SvN=4.761e-02
 qbond: qkept nsym=1 dimAll=2
 (23,3):2
----- TIMING for decimation_row(nkr): 1.285e-02 S T(decim/select/formRot)=1.264e-02,1.886e-04,1.758e-05 -----
----- TIMING FOR onedot_decimation: 1.291e-02 S T(wf/decim)=5.249e-05,1.286e-02 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 P:0 Q:96.8 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.919e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.227e-02 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper)=2.111e-05
rank=0 GPUmem(GB): used=5.038e-05 (oper,site)=2.111e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.499e-03 S -----
rank=0 GPUmem(GB): used=7.959e-05 (oper,site,rinter)=2.111e-05,5.960e-08,2.921e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.318e-03 S size(rtasks)=141 size(Rlst2)=1 T(Rmu/Rlist)=1.654e-03,6.646e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.391e-03 S size(rtasks)=141 size(Rlst)=382 -----
rank=0 GPUmem(GB): used=7.959e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.131e-05 blksize=4 blksize0=2 batchsize=382
rank=0 GPUmem(GB): used=1.109e-04 (oper,site,rinter,batch)=2.111e-05,5.960e-08,2.921e-05,3.131e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.468e-03,2.275e-02,1.012e-02
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=14 t=5.5e-03 per=1.4e+01 cost=6.7e+03 flops=1.2e+06
 renorm[gemm] counter=14 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=3 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=4 t=7.6e-03 per=2.0e+01 cost=7.9e+02 flops=1.0e+05
 renorm[gemm] counter=14 i=5 t=7.6e-03 per=2.0e+01 cost=1.5e+03 flops=2.0e+05
 renorm[gemm] counter=14 i=6 t=7.6e-03 per=2.0e+01 cost=4.3e+03 flops=5.7e+05
 renorm[gemm] counter=14 total t=2.3e-02 per=5.9e+01 cost=6.6e+03 flops=2.9e+05
 renorm[red] counter=14 t=1.0e-02 per=2.6e+01 cost=3.1e+03 flops=3.0e+05
----- TIMING FOR renorm_tot : t_inter=8.3e-02 t_gemm=3.1e-01 t_reduction=1.4e-01 tot=5.4e-01 -----
 renorm_tot[inter] counter=14 t=8.3e-02 per=1.5e+01 cost=5.2e+05 flops=6.2e+06
 renorm_tot[gemm] counter=14 i=0 t=2.2e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=1.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=3 t=1.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=4 t=1.0e-01 per=1.9e+01 cost=2.1e+05 flops=2.0e+06
 renorm_tot[gemm] counter=14 i=5 t=1.1e-01 per=2.0e+01 cost=2.8e+05 flops=2.6e+06
 renorm_tot[gemm] counter=14 i=6 t=1.1e-01 per=2.0e+01 cost=1.4e+06 flops=1.3e+07
 renorm_tot[gemm] counter=14 total t=3.1e-01 per=5.8e+01 cost=1.9e+06 flops=6.1e+06
 renorm_tot[red] counter=14 t=1.4e-01 per=2.6e+01 cost=6.5e+05 flops=4.6e+06
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB T(to_cpu)=1.3e-04S speed=6.9e-03GB/S
check ||H-H.dagger||=1.256e-15 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.06 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.783e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.499e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.906e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.936e-01 S #####
 T(local opt: fetch) = 1.021e-02 S  per = 1.72  per(accum) = 1.72
 T(local opt: hdiag) = 1.624e-01 S  per = 27.4  per(accum) = 29.1
 T(local opt: dvdsn) = 3.466e-01 S  per = 58.4  per(accum) = 87.5
 T(local opt: decim) = 1.292e-02 S  per = 2.18  per(accum) = 89.6
 T(local opt: guess) = 6.819e-05 S  per = 0.0115  per(accum) = 89.6
 T(local opt: renrm) = 6.127e-02 S  per = 10.3  per(accum) = 100
 T(local opt: save ) = 2.139e-04 S  per = 0.036  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.466e-01 S  T(sum) = 3.464e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 9.485e-05 S  per = 0.0274  per(accum) = 0.0274
 T(local opt: symbolic_formulae           ) = 1.132e-02 S  per = 3.27  per(accum) = 3.3
 T(local opt: hintermediate init          ) = 2.723e-04 S  per = 0.0786  per(accum) = 3.38
 T(local opt: preprocess_hformulae_Hxlist ) = 2.584e-03 S  per = 0.746  per(accum) = 4.12
 T(local opt: hmmtasks init               ) = 3.485e-03 S  per = 1.01  per(accum) = 5.13
 T(local opt: initial guess for dvdson    ) = 2.767e-06 S  per = 0.000799  per(accum) = 5.13
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.624e-01 S  per = 75.8  per(accum) = 80.9
 T(local opt: dvdson [cpu-gpu]            ) = 8.336e-03 S  per = 2.41  per(accum) = 83.3
 T(local opt: dvdson [nccl]               ) = 3.595e-05 S  per = 0.0104  per(accum) = 83.3
 T(local opt: dvdson [mpi]                ) = 5.100e-07 S  per = 0.000147  per(accum) = 83.3
 T(local opt: dvdson [rest part(linalg)]  ) = 5.783e-02 S  per = 16.7  per(accum) = 100
Detailed decomposition of T(renrm) = 6.127e-02 S  T(sum) = 6.127e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.718e-05 S  per = 0.126  per(accum) = 0.126
 T(local opt: qops init                    ) = 1.150e-03 S  per = 1.88  per(accum) = 2
 T(local opt: symbolic_formulae_renorm     ) = 1.229e-02 S  per =   20  per(accum) = 22.1
 T(local opt: allocate qops on gpu         ) = 5.890e-05 S  per = 0.0961  per(accum) = 22.1
 T(local opt: site memcpy cpu2gpu          ) = 7.563e-04 S  per = 1.23  per(accum) = 23.4
 T(local opt: rintermediate init           ) = 2.510e-03 S  per =  4.1  per(accum) = 27.5
 T(local opt: preprocess_formulae_Rlist2   ) = 2.407e-03 S  per = 3.93  per(accum) = 31.4
 T(local opt: rmmtasks init                ) = 2.185e-03 S  per = 3.57  per(accum) = 35
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 5.06e-05  per(accum) = 35
 T(local opt: preprocess_renorm_batchGPU   ) = 3.842e-02 S  per = 62.7  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 3.586e-05 S  per = 0.0585  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 9.14e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 7.02e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 1.405e-04 S  per = 0.229  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.586e-05 S  per = 0.0259  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.233e-03 S  per = 2.01  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.465e-06 S  per = 0.00239  per(accum) = 100
##### sweep opt: 8.747e+00 S #####
 T(sweep opt: fetch) = 1.815e-01 S  per = 2.07  per(accum) = 2.07
 T(sweep opt: hdiag) = 2.750e+00 S  per = 31.4  per(accum) = 33.5
 T(sweep opt: dvdsn) = 4.574e+00 S  per = 52.3  per(accum) = 85.8
 T(sweep opt: decim) = 1.515e-01 S  per = 1.73  per(accum) = 87.5
 T(sweep opt: guess) = 1.462e-03 S  per = 0.0167  per(accum) = 87.6
 T(sweep opt: renrm) = 1.084e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 3.559e-03 S  per = 0.0407  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.574e+00 S  T(sum) = 4.570e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.450e-03 S  per = 0.0317  per(accum) = 0.0317
 T(sweep opt: symbolic_formulae           ) = 1.999e-01 S  per = 4.38  per(accum) = 4.41
 T(sweep opt: hintermediate init          ) = 5.191e-03 S  per = 0.114  per(accum) = 4.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.470e-02 S  per = 1.42  per(accum) = 5.94
 T(sweep opt: hmmtasks init               ) = 1.270e-01 S  per = 2.78  per(accum) = 8.72
 T(sweep opt: initial guess for dvdson    ) = 4.329e-05 S  per = 0.000947  per(accum) = 8.72
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.440e+00 S  per = 75.3  per(accum) = 84
 T(sweep opt: dvdson [cpu-gpu]            ) = 8.399e-02 S  per = 1.84  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 4.171e-04 S  per = 0.00913  per(accum) = 85.8
 T(sweep opt: dvdson [mpi]                ) = 8.110e-06 S  per = 0.000177  per(accum) = 85.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.472e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.084e+00 S  T(sum) = 1.084e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.020e-03 S  per = 0.186  per(accum) = 0.186
 T(sweep opt: qops init                    ) = 2.891e-02 S  per = 2.67  per(accum) = 2.85
 T(sweep opt: symbolic_formulae_renorm     ) = 2.172e-01 S  per =   20  per(accum) = 22.9
 T(sweep opt: allocate qops on gpu         ) = 8.466e-04 S  per = 0.0781  per(accum) = 23
 T(sweep opt: site memcpy cpu2gpu          ) = 1.820e-02 S  per = 1.68  per(accum) = 24.6
 T(sweep opt: rintermediate init           ) = 3.267e-02 S  per = 3.01  per(accum) = 27.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.655e-02 S  per = 6.14  per(accum) = 33.8
 T(sweep opt: rmmtasks init                ) = 1.267e-01 S  per = 11.7  per(accum) = 45.5
 T(sweep opt: qops memset on cpu           ) = 5.980e-07 S  per = 5.52e-05  per(accum) = 45.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.404e-01 S  per = 49.8  per(accum) = 95.3
 T(sweep opt: deallocate cpu and gpu memory) = 1.237e-03 S  per = 0.114  per(accum) = 95.4
 T(sweep opt: construct opS [ifdists=true] ) = 8.380e-07 S  per = 7.73e-05  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [nccl]) = 6.000e-07 S  per = 5.53e-05  per(accum) = 95.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.100e-03 S  per = 0.286  per(accum) = 95.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.775e-04 S  per = 0.0256  per(accum) = 95.7
 T(sweep opt: qops_pool join and erase     ) = 2.127e-02 S  per = 1.96  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.29  per(accum) = 100
##### global opt: 8.747e+00 S #####
 T(global opt: fetch) = 1.815e-01 S  per = 2.07  per(accum) = 2.07
 T(global opt: hdiag) = 2.750e+00 S  per = 31.4  per(accum) = 33.5
 T(global opt: dvdsn) = 4.574e+00 S  per = 52.3  per(accum) = 85.8
 T(global opt: decim) = 1.515e-01 S  per = 1.73  per(accum) = 87.5
 T(global opt: guess) = 1.462e-03 S  per = 0.0167  per(accum) = 87.6
 T(global opt: renrm) = 1.084e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 3.559e-03 S  per = 0.0407  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.574e+00 S  T(sum) = 4.570e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.450e-03 S  per = 0.0317  per(accum) = 0.0317
 T(global opt: symbolic_formulae           ) = 1.999e-01 S  per = 4.38  per(accum) = 4.41
 T(global opt: hintermediate init          ) = 5.191e-03 S  per = 0.114  per(accum) = 4.52
 T(global opt: preprocess_hformulae_Hxlist ) = 6.470e-02 S  per = 1.42  per(accum) = 5.94
 T(global opt: hmmtasks init               ) = 1.270e-01 S  per = 2.78  per(accum) = 8.72
 T(global opt: initial guess for dvdson    ) = 4.329e-05 S  per = 0.000947  per(accum) = 8.72
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.440e+00 S  per = 75.3  per(accum) = 84
 T(global opt: dvdson [cpu-gpu]            ) = 8.399e-02 S  per = 1.84  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 4.171e-04 S  per = 0.00913  per(accum) = 85.8
 T(global opt: dvdson [mpi]                ) = 8.110e-06 S  per = 0.000177  per(accum) = 85.8
 T(global opt: dvdson [rest part(linalg)]  ) = 6.472e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.084e+00 S  T(sum) = 1.084e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.020e-03 S  per = 0.186  per(accum) = 0.186
 T(global opt: qops init                    ) = 2.891e-02 S  per = 2.67  per(accum) = 2.85
 T(global opt: symbolic_formulae_renorm     ) = 2.172e-01 S  per =   20  per(accum) = 22.9
 T(global opt: allocate qops on gpu         ) = 8.466e-04 S  per = 0.0781  per(accum) = 23
 T(global opt: site memcpy cpu2gpu          ) = 1.820e-02 S  per = 1.68  per(accum) = 24.6
 T(global opt: rintermediate init           ) = 3.267e-02 S  per = 3.01  per(accum) = 27.7
 T(global opt: preprocess_formulae_Rlist2   ) = 6.655e-02 S  per = 6.14  per(accum) = 33.8
 T(global opt: rmmtasks init                ) = 1.267e-01 S  per = 11.7  per(accum) = 45.5
 T(global opt: qops memset on cpu           ) = 5.980e-07 S  per = 5.52e-05  per(accum) = 45.5
 T(global opt: preprocess_renorm_batchGPU   ) = 5.404e-01 S  per = 49.8  per(accum) = 95.3
 T(global opt: deallocate cpu and gpu memory) = 1.237e-03 S  per = 0.114  per(accum) = 95.4
 T(global opt: construct opS [ifdists=true] ) = 8.380e-07 S  per = 7.73e-05  per(accum) = 95.4
 T(global opt: reduction of opS & opH [nccl]) = 6.000e-07 S  per = 5.53e-05  per(accum) = 95.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.100e-03 S  per = 0.286  per(accum) = 95.7
 T(global opt: reduction of opS & opH [mpi] ) = 2.775e-04 S  per = 0.0256  per(accum) = 95.7
 T(global opt: qops_pool join and erase     ) = 2.127e-02 S  per = 1.96  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.29  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-6.074e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=14/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=6:4.578e-05MB:4.470e-08GB
total mem of comb=770:5.875e-03MB:5.737e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 P:0 Q:96.8 
 rqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2605:0.0199MB:1.94e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(2,3,4) nnz=6:4.578e-05MB
qtensor3: wf3 own=1 _data=0x3aa08600
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=1 dimAll=2
 (23,3):2
 qbond: qcol nsym=2 dimAll=3
 (5,-3):2 (6,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=2 nblocks=8 size=6:4.578e-05MB
### DIAG TIMING: total=1.126e-01 t1=2.197e-05, t2=2.211e-03, t3=2.484e-03, t4=1.079e-01, t5=6.385e-06, t6=1.523e-05, t7=3.782e-06
duration_diagGPU:1.126e-01
duration_diagreduce:6.790e-07
duration_diagtransform:8.810e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 7.605e-03 S -----
rank=0 GPUmem(GB): used=1.941e-05 (oper)=1.941e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.787e-04 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper,hinter)=1.941e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.336e-03 S size(H_formulae)=435 size(Hxlst2)=2 T(Hmu/Hxlist)=9.790e-04,3.572e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.369e-03 S size(H_formulae)=435 size(Hxlst)=196 -----
rank=0 GPUmem(GB): used=4.042e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=8.941e-08 batch[need]=1.314e-05 blksize=4 blksize0=0 batchsize=196
rank=0 GPUmem(GB): used=5.365e-05 (oper,hinter,dvdson,batch)=1.941e-05,2.101e-05,8.941e-08,1.314e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=6 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.313e-03,2.534e-03,3.041e-02,1.246e-02,4.673e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.309e-03 speed=6.832e-05GB/S T(nccl)=4.724e-06 speed=1.893e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=67 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=0 t=1.5e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=1.2e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=67 i=3 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=67 i=4 t=7.6e-03 per=1.7e+01 cost=5.8e+02 flops=7.5e+04
 sigma[gemm] counter=67 i=5 t=7.6e-03 per=1.7e+01 cost=6.1e+02 flops=8.0e+04
 sigma[gemm] counter=67 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.8e+04
 sigma[red] counter=67 t=1.2e-02 per=2.7e+01 cost=1.2e+03 flops=9.5e+04
----- TIMING FOR sigma_tot : t_inter=6.7e-01 t_gemm=2.0e+00 t_reduction=8.3e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=67 t=6.7e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=67 i=0 t=1.4e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=67 i=3 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=67 i=4 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=67 i=5 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=67 total t=2.0e+00 per=5.7e+01 cost=4.3e+06 flops=2.2e+06
 sigma_tot[red] counter=67 t=8.3e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.0e-06,1.9e-06,6.8e-07,2.0e-07
settings: ndim=6 neig=1 maxcycle=30 nbuff=4 memory=7e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.309956986587 -1.116e+03  1.797e-03    1     1  4.684e-02 4.684e-02 4.681e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.787e-03,2.451e-03,3.044e-02,1.261e-02,4.730e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.781e-03 speed=5.019e-05GB/S T(nccl)=5.596e-06 speed=1.598e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=4.5e-02 -----
 sigma[inter] counter=68 t=2.5e-03 per=5.4e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=0 t=2.2e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=1.6e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=68 i=3 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=68 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.6e+04
 sigma[gemm] counter=68 i=5 t=7.6e-03 per=1.7e+01 cost=6.1e+02 flops=8.0e+04
 sigma[gemm] counter=68 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.7e+04
 sigma[red] counter=68 t=1.3e-02 per=2.8e+01 cost=1.2e+03 flops=9.4e+04
----- TIMING FOR sigma_tot : t_inter=6.7e-01 t_gemm=2.0e+00 t_reduction=8.4e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=68 t=6.7e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=68 i=0 t=1.4e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=68 i=3 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=68 i=4 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=68 i=5 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=68 total t=2.0e+00 per=5.7e+01 cost=4.3e+06 flops=2.1e+06
 sigma_tot[red] counter=68 t=8.4e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.1e-05,3.4e-06,9.1e-07,2.4e-07
    2   0 -    -116.309975579039 -1.859e-05  7.449e-04    2     2  1.075e-01 5.373e-02 4.710e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.315e-03,2.484e-03,3.002e-02,3.398e-03,3.823e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=2.309e-03 speed=3.872e-05GB/S T(nccl)=5.908e-06 speed=1.513e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=3.4e-03 tot=3.6e-02 -----
 sigma[inter] counter=69 t=2.5e-03 per=6.9e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=0 t=2.2e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=1.5e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=7.5e-03 per=2.1e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=69 i=3 t=7.5e-03 per=2.1e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=69 i=4 t=7.5e-03 per=2.1e+01 cost=5.8e+02 flops=7.6e+04
 sigma[gemm] counter=69 i=5 t=7.5e-03 per=2.1e+01 cost=6.1e+02 flops=8.1e+04
 sigma[gemm] counter=69 total t=3.0e-02 per=8.4e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=69 t=3.4e-03 per=9.5e+00 cost=1.2e+03 flops=3.5e+05
----- TIMING FOR sigma_tot : t_inter=6.8e-01 t_gemm=2.0e+00 t_reduction=8.4e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=69 t=6.8e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=69 i=0 t=1.5e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=69 i=3 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=69 i=4 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=69 i=5 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=69 total t=2.0e+00 per=5.7e+01 cost=4.3e+06 flops=2.1e+06
 sigma_tot[red] counter=69 t=8.4e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.1e-06,9.9e-07,2.2e-07
    3   0 -    -116.309976937068 -1.358e-06  2.085e-04    3     3  1.585e-01 5.282e-02 4.418e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.998e-03,2.520e-03,2.994e-02,1.239e-02,4.685e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.993e-03 speed=4.486e-05GB/S T(nccl)=4.686e-06 speed=1.908e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=70 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=0 t=2.0e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=1.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=70 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=70 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.6e+04
 sigma[gemm] counter=70 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=70 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=70 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.5e+04
----- TIMING FOR sigma_tot : t_inter=6.8e-01 t_gemm=2.1e+00 t_reduction=8.6e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=70 t=6.8e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=70 i=0 t=1.5e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=70 i=3 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=70 i=4 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=70 i=5 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=70 total t=2.1e+00 per=5.7e+01 cost=4.3e+06 flops=2.1e+06
 sigma_tot[red] counter=70 t=8.6e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.7e-05,2.8e-06,9.2e-07,2.3e-07
    4   0 +    -116.309977015224 -7.816e-08  2.696e-05    3     4  2.180e-01 5.450e-02 4.487e-02
TIMING FOR Davidson : 2.180e-01  T(cal/comm/rest)=1.795e-01,4.520e-07,3.853e-02
decomposed t_rest=3.853e-02
 T(sub)    =7.767e-05 per=2.016e-01
 T(precond)=3.835e-02 per=9.953e+01
 T(ortho)  =2.204e-05 per=5.721e-02
 T(xcopy)  =5.820e-07 per=1.511e-03
 T(xnrm2)  =1.662e-06 per=4.314e-03
 T(other)  =8.002e-05 per=2.077e-01
optimized energies: isweep=0 ibond=14 dots=1 e[0]=-116.309977015224 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.806e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=4 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=4 dimAll=8
 (23,3):2 (25,3):2 (24,4):2 (24,2):2
timing for divide=6.7e-06
timing for compute=1.3e-02
timing for collect=3.0e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.7e-06,1.3e-02,0.0e+00,4.4e-06,3.0e-05 -----
decimation summary: 8->3 dwt=+0.000e+00 SvN=5.868e-01
 qbond: qkept nsym=2 dimAll=3
 (25,3):2 (24,2):1
----- TIMING for decimation_row(nkr): 1.322e-02 S T(decim/select/formRot)=1.298e-02,2.204e-04,2.543e-05 -----
----- TIMING FOR onedot_decimation: 1.327e-02 S T(wf/decim)=3.113e-05,1.324e-02 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.368e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 9.055e-03 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper)=1.941e-05
rank=0 GPUmem(GB): used=4.046e-05 (oper,site)=1.941e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.503e-03 S -----
rank=0 GPUmem(GB): used=6.147e-05 (oper,site,rinter)=1.941e-05,4.470e-08,2.101e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.499e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.234e-03,2.647e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.522e-03 S size(rtasks)=105 size(Rlst)=103 -----
rank=0 GPUmem(GB): used=6.147e-05 avail=6.176e+00 total=6.176e+00 batch[need]=6.907e-06 blksize=4 blksize0=0 batchsize=103
rank=0 GPUmem(GB): used=6.838e-05 (oper,site,rinter,batch)=1.941e-05,4.470e-08,2.101e-05,6.907e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=4.579e-04,2.229e-02,9.850e-03
----- TIMING FOR renorm : t_inter=4.6e-04 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.3e-02 -----
 renorm[inter] counter=15 t=4.6e-04 per=1.4e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=0 t=1.7e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=1.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=3 t=1.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=4 t=7.5e-03 per=2.3e+01 cost=1.3e+02 flops=1.7e+04
 renorm[gemm] counter=15 i=5 t=7.4e-03 per=2.3e+01 cost=5.4e+02 flops=7.4e+04
 renorm[gemm] counter=15 i=6 t=7.4e-03 per=2.3e+01 cost=1.0e+03 flops=1.4e+05
 renorm[gemm] counter=15 total t=2.2e-02 per=6.8e+01 cost=1.7e+03 flops=7.6e+04
 renorm[red] counter=15 t=9.9e-03 per=3.0e+01 cost=5.1e+02 flops=5.2e+04
----- TIMING FOR renorm_tot : t_inter=8.4e-02 t_gemm=3.4e-01 t_reduction=1.5e-01 tot=5.7e-01 -----
 renorm_tot[inter] counter=15 t=8.4e-02 per=1.5e+01 cost=5.2e+05 flops=6.2e+06
 renorm_tot[gemm] counter=15 i=0 t=2.4e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=2.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=1.9e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=3 t=1.9e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=4 t=1.1e-01 per=1.9e+01 cost=2.1e+05 flops=1.9e+06
 renorm_tot[gemm] counter=15 i=5 t=1.1e-01 per=2.0e+01 cost=2.8e+05 flops=2.5e+06
 renorm_tot[gemm] counter=15 i=6 t=1.1e-01 per=2.0e+01 cost=1.4e+06 flops=1.3e+07
 renorm_tot[gemm] counter=15 total t=3.4e-01 per=5.9e+01 cost=1.9e+06 flops=5.7e+06
 renorm_tot[red] counter=15 t=1.5e-01 per=2.6e+01 cost=6.5e+05 flops=4.3e+06
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.1e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0493 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.172e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.281e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.310e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.153e-01 S #####
 T(local opt: fetch) = 1.063e-02 S  per = 2.56  per(accum) = 2.56
 T(local opt: hdiag) = 1.127e-01 S  per = 27.1  per(accum) = 29.7
 T(local opt: dvdsn) = 2.281e-01 S  per = 54.9  per(accum) = 84.6
 T(local opt: decim) = 1.329e-02 S  per =  3.2  per(accum) = 87.8
 T(local opt: guess) = 7.071e-05 S  per = 0.017  per(accum) = 87.8
 T(local opt: renrm) = 5.036e-02 S  per = 12.1  per(accum) = 99.9
 T(local opt: save ) = 2.231e-04 S  per = 0.0537  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.281e-01 S  T(sum) = 2.279e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 6.210e-05 S  per = 0.0272  per(accum) = 0.0272
 T(local opt: symbolic_formulae           ) = 7.617e-03 S  per = 3.34  per(accum) = 3.37
 T(local opt: hintermediate init          ) = 1.926e-04 S  per = 0.0845  per(accum) = 3.45
 T(local opt: preprocess_hformulae_Hxlist ) = 1.377e-03 S  per = 0.604  per(accum) = 4.06
 T(local opt: hmmtasks init               ) = 6.904e-04 S  per = 0.303  per(accum) = 4.36
 T(local opt: initial guess for dvdson    ) = 2.446e-06 S  per = 0.00107  per(accum) = 4.36
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.721e-01 S  per = 75.5  per(accum) = 79.8
 T(local opt: dvdson [cpu-gpu]            ) = 7.392e-03 S  per = 3.24  per(accum) = 83.1
 T(local opt: dvdson [nccl]               ) = 2.091e-05 S  per = 0.00918  per(accum) = 83.1
 T(local opt: dvdson [mpi]                ) = 4.520e-07 S  per = 0.000198  per(accum) = 83.1
 T(local opt: dvdson [rest part(linalg)]  ) = 3.853e-02 S  per = 16.9  per(accum) = 100
Detailed decomposition of T(renrm) = 5.036e-02 S  T(sum) = 5.036e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.426e-05 S  per = 0.147  per(accum) = 0.147
 T(local opt: qops init                    ) = 9.378e-04 S  per = 1.86  per(accum) = 2.01
 T(local opt: symbolic_formulae_renorm     ) = 9.069e-03 S  per =   18  per(accum) = 20
 T(local opt: allocate qops on gpu         ) = 5.614e-05 S  per = 0.111  per(accum) = 20.1
 T(local opt: site memcpy cpu2gpu          ) = 1.828e-03 S  per = 3.63  per(accum) = 23.8
 T(local opt: rintermediate init           ) = 2.515e-03 S  per = 4.99  per(accum) = 28.8
 T(local opt: preprocess_formulae_Rlist2   ) = 1.529e-03 S  per = 3.04  per(accum) = 31.8
 T(local opt: rmmtasks init                ) = 5.143e-04 S  per = 1.02  per(accum) = 32.8
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 6.75e-05  per(accum) = 32.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.268e-02 S  per = 64.9  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 2.661e-05 S  per = 0.0528  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 0.000111  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 7.55e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.130e-04 S  per = 0.224  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.519e-05 S  per = 0.0302  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.002e-03 S  per = 1.99  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.871e-06 S  per = 0.00371  per(accum) = 100
##### sweep opt: 9.162e+00 S #####
 T(sweep opt: fetch) = 1.921e-01 S  per =  2.1  per(accum) = 2.1
 T(sweep opt: hdiag) = 2.863e+00 S  per = 31.2  per(accum) = 33.3
 T(sweep opt: dvdsn) = 4.803e+00 S  per = 52.4  per(accum) = 85.8
 T(sweep opt: decim) = 1.647e-01 S  per =  1.8  per(accum) = 87.6
 T(sweep opt: guess) = 1.532e-03 S  per = 0.0167  per(accum) = 87.6
 T(sweep opt: renrm) = 1.135e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 3.782e-03 S  per = 0.0413  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.803e+00 S  T(sum) = 4.798e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.512e-03 S  per = 0.0315  per(accum) = 0.0315
 T(sweep opt: symbolic_formulae           ) = 2.076e-01 S  per = 4.33  per(accum) = 4.36
 T(sweep opt: hintermediate init          ) = 5.384e-03 S  per = 0.112  per(accum) = 4.47
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.608e-02 S  per = 1.38  per(accum) = 5.85
 T(sweep opt: hmmtasks init               ) = 1.277e-01 S  per = 2.66  per(accum) = 8.51
 T(sweep opt: initial guess for dvdson    ) = 4.574e-05 S  per = 0.000953  per(accum) = 8.51
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.612e+00 S  per = 75.3  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 9.138e-02 S  per =  1.9  per(accum) = 85.7
 T(sweep opt: dvdson [nccl]               ) = 4.380e-04 S  per = 0.00913  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 8.562e-06 S  per = 0.000178  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.858e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.135e+00 S  T(sum) = 1.135e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.095e-03 S  per = 0.185  per(accum) = 0.185
 T(sweep opt: qops init                    ) = 2.984e-02 S  per = 2.63  per(accum) = 2.82
 T(sweep opt: symbolic_formulae_renorm     ) = 2.263e-01 S  per = 19.9  per(accum) = 22.8
 T(sweep opt: allocate qops on gpu         ) = 9.028e-04 S  per = 0.0796  per(accum) = 22.8
 T(sweep opt: site memcpy cpu2gpu          ) = 2.003e-02 S  per = 1.77  per(accum) = 24.6
 T(sweep opt: rintermediate init           ) = 3.519e-02 S  per =  3.1  per(accum) = 27.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.808e-02 S  per =    6  per(accum) = 33.7
 T(sweep opt: rmmtasks init                ) = 1.272e-01 S  per = 11.2  per(accum) = 44.9
 T(sweep opt: qops memset on cpu           ) = 6.320e-07 S  per = 5.57e-05  per(accum) = 44.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.731e-01 S  per = 50.5  per(accum) = 95.4
 T(sweep opt: deallocate cpu and gpu memory) = 1.264e-03 S  per = 0.111  per(accum) = 95.5
 T(sweep opt: construct opS [ifdists=true] ) = 8.940e-07 S  per = 7.88e-05  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [nccl]) = 6.380e-07 S  per = 5.62e-05  per(accum) = 95.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.213e-03 S  per = 0.283  per(accum) = 95.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.927e-04 S  per = 0.0258  per(accum) = 95.8
 T(sweep opt: qops_pool join and erase     ) = 2.227e-02 S  per = 1.96  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.19  per(accum) = 100
##### global opt: 9.162e+00 S #####
 T(global opt: fetch) = 1.921e-01 S  per =  2.1  per(accum) = 2.1
 T(global opt: hdiag) = 2.863e+00 S  per = 31.2  per(accum) = 33.3
 T(global opt: dvdsn) = 4.803e+00 S  per = 52.4  per(accum) = 85.8
 T(global opt: decim) = 1.647e-01 S  per =  1.8  per(accum) = 87.6
 T(global opt: guess) = 1.532e-03 S  per = 0.0167  per(accum) = 87.6
 T(global opt: renrm) = 1.135e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 3.782e-03 S  per = 0.0413  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.803e+00 S  T(sum) = 4.798e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.512e-03 S  per = 0.0315  per(accum) = 0.0315
 T(global opt: symbolic_formulae           ) = 2.076e-01 S  per = 4.33  per(accum) = 4.36
 T(global opt: hintermediate init          ) = 5.384e-03 S  per = 0.112  per(accum) = 4.47
 T(global opt: preprocess_hformulae_Hxlist ) = 6.608e-02 S  per = 1.38  per(accum) = 5.85
 T(global opt: hmmtasks init               ) = 1.277e-01 S  per = 2.66  per(accum) = 8.51
 T(global opt: initial guess for dvdson    ) = 4.574e-05 S  per = 0.000953  per(accum) = 8.51
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.612e+00 S  per = 75.3  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 9.138e-02 S  per =  1.9  per(accum) = 85.7
 T(global opt: dvdson [nccl]               ) = 4.380e-04 S  per = 0.00913  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 8.562e-06 S  per = 0.000178  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 6.858e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.135e+00 S  T(sum) = 1.135e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.095e-03 S  per = 0.185  per(accum) = 0.185
 T(global opt: qops init                    ) = 2.984e-02 S  per = 2.63  per(accum) = 2.82
 T(global opt: symbolic_formulae_renorm     ) = 2.263e-01 S  per = 19.9  per(accum) = 22.8
 T(global opt: allocate qops on gpu         ) = 9.028e-04 S  per = 0.0796  per(accum) = 22.8
 T(global opt: site memcpy cpu2gpu          ) = 2.003e-02 S  per = 1.77  per(accum) = 24.6
 T(global opt: rintermediate init           ) = 3.519e-02 S  per =  3.1  per(accum) = 27.7
 T(global opt: preprocess_formulae_Rlist2   ) = 6.808e-02 S  per =    6  per(accum) = 33.7
 T(global opt: rmmtasks init                ) = 1.272e-01 S  per = 11.2  per(accum) = 44.9
 T(global opt: qops memset on cpu           ) = 6.320e-07 S  per = 5.57e-05  per(accum) = 44.9
 T(global opt: preprocess_renorm_batchGPU   ) = 5.731e-01 S  per = 50.5  per(accum) = 95.4
 T(global opt: deallocate cpu and gpu memory) = 1.264e-03 S  per = 0.111  per(accum) = 95.5
 T(global opt: construct opS [ifdists=true] ) = 8.940e-07 S  per = 7.88e-05  per(accum) = 95.5
 T(global opt: reduction of opS & opH [nccl]) = 6.380e-07 S  per = 5.62e-05  per(accum) = 95.5
 T(global opt: qops memcpy gpu2cpu          ) = 3.213e-03 S  per = 0.283  per(accum) = 95.8
 T(global opt: reduction of opS & opH [mpi] ) = 2.927e-04 S  per = 0.0258  per(accum) = 95.8
 T(global opt: qops_pool join and erase     ) = 2.227e-02 S  per = 1.96  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.19  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.779e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=15/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=8:6.104e-05MB:5.960e-08GB
total mem of comb=772:5.890e-03MB:5.752e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 rqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2586:0.0197MB:1.93e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.090e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.768e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,3,4) nnz=8:6.104e-05MB
qtensor3: wf3 own=1 _data=0x3aa244c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (25,3):2 (24,2):1
 qbond: qcol nsym=2 dimAll=3
 (4,-2):2 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=8:6.104e-05MB
### DIAG TIMING: total=7.183e-02 t1=2.304e-05, t2=2.242e-03, t3=2.523e-03, t4=6.702e-02, t5=4.612e-06, t6=1.246e-05, t7=3.315e-06
duration_diagGPU:7.184e-02
duration_diagreduce:4.400e-08
duration_diagtransform:4.030e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 4.970e-03 S -----
rank=0 GPUmem(GB): used=1.927e-05 (oper)=1.927e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.220e-04 S -----
rank=0 GPUmem(GB): used=3.286e-05 (oper,hinter)=1.927e-05,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.056e-03 S size(H_formulae)=297 size(Hxlst2)=3 T(Hmu/Hxlist)=6.238e-04,4.320e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.087e-03 S size(H_formulae)=297 size(Hxlst)=318 -----
rank=0 GPUmem(GB): used=3.286e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.192e-07 batch[need]=2.606e-05 blksize=4 blksize0=2 batchsize=318
rank=0 GPUmem(GB): used=5.904e-05 (oper,hinter,dvdson,batch)=1.927e-05,1.359e-05,1.192e-07,2.606e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=8 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.507e-03,9.895e-03,2.988e-02,1.241e-02,5.370e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.503e-03 speed=7.933e-05GB/S T(nccl)=4.632e-06 speed=2.574e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=71 t=9.9e-03 per=1.9e+01 cost=3.8e+03 flops=3.9e+05
 sigma[gemm] counter=71 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=71 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=71 i=4 t=7.5e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=71 i=5 t=7.5e-03 per=1.4e+01 cost=8.7e+02 flops=1.2e+05
 sigma[gemm] counter=71 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=71 t=1.2e-02 per=2.4e+01 cost=1.7e+03 flops=1.4e+05
----- TIMING FOR sigma_tot : t_inter=6.9e-01 t_gemm=2.1e+00 t_reduction=8.7e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=71 t=6.9e-01 per=1.9e+01 cost=2.5e+06 flops=3.6e+06
 sigma_tot[gemm] counter=71 i=0 t=1.5e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=71 i=3 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=71 i=4 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=71 i=5 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=71 total t=2.1e+00 per=5.7e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=71 t=8.7e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.9e-06,2.0e-06,6.5e-07,1.6e-07
settings: ndim=8 neig=1 maxcycle=30 nbuff=4 memory=9e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.309977015224 -1.116e+03  1.746e-02    1     1  5.380e-02 5.380e-02 5.378e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.834e-03,9.886e-03,2.988e-02,1.254e-02,5.420e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.826e-03 speed=6.530e-05GB/S T(nccl)=8.333e-06 speed=1.431e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=72 t=9.9e-03 per=1.9e+01 cost=3.8e+03 flops=3.9e+05
 sigma[gemm] counter=72 i=0 t=3.0e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=72 i=3 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=72 i=4 t=7.5e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=72 i=5 t=7.6e-03 per=1.4e+01 cost=8.7e+02 flops=1.1e+05
 sigma[gemm] counter=72 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=72 t=1.3e-02 per=2.4e+01 cost=1.7e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=7.0e-01 t_gemm=2.1e+00 t_reduction=8.8e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=72 t=7.0e-01 per=1.9e+01 cost=2.5e+06 flops=3.6e+06
 sigma_tot[gemm] counter=72 i=0 t=1.5e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=72 i=3 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=72 i=4 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=72 i=5 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=72 total t=2.1e+00 per=5.7e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=72 t=8.8e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.2e-05,3.5e-06,7.7e-07,1.9e-07
    2   0 -    -116.311757695462 -1.781e-03  5.344e-03    2     2  1.192e-01 5.958e-02 5.404e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.090e-04,9.982e-03,2.998e-02,1.255e-02,5.313e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=6.031e-04 speed=1.977e-04GB/S T(nccl)=5.930e-06 speed=2.010e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=73 t=1.0e-02 per=1.9e+01 cost=3.8e+03 flops=3.8e+05
 sigma[gemm] counter=73 i=0 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=73 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=73 i=4 t=7.5e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=73 i=5 t=7.6e-03 per=1.4e+01 cost=8.7e+02 flops=1.1e+05
 sigma[gemm] counter=73 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=73 t=1.3e-02 per=2.4e+01 cost=1.7e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=7.1e-01 t_gemm=2.2e+00 t_reduction=8.9e-01 tot=3.8e+00 -----
 sigma_tot[inter] counter=73 t=7.1e-01 per=1.9e+01 cost=2.5e+06 flops=3.5e+06
 sigma_tot[gemm] counter=73 i=0 t=1.5e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 i=3 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 i=4 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 i=5 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 total t=2.2e+00 per=5.7e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=73 t=8.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.0e-06,9.1e-07,2.1e-07
    3   0 -    -116.311849054852 -9.136e-05  1.544e-03    3     3  1.847e-01 6.157e-02 5.377e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.863e-03,1.000e-02,2.995e-02,1.254e-02,5.438e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.857e-03 speed=6.419e-05GB/S T(nccl)=5.666e-06 speed=2.104e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=74 t=1.0e-02 per=1.9e+01 cost=3.8e+03 flops=3.8e+05
 sigma[gemm] counter=74 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=74 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=74 i=4 t=7.4e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=74 i=5 t=7.5e-03 per=1.4e+01 cost=8.7e+02 flops=1.2e+05
 sigma[gemm] counter=74 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=74 t=1.3e-02 per=2.4e+01 cost=1.7e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=7.2e-01 t_gemm=2.2e+00 t_reduction=9.1e-01 tot=3.8e+00 -----
 sigma_tot[inter] counter=74 t=7.2e-01 per=1.9e+01 cost=2.5e+06 flops=3.5e+06
 sigma_tot[gemm] counter=74 i=0 t=1.6e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=74 i=3 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=74 i=4 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=74 i=5 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=74 total t=2.2e+00 per=5.7e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=74 t=9.1e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.5e-05,3.0e-06,8.4e-07,2.3e-07
    4   0 -    -116.311856283844 -7.229e-06  4.687e-04    3     4  2.523e-01 6.307e-02 5.394e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.843e-04,1.004e-02,3.035e-02,1.252e-02,5.331e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=3.784e-04 speed=3.151e-04GB/S T(nccl)=5.979e-06 speed=1.994e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=75 t=1.0e-02 per=1.9e+01 cost=3.8e+03 flops=3.8e+05
 sigma[gemm] counter=75 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=7.6e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=75 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=75 i=4 t=7.6e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=75 i=5 t=7.6e-03 per=1.4e+01 cost=8.7e+02 flops=1.1e+05
 sigma[gemm] counter=75 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=75 t=1.3e-02 per=2.4e+01 cost=1.7e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=7.3e-01 t_gemm=2.2e+00 t_reduction=9.2e-01 tot=3.9e+00 -----
 sigma_tot[inter] counter=75 t=7.3e-01 per=1.9e+01 cost=2.5e+06 flops=3.4e+06
 sigma_tot[gemm] counter=75 i=0 t=1.6e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=75 i=3 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=75 i=4 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=75 i=5 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=75 total t=2.2e+00 per=5.7e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=75 t=9.2e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.5e-05,3.0e-06,8.6e-07,2.4e-07
    5   0 +    -116.311856917920 -6.341e-07  9.866e-05    3     5  3.182e-01 6.365e-02 5.384e-02
TIMING FOR Davidson : 3.182e-01  T(cal/comm/rest)=2.692e-01,5.780e-07,4.905e-02
decomposed t_rest=4.905e-02
 T(sub)    =1.007e-04 per=2.053e-01
 T(precond)=4.877e-02 per=9.942e+01
 T(ortho)  =4.093e-05 per=8.343e-02
 T(xcopy)  =7.680e-07 per=1.566e-03
 T(xnrm2)  =1.481e-05 per=3.020e-02
 T(other)  =1.284e-04 per=2.618e-01
optimized energies: isweep=0 ibond=15 dots=1 e[0]=-116.311856917920 nmvp=5
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.084e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=6 dimAll=12
 (25,3):3 (27,3):2 (26,4):2 (26,2):3 (24,2):1 (25,1):1
timing for divide=7.6e-06
timing for compute=1.2e-02
timing for collect=3.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=7.6e-06,1.2e-02,0.0e+00,4.4e-06,3.3e-05 -----
decimation summary: 12->3 dwt=+1.110e-16 SvN=8.235e-01
 qbond: qkept nsym=2 dimAll=3
 (26,2):2 (27,3):1
----- TIMING for decimation_row(nkr): 1.272e-02 S T(decim/select/formRot)=1.252e-02,1.831e-04,1.893e-05 -----
----- TIMING FOR onedot_decimation: 1.277e-02 S T(wf/decim)=3.990e-05,1.273e-02 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=105:8.011e-04MB:7.823e-07GB
        per(mem): H:4.76 C:32.4 S:5.71 P:0 Q:57.1 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.280e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 5.814e-03 S -----
rank=0 GPUmem(GB): used=3.286e-05 (oper)=1.927e-05
rank=0 GPUmem(GB): used=3.292e-05 (oper,site)=1.927e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.472e-03 S -----
rank=0 GPUmem(GB): used=4.651e-05 (oper,site,rinter)=1.927e-05,5.960e-08,1.359e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.226e-03 S size(rtasks)=77 size(Rlst2)=4 T(Rmu/Rlist)=8.460e-04,3.802e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.260e-03 S size(rtasks)=77 size(Rlst)=184 -----
rank=0 GPUmem(GB): used=4.651e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.508e-05 blksize=4 blksize0=2 batchsize=184
rank=0 GPUmem(GB): used=6.159e-05 (oper,site,rinter,batch)=1.927e-05,5.960e-08,1.359e-05,1.508e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.079e-03,5.003e-03,5.674e-04
----- TIMING FOR renorm : t_inter=1.1e-03 t_gemm=5.0e-03 t_reduction=5.7e-04 tot=6.6e-03 -----
 renorm[inter] counter=16 t=1.1e-03 per=1.6e+01 cost=1.9e+03 flops=1.8e+06
 renorm[gemm] counter=16 i=0 t=1.7e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.5e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=1.5e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=3 t=1.5e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=4 t=2.6e-03 per=3.9e+01 cost=3.5e+02 flops=1.3e+05
 renorm[gemm] counter=16 i=5 t=1.2e-03 per=1.8e+01 cost=7.8e+02 flops=6.6e+05
 renorm[gemm] counter=16 i=6 t=1.2e-03 per=1.9e+01 cost=1.8e+03 flops=1.4e+06
 renorm[gemm] counter=16 total t=5.0e-03 per=7.5e+01 cost=2.9e+03 flops=5.8e+05
 renorm[red] counter=16 t=5.7e-04 per=8.5e+00 cost=1.2e+03 flops=2.0e+06
----- TIMING FOR renorm_tot : t_inter=8.5e-02 t_gemm=3.4e-01 t_reduction=1.5e-01 tot=5.8e-01 -----
 renorm_tot[inter] counter=16 t=8.5e-02 per=1.5e+01 cost=5.2e+05 flops=6.1e+06
 renorm_tot[gemm] counter=16 i=0 t=2.5e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=2.1e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=2.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=3 t=2.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=4 t=1.1e-01 per=2.0e+01 cost=2.1e+05 flops=1.9e+06
 renorm_tot[gemm] counter=16 i=5 t=1.1e-01 per=2.0e+01 cost=2.8e+05 flops=2.4e+06
 renorm_tot[gemm] counter=16 i=6 t=1.1e-01 per=2.0e+01 cost=1.4e+06 flops=1.2e+07
 renorm_tot[gemm] counter=16 total t=3.4e-01 per=5.9e+01 cost=1.9e+06 flops=5.6e+06
 renorm_tot[red] counter=16 t=1.5e-01 per=2.6e+01 cost=6.5e+05 flops=4.3e+06
qops.to_cpu: size(tot)=105:8.0e-04MB:7.8e-07GB T(to_cpu)=8.5e-05S speed=9.2e-03GB/S
check ||H-H.dagger||=6.280e-16 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0199 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.396e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.186e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-3.353e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.429e-01 S #####
 T(local opt: fetch) = 1.099e-02 S  per = 2.48  per(accum) = 2.48
 T(local opt: hdiag) = 7.187e-02 S  per = 16.2  per(accum) = 18.7
 T(local opt: dvdsn) = 3.260e-01 S  per = 73.6  per(accum) = 92.3
 T(local opt: decim) = 1.278e-02 S  per = 2.89  per(accum) = 95.2
 T(local opt: guess) = 5.918e-05 S  per = 0.0134  per(accum) = 95.2
 T(local opt: renrm) = 2.097e-02 S  per = 4.73  per(accum) = 99.9
 T(local opt: save ) = 2.256e-04 S  per = 0.0509  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.260e-01 S  T(sum) = 3.258e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 7.363e-05 S  per = 0.0226  per(accum) = 0.0226
 T(local opt: symbolic_formulae           ) = 4.980e-03 S  per = 1.53  per(accum) = 1.55
 T(local opt: hintermediate init          ) = 1.347e-04 S  per = 0.0413  per(accum) = 1.59
 T(local opt: preprocess_hformulae_Hxlist ) = 1.103e-03 S  per = 0.338  per(accum) = 1.93
 T(local opt: hmmtasks init               ) = 1.281e-03 S  per = 0.393  per(accum) = 2.32
 T(local opt: initial guess for dvdson    ) = 2.400e-06 S  per = 0.000737  per(accum) = 2.32
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.630e-01 S  per = 80.7  per(accum) = 83
 T(local opt: dvdson [cpu-gpu]            ) = 6.167e-03 S  per = 1.89  per(accum) = 84.9
 T(local opt: dvdson [nccl]               ) = 3.054e-05 S  per = 0.00937  per(accum) = 84.9
 T(local opt: dvdson [mpi]                ) = 5.780e-07 S  per = 0.000177  per(accum) = 84.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.905e-02 S  per = 15.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.097e-02 S  T(sum) = 2.097e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.632e-05 S  per = 0.364  per(accum) = 0.364
 T(local opt: qops init                    ) = 7.772e-04 S  per = 3.71  per(accum) = 4.07
 T(local opt: symbolic_formulae_renorm     ) = 5.827e-03 S  per = 27.8  per(accum) = 31.9
 T(local opt: allocate qops on gpu         ) = 5.526e-05 S  per = 0.264  per(accum) = 32.1
 T(local opt: site memcpy cpu2gpu          ) = 1.483e-03 S  per = 7.07  per(accum) = 39.2
 T(local opt: rintermediate init           ) = 2.485e-03 S  per = 11.8  per(accum) = 51
 T(local opt: preprocess_formulae_Rlist2   ) = 1.271e-03 S  per = 6.06  per(accum) = 57.1
 T(local opt: rmmtasks init                ) = 1.085e-03 S  per = 5.17  per(accum) = 62.3
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.000186  per(accum) = 62.3
 T(local opt: preprocess_renorm_batchGPU   ) = 6.741e-03 S  per = 32.1  per(accum) = 94.4
 T(local opt: deallocate cpu and gpu memory) = 2.716e-05 S  per = 0.13  per(accum) = 94.6
 T(local opt: construct opS [ifdists=true] ) = 5.900e-08 S  per = 0.000281  per(accum) = 94.6
 T(local opt: reduction of opS & opH [nccl]) = 4.100e-08 S  per = 0.000196  per(accum) = 94.6
 T(local opt: qops memcpy gpu2cpu          ) = 9.136e-05 S  per = 0.436  per(accum) = 95
 T(local opt: reduction of opS & opH [mpi] ) = 1.578e-05 S  per = 0.0753  per(accum) = 95.1
 T(local opt: qops_pool join and erase     ) = 1.033e-03 S  per = 4.93  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.566e-06 S  per = 0.00747  per(accum) = 100
##### sweep opt: 9.605e+00 S #####
 T(sweep opt: fetch) = 2.031e-01 S  per = 2.11  per(accum) = 2.11
 T(sweep opt: hdiag) = 2.935e+00 S  per = 30.6  per(accum) = 32.7
 T(sweep opt: dvdsn) = 5.129e+00 S  per = 53.4  per(accum) = 86.1
 T(sweep opt: decim) = 1.775e-01 S  per = 1.85  per(accum) = 87.9
 T(sweep opt: guess) = 1.592e-03 S  per = 0.0166  per(accum) = 87.9
 T(sweep opt: renrm) = 1.156e+00 S  per =   12  per(accum) = 100
 T(sweep opt: save ) = 4.008e-03 S  per = 0.0417  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.129e+00 S  T(sum) = 5.124e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.586e-03 S  per = 0.0309  per(accum) = 0.0309
 T(sweep opt: symbolic_formulae           ) = 2.125e-01 S  per = 4.15  per(accum) = 4.18
 T(sweep opt: hintermediate init          ) = 5.519e-03 S  per = 0.108  per(accum) = 4.29
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.719e-02 S  per = 1.31  per(accum) = 5.6
 T(sweep opt: hmmtasks init               ) = 1.290e-01 S  per = 2.52  per(accum) = 8.12
 T(sweep opt: initial guess for dvdson    ) = 4.814e-05 S  per = 0.000939  per(accum) = 8.12
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.875e+00 S  per = 75.6  per(accum) = 83.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 9.755e-02 S  per =  1.9  per(accum) = 85.6
 T(sweep opt: dvdson [nccl]               ) = 4.685e-04 S  per = 0.00914  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 9.140e-06 S  per = 0.000178  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.348e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.156e+00 S  T(sum) = 1.156e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.171e-03 S  per = 0.188  per(accum) = 0.188
 T(sweep opt: qops init                    ) = 3.062e-02 S  per = 2.65  per(accum) = 2.84
 T(sweep opt: symbolic_formulae_renorm     ) = 2.321e-01 S  per = 20.1  per(accum) = 22.9
 T(sweep opt: allocate qops on gpu         ) = 9.580e-04 S  per = 0.0829  per(accum) = 23
 T(sweep opt: site memcpy cpu2gpu          ) = 2.151e-02 S  per = 1.86  per(accum) = 24.9
 T(sweep opt: rintermediate init           ) = 3.767e-02 S  per = 3.26  per(accum) = 28.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.935e-02 S  per =    6  per(accum) = 34.1
 T(sweep opt: rmmtasks init                ) = 1.283e-01 S  per = 11.1  per(accum) = 45.2
 T(sweep opt: qops memset on cpu           ) = 6.710e-07 S  per = 5.81e-05  per(accum) = 45.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.798e-01 S  per = 50.2  per(accum) = 95.4
 T(sweep opt: deallocate cpu and gpu memory) = 1.291e-03 S  per = 0.112  per(accum) = 95.5
 T(sweep opt: construct opS [ifdists=true] ) = 9.530e-07 S  per = 8.25e-05  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [nccl]) = 6.790e-07 S  per = 5.88e-05  per(accum) = 95.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.305e-03 S  per = 0.286  per(accum) = 95.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.085e-04 S  per = 0.0267  per(accum) = 95.8
 T(sweep opt: qops_pool join and erase     ) = 2.330e-02 S  per = 2.02  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.15  per(accum) = 100
##### global opt: 9.605e+00 S #####
 T(global opt: fetch) = 2.031e-01 S  per = 2.11  per(accum) = 2.11
 T(global opt: hdiag) = 2.935e+00 S  per = 30.6  per(accum) = 32.7
 T(global opt: dvdsn) = 5.129e+00 S  per = 53.4  per(accum) = 86.1
 T(global opt: decim) = 1.775e-01 S  per = 1.85  per(accum) = 87.9
 T(global opt: guess) = 1.592e-03 S  per = 0.0166  per(accum) = 87.9
 T(global opt: renrm) = 1.156e+00 S  per =   12  per(accum) = 100
 T(global opt: save ) = 4.008e-03 S  per = 0.0417  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.129e+00 S  T(sum) = 5.124e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.586e-03 S  per = 0.0309  per(accum) = 0.0309
 T(global opt: symbolic_formulae           ) = 2.125e-01 S  per = 4.15  per(accum) = 4.18
 T(global opt: hintermediate init          ) = 5.519e-03 S  per = 0.108  per(accum) = 4.29
 T(global opt: preprocess_hformulae_Hxlist ) = 6.719e-02 S  per = 1.31  per(accum) = 5.6
 T(global opt: hmmtasks init               ) = 1.290e-01 S  per = 2.52  per(accum) = 8.12
 T(global opt: initial guess for dvdson    ) = 4.814e-05 S  per = 0.000939  per(accum) = 8.12
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.875e+00 S  per = 75.6  per(accum) = 83.7
 T(global opt: dvdson [cpu-gpu]            ) = 9.755e-02 S  per =  1.9  per(accum) = 85.6
 T(global opt: dvdson [nccl]               ) = 4.685e-04 S  per = 0.00914  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 9.140e-06 S  per = 0.000178  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 7.348e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.156e+00 S  T(sum) = 1.156e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.171e-03 S  per = 0.188  per(accum) = 0.188
 T(global opt: qops init                    ) = 3.062e-02 S  per = 2.65  per(accum) = 2.84
 T(global opt: symbolic_formulae_renorm     ) = 2.321e-01 S  per = 20.1  per(accum) = 22.9
 T(global opt: allocate qops on gpu         ) = 9.580e-04 S  per = 0.0829  per(accum) = 23
 T(global opt: site memcpy cpu2gpu          ) = 2.151e-02 S  per = 1.86  per(accum) = 24.9
 T(global opt: rintermediate init           ) = 3.767e-02 S  per = 3.26  per(accum) = 28.1
 T(global opt: preprocess_formulae_Rlist2   ) = 6.935e-02 S  per =    6  per(accum) = 34.1
 T(global opt: rmmtasks init                ) = 1.283e-01 S  per = 11.1  per(accum) = 45.2
 T(global opt: qops memset on cpu           ) = 6.710e-07 S  per = 5.81e-05  per(accum) = 45.2
 T(global opt: preprocess_renorm_batchGPU   ) = 5.798e-01 S  per = 50.2  per(accum) = 95.4
 T(global opt: deallocate cpu and gpu memory) = 1.291e-03 S  per = 0.112  per(accum) = 95.5
 T(global opt: construct opS [ifdists=true] ) = 9.530e-07 S  per = 8.25e-05  per(accum) = 95.5
 T(global opt: reduction of opS & opH [nccl]) = 6.790e-07 S  per = 5.88e-05  per(accum) = 95.5
 T(global opt: qops memcpy gpu2cpu          ) = 3.305e-03 S  per = 0.286  per(accum) = 95.8
 T(global opt: reduction of opS & opH [mpi] ) = 3.085e-04 S  per = 0.0267  per(accum) = 95.8
 T(global opt: qops_pool join and erase     ) = 2.330e-02 S  per = 2.02  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.15  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.030e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=16/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=7:5.341e-05MB:5.215e-08GB
total mem of comb=771:5.882e-03MB:5.744e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=105:8.011e-04MB:7.823e-07GB
        per(mem): H:4.76 C:32.4 S:5.71 P:0 Q:57.1 
 rqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2516:0.0192MB:1.87e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.014e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.384e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,3,4) nnz=7:5.341e-05MB
qtensor3: wf3 own=1 _data=0x3aa70180
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (26,2):2 (27,3):1
 qbond: qcol nsym=2 dimAll=3
 (3,-1):2 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=7:5.341e-05MB
### DIAG TIMING: total=4.210e-02 t1=2.675e-05, t2=2.237e-03, t3=2.498e-03, t4=3.731e-02, t5=4.505e-06, t6=1.408e-05, t7=3.008e-06
duration_diagGPU:4.211e-02
duration_diagreduce:4.400e-08
duration_diagtransform:3.870e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 2.789e-03 S -----
rank=0 GPUmem(GB): used=1.875e-05 (oper)=1.875e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.199e-05 S -----
rank=0 GPUmem(GB): used=2.609e-05 (oper,hinter)=1.875e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.754e-04 S size(H_formulae)=193 size(Hxlst2)=3 T(Hmu/Hxlist)=3.823e-04,2.931e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.973e-04 S size(H_formulae)=193 size(Hxlst)=210 -----
rank=0 GPUmem(GB): used=2.609e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.043e-07 batch[need]=1.721e-05 blksize=4 blksize0=2 batchsize=210
rank=0 GPUmem(GB): used=4.341e-05 (oper,hinter,dvdson,batch)=1.875e-05,7.346e-06,1.043e-07,1.721e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=7 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.502e-05,9.830e-03,2.979e-02,1.228e-02,5.200e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=8.027e-05 speed=1.299e-03GB/S T(nccl)=4.749e-06 speed=2.196e-02GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=76 t=9.8e-03 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=76 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+02 flops=6.2e+04
 sigma[gemm] counter=76 i=3 t=7.4e-03 per=1.4e+01 cost=5.1e+02 flops=7.0e+04
 sigma[gemm] counter=76 i=4 t=7.5e-03 per=1.4e+01 cost=5.3e+02 flops=7.0e+04
 sigma[gemm] counter=76 i=5 t=7.5e-03 per=1.4e+01 cost=4.4e+02 flops=6.0e+04
 sigma[gemm] counter=76 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.5e+04
 sigma[red] counter=76 t=1.2e-02 per=2.4e+01 cost=9.1e+02 flops=7.4e+04
----- TIMING FOR sigma_tot : t_inter=7.4e-01 t_gemm=2.2e+00 t_reduction=9.3e-01 tot=3.9e+00 -----
 sigma_tot[inter] counter=76 t=7.4e-01 per=1.9e+01 cost=2.5e+06 flops=3.4e+06
 sigma_tot[gemm] counter=76 i=0 t=1.6e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=76 i=3 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=76 i=4 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=76 i=5 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=76 total t=2.2e+00 per=5.7e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=76 t=9.3e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.1e-06,1.9e-06,6.9e-07,1.5e-07
settings: ndim=7 neig=1 maxcycle=30 nbuff=4 memory=8e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.311856917920 -1.116e+03  2.134e-02    1     1  5.210e-02 5.210e-02 5.208e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.643e-03,9.995e-03,2.987e-02,1.255e-02,5.406e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=1.638e-03 speed=6.369e-05GB/S T(nccl)=5.114e-06 speed=2.040e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=77 t=1.0e-02 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=77 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+02 flops=6.2e+04
 sigma[gemm] counter=77 i=3 t=7.4e-03 per=1.4e+01 cost=5.1e+02 flops=6.9e+04
 sigma[gemm] counter=77 i=4 t=7.5e-03 per=1.4e+01 cost=5.3e+02 flops=7.1e+04
 sigma[gemm] counter=77 i=5 t=7.5e-03 per=1.4e+01 cost=4.4e+02 flops=5.9e+04
 sigma[gemm] counter=77 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.5e+04
 sigma[red] counter=77 t=1.3e-02 per=2.4e+01 cost=9.1e+02 flops=7.2e+04
----- TIMING FOR sigma_tot : t_inter=7.5e-01 t_gemm=2.3e+00 t_reduction=9.4e-01 tot=4.0e+00 -----
 sigma_tot[inter] counter=77 t=7.5e-01 per=1.9e+01 cost=2.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=77 i=0 t=1.6e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 i=3 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 i=4 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 i=5 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 total t=2.3e+00 per=5.7e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=77 t=9.4e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,3.4e-06,7.8e-07,2.2e-07
    2   0 -    -116.314200212892 -2.343e-03  2.427e-03    2     2  1.175e-01 5.875e-02 5.312e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.317e-03,9.858e-03,2.970e-02,1.245e-02,5.333e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=1.312e-03 speed=7.948e-05GB/S T(nccl)=4.342e-06 speed=2.402e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=78 t=9.9e-03 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=78 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+02 flops=6.2e+04
 sigma[gemm] counter=78 i=3 t=7.4e-03 per=1.4e+01 cost=5.1e+02 flops=6.9e+04
 sigma[gemm] counter=78 i=4 t=7.4e-03 per=1.4e+01 cost=5.3e+02 flops=7.1e+04
 sigma[gemm] counter=78 i=5 t=7.4e-03 per=1.4e+01 cost=4.4e+02 flops=6.0e+04
 sigma[gemm] counter=78 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.6e+04
 sigma[red] counter=78 t=1.2e-02 per=2.4e+01 cost=9.1e+02 flops=7.3e+04
----- TIMING FOR sigma_tot : t_inter=7.6e-01 t_gemm=2.3e+00 t_reduction=9.6e-01 tot=4.0e+00 -----
 sigma_tot[inter] counter=78 t=7.6e-01 per=1.9e+01 cost=2.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=78 i=0 t=1.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=78 i=3 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=78 i=4 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=78 i=5 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=78 total t=2.3e+00 per=5.7e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=78 t=9.6e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,2.8e-06,8.5e-07,1.8e-07
    3   0 -    -116.314230246966 -3.003e-05  1.927e-04    3     3  1.825e-01 6.082e-02 5.322e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.760e-04,1.001e-02,3.003e-02,1.237e-02,5.329e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=8.714e-04 speed=1.197e-04GB/S T(nccl)=4.607e-06 speed=2.264e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=79 t=1.0e-02 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=79 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+02 flops=6.1e+04
 sigma[gemm] counter=79 i=3 t=7.6e-03 per=1.4e+01 cost=5.1e+02 flops=6.8e+04
 sigma[gemm] counter=79 i=4 t=7.5e-03 per=1.4e+01 cost=5.3e+02 flops=7.0e+04
 sigma[gemm] counter=79 i=5 t=7.4e-03 per=1.4e+01 cost=4.4e+02 flops=6.0e+04
 sigma[gemm] counter=79 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.5e+04
 sigma[red] counter=79 t=1.2e-02 per=2.4e+01 cost=9.1e+02 flops=7.3e+04
----- TIMING FOR sigma_tot : t_inter=7.7e-01 t_gemm=2.3e+00 t_reduction=9.7e-01 tot=4.1e+00 -----
 sigma_tot[inter] counter=79 t=7.7e-01 per=1.9e+01 cost=2.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=79 i=0 t=1.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=1.4e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=79 i=3 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=79 i=4 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=79 i=5 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=79 total t=2.3e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=79 t=9.7e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.0e-06,8.9e-07,1.6e-07
    4   0 +    -116.314230523770 -2.768e-07  7.518e-06    3     4  2.457e-01 6.144e-02 5.326e-02
TIMING FOR Davidson : 2.458e-01  T(cal/comm/rest)=2.130e-01,4.290e-07,3.272e-02
decomposed t_rest=3.272e-02
 T(sub)    =7.306e-05 per=2.233e-01
 T(precond)=3.253e-02 per=9.943e+01
 T(ortho)  =1.149e-05 per=3.512e-02
 T(xcopy)  =5.940e-07 per=1.815e-03
 T(xnrm2)  =1.674e-06 per=5.116e-03
 T(other)  =9.851e-05 per=3.011e-01
optimized energies: isweep=0 ibond=16 dots=1 e[0]=-116.314230523770 nmvp=4
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.894e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=6 dimAll=12
 (26,2):2 (28,2):3 (27,3):3 (27,1):2 (29,3):1 (28,4):1
timing for divide=7.2e-06
timing for compute=9.2e-03
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 9.3e-03 S T(divide/compute[cpu/gpu/rest]/collect)=7.2e-06,9.2e-03,0.0e+00,4.0e-06,1.3e-05 -----
decimation summary: 12->3 dwt=+0.000e+00 SvN=8.191e-01
 qbond: qkept nsym=2 dimAll=3
 (27,1):2 (28,2):1
----- TIMING for decimation_row(nkr): 9.487e-03 S T(decim/select/formRot)=9.291e-03,1.792e-04,1.712e-05 -----
----- TIMING FOR onedot_decimation: 9.536e-03 S T(wf/decim)=3.805e-05,9.498e-03 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=75:5.722e-04MB:5.588e-07GB
        per(mem): H:6.67 C:48 S:5.33 P:0 Q:40 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.512e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 3.330e-03 S -----
rank=0 GPUmem(GB): used=2.609e-05 (oper)=1.875e-05
rank=0 GPUmem(GB): used=2.614e-05 (oper,site)=1.875e-05,5.215e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.522e-03 S -----
rank=0 GPUmem(GB): used=3.349e-05 (oper,site,rinter)=1.875e-05,5.215e-08,7.346e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 7.915e-04 S size(rtasks)=57 size(Rlst2)=4 T(Rmu/Rlist)=5.146e-04,2.769e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.172e-04 S size(rtasks)=57 size(Rlst)=130 -----
rank=0 GPUmem(GB): used=3.349e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.065e-05 blksize=4 blksize0=2 batchsize=130
rank=0 GPUmem(GB): used=4.414e-05 (oper,site,rinter,batch)=1.875e-05,5.215e-08,7.346e-06,1.065e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.356e-03,2.257e-02,9.889e-03
----- TIMING FOR renorm : t_inter=8.4e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.1e-02 -----
 renorm[inter] counter=17 t=8.4e-03 per=2.0e+01 cost=9.5e+02 flops=1.1e+05
 renorm[gemm] counter=17 i=0 t=2.6e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=3 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=4 t=7.5e-03 per=1.8e+01 cost=1.8e+02 flops=2.4e+04
 renorm[gemm] counter=17 i=5 t=7.6e-03 per=1.9e+01 cost=4.6e+02 flops=6.0e+04
 renorm[gemm] counter=17 i=6 t=7.4e-03 per=1.8e+01 cost=6.9e+02 flops=9.3e+04
 renorm[gemm] counter=17 total t=2.3e-02 per=5.5e+01 cost=1.3e+03 flops=5.9e+04
 renorm[red] counter=17 t=9.9e-03 per=2.4e+01 cost=4.2e+02 flops=4.2e+04
----- TIMING FOR renorm_tot : t_inter=9.3e-02 t_gemm=3.6e-01 t_reduction=1.6e-01 tot=6.2e-01 -----
 renorm_tot[inter] counter=17 t=9.3e-02 per=1.5e+01 cost=5.2e+05 flops=5.6e+06
 renorm_tot[gemm] counter=17 i=0 t=2.8e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=2.3e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=2.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=3 t=2.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=4 t=1.2e-01 per=2.0e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=17 i=5 t=1.2e-01 per=2.0e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=17 i=6 t=1.2e-01 per=2.0e+01 cost=1.4e+06 flops=1.2e+07
 renorm_tot[gemm] counter=17 total t=3.6e-01 per=5.9e+01 cost=1.9e+06 flops=5.3e+06
 renorm_tot[red] counter=17 t=1.6e-01 per=2.6e+01 cost=6.5e+05 flops=4.1e+06
qops.to_cpu: size(tot)=75:5.7e-04MB:5.6e-07GB T(to_cpu)=1.2e-04S speed=4.6e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.0504 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.502e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.078e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.353e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 3.655e-01 S #####
 T(local opt: fetch) = 1.160e-02 S  per = 3.17  per(accum) = 3.17
 T(local opt: hdiag) = 4.215e-02 S  per = 11.5  per(accum) = 14.7
 T(local opt: dvdsn) = 2.504e-01 S  per = 68.5  per(accum) = 83.2
 T(local opt: decim) = 9.546e-03 S  per = 2.61  per(accum) = 85.8
 T(local opt: guess) = 6.057e-05 S  per = 0.0166  per(accum) = 85.8
 T(local opt: renrm) = 5.162e-02 S  per = 14.1  per(accum) = 99.9
 T(local opt: save ) = 2.086e-04 S  per = 0.0571  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.504e-01 S  T(sum) = 2.502e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 7.019e-05 S  per = 0.028  per(accum) = 0.028
 T(local opt: symbolic_formulae           ) = 2.798e-03 S  per = 1.12  per(accum) = 1.15
 T(local opt: hintermediate init          ) = 9.488e-05 S  per = 0.0379  per(accum) = 1.18
 T(local opt: preprocess_hformulae_Hxlist ) = 7.061e-04 S  per = 0.282  per(accum) = 1.47
 T(local opt: hmmtasks init               ) = 7.936e-04 S  per = 0.317  per(accum) = 1.78
 T(local opt: initial guess for dvdson    ) = 2.504e-06 S  per = 0.001  per(accum) = 1.78
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.091e-01 S  per = 83.6  per(accum) = 85.4
 T(local opt: dvdson [cpu-gpu]            ) = 3.902e-03 S  per = 1.56  per(accum) = 86.9
 T(local opt: dvdson [nccl]               ) = 1.881e-05 S  per = 0.00752  per(accum) = 86.9
 T(local opt: dvdson [mpi]                ) = 4.290e-07 S  per = 0.000171  per(accum) = 86.9
 T(local opt: dvdson [rest part(linalg)]  ) = 3.272e-02 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 5.162e-02 S  T(sum) = 5.162e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.014e-05 S  per = 0.136  per(accum) = 0.136
 T(local opt: qops init                    ) = 6.294e-04 S  per = 1.22  per(accum) = 1.36
 T(local opt: symbolic_formulae_renorm     ) = 3.342e-03 S  per = 6.47  per(accum) = 7.83
 T(local opt: allocate qops on gpu         ) = 5.246e-05 S  per = 0.102  per(accum) = 7.93
 T(local opt: site memcpy cpu2gpu          ) = 1.125e-03 S  per = 2.18  per(accum) = 10.1
 T(local opt: rintermediate init           ) = 2.534e-03 S  per = 4.91  per(accum) = 15
 T(local opt: preprocess_formulae_Rlist2   ) = 8.266e-04 S  per =  1.6  per(accum) = 16.6
 T(local opt: rmmtasks init                ) = 7.876e-04 S  per = 1.53  per(accum) = 18.1
 T(local opt: qops memset on cpu           ) = 3.600e-08 S  per = 6.97e-05  per(accum) = 18.1
 T(local opt: preprocess_renorm_batchGPU   ) = 4.090e-02 S  per = 79.2  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 3.835e-05 S  per = 0.0743  per(accum) = 97.4
 T(local opt: construct opS [ifdists=true] ) = 6.400e-08 S  per = 0.000124  per(accum) = 97.4
 T(local opt: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 6.2e-05  per(accum) = 97.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.273e-04 S  per = 0.247  per(accum) = 97.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.869e-05 S  per = 0.0362  per(accum) = 97.7
 T(local opt: qops_pool join and erase     ) = 1.173e-03 S  per = 2.27  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.432e-06 S  per = 0.00277  per(accum) = 100
##### sweep opt: 9.971e+00 S #####
 T(sweep opt: fetch) = 2.147e-01 S  per = 2.15  per(accum) = 2.15
 T(sweep opt: hdiag) = 2.977e+00 S  per = 29.9  per(accum) = 32
 T(sweep opt: dvdsn) = 5.379e+00 S  per = 53.9  per(accum) = 86
 T(sweep opt: decim) = 1.871e-01 S  per = 1.88  per(accum) = 87.8
 T(sweep opt: guess) = 1.652e-03 S  per = 0.0166  per(accum) = 87.9
 T(sweep opt: renrm) = 1.207e+00 S  per = 12.1  per(accum) = 100
 T(sweep opt: save ) = 4.217e-03 S  per = 0.0423  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.379e+00 S  T(sum) = 5.374e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 1.656e-03 S  per = 0.0308  per(accum) = 0.0308
 T(sweep opt: symbolic_formulae           ) = 2.153e-01 S  per = 4.01  per(accum) = 4.04
 T(sweep opt: hintermediate init          ) = 5.613e-03 S  per = 0.104  per(accum) = 4.14
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.789e-02 S  per = 1.26  per(accum) = 5.41
 T(sweep opt: hmmtasks init               ) = 1.298e-01 S  per = 2.41  per(accum) = 7.82
 T(sweep opt: initial guess for dvdson    ) = 5.064e-05 S  per = 0.000942  per(accum) = 7.82
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.084e+00 S  per =   76  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.015e-01 S  per = 1.89  per(accum) = 85.7
 T(sweep opt: dvdson [nccl]               ) = 4.873e-04 S  per = 0.00907  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 9.569e-06 S  per = 0.000178  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.675e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.207e+00 S  T(sum) = 1.207e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.241e-03 S  per = 0.186  per(accum) = 0.186
 T(sweep opt: qops init                    ) = 3.125e-02 S  per = 2.59  per(accum) = 2.77
 T(sweep opt: symbolic_formulae_renorm     ) = 2.354e-01 S  per = 19.5  per(accum) = 22.3
 T(sweep opt: allocate qops on gpu         ) = 1.010e-03 S  per = 0.0837  per(accum) = 22.4
 T(sweep opt: site memcpy cpu2gpu          ) = 2.264e-02 S  per = 1.88  per(accum) = 24.2
 T(sweep opt: rintermediate init           ) = 4.021e-02 S  per = 3.33  per(accum) = 27.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.018e-02 S  per = 5.81  per(accum) = 33.4
 T(sweep opt: rmmtasks init                ) = 1.291e-01 S  per = 10.7  per(accum) = 44.1
 T(sweep opt: qops memset on cpu           ) = 7.070e-07 S  per = 5.86e-05  per(accum) = 44.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.207e-01 S  per = 51.4  per(accum) = 95.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.329e-03 S  per = 0.11  per(accum) = 95.6
 T(sweep opt: construct opS [ifdists=true] ) = 1.017e-06 S  per = 8.42e-05  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [nccl]) = 7.110e-07 S  per = 5.89e-05  per(accum) = 95.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.432e-03 S  per = 0.284  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.272e-04 S  per = 0.0271  per(accum) = 95.9
 T(sweep opt: qops_pool join and erase     ) = 2.447e-02 S  per = 2.03  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.06  per(accum) = 100
##### global opt: 9.971e+00 S #####
 T(global opt: fetch) = 2.147e-01 S  per = 2.15  per(accum) = 2.15
 T(global opt: hdiag) = 2.977e+00 S  per = 29.9  per(accum) = 32
 T(global opt: dvdsn) = 5.379e+00 S  per = 53.9  per(accum) = 86
 T(global opt: decim) = 1.871e-01 S  per = 1.88  per(accum) = 87.8
 T(global opt: guess) = 1.652e-03 S  per = 0.0166  per(accum) = 87.9
 T(global opt: renrm) = 1.207e+00 S  per = 12.1  per(accum) = 100
 T(global opt: save ) = 4.217e-03 S  per = 0.0423  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.379e+00 S  T(sum) = 5.374e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 1.656e-03 S  per = 0.0308  per(accum) = 0.0308
 T(global opt: symbolic_formulae           ) = 2.153e-01 S  per = 4.01  per(accum) = 4.04
 T(global opt: hintermediate init          ) = 5.613e-03 S  per = 0.104  per(accum) = 4.14
 T(global opt: preprocess_hformulae_Hxlist ) = 6.789e-02 S  per = 1.26  per(accum) = 5.41
 T(global opt: hmmtasks init               ) = 1.298e-01 S  per = 2.41  per(accum) = 7.82
 T(global opt: initial guess for dvdson    ) = 5.064e-05 S  per = 0.000942  per(accum) = 7.82
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.084e+00 S  per =   76  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.015e-01 S  per = 1.89  per(accum) = 85.7
 T(global opt: dvdson [nccl]               ) = 4.873e-04 S  per = 0.00907  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 9.569e-06 S  per = 0.000178  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 7.675e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.207e+00 S  T(sum) = 1.207e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.241e-03 S  per = 0.186  per(accum) = 0.186
 T(global opt: qops init                    ) = 3.125e-02 S  per = 2.59  per(accum) = 2.77
 T(global opt: symbolic_formulae_renorm     ) = 2.354e-01 S  per = 19.5  per(accum) = 22.3
 T(global opt: allocate qops on gpu         ) = 1.010e-03 S  per = 0.0837  per(accum) = 22.4
 T(global opt: site memcpy cpu2gpu          ) = 2.264e-02 S  per = 1.88  per(accum) = 24.2
 T(global opt: rintermediate init           ) = 4.021e-02 S  per = 3.33  per(accum) = 27.6
 T(global opt: preprocess_formulae_Rlist2   ) = 7.018e-02 S  per = 5.81  per(accum) = 33.4
 T(global opt: rmmtasks init                ) = 1.291e-01 S  per = 10.7  per(accum) = 44.1
 T(global opt: qops memset on cpu           ) = 7.070e-07 S  per = 5.86e-05  per(accum) = 44.1
 T(global opt: preprocess_renorm_batchGPU   ) = 6.207e-01 S  per = 51.4  per(accum) = 95.5
 T(global opt: deallocate cpu and gpu memory) = 1.329e-03 S  per = 0.11  per(accum) = 95.6
 T(global opt: construct opS [ifdists=true] ) = 1.017e-06 S  per = 8.42e-05  per(accum) = 95.6
 T(global opt: reduction of opS & opH [nccl]) = 7.110e-07 S  per = 5.89e-05  per(accum) = 95.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.432e-03 S  per = 0.284  per(accum) = 95.9
 T(global opt: reduction of opS & opH [mpi] ) = 3.272e-04 S  per = 0.0271  per(accum) = 95.9
 T(global opt: qops_pool join and erase     ) = 2.447e-02 S  per = 2.03  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 2.484e-02 S  per = 2.06  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.837e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=17/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=5:3.815e-05MB:3.725e-08GB
total mem of comb=769:5.867e-03MB:5.729e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=18,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19
 suppr= 15
 suppc= 14
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=75:5.722e-04MB:5.588e-07GB
        per(mem): H:6.67 C:48 S:5.33 P:0 Q:40 
 rqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4747:0.0362MB:3.54e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.749e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.872e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,4,4) nnz=5:3.815e-05MB
qtensor3: wf3 own=1 _data=0x3a9d6060
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (27,1):2 (28,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=32 size=5:3.815e-05MB
### DIAG TIMING: total=2.248e-02 t1=2.652e-05, t2=2.214e-03, t3=2.549e-03, t4=1.767e-02, t5=4.864e-06, t6=1.371e-05, t7=3.746e-06
duration_diagGPU:2.249e-02
duration_diagreduce:4.100e-08
duration_diagtransform:1.800e-07
----- TIMING FOR symbolic_formulae_onedot with size=123 : 1.327e-03 S -----
rank=0 GPUmem(GB): used=3.537e-05 (oper)=3.537e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=123
 no. of hintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.123e-05 S -----
rank=0 GPUmem(GB): used=3.805e-05 (oper,hinter)=3.537e-05,2.682e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.409e-04 S size(H_formulae)=123 size(Hxlst2)=3 T(Hmu/Hxlist)=2.328e-04,2.081e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.664e-04 S size(H_formulae)=123 size(Hxlst)=142 -----
rank=0 GPUmem(GB): used=3.805e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=7.451e-08 batch[need]=7.406e-06 blksize=2 blksize0=2 batchsize=142
rank=0 GPUmem(GB): used=4.553e-05 (oper,hinter,dvdson,batch)=3.537e-05,2.682e-06,7.451e-08,7.406e-06
ctns::pdvdsonSolver_nkr::solve_iter ndim=5 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.418e-03,1.008e-02,2.986e-02,1.259e-02,5.495e-02
 analyze_tgpu[Hx]: ndim=5:3.725e-08GB T(cpu-gpu)=2.414e-03 speed=3.087e-05GB/S T(nccl)=4.503e-06 speed=1.655e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=80 t=1.0e-02 per=1.9e+01 cost=7.2e+02 flops=7.1e+04
 sigma[gemm] counter=80 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=7.6e-03 per=1.4e+01 cost=1.2e+02 flops=1.6e+04
 sigma[gemm] counter=80 i=3 t=7.4e-03 per=1.4e+01 cost=1.5e+02 flops=2.0e+04
 sigma[gemm] counter=80 i=4 t=7.4e-03 per=1.4e+01 cost=2.6e+02 flops=3.5e+04
 sigma[gemm] counter=80 i=5 t=7.4e-03 per=1.4e+01 cost=2.6e+02 flops=3.5e+04
 sigma[gemm] counter=80 total t=3.0e-02 per=5.7e+01 cost=7.9e+02 flops=2.6e+04
 sigma[red] counter=80 t=1.3e-02 per=2.4e+01 cost=4.5e+02 flops=3.6e+04
----- TIMING FOR sigma_tot : t_inter=7.8e-01 t_gemm=2.4e+00 t_reduction=9.8e-01 tot=4.1e+00 -----
 sigma_tot[inter] counter=80 t=7.8e-01 per=1.9e+01 cost=2.5e+06 flops=3.2e+06
 sigma_tot[gemm] counter=80 i=0 t=1.7e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=80 i=3 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=80 i=4 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=80 i=5 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=80 total t=2.4e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=80 t=9.8e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.1e-06,1.9e-06,6.9e-07,1.5e-07
settings: ndim=5 neig=1 maxcycle=30 nbuff=4 memory=6e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.314230523770 -1.116e+03  6.544e-06    1     1  5.505e-02 5.505e-02 5.503e-02
TIMING FOR Davidson : 5.508e-02  T(cal/comm/rest)=5.503e-02,9.700e-08,4.489e-05
decomposed t_rest=4.489e-05
 T(sub)    =9.235e-06 per=2.057e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.150e-07 per=7.017e-01
 T(xnrm2)  =3.450e-07 per=7.686e-01
 T(other)  =3.499e-05 per=7.796e+01
optimized energies: isweep=0 ibond=17 dots=1 e[0]=-116.314230523770 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.145e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=0 mpisize=1
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 1.1e-04 S T(wf/decim)=5.0e-05,6.0e-05 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1352:1.0e-02MB:1.0e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.333e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.363e-03 S -----
rank=0 GPUmem(GB): used=4.756e-05 (oper)=4.488e-05
rank=0 GPUmem(GB): used=4.783e-05 (oper,site)=4.488e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=4.783e-05 (oper,site,rinter)=4.488e-05,2.682e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.526e-03 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=6.244e-04,1.902e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.819e-03 S size(rtasks)=57 size(Rlst)=1620 -----
rank=0 GPUmem(GB): used=4.783e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.983e-04 blksize=16 blksize0=0 batchsize=1620
rank=0 GPUmem(GB): used=4.461e-04 (oper,site,rinter,batch)=4.488e-05,2.682e-07,0.000e+00,3.983e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.584e-06,2.121e-02,1.018e-02
----- TIMING FOR renorm : t_inter=8.3e-06 t_gemm=2.1e-02 t_reduction=1.0e-02 tot=3.1e-02 -----
 renorm[inter] counter=18 t=8.3e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=1.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=6.2e-03 per=2.0e+01 cost=2.5e+03 flops=4.0e+05
 renorm[gemm] counter=18 i=3 t=7.5e-03 per=2.4e+01 cost=3.6e+03 flops=4.9e+05
 renorm[gemm] counter=18 i=4 t=1.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.1e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=7.5e-03 per=2.4e+01 cost=1.9e+04 flops=2.5e+06
 renorm[gemm] counter=18 total t=2.1e-02 per=6.8e+01 cost=2.5e+04 flops=1.2e+06
 renorm[red] counter=18 t=1.0e-02 per=3.2e+01 cost=1.9e+04 flops=1.8e+06
----- TIMING FOR renorm_tot : t_inter=9.3e-02 t_gemm=3.9e-01 t_reduction=1.7e-01 tot=6.5e-01 -----
 renorm_tot[inter] counter=18 t=9.3e-02 per=1.4e+01 cost=5.2e+05 flops=5.6e+06
 renorm_tot[gemm] counter=18 i=0 t=3.0e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.4e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=6.2e-03 per=9.6e-01 cost=2.5e+03 flops=3.9e+05
 renorm_tot[gemm] counter=18 i=3 t=7.5e-03 per=1.2e+00 cost=3.6e+03 flops=4.9e+05
 renorm_tot[gemm] counter=18 i=4 t=1.2e-01 per=1.9e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=18 i=5 t=1.2e-01 per=1.9e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=18 i=6 t=1.3e-01 per=2.0e+01 cost=1.4e+06 flops=1.1e+07
 renorm_tot[gemm] counter=18 total t=3.9e-01 per=5.9e+01 cost=1.9e+06 flops=5.0e+06
 renorm_tot[red] counter=18 t=1.7e-01 per=2.6e+01 cost=6.7e+05 flops=3.9e+06
qops.to_cpu: size(tot)=1352:1.0e-02MB:1.0e-05GB T(to_cpu)=6.8e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.0479 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=4.597e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.808e-03 change=-2.196e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.808e-03 change=-1.550e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.499e-01 S #####
 T(local opt: fetch) = 1.925e-02 S  per = 12.8  per(accum) = 12.8
 T(local opt: hdiag) = 2.253e-02 S  per =   15  per(accum) = 27.9
 T(local opt: dvdsn) = 5.774e-02 S  per = 38.5  per(accum) = 66.4
 T(local opt: decim) = 1.176e-04 S  per = 0.0784  per(accum) = 66.5
 T(local opt: guess) = 6.585e-05 S  per = 0.0439  per(accum) = 66.5
 T(local opt: renrm) = 5.002e-02 S  per = 33.4  per(accum) = 99.9
 T(local opt: save ) = 1.930e-04 S  per = 0.129  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.774e-02 S  T(sum) = 5.760e-02 S  per = 9.976e+01
 T(local opt: preprocess                  ) = 9.034e-05 S  per = 0.157  per(accum) = 0.157
 T(local opt: symbolic_formulae           ) = 1.335e-03 S  per = 2.32  per(accum) = 2.47
 T(local opt: hintermediate init          ) = 7.378e-05 S  per = 0.128  per(accum) = 2.6
 T(local opt: preprocess_hformulae_Hxlist ) = 4.735e-04 S  per = 0.822  per(accum) = 3.42
 T(local opt: hmmtasks init               ) = 5.484e-04 S  per = 0.952  per(accum) = 4.38
 T(local opt: initial guess for dvdson    ) = 2.383e-06 S  per = 0.00414  per(accum) = 4.38
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.261e-02 S  per = 91.3  per(accum) = 95.7
 T(local opt: dvdson [cpu-gpu]            ) = 2.414e-03 S  per = 4.19  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 4.503e-06 S  per = 0.00782  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 9.700e-08 S  per = 0.000168  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.489e-05 S  per = 0.0779  per(accum) = 100
Detailed decomposition of T(renrm) = 5.002e-02 S  T(sum) = 5.002e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.486e-05 S  per = 0.13  per(accum) = 0.13
 T(local opt: qops init                    ) = 7.274e-04 S  per = 1.45  per(accum) = 1.58
 T(local opt: symbolic_formulae_renorm     ) = 1.387e-03 S  per = 2.77  per(accum) = 4.36
 T(local opt: allocate qops on gpu         ) = 5.162e-05 S  per = 0.103  per(accum) = 4.46
 T(local opt: site memcpy cpu2gpu          ) = 1.924e-03 S  per = 3.85  per(accum) = 8.31
 T(local opt: rintermediate init           ) = 2.601e-05 S  per = 0.052  per(accum) = 8.36
 T(local opt: preprocess_formulae_Rlist2   ) = 2.870e-03 S  per = 5.74  per(accum) = 14.1
 T(local opt: rmmtasks init                ) = 9.291e-03 S  per = 18.6  per(accum) = 32.7
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 5.8e-05  per(accum) = 32.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.148e-02 S  per = 62.9  per(accum) = 95.6
 T(local opt: deallocate cpu and gpu memory) = 7.132e-05 S  per = 0.143  per(accum) = 95.8
 T(local opt: construct opS [ifdists=true] ) = 3.900e-08 S  per = 7.8e-05  per(accum) = 95.8
 T(local opt: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 6e-05  per(accum) = 95.8
 T(local opt: qops memcpy gpu2cpu          ) = 7.459e-05 S  per = 0.149  per(accum) = 95.9
 T(local opt: reduction of opS & opH [mpi] ) = 2.412e-05 S  per = 0.0482  per(accum) = 96
 T(local opt: qops_pool join and erase     ) = 2.022e-03 S  per = 4.04  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.553e-06 S  per = 0.0031  per(accum) = 100
##### sweep opt: 1.012e+01 S #####
 T(sweep opt: fetch) = 2.340e-01 S  per = 2.31  per(accum) = 2.31
 T(sweep opt: hdiag) = 3.000e+00 S  per = 29.6  per(accum) = 32
 T(sweep opt: dvdsn) = 5.437e+00 S  per = 53.7  per(accum) = 85.7
 T(sweep opt: decim) = 1.872e-01 S  per = 1.85  per(accum) = 87.5
 T(sweep opt: guess) = 1.718e-03 S  per = 0.017  per(accum) = 87.5
 T(sweep opt: renrm) = 1.257e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 4.410e-03 S  per = 0.0436  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.437e+00 S  T(sum) = 5.432e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.746e-03 S  per = 0.0321  per(accum) = 0.0321
 T(sweep opt: symbolic_formulae           ) = 2.167e-01 S  per = 3.99  per(accum) = 4.02
 T(sweep opt: hintermediate init          ) = 5.687e-03 S  per = 0.105  per(accum) = 4.13
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.836e-02 S  per = 1.26  per(accum) = 5.38
 T(sweep opt: hmmtasks init               ) = 1.303e-01 S  per =  2.4  per(accum) = 7.78
 T(sweep opt: initial guess for dvdson    ) = 5.302e-05 S  per = 0.000976  per(accum) = 7.78
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.137e+00 S  per = 76.2  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.039e-01 S  per = 1.91  per(accum) = 85.9
 T(sweep opt: dvdson [nccl]               ) = 4.918e-04 S  per = 0.00906  per(accum) = 85.9
 T(sweep opt: dvdson [mpi]                ) = 9.666e-06 S  per = 0.000178  per(accum) = 85.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.676e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.257e+00 S  T(sum) = 1.257e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.306e-03 S  per = 0.183  per(accum) = 0.183
 T(sweep opt: qops init                    ) = 3.198e-02 S  per = 2.54  per(accum) = 2.73
 T(sweep opt: symbolic_formulae_renorm     ) = 2.368e-01 S  per = 18.8  per(accum) = 21.6
 T(sweep opt: allocate qops on gpu         ) = 1.062e-03 S  per = 0.0845  per(accum) = 21.6
 T(sweep opt: site memcpy cpu2gpu          ) = 2.456e-02 S  per = 1.95  per(accum) = 23.6
 T(sweep opt: rintermediate init           ) = 4.023e-02 S  per =  3.2  per(accum) = 26.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.305e-02 S  per = 5.81  per(accum) = 32.6
 T(sweep opt: rmmtasks init                ) = 1.384e-01 S  per =   11  per(accum) = 43.6
 T(sweep opt: qops memset on cpu           ) = 7.360e-07 S  per = 5.85e-05  per(accum) = 43.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.522e-01 S  per = 51.9  per(accum) = 95.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.400e-03 S  per = 0.111  per(accum) = 95.6
 T(sweep opt: construct opS [ifdists=true] ) = 1.056e-06 S  per = 8.4e-05  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [nccl]) = 7.410e-07 S  per = 5.89e-05  per(accum) = 95.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.506e-03 S  per = 0.279  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.513e-04 S  per = 0.0279  per(accum) = 95.9
 T(sweep opt: qops_pool join and erase     ) = 2.650e-02 S  per = 2.11  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.98  per(accum) = 100
##### global opt: 1.012e+01 S #####
 T(global opt: fetch) = 2.340e-01 S  per = 2.31  per(accum) = 2.31
 T(global opt: hdiag) = 3.000e+00 S  per = 29.6  per(accum) = 32
 T(global opt: dvdsn) = 5.437e+00 S  per = 53.7  per(accum) = 85.7
 T(global opt: decim) = 1.872e-01 S  per = 1.85  per(accum) = 87.5
 T(global opt: guess) = 1.718e-03 S  per = 0.017  per(accum) = 87.5
 T(global opt: renrm) = 1.257e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 4.410e-03 S  per = 0.0436  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.437e+00 S  T(sum) = 5.432e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.746e-03 S  per = 0.0321  per(accum) = 0.0321
 T(global opt: symbolic_formulae           ) = 2.167e-01 S  per = 3.99  per(accum) = 4.02
 T(global opt: hintermediate init          ) = 5.687e-03 S  per = 0.105  per(accum) = 4.13
 T(global opt: preprocess_hformulae_Hxlist ) = 6.836e-02 S  per = 1.26  per(accum) = 5.38
 T(global opt: hmmtasks init               ) = 1.303e-01 S  per =  2.4  per(accum) = 7.78
 T(global opt: initial guess for dvdson    ) = 5.302e-05 S  per = 0.000976  per(accum) = 7.78
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.137e+00 S  per = 76.2  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.039e-01 S  per = 1.91  per(accum) = 85.9
 T(global opt: dvdson [nccl]               ) = 4.918e-04 S  per = 0.00906  per(accum) = 85.9
 T(global opt: dvdson [mpi]                ) = 9.666e-06 S  per = 0.000178  per(accum) = 85.9
 T(global opt: dvdson [rest part(linalg)]  ) = 7.676e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.257e+00 S  T(sum) = 1.257e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.306e-03 S  per = 0.183  per(accum) = 0.183
 T(global opt: qops init                    ) = 3.198e-02 S  per = 2.54  per(accum) = 2.73
 T(global opt: symbolic_formulae_renorm     ) = 2.368e-01 S  per = 18.8  per(accum) = 21.6
 T(global opt: allocate qops on gpu         ) = 1.062e-03 S  per = 0.0845  per(accum) = 21.6
 T(global opt: site memcpy cpu2gpu          ) = 2.456e-02 S  per = 1.95  per(accum) = 23.6
 T(global opt: rintermediate init           ) = 4.023e-02 S  per =  3.2  per(accum) = 26.8
 T(global opt: preprocess_formulae_Rlist2   ) = 7.305e-02 S  per = 5.81  per(accum) = 32.6
 T(global opt: rmmtasks init                ) = 1.384e-01 S  per =   11  per(accum) = 43.6
 T(global opt: qops memset on cpu           ) = 7.360e-07 S  per = 5.85e-05  per(accum) = 43.6
 T(global opt: preprocess_renorm_batchGPU   ) = 6.522e-01 S  per = 51.9  per(accum) = 95.5
 T(global opt: deallocate cpu and gpu memory) = 1.400e-03 S  per = 0.111  per(accum) = 95.6
 T(global opt: construct opS [ifdists=true] ) = 1.056e-06 S  per = 8.4e-05  per(accum) = 95.6
 T(global opt: reduction of opS & opH [nccl]) = 7.410e-07 S  per = 5.89e-05  per(accum) = 95.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.506e-03 S  per = 0.279  per(accum) = 95.9
 T(global opt: reduction of opS & opH [mpi] ) = 3.513e-04 S  per = 0.0279  per(accum) = 95.9
 T(global opt: qops_pool join and erase     ) = 2.650e-02 S  per = 2.11  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.98  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.109e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=18/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=747:5.699e-03MB:5.566e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=7:5.341e-05MB:5.215e-08GB
total mem of comb=802:6.119e-03MB:5.975e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=105:8.011e-04MB:7.823e-07GB
        per(mem): H:4.76 C:32.4 S:5.71 P:0 Q:57.1 
 rqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1352:0.0103MB:1.01e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3793:0.0289MB:2.83e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.096e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.768e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,16,4) nnz=7:5.341e-05MB
qtensor3: wf3 own=1 _data=0x3aaaafc0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (26,2):2 (27,3):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=72 size=7:5.341e-05MB
### DIAG TIMING: total=3.105e-02 t1=2.179e-05, t2=2.212e-03, t3=2.493e-03, t4=2.630e-02, t5=4.485e-06, t6=1.399e-05, t7=3.344e-06
duration_diagGPU:3.106e-02
duration_diagreduce:5.800e-08
duration_diagtransform:2.060e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 2.929e-03 S -----
rank=0 GPUmem(GB): used=2.826e-05 (oper)=2.826e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.608e-05 S -----
rank=0 GPUmem(GB): used=3.561e-05 (oper,hinter)=2.826e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.288e-04 S size(H_formulae)=193 size(Hxlst2)=3 T(Hmu/Hxlist)=3.999e-04,3.289e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.513e-04 S size(H_formulae)=193 size(Hxlst)=210 -----
rank=0 GPUmem(GB): used=3.561e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.043e-07 batch[need]=1.721e-05 blksize=4 blksize0=2 batchsize=210
rank=0 GPUmem(GB): used=5.292e-05 (oper,hinter,dvdson,batch)=2.826e-05,7.346e-06,1.043e-07,1.721e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=7 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.522e-03,1.009e-02,2.989e-02,1.248e-02,5.499e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=2.518e-03 speed=4.143e-05GB/S T(nccl)=4.392e-06 speed=2.375e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=81 t=1.0e-02 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=81 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+02 flops=6.1e+04
 sigma[gemm] counter=81 i=3 t=7.4e-03 per=1.4e+01 cost=5.1e+02 flops=6.9e+04
 sigma[gemm] counter=81 i=4 t=7.5e-03 per=1.4e+01 cost=5.3e+02 flops=7.1e+04
 sigma[gemm] counter=81 i=5 t=7.4e-03 per=1.4e+01 cost=4.4e+02 flops=6.0e+04
 sigma[gemm] counter=81 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.5e+04
 sigma[red] counter=81 t=1.2e-02 per=2.4e+01 cost=9.1e+02 flops=7.3e+04
----- TIMING FOR sigma_tot : t_inter=7.9e-01 t_gemm=2.4e+00 t_reduction=9.9e-01 tot=4.2e+00 -----
 sigma_tot[inter] counter=81 t=7.9e-01 per=1.9e+01 cost=2.5e+06 flops=3.2e+06
 sigma_tot[gemm] counter=81 i=0 t=1.7e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=81 i=3 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=81 i=4 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=81 i=5 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=81 total t=2.4e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=81 t=9.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=9.0e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.9e-06,1.9e-06,6.3e-07,1.5e-07
settings: ndim=7 neig=1 maxcycle=30 nbuff=4 memory=8e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.314230523770 -1.116e+03  7.518e-06    1     1  5.510e-02 5.510e-02 5.508e-02
TIMING FOR Davidson : 5.512e-02  T(cal/comm/rest)=5.508e-02,8.400e-08,4.451e-05
decomposed t_rest=4.451e-05
 T(sub)    =8.975e-06 per=2.016e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.990e-07 per=6.718e-01
 T(xnrm2)  =4.240e-07 per=9.526e-01
 T(other)  =3.481e-05 per=7.821e+01
optimized energies: isweep=0 ibond=18 dots=1 e[0]=-116.314230523770 nmvp=1
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.900e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=0 mpisize=1
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 1.9e-04 S T(wf/decim)=7.5e-05,1.2e-04 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=21970:1.7e-01MB:1.6e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.972e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.010e-03 S -----
rank=0 GPUmem(GB): used=1.985e-04 (oper)=1.912e-04
rank=0 GPUmem(GB): used=2.015e-04 (oper,site)=1.912e-04,2.980e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:5.684e-03MB:5.551e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.452e-03 S -----
rank=0 GPUmem(GB): used=2.070e-04 (oper,site,rinter)=1.912e-04,2.980e-06,5.551e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.325e-03 S size(rtasks)=77 size(Rlst2)=256 T(Rmu/Rlist)=1.129e-03,7.196e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.247e-03 S size(rtasks)=77 size(Rlst)=6692 -----
rank=0 GPUmem(GB): used=2.070e-04 avail=6.176e+00 total=6.176e+00 batch[need]=8.925e-03 blksize=81 blksize0=16 batchsize=6692
rank=0 GPUmem(GB): used=9.132e-03 (oper,site,rinter,batch)=1.912e-04,2.980e-06,5.551e-06,8.925e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.887e-03,2.300e-02,1.023e-02
----- TIMING FOR renorm : t_inter=6.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=19 t=6.9e-03 per=1.7e+01 cost=8.5e+04 flops=1.2e+07
 renorm[gemm] counter=19 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=7.6e-03 per=1.9e+01 cost=1.8e+05 flops=2.3e+07
 renorm[gemm] counter=19 i=3 t=7.7e-03 per=1.9e+01 cost=1.5e+05 flops=1.9e+07
 renorm[gemm] counter=19 i=4 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=7.7e-03 per=1.9e+01 cost=1.2e+06 flops=1.5e+08
 renorm[gemm] counter=19 total t=2.3e-02 per=5.7e+01 cost=1.5e+06 flops=6.6e+07
 renorm[red] counter=19 t=1.0e-02 per=2.5e+01 cost=5.3e+05 flops=5.2e+07
----- TIMING FOR renorm_tot : t_inter=1.0e-01 t_gemm=4.1e-01 t_reduction=1.8e-01 tot=6.9e-01 -----
 renorm_tot[inter] counter=19 t=1.0e-01 per=1.5e+01 cost=6.1e+05 flops=6.1e+06
 renorm_tot[gemm] counter=19 i=0 t=3.1e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.5e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=1.4e-02 per=2.0e+00 cost=1.8e+05 flops=1.3e+07
 renorm_tot[gemm] counter=19 i=3 t=1.5e-02 per=2.2e+00 cost=1.5e+05 flops=1.0e+07
 renorm_tot[gemm] counter=19 i=4 t=1.2e-01 per=1.8e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=19 i=5 t=1.2e-01 per=1.8e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=19 i=6 t=1.4e-01 per=2.0e+01 cost=2.6e+06 flops=1.9e+07
 renorm_tot[gemm] counter=19 total t=4.1e-01 per=5.9e+01 cost=3.4e+06 flops=8.4e+06
 renorm_tot[red] counter=19 t=1.8e-01 per=2.6e+01 cost=1.2e+06 flops=6.7e+06
qops.to_cpu: size(tot)=21970:1.7e-01MB:1.6e-04GB T(to_cpu)=1.3e-04S speed=1.2e+00GB/S
check ||H-H.dagger||=1.127e-16 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.107 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.907e-03 change=1.858e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.357e-03 change=-2.683e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.357e-03 change=-6.437e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.102e-01 S #####
 T(local opt: fetch) = 9.848e-03 S  per = 4.68  per(accum) = 4.68
 T(local opt: hdiag) = 3.109e-02 S  per = 14.8  per(accum) = 19.5
 T(local opt: dvdsn) = 5.999e-02 S  per = 28.5  per(accum) = 48
 T(local opt: decim) = 1.970e-04 S  per = 0.0937  per(accum) = 48.1
 T(local opt: guess) = 1.104e-04 S  per = 0.0525  per(accum) = 48.2
 T(local opt: renrm) = 1.087e-01 S  per = 51.7  per(accum) = 99.8
 T(local opt: save ) = 3.198e-04 S  per = 0.152  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.999e-02 S  T(sum) = 5.985e-02 S  per = 9.978e+01
 T(local opt: preprocess                  ) = 1.363e-04 S  per = 0.228  per(accum) = 0.228
 T(local opt: symbolic_formulae           ) = 2.938e-03 S  per = 4.91  per(accum) = 5.14
 T(local opt: hintermediate init          ) = 9.909e-05 S  per = 0.166  per(accum) = 5.3
 T(local opt: preprocess_hformulae_Hxlist ) = 7.602e-04 S  per = 1.27  per(accum) = 6.57
 T(local opt: hmmtasks init               ) = 7.964e-04 S  per = 1.33  per(accum) = 7.9
 T(local opt: initial guess for dvdson    ) = 2.472e-06 S  per = 0.00413  per(accum) = 7.91
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.255e-02 S  per = 87.8  per(accum) = 95.7
 T(local opt: dvdson [cpu-gpu]            ) = 2.518e-03 S  per = 4.21  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 4.392e-06 S  per = 0.00734  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 8.400e-08 S  per = 0.00014  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.451e-05 S  per = 0.0744  per(accum) = 100
Detailed decomposition of T(renrm) = 1.087e-01 S  T(sum) = 1.087e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.366e-04 S  per = 0.126  per(accum) = 0.126
 T(local opt: qops init                    ) = 1.891e-03 S  per = 1.74  per(accum) = 1.87
 T(local opt: symbolic_formulae_renorm     ) = 3.020e-03 S  per = 2.78  per(accum) = 4.64
 T(local opt: allocate qops on gpu         ) = 4.580e-05 S  per = 0.0421  per(accum) = 4.69
 T(local opt: site memcpy cpu2gpu          ) = 9.956e-04 S  per = 0.916  per(accum) = 5.6
 T(local opt: rintermediate init           ) = 2.460e-03 S  per = 2.26  per(accum) = 7.87
 T(local opt: preprocess_formulae_Rlist2   ) = 9.467e-03 S  per = 8.71  per(accum) = 16.6
 T(local opt: rmmtasks init                ) = 4.821e-02 S  per = 44.4  per(accum) = 60.9
 T(local opt: qops memset on cpu           ) = 4.900e-08 S  per = 4.51e-05  per(accum) = 60.9
 T(local opt: preprocess_renorm_batchGPU   ) = 4.021e-02 S  per =   37  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 9.115e-04 S  per = 0.839  per(accum) = 98.8
 T(local opt: construct opS [ifdists=true] ) = 8.400e-08 S  per = 7.73e-05  per(accum) = 98.8
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 3.31e-05  per(accum) = 98.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.507e-04 S  per = 0.139  per(accum) = 98.9
 T(local opt: reduction of opS & opH [mpi] ) = 6.043e-05 S  per = 0.0556  per(accum) = 99
 T(local opt: qops_pool join and erase     ) = 1.117e-03 S  per = 1.03  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.515e-06 S  per = 0.00139  per(accum) = 100
##### sweep opt: 1.033e+01 S #####
 T(sweep opt: fetch) = 2.438e-01 S  per = 2.36  per(accum) = 2.36
 T(sweep opt: hdiag) = 3.031e+00 S  per = 29.3  per(accum) = 31.7
 T(sweep opt: dvdsn) = 5.497e+00 S  per = 53.2  per(accum) = 84.9
 T(sweep opt: decim) = 1.874e-01 S  per = 1.81  per(accum) = 86.7
 T(sweep opt: guess) = 1.828e-03 S  per = 0.0177  per(accum) = 86.7
 T(sweep opt: renrm) = 1.366e+00 S  per = 13.2  per(accum) = 100
 T(sweep opt: save ) = 4.729e-03 S  per = 0.0458  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.497e+00 S  T(sum) = 5.491e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.882e-03 S  per = 0.0343  per(accum) = 0.0343
 T(sweep opt: symbolic_formulae           ) = 2.196e-01 S  per =    4  per(accum) = 4.03
 T(sweep opt: hintermediate init          ) = 5.786e-03 S  per = 0.105  per(accum) = 4.14
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.912e-02 S  per = 1.26  per(accum) = 5.4
 T(sweep opt: hmmtasks init               ) = 1.311e-01 S  per = 2.39  per(accum) = 7.79
 T(sweep opt: initial guess for dvdson    ) = 5.550e-05 S  per = 0.00101  per(accum) = 7.79
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.189e+00 S  per = 76.3  per(accum) = 84.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.064e-01 S  per = 1.94  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 4.962e-04 S  per = 0.00904  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 9.750e-06 S  per = 0.000178  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.676e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.366e+00 S  T(sum) = 1.366e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.443e-03 S  per = 0.179  per(accum) = 0.179
 T(sweep opt: qops init                    ) = 3.387e-02 S  per = 2.48  per(accum) = 2.66
 T(sweep opt: symbolic_formulae_renorm     ) = 2.399e-01 S  per = 17.6  per(accum) = 20.2
 T(sweep opt: allocate qops on gpu         ) = 1.108e-03 S  per = 0.0811  per(accum) = 20.3
 T(sweep opt: site memcpy cpu2gpu          ) = 2.556e-02 S  per = 1.87  per(accum) = 22.2
 T(sweep opt: rintermediate init           ) = 4.269e-02 S  per = 3.13  per(accum) = 25.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.252e-02 S  per = 6.04  per(accum) = 31.3
 T(sweep opt: rmmtasks init                ) = 1.866e-01 S  per = 13.7  per(accum) = 45
 T(sweep opt: qops memset on cpu           ) = 7.850e-07 S  per = 5.75e-05  per(accum) = 45
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.924e-01 S  per = 50.7  per(accum) = 95.7
 T(sweep opt: deallocate cpu and gpu memory) = 2.312e-03 S  per = 0.169  per(accum) = 95.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.140e-06 S  per = 8.35e-05  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [nccl]) = 7.770e-07 S  per = 5.69e-05  per(accum) = 95.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.657e-03 S  per = 0.268  per(accum) = 96.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.117e-04 S  per = 0.0301  per(accum) = 96.2
 T(sweep opt: qops_pool join and erase     ) = 2.761e-02 S  per = 2.02  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.82  per(accum) = 100
##### global opt: 1.033e+01 S #####
 T(global opt: fetch) = 2.438e-01 S  per = 2.36  per(accum) = 2.36
 T(global opt: hdiag) = 3.031e+00 S  per = 29.3  per(accum) = 31.7
 T(global opt: dvdsn) = 5.497e+00 S  per = 53.2  per(accum) = 84.9
 T(global opt: decim) = 1.874e-01 S  per = 1.81  per(accum) = 86.7
 T(global opt: guess) = 1.828e-03 S  per = 0.0177  per(accum) = 86.7
 T(global opt: renrm) = 1.366e+00 S  per = 13.2  per(accum) = 100
 T(global opt: save ) = 4.729e-03 S  per = 0.0458  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.497e+00 S  T(sum) = 5.491e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.882e-03 S  per = 0.0343  per(accum) = 0.0343
 T(global opt: symbolic_formulae           ) = 2.196e-01 S  per =    4  per(accum) = 4.03
 T(global opt: hintermediate init          ) = 5.786e-03 S  per = 0.105  per(accum) = 4.14
 T(global opt: preprocess_hformulae_Hxlist ) = 6.912e-02 S  per = 1.26  per(accum) = 5.4
 T(global opt: hmmtasks init               ) = 1.311e-01 S  per = 2.39  per(accum) = 7.79
 T(global opt: initial guess for dvdson    ) = 5.550e-05 S  per = 0.00101  per(accum) = 7.79
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.189e+00 S  per = 76.3  per(accum) = 84.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.064e-01 S  per = 1.94  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 4.962e-04 S  per = 0.00904  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 9.750e-06 S  per = 0.000178  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 7.676e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.366e+00 S  T(sum) = 1.366e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.443e-03 S  per = 0.179  per(accum) = 0.179
 T(global opt: qops init                    ) = 3.387e-02 S  per = 2.48  per(accum) = 2.66
 T(global opt: symbolic_formulae_renorm     ) = 2.399e-01 S  per = 17.6  per(accum) = 20.2
 T(global opt: allocate qops on gpu         ) = 1.108e-03 S  per = 0.0811  per(accum) = 20.3
 T(global opt: site memcpy cpu2gpu          ) = 2.556e-02 S  per = 1.87  per(accum) = 22.2
 T(global opt: rintermediate init           ) = 4.269e-02 S  per = 3.13  per(accum) = 25.3
 T(global opt: preprocess_formulae_Rlist2   ) = 8.252e-02 S  per = 6.04  per(accum) = 31.3
 T(global opt: rmmtasks init                ) = 1.866e-01 S  per = 13.7  per(accum) = 45
 T(global opt: qops memset on cpu           ) = 7.850e-07 S  per = 5.75e-05  per(accum) = 45
 T(global opt: preprocess_renorm_batchGPU   ) = 6.924e-01 S  per = 50.7  per(accum) = 95.7
 T(global opt: deallocate cpu and gpu memory) = 2.312e-03 S  per = 0.169  per(accum) = 95.9
 T(global opt: construct opS [ifdists=true] ) = 1.140e-06 S  per = 8.35e-05  per(accum) = 95.9
 T(global opt: reduction of opS & opH [nccl]) = 7.770e-07 S  per = 5.69e-05  per(accum) = 95.9
 T(global opt: qops memcpy gpu2cpu          ) = 3.657e-03 S  per = 0.268  per(accum) = 96.1
 T(global opt: reduction of opS & opH [mpi] ) = 4.117e-04 S  per = 0.0301  per(accum) = 96.2
 T(global opt: qops_pool join and erase     ) = 2.761e-02 S  per = 2.02  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.82  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.909e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=19/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1140:8.698e-03MB:8.494e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=1202:9.171e-03MB:8.956e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 rqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:0.00305MB size(tot)=21970:0.168MB:0.000164GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=24451:0.187MB:0.000182GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,64,4) nnz=14:1.068e-04MB
qtensor3: wf3 own=1 _data=0x4678eb60
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (25,3):2 (24,2):1
 qbond: qcol nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=128 size=14:1.068e-04MB
### DIAG TIMING: total=1.350e-02 t1=3.852e-05, t2=1.596e-03, t3=5.581e-04, t4=1.127e-02, t5=4.914e-06, t6=2.124e-05, t7=4.137e-06
duration_diagGPU:1.351e-02
duration_diagreduce:4.100e-08
duration_diagtransform:3.820e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 4.972e-03 S -----
rank=0 GPUmem(GB): used=1.822e-04 (oper)=1.822e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.257e-04 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper,hinter)=1.822e-04,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.237e-03 S size(H_formulae)=297 size(Hxlst2)=4 T(Hmu/Hxlist)=6.231e-04,6.135e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.319e-03 S size(H_formulae)=297 size(Hxlst)=438 -----
rank=0 GPUmem(GB): used=1.958e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.086e-07 batch[need]=4.895e-05 blksize=6 blksize0=2 batchsize=438
rank=0 GPUmem(GB): used=2.449e-04 (oper,hinter,dvdson,batch)=1.822e-04,1.359e-05,2.086e-07,4.895e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=14 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.119e-03,9.948e-03,2.966e-02,1.246e-02,5.319e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.114e-03 speed=1.872e-04GB/S T(nccl)=4.999e-06 speed=4.173e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=82 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=82 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=82 i=3 t=7.4e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=82 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=82 i=5 t=7.4e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=82 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=82 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.0e-01 t_gemm=2.4e+00 t_reduction=1.0e+00 tot=4.2e+00 -----
 sigma_tot[inter] counter=82 t=8.0e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=82 i=0 t=1.7e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=82 i=3 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=82 i=4 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=82 i=5 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=82 total t=2.4e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=82 t=1.0e+00 per=2.4e+01 cost=1.1e+06 flops=1.1e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,7.4e-06,2.0e-06,1.5e-06,1.9e-07
settings: ndim=14 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.314230523770 -1.116e+03  5.832e-02    1     1  5.332e-02 5.332e-02 5.328e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.004e-03,9.917e-03,2.965e-02,1.236e-02,5.395e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.998e-03 speed=1.044e-04GB/S T(nccl)=5.686e-06 speed=3.669e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=83 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=83 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=83 i=3 t=7.4e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=83 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=83 i=5 t=7.4e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=83 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=83 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.1e-01 t_gemm=2.5e+00 t_reduction=1.0e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=83 t=8.1e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=83 i=0 t=1.7e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=83 i=3 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=83 i=4 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=83 i=5 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=83 total t=2.5e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=83 t=1.0e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,3.9e-05,3.7e-06,1.1e-06,2.2e-07
    2   0 -    -116.321452777886 -7.222e-03  1.088e-02    2     2  1.203e-01 6.016e-02 5.366e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.010e-03,1.001e-02,3.004e-02,1.231e-02,5.439e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.003e-03 speed=1.041e-04GB/S T(nccl)=6.491e-06 speed=3.214e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=84 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=84 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=84 i=3 t=7.6e-03 per=1.4e+01 cost=3.5e+03 flops=4.6e+05
 sigma[gemm] counter=84 i=4 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=84 i=5 t=7.4e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=84 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=84 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.2e-01 t_gemm=2.5e+00 t_reduction=1.0e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=84 t=8.2e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=84 i=0 t=1.7e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=84 i=3 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=84 i=4 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=84 i=5 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=84 total t=2.5e+00 per=5.7e+01 cost=4.3e+06 flops=1.7e+06
 sigma_tot[red] counter=84 t=1.0e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,2.4e-05,1.3e-05,1.1e-06,2.3e-07
    3   0 -    -116.321975705786 -5.229e-04  2.987e-03    3     3  1.877e-01 6.257e-02 5.394e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.855e-04,9.950e-03,2.999e-02,1.248e-02,5.282e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=3.795e-04 speed=5.497e-04GB/S T(nccl)=6.002e-06 speed=3.476e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=85 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=85 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=85 i=3 t=7.5e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=85 i=4 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=85 i=5 t=7.6e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=85 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=85 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.3e-01 t_gemm=2.5e+00 t_reduction=1.0e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=85 t=8.3e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=85 i=0 t=1.7e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=85 i=3 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=85 i=4 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=85 i=5 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=85 total t=2.5e+00 per=5.7e+01 cost=4.3e+06 flops=1.7e+06
 sigma_tot[red] counter=85 t=1.0e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.5e-05,5.5e-06,9.7e-07,2.2e-07
    4   0 -    -116.322003027943 -2.732e-05  5.455e-04    3     4  2.531e-01 6.327e-02 5.368e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.890e-03,9.948e-03,2.984e-02,1.263e-02,5.431e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.884e-03 speed=1.107e-04GB/S T(nccl)=5.892e-06 speed=3.541e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=86 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=86 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=86 i=3 t=7.4e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=86 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=86 i=5 t=7.5e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=86 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=86 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.5e+05
----- TIMING FOR sigma_tot : t_inter=8.4e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=86 t=8.4e-01 per=1.9e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=86 i=0 t=1.7e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=86 i=3 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=86 i=4 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=86 i=5 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=86 total t=2.5e+00 per=5.7e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=86 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.5e-05,3.2e-06,9.4e-07,2.3e-07
    5   0 -    -116.322004221593 -1.194e-06  1.622e-04    3     5  3.206e-01 6.412e-02 5.383e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.651e-04,1.001e-02,2.987e-02,1.251e-02,5.277e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=3.590e-04 speed=5.811e-04GB/S T(nccl)=6.061e-06 speed=3.442e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=87 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=87 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=87 i=3 t=7.4e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=87 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=87 i=5 t=7.6e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=87 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=87 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.5e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=87 t=8.5e-01 per=1.9e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=87 i=0 t=1.8e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=1.5e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=87 i=3 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=87 i=4 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=87 i=5 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=87 total t=2.6e+00 per=5.7e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=87 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.5e-05,3.0e-06,1.1e-06,2.4e-07
    6   0 +    -116.322004322050 -1.005e-07  3.779e-05    3     6  3.860e-01 6.434e-02 5.367e-02
TIMING FOR Davidson : 3.860e-01  T(cal/comm/rest)=3.220e-01,7.020e-07,6.405e-02
decomposed t_rest=6.405e-02
 T(sub)    =2.038e-04 per=3.182e-01
 T(precond)=6.364e-02 per=9.936e+01
 T(ortho)  =5.447e-05 per=8.504e-02
 T(xcopy)  =9.340e-07 per=1.458e-03
 T(xnrm2)  =2.731e-06 per=4.264e-03
 T(other)  =1.477e-04 per=2.307e-01
optimized energies: isweep=0 ibond=19 dots=1 e[0]=-116.322004322050 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.464e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=1.3e-05
timing for compute=1.3e-02
timing for collect=3.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.3e-05,1.3e-02,0.0e+00,4.7e-06,3.3e-05 -----
decimation summary: 256->3 dwt=+0.000e+00 SvN=6.227e-01
 qbond: qkept nsym=2 dimAll=3
 (5,-3):2 (6,-2):1
----- TIMING for decimation_row(nkr): 1.314e-02 S T(decim/select/formRot)=1.291e-02,2.091e-04,2.403e-05 -----
----- TIMING FOR onedot_decimation: 1.329e-02 S T(wf/decim)=1.227e-04,1.317e-02 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.463e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 5.396e-03 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper)=1.822e-04
rank=0 GPUmem(GB): used=1.959e-04 (oper,site)=1.822e-04,1.043e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:1.442e-02MB:1.408e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.483e-03 S -----
rank=0 GPUmem(GB): used=2.099e-04 (oper,site,rinter)=1.822e-04,1.043e-07,1.408e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.117e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.510e-03,6.075e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.162e-03 S size(rtasks)=105 size(Rlst)=267 -----
rank=0 GPUmem(GB): used=2.099e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.376e-05 blksize=6 blksize0=9 batchsize=267
rank=0 GPUmem(GB): used=2.537e-04 (oper,site,rinter,batch)=1.822e-04,1.043e-07,1.408e-05,4.376e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.355e-03,2.240e-02,1.000e-02
----- TIMING FOR renorm : t_inter=6.4e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=20 t=6.4e-03 per=1.6e+01 cost=1.2e+04 flops=1.9e+06
 renorm[gemm] counter=20 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=2 t=7.5e-03 per=1.9e+01 cost=1.3e+03 flops=1.8e+05
 renorm[gemm] counter=20 i=3 t=7.5e-03 per=1.9e+01 cost=2.1e+03 flops=2.8e+05
 renorm[gemm] counter=20 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=6 t=7.4e-03 per=1.9e+01 cost=2.5e+03 flops=3.4e+05
 renorm[gemm] counter=20 total t=2.2e-02 per=5.8e+01 cost=6.0e+03 flops=2.7e+05
 renorm[red] counter=20 t=1.0e-02 per=2.6e+01 cost=1.2e+03 flops=1.2e+05
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.3e-01 t_reduction=1.9e-01 tot=7.3e-01 -----
 renorm_tot[inter] counter=20 t=1.1e-01 per=1.5e+01 cost=6.2e+05 flops=5.8e+06
 renorm_tot[gemm] counter=20 i=0 t=3.2e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=1 t=2.6e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=2 t=2.1e-02 per=2.9e+00 cost=1.8e+05 flops=8.5e+06
 renorm_tot[gemm] counter=20 i=3 t=2.3e-02 per=3.1e+00 cost=1.5e+05 flops=6.8e+06
 renorm_tot[gemm] counter=20 i=4 t=1.2e-01 per=1.7e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=20 i=5 t=1.2e-01 per=1.7e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=20 i=6 t=1.4e-01 per=2.0e+01 cost=2.6e+06 flops=1.8e+07
 renorm_tot[gemm] counter=20 total t=4.3e-01 per=5.9e+01 cost=3.5e+06 flops=8.0e+06
 renorm_tot[red] counter=20 t=1.9e-01 per=2.6e+01 cost=1.2e+06 flops=6.3e+06
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.1e-04S speed=9.6e-03GB/S
check ||H-H.dagger||=6.280e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0527 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.013e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.663e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.125e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.860e-01 S #####
 T(local opt: fetch) = 1.014e-02 S  per = 2.09  per(accum) = 2.09
 T(local opt: hdiag) = 1.355e-02 S  per = 2.79  per(accum) = 4.87
 T(local opt: dvdsn) = 3.947e-01 S  per = 81.2  per(accum) = 86.1
 T(local opt: decim) = 1.330e-02 S  per = 2.74  per(accum) = 88.8
 T(local opt: guess) = 1.617e-04 S  per = 0.0333  per(accum) = 88.9
 T(local opt: renrm) = 5.399e-02 S  per = 11.1  per(accum) = 100
 T(local opt: save ) = 1.889e-04 S  per = 0.0389  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.947e-01 S  T(sum) = 3.945e-01 S  per = 9.996e+01
 T(local opt: preprocess                  ) = 1.970e-04 S  per = 0.0499  per(accum) = 0.0499
 T(local opt: symbolic_formulae           ) = 4.983e-03 S  per = 1.26  per(accum) = 1.31
 T(local opt: hintermediate init          ) = 1.387e-04 S  per = 0.0352  per(accum) = 1.35
 T(local opt: preprocess_hformulae_Hxlist ) = 1.335e-03 S  per = 0.338  per(accum) = 1.69
 T(local opt: hmmtasks init               ) = 1.778e-03 S  per = 0.451  per(accum) = 2.14
 T(local opt: initial guess for dvdson    ) = 5.588e-06 S  per = 0.00142  per(accum) = 2.14
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.142e-01 S  per = 79.7  per(accum) = 81.8
 T(local opt: dvdson [cpu-gpu]            ) = 7.738e-03 S  per = 1.96  per(accum) = 83.8
 T(local opt: dvdson [nccl]               ) = 3.513e-05 S  per = 0.00891  per(accum) = 83.8
 T(local opt: dvdson [mpi]                ) = 7.020e-07 S  per = 0.000178  per(accum) = 83.8
 T(local opt: dvdson [rest part(linalg)]  ) = 6.405e-02 S  per = 16.2  per(accum) = 100
Detailed decomposition of T(renrm) = 5.399e-02 S  T(sum) = 5.399e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.669e-04 S  per = 0.309  per(accum) = 0.309
 T(local opt: qops init                    ) = 9.303e-04 S  per = 1.72  per(accum) = 2.03
 T(local opt: symbolic_formulae_renorm     ) = 5.408e-03 S  per =   10  per(accum) = 12
 T(local opt: allocate qops on gpu         ) = 5.582e-05 S  per = 0.103  per(accum) = 12.2
 T(local opt: site memcpy cpu2gpu          ) = 1.044e-03 S  per = 1.93  per(accum) = 14.1
 T(local opt: rintermediate init           ) = 2.495e-03 S  per = 4.62  per(accum) = 18.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.175e-03 S  per = 4.03  per(accum) = 22.7
 T(local opt: rmmtasks init                ) = 1.611e-03 S  per = 2.98  per(accum) = 25.7
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 6.3e-05  per(accum) = 25.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.885e-02 S  per =   72  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 3.831e-05 S  per = 0.071  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 0.000104  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 7.22e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 1.191e-04 S  per = 0.221  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.566e-05 S  per = 0.029  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.084e-03 S  per = 2.01  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.442e-06 S  per = 0.00267  per(accum) = 100
##### sweep opt: 1.082e+01 S #####
 T(sweep opt: fetch) = 2.540e-01 S  per = 2.35  per(accum) = 2.35
 T(sweep opt: hdiag) = 3.044e+00 S  per = 28.1  per(accum) = 30.5
 T(sweep opt: dvdsn) = 5.891e+00 S  per = 54.5  per(accum) = 85
 T(sweep opt: decim) = 2.007e-01 S  per = 1.86  per(accum) = 86.8
 T(sweep opt: guess) = 1.990e-03 S  per = 0.0184  per(accum) = 86.8
 T(sweep opt: renrm) = 1.420e+00 S  per = 13.1  per(accum) = 100
 T(sweep opt: save ) = 4.918e-03 S  per = 0.0455  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.891e+00 S  T(sum) = 5.886e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.079e-03 S  per = 0.0353  per(accum) = 0.0353
 T(sweep opt: symbolic_formulae           ) = 2.246e-01 S  per = 3.82  per(accum) = 3.85
 T(sweep opt: hintermediate init          ) = 5.925e-03 S  per = 0.101  per(accum) = 3.95
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.046e-02 S  per =  1.2  per(accum) = 5.15
 T(sweep opt: hmmtasks init               ) = 1.329e-01 S  per = 2.26  per(accum) = 7.41
 T(sweep opt: initial guess for dvdson    ) = 6.108e-05 S  per = 0.00104  per(accum) = 7.41
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.504e+00 S  per = 76.5  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.141e-01 S  per = 1.94  per(accum) = 85.9
 T(sweep opt: dvdson [nccl]               ) = 5.314e-04 S  per = 0.00903  per(accum) = 85.9
 T(sweep opt: dvdson [mpi]                ) = 1.045e-05 S  per = 0.000178  per(accum) = 85.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.317e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.420e+00 S  T(sum) = 1.420e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.609e-03 S  per = 0.184  per(accum) = 0.184
 T(sweep opt: qops init                    ) = 3.480e-02 S  per = 2.45  per(accum) = 2.63
 T(sweep opt: symbolic_formulae_renorm     ) = 2.453e-01 S  per = 17.3  per(accum) = 19.9
 T(sweep opt: allocate qops on gpu         ) = 1.164e-03 S  per = 0.082  per(accum) = 20
 T(sweep opt: site memcpy cpu2gpu          ) = 2.660e-02 S  per = 1.87  per(accum) = 21.9
 T(sweep opt: rintermediate init           ) = 4.519e-02 S  per = 3.18  per(accum) = 25
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.469e-02 S  per = 5.96  per(accum) = 31
 T(sweep opt: rmmtasks init                ) = 1.882e-01 S  per = 13.3  per(accum) = 44.3
 T(sweep opt: qops memset on cpu           ) = 8.190e-07 S  per = 5.77e-05  per(accum) = 44.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.312e-01 S  per = 51.5  per(accum) = 95.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.350e-03 S  per = 0.166  per(accum) = 95.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.196e-06 S  per = 8.42e-05  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [nccl]) = 8.160e-07 S  per = 5.75e-05  per(accum) = 95.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.776e-03 S  per = 0.266  per(accum) = 96.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.274e-04 S  per = 0.0301  per(accum) = 96.2
 T(sweep opt: qops_pool join and erase     ) = 2.870e-02 S  per = 2.02  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.75  per(accum) = 100
##### global opt: 1.082e+01 S #####
 T(global opt: fetch) = 2.540e-01 S  per = 2.35  per(accum) = 2.35
 T(global opt: hdiag) = 3.044e+00 S  per = 28.1  per(accum) = 30.5
 T(global opt: dvdsn) = 5.891e+00 S  per = 54.5  per(accum) = 85
 T(global opt: decim) = 2.007e-01 S  per = 1.86  per(accum) = 86.8
 T(global opt: guess) = 1.990e-03 S  per = 0.0184  per(accum) = 86.8
 T(global opt: renrm) = 1.420e+00 S  per = 13.1  per(accum) = 100
 T(global opt: save ) = 4.918e-03 S  per = 0.0455  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.891e+00 S  T(sum) = 5.886e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.079e-03 S  per = 0.0353  per(accum) = 0.0353
 T(global opt: symbolic_formulae           ) = 2.246e-01 S  per = 3.82  per(accum) = 3.85
 T(global opt: hintermediate init          ) = 5.925e-03 S  per = 0.101  per(accum) = 3.95
 T(global opt: preprocess_hformulae_Hxlist ) = 7.046e-02 S  per =  1.2  per(accum) = 5.15
 T(global opt: hmmtasks init               ) = 1.329e-01 S  per = 2.26  per(accum) = 7.41
 T(global opt: initial guess for dvdson    ) = 6.108e-05 S  per = 0.00104  per(accum) = 7.41
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.504e+00 S  per = 76.5  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.141e-01 S  per = 1.94  per(accum) = 85.9
 T(global opt: dvdson [nccl]               ) = 5.314e-04 S  per = 0.00903  per(accum) = 85.9
 T(global opt: dvdson [mpi]                ) = 1.045e-05 S  per = 0.000178  per(accum) = 85.9
 T(global opt: dvdson [rest part(linalg)]  ) = 8.317e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.420e+00 S  T(sum) = 1.420e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.609e-03 S  per = 0.184  per(accum) = 0.184
 T(global opt: qops init                    ) = 3.480e-02 S  per = 2.45  per(accum) = 2.63
 T(global opt: symbolic_formulae_renorm     ) = 2.453e-01 S  per = 17.3  per(accum) = 19.9
 T(global opt: allocate qops on gpu         ) = 1.164e-03 S  per = 0.082  per(accum) = 20
 T(global opt: site memcpy cpu2gpu          ) = 2.660e-02 S  per = 1.87  per(accum) = 21.9
 T(global opt: rintermediate init           ) = 4.519e-02 S  per = 3.18  per(accum) = 25
 T(global opt: preprocess_formulae_Rlist2   ) = 8.469e-02 S  per = 5.96  per(accum) = 31
 T(global opt: rmmtasks init                ) = 1.882e-01 S  per = 13.3  per(accum) = 44.3
 T(global opt: qops memset on cpu           ) = 8.190e-07 S  per = 5.77e-05  per(accum) = 44.3
 T(global opt: preprocess_renorm_batchGPU   ) = 7.312e-01 S  per = 51.5  per(accum) = 95.8
 T(global opt: deallocate cpu and gpu memory) = 2.350e-03 S  per = 0.166  per(accum) = 95.9
 T(global opt: construct opS [ifdists=true] ) = 1.196e-06 S  per = 8.42e-05  per(accum) = 95.9
 T(global opt: reduction of opS & opH [nccl]) = 8.160e-07 S  per = 5.75e-05  per(accum) = 95.9
 T(global opt: qops memcpy gpu2cpu          ) = 3.776e-03 S  per = 0.266  per(accum) = 96.2
 T(global opt: reduction of opS & opH [mpi] ) = 4.274e-04 S  per = 0.0301  per(accum) = 96.2
 T(global opt: qops_pool join and erase     ) = 2.870e-02 S  per = 2.02  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.75  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.402e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=20/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=6:4.578e-05MB:4.470e-08GB
total mem of comb=1200:9.155e-03MB:8.941e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 P:0 Q:96.8 
 rqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2605:0.0199MB:1.94e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.263e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(2,3,4) nnz=6:4.578e-05MB
qtensor3: wf3 own=1 _data=0x4639c900
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=1 dimAll=2
 (23,3):2
 qbond: qcol nsym=2 dimAll=3
 (5,-3):2 (6,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=2 nblocks=8 size=6:4.578e-05MB
### DIAG TIMING: total=9.045e-02 t1=2.363e-05, t2=2.263e-03, t3=2.552e-03, t4=8.558e-02, t5=4.739e-06, t6=1.464e-05, t7=3.631e-06
duration_diagGPU:9.046e-02
duration_diagreduce:6.200e-08
duration_diagtransform:2.660e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 8.024e-03 S -----
rank=0 GPUmem(GB): used=1.941e-05 (oper)=1.941e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.885e-04 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper,hinter)=1.941e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.398e-03 S size(H_formulae)=435 size(Hxlst2)=2 T(Hmu/Hxlist)=1.032e-03,3.660e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.424e-03 S size(H_formulae)=435 size(Hxlst)=196 -----
rank=0 GPUmem(GB): used=4.042e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=8.941e-08 batch[need]=1.314e-05 blksize=4 blksize0=0 batchsize=196
rank=0 GPUmem(GB): used=5.365e-05 (oper,hinter,dvdson,batch)=1.941e-05,2.101e-05,8.941e-08,1.314e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=6 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.524e-03,2.494e-03,2.979e-02,1.231e-02,4.612e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.520e-03 speed=5.883e-05GB/S T(nccl)=4.530e-06 speed=1.974e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=88 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=0 t=1.6e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=1.2e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=88 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=88 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.7e+04
 sigma[gemm] counter=88 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=88 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=1.0e+05
 sigma[red] counter=88 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.6e+04
----- TIMING FOR sigma_tot : t_inter=8.5e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=88 t=8.5e-01 per=1.9e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=88 i=0 t=1.8e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=88 i=3 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=88 i=4 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=88 i=5 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=88 total t=2.6e+00 per=5.7e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=88 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.1e-06,1.9e-06,7.0e-07,2.0e-07
settings: ndim=6 neig=1 maxcycle=30 nbuff=4 memory=7e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322004322050 -1.116e+03  4.334e-03    1     1  4.623e-02 4.623e-02 4.620e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.070e-03,2.488e-03,2.984e-02,1.229e-02,4.570e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.064e-03 speed=8.401e-05GB/S T(nccl)=5.565e-06 speed=1.607e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=89 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=0 t=2.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=1.6e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=89 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=89 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.7e+04
 sigma[gemm] counter=89 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=89 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=89 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.6e+04
----- TIMING FOR sigma_tot : t_inter=8.5e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=89 t=8.5e-01 per=1.9e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=89 i=0 t=1.8e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=89 i=3 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=89 i=4 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=89 i=5 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=89 total t=2.6e+00 per=5.7e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=89 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,3.4e-06,9.4e-07,2.4e-07
    2   0 -    -116.322032794698 -2.847e-05  7.625e-04    2     2  1.038e-01 5.191e-02 4.600e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.056e-03,2.506e-03,3.005e-02,1.259e-02,4.721e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=2.050e-03 speed=4.361e-05GB/S T(nccl)=5.992e-06 speed=1.492e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=4.5e-02 -----
 sigma[inter] counter=90 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=0 t=2.2e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=1.6e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=90 i=3 t=7.4e-03 per=1.6e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=90 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.7e+04
 sigma[gemm] counter=90 i=5 t=7.6e-03 per=1.7e+01 cost=6.1e+02 flops=8.0e+04
 sigma[gemm] counter=90 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=90 t=1.3e-02 per=2.8e+01 cost=1.2e+03 flops=9.4e+04
----- TIMING FOR sigma_tot : t_inter=8.6e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=90 t=8.6e-01 per=1.9e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=90 i=0 t=1.8e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=90 i=3 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=90 i=4 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=90 i=5 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=90 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=90 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.0e-06,8.8e-07,2.4e-07
    3   0 -    -116.322035104158 -2.309e-06  4.652e-04    3     3  1.640e-01 5.468e-02 4.644e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.078e-04,2.447e-03,2.970e-02,1.242e-02,4.518e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=6.016e-04 speed=1.486e-04GB/S T(nccl)=6.182e-06 speed=1.446e-02GB/S
----- TIMING FOR sigma : t_inter=2.4e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=91 t=2.4e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=0 t=2.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=1.5e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=91 i=3 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=91 i=4 t=7.4e-03 per=1.7e+01 cost=5.8e+02 flops=7.8e+04
 sigma[gemm] counter=91 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=91 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=1.0e+05
 sigma[red] counter=91 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.5e+04
----- TIMING FOR sigma_tot : t_inter=8.6e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=91 t=8.6e-01 per=1.8e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=91 i=0 t=1.8e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=91 i=3 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=91 i=4 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=91 i=5 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=91 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=91 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.5e-05,3.1e-06,9.7e-07,2.8e-07
    4   0 +    -116.322036004501 -9.003e-07  5.842e-05    3     4  2.216e-01 5.539e-02 4.615e-02
TIMING FOR Davidson : 2.216e-01  T(cal/comm/rest)=1.846e-01,4.750e-07,3.698e-02
decomposed t_rest=3.698e-02
 T(sub)    =7.703e-05 per=2.083e-01
 T(precond)=3.677e-02 per=9.944e+01
 T(ortho)  =2.242e-05 per=6.062e-02
 T(xcopy)  =6.980e-07 per=1.888e-03
 T(xnrm2)  =1.601e-06 per=4.329e-03
 T(other)  =1.052e-04 per=2.845e-01
optimized energies: isweep=0 ibond=20 dots=1 e[0]=-116.322036004501 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.770e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=6 dimAll=12
 (5,-3):2 (6,-2):3 (7,-3):3 (8,-2):1 (7,-1):1 (6,-4):2
timing for divide=6.4e-06
timing for compute=1.2e-02
timing for collect=3.1e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.4e-06,1.2e-02,0.0e+00,4.4e-06,3.1e-05 -----
decimation summary: 12->2 dwt=+0.000e+00 SvN=4.485e-02
 qbond: qkept nsym=1 dimAll=2
 (7,-3):2
----- TIMING for decimation_row(nkr): 1.216e-02 S T(decim/select/formRot)=1.197e-02,1.708e-04,1.765e-05 -----
----- TIMING FOR onedot_decimation: 1.221e-02 S T(wf/decim)=4.145e-05,1.217e-02 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.920e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 6.880e-03 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper)=1.941e-05
rank=0 GPUmem(GB): used=4.046e-05 (oper,site)=1.941e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:2.237e-02MB:2.185e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.496e-03 S -----
rank=0 GPUmem(GB): used=6.231e-05 (oper,site,rinter)=1.941e-05,4.470e-08,2.185e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.792e-03 S size(rtasks)=141 size(Rlst2)=1 T(Rmu/Rlist)=1.519e-03,2.730e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.813e-03 S size(rtasks)=141 size(Rlst)=77 -----
rank=0 GPUmem(GB): used=6.231e-05 avail=6.176e+00 total=6.176e+00 batch[need]=7.458e-06 blksize=4 blksize0=4 batchsize=77
rank=0 GPUmem(GB): used=6.977e-05 (oper,site,rinter,batch)=1.941e-05,4.470e-08,2.185e-05,7.458e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.683e-03,2.253e-02,9.893e-03
----- TIMING FOR renorm : t_inter=7.7e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=21 t=7.7e-03 per=1.9e+01 cost=1.4e+03 flops=1.9e+05
 renorm[gemm] counter=21 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=2 t=7.6e-03 per=1.9e+01 cost=1.6e+02 flops=2.2e+04
 renorm[gemm] counter=21 i=3 t=7.5e-03 per=1.9e+01 cost=5.3e+02 flops=7.1e+04
 renorm[gemm] counter=21 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=5 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=6 t=7.4e-03 per=1.9e+01 cost=9.6e+02 flops=1.3e+05
 renorm[gemm] counter=21 total t=2.3e-02 per=5.6e+01 cost=1.7e+03 flops=7.3e+04
 renorm[red] counter=21 t=9.9e-03 per=2.5e+01 cost=6.2e+02 flops=6.2e+04
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.5e-01 t_reduction=2.0e-01 tot=7.7e-01 -----
 renorm_tot[inter] counter=21 t=1.1e-01 per=1.5e+01 cost=6.2e+05 flops=5.4e+06
 renorm_tot[gemm] counter=21 i=0 t=3.4e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=1 t=2.7e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=2 t=2.9e-02 per=3.8e+00 cost=1.8e+05 flops=6.3e+06
 renorm_tot[gemm] counter=21 i=3 t=3.0e-02 per=3.9e+00 cost=1.5e+05 flops=5.1e+06
 renorm_tot[gemm] counter=21 i=4 t=1.2e-01 per=1.6e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=21 i=5 t=1.2e-01 per=1.6e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=21 i=6 t=1.5e-01 per=2.0e+01 cost=2.6e+06 flops=1.7e+07
 renorm_tot[gemm] counter=21 total t=4.5e-01 per=5.9e+01 cost=3.5e+06 flops=7.6e+06
 renorm_tot[red] counter=21 t=2.0e-01 per=2.6e+01 cost=1.2e+06 flops=6.0e+06
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB T(to_cpu)=1.4e-04S speed=6.6e-03GB/S
check ||H-H.dagger||=1.256e-15 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.054 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.231e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.291e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.459e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.011e-01 S #####
 T(local opt: fetch) = 1.083e-02 S  per =  2.7  per(accum) = 2.7
 T(local opt: hdiag) = 9.049e-02 S  per = 22.6  per(accum) = 25.3
 T(local opt: dvdsn) = 2.322e-01 S  per = 57.9  per(accum) = 83.2
 T(local opt: decim) = 1.222e-02 S  per = 3.05  per(accum) = 86.2
 T(local opt: guess) = 6.138e-05 S  per = 0.0153  per(accum) = 86.2
 T(local opt: renrm) = 5.510e-02 S  per = 13.7  per(accum) = 100
 T(local opt: save ) = 1.924e-04 S  per = 0.048  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.322e-01 S  T(sum) = 2.320e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 6.734e-05 S  per = 0.029  per(accum) = 0.029
 T(local opt: symbolic_formulae           ) = 8.036e-03 S  per = 3.46  per(accum) = 3.49
 T(local opt: hintermediate init          ) = 2.031e-04 S  per = 0.0875  per(accum) = 3.58
 T(local opt: preprocess_hformulae_Hxlist ) = 1.433e-03 S  per = 0.618  per(accum) = 4.2
 T(local opt: hmmtasks init               ) = 7.224e-04 S  per = 0.311  per(accum) = 4.51
 T(local opt: initial guess for dvdson    ) = 2.448e-06 S  per = 0.00106  per(accum) = 4.51
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.793e-01 S  per = 77.3  per(accum) = 81.8
 T(local opt: dvdson [cpu-gpu]            ) = 5.236e-03 S  per = 2.26  per(accum) = 84.1
 T(local opt: dvdson [nccl]               ) = 2.227e-05 S  per = 0.0096  per(accum) = 84.1
 T(local opt: dvdson [mpi]                ) = 4.750e-07 S  per = 0.000205  per(accum) = 84.1
 T(local opt: dvdson [rest part(linalg)]  ) = 3.698e-02 S  per = 15.9  per(accum) = 100
Detailed decomposition of T(renrm) = 5.510e-02 S  T(sum) = 5.510e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.146e-05 S  per = 0.112  per(accum) = 0.112
 T(local opt: qops init                    ) = 1.072e-03 S  per = 1.95  per(accum) = 2.06
 T(local opt: symbolic_formulae_renorm     ) = 6.893e-03 S  per = 12.5  per(accum) = 14.6
 T(local opt: allocate qops on gpu         ) = 5.681e-05 S  per = 0.103  per(accum) = 14.7
 T(local opt: site memcpy cpu2gpu          ) = 7.612e-04 S  per = 1.38  per(accum) = 16.1
 T(local opt: rintermediate init           ) = 2.508e-03 S  per = 4.55  per(accum) = 20.6
 T(local opt: preprocess_formulae_Rlist2   ) = 1.820e-03 S  per =  3.3  per(accum) = 23.9
 T(local opt: rmmtasks init                ) = 4.596e-04 S  per = 0.834  per(accum) = 24.7
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 6.35e-05  per(accum) = 24.7
 T(local opt: preprocess_renorm_batchGPU   ) = 4.020e-02 S  per =   73  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 2.370e-05 S  per = 0.043  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 6.500e-08 S  per = 0.000118  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 4.000e-08 S  per = 7.26e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.462e-04 S  per = 0.265  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.479e-05 S  per = 0.0268  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.077e-03 S  per = 1.95  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.364e-06 S  per = 0.00248  per(accum) = 100
##### sweep opt: 1.122e+01 S #####
 T(sweep opt: fetch) = 2.648e-01 S  per = 2.36  per(accum) = 2.36
 T(sweep opt: hdiag) = 3.135e+00 S  per = 27.9  per(accum) = 30.3
 T(sweep opt: dvdsn) = 6.124e+00 S  per = 54.6  per(accum) = 84.9
 T(sweep opt: decim) = 2.129e-01 S  per =  1.9  per(accum) = 86.8
 T(sweep opt: guess) = 2.051e-03 S  per = 0.0183  per(accum) = 86.8
 T(sweep opt: renrm) = 1.475e+00 S  per = 13.1  per(accum) = 100
 T(sweep opt: save ) = 5.111e-03 S  per = 0.0456  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.124e+00 S  T(sum) = 6.118e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.147e-03 S  per = 0.0351  per(accum) = 0.0351
 T(sweep opt: symbolic_formulae           ) = 2.326e-01 S  per =  3.8  per(accum) = 3.84
 T(sweep opt: hintermediate init          ) = 6.128e-03 S  per =  0.1  per(accum) = 3.94
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.189e-02 S  per = 1.18  per(accum) = 5.11
 T(sweep opt: hmmtasks init               ) = 1.336e-01 S  per = 2.18  per(accum) = 7.3
 T(sweep opt: initial guess for dvdson    ) = 6.353e-05 S  per = 0.00104  per(accum) = 7.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.683e+00 S  per = 76.5  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.194e-01 S  per = 1.95  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 5.536e-04 S  per = 0.00905  per(accum) = 85.8
 T(sweep opt: dvdson [mpi]                ) = 1.093e-05 S  per = 0.000179  per(accum) = 85.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.687e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.475e+00 S  T(sum) = 1.475e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.671e-03 S  per = 0.181  per(accum) = 0.181
 T(sweep opt: qops init                    ) = 3.587e-02 S  per = 2.43  per(accum) = 2.61
 T(sweep opt: symbolic_formulae_renorm     ) = 2.522e-01 S  per = 17.1  per(accum) = 19.7
 T(sweep opt: allocate qops on gpu         ) = 1.221e-03 S  per = 0.0827  per(accum) = 19.8
 T(sweep opt: site memcpy cpu2gpu          ) = 2.736e-02 S  per = 1.86  per(accum) = 21.6
 T(sweep opt: rintermediate init           ) = 4.770e-02 S  per = 3.23  per(accum) = 24.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.651e-02 S  per = 5.87  per(accum) = 30.7
 T(sweep opt: rmmtasks init                ) = 1.887e-01 S  per = 12.8  per(accum) = 43.5
 T(sweep opt: qops memset on cpu           ) = 8.540e-07 S  per = 5.79e-05  per(accum) = 43.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.714e-01 S  per = 52.3  per(accum) = 95.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.374e-03 S  per = 0.161  per(accum) = 96
 T(sweep opt: construct opS [ifdists=true] ) = 1.261e-06 S  per = 8.55e-05  per(accum) = 96
 T(sweep opt: reduction of opS & opH [nccl]) = 8.560e-07 S  per = 5.8e-05  per(accum) = 96
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.922e-03 S  per = 0.266  per(accum) = 96.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.422e-04 S  per = 0.03  per(accum) = 96.3
 T(sweep opt: qops_pool join and erase     ) = 2.977e-02 S  per = 2.02  per(accum) = 98.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.68  per(accum) = 100
##### global opt: 1.122e+01 S #####
 T(global opt: fetch) = 2.648e-01 S  per = 2.36  per(accum) = 2.36
 T(global opt: hdiag) = 3.135e+00 S  per = 27.9  per(accum) = 30.3
 T(global opt: dvdsn) = 6.124e+00 S  per = 54.6  per(accum) = 84.9
 T(global opt: decim) = 2.129e-01 S  per =  1.9  per(accum) = 86.8
 T(global opt: guess) = 2.051e-03 S  per = 0.0183  per(accum) = 86.8
 T(global opt: renrm) = 1.475e+00 S  per = 13.1  per(accum) = 100
 T(global opt: save ) = 5.111e-03 S  per = 0.0456  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.124e+00 S  T(sum) = 6.118e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.147e-03 S  per = 0.0351  per(accum) = 0.0351
 T(global opt: symbolic_formulae           ) = 2.326e-01 S  per =  3.8  per(accum) = 3.84
 T(global opt: hintermediate init          ) = 6.128e-03 S  per =  0.1  per(accum) = 3.94
 T(global opt: preprocess_hformulae_Hxlist ) = 7.189e-02 S  per = 1.18  per(accum) = 5.11
 T(global opt: hmmtasks init               ) = 1.336e-01 S  per = 2.18  per(accum) = 7.3
 T(global opt: initial guess for dvdson    ) = 6.353e-05 S  per = 0.00104  per(accum) = 7.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.683e+00 S  per = 76.5  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.194e-01 S  per = 1.95  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 5.536e-04 S  per = 0.00905  per(accum) = 85.8
 T(global opt: dvdson [mpi]                ) = 1.093e-05 S  per = 0.000179  per(accum) = 85.8
 T(global opt: dvdson [rest part(linalg)]  ) = 8.687e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.475e+00 S  T(sum) = 1.475e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.671e-03 S  per = 0.181  per(accum) = 0.181
 T(global opt: qops init                    ) = 3.587e-02 S  per = 2.43  per(accum) = 2.61
 T(global opt: symbolic_formulae_renorm     ) = 2.522e-01 S  per = 17.1  per(accum) = 19.7
 T(global opt: allocate qops on gpu         ) = 1.221e-03 S  per = 0.0827  per(accum) = 19.8
 T(global opt: site memcpy cpu2gpu          ) = 2.736e-02 S  per = 1.86  per(accum) = 21.6
 T(global opt: rintermediate init           ) = 4.770e-02 S  per = 3.23  per(accum) = 24.9
 T(global opt: preprocess_formulae_Rlist2   ) = 8.651e-02 S  per = 5.87  per(accum) = 30.7
 T(global opt: rmmtasks init                ) = 1.887e-01 S  per = 12.8  per(accum) = 43.5
 T(global opt: qops memset on cpu           ) = 8.540e-07 S  per = 5.79e-05  per(accum) = 43.5
 T(global opt: preprocess_renorm_batchGPU   ) = 7.714e-01 S  per = 52.3  per(accum) = 95.8
 T(global opt: deallocate cpu and gpu memory) = 2.374e-03 S  per = 0.161  per(accum) = 96
 T(global opt: construct opS [ifdists=true] ) = 1.261e-06 S  per = 8.55e-05  per(accum) = 96
 T(global opt: reduction of opS & opH [nccl]) = 8.560e-07 S  per = 5.8e-05  per(accum) = 96
 T(global opt: qops memcpy gpu2cpu          ) = 3.922e-03 S  per = 0.266  per(accum) = 96.3
 T(global opt: reduction of opS & opH [mpi] ) = 4.422e-04 S  per = 0.03  per(accum) = 96.3
 T(global opt: qops_pool join and erase     ) = 2.977e-02 S  per = 2.02  per(accum) = 98.3
 T(global opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.68  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.779e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=21/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=8:6.104e-05MB:5.960e-08GB
total mem of comb=1202:9.171e-03MB:8.956e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:15 S:6.42 P:0 Q:77 
 rqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2834:0.0216MB:2.11e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.760e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,2,4) nnz=8:6.104e-05MB
qtensor3: wf3 own=1 _data=0x3aee5040
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=4
 (21,3):2 (22,2):1 (22,4):1
 qbond: qcol nsym=1 dimAll=2
 (7,-3):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=12 size=8:6.104e-05MB
### DIAG TIMING: total=1.627e-01 t1=2.814e-05, t2=2.190e-03, t3=2.488e-03, t4=1.580e-01, t5=7.049e-06, t6=1.433e-05, t7=4.552e-06
duration_diagGPU:1.627e-01
duration_diagreduce:4.600e-08
duration_diagtransform:2.730e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.139e-02 S -----
rank=0 GPUmem(GB): used=2.111e-05 (oper)=2.111e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.737e-04 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper,hinter)=2.111e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.465e-03 S size(H_formulae)=607 size(Hxlst2)=3 T(Hmu/Hxlist)=1.508e-03,9.569e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.596e-03 S size(H_formulae)=607 size(Hxlst)=688 -----
rank=0 GPUmem(GB): used=5.032e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.192e-07 batch[need]=5.639e-05 blksize=4 blksize0=2 batchsize=688
rank=0 GPUmem(GB): used=1.068e-04 (oper,hinter,dvdson,batch)=2.111e-05,2.921e-05,1.192e-07,5.639e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=8 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.656e-03,1.011e-02,3.026e-02,1.252e-02,5.456e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.651e-03 speed=7.220e-05GB/S T(nccl)=5.055e-06 speed=2.358e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=92 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=92 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=92 i=3 t=7.7e-03 per=1.4e+01 cost=3.4e+03 flops=4.4e+05
 sigma[gemm] counter=92 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=92 i=5 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=92 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=92 t=1.3e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=8.7e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=92 t=8.7e-01 per=1.8e+01 cost=2.6e+06 flops=2.9e+06
 sigma_tot[gemm] counter=92 i=0 t=1.9e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=92 i=3 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=92 i=4 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=92 i=5 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=92 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=92 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.6e-06,1.9e-06,7.2e-07,2.1e-07
settings: ndim=8 neig=1 maxcycle=30 nbuff=4 memory=9e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322036004501 -1.116e+03  4.577e-04    1     1  5.467e-02 5.467e-02 5.465e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.029e-03,2.967e-03,5.030e-03,3.061e-03,1.210e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.023e-03 speed=1.166e-04GB/S T(nccl)=5.965e-06 speed=1.998e-02GB/S
----- TIMING FOR sigma : t_inter=3.0e-03 t_gemm=5.0e-03 t_reduction=3.1e-03 tot=1.1e-02 -----
 sigma[inter] counter=93 t=3.0e-03 per=2.7e+01 cost=1.3e+04 flops=4.5e+06
 sigma[gemm] counter=93 i=0 t=1.8e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=1.5e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=2.5e-03 per=2.3e+01 cost=3.4e+03 flops=1.3e+06
 sigma[gemm] counter=93 i=3 t=1.2e-03 per=1.0e+01 cost=3.4e+03 flops=2.9e+06
 sigma[gemm] counter=93 i=4 t=1.3e-03 per=1.1e+01 cost=2.0e+03 flops=1.6e+06
 sigma[gemm] counter=93 i=5 t=7.5e-05 per=6.8e-01 cost=2.0e+03 flops=2.7e+07
 sigma[gemm] counter=93 total t=5.0e-03 per=4.5e+01 cost=1.1e+04 flops=2.1e+06
 sigma[red] counter=93 t=3.1e-03 per=2.8e+01 cost=3.9e+03 flops=1.3e+06
----- TIMING FOR sigma_tot : t_inter=8.7e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=93 t=8.7e-01 per=1.8e+01 cost=2.6e+06 flops=2.9e+06
 sigma_tot[gemm] counter=93 i=0 t=1.9e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=93 i=3 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=93 i=4 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=93 i=5 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=93 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=93 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.7e-05,3.8e-06,1.3e-06,3.4e-07
    2   0 -    -116.322036680222 -6.757e-07  1.350e-04    2     2  7.878e-02 3.939e-02 3.343e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.218e-03,1.004e-02,2.986e-02,1.237e-02,5.452e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=2.210e-03 speed=5.394e-05GB/S T(nccl)=7.958e-06 speed=1.498e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=94 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=94 i=0 t=2.3e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=2.0e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=94 i=3 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=94 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=94 i=5 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=94 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=94 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=8.8e-01 t_gemm=2.8e+00 t_reduction=1.1e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=94 t=8.8e-01 per=1.8e+01 cost=2.6e+06 flops=2.9e+06
 sigma_tot[gemm] counter=94 i=0 t=1.9e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=1.7e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=94 i=3 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=94 i=4 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=94 i=5 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=94 total t=2.8e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=94 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,2.0e-05,3.9e-06,1.2e-05,2.8e-07
    3   0 +    -116.322036723062 -4.284e-08  5.976e-05    3     3  1.415e-01 4.717e-02 4.051e-02
TIMING FOR Davidson : 1.415e-01  T(cal/comm/rest)=1.215e-01,4.640e-07,1.999e-02
decomposed t_rest=1.999e-02
 T(sub)    =8.065e-05 per=4.034e-01
 T(precond)=1.980e-02 per=9.905e+01
 T(ortho)  =1.805e-05 per=9.028e-02
 T(xcopy)  =5.670e-07 per=2.836e-03
 T(xnrm2)  =1.469e-06 per=7.347e-03
 T(other)  =9.013e-05 per=4.508e-01
optimized energies: isweep=0 ibond=21 dots=1 e[0]=-116.322036723062 nmvp=3
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=6.065e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=4 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=4 dimAll=8
 (7,-3):2 (9,-3):2 (8,-2):2 (8,-4):2
timing for divide=2.1e-05
timing for compute=9.3e-03
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 9.3e-03 S T(divide/compute[cpu/gpu/rest]/collect)=2.1e-05,9.3e-03,0.0e+00,6.5e-06,1.6e-05 -----
decimation summary: 8->4 dwt=+0.000e+00 SvN=3.351e-01
 qbond: qkept nsym=3 dimAll=4
 (9,-3):2 (8,-2):1 (8,-4):1
----- TIMING for decimation_row(nkr): 9.598e-03 S T(decim/select/formRot)=9.379e-03,1.997e-04,1.948e-05 -----
----- TIMING FOR onedot_decimation: 9.668e-03 S T(wf/decim)=5.146e-05,9.616e-03 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.740e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 8.597e-03 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper)=2.111e-05
rank=0 GPUmem(GB): used=5.038e-05 (oper,site)=2.111e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:3.120e-02MB:3.047e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.494e-03 S -----
rank=0 GPUmem(GB): used=8.085e-05 (oper,site,rinter)=2.111e-05,5.960e-08,3.047e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.974e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=1.519e-03,4.548e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.011e-03 S size(rtasks)=185 size(Rlst)=209 -----
rank=0 GPUmem(GB): used=8.085e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.024e-05 blksize=4 blksize0=4 batchsize=209
rank=0 GPUmem(GB): used=1.011e-04 (oper,site,rinter,batch)=2.111e-05,5.960e-08,3.047e-05,2.024e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.770e-03,2.217e-02,9.966e-03
----- TIMING FOR renorm : t_inter=6.8e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=22 t=6.8e-03 per=1.7e+01 cost=1.7e+04 flops=2.6e+06
 renorm[gemm] counter=22 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=2 t=7.4e-03 per=1.9e+01 cost=5.8e+02 flops=7.8e+04
 renorm[gemm] counter=22 i=3 t=7.4e-03 per=1.9e+01 cost=1.5e+03 flops=2.1e+05
 renorm[gemm] counter=22 i=4 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=6 t=7.4e-03 per=1.9e+01 cost=1.7e+03 flops=2.3e+05
 renorm[gemm] counter=22 total t=2.2e-02 per=5.7e+01 cost=3.8e+03 flops=1.7e+05
 renorm[red] counter=22 t=1.0e-02 per=2.6e+01 cost=8.5e+02 flops=8.6e+04
----- TIMING FOR renorm_tot : t_inter=1.2e-01 t_gemm=4.8e-01 t_reduction=2.1e-01 tot=8.1e-01 -----
 renorm_tot[inter] counter=22 t=1.2e-01 per=1.5e+01 cost=6.4e+05 flops=5.3e+06
 renorm_tot[gemm] counter=22 i=0 t=3.5e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=1 t=2.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=2 t=3.6e-02 per=4.5e+00 cost=1.8e+05 flops=5.0e+06
 renorm_tot[gemm] counter=22 i=3 t=3.8e-02 per=4.6e+00 cost=1.6e+05 flops=4.2e+06
 renorm_tot[gemm] counter=22 i=4 t=1.2e-01 per=1.5e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=22 i=5 t=1.2e-01 per=1.5e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=22 i=6 t=1.6e-01 per=2.0e+01 cost=2.6e+06 flops=1.7e+07
 renorm_tot[gemm] counter=22 total t=4.8e-01 per=5.9e+01 cost=3.5e+06 flops=7.3e+06
 renorm_tot[red] counter=22 t=2.1e-01 per=2.6e+01 cost=1.2e+06 flops=5.7e+06
qops.to_cpu: size(tot)=374:2.9e-03MB:2.8e-06GB T(to_cpu)=1.8e-04S speed=1.6e-02GB/S
check ||H-H.dagger||=7.850e-17 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0561 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.412e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.461e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-3.129e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.008e-01 S #####
 T(local opt: fetch) = 1.091e-02 S  per = 2.72  per(accum) = 2.72
 T(local opt: hdiag) = 1.628e-01 S  per = 40.6  per(accum) = 43.3
 T(local opt: dvdsn) = 1.597e-01 S  per = 39.9  per(accum) = 83.2
 T(local opt: decim) = 9.679e-03 S  per = 2.41  per(accum) = 85.6
 T(local opt: guess) = 6.632e-05 S  per = 0.0165  per(accum) = 85.6
 T(local opt: renrm) = 5.742e-02 S  per = 14.3  per(accum) = 100
 T(local opt: save ) = 1.942e-04 S  per = 0.0485  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.597e-01 S  T(sum) = 1.595e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 7.142e-05 S  per = 0.0448  per(accum) = 0.0448
 T(local opt: symbolic_formulae           ) = 1.140e-02 S  per = 7.15  per(accum) = 7.19
 T(local opt: hintermediate init          ) = 2.892e-04 S  per = 0.181  per(accum) = 7.37
 T(local opt: preprocess_hformulae_Hxlist ) = 2.620e-03 S  per = 1.64  per(accum) = 9.02
 T(local opt: hmmtasks init               ) = 3.613e-03 S  per = 2.26  per(accum) = 11.3
 T(local opt: initial guess for dvdson    ) = 3.042e-06 S  per = 0.00191  per(accum) = 11.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.166e-01 S  per = 73.1  per(accum) = 84.4
 T(local opt: dvdson [cpu-gpu]            ) = 4.884e-03 S  per = 3.06  per(accum) = 87.5
 T(local opt: dvdson [nccl]               ) = 1.898e-05 S  per = 0.0119  per(accum) = 87.5
 T(local opt: dvdson [mpi]                ) = 4.640e-07 S  per = 0.000291  per(accum) = 87.5
 T(local opt: dvdson [rest part(linalg)]  ) = 1.999e-02 S  per = 12.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.742e-02 S  T(sum) = 5.742e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.080e-05 S  per = 0.106  per(accum) = 0.106
 T(local opt: qops init                    ) = 1.784e-03 S  per = 3.11  per(accum) = 3.21
 T(local opt: symbolic_formulae_renorm     ) = 8.611e-03 S  per =   15  per(accum) = 18.2
 T(local opt: allocate qops on gpu         ) = 4.898e-05 S  per = 0.0853  per(accum) = 18.3
 T(local opt: site memcpy cpu2gpu          ) = 7.301e-04 S  per = 1.27  per(accum) = 19.6
 T(local opt: rintermediate init           ) = 2.506e-03 S  per = 4.36  per(accum) = 23.9
 T(local opt: preprocess_formulae_Rlist2   ) = 2.021e-03 S  per = 3.52  per(accum) = 27.4
 T(local opt: rmmtasks init                ) = 1.186e-03 S  per = 2.07  per(accum) = 29.5
 T(local opt: qops memset on cpu           ) = 6.100e-08 S  per = 0.000106  per(accum) = 29.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.899e-02 S  per = 67.9  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 2.737e-05 S  per = 0.0477  per(accum) = 97.5
 T(local opt: construct opS [ifdists=true] ) = 4.300e-08 S  per = 7.49e-05  per(accum) = 97.5
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 6.79e-05  per(accum) = 97.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.839e-04 S  per = 0.32  per(accum) = 97.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.653e-05 S  per = 0.0288  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 1.251e-03 S  per = 2.18  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.535e-06 S  per = 0.00267  per(accum) = 100
##### sweep opt: 1.162e+01 S #####
 T(sweep opt: fetch) = 2.757e-01 S  per = 2.37  per(accum) = 2.37
 T(sweep opt: hdiag) = 3.298e+00 S  per = 28.4  per(accum) = 30.8
 T(sweep opt: dvdsn) = 6.283e+00 S  per = 54.1  per(accum) = 84.8
 T(sweep opt: decim) = 2.226e-01 S  per = 1.92  per(accum) = 86.7
 T(sweep opt: guess) = 2.118e-03 S  per = 0.0182  per(accum) = 86.8
 T(sweep opt: renrm) = 1.532e+00 S  per = 13.2  per(accum) = 100
 T(sweep opt: save ) = 5.305e-03 S  per = 0.0457  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.283e+00 S  T(sum) = 6.277e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.218e-03 S  per = 0.0353  per(accum) = 0.0353
 T(sweep opt: symbolic_formulae           ) = 2.440e-01 S  per = 3.89  per(accum) = 3.92
 T(sweep opt: hintermediate init          ) = 6.417e-03 S  per = 0.102  per(accum) = 4.03
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.451e-02 S  per = 1.19  per(accum) = 5.21
 T(sweep opt: hmmtasks init               ) = 1.372e-01 S  per = 2.19  per(accum) = 7.4
 T(sweep opt: initial guess for dvdson    ) = 6.657e-05 S  per = 0.00106  per(accum) = 7.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.799e+00 S  per = 76.5  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.242e-01 S  per = 1.98  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 5.726e-04 S  per = 0.00912  per(accum) = 85.8
 T(sweep opt: dvdson [mpi]                ) = 1.139e-05 S  per = 0.000181  per(accum) = 85.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.886e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.532e+00 S  T(sum) = 1.532e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.732e-03 S  per = 0.178  per(accum) = 0.178
 T(sweep opt: qops init                    ) = 3.766e-02 S  per = 2.46  per(accum) = 2.64
 T(sweep opt: symbolic_formulae_renorm     ) = 2.608e-01 S  per =   17  per(accum) = 19.7
 T(sweep opt: allocate qops on gpu         ) = 1.270e-03 S  per = 0.0828  per(accum) = 19.7
 T(sweep opt: site memcpy cpu2gpu          ) = 2.809e-02 S  per = 1.83  per(accum) = 21.6
 T(sweep opt: rintermediate init           ) = 5.020e-02 S  per = 3.28  per(accum) = 24.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.853e-02 S  per = 5.78  per(accum) = 30.6
 T(sweep opt: rmmtasks init                ) = 1.899e-01 S  per = 12.4  per(accum) = 43
 T(sweep opt: qops memset on cpu           ) = 9.150e-07 S  per = 5.97e-05  per(accum) = 43
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.104e-01 S  per = 52.9  per(accum) = 95.9
 T(sweep opt: deallocate cpu and gpu memory) = 2.401e-03 S  per = 0.157  per(accum) = 96.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.304e-06 S  per = 8.51e-05  per(accum) = 96.1
 T(sweep opt: reduction of opS & opH [nccl]) = 8.950e-07 S  per = 5.84e-05  per(accum) = 96.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.106e-03 S  per = 0.268  per(accum) = 96.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.587e-04 S  per = 0.0299  per(accum) = 96.4
 T(sweep opt: qops_pool join and erase     ) = 3.102e-02 S  per = 2.02  per(accum) = 98.4
 T(sweep opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.62  per(accum) = 100
##### global opt: 1.162e+01 S #####
 T(global opt: fetch) = 2.757e-01 S  per = 2.37  per(accum) = 2.37
 T(global opt: hdiag) = 3.298e+00 S  per = 28.4  per(accum) = 30.8
 T(global opt: dvdsn) = 6.283e+00 S  per = 54.1  per(accum) = 84.8
 T(global opt: decim) = 2.226e-01 S  per = 1.92  per(accum) = 86.7
 T(global opt: guess) = 2.118e-03 S  per = 0.0182  per(accum) = 86.8
 T(global opt: renrm) = 1.532e+00 S  per = 13.2  per(accum) = 100
 T(global opt: save ) = 5.305e-03 S  per = 0.0457  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.283e+00 S  T(sum) = 6.277e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.218e-03 S  per = 0.0353  per(accum) = 0.0353
 T(global opt: symbolic_formulae           ) = 2.440e-01 S  per = 3.89  per(accum) = 3.92
 T(global opt: hintermediate init          ) = 6.417e-03 S  per = 0.102  per(accum) = 4.03
 T(global opt: preprocess_hformulae_Hxlist ) = 7.451e-02 S  per = 1.19  per(accum) = 5.21
 T(global opt: hmmtasks init               ) = 1.372e-01 S  per = 2.19  per(accum) = 7.4
 T(global opt: initial guess for dvdson    ) = 6.657e-05 S  per = 0.00106  per(accum) = 7.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.799e+00 S  per = 76.5  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.242e-01 S  per = 1.98  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 5.726e-04 S  per = 0.00912  per(accum) = 85.8
 T(global opt: dvdson [mpi]                ) = 1.139e-05 S  per = 0.000181  per(accum) = 85.8
 T(global opt: dvdson [rest part(linalg)]  ) = 8.886e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.532e+00 S  T(sum) = 1.532e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.732e-03 S  per = 0.178  per(accum) = 0.178
 T(global opt: qops init                    ) = 3.766e-02 S  per = 2.46  per(accum) = 2.64
 T(global opt: symbolic_formulae_renorm     ) = 2.608e-01 S  per =   17  per(accum) = 19.7
 T(global opt: allocate qops on gpu         ) = 1.270e-03 S  per = 0.0828  per(accum) = 19.7
 T(global opt: site memcpy cpu2gpu          ) = 2.809e-02 S  per = 1.83  per(accum) = 21.6
 T(global opt: rintermediate init           ) = 5.020e-02 S  per = 3.28  per(accum) = 24.8
 T(global opt: preprocess_formulae_Rlist2   ) = 8.853e-02 S  per = 5.78  per(accum) = 30.6
 T(global opt: rmmtasks init                ) = 1.899e-01 S  per = 12.4  per(accum) = 43
 T(global opt: qops memset on cpu           ) = 9.150e-07 S  per = 5.97e-05  per(accum) = 43
 T(global opt: preprocess_renorm_batchGPU   ) = 8.104e-01 S  per = 52.9  per(accum) = 95.9
 T(global opt: deallocate cpu and gpu memory) = 2.401e-03 S  per = 0.157  per(accum) = 96.1
 T(global opt: construct opS [ifdists=true] ) = 1.304e-06 S  per = 8.51e-05  per(accum) = 96.1
 T(global opt: reduction of opS & opH [nccl]) = 8.950e-07 S  per = 5.84e-05  per(accum) = 96.1
 T(global opt: qops memcpy gpu2cpu          ) = 4.106e-03 S  per = 0.268  per(accum) = 96.3
 T(global opt: reduction of opS & opH [mpi] ) = 4.587e-04 S  per = 0.0299  per(accum) = 96.4
 T(global opt: qops_pool join and erase     ) = 3.102e-02 S  per = 2.02  per(accum) = 98.4
 T(global opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.62  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-6.074e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=22/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=1210:9.232e-03MB:9.015e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:10 S:5.38 P:0 Q:83.5 
 rqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3750:0.0286MB:2.79e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.008e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.225e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,4,4) nnz=16:1.221e-04MB
qtensor3: wf3 own=1 _data=0x467b6180
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (20,2):2 (19,3):2 (20,4):2
 qbond: qcol nsym=3 dimAll=4
 (9,-3):2 (8,-2):1 (8,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=16:1.221e-04MB
### DIAG TIMING: total=2.217e-01 t1=2.342e-05, t2=2.181e-03, t3=2.512e-03, t4=2.170e-01, t5=5.656e-06, t6=1.249e-05, t7=3.642e-06
duration_diagGPU:2.217e-01
duration_diagreduce:4.600e-08
duration_diagtransform:3.100e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.493e-02 S -----
rank=0 GPUmem(GB): used=2.794e-05 (oper)=2.794e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.785e-04 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper,hinter)=2.794e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.173e-03 S size(H_formulae)=813 size(Hxlst2)=5 T(Hmu/Hxlist)=2.056e-03,2.117e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.437e-03 S size(H_formulae)=813 size(Hxlst)=1552 -----
rank=0 GPUmem(GB): used=6.571e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.384e-07 batch[need]=1.503e-04 blksize=4 blksize0=4 batchsize=1552
rank=0 GPUmem(GB): used=2.163e-04 (oper,hinter,dvdson,batch)=2.794e-05,3.777e-05,2.384e-07,1.503e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=16 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.980e-03,1.002e-02,3.026e-02,1.246e-02,5.472e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.976e-03 speed=1.207e-04GB/S T(nccl)=4.573e-06 speed=5.214e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=95 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=95 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=95 i=3 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=95 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=9.9e+05
 sigma[gemm] counter=95 i=5 t=7.6e-03 per=1.4e+01 cost=7.1e+03 flops=9.3e+05
 sigma[gemm] counter=95 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=95 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=8.9e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=95 t=8.9e-01 per=1.8e+01 cost=2.6e+06 flops=2.9e+06
 sigma_tot[gemm] counter=95 i=0 t=1.9e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=95 i=3 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=95 i=4 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=95 i=5 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=95 total t=2.8e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=95 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.2e-06,1.9e-06,7.1e-07,1.9e-07
settings: ndim=16 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322036723062 -1.116e+03  5.782e-03    1     1  5.484e-02 5.484e-02 5.481e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.535e-03,1.006e-02,3.031e-02,1.267e-02,5.458e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.529e-03 speed=1.560e-04GB/S T(nccl)=5.795e-06 speed=4.114e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=96 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=96 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=96 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=96 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=96 i=5 t=7.6e-03 per=1.4e+01 cost=7.1e+03 flops=9.4e+05
 sigma[gemm] counter=96 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=96 t=1.3e-02 per=2.4e+01 cost=1.0e+04 flops=8.1e+05
----- TIMING FOR sigma_tot : t_inter=9.0e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.9e+00 -----
 sigma_tot[inter] counter=96 t=9.0e-01 per=1.8e+01 cost=2.7e+06 flops=2.9e+06
 sigma_tot[gemm] counter=96 i=0 t=1.9e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=96 i=3 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=96 i=4 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=96 i=5 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=96 total t=2.8e+00 per=5.8e+01 cost=4.5e+06 flops=1.6e+06
 sigma_tot[red] counter=96 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.2e-05,3.4e-06,8.2e-07,2.2e-07
    2   0 -    -116.322143984300 -1.073e-04  1.939e-03    2     2  1.230e-01 6.149e-02 5.474e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.609e-03,1.003e-02,2.098e-02,3.340e-03,3.597e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.603e-03 speed=1.487e-04GB/S T(nccl)=5.707e-06 speed=4.178e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.1e-02 t_reduction=3.3e-03 tot=3.4e-02 -----
 sigma[inter] counter=97 t=1.0e-02 per=2.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=97 i=0 t=1.8e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=1.5e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=7.5e-03 per=2.2e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=97 i=3 t=7.6e-03 per=2.2e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=97 i=4 t=4.7e-03 per=1.4e+01 cost=7.6e+03 flops=1.6e+06
 sigma[gemm] counter=97 i=5 t=1.1e-03 per=3.3e+00 cost=7.1e+03 flops=6.3e+06
 sigma[gemm] counter=97 total t=2.1e-02 per=6.1e+01 cost=3.1e+04 flops=1.5e+06
 sigma[red] counter=97 t=3.3e-03 per=9.7e+00 cost=1.0e+04 flops=3.1e+06
----- TIMING FOR sigma_tot : t_inter=9.1e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.9e+00 -----
 sigma_tot[inter] counter=97 t=9.1e-01 per=1.9e+01 cost=2.7e+06 flops=3.0e+06
 sigma_tot[gemm] counter=97 i=0 t=2.0e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 i=3 t=7.1e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 i=4 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 i=5 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 total t=2.8e+00 per=5.8e+01 cost=4.5e+06 flops=1.6e+06
 sigma_tot[red] counter=97 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.6e-05,3.1e-06,1.1e-06,2.4e-07
    3   0 -    -116.322160749635 -1.677e-05  6.207e-04    3     3  1.724e-01 5.747e-02 4.852e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.254e-04,9.954e-03,2.977e-02,1.238e-02,5.255e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=4.195e-04 speed=5.683e-04GB/S T(nccl)=5.910e-06 speed=4.034e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=98 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=98 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=98 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=98 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=98 i=5 t=7.4e-03 per=1.4e+01 cost=7.1e+03 flops=9.6e+05
 sigma[gemm] counter=98 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.1e+06
 sigma[red] counter=98 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=9.2e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=5.0e+00 -----
 sigma_tot[inter] counter=98 t=9.2e-01 per=1.9e+01 cost=2.7e+06 flops=3.0e+06
 sigma_tot[gemm] counter=98 i=0 t=2.0e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=7.2e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=98 i=3 t=7.2e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=98 i=4 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=98 i=5 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=98 total t=2.9e+00 per=5.8e+01 cost=4.5e+06 flops=1.6e+06
 sigma_tot[red] counter=98 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.0e-06,9.4e-07,2.0e-07
    4   0 -    -116.322161904565 -1.155e-06  2.090e-04    3     4  2.377e-01 5.941e-02 4.955e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.172e-03,9.956e-03,2.967e-02,1.244e-02,5.425e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=2.167e-03 speed=1.100e-04GB/S T(nccl)=4.479e-06 speed=5.323e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=99 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=99 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=99 i=3 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=99 i=4 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=99 i=5 t=7.4e-03 per=1.4e+01 cost=7.1e+03 flops=9.6e+05
 sigma[gemm] counter=99 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.1e+06
 sigma[red] counter=99 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=9.3e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=5.0e+00 -----
 sigma_tot[inter] counter=99 t=9.3e-01 per=1.9e+01 cost=2.8e+06 flops=3.0e+06
 sigma_tot[gemm] counter=99 i=0 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=7.3e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=99 i=3 t=7.3e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=99 i=4 t=7.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=99 i=5 t=7.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=99 total t=2.9e+00 per=5.8e+01 cost=4.6e+06 flops=1.6e+06
 sigma_tot[red] counter=99 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,2.9e-06,9.1e-07,1.9e-07
    5   0 -    -116.322162086116 -1.816e-07  1.035e-04    3     5  3.026e-01 6.053e-02 5.051e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.220e-04,9.961e-03,3.013e-02,1.234e-02,5.286e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=4.158e-04 speed=5.734e-04GB/S T(nccl)=6.204e-06 speed=3.843e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=100 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=100 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=100 i=3 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=100 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=100 i=5 t=7.5e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=100 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=100 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.4e+05
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=100 t=9.4e-01 per=1.9e+01 cost=2.8e+06 flops=3.0e+06
 sigma_tot[gemm] counter=100 i=0 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=7.3e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=100 i=3 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=100 i=4 t=7.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=100 i=5 t=7.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=100 total t=2.9e+00 per=5.8e+01 cost=4.6e+06 flops=1.6e+06
 sigma_tot[red] counter=100 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,2.9e-06,9.3e-07,2.2e-07
    6   0 +    -116.322162108317 -2.220e-08  1.484e-05    3     6  3.680e-01 6.134e-02 5.091e-02
TIMING FOR Davidson : 3.680e-01  T(cal/comm/rest)=3.055e-01,6.510e-07,6.256e-02
decomposed t_rest=6.256e-02
 T(sub)    =1.234e-04 per=1.972e-01
 T(precond)=6.223e-02 per=9.948e+01
 T(ortho)  =4.698e-05 per=7.509e-02
 T(xcopy)  =7.150e-07 per=1.143e-03
 T(xnrm2)  =2.460e-06 per=3.932e-03
 T(other)  =1.545e-04 per=2.469e-01
optimized energies: isweep=0 ibond=22 dots=1 e[0]=-116.322162108317 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.383e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=8 dimAll=16
 (9,-3):4 (8,-2):1 (8,-4):1 (11,-3):2 (10,-2):3 (10,-4):3 (9,-1):1 (9,-5):1
timing for divide=9.1e-06
timing for compute=1.2e-02
timing for collect=3.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.1e-06,1.2e-02,0.0e+00,4.6e-06,3.4e-05 -----
decimation summary: 16->6 dwt=+0.000e+00 SvN=6.385e-01
 qbond: qkept nsym=3 dimAll=6
 (11,-3):2 (10,-2):2 (10,-4):2
----- TIMING for decimation_row(nkr): 1.227e-02 S T(decim/select/formRot)=1.205e-02,2.006e-04,2.115e-05 -----
----- TIMING FOR onedot_decimation: 1.234e-02 S T(wf/decim)=5.220e-05,1.229e-02 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.238e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 9.918e-03 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper)=2.794e-05
rank=0 GPUmem(GB): used=6.583e-05 (oper,site)=2.794e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:4.051e-02MB:3.956e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.492e-03 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper,site,rinter)=2.794e-05,1.192e-07,3.956e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.456e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=1.555e-03,9.013e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.551e-03 S size(rtasks)=237 size(Rlst)=529 -----
rank=0 GPUmem(GB): used=1.054e-04 avail=6.176e+00 total=6.176e+00 batch[need]=5.124e-05 blksize=4 blksize0=4 batchsize=529
rank=0 GPUmem(GB): used=1.566e-04 (oper,site,rinter,batch)=2.794e-05,1.192e-07,3.956e-05,5.124e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.141e-03,2.282e-02,1.001e-02
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=23 t=6.1e-03 per=1.6e+01 cost=2.5e+04 flops=4.1e+06
 renorm[gemm] counter=23 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=2 t=7.5e-03 per=1.9e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=23 i=3 t=7.6e-03 per=2.0e+01 cost=3.5e+03 flops=4.6e+05
 renorm[gemm] counter=23 i=4 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=6 t=7.6e-03 per=2.0e+01 cost=6.4e+03 flops=8.3e+05
 renorm[gemm] counter=23 total t=2.3e-02 per=5.9e+01 cost=1.1e+04 flops=4.9e+05
 renorm[red] counter=23 t=1.0e-02 per=2.6e+01 cost=4.2e+03 flops=4.2e+05
----- TIMING FOR renorm_tot : t_inter=1.3e-01 t_gemm=5.0e-01 t_reduction=2.2e-01 tot=8.5e-01 -----
 renorm_tot[inter] counter=23 t=1.3e-01 per=1.5e+01 cost=6.6e+05 flops=5.2e+06
 renorm_tot[gemm] counter=23 i=0 t=3.7e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=1 t=3.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=2 t=4.4e-02 per=5.2e+00 cost=1.8e+05 flops=4.2e+06
 renorm_tot[gemm] counter=23 i=3 t=4.5e-02 per=5.3e+00 cost=1.6e+05 flops=3.5e+06
 renorm_tot[gemm] counter=23 i=4 t=1.2e-01 per=1.4e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=23 i=5 t=1.2e-01 per=1.4e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=23 i=6 t=1.7e-01 per=2.0e+01 cost=2.6e+06 flops=1.6e+07
 renorm_tot[gemm] counter=23 total t=5.0e-01 per=5.9e+01 cost=3.5e+06 flops=7.0e+06
 renorm_tot[red] counter=23 t=2.2e-01 per=2.6e+01 cost=1.2e+06 flops=5.5e+06
qops.to_cpu: size(tot)=1040:7.9e-03MB:7.7e-06GB T(to_cpu)=2.2e-04S speed=3.5e-02GB/S
check ||H-H.dagger||=5.027e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0605 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=5.961e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=6.409e-04 change=-1.686e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=6.409e-04 change=-5.662e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.052e-01 S #####
 T(local opt: fetch) = 1.252e-02 S  per = 1.78  per(accum) = 1.78
 T(local opt: hdiag) = 2.218e-01 S  per = 31.4  per(accum) = 33.2
 T(local opt: dvdsn) = 3.965e-01 S  per = 56.2  per(accum) = 89.4
 T(local opt: decim) = 1.235e-02 S  per = 1.75  per(accum) = 91.2
 T(local opt: guess) = 8.184e-05 S  per = 0.0116  per(accum) = 91.2
 T(local opt: renrm) = 6.184e-02 S  per = 8.77  per(accum) = 100
 T(local opt: save ) = 1.968e-04 S  per = 0.0279  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.965e-01 S  T(sum) = 3.963e-01 S  per = 9.995e+01
 T(local opt: preprocess                  ) = 1.034e-04 S  per = 0.0261  per(accum) = 0.0261
 T(local opt: symbolic_formulae           ) = 1.494e-02 S  per = 3.77  per(accum) = 3.8
 T(local opt: hintermediate init          ) = 3.986e-04 S  per = 0.101  per(accum) = 3.9
 T(local opt: preprocess_hformulae_Hxlist ) = 4.485e-03 S  per = 1.13  per(accum) = 5.03
 T(local opt: hmmtasks init               ) = 8.285e-03 S  per = 2.09  per(accum) = 7.12
 T(local opt: initial guess for dvdson    ) = 2.736e-06 S  per = 0.00069  per(accum) = 7.12
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.973e-01 S  per =   75  per(accum) = 82.2
 T(local opt: dvdson [cpu-gpu]            ) = 8.110e-03 S  per = 2.05  per(accum) = 84.2
 T(local opt: dvdson [nccl]               ) = 3.267e-05 S  per = 0.00824  per(accum) = 84.2
 T(local opt: dvdson [mpi]                ) = 6.510e-07 S  per = 0.000164  per(accum) = 84.2
 T(local opt: dvdson [rest part(linalg)]  ) = 6.256e-02 S  per = 15.8  per(accum) = 100
Detailed decomposition of T(renrm) = 6.184e-02 S  T(sum) = 6.184e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.239e-05 S  per = 0.117  per(accum) = 0.117
 T(local opt: qops init                    ) = 1.792e-03 S  per =  2.9  per(accum) = 3.01
 T(local opt: symbolic_formulae_renorm     ) = 9.932e-03 S  per = 16.1  per(accum) = 19.1
 T(local opt: allocate qops on gpu         ) = 5.555e-05 S  per = 0.0898  per(accum) = 19.2
 T(local opt: site memcpy cpu2gpu          ) = 9.328e-04 S  per = 1.51  per(accum) = 20.7
 T(local opt: rintermediate init           ) = 2.503e-03 S  per = 4.05  per(accum) = 24.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.572e-03 S  per = 4.16  per(accum) = 28.9
 T(local opt: rmmtasks init                ) = 3.362e-03 S  per = 5.44  per(accum) = 34.3
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 7.11e-05  per(accum) = 34.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.906e-02 S  per = 63.2  per(accum) = 97.5
 T(local opt: deallocate cpu and gpu memory) = 4.097e-05 S  per = 0.0663  per(accum) = 97.5
 T(local opt: construct opS [ifdists=true] ) = 5.700e-08 S  per = 9.22e-05  per(accum) = 97.5
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 6.14e-05  per(accum) = 97.5
 T(local opt: qops memcpy gpu2cpu          ) = 2.306e-04 S  per = 0.373  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.628e-05 S  per = 0.0263  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 1.277e-03 S  per = 2.06  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.448e-06 S  per = 0.00234  per(accum) = 100
##### sweep opt: 1.232e+01 S #####
 T(sweep opt: fetch) = 2.882e-01 S  per = 2.34  per(accum) = 2.34
 T(sweep opt: hdiag) = 3.519e+00 S  per = 28.6  per(accum) = 30.9
 T(sweep opt: dvdsn) = 6.680e+00 S  per = 54.2  per(accum) = 85.1
 T(sweep opt: decim) = 2.349e-01 S  per = 1.91  per(accum) = 87
 T(sweep opt: guess) = 2.200e-03 S  per = 0.0178  per(accum) = 87
 T(sweep opt: renrm) = 1.594e+00 S  per = 12.9  per(accum) = 100
 T(sweep opt: save ) = 5.502e-03 S  per = 0.0446  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.680e+00 S  T(sum) = 6.674e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.322e-03 S  per = 0.0348  per(accum) = 0.0348
 T(sweep opt: symbolic_formulae           ) = 2.590e-01 S  per = 3.88  per(accum) = 3.92
 T(sweep opt: hintermediate init          ) = 6.816e-03 S  per = 0.102  per(accum) = 4.02
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.900e-02 S  per = 1.18  per(accum) = 5.2
 T(sweep opt: hmmtasks init               ) = 1.455e-01 S  per = 2.18  per(accum) = 7.38
 T(sweep opt: initial guess for dvdson    ) = 6.931e-05 S  per = 0.00104  per(accum) = 7.38
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.097e+00 S  per = 76.4  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.323e-01 S  per = 1.98  per(accum) = 85.7
 T(sweep opt: dvdson [nccl]               ) = 6.053e-04 S  per = 0.00907  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 1.204e-05 S  per = 0.00018  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.512e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.594e+00 S  T(sum) = 1.594e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.804e-03 S  per = 0.176  per(accum) = 0.176
 T(sweep opt: qops init                    ) = 3.945e-02 S  per = 2.47  per(accum) = 2.65
 T(sweep opt: symbolic_formulae_renorm     ) = 2.707e-01 S  per =   17  per(accum) = 19.6
 T(sweep opt: allocate qops on gpu         ) = 1.325e-03 S  per = 0.0831  per(accum) = 19.7
 T(sweep opt: site memcpy cpu2gpu          ) = 2.903e-02 S  per = 1.82  per(accum) = 21.5
 T(sweep opt: rintermediate init           ) = 5.271e-02 S  per = 3.31  per(accum) = 24.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.111e-02 S  per = 5.71  per(accum) = 30.6
 T(sweep opt: rmmtasks init                ) = 1.932e-01 S  per = 12.1  per(accum) = 42.7
 T(sweep opt: qops memset on cpu           ) = 9.590e-07 S  per = 6.02e-05  per(accum) = 42.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.495e-01 S  per = 53.3  per(accum) = 96
 T(sweep opt: deallocate cpu and gpu memory) = 2.442e-03 S  per = 0.153  per(accum) = 96.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.361e-06 S  per = 8.54e-05  per(accum) = 96.1
 T(sweep opt: reduction of opS & opH [nccl]) = 9.330e-07 S  per = 5.85e-05  per(accum) = 96.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.337e-03 S  per = 0.272  per(accum) = 96.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.750e-04 S  per = 0.0298  per(accum) = 96.4
 T(sweep opt: qops_pool join and erase     ) = 3.230e-02 S  per = 2.03  per(accum) = 98.4
 T(sweep opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.56  per(accum) = 100
##### global opt: 1.232e+01 S #####
 T(global opt: fetch) = 2.882e-01 S  per = 2.34  per(accum) = 2.34
 T(global opt: hdiag) = 3.519e+00 S  per = 28.6  per(accum) = 30.9
 T(global opt: dvdsn) = 6.680e+00 S  per = 54.2  per(accum) = 85.1
 T(global opt: decim) = 2.349e-01 S  per = 1.91  per(accum) = 87
 T(global opt: guess) = 2.200e-03 S  per = 0.0178  per(accum) = 87
 T(global opt: renrm) = 1.594e+00 S  per = 12.9  per(accum) = 100
 T(global opt: save ) = 5.502e-03 S  per = 0.0446  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.680e+00 S  T(sum) = 6.674e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.322e-03 S  per = 0.0348  per(accum) = 0.0348
 T(global opt: symbolic_formulae           ) = 2.590e-01 S  per = 3.88  per(accum) = 3.92
 T(global opt: hintermediate init          ) = 6.816e-03 S  per = 0.102  per(accum) = 4.02
 T(global opt: preprocess_hformulae_Hxlist ) = 7.900e-02 S  per = 1.18  per(accum) = 5.2
 T(global opt: hmmtasks init               ) = 1.455e-01 S  per = 2.18  per(accum) = 7.38
 T(global opt: initial guess for dvdson    ) = 6.931e-05 S  per = 0.00104  per(accum) = 7.38
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.097e+00 S  per = 76.4  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.323e-01 S  per = 1.98  per(accum) = 85.7
 T(global opt: dvdson [nccl]               ) = 6.053e-04 S  per = 0.00907  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 1.204e-05 S  per = 0.00018  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 9.512e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.594e+00 S  T(sum) = 1.594e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.804e-03 S  per = 0.176  per(accum) = 0.176
 T(global opt: qops init                    ) = 3.945e-02 S  per = 2.47  per(accum) = 2.65
 T(global opt: symbolic_formulae_renorm     ) = 2.707e-01 S  per =   17  per(accum) = 19.6
 T(global opt: allocate qops on gpu         ) = 1.325e-03 S  per = 0.0831  per(accum) = 19.7
 T(global opt: site memcpy cpu2gpu          ) = 2.903e-02 S  per = 1.82  per(accum) = 21.5
 T(global opt: rintermediate init           ) = 5.271e-02 S  per = 3.31  per(accum) = 24.8
 T(global opt: preprocess_formulae_Rlist2   ) = 9.111e-02 S  per = 5.71  per(accum) = 30.6
 T(global opt: rmmtasks init                ) = 1.932e-01 S  per = 12.1  per(accum) = 42.7
 T(global opt: qops memset on cpu           ) = 9.590e-07 S  per = 6.02e-05  per(accum) = 42.7
 T(global opt: preprocess_renorm_batchGPU   ) = 8.495e-01 S  per = 53.3  per(accum) = 96
 T(global opt: deallocate cpu and gpu memory) = 2.442e-03 S  per = 0.153  per(accum) = 96.1
 T(global opt: construct opS [ifdists=true] ) = 1.361e-06 S  per = 8.54e-05  per(accum) = 96.1
 T(global opt: reduction of opS & opH [nccl]) = 9.330e-07 S  per = 5.85e-05  per(accum) = 96.1
 T(global opt: qops memcpy gpu2cpu          ) = 4.337e-03 S  per = 0.272  per(accum) = 96.4
 T(global opt: reduction of opS & opH [mpi] ) = 4.750e-04 S  per = 0.0298  per(accum) = 96.4
 T(global opt: qops_pool join and erase     ) = 3.230e-02 S  per = 2.03  per(accum) = 98.4
 T(global opt: conversion from opAB to opPQ ) = 2.485e-02 S  per = 1.56  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.390e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=23/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=24:1.831e-04MB:1.788e-07GB
total mem of comb=1218:9.293e-03MB:9.075e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:6.58 S:4.38 P:0 Q:88.1 
 rqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5201:0.0397MB:3.88e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.046e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,6,4) nnz=24:1.831e-04MB
qtensor3: wf3 own=1 _data=0x3b622540
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (18,2):3 (17,3):2 (18,4):2
 qbond: qcol nsym=3 dimAll=6
 (11,-3):2 (10,-2):2 (10,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=24:1.831e-04MB
### DIAG TIMING: total=2.870e-01 t1=2.928e-05, t2=2.183e-03, t3=2.477e-03, t4=2.823e-01, t5=5.177e-06, t6=1.435e-05, t7=3.942e-06
duration_diagGPU:2.870e-01
duration_diagreduce:4.600e-08
duration_diagtransform:5.100e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.904e-02 S -----
rank=0 GPUmem(GB): used=3.875e-05 (oper)=3.875e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.742e-04 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper,hinter)=3.875e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.452e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.710e-03,2.742e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.802e-03 S size(H_formulae)=1053 size(Hxlst)=1986 -----
rank=0 GPUmem(GB): used=8.506e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.576e-07 batch[need]=2.811e-04 blksize=6 blksize0=6 batchsize=1986
rank=0 GPUmem(GB): used=3.666e-04 (oper,hinter,dvdson,batch)=3.875e-05,4.631e-05,3.576e-07,2.811e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=24 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.671e-03,1.009e-02,2.983e-02,1.246e-02,5.406e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.666e-03 speed=2.147e-04GB/S T(nccl)=5.055e-06 speed=7.075e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=101 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=101 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=101 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=101 i=4 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=101 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=101 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=101 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.5e-01 t_gemm=3.0e+00 t_reduction=1.2e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=101 t=9.5e-01 per=1.9e+01 cost=2.9e+06 flops=3.0e+06
 sigma_tot[gemm] counter=101 i=0 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=101 i=3 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=101 i=4 t=7.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=101 i=5 t=7.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=101 total t=3.0e+00 per=5.8e+01 cost=4.7e+06 flops=1.6e+06
 sigma_tot[red] counter=101 t=1.2e+00 per=2.4e+01 cost=1.3e+06 flops=1.0e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,4.9e-06,2.1e-06,9.2e-07,1.8e-07
settings: ndim=24 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322162108317 -1.116e+03  8.836e-03    1     1  5.418e-02 5.418e-02 5.416e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.852e-04,9.865e-03,3.000e-02,1.244e-02,5.271e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=3.790e-04 speed=9.437e-04GB/S T(nccl)=6.223e-06 speed=5.747e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=102 t=9.9e-03 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=102 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=102 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=102 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=102 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=102 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=102 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.6e-01 t_gemm=3.0e+00 t_reduction=1.2e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=102 t=9.6e-01 per=1.9e+01 cost=2.9e+06 flops=3.1e+06
 sigma_tot[gemm] counter=102 i=0 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=7.5e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=102 i=3 t=7.5e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=102 i=4 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=102 i=5 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.5e+06
 sigma_tot[gemm] counter=102 total t=3.0e+00 per=5.8e+01 cost=4.7e+06 flops=1.6e+06
 sigma_tot[red] counter=102 t=1.2e+00 per=2.4e+01 cost=1.3e+06 flops=1.0e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.5e-05,3.5e-06,9.9e-07,2.1e-07
    2   0 -    -116.322343412170 -1.813e-04  2.077e-03    2     2  1.195e-01 5.973e-02 5.348e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.808e-03,1.001e-02,2.965e-02,1.247e-02,5.395e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.802e-03 speed=1.985e-04GB/S T(nccl)=5.703e-06 speed=6.271e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=103 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=103 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=103 i=3 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=103 i=4 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=103 i=5 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=103 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=103 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.7e-01 t_gemm=3.0e+00 t_reduction=1.2e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=103 t=9.7e-01 per=1.9e+01 cost=3.0e+06 flops=3.1e+06
 sigma_tot[gemm] counter=103 i=0 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=7.6e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=103 i=3 t=7.6e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=103 i=4 t=7.5e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=103 i=5 t=7.5e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=103 total t=3.0e+00 per=5.8e+01 cost=4.8e+06 flops=1.6e+06
 sigma_tot[red] counter=103 t=1.2e+00 per=2.4e+01 cost=1.3e+06 flops=1.0e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.7e-05,3.1e-06,1.0e-06,2.1e-07
    3   0 -    -116.322360945000 -1.753e-05  9.524e-04    3     3  1.867e-01 6.223e-02 5.367e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.898e-04,1.002e-02,3.022e-02,1.255e-02,5.369e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=8.840e-04 speed=4.045e-04GB/S T(nccl)=5.783e-06 speed=6.184e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=104 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=104 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=104 i=3 t=7.7e-03 per=1.5e+01 cost=1.8e+04 flops=2.3e+06
 sigma[gemm] counter=104 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=104 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=104 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=104 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.8e-01 t_gemm=3.0e+00 t_reduction=1.3e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=104 t=9.8e-01 per=1.9e+01 cost=3.1e+06 flops=3.1e+06
 sigma_tot[gemm] counter=104 i=0 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=7.6e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=104 i=3 t=7.7e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=104 i=4 t=7.6e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=104 i=5 t=7.6e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=104 total t=3.0e+00 per=5.8e+01 cost=4.9e+06 flops=1.6e+06
 sigma_tot[red] counter=104 t=1.3e+00 per=2.4e+01 cost=1.3e+06 flops=1.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.5e-05,2.9e-06,1.0e-06,2.1e-07
    4   0 -    -116.322362823573 -1.879e-06  2.502e-04    3     4  2.524e-01 6.311e-02 5.370e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.763e-03,9.962e-03,3.038e-02,1.263e-02,5.474e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.756e-03 speed=2.036e-04GB/S T(nccl)=6.303e-06 speed=5.674e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=105 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=105 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=105 i=3 t=7.7e-03 per=1.5e+01 cost=1.8e+04 flops=2.3e+06
 sigma[gemm] counter=105 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=105 i=5 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=105 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=105 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.9e-01 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=105 t=9.9e-01 per=1.9e+01 cost=3.1e+06 flops=3.1e+06
 sigma_tot[gemm] counter=105 i=0 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=7.7e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=105 i=3 t=7.7e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=105 i=4 t=7.7e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=105 i=5 t=7.7e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=105 total t=3.1e+00 per=5.8e+01 cost=4.9e+06 flops=1.6e+06
 sigma_tot[red] counter=105 t=1.3e+00 per=2.4e+01 cost=1.3e+06 flops=1.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.0e-06,1.0e-06,2.6e-07
    5   0 +    -116.322363025516 -2.019e-07  4.939e-05    3     5  3.205e-01 6.410e-02 5.392e-02
TIMING FOR Davidson : 3.205e-01  T(cal/comm/rest)=2.696e-01,6.080e-07,5.087e-02
decomposed t_rest=5.087e-02
 T(sub)    =1.088e-04 per=2.139e-01
 T(precond)=5.055e-02 per=9.937e+01
 T(ortho)  =4.661e-05 per=9.162e-02
 T(xcopy)  =7.860e-07 per=1.545e-03
 T(xnrm2)  =2.154e-06 per=4.234e-03
 T(other)  =1.619e-04 per=3.183e-01
optimized energies: isweep=0 ibond=23 dots=1 e[0]=-116.322363025516 nmvp=5
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.199e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=8 dimAll=24
 (11,-3):6 (10,-2):2 (10,-4):2 (13,-3):2 (12,-2):4 (12,-4):4 (11,-1):2 (11,-5):2
timing for divide=9.9e-06
timing for compute=1.3e-02
timing for collect=2.2e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.9e-06,1.3e-02,0.0e+00,2.1e-05,2.2e-05 -----
decimation summary: 24->7 dwt=-2.220e-16 SvN=9.814e-01
 qbond: qkept nsym=3 dimAll=7
 (12,-2):3 (13,-3):2 (12,-4):2
----- TIMING for decimation_row(nkr): 1.316e-02 S T(decim/select/formRot)=1.289e-02,2.388e-04,2.553e-05 -----
----- TIMING FOR onedot_decimation: 1.323e-02 S T(wf/decim)=5.407e-05,1.318e-02 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.546e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 1.139e-02 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper)=3.875e-05
rank=0 GPUmem(GB): used=8.524e-05 (oper,site)=3.875e-05,1.788e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:4.988e-02MB:4.871e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.516e-03 S -----
rank=0 GPUmem(GB): used=1.340e-04 (oper,site,rinter)=3.875e-05,1.788e-07,4.871e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.545e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=1.582e-03,9.636e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.626e-03 S size(rtasks)=297 size(Rlst)=610 -----
rank=0 GPUmem(GB): used=1.340e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.045e-04 blksize=9 blksize0=4 batchsize=610
rank=0 GPUmem(GB): used=2.385e-04 (oper,site,rinter,batch)=3.875e-05,1.788e-07,4.871e-05,1.045e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.054e-03,2.276e-02,1.022e-02
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=24 t=6.1e-03 per=1.6e+01 cost=3.9e+04 flops=6.4e+06
 renorm[gemm] counter=24 i=0 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=2 t=7.6e-03 per=1.9e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=24 i=3 t=7.6e-03 per=1.9e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=24 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=6 t=7.6e-03 per=1.9e+01 cost=1.4e+04 flops=1.9e+06
 renorm[gemm] counter=24 total t=2.3e-02 per=5.8e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=24 t=1.0e-02 per=2.6e+01 cost=7.0e+03 flops=6.9e+05
----- TIMING FOR renorm_tot : t_inter=1.3e-01 t_gemm=5.2e-01 t_reduction=2.3e-01 tot=8.9e-01 -----
 renorm_tot[inter] counter=24 t=1.3e-01 per=1.5e+01 cost=7.0e+05 flops=5.3e+06
 renorm_tot[gemm] counter=24 i=0 t=3.8e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=1 t=3.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=2 t=5.1e-02 per=5.8e+00 cost=1.9e+05 flops=3.6e+06
 renorm_tot[gemm] counter=24 i=3 t=5.3e-02 per=6.0e+00 cost=1.7e+05 flops=3.2e+06
 renorm_tot[gemm] counter=24 i=4 t=1.2e-01 per=1.4e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=24 i=5 t=1.2e-01 per=1.4e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=24 i=6 t=1.7e-01 per=2.0e+01 cost=2.6e+06 flops=1.5e+07
 renorm_tot[gemm] counter=24 total t=5.2e-01 per=5.9e+01 cost=3.5e+06 flops=6.7e+06
 renorm_tot[red] counter=24 t=2.3e-01 per=2.6e+01 cost=1.2e+06 flops=5.3e+06
qops.to_cpu: size(tot)=1825:1.4e-02MB:1.4e-05GB T(to_cpu)=2.8e-04S speed=4.8e-02GB/S
check ||H-H.dagger||=7.540e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0621 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=7.391e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=4.807e-04 change=-1.886e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=4.807e-04 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.339e-01 S #####
 T(local opt: fetch) = 1.242e-02 S  per = 1.69  per(accum) = 1.69
 T(local opt: hdiag) = 2.871e-01 S  per = 39.1  per(accum) = 40.8
 T(local opt: dvdsn) = 3.572e-01 S  per = 48.7  per(accum) = 89.5
 T(local opt: decim) = 1.324e-02 S  per =  1.8  per(accum) = 91.3
 T(local opt: guess) = 8.551e-05 S  per = 0.0117  per(accum) = 91.3
 T(local opt: renrm) = 6.366e-02 S  per = 8.67  per(accum) = 100
 T(local opt: save ) = 2.163e-04 S  per = 0.0295  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.572e-01 S  T(sum) = 3.570e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 1.016e-04 S  per = 0.0285  per(accum) = 0.0285
 T(local opt: symbolic_formulae           ) = 1.905e-02 S  per = 5.34  per(accum) = 5.37
 T(local opt: hintermediate init          ) = 4.919e-04 S  per = 0.138  per(accum) = 5.5
 T(local opt: preprocess_hformulae_Hxlist ) = 5.862e-03 S  per = 1.64  per(accum) = 7.15
 T(local opt: hmmtasks init               ) = 1.099e-02 S  per = 3.08  per(accum) = 10.2
 T(local opt: initial guess for dvdson    ) = 3.213e-06 S  per = 0.0009  per(accum) = 10.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.631e-01 S  per = 73.7  per(accum) = 83.9
 T(local opt: dvdson [cpu-gpu]            ) = 6.487e-03 S  per = 1.82  per(accum) = 85.7
 T(local opt: dvdson [nccl]               ) = 2.907e-05 S  per = 0.00814  per(accum) = 85.7
 T(local opt: dvdson [mpi]                ) = 6.080e-07 S  per = 0.00017  per(accum) = 85.7
 T(local opt: dvdson [rest part(linalg)]  ) = 5.087e-02 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 6.366e-02 S  T(sum) = 6.366e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.592e-05 S  per = 0.119  per(accum) = 0.119
 T(local opt: qops init                    ) = 2.133e-03 S  per = 3.35  per(accum) = 3.47
 T(local opt: symbolic_formulae_renorm     ) = 1.141e-02 S  per = 17.9  per(accum) = 21.4
 T(local opt: allocate qops on gpu         ) = 5.418e-05 S  per = 0.0851  per(accum) = 21.5
 T(local opt: site memcpy cpu2gpu          ) = 3.239e-04 S  per = 0.509  per(accum) = 22
 T(local opt: rintermediate init           ) = 2.529e-03 S  per = 3.97  per(accum) = 26
 T(local opt: preprocess_formulae_Rlist2   ) = 2.648e-03 S  per = 4.16  per(accum) = 30.1
 T(local opt: rmmtasks init                ) = 3.542e-03 S  per = 5.56  per(accum) = 35.7
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 5.03e-05  per(accum) = 35.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.912e-02 S  per = 61.4  per(accum) = 97.1
 T(local opt: deallocate cpu and gpu memory) = 4.231e-05 S  per = 0.0665  per(accum) = 97.2
 T(local opt: construct opS [ifdists=true] ) = 5.700e-08 S  per = 8.95e-05  per(accum) = 97.2
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 5.97e-05  per(accum) = 97.2
 T(local opt: qops memcpy gpu2cpu          ) = 2.884e-04 S  per = 0.453  per(accum) = 97.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.662e-05 S  per = 0.0261  per(accum) = 97.7
 T(local opt: qops_pool join and erase     ) = 1.477e-03 S  per = 2.32  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.470e-06 S  per = 0.00231  per(accum) = 100
##### sweep opt: 1.306e+01 S #####
 T(sweep opt: fetch) = 3.006e-01 S  per =  2.3  per(accum) = 2.3
 T(sweep opt: hdiag) = 3.806e+00 S  per = 29.1  per(accum) = 31.5
 T(sweep opt: dvdsn) = 7.037e+00 S  per = 53.9  per(accum) = 85.3
 T(sweep opt: decim) = 2.482e-01 S  per =  1.9  per(accum) = 87.2
 T(sweep opt: guess) = 2.285e-03 S  per = 0.0175  per(accum) = 87.3
 T(sweep opt: renrm) = 1.658e+00 S  per = 12.7  per(accum) = 100
 T(sweep opt: save ) = 5.718e-03 S  per = 0.0438  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.037e+00 S  T(sum) = 7.031e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.423e-03 S  per = 0.0345  per(accum) = 0.0345
 T(sweep opt: symbolic_formulae           ) = 2.780e-01 S  per = 3.95  per(accum) = 3.99
 T(sweep opt: hintermediate init          ) = 7.308e-03 S  per = 0.104  per(accum) = 4.09
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.486e-02 S  per = 1.21  per(accum) = 5.3
 T(sweep opt: hmmtasks init               ) = 1.565e-01 S  per = 2.23  per(accum) = 7.53
 T(sweep opt: initial guess for dvdson    ) = 7.252e-05 S  per = 0.00103  per(accum) = 7.53
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.360e+00 S  per = 76.2  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.388e-01 S  per = 1.97  per(accum) = 85.7
 T(sweep opt: dvdson [nccl]               ) = 6.344e-04 S  per = 0.00902  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 1.265e-05 S  per = 0.00018  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.002e+00 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.658e+00 S  T(sum) = 1.658e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.880e-03 S  per = 0.174  per(accum) = 0.174
 T(sweep opt: qops init                    ) = 4.158e-02 S  per = 2.51  per(accum) = 2.68
 T(sweep opt: symbolic_formulae_renorm     ) = 2.821e-01 S  per =   17  per(accum) = 19.7
 T(sweep opt: allocate qops on gpu         ) = 1.379e-03 S  per = 0.0832  per(accum) = 19.8
 T(sweep opt: site memcpy cpu2gpu          ) = 2.935e-02 S  per = 1.77  per(accum) = 21.6
 T(sweep opt: rintermediate init           ) = 5.523e-02 S  per = 3.33  per(accum) = 24.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.375e-02 S  per = 5.65  per(accum) = 30.5
 T(sweep opt: rmmtasks init                ) = 1.968e-01 S  per = 11.9  per(accum) = 42.4
 T(sweep opt: qops memset on cpu           ) = 9.910e-07 S  per = 5.98e-05  per(accum) = 42.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.886e-01 S  per = 53.6  per(accum) = 96
 T(sweep opt: deallocate cpu and gpu memory) = 2.485e-03 S  per = 0.15  per(accum) = 96.2
 T(sweep opt: construct opS [ifdists=true] ) = 1.418e-06 S  per = 8.55e-05  per(accum) = 96.2
 T(sweep opt: reduction of opS & opH [nccl]) = 9.710e-07 S  per = 5.86e-05  per(accum) = 96.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.625e-03 S  per = 0.279  per(accum) = 96.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.916e-04 S  per = 0.0297  per(accum) = 96.5
 T(sweep opt: qops_pool join and erase     ) = 3.378e-02 S  per = 2.04  per(accum) = 98.5
 T(sweep opt: conversion from opAB to opPQ ) = 2.485e-02 S  per =  1.5  per(accum) = 100
##### global opt: 1.306e+01 S #####
 T(global opt: fetch) = 3.006e-01 S  per =  2.3  per(accum) = 2.3
 T(global opt: hdiag) = 3.806e+00 S  per = 29.1  per(accum) = 31.5
 T(global opt: dvdsn) = 7.037e+00 S  per = 53.9  per(accum) = 85.3
 T(global opt: decim) = 2.482e-01 S  per =  1.9  per(accum) = 87.2
 T(global opt: guess) = 2.285e-03 S  per = 0.0175  per(accum) = 87.3
 T(global opt: renrm) = 1.658e+00 S  per = 12.7  per(accum) = 100
 T(global opt: save ) = 5.718e-03 S  per = 0.0438  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.037e+00 S  T(sum) = 7.031e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.423e-03 S  per = 0.0345  per(accum) = 0.0345
 T(global opt: symbolic_formulae           ) = 2.780e-01 S  per = 3.95  per(accum) = 3.99
 T(global opt: hintermediate init          ) = 7.308e-03 S  per = 0.104  per(accum) = 4.09
 T(global opt: preprocess_hformulae_Hxlist ) = 8.486e-02 S  per = 1.21  per(accum) = 5.3
 T(global opt: hmmtasks init               ) = 1.565e-01 S  per = 2.23  per(accum) = 7.53
 T(global opt: initial guess for dvdson    ) = 7.252e-05 S  per = 0.00103  per(accum) = 7.53
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.360e+00 S  per = 76.2  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.388e-01 S  per = 1.97  per(accum) = 85.7
 T(global opt: dvdson [nccl]               ) = 6.344e-04 S  per = 0.00902  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 1.265e-05 S  per = 0.00018  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 1.002e+00 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.658e+00 S  T(sum) = 1.658e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.880e-03 S  per = 0.174  per(accum) = 0.174
 T(global opt: qops init                    ) = 4.158e-02 S  per = 2.51  per(accum) = 2.68
 T(global opt: symbolic_formulae_renorm     ) = 2.821e-01 S  per =   17  per(accum) = 19.7
 T(global opt: allocate qops on gpu         ) = 1.379e-03 S  per = 0.0832  per(accum) = 19.8
 T(global opt: site memcpy cpu2gpu          ) = 2.935e-02 S  per = 1.77  per(accum) = 21.6
 T(global opt: rintermediate init           ) = 5.523e-02 S  per = 3.33  per(accum) = 24.9
 T(global opt: preprocess_formulae_Rlist2   ) = 9.375e-02 S  per = 5.65  per(accum) = 30.5
 T(global opt: rmmtasks init                ) = 1.968e-01 S  per = 11.9  per(accum) = 42.4
 T(global opt: qops memset on cpu           ) = 9.910e-07 S  per = 5.98e-05  per(accum) = 42.4
 T(global opt: preprocess_renorm_batchGPU   ) = 8.886e-01 S  per = 53.6  per(accum) = 96
 T(global opt: deallocate cpu and gpu memory) = 2.485e-03 S  per = 0.15  per(accum) = 96.2
 T(global opt: construct opS [ifdists=true] ) = 1.418e-06 S  per = 8.55e-05  per(accum) = 96.2
 T(global opt: reduction of opS & opH [nccl]) = 9.710e-07 S  per = 5.86e-05  per(accum) = 96.2
 T(global opt: qops memcpy gpu2cpu          ) = 4.625e-03 S  per = 0.279  per(accum) = 96.4
 T(global opt: reduction of opS & opH [mpi] ) = 4.916e-04 S  per = 0.0297  per(accum) = 96.5
 T(global opt: qops_pool join and erase     ) = 3.378e-02 S  per = 2.04  per(accum) = 98.5
 T(global opt: conversion from opAB to opPQ ) = 2.485e-02 S  per =  1.5  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.199e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=24/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=30:2.289e-04MB:2.235e-07GB
total mem of comb=1224:9.338e-03MB:9.120e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.46 S:2.02 P:0 Q:94.7 
 rqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=6840:0.0522MB:5.1e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.088e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.253e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=30:2.289e-04MB
qtensor3: wf3 own=1 _data=0x3aaa33b0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (16,2):4 (16,4):2 (15,3):1
 qbond: qcol nsym=3 dimAll=7
 (12,-2):3 (13,-3):2 (12,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=30:2.289e-04MB
### DIAG TIMING: total=3.136e-01 t1=2.478e-05, t2=2.201e-03, t3=2.492e-03, t4=3.088e-01, t5=5.512e-06, t6=1.481e-05, t7=4.585e-06
duration_diagGPU:3.136e-01
duration_diagreduce:9.900e-08
duration_diagtransform:5.620e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.295e-02 S -----
rank=0 GPUmem(GB): used=5.096e-05 (oper)=5.096e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.885e-04 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper,hinter)=5.096e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.815e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.453e-03,3.362e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.232e-03 S size(H_formulae)=1327 size(Hxlst)=2480 -----
rank=0 GPUmem(GB): used=1.054e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.470e-07 batch[need]=5.358e-04 blksize=12 blksize0=4 batchsize=2480
rank=0 GPUmem(GB): used=6.417e-04 (oper,hinter,dvdson,batch)=5.096e-05,5.442e-05,4.470e-07,5.358e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.963e-04,1.002e-02,3.025e-02,1.263e-02,5.380e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=8.907e-04 speed=5.019e-04GB/S T(nccl)=5.631e-06 speed=7.939e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=106 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=106 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=106 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=106 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=106 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=106 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=106 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.4e+00 -----
 sigma_tot[inter] counter=106 t=1.0e+00 per=1.9e+01 cost=3.2e+06 flops=3.2e+06
 sigma_tot[gemm] counter=106 i=0 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=7.8e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=106 i=3 t=7.8e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=106 i=4 t=7.7e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=106 i=5 t=7.7e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=106 total t=3.1e+00 per=5.8e+01 cost=5.0e+06 flops=1.6e+06
 sigma_tot[red] counter=106 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,5.0e-06,1.9e-06,7.5e-07,2.2e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322363025516 -1.116e+03  1.581e-02    1     1  5.392e-02 5.392e-02 5.390e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.448e-03,9.894e-03,3.017e-02,1.271e-02,5.424e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.442e-03 speed=3.101e-04GB/S T(nccl)=6.583e-06 speed=6.791e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=107 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.3e+06
 sigma[gemm] counter=107 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=107 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=107 i=4 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=107 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=107 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=107 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=107 t=1.0e+00 per=1.9e+01 cost=3.2e+06 flops=3.2e+06
 sigma_tot[gemm] counter=107 i=0 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=7.9e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=107 i=3 t=7.9e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=107 i=4 t=7.8e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=107 i=5 t=7.8e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=107 total t=3.1e+00 per=5.8e+01 cost=5.1e+06 flops=1.6e+06
 sigma_tot[red] counter=107 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,1.6e-05,3.5e-06,9.1e-07,2.3e-07
    2   0 -    -116.322986511550 -6.235e-04  4.573e-03    2     2  1.176e-01 5.880e-02 5.412e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.472e-03,9.982e-03,3.043e-02,1.268e-02,5.458e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.465e-03 speed=3.050e-04GB/S T(nccl)=6.056e-06 speed=7.382e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=108 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=108 i=0 t=1.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=108 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=108 i=4 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=108 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=108 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=108 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.2e+00 t_reduction=1.3e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=108 t=1.0e+00 per=1.9e+01 cost=3.2e+06 flops=3.2e+06
 sigma_tot[gemm] counter=108 i=0 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=7.9e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=108 i=3 t=8.0e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=108 i=4 t=7.9e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=108 i=5 t=7.9e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=108 total t=3.2e+00 per=5.8e+01 cost=5.3e+06 flops=1.7e+06
 sigma_tot[red] counter=108 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,3.0e-06,1.0e-06,2.1e-07
    3   0 -    -116.323063959884 -7.745e-05  1.743e-03    3     3  1.858e-01 6.192e-02 5.430e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.715e-03,1.004e-02,3.001e-02,1.261e-02,5.439e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.709e-03 speed=2.615e-04GB/S T(nccl)=5.819e-06 speed=7.682e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=109 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=109 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=109 i=3 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=109 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=109 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=109 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=109 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.2e+00 t_reduction=1.3e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=109 t=1.0e+00 per=1.9e+01 cost=3.3e+06 flops=3.2e+06
 sigma_tot[gemm] counter=109 i=0 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=1.9e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=8.0e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=109 i=3 t=8.0e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=109 i=4 t=8.0e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=109 i=5 t=8.0e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=109 total t=3.2e+00 per=5.8e+01 cost=5.4e+06 flops=1.7e+06
 sigma_tot[red] counter=109 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.5e-05,3.0e-06,1.0e-06,2.5e-07
    4   0 -    -116.323071442041 -7.482e-06  2.606e-04    3     4  2.535e-01 6.338e-02 5.435e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.665e-04,1.009e-02,3.032e-02,1.246e-02,5.336e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=4.560e-04 speed=9.804e-04GB/S T(nccl)=1.054e-05 speed=4.243e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=110 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=110 i=0 t=4.0e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=3.4e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=7.7e-03 per=1.4e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=110 i=3 t=7.7e-03 per=1.5e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=110 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=110 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=110 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=110 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.2e+00 t_reduction=1.3e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=110 t=1.0e+00 per=1.9e+01 cost=3.3e+06 flops=3.2e+06
 sigma_tot[gemm] counter=110 i=0 t=2.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=8.1e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=110 i=3 t=8.1e-01 per=1.4e+01 cost=1.4e+06 flops=1.8e+06
 sigma_tot[gemm] counter=110 i=4 t=8.0e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=110 i=5 t=8.0e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=110 total t=3.2e+00 per=5.8e+01 cost=5.5e+06 flops=1.7e+06
 sigma_tot[red] counter=110 t=1.3e+00 per=2.4e+01 cost=1.5e+06 flops=1.1e+06
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.0e-06,3.6e-05,5.3e-06,1.9e-06,3.7e-07
    5   0 +    -116.323071653332 -2.113e-07  6.679e-05    3     5  3.196e-01 6.391e-02 5.419e-02
TIMING FOR Davidson : 3.196e-01  T(cal/comm/rest)=2.709e-01,6.480e-07,4.865e-02
decomposed t_rest=4.865e-02
 T(sub)    =1.357e-04 per=2.790e-01
 T(precond)=4.833e-02 per=9.934e+01
 T(ortho)  =3.587e-05 per=7.373e-02
 T(xcopy)  =1.135e-06 per=2.333e-03
 T(xnrm2)  =2.511e-06 per=5.161e-03
 T(other)  =1.460e-04 per=3.000e-01
optimized energies: isweep=0 ibond=24 dots=1 e[0]=-116.323071653332 nmvp=5
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.442e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=8 dimAll=28
 (12,-2):3 (13,-3):7 (12,-4):2 (14,-2):5 (15,-3):2 (14,-4):4 (13,-1):3 (13,-5):2
timing for divide=1.7e-05
timing for compute=1.5e-02
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 1.5e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.7e-05,1.5e-02,0.0e+00,8.7e-06,1.8e-05 -----
decimation summary: 28->7 dwt=+0.000e+00 SvN=1.263e+00
 qbond: qkept nsym=3 dimAll=7
 (14,-2):4 (14,-4):2 (15,-3):1
----- TIMING for decimation_row(nkr): 1.511e-02 S T(decim/select/formRot)=1.482e-02,2.687e-04,2.189e-05 -----
----- TIMING FOR onedot_decimation: 1.523e-02 S T(wf/decim)=9.063e-05,1.513e-02 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.902e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.234e-02 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper)=5.096e-05
rank=0 GPUmem(GB): used=1.056e-04 (oper,site)=5.096e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:5.890e-02MB:5.752e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.506e-03 S -----
rank=0 GPUmem(GB): used=1.631e-04 (oper,site,rinter)=5.096e-05,2.235e-07,5.752e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.972e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=1.802e-03,1.170e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.142e-03 S size(rtasks)=365 size(Rlst)=703 -----
rank=0 GPUmem(GB): used=1.631e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.200e-04 blksize=16 blksize0=9 batchsize=703
rank=0 GPUmem(GB): used=3.831e-04 (oper,site,rinter,batch)=5.096e-05,2.235e-07,5.752e-05,2.200e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.902e-03,2.236e-02,9.896e-03
----- TIMING FOR renorm : t_inter=6.9e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=25 t=6.9e-03 per=1.8e+01 cost=5.3e+04 flops=7.7e+06
 renorm[gemm] counter=25 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=2 t=7.5e-03 per=1.9e+01 cost=2.8e+03 flops=3.7e+05
 renorm[gemm] counter=25 i=3 t=7.4e-03 per=1.9e+01 cost=1.5e+04 flops=2.0e+06
 renorm[gemm] counter=25 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=6 t=7.4e-03 per=1.9e+01 cost=2.4e+04 flops=3.3e+06
 renorm[gemm] counter=25 total t=2.2e-02 per=5.7e+01 cost=4.2e+04 flops=1.9e+06
 renorm[red] counter=25 t=9.9e-03 per=2.5e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=1.4e-01 t_gemm=5.4e-01 t_reduction=2.4e-01 tot=9.3e-01 -----
 renorm_tot[inter] counter=25 t=1.4e-01 per=1.5e+01 cost=7.6e+05 flops=5.4e+06
 renorm_tot[gemm] counter=25 i=0 t=4.0e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=1 t=3.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=2 t=5.9e-02 per=6.4e+00 cost=1.9e+05 flops=3.2e+06
 renorm_tot[gemm] counter=25 i=3 t=6.0e-02 per=6.5e+00 cost=1.8e+05 flops=3.0e+06
 renorm_tot[gemm] counter=25 i=4 t=1.2e-01 per=1.3e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=25 i=5 t=1.2e-01 per=1.3e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=25 i=6 t=1.8e-01 per=2.0e+01 cost=2.7e+06 flops=1.5e+07
 renorm_tot[gemm] counter=25 total t=5.4e-01 per=5.9e+01 cost=3.5e+06 flops=6.5e+06
 renorm_tot[red] counter=25 t=2.4e-01 per=2.6e+01 cost=1.2e+06 flops=5.1e+06
qops.to_cpu: size(tot)=2679:2.0e-02MB:2.0e-05GB T(to_cpu)=3.5e-04S speed=5.8e-02GB/S
check ||H-H.dagger||=6.748e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0672 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.128e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.024e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-6.706e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.735e-01 S #####
 T(local opt: fetch) = 1.171e-02 S  per = 1.51  per(accum) = 1.51
 T(local opt: hdiag) = 3.136e-01 S  per = 40.5  per(accum) = 42.1
 T(local opt: dvdsn) = 3.638e-01 S  per =   47  per(accum) = 89.1
 T(local opt: decim) = 1.524e-02 S  per = 1.97  per(accum) = 91.1
 T(local opt: guess) = 9.462e-05 S  per = 0.0122  per(accum) = 91.1
 T(local opt: renrm) = 6.872e-02 S  per = 8.89  per(accum) = 100
 T(local opt: save ) = 2.289e-04 S  per = 0.0296  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.638e-01 S  T(sum) = 3.635e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 1.016e-04 S  per = 0.0279  per(accum) = 0.0279
 T(local opt: symbolic_formulae           ) = 2.296e-02 S  per = 6.32  per(accum) = 6.35
 T(local opt: hintermediate init          ) = 6.075e-04 S  per = 0.167  per(accum) = 6.51
 T(local opt: preprocess_hformulae_Hxlist ) = 7.309e-03 S  per = 2.01  per(accum) = 8.52
 T(local opt: hmmtasks init               ) = 1.288e-02 S  per = 3.54  per(accum) = 12.1
 T(local opt: initial guess for dvdson    ) = 3.658e-06 S  per = 0.00101  per(accum) = 12.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.649e-01 S  per = 72.9  per(accum) = 85
 T(local opt: dvdson [cpu-gpu]            ) = 5.963e-03 S  per = 1.64  per(accum) = 86.6
 T(local opt: dvdson [nccl]               ) = 3.463e-05 S  per = 0.00953  per(accum) = 86.6
 T(local opt: dvdson [mpi]                ) = 6.480e-07 S  per = 0.000178  per(accum) = 86.6
 T(local opt: dvdson [rest part(linalg)]  ) = 4.865e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 6.872e-02 S  T(sum) = 6.872e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.919e-05 S  per = 0.115  per(accum) = 0.115
 T(local opt: qops init                    ) = 3.130e-03 S  per = 4.55  per(accum) = 4.67
 T(local opt: symbolic_formulae_renorm     ) = 1.236e-02 S  per =   18  per(accum) = 22.7
 T(local opt: allocate qops on gpu         ) = 6.730e-05 S  per = 0.0979  per(accum) = 22.7
 T(local opt: site memcpy cpu2gpu          ) = 2.073e-03 S  per = 3.02  per(accum) = 25.8
 T(local opt: rintermediate init           ) = 2.526e-03 S  per = 3.68  per(accum) = 29.4
 T(local opt: preprocess_formulae_Rlist2   ) = 3.171e-03 S  per = 4.61  per(accum) = 34.1
 T(local opt: rmmtasks init                ) = 4.167e-03 S  per = 6.06  per(accum) = 40.1
 T(local opt: qops memset on cpu           ) = 5.100e-08 S  per = 7.42e-05  per(accum) = 40.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.926e-02 S  per = 57.1  per(accum) = 97.2
 T(local opt: deallocate cpu and gpu memory) = 4.378e-05 S  per = 0.0637  per(accum) = 97.3
 T(local opt: construct opS [ifdists=true] ) = 6.000e-08 S  per = 8.73e-05  per(accum) = 97.3
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 5.38e-05  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 3.540e-04 S  per = 0.515  per(accum) = 97.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.971e-05 S  per = 0.0287  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 1.479e-03 S  per = 2.15  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.076e-06 S  per = 0.00302  per(accum) = 100
##### sweep opt: 1.383e+01 S #####
 T(sweep opt: fetch) = 3.123e-01 S  per = 2.26  per(accum) = 2.26
 T(sweep opt: hdiag) = 4.120e+00 S  per = 29.8  per(accum) = 32
 T(sweep opt: dvdsn) = 7.401e+00 S  per = 53.5  per(accum) = 85.6
 T(sweep opt: decim) = 2.634e-01 S  per =  1.9  per(accum) = 87.5
 T(sweep opt: guess) = 2.380e-03 S  per = 0.0172  per(accum) = 87.5
 T(sweep opt: renrm) = 1.727e+00 S  per = 12.5  per(accum) = 100
 T(sweep opt: save ) = 5.947e-03 S  per = 0.043  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.401e+00 S  T(sum) = 7.394e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.525e-03 S  per = 0.0341  per(accum) = 0.0341
 T(sweep opt: symbolic_formulae           ) = 3.010e-01 S  per = 4.07  per(accum) = 4.1
 T(sweep opt: hintermediate init          ) = 7.915e-03 S  per = 0.107  per(accum) = 4.21
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.217e-02 S  per = 1.25  per(accum) = 5.46
 T(sweep opt: hmmtasks init               ) = 1.694e-01 S  per = 2.29  per(accum) = 7.75
 T(sweep opt: initial guess for dvdson    ) = 7.618e-05 S  per = 0.00103  per(accum) = 7.75
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.625e+00 S  per = 76.1  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.448e-01 S  per = 1.96  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 6.690e-04 S  per = 0.00905  per(accum) = 85.8
 T(sweep opt: dvdson [mpi]                ) = 1.330e-05 S  per = 0.00018  per(accum) = 85.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.051e+00 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.727e+00 S  T(sum) = 1.727e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.959e-03 S  per = 0.171  per(accum) = 0.171
 T(sweep opt: qops init                    ) = 4.471e-02 S  per = 2.59  per(accum) = 2.76
 T(sweep opt: symbolic_formulae_renorm     ) = 2.945e-01 S  per = 17.1  per(accum) = 19.8
 T(sweep opt: allocate qops on gpu         ) = 1.447e-03 S  per = 0.0838  per(accum) = 19.9
 T(sweep opt: site memcpy cpu2gpu          ) = 3.142e-02 S  per = 1.82  per(accum) = 21.7
 T(sweep opt: rintermediate init           ) = 5.776e-02 S  per = 3.35  per(accum) = 25.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.692e-02 S  per = 5.61  per(accum) = 30.7
 T(sweep opt: rmmtasks init                ) = 2.009e-01 S  per = 11.6  per(accum) = 42.3
 T(sweep opt: qops memset on cpu           ) = 1.042e-06 S  per = 6.03e-05  per(accum) = 42.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.279e-01 S  per = 53.7  per(accum) = 96.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.528e-03 S  per = 0.146  per(accum) = 96.2
 T(sweep opt: construct opS [ifdists=true] ) = 1.478e-06 S  per = 8.56e-05  per(accum) = 96.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.008e-06 S  per = 5.84e-05  per(accum) = 96.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.979e-03 S  per = 0.288  per(accum) = 96.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.113e-04 S  per = 0.0296  per(accum) = 96.5
 T(sweep opt: qops_pool join and erase     ) = 3.526e-02 S  per = 2.04  per(accum) = 98.6
 T(sweep opt: conversion from opAB to opPQ ) = 2.486e-02 S  per = 1.44  per(accum) = 100
##### global opt: 1.383e+01 S #####
 T(global opt: fetch) = 3.123e-01 S  per = 2.26  per(accum) = 2.26
 T(global opt: hdiag) = 4.120e+00 S  per = 29.8  per(accum) = 32
 T(global opt: dvdsn) = 7.401e+00 S  per = 53.5  per(accum) = 85.6
 T(global opt: decim) = 2.634e-01 S  per =  1.9  per(accum) = 87.5
 T(global opt: guess) = 2.380e-03 S  per = 0.0172  per(accum) = 87.5
 T(global opt: renrm) = 1.727e+00 S  per = 12.5  per(accum) = 100
 T(global opt: save ) = 5.947e-03 S  per = 0.043  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.401e+00 S  T(sum) = 7.394e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.525e-03 S  per = 0.0341  per(accum) = 0.0341
 T(global opt: symbolic_formulae           ) = 3.010e-01 S  per = 4.07  per(accum) = 4.1
 T(global opt: hintermediate init          ) = 7.915e-03 S  per = 0.107  per(accum) = 4.21
 T(global opt: preprocess_hformulae_Hxlist ) = 9.217e-02 S  per = 1.25  per(accum) = 5.46
 T(global opt: hmmtasks init               ) = 1.694e-01 S  per = 2.29  per(accum) = 7.75
 T(global opt: initial guess for dvdson    ) = 7.618e-05 S  per = 0.00103  per(accum) = 7.75
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.625e+00 S  per = 76.1  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.448e-01 S  per = 1.96  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 6.690e-04 S  per = 0.00905  per(accum) = 85.8
 T(global opt: dvdson [mpi]                ) = 1.330e-05 S  per = 0.00018  per(accum) = 85.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.051e+00 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.727e+00 S  T(sum) = 1.727e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.959e-03 S  per = 0.171  per(accum) = 0.171
 T(global opt: qops init                    ) = 4.471e-02 S  per = 2.59  per(accum) = 2.76
 T(global opt: symbolic_formulae_renorm     ) = 2.945e-01 S  per = 17.1  per(accum) = 19.8
 T(global opt: allocate qops on gpu         ) = 1.447e-03 S  per = 0.0838  per(accum) = 19.9
 T(global opt: site memcpy cpu2gpu          ) = 3.142e-02 S  per = 1.82  per(accum) = 21.7
 T(global opt: rintermediate init           ) = 5.776e-02 S  per = 3.35  per(accum) = 25.1
 T(global opt: preprocess_formulae_Rlist2   ) = 9.692e-02 S  per = 5.61  per(accum) = 30.7
 T(global opt: rmmtasks init                ) = 2.009e-01 S  per = 11.6  per(accum) = 42.3
 T(global opt: qops memset on cpu           ) = 1.042e-06 S  per = 6.03e-05  per(accum) = 42.3
 T(global opt: preprocess_renorm_batchGPU   ) = 9.279e-01 S  per = 53.7  per(accum) = 96.1
 T(global opt: deallocate cpu and gpu memory) = 2.528e-03 S  per = 0.146  per(accum) = 96.2
 T(global opt: construct opS [ifdists=true] ) = 1.478e-06 S  per = 8.56e-05  per(accum) = 96.2
 T(global opt: reduction of opS & opH [nccl]) = 1.008e-06 S  per = 5.84e-05  per(accum) = 96.2
 T(global opt: qops memcpy gpu2cpu          ) = 4.979e-03 S  per = 0.288  per(accum) = 96.5
 T(global opt: reduction of opS & opH [mpi] ) = 5.113e-04 S  per = 0.0296  per(accum) = 96.5
 T(global opt: qops_pool join and erase     ) = 3.526e-02 S  per = 2.04  per(accum) = 98.6
 T(global opt: conversion from opAB to opPQ ) = 2.486e-02 S  per = 1.44  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.442e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=25/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=35:2.670e-04MB:2.608e-07GB
total mem of comb=1229:9.377e-03MB:9.157e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 rqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=8266:0.0631MB:6.16e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.128e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.444e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=35:2.670e-04MB
qtensor3: wf3 own=1 _data=0x3acf1c20
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (15,1):4 (15,3):2 (14,2):1
 qbond: qcol nsym=3 dimAll=7
 (14,-2):4 (14,-4):2 (15,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=35:2.670e-04MB
### DIAG TIMING: total=4.611e-01 t1=4.441e-05, t2=2.188e-03, t3=2.515e-03, t4=4.563e-01, t5=5.955e-06, t6=1.505e-05, t7=3.913e-06
duration_diagGPU:4.611e-01
duration_diagreduce:6.000e-08
duration_diagtransform:5.790e-07
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.611e-02 S -----
rank=0 GPUmem(GB): used=6.159e-05 (oper)=6.159e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.148e-04 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper,hinter)=6.159e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.212e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=4.033e-03,5.179e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.879e-03 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.233e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=5.215e-07 batch[need]=1.086e-03 blksize=16 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=1.210e-03 (oper,hinter,dvdson,batch)=6.159e-05,6.169e-05,5.215e-07,1.086e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=35 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.297e-04,1.006e-02,2.986e-02,1.248e-02,5.285e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=4.234e-04 speed=1.232e-03GB/S T(nccl)=6.324e-06 speed=8.247e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=111 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.7e+06
 sigma[gemm] counter=111 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=111 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=111 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=111 i=5 t=7.4e-03 per=1.4e+01 cost=3.5e+04 flops=4.7e+06
 sigma[gemm] counter=111 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=111 t=1.2e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.3e+00 tot=5.7e+00 -----
 sigma_tot[inter] counter=111 t=1.1e+00 per=1.9e+01 cost=3.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=111 i=0 t=2.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=8.2e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=111 i=3 t=8.2e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=111 i=4 t=8.1e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=111 i=5 t=8.1e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=111 total t=3.3e+00 per=5.8e+01 cost=5.7e+06 flops=1.7e+06
 sigma_tot[red] counter=111 t=1.3e+00 per=2.4e+01 cost=1.5e+06 flops=1.1e+06
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,5.5e-06,2.0e-06,8.3e-07,1.9e-07
settings: ndim=35 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323071653332 -1.116e+03  3.775e-03    1     1  5.297e-02 5.297e-02 5.294e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.497e-03,9.875e-03,2.997e-02,1.250e-02,5.385e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.488e-03 speed=3.506e-04GB/S T(nccl)=9.012e-06 speed=5.787e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=112 t=9.9e-03 per=1.9e+01 cost=6.8e+04 flops=6.9e+06
 sigma[gemm] counter=112 i=0 t=2.0e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=112 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=112 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=112 i=5 t=7.4e-03 per=1.4e+01 cost=3.5e+04 flops=4.7e+06
 sigma[gemm] counter=112 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=112 t=1.2e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.7e+00 -----
 sigma_tot[inter] counter=112 t=1.1e+00 per=1.9e+01 cost=3.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=112 i=0 t=2.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=8.2e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=112 i=3 t=8.3e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=112 i=4 t=8.2e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=112 i=5 t=8.2e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=112 total t=3.3e+00 per=5.8e+01 cost=5.9e+06 flops=1.8e+06
 sigma_tot[red] counter=112 t=1.4e+00 per=2.4e+01 cost=1.6e+06 flops=1.2e+06
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,2.4e-05,6.7e-06,2.0e-06,4.3e-07
    2   0 -    -116.323141789501 -7.014e-05  3.796e-04    2     2  1.205e-01 6.026e-02 5.350e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.767e-04,9.945e-03,2.963e-02,1.246e-02,5.232e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.697e-04 speed=1.934e-03GB/S T(nccl)=7.006e-06 speed=7.444e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=113 t=9.9e-03 per=1.9e+01 cost=6.8e+04 flops=6.8e+06
 sigma[gemm] counter=113 i=0 t=2.5e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=2.1e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=7.4e-03 per=1.4e+01 cost=7.8e+04 flops=1.1e+07
 sigma[gemm] counter=113 i=3 t=7.4e-03 per=1.4e+01 cost=7.8e+04 flops=1.1e+07
 sigma[gemm] counter=113 i=4 t=7.4e-03 per=1.4e+01 cost=3.4e+04 flops=4.6e+06
 sigma[gemm] counter=113 i=5 t=7.4e-03 per=1.4e+01 cost=3.5e+04 flops=4.7e+06
 sigma[gemm] counter=113 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.6e+06
 sigma[red] counter=113 t=1.2e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=113 t=1.1e+00 per=1.9e+01 cost=3.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=113 i=0 t=2.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=8.3e-01 per=1.4e+01 cost=1.6e+06 flops=2.0e+06
 sigma_tot[gemm] counter=113 i=3 t=8.3e-01 per=1.4e+01 cost=1.7e+06 flops=2.0e+06
 sigma_tot[gemm] counter=113 i=4 t=8.3e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=113 i=5 t=8.3e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=113 total t=3.3e+00 per=5.8e+01 cost=6.1e+06 flops=1.9e+06
 sigma_tot[red] counter=113 t=1.4e+00 per=2.4e+01 cost=1.6e+06 flops=1.2e+06
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.9e-05,3.4e-06,1.4e-06,2.7e-07
    3   0 -    -116.323142446351 -6.569e-07  1.172e-04    3     3  1.854e-01 6.181e-02 5.315e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.939e-03,1.008e-02,3.025e-02,1.246e-02,5.476e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.933e-03 speed=2.698e-04GB/S T(nccl)=5.817e-06 speed=8.966e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=114 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.7e+06
 sigma[gemm] counter=114 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=7.6e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=114 i=3 t=7.6e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=114 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=114 i=5 t=7.6e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=114 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.4e+06
 sigma[red] counter=114 t=1.2e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=114 t=1.1e+00 per=1.9e+01 cost=3.6e+06 flops=3.3e+06
 sigma_tot[gemm] counter=114 i=0 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=2.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=8.4e-01 per=1.4e+01 cost=1.7e+06 flops=2.1e+06
 sigma_tot[gemm] counter=114 i=3 t=8.4e-01 per=1.4e+01 cost=1.7e+06 flops=2.1e+06
 sigma_tot[gemm] counter=114 i=4 t=8.3e-01 per=1.4e+01 cost=1.5e+06 flops=1.7e+06
 sigma_tot[gemm] counter=114 i=5 t=8.3e-01 per=1.4e+01 cost=1.5e+06 flops=1.7e+06
 sigma_tot[gemm] counter=114 total t=3.3e+00 per=5.8e+01 cost=6.4e+06 flops=1.9e+06
 sigma_tot[red] counter=114 t=1.4e+00 per=2.4e+01 cost=1.7e+06 flops=1.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.1e-06,1.1e-06,2.2e-07
    4   0 +    -116.323142503667 -5.732e-08  2.168e-05    3     4  2.533e-01 6.332e-02 5.357e-02
TIMING FOR Davidson : 2.533e-01  T(cal/comm/rest)=2.143e-01,5.180e-07,3.900e-02
decomposed t_rest=3.900e-02
 T(sub)    =1.079e-04 per=2.766e-01
 T(precond)=3.874e-02 per=9.934e+01
 T(ortho)  =2.220e-05 per=5.692e-02
 T(xcopy)  =9.030e-07 per=2.316e-03
 T(xnrm2)  =2.580e-06 per=6.616e-03
 T(other)  =1.230e-04 per=3.154e-01
optimized energies: isweep=0 ibond=25 dots=1 e[0]=-116.323142503667 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.747e-04 change=1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=8 dimAll=28
 (14,-2):4 (14,-4):2 (15,-3):7 (16,-2):5 (16,-4):3 (17,-3):1 (15,-1):4 (15,-5):2
timing for divide=1.0e-05
timing for compute=1.1e-02
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,1.1e-02,0.0e+00,4.6e-06,2.0e-05 -----
decimation summary: 28->7 dwt=+0.000e+00 SvN=1.234e+00
 qbond: qkept nsym=3 dimAll=7
 (15,-1):4 (15,-3):2 (16,-2):1
----- TIMING for decimation_row(nkr): 1.116e-02 S T(decim/select/formRot)=1.092e-02,2.256e-04,1.956e-05 -----
----- TIMING FOR onedot_decimation: 1.124e-02 S T(wf/decim)=5.534e-05,1.118e-02 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:20 S:20 A:190 B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 A:0 B:95.7 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.747e-04 change=2.281e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=441 : 1.428e-02 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper)=6.159e-05
rank=0 GPUmem(GB): used=1.235e-04 (oper,site)=6.159e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:6.715e-02MB:6.558e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.520e-03 S -----
rank=0 GPUmem(GB): used=1.891e-04 (oper,site,rinter)=6.159e-05,2.608e-07,6.558e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.307e-03 S size(rtasks)=441 size(Rlst2)=9 T(Rmu/Rlist)=1.873e-03,1.433e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.427e-03 S size(rtasks)=441 size(Rlst)=965 -----
rank=0 GPUmem(GB): used=1.891e-04 avail=6.176e+00 total=6.176e+00 batch[need]=3.523e-04 blksize=16 blksize0=16 batchsize=965
rank=0 GPUmem(GB): used=5.414e-04 (oper,site,rinter,batch)=6.159e-05,2.608e-07,6.558e-05,3.523e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.110e-03,2.256e-02,9.954e-03
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=26 t=7.1e-03 per=1.8e+01 cost=1.9e+05 flops=2.6e+07
 renorm[gemm] counter=26 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=2 t=7.6e-03 per=1.9e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=26 i=3 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.8e+06
 renorm[gemm] counter=26 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=6 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=26 total t=2.3e-02 per=5.7e+01 cost=5.9e+04 flops=2.6e+06
 renorm[red] counter=26 t=1.0e-02 per=2.5e+01 cost=8.9e+03 flops=8.9e+05
----- TIMING FOR renorm_tot : t_inter=1.5e-01 t_gemm=5.7e-01 t_reduction=2.5e-01 tot=9.7e-01 -----
 renorm_tot[inter] counter=26 t=1.5e-01 per=1.5e+01 cost=9.4e+05 flops=6.4e+06
 renorm_tot[gemm] counter=26 i=0 t=4.1e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=1 t=3.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=2 t=6.6e-02 per=6.9e+00 cost=1.9e+05 flops=2.9e+06
 renorm_tot[gemm] counter=26 i=3 t=6.8e-02 per=7.0e+00 cost=2.1e+05 flops=3.1e+06
 renorm_tot[gemm] counter=26 i=4 t=1.2e-01 per=1.3e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=26 i=5 t=1.2e-01 per=1.3e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=26 i=6 t=1.9e-01 per=2.0e+01 cost=2.7e+06 flops=1.4e+07
 renorm_tot[gemm] counter=26 total t=5.7e-01 per=5.9e+01 cost=3.6e+06 flops=6.3e+06
 renorm_tot[red] counter=26 t=2.5e-01 per=2.6e+01 cost=1.2e+06 flops=4.9e+06
----- TIMING FOR oper_renorm : 6.9e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=6.104e-05 change=9.697e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.190e-03 change=-2.285e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.190e-03 change=2.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.190e-03 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=1 ifkr=0 maxsize=3110:2.317e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3110:2.373e-02MB:2.317e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.0009 tinit=0.0009
   copy opB to qops_tmps: dt=0.00214 tcopy=0.00214
   bcast: size(opB)=3110:2.32e-05GB dt=4.1e-08 speed=565GB/s tcomm=4.1e-08
   compute opQ from opB: dt=0.00757 tcomp=0.00757
iproc=0
 qops_tmp: oplist=N nops=N:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3110:0.0237MB:2.32e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.000882 tinit=0.00178
   from opB to opB.H(): dt=0.00666 tadjt=0.00666
   bcast: size(opN)=3110:2.32e-05GB dt=4.2e-08 speed=552GB/s tcomm=8.3e-08
   compute opQ from opB.H(): dt=0.0075 tcomp=0.0151
----- TIMING FOR oper_b2qGPU : 0.026 S T(init/copy/adjt+bcast/comp/rest)=0.00178,0.00214,0.00666,0.0151,0.000359 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.099e-03 change=4.321e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.099e-03 change=2.480e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.099e-03 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before move
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.099e-03 change=-2.284e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=8.591e-05 avail=6.176e+00 after move
check ||H-H.dagger||=2.081e-15 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0291 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00214,1.77e-05,4.69e-06,0.026,0,0.000598,0.000324 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.099e-03 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.099e-03 change=-7.153e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.989e-01 S #####
 T(local opt: fetch) = 1.350e-02 S  per =  1.5  per(accum) = 1.5
 T(local opt: hdiag) = 4.611e-01 S  per = 51.3  per(accum) = 52.8
 T(local opt: dvdsn) = 3.126e-01 S  per = 34.8  per(accum) = 87.6
 T(local opt: decim) = 1.125e-02 S  per = 1.25  per(accum) = 88.8
 T(local opt: guess) = 8.458e-05 S  per = 0.00941  per(accum) = 88.8
 T(local opt: renrm) = 1.000e-01 S  per = 11.1  per(accum) = 100
 T(local opt: save ) = 2.364e-04 S  per = 0.0263  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.126e-01 S  T(sum) = 3.123e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 1.036e-04 S  per = 0.0332  per(accum) = 0.0332
 T(local opt: symbolic_formulae           ) = 2.612e-02 S  per = 8.36  per(accum) = 8.4
 T(local opt: hintermediate init          ) = 7.374e-04 S  per = 0.236  per(accum) = 8.63
 T(local opt: preprocess_hformulae_Hxlist ) = 1.000e-02 S  per =  3.2  per(accum) = 11.8
 T(local opt: hmmtasks init               ) = 2.208e-02 S  per = 7.07  per(accum) = 18.9
 T(local opt: initial guess for dvdson    ) = 4.243e-06 S  per = 0.00136  per(accum) = 18.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.102e-01 S  per = 67.3  per(accum) = 86.2
 T(local opt: dvdson [cpu-gpu]            ) = 4.114e-03 S  per = 1.32  per(accum) = 87.5
 T(local opt: dvdson [nccl]               ) = 2.816e-05 S  per = 0.00902  per(accum) = 87.5
 T(local opt: dvdson [mpi]                ) = 5.180e-07 S  per = 0.000166  per(accum) = 87.5
 T(local opt: dvdson [rest part(linalg)]  ) = 3.900e-02 S  per = 12.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.000e-01 S  T(sum) = 1.000e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.331e-05 S  per = 0.0733  per(accum) = 0.0733
 T(local opt: qops init                    ) = 2.982e-03 S  per = 2.98  per(accum) = 3.05
 T(local opt: symbolic_formulae_renorm     ) = 1.430e-02 S  per = 14.3  per(accum) = 17.3
 T(local opt: allocate qops on gpu         ) = 5.654e-05 S  per = 0.0565  per(accum) = 17.4
 T(local opt: site memcpy cpu2gpu          ) = 5.396e-04 S  per = 0.539  per(accum) = 17.9
 T(local opt: rintermediate init           ) = 2.534e-03 S  per = 2.53  per(accum) = 20.5
 T(local opt: preprocess_formulae_Rlist2   ) = 3.461e-03 S  per = 3.46  per(accum) = 23.9
 T(local opt: rmmtasks init                ) = 5.455e-03 S  per = 5.45  per(accum) = 29.4
 T(local opt: qops memset on cpu           ) = 6.900e-08 S  per = 6.9e-05  per(accum) = 29.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.972e-02 S  per = 39.7  per(accum) = 69.1
 T(local opt: deallocate cpu and gpu memory) = 5.659e-05 S  per = 0.0566  per(accum) = 69.1
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 4.2e-05  per(accum) = 69.1
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 3.8e-05  per(accum) = 69.1
 T(local opt: qops memcpy gpu2cpu          ) = 2.800e-08 S  per = 2.8e-05  per(accum) = 69.1
 T(local opt: reduction of opS & opH [mpi] ) = 5.300e-08 S  per = 5.3e-05  per(accum) = 69.1
 T(local opt: qops_pool join and erase     ) = 1.689e-03 S  per = 1.69  per(accum) = 70.8
 T(local opt: conversion from opAB to opPQ ) = 2.919e-02 S  per = 29.2  per(accum) = 100
##### sweep opt: 1.473e+01 S #####
 T(sweep opt: fetch) = 3.258e-01 S  per = 2.21  per(accum) = 2.21
 T(sweep opt: hdiag) = 4.581e+00 S  per = 31.1  per(accum) = 33.3
 T(sweep opt: dvdsn) = 7.713e+00 S  per = 52.4  per(accum) = 85.7
 T(sweep opt: decim) = 2.747e-01 S  per = 1.86  per(accum) = 87.5
 T(sweep opt: guess) = 2.464e-03 S  per = 0.0167  per(accum) = 87.6
 T(sweep opt: renrm) = 1.827e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 6.183e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.713e+00 S  T(sum) = 7.706e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.628e-03 S  per = 0.0341  per(accum) = 0.0341
 T(sweep opt: symbolic_formulae           ) = 3.271e-01 S  per = 4.24  per(accum) = 4.28
 T(sweep opt: hintermediate init          ) = 8.653e-03 S  per = 0.112  per(accum) = 4.39
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.022e-01 S  per = 1.33  per(accum) = 5.72
 T(sweep opt: hmmtasks init               ) = 1.914e-01 S  per = 2.48  per(accum) = 8.2
 T(sweep opt: initial guess for dvdson    ) = 8.042e-05 S  per = 0.00104  per(accum) = 8.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.835e+00 S  per = 75.7  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.489e-01 S  per = 1.93  per(accum) = 85.9
 T(sweep opt: dvdson [nccl]               ) = 6.971e-04 S  per = 0.00905  per(accum) = 85.9
 T(sweep opt: dvdson [mpi]                ) = 1.382e-05 S  per = 0.000179  per(accum) = 85.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.090e+00 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.827e+00 S  T(sum) = 1.827e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.032e-03 S  per = 0.166  per(accum) = 0.166
 T(sweep opt: qops init                    ) = 4.769e-02 S  per = 2.61  per(accum) = 2.78
 T(sweep opt: symbolic_formulae_renorm     ) = 3.088e-01 S  per = 16.9  per(accum) = 19.7
 T(sweep opt: allocate qops on gpu         ) = 1.503e-03 S  per = 0.0823  per(accum) = 19.8
 T(sweep opt: site memcpy cpu2gpu          ) = 3.196e-02 S  per = 1.75  per(accum) = 21.5
 T(sweep opt: rintermediate init           ) = 6.029e-02 S  per =  3.3  per(accum) = 24.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.004e-01 S  per =  5.5  per(accum) = 30.3
 T(sweep opt: rmmtasks init                ) = 2.064e-01 S  per = 11.3  per(accum) = 41.6
 T(sweep opt: qops memset on cpu           ) = 1.111e-06 S  per = 6.08e-05  per(accum) = 41.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.676e-01 S  per =   53  per(accum) = 94.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.585e-03 S  per = 0.142  per(accum) = 94.7
 T(sweep opt: construct opS [ifdists=true] ) = 1.520e-06 S  per = 8.32e-05  per(accum) = 94.7
 T(sweep opt: reduction of opS & opH [nccl]) = 1.046e-06 S  per = 5.73e-05  per(accum) = 94.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.979e-03 S  per = 0.273  per(accum) = 95
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.114e-04 S  per = 0.028  per(accum) = 95
 T(sweep opt: qops_pool join and erase     ) = 3.695e-02 S  per = 2.02  per(accum) = 97
 T(sweep opt: conversion from opAB to opPQ ) = 5.404e-02 S  per = 2.96  per(accum) = 100
##### global opt: 1.473e+01 S #####
 T(global opt: fetch) = 3.258e-01 S  per = 2.21  per(accum) = 2.21
 T(global opt: hdiag) = 4.581e+00 S  per = 31.1  per(accum) = 33.3
 T(global opt: dvdsn) = 7.713e+00 S  per = 52.4  per(accum) = 85.7
 T(global opt: decim) = 2.747e-01 S  per = 1.86  per(accum) = 87.5
 T(global opt: guess) = 2.464e-03 S  per = 0.0167  per(accum) = 87.6
 T(global opt: renrm) = 1.827e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 6.183e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.713e+00 S  T(sum) = 7.706e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.628e-03 S  per = 0.0341  per(accum) = 0.0341
 T(global opt: symbolic_formulae           ) = 3.271e-01 S  per = 4.24  per(accum) = 4.28
 T(global opt: hintermediate init          ) = 8.653e-03 S  per = 0.112  per(accum) = 4.39
 T(global opt: preprocess_hformulae_Hxlist ) = 1.022e-01 S  per = 1.33  per(accum) = 5.72
 T(global opt: hmmtasks init               ) = 1.914e-01 S  per = 2.48  per(accum) = 8.2
 T(global opt: initial guess for dvdson    ) = 8.042e-05 S  per = 0.00104  per(accum) = 8.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.835e+00 S  per = 75.7  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.489e-01 S  per = 1.93  per(accum) = 85.9
 T(global opt: dvdson [nccl]               ) = 6.971e-04 S  per = 0.00905  per(accum) = 85.9
 T(global opt: dvdson [mpi]                ) = 1.382e-05 S  per = 0.000179  per(accum) = 85.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.090e+00 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.827e+00 S  T(sum) = 1.827e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.032e-03 S  per = 0.166  per(accum) = 0.166
 T(global opt: qops init                    ) = 4.769e-02 S  per = 2.61  per(accum) = 2.78
 T(global opt: symbolic_formulae_renorm     ) = 3.088e-01 S  per = 16.9  per(accum) = 19.7
 T(global opt: allocate qops on gpu         ) = 1.503e-03 S  per = 0.0823  per(accum) = 19.8
 T(global opt: site memcpy cpu2gpu          ) = 3.196e-02 S  per = 1.75  per(accum) = 21.5
 T(global opt: rintermediate init           ) = 6.029e-02 S  per =  3.3  per(accum) = 24.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.004e-01 S  per =  5.5  per(accum) = 30.3
 T(global opt: rmmtasks init                ) = 2.064e-01 S  per = 11.3  per(accum) = 41.6
 T(global opt: qops memset on cpu           ) = 1.111e-06 S  per = 6.08e-05  per(accum) = 41.6
 T(global opt: preprocess_renorm_batchGPU   ) = 9.676e-01 S  per =   53  per(accum) = 94.6
 T(global opt: deallocate cpu and gpu memory) = 2.585e-03 S  per = 0.142  per(accum) = 94.7
 T(global opt: construct opS [ifdists=true] ) = 1.520e-06 S  per = 8.32e-05  per(accum) = 94.7
 T(global opt: reduction of opS & opH [nccl]) = 1.046e-06 S  per = 5.73e-05  per(accum) = 94.7
 T(global opt: qops memcpy gpu2cpu          ) = 4.979e-03 S  per = 0.273  per(accum) = 95
 T(global opt: reduction of opS & opH [mpi] ) = 5.114e-04 S  per = 0.028  per(accum) = 95
 T(global opt: qops_pool join and erase     ) = 3.695e-02 S  per = 2.02  per(accum) = 97
 T(global opt: conversion from opAB to opPQ ) = 5.404e-02 S  per = 2.96  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=26/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=31:2.365e-04MB:2.310e-07GB
total mem of comb=1225:9.346e-03MB:9.127e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.42 S:2.96 A:0 B:93.9 
 rqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=7447:0.0568MB:5.55e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.080e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,7,4) nnz=31:2.365e-04MB
qtensor3: wf3 own=1 _data=0x3b0cd900
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (14,0):3 (14,2):2 (13,1):1
 qbond: qcol nsym=3 dimAll=7
 (15,-1):4 (15,-3):2 (16,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=31:2.365e-04MB
### DIAG TIMING: total=4.189e-01 t1=2.363e-05, t2=2.266e-03, t3=2.543e-03, t4=4.140e-01, t5=5.828e-06, t6=1.416e-05, t7=3.854e-06
duration_diagGPU:4.189e-01
duration_diagreduce:7.500e-08
duration_diagtransform:4.320e-07
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.660e-02 S -----
rank=0 GPUmem(GB): used=5.548e-05 (oper)=5.548e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.974e-04 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper,hinter)=5.548e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.403e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=4.236e-03,5.167e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.001e-02 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.172e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.619e-07 batch[need]=8.513e-04 blksize=12 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=9.689e-04 (oper,hinter,dvdson,batch)=5.548e-05,6.169e-05,4.619e-07,8.513e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=31 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.188e-03,1.018e-02,3.032e-02,1.256e-02,5.426e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.183e-03 speed=3.905e-04GB/S T(nccl)=4.705e-06 speed=9.818e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=115 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=8.8e+06
 sigma[gemm] counter=115 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=7.7e-03 per=1.5e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=115 i=3 t=7.6e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=115 i=4 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=115 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=115 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=115 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=115 t=1.1e+00 per=1.9e+01 cost=3.7e+06 flops=3.4e+06
 sigma_tot[gemm] counter=115 i=0 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=2.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=8.5e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=115 i=3 t=8.5e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=115 i=4 t=8.4e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=115 i=5 t=8.4e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=115 total t=3.4e+00 per=5.8e+01 cost=6.5e+06 flops=1.9e+06
 sigma_tot[red] counter=115 t=1.4e+00 per=2.4e+01 cost=1.7e+06 flops=1.2e+06
T(sub)=9.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.5e-06,1.9e-06,7.5e-07,1.7e-07
settings: ndim=31 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323142503667 -1.116e+03  3.263e-03    1     1  5.437e-02 5.437e-02 5.435e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.357e-03,1.007e-02,3.037e-02,1.246e-02,5.426e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.352e-03 speed=3.416e-04GB/S T(nccl)=4.685e-06 speed=9.860e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=116 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=8.9e+06
 sigma[gemm] counter=116 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=7.7e-03 per=1.4e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=116 i=3 t=7.5e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=116 i=4 t=7.6e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=116 i=5 t=7.6e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=116 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=116 t=1.2e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=116 t=1.1e+00 per=1.9e+01 cost=3.8e+06 flops=3.4e+06
 sigma_tot[gemm] counter=116 i=0 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=2.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=8.6e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=116 i=3 t=8.6e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=116 i=4 t=8.5e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=116 i=5 t=8.5e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=116 total t=3.4e+00 per=5.8e+01 cost=6.7e+06 flops=2.0e+06
 sigma_tot[red] counter=116 t=1.4e+00 per=2.4e+01 cost=1.7e+06 flops=1.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.3e-05,3.3e-06,9.7e-07,2.2e-07
    2   0 -    -116.323153793083 -1.129e-05  2.010e-04    2     2  1.224e-01 6.121e-02 5.436e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.894e-04,1.016e-02,3.034e-02,1.258e-02,5.339e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=2.830e-04 speed=1.632e-03GB/S T(nccl)=6.326e-06 speed=7.302e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=117 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=8.9e+06
 sigma[gemm] counter=117 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=7.5e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=117 i=3 t=7.7e-03 per=1.4e+01 cost=3.3e+04 flops=4.3e+06
 sigma[gemm] counter=117 i=4 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=117 i=5 t=7.6e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=117 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=117 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=117 t=1.1e+00 per=1.9e+01 cost=3.9e+06 flops=3.5e+06
 sigma_tot[gemm] counter=117 i=0 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=2.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=8.6e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=117 i=3 t=8.6e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=117 i=4 t=8.6e-01 per=1.4e+01 cost=1.6e+06 flops=1.8e+06
 sigma_tot[gemm] counter=117 i=5 t=8.6e-01 per=1.4e+01 cost=1.6e+06 flops=1.8e+06
 sigma_tot[gemm] counter=117 total t=3.4e+00 per=5.8e+01 cost=6.8e+06 flops=2.0e+06
 sigma_tot[red] counter=117 t=1.4e+00 per=2.4e+01 cost=1.8e+06 flops=1.3e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.7e-05,2.9e-06,1.2e-06,2.1e-07
    3   0 +    -116.323153873735 -8.065e-08  1.462e-05    3     3  1.885e-01 6.282e-02 5.407e-02
TIMING FOR Davidson : 1.885e-01  T(cal/comm/rest)=1.622e-01,2.950e-07,2.628e-02
decomposed t_rest=2.628e-02
 T(sub)    =5.846e-05 per=2.225e-01
 T(precond)=2.612e-02 per=9.942e+01
 T(ortho)  =1.195e-05 per=4.547e-02
 T(xcopy)  =4.780e-07 per=1.819e-03
 T(xnrm2)  =1.402e-06 per=5.335e-03
 T(other)  =8.001e-05 per=3.045e-01
optimized energies: isweep=0 ibond=26 dots=1 e[0]=-116.323153873735 nmvp=3
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.747e-04 change=1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=8 dimAll=28
 (15,-1):4 (15,-3):2 (16,-2):7 (17,-1):5 (17,-3):3 (18,-2):1 (16,0):4 (16,-4):2
timing for divide=9.8e-06
timing for compute=1.1e-02
timing for collect=3.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.8e-06,1.1e-02,0.0e+00,4.8e-06,3.3e-05 -----
decimation summary: 28->6 dwt=+0.000e+00 SvN=1.010e+00
 qbond: qkept nsym=3 dimAll=6
 (16,0):3 (16,-2):2 (17,-1):1
----- TIMING for decimation_row(nkr): 1.140e-02 S T(decim/select/formRot)=1.103e-02,3.343e-04,3.102e-05 -----
----- TIMING FOR onedot_decimation: 1.152e-02 S T(wf/decim)=5.193e-05,1.147e-02 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.747e-04 change=1.895e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 2.648e-02 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper)=5.548e-05
rank=0 GPUmem(GB): used=1.174e-04 (oper,site)=5.548e-05,2.310e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.309e-03 S -----
rank=0 GPUmem(GB): used=1.791e-04 (oper,site,rinter)=5.548e-05,2.310e-07,6.169e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.826e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=4.788e-03,3.039e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.235e-03 S size(rtasks)=365 size(Rlst)=2015 -----
rank=0 GPUmem(GB): used=1.791e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.354e-04 blksize=12 blksize0=4 batchsize=2015
rank=0 GPUmem(GB): used=6.145e-04 (oper,site,rinter,batch)=5.548e-05,2.310e-07,6.169e-05,4.354e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.315e-03,2.264e-02,1.004e-02
----- TIMING FOR renorm : t_inter=7.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=27 t=7.3e-03 per=1.8e+01 cost=4.5e+04 flops=6.2e+06
 renorm[gemm] counter=27 i=0 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=2 t=7.6e-03 per=1.9e+01 cost=4.8e+03 flops=6.3e+05
 renorm[gemm] counter=27 i=3 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.8e+06
 renorm[gemm] counter=27 i=4 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=6 t=7.6e-03 per=1.9e+01 cost=4.3e+04 flops=5.7e+06
 renorm[gemm] counter=27 total t=2.3e-02 per=5.7e+01 cost=7.6e+04 flops=3.4e+06
 renorm[red] counter=27 t=1.0e-02 per=2.5e+01 cost=1.5e+04 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=1.5e-01 t_gemm=5.9e-01 t_reduction=2.6e-01 tot=1.0e+00 -----
 renorm_tot[inter] counter=27 t=1.5e-01 per=1.5e+01 cost=9.9e+05 flops=6.4e+06
 renorm_tot[gemm] counter=27 i=0 t=4.2e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=1 t=3.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=2 t=7.4e-02 per=7.4e+00 cost=2.0e+05 flops=2.7e+06
 renorm_tot[gemm] counter=27 i=3 t=7.5e-02 per=7.5e+00 cost=2.4e+05 flops=3.2e+06
 renorm_tot[gemm] counter=27 i=4 t=1.2e-01 per=1.2e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=27 i=5 t=1.2e-01 per=1.2e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=27 i=6 t=2.0e-01 per=2.0e+01 cost=2.7e+06 flops=1.4e+07
 renorm_tot[gemm] counter=27 total t=5.9e-01 per=5.9e+01 cost=3.7e+06 flops=6.2e+06
 renorm_tot[red] counter=27 t=2.6e-01 per=2.6e+01 cost=1.3e+06 flops=4.8e+06
qops.to_cpu: size(tot)=1860:1.4e-02MB:1.4e-05GB T(to_cpu)=3.3e-04S speed=4.2e-02GB/S
check ||H-H.dagger||=5.145e-15 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.0918 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.526e-04 change=1.369e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.831e-03 change=-2.671e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.831e-03 change=-6.855e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.856e-01 S #####
 T(local opt: fetch) = 1.243e-02 S  per = 1.58  per(accum) = 1.58
 T(local opt: hdiag) = 4.189e-01 S  per = 53.3  per(accum) = 54.9
 T(local opt: dvdsn) = 2.488e-01 S  per = 31.7  per(accum) = 86.6
 T(local opt: decim) = 1.154e-02 S  per = 1.47  per(accum) = 88
 T(local opt: guess) = 1.072e-04 S  per = 0.0136  per(accum) = 88.1
 T(local opt: renrm) = 9.365e-02 S  per = 11.9  per(accum) = 100
 T(local opt: save ) = 2.181e-04 S  per = 0.0278  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.488e-01 S  T(sum) = 2.485e-01 S  per = 9.988e+01
 T(local opt: preprocess                  ) = 9.924e-05 S  per = 0.0399  per(accum) = 0.0399
 T(local opt: symbolic_formulae           ) = 2.661e-02 S  per = 10.7  per(accum) = 10.7
 T(local opt: hintermediate init          ) = 7.173e-04 S  per = 0.289  per(accum) = 11
 T(local opt: preprocess_hformulae_Hxlist ) = 1.013e-02 S  per = 4.08  per(accum) = 15.1
 T(local opt: hmmtasks init               ) = 2.243e-02 S  per = 9.03  per(accum) = 24.1
 T(local opt: initial guess for dvdson    ) = 2.664e-06 S  per = 0.00107  per(accum) = 24.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.594e-01 S  per = 64.1  per(accum) = 88.3
 T(local opt: dvdson [cpu-gpu]            ) = 2.819e-03 S  per = 1.13  per(accum) = 89.4
 T(local opt: dvdson [nccl]               ) = 1.572e-05 S  per = 0.00633  per(accum) = 89.4
 T(local opt: dvdson [mpi]                ) = 2.950e-07 S  per = 0.000119  per(accum) = 89.4
 T(local opt: dvdson [rest part(linalg)]  ) = 2.628e-02 S  per = 10.6  per(accum) = 100
Detailed decomposition of T(renrm) = 9.365e-02 S  T(sum) = 9.365e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.552e-05 S  per = 0.0806  per(accum) = 0.0806
 T(local opt: qops init                    ) = 2.505e-03 S  per = 2.67  per(accum) = 2.76
 T(local opt: symbolic_formulae_renorm     ) = 2.649e-02 S  per = 28.3  per(accum) = 31
 T(local opt: allocate qops on gpu         ) = 5.440e-05 S  per = 0.0581  per(accum) = 31.1
 T(local opt: site memcpy cpu2gpu          ) = 2.061e-04 S  per = 0.22  per(accum) = 31.3
 T(local opt: rintermediate init           ) = 1.323e-03 S  per = 1.41  per(accum) = 32.7
 T(local opt: preprocess_formulae_Rlist2   ) = 8.301e-03 S  per = 8.86  per(accum) = 41.6
 T(local opt: rmmtasks init                ) = 1.237e-02 S  per = 13.2  per(accum) = 54.8
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 4.48e-05  per(accum) = 54.8
 T(local opt: preprocess_renorm_batchGPU   ) = 4.007e-02 S  per = 42.8  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 7.770e-05 S  per = 0.083  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 5.300e-08 S  per = 5.66e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 4.200e-08 S  per = 4.48e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 3.474e-04 S  per = 0.371  per(accum) = 98.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.688e-05 S  per = 0.018  per(accum) = 98.1
 T(local opt: qops_pool join and erase     ) = 1.804e-03 S  per = 1.93  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.563e-06 S  per = 0.00167  per(accum) = 100
##### sweep opt: 1.552e+01 S #####
 T(sweep opt: fetch) = 3.383e-01 S  per = 2.18  per(accum) = 2.18
 T(sweep opt: hdiag) = 5.000e+00 S  per = 32.2  per(accum) = 34.4
 T(sweep opt: dvdsn) = 7.962e+00 S  per = 51.3  per(accum) = 85.7
 T(sweep opt: decim) = 2.862e-01 S  per = 1.84  per(accum) = 87.6
 T(sweep opt: guess) = 2.571e-03 S  per = 0.0166  per(accum) = 87.6
 T(sweep opt: renrm) = 1.920e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 6.401e-03 S  per = 0.0413  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.962e+00 S  T(sum) = 7.955e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.728e-03 S  per = 0.0343  per(accum) = 0.0343
 T(sweep opt: symbolic_formulae           ) = 3.537e-01 S  per = 4.45  per(accum) = 4.48
 T(sweep opt: hintermediate init          ) = 9.370e-03 S  per = 0.118  per(accum) = 4.6
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.123e-01 S  per = 1.41  per(accum) = 6.01
 T(sweep opt: hmmtasks init               ) = 2.139e-01 S  per = 2.69  per(accum) = 8.7
 T(sweep opt: initial guess for dvdson    ) = 8.309e-05 S  per = 0.00104  per(accum) = 8.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.994e+00 S  per = 75.4  per(accum) = 84.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.517e-01 S  per = 1.91  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 7.129e-04 S  per = 0.00896  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 1.411e-05 S  per = 0.000177  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.116e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.920e+00 S  T(sum) = 1.920e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.108e-03 S  per = 0.162  per(accum) = 0.162
 T(sweep opt: qops init                    ) = 5.020e-02 S  per = 2.61  per(accum) = 2.78
 T(sweep opt: symbolic_formulae_renorm     ) = 3.353e-01 S  per = 17.5  per(accum) = 20.2
 T(sweep opt: allocate qops on gpu         ) = 1.557e-03 S  per = 0.0811  per(accum) = 20.3
 T(sweep opt: site memcpy cpu2gpu          ) = 3.217e-02 S  per = 1.68  per(accum) = 22
 T(sweep opt: rintermediate init           ) = 6.162e-02 S  per = 3.21  per(accum) = 25.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.087e-01 S  per = 5.66  per(accum) = 30.9
 T(sweep opt: rmmtasks init                ) = 2.188e-01 S  per = 11.4  per(accum) = 42.3
 T(sweep opt: qops memset on cpu           ) = 1.153e-06 S  per = 6e-05  per(accum) = 42.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.008e+00 S  per = 52.5  per(accum) = 94.7
 T(sweep opt: deallocate cpu and gpu memory) = 2.663e-03 S  per = 0.139  per(accum) = 94.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.573e-06 S  per = 8.19e-05  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.088e-06 S  per = 5.67e-05  per(accum) = 94.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.327e-03 S  per = 0.277  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.283e-04 S  per = 0.0275  per(accum) = 95.2
 T(sweep opt: qops_pool join and erase     ) = 3.875e-02 S  per = 2.02  per(accum) = 97.2
 T(sweep opt: conversion from opAB to opPQ ) = 5.404e-02 S  per = 2.81  per(accum) = 100
##### global opt: 1.552e+01 S #####
 T(global opt: fetch) = 3.383e-01 S  per = 2.18  per(accum) = 2.18
 T(global opt: hdiag) = 5.000e+00 S  per = 32.2  per(accum) = 34.4
 T(global opt: dvdsn) = 7.962e+00 S  per = 51.3  per(accum) = 85.7
 T(global opt: decim) = 2.862e-01 S  per = 1.84  per(accum) = 87.6
 T(global opt: guess) = 2.571e-03 S  per = 0.0166  per(accum) = 87.6
 T(global opt: renrm) = 1.920e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 6.401e-03 S  per = 0.0413  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.962e+00 S  T(sum) = 7.955e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.728e-03 S  per = 0.0343  per(accum) = 0.0343
 T(global opt: symbolic_formulae           ) = 3.537e-01 S  per = 4.45  per(accum) = 4.48
 T(global opt: hintermediate init          ) = 9.370e-03 S  per = 0.118  per(accum) = 4.6
 T(global opt: preprocess_hformulae_Hxlist ) = 1.123e-01 S  per = 1.41  per(accum) = 6.01
 T(global opt: hmmtasks init               ) = 2.139e-01 S  per = 2.69  per(accum) = 8.7
 T(global opt: initial guess for dvdson    ) = 8.309e-05 S  per = 0.00104  per(accum) = 8.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.994e+00 S  per = 75.4  per(accum) = 84.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.517e-01 S  per = 1.91  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 7.129e-04 S  per = 0.00896  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 1.411e-05 S  per = 0.000177  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 1.116e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.920e+00 S  T(sum) = 1.920e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.108e-03 S  per = 0.162  per(accum) = 0.162
 T(global opt: qops init                    ) = 5.020e-02 S  per = 2.61  per(accum) = 2.78
 T(global opt: symbolic_formulae_renorm     ) = 3.353e-01 S  per = 17.5  per(accum) = 20.2
 T(global opt: allocate qops on gpu         ) = 1.557e-03 S  per = 0.0811  per(accum) = 20.3
 T(global opt: site memcpy cpu2gpu          ) = 3.217e-02 S  per = 1.68  per(accum) = 22
 T(global opt: rintermediate init           ) = 6.162e-02 S  per = 3.21  per(accum) = 25.2
 T(global opt: preprocess_formulae_Rlist2   ) = 1.087e-01 S  per = 5.66  per(accum) = 30.9
 T(global opt: rmmtasks init                ) = 2.188e-01 S  per = 11.4  per(accum) = 42.3
 T(global opt: qops memset on cpu           ) = 1.153e-06 S  per = 6e-05  per(accum) = 42.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.008e+00 S  per = 52.5  per(accum) = 94.7
 T(global opt: deallocate cpu and gpu memory) = 2.663e-03 S  per = 0.139  per(accum) = 94.9
 T(global opt: construct opS [ifdists=true] ) = 1.573e-06 S  per = 8.19e-05  per(accum) = 94.9
 T(global opt: reduction of opS & opH [nccl]) = 1.088e-06 S  per = 5.67e-05  per(accum) = 94.9
 T(global opt: qops memcpy gpu2cpu          ) = 5.327e-03 S  per = 0.277  per(accum) = 95.1
 T(global opt: reduction of opS & opH [mpi] ) = 5.283e-04 S  per = 0.0275  per(accum) = 95.2
 T(global opt: qops_pool join and erase     ) = 3.875e-02 S  per = 2.02  per(accum) = 97.2
 T(global opt: conversion from opAB to opPQ ) = 5.404e-02 S  per = 2.81  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=27/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=1213:9.254e-03MB:9.038e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:2.66 S:3.98 A:0 B:92.4 
 rqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5702:0.0435MB:4.25e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.042e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.109e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x37e22fa0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (12,0):3 (12,2):2 (11,1):1
 qbond: qcol nsym=3 dimAll=6
 (16,0):3 (16,-2):2 (17,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=2.649e-01 t1=2.408e-05, t2=2.199e-03, t3=2.482e-03, t4=2.602e-01, t5=5.602e-06, t6=1.414e-05, t7=4.549e-06
duration_diagGPU:2.649e-01
duration_diagreduce:9.000e-08
duration_diagtransform:4.150e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.152e-02 S -----
rank=0 GPUmem(GB): used=4.248e-05 (oper)=4.248e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.261e-04 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper,hinter)=4.248e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.592e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.180e-03,3.412e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.996e-03 S size(H_formulae)=1327 size(Hxlst)=2830 -----
rank=0 GPUmem(GB): used=9.690e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=4.639e-04 blksize=9 blksize0=3 batchsize=2830
rank=0 GPUmem(GB): used=5.611e-04 (oper,hinter,dvdson,batch)=4.248e-05,5.442e-05,2.831e-07,4.639e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.800e-04,1.002e-02,2.967e-02,1.245e-02,5.283e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=6.753e-04 speed=4.193e-04GB/S T(nccl)=4.710e-06 speed=6.011e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=118 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=118 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=7.4e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=118 i=3 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=118 i=4 t=7.4e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=118 i=5 t=7.4e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=118 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=118 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.5e+00 t_reduction=1.4e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=118 t=1.1e+00 per=1.9e+01 cost=3.9e+06 flops=3.5e+06
 sigma_tot[gemm] counter=118 i=0 t=2.3e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=2.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=8.7e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=118 i=3 t=8.7e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=118 i=4 t=8.6e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=118 i=5 t=8.6e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=118 total t=3.5e+00 per=5.8e+01 cost=6.9e+06 flops=2.0e+06
 sigma_tot[red] counter=118 t=1.4e+00 per=2.4e+01 cost=1.8e+06 flops=1.3e+06
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.2e-06,4.1e-06,1.9e-06,7.3e-07,1.7e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323153873735 -1.116e+03  3.184e-02    1     1  5.293e-02 5.293e-02 5.291e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.633e-03,1.010e-02,3.016e-02,1.247e-02,5.438e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.628e-03 speed=1.740e-04GB/S T(nccl)=5.657e-06 speed=5.005e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=119 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=119 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=119 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=119 i=4 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=119 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=119 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=119 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.5e+00 t_reduction=1.4e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=119 t=1.1e+00 per=1.9e+01 cost=4.0e+06 flops=3.5e+06
 sigma_tot[gemm] counter=119 i=0 t=2.3e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=2.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=8.8e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=119 i=3 t=8.8e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=119 i=4 t=8.7e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=119 i=5 t=8.7e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=119 total t=3.5e+00 per=5.8e+01 cost=7.0e+06 flops=2.0e+06
 sigma_tot[red] counter=119 t=1.4e+00 per=2.4e+01 cost=1.8e+06 flops=1.3e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,3.2e-06,1.2e-06,2.1e-07
    2   0 -    -116.325715901524 -2.562e-03  8.671e-03    2     2  1.207e-01 6.037e-02 5.369e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.158e-04,1.001e-02,3.034e-02,1.257e-02,5.326e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=3.101e-04 speed=9.131e-04GB/S T(nccl)=5.753e-06 speed=4.921e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=120 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=120 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=120 i=3 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=120 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=120 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=120 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.7e+06
 sigma[red] counter=120 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=120 t=1.1e+00 per=1.9e+01 cost=4.0e+06 flops=3.5e+06
 sigma_tot[gemm] counter=120 i=0 t=2.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=2.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=8.9e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=120 i=3 t=8.9e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=120 i=4 t=8.8e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=120 i=5 t=8.8e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=120 total t=3.5e+00 per=5.8e+01 cost=7.1e+06 flops=2.0e+06
 sigma_tot[red] counter=120 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,2.9e-06,9.8e-07,1.8e-07
    3   0 -    -116.326034029175 -3.181e-04  7.341e-04    3     3  1.866e-01 6.221e-02 5.357e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.322e-03,1.011e-02,3.020e-02,1.250e-02,5.516e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=2.316e-03 speed=1.222e-04GB/S T(nccl)=5.869e-06 speed=4.824e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=121 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=121 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=121 i=3 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=121 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=121 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=121 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=121 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=121 t=1.2e+00 per=1.9e+01 cost=4.1e+06 flops=3.5e+06
 sigma_tot[gemm] counter=121 i=0 t=2.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=8.9e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=121 i=3 t=8.9e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=121 i=4 t=8.9e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=121 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=121 total t=3.6e+00 per=5.8e+01 cost=7.1e+06 flops=2.0e+06
 sigma_tot[red] counter=121 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.0e-06,1.0e-06,1.9e-07
    4   0 +    -116.326036515321 -2.486e-06  6.400e-05    3     4  2.545e-01 6.363e-02 5.399e-02
TIMING FOR Davidson : 2.545e-01  T(cal/comm/rest)=2.160e-01,4.450e-07,3.855e-02
decomposed t_rest=3.855e-02
 T(sub)    =7.392e-05 per=1.917e-01
 T(precond)=3.837e-02 per=9.953e+01
 T(ortho)  =2.167e-05 per=5.620e-02
 T(xcopy)  =6.880e-07 per=1.785e-03
 T(xnrm2)  =1.646e-06 per=4.269e-03
 T(other)  =8.246e-05 per=2.139e-01
optimized energies: isweep=0 ibond=27 dots=1 e[0]=-116.326036515321 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.518e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=8 dimAll=24
 (16,0):3 (16,-2):2 (17,-1):6 (18,0):4 (18,-2):3 (19,-1):1 (17,1):3 (17,-3):2
timing for divide=9.1e-06
timing for compute=1.2e-02
timing for collect=3.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.1e-06,1.2e-02,0.0e+00,4.5e-06,3.4e-05 -----
decimation summary: 24->6 dwt=+1.110e-16 SvN=1.096e+00
 qbond: qkept nsym=3 dimAll=6
 (18,0):3 (18,-2):2 (19,-1):1
----- TIMING for decimation_row(nkr): 1.271e-02 S T(decim/select/formRot)=1.249e-02,2.004e-04,2.109e-05 -----
----- TIMING FOR onedot_decimation: 1.278e-02 S T(wf/decim)=4.908e-05,1.273e-02 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.545e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.205e-02 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper)=4.248e-05
rank=0 GPUmem(GB): used=9.704e-05 (oper,site)=4.248e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.576e-03 S -----
rank=0 GPUmem(GB): used=1.515e-04 (oper,site,rinter)=4.248e-05,1.416e-07,5.442e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 5.849e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=3.706e-03,2.143e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.136e-03 S size(rtasks)=297 size(Rlst)=1452 -----
rank=0 GPUmem(GB): used=1.515e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.380e-04 blksize=9 blksize0=3 batchsize=1452
rank=0 GPUmem(GB): used=3.895e-04 (oper,site,rinter,batch)=4.248e-05,1.416e-07,5.442e-05,2.380e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.773e-03,2.278e-02,1.015e-02
----- TIMING FOR renorm : t_inter=5.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=28 t=5.8e-03 per=1.5e+01 cost=2.5e+04 flops=4.3e+06
 renorm[gemm] counter=28 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=2 t=7.7e-03 per=2.0e+01 cost=3.3e+03 flops=4.4e+05
 renorm[gemm] counter=28 i=3 t=7.5e-03 per=1.9e+01 cost=1.2e+04 flops=1.5e+06
 renorm[gemm] counter=28 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=6 t=7.6e-03 per=2.0e+01 cost=2.9e+04 flops=3.8e+06
 renorm[gemm] counter=28 total t=2.3e-02 per=5.9e+01 cost=4.4e+04 flops=1.9e+06
 renorm[red] counter=28 t=1.0e-02 per=2.6e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=6.1e-01 t_reduction=2.7e-01 tot=1.0e+00 -----
 renorm_tot[inter] counter=28 t=1.6e-01 per=1.5e+01 cost=1.0e+06 flops=6.3e+06
 renorm_tot[gemm] counter=28 i=0 t=4.4e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=1 t=3.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=2 t=8.2e-02 per=7.8e+00 cost=2.0e+05 flops=2.5e+06
 renorm_tot[gemm] counter=28 i=3 t=8.3e-02 per=7.9e+00 cost=2.5e+05 flops=3.0e+06
 renorm_tot[gemm] counter=28 i=4 t=1.2e-01 per=1.2e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=28 i=5 t=1.2e-01 per=1.2e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=28 i=6 t=2.0e-01 per=2.0e+01 cost=2.8e+06 flops=1.4e+07
 renorm_tot[gemm] counter=28 total t=6.1e-01 per=5.9e+01 cost=3.7e+06 flops=6.1e+06
 renorm_tot[red] counter=28 t=2.7e-01 per=2.6e+01 cost=1.3e+06 flops=4.7e+06
qops.to_cpu: size(tot)=1506:1.1e-02MB:1.1e-05GB T(to_cpu)=2.8e-04S speed=4.0e-02GB/S
check ||H-H.dagger||=1.310e-15 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0814 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.109e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=9.995e-04 change=-2.332e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=9.995e-04 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.712e-01 S #####
 T(local opt: fetch) = 1.127e-02 S  per = 1.68  per(accum) = 1.68
 T(local opt: hdiag) = 2.650e-01 S  per = 39.5  per(accum) = 41.2
 T(local opt: dvdsn) = 2.989e-01 S  per = 44.5  per(accum) = 85.7
 T(local opt: decim) = 1.279e-02 S  per = 1.91  per(accum) = 87.6
 T(local opt: guess) = 8.342e-05 S  per = 0.0124  per(accum) = 87.6
 T(local opt: renrm) = 8.298e-02 S  per = 12.4  per(accum) = 100
 T(local opt: save ) = 1.846e-04 S  per = 0.0275  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.989e-01 S  T(sum) = 2.986e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 9.935e-05 S  per = 0.0333  per(accum) = 0.0333
 T(local opt: symbolic_formulae           ) = 2.153e-02 S  per = 7.21  per(accum) = 7.24
 T(local opt: hintermediate init          ) = 5.429e-04 S  per = 0.182  per(accum) = 7.43
 T(local opt: preprocess_hformulae_Hxlist ) = 7.077e-03 S  per = 2.37  per(accum) = 9.8
 T(local opt: hmmtasks init               ) = 1.485e-02 S  per = 4.97  per(accum) = 14.8
 T(local opt: initial guess for dvdson    ) = 2.450e-06 S  per = 0.00082  per(accum) = 14.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.110e-01 S  per = 70.7  per(accum) = 85.4
 T(local opt: dvdson [cpu-gpu]            ) = 4.929e-03 S  per = 1.65  per(accum) = 87.1
 T(local opt: dvdson [nccl]               ) = 2.199e-05 S  per = 0.00736  per(accum) = 87.1
 T(local opt: dvdson [mpi]                ) = 4.450e-07 S  per = 0.000149  per(accum) = 87.1
 T(local opt: dvdson [rest part(linalg)]  ) = 3.855e-02 S  per = 12.9  per(accum) = 100
Detailed decomposition of T(renrm) = 8.298e-02 S  T(sum) = 8.298e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.128e-05 S  per = 0.0859  per(accum) = 0.0859
 T(local opt: qops init                    ) = 2.040e-03 S  per = 2.46  per(accum) = 2.54
 T(local opt: symbolic_formulae_renorm     ) = 2.206e-02 S  per = 26.6  per(accum) = 29.1
 T(local opt: allocate qops on gpu         ) = 5.355e-05 S  per = 0.0645  per(accum) = 29.2
 T(local opt: site memcpy cpu2gpu          ) = 7.531e-04 S  per = 0.908  per(accum) = 30.1
 T(local opt: rintermediate init           ) = 2.593e-03 S  per = 3.12  per(accum) = 33.2
 T(local opt: preprocess_formulae_Rlist2   ) = 6.184e-03 S  per = 7.45  per(accum) = 40.7
 T(local opt: rmmtasks init                ) = 8.565e-03 S  per = 10.3  per(accum) = 51
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 5.3e-05  per(accum) = 51
 T(local opt: preprocess_renorm_batchGPU   ) = 3.879e-02 S  per = 46.7  per(accum) = 97.8
 T(local opt: deallocate cpu and gpu memory) = 6.681e-05 S  per = 0.0805  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 5.06e-05  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 4.400e-08 S  per = 5.3e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 2.868e-04 S  per = 0.346  per(accum) = 98.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.536e-05 S  per = 0.0185  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 1.496e-03 S  per =  1.8  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.362e-06 S  per = 0.00164  per(accum) = 100
##### sweep opt: 1.619e+01 S #####
 T(sweep opt: fetch) = 3.495e-01 S  per = 2.16  per(accum) = 2.16
 T(sweep opt: hdiag) = 5.265e+00 S  per = 32.5  per(accum) = 34.7
 T(sweep opt: dvdsn) = 8.261e+00 S  per =   51  per(accum) = 85.7
 T(sweep opt: decim) = 2.990e-01 S  per = 1.85  per(accum) = 87.6
 T(sweep opt: guess) = 2.655e-03 S  per = 0.0164  per(accum) = 87.6
 T(sweep opt: renrm) = 2.003e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 6.586e-03 S  per = 0.0407  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.261e+00 S  T(sum) = 8.254e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.827e-03 S  per = 0.0343  per(accum) = 0.0343
 T(sweep opt: symbolic_formulae           ) = 3.753e-01 S  per = 4.55  per(accum) = 4.58
 T(sweep opt: hintermediate init          ) = 9.913e-03 S  per = 0.12  per(accum) = 4.7
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.194e-01 S  per = 1.45  per(accum) = 6.15
 T(sweep opt: hmmtasks init               ) = 2.287e-01 S  per = 2.77  per(accum) = 8.92
 T(sweep opt: initial guess for dvdson    ) = 8.554e-05 S  per = 0.00104  per(accum) = 8.92
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.205e+00 S  per = 75.2  per(accum) = 84.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.567e-01 S  per =  1.9  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 7.348e-04 S  per = 0.0089  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 1.456e-05 S  per = 0.000176  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.155e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 2.003e+00 S  T(sum) = 2.003e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.179e-03 S  per = 0.159  per(accum) = 0.159
 T(sweep opt: qops init                    ) = 5.224e-02 S  per = 2.61  per(accum) = 2.77
 T(sweep opt: symbolic_formulae_renorm     ) = 3.573e-01 S  per = 17.8  per(accum) = 20.6
 T(sweep opt: allocate qops on gpu         ) = 1.611e-03 S  per = 0.0804  per(accum) = 20.7
 T(sweep opt: site memcpy cpu2gpu          ) = 3.292e-02 S  per = 1.64  per(accum) = 22.3
 T(sweep opt: rintermediate init           ) = 6.421e-02 S  per = 3.21  per(accum) = 25.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.149e-01 S  per = 5.73  per(accum) = 31.3
 T(sweep opt: rmmtasks init                ) = 2.273e-01 S  per = 11.3  per(accum) = 42.6
 T(sweep opt: qops memset on cpu           ) = 1.197e-06 S  per = 5.98e-05  per(accum) = 42.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.046e+00 S  per = 52.2  per(accum) = 94.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.729e-03 S  per = 0.136  per(accum) = 95
 T(sweep opt: construct opS [ifdists=true] ) = 1.615e-06 S  per = 8.06e-05  per(accum) = 95
 T(sweep opt: reduction of opS & opH [nccl]) = 1.132e-06 S  per = 5.65e-05  per(accum) = 95
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.614e-03 S  per = 0.28  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.436e-04 S  per = 0.0271  per(accum) = 95.3
 T(sweep opt: qops_pool join and erase     ) = 4.025e-02 S  per = 2.01  per(accum) = 97.3
 T(sweep opt: conversion from opAB to opPQ ) = 5.405e-02 S  per =  2.7  per(accum) = 100
##### global opt: 1.619e+01 S #####
 T(global opt: fetch) = 3.495e-01 S  per = 2.16  per(accum) = 2.16
 T(global opt: hdiag) = 5.265e+00 S  per = 32.5  per(accum) = 34.7
 T(global opt: dvdsn) = 8.261e+00 S  per =   51  per(accum) = 85.7
 T(global opt: decim) = 2.990e-01 S  per = 1.85  per(accum) = 87.6
 T(global opt: guess) = 2.655e-03 S  per = 0.0164  per(accum) = 87.6
 T(global opt: renrm) = 2.003e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 6.586e-03 S  per = 0.0407  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.261e+00 S  T(sum) = 8.254e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.827e-03 S  per = 0.0343  per(accum) = 0.0343
 T(global opt: symbolic_formulae           ) = 3.753e-01 S  per = 4.55  per(accum) = 4.58
 T(global opt: hintermediate init          ) = 9.913e-03 S  per = 0.12  per(accum) = 4.7
 T(global opt: preprocess_hformulae_Hxlist ) = 1.194e-01 S  per = 1.45  per(accum) = 6.15
 T(global opt: hmmtasks init               ) = 2.287e-01 S  per = 2.77  per(accum) = 8.92
 T(global opt: initial guess for dvdson    ) = 8.554e-05 S  per = 0.00104  per(accum) = 8.92
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.205e+00 S  per = 75.2  per(accum) = 84.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.567e-01 S  per =  1.9  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 7.348e-04 S  per = 0.0089  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 1.456e-05 S  per = 0.000176  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 1.155e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 2.003e+00 S  T(sum) = 2.003e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.179e-03 S  per = 0.159  per(accum) = 0.159
 T(global opt: qops init                    ) = 5.224e-02 S  per = 2.61  per(accum) = 2.77
 T(global opt: symbolic_formulae_renorm     ) = 3.573e-01 S  per = 17.8  per(accum) = 20.6
 T(global opt: allocate qops on gpu         ) = 1.611e-03 S  per = 0.0804  per(accum) = 20.7
 T(global opt: site memcpy cpu2gpu          ) = 3.292e-02 S  per = 1.64  per(accum) = 22.3
 T(global opt: rintermediate init           ) = 6.421e-02 S  per = 3.21  per(accum) = 25.5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.149e-01 S  per = 5.73  per(accum) = 31.3
 T(global opt: rmmtasks init                ) = 2.273e-01 S  per = 11.3  per(accum) = 42.6
 T(global opt: qops memset on cpu           ) = 1.197e-06 S  per = 5.98e-05  per(accum) = 42.6
 T(global opt: preprocess_renorm_batchGPU   ) = 1.046e+00 S  per = 52.2  per(accum) = 94.8
 T(global opt: deallocate cpu and gpu memory) = 2.729e-03 S  per = 0.136  per(accum) = 95
 T(global opt: construct opS [ifdists=true] ) = 1.615e-06 S  per = 8.06e-05  per(accum) = 95
 T(global opt: reduction of opS & opH [nccl]) = 1.132e-06 S  per = 5.65e-05  per(accum) = 95
 T(global opt: qops memcpy gpu2cpu          ) = 5.614e-03 S  per = 0.28  per(accum) = 95.3
 T(global opt: reduction of opS & opH [mpi] ) = 5.436e-04 S  per = 0.0271  per(accum) = 95.3
 T(global opt: qops_pool join and erase     ) = 4.025e-02 S  per = 2.01  per(accum) = 97.3
 T(global opt: conversion from opAB to opPQ ) = 5.405e-02 S  per =  2.7  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.518e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=28/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=1213:9.254e-03MB:9.038e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:2.94 S:5.45 A:0 B:90.4 
 rqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5034:0.0384MB:3.75e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.009e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-9.179e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x3ad2e640
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (10,0):3 (10,2):2 (9,1):1
 qbond: qcol nsym=3 dimAll=6
 (18,0):3 (18,-2):2 (19,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=2.152e-01 t1=2.402e-05, t2=2.241e-03, t3=2.511e-03, t4=2.104e-01, t5=6.570e-06, t6=1.934e-05, t7=4.671e-06
duration_diagGPU:2.152e-01
duration_diagreduce:4.400e-08
duration_diagtransform:4.610e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.785e-02 S -----
rank=0 GPUmem(GB): used=3.751e-05 (oper)=3.751e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.275e-04 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper,hinter)=3.751e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.228e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.589e-03,2.639e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.566e-03 S size(H_formulae)=1053 size(Hxlst)=2250 -----
rank=0 GPUmem(GB): used=8.382e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=3.688e-04 blksize=9 blksize0=3 batchsize=2250
rank=0 GPUmem(GB): used=4.529e-04 (oper,hinter,dvdson,batch)=3.751e-05,4.631e-05,2.831e-07,3.688e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.133e-03,9.959e-03,3.027e-02,1.252e-02,5.389e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.128e-03 speed=2.510e-04GB/S T(nccl)=5.208e-06 speed=5.436e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=122 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=122 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=122 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=122 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=122 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=122 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=122 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=122 t=1.2e+00 per=1.9e+01 cost=4.1e+06 flops=3.5e+06
 sigma_tot[gemm] counter=122 i=0 t=2.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=9.0e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=122 i=3 t=9.0e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=122 i=4 t=8.9e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=122 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=122 total t=3.6e+00 per=5.8e+01 cost=7.2e+06 flops=2.0e+06
 sigma_tot[red] counter=122 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,4.7e-06,1.9e-06,7.8e-07,1.6e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.326036515321 -1.116e+03  2.733e-02    1     1  5.400e-02 5.400e-02 5.398e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.072e-03,9.894e-03,3.005e-02,1.260e-02,5.463e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=2.066e-03 speed=1.370e-04GB/S T(nccl)=5.766e-06 speed=4.910e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=123 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=123 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=7.4e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=123 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=123 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=123 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=123 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=123 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=123 t=1.2e+00 per=1.9e+01 cost=4.2e+06 flops=3.5e+06
 sigma_tot[gemm] counter=123 i=0 t=2.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=9.1e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=123 i=3 t=9.1e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=123 i=4 t=9.0e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=123 i=5 t=9.0e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=123 total t=3.6e+00 per=5.8e+01 cost=7.3e+06 flops=2.0e+06
 sigma_tot[red] counter=123 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.4e-05,3.2e-06,8.6e-07,2.1e-07
    2   0 -    -116.328001626551 -1.965e-03  7.022e-03    2     2  1.216e-01 6.081e-02 5.435e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.849e-04,9.925e-03,3.022e-02,1.264e-02,5.340e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=5.791e-04 speed=4.889e-04GB/S T(nccl)=5.777e-06 speed=4.901e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=124 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=124 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=7.4e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=124 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=124 i=4 t=7.7e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=124 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=124 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=124 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=124 t=1.2e+00 per=1.9e+01 cost=4.2e+06 flops=3.5e+06
 sigma_tot[gemm] counter=124 i=0 t=2.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=9.1e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=124 i=3 t=9.2e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=124 i=4 t=9.1e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=124 i=5 t=9.1e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=124 total t=3.7e+00 per=5.8e+01 cost=7.3e+06 flops=2.0e+06
 sigma_tot[red] counter=124 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.5e-05,3.0e-06,1.1e-06,2.2e-07
    3   0 -    -116.328195629028 -1.940e-04  9.900e-04    3     3  1.874e-01 6.246e-02 5.406e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.907e-04,1.016e-02,3.001e-02,1.257e-02,5.324e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=4.853e-04 speed=5.834e-04GB/S T(nccl)=5.413e-06 speed=5.230e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=125 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.1e+06
 sigma[gemm] counter=125 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=125 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=125 i=4 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=125 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=125 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=125 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=125 t=1.2e+00 per=1.9e+01 cost=4.2e+06 flops=3.6e+06
 sigma_tot[gemm] counter=125 i=0 t=2.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=9.2e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=125 i=3 t=9.2e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=125 i=4 t=9.2e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=125 i=5 t=9.2e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=125 total t=3.7e+00 per=5.8e+01 cost=7.4e+06 flops=2.0e+06
 sigma_tot[red] counter=125 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,2.8e-06,1.0e-06,2.3e-07
    4   0 +    -116.328199520972 -3.892e-06  6.006e-05    3     4  2.531e-01 6.328e-02 5.388e-02
TIMING FOR Davidson : 2.531e-01  T(cal/comm/rest)=2.155e-01,4.930e-07,3.760e-02
decomposed t_rest=3.760e-02
 T(sub)    =8.060e-05 per=2.144e-01
 T(precond)=3.739e-02 per=9.945e+01
 T(ortho)  =2.086e-05 per=5.549e-02
 T(xcopy)  =6.170e-07 per=1.641e-03
 T(xnrm2)  =1.589e-06 per=4.226e-03
 T(other)  =1.032e-04 per=2.744e-01
optimized energies: isweep=0 ibond=28 dots=1 e[0]=-116.328199520972 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.252e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=8 dimAll=24
 (18,0):3 (18,-2):2 (19,-1):6 (20,0):4 (20,-2):3 (21,-1):1 (19,1):3 (19,-3):2
timing for divide=9.7e-06
timing for compute=9.5e-03
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 9.5e-03 S T(divide/compute[cpu/gpu/rest]/collect)=9.7e-06,9.4e-03,0.0e+00,4.2e-06,1.6e-05 -----
decimation summary: 24->6 dwt=+2.220e-16 SvN=1.154e+00
 qbond: qkept nsym=3 dimAll=6
 (20,0):3 (20,-2):2 (21,-1):1
----- TIMING for decimation_row(nkr): 9.745e-03 S T(decim/select/formRot)=9.515e-03,2.098e-04,1.968e-05 -----
----- TIMING FOR onedot_decimation: 9.815e-03 S T(wf/decim)=5.015e-05,9.765e-03 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.233e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 1.873e-02 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper)=3.751e-05
rank=0 GPUmem(GB): used=8.396e-05 (oper,site)=3.751e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.513e-03 S -----
rank=0 GPUmem(GB): used=1.303e-04 (oper,site,rinter)=3.751e-05,1.416e-07,4.631e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 4.753e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=2.977e-03,1.776e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.980e-03 S size(rtasks)=237 size(Rlst)=1164 -----
rank=0 GPUmem(GB): used=1.303e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.908e-04 blksize=9 blksize0=3 batchsize=1164
rank=0 GPUmem(GB): used=3.211e-04 (oper,site,rinter,batch)=3.751e-05,1.416e-07,4.631e-05,1.908e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.641e-03,2.267e-02,1.006e-02
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=29 t=6.6e-03 per=1.7e+01 cost=2.1e+04 flops=3.2e+06
 renorm[gemm] counter=29 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=2 t=7.5e-03 per=1.9e+01 cost=2.8e+03 flops=3.7e+05
 renorm[gemm] counter=29 i=3 t=7.6e-03 per=1.9e+01 cost=9.2e+03 flops=1.2e+06
 renorm[gemm] counter=29 i=4 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=6 t=7.6e-03 per=1.9e+01 cost=2.3e+04 flops=3.1e+06
 renorm[gemm] counter=29 total t=2.3e-02 per=5.8e+01 cost=3.5e+04 flops=1.6e+06
 renorm[red] counter=29 t=1.0e-02 per=2.6e+01 cost=1.3e+04 flops=1.3e+06
----- TIMING FOR renorm_tot : t_inter=1.7e-01 t_gemm=6.3e-01 t_reduction=2.8e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=29 t=1.7e-01 per=1.5e+01 cost=1.0e+06 flops=6.2e+06
 renorm_tot[gemm] counter=29 i=0 t=4.5e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=1 t=3.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=2 t=8.9e-02 per=8.2e+00 cost=2.0e+05 flops=2.3e+06
 renorm_tot[gemm] counter=29 i=3 t=9.0e-02 per=8.3e+00 cost=2.6e+05 flops=2.9e+06
 renorm_tot[gemm] counter=29 i=4 t=1.2e-01 per=1.1e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=29 i=5 t=1.2e-01 per=1.1e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=29 i=6 t=2.1e-01 per=2.0e+01 cost=2.8e+06 flops=1.3e+07
 renorm_tot[gemm] counter=29 total t=6.3e-01 per=5.9e+01 cost=3.8e+06 flops=5.9e+06
 renorm_tot[red] counter=29 t=2.8e-01 per=2.6e+01 cost=1.3e+06 flops=4.6e+06
qops.to_cpu: size(tot)=1192:9.1e-03MB:8.9e-06GB T(to_cpu)=2.2e-04S speed=4.0e-02GB/S
check ||H-H.dagger||=1.031e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0757 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.989e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=6.485e-04 change=-2.054e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=6.485e-04 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.032e-01 S #####
 T(local opt: fetch) = 1.200e-02 S  per = 1.99  per(accum) = 1.99
 T(local opt: hdiag) = 2.152e-01 S  per = 35.7  per(accum) = 37.7
 T(local opt: dvdsn) = 2.885e-01 S  per = 47.8  per(accum) = 85.5
 T(local opt: decim) = 9.825e-03 S  per = 1.63  per(accum) = 87.1
 T(local opt: guess) = 8.072e-05 S  per = 0.0134  per(accum) = 87.1
 T(local opt: renrm) = 7.724e-02 S  per = 12.8  per(accum) = 100
 T(local opt: save ) = 2.773e-04 S  per = 0.046  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.885e-01 S  T(sum) = 2.883e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 9.665e-05 S  per = 0.0335  per(accum) = 0.0335
 T(local opt: symbolic_formulae           ) = 1.786e-02 S  per = 6.19  per(accum) = 6.23
 T(local opt: hintermediate init          ) = 4.447e-04 S  per = 0.154  per(accum) = 6.38
 T(local opt: preprocess_hformulae_Hxlist ) = 5.633e-03 S  per = 1.95  per(accum) = 8.34
 T(local opt: hmmtasks init               ) = 1.116e-02 S  per = 3.87  per(accum) = 12.2
 T(local opt: initial guess for dvdson    ) = 3.002e-06 S  per = 0.00104  per(accum) = 12.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.112e-01 S  per = 73.3  per(accum) = 85.5
 T(local opt: dvdson [cpu-gpu]            ) = 4.259e-03 S  per = 1.48  per(accum) = 87
 T(local opt: dvdson [nccl]               ) = 2.216e-05 S  per = 0.00769  per(accum) = 87
 T(local opt: dvdson [mpi]                ) = 4.930e-07 S  per = 0.000171  per(accum) = 87
 T(local opt: dvdson [rest part(linalg)]  ) = 3.760e-02 S  per =   13  per(accum) = 100
Detailed decomposition of T(renrm) = 7.724e-02 S  T(sum) = 7.724e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.950e-05 S  per = 0.09  per(accum) = 0.09
 T(local opt: qops init                    ) = 1.743e-03 S  per = 2.26  per(accum) = 2.35
 T(local opt: symbolic_formulae_renorm     ) = 1.875e-02 S  per = 24.3  per(accum) = 26.6
 T(local opt: allocate qops on gpu         ) = 5.077e-05 S  per = 0.0657  per(accum) = 26.7
 T(local opt: site memcpy cpu2gpu          ) = 1.022e-03 S  per = 1.32  per(accum) = 28
 T(local opt: rintermediate init           ) = 2.526e-03 S  per = 3.27  per(accum) = 31.3
 T(local opt: preprocess_formulae_Rlist2   ) = 5.021e-03 S  per =  6.5  per(accum) = 37.8
 T(local opt: rmmtasks init                ) = 6.814e-03 S  per = 8.82  per(accum) = 46.6
 T(local opt: qops memset on cpu           ) = 5.400e-08 S  per = 6.99e-05  per(accum) = 46.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.946e-02 S  per = 51.1  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 5.496e-05 S  per = 0.0712  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 5.200e-08 S  per = 6.73e-05  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 4.79e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 2.276e-04 S  per = 0.295  per(accum) = 98.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.572e-05 S  per = 0.0203  per(accum) = 98.1
 T(local opt: qops_pool join and erase     ) = 1.481e-03 S  per = 1.92  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.405e-06 S  per = 0.00182  per(accum) = 100
##### sweep opt: 1.679e+01 S #####
 T(sweep opt: fetch) = 3.616e-01 S  per = 2.15  per(accum) = 2.15
 T(sweep opt: hdiag) = 5.480e+00 S  per = 32.6  per(accum) = 34.8
 T(sweep opt: dvdsn) = 8.550e+00 S  per = 50.9  per(accum) = 85.7
 T(sweep opt: decim) = 3.088e-01 S  per = 1.84  per(accum) = 87.6
 T(sweep opt: guess) = 2.736e-03 S  per = 0.0163  per(accum) = 87.6
 T(sweep opt: renrm) = 2.081e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 6.863e-03 S  per = 0.0409  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.550e+00 S  T(sum) = 8.542e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.924e-03 S  per = 0.0342  per(accum) = 0.0342
 T(sweep opt: symbolic_formulae           ) = 3.931e-01 S  per =  4.6  per(accum) = 4.64
 T(sweep opt: hintermediate init          ) = 1.036e-02 S  per = 0.121  per(accum) = 4.76
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.250e-01 S  per = 1.46  per(accum) = 6.22
 T(sweep opt: hmmtasks init               ) = 2.399e-01 S  per = 2.81  per(accum) = 9.03
 T(sweep opt: initial guess for dvdson    ) = 8.854e-05 S  per = 0.00104  per(accum) = 9.03
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.417e+00 S  per = 75.1  per(accum) = 84.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.609e-01 S  per = 1.88  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 7.570e-04 S  per = 0.00886  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 1.505e-05 S  per = 0.000176  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.192e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 2.081e+00 S  T(sum) = 2.081e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.249e-03 S  per = 0.156  per(accum) = 0.156
 T(sweep opt: qops init                    ) = 5.398e-02 S  per = 2.59  per(accum) = 2.75
 T(sweep opt: symbolic_formulae_renorm     ) = 3.761e-01 S  per = 18.1  per(accum) = 20.8
 T(sweep opt: allocate qops on gpu         ) = 1.662e-03 S  per = 0.0799  per(accum) = 20.9
 T(sweep opt: site memcpy cpu2gpu          ) = 3.394e-02 S  per = 1.63  per(accum) = 22.5
 T(sweep opt: rintermediate init           ) = 6.674e-02 S  per = 3.21  per(accum) = 25.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.199e-01 S  per = 5.76  per(accum) = 31.5
 T(sweep opt: rmmtasks init                ) = 2.342e-01 S  per = 11.3  per(accum) = 42.8
 T(sweep opt: qops memset on cpu           ) = 1.251e-06 S  per = 6.01e-05  per(accum) = 42.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.086e+00 S  per = 52.2  per(accum) = 95
 T(sweep opt: deallocate cpu and gpu memory) = 2.784e-03 S  per = 0.134  per(accum) = 95.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.667e-06 S  per = 8.01e-05  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.169e-06 S  per = 5.62e-05  per(accum) = 95.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.841e-03 S  per = 0.281  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.593e-04 S  per = 0.0269  per(accum) = 95.4
 T(sweep opt: qops_pool join and erase     ) = 4.173e-02 S  per = 2.01  per(accum) = 97.4
 T(sweep opt: conversion from opAB to opPQ ) = 5.405e-02 S  per =  2.6  per(accum) = 100
##### global opt: 1.679e+01 S #####
 T(global opt: fetch) = 3.616e-01 S  per = 2.15  per(accum) = 2.15
 T(global opt: hdiag) = 5.480e+00 S  per = 32.6  per(accum) = 34.8
 T(global opt: dvdsn) = 8.550e+00 S  per = 50.9  per(accum) = 85.7
 T(global opt: decim) = 3.088e-01 S  per = 1.84  per(accum) = 87.6
 T(global opt: guess) = 2.736e-03 S  per = 0.0163  per(accum) = 87.6
 T(global opt: renrm) = 2.081e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 6.863e-03 S  per = 0.0409  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.550e+00 S  T(sum) = 8.542e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.924e-03 S  per = 0.0342  per(accum) = 0.0342
 T(global opt: symbolic_formulae           ) = 3.931e-01 S  per =  4.6  per(accum) = 4.64
 T(global opt: hintermediate init          ) = 1.036e-02 S  per = 0.121  per(accum) = 4.76
 T(global opt: preprocess_hformulae_Hxlist ) = 1.250e-01 S  per = 1.46  per(accum) = 6.22
 T(global opt: hmmtasks init               ) = 2.399e-01 S  per = 2.81  per(accum) = 9.03
 T(global opt: initial guess for dvdson    ) = 8.854e-05 S  per = 0.00104  per(accum) = 9.03
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.417e+00 S  per = 75.1  per(accum) = 84.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.609e-01 S  per = 1.88  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 7.570e-04 S  per = 0.00886  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 1.505e-05 S  per = 0.000176  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 1.192e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 2.081e+00 S  T(sum) = 2.081e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.249e-03 S  per = 0.156  per(accum) = 0.156
 T(global opt: qops init                    ) = 5.398e-02 S  per = 2.59  per(accum) = 2.75
 T(global opt: symbolic_formulae_renorm     ) = 3.761e-01 S  per = 18.1  per(accum) = 20.8
 T(global opt: allocate qops on gpu         ) = 1.662e-03 S  per = 0.0799  per(accum) = 20.9
 T(global opt: site memcpy cpu2gpu          ) = 3.394e-02 S  per = 1.63  per(accum) = 22.5
 T(global opt: rintermediate init           ) = 6.674e-02 S  per = 3.21  per(accum) = 25.7
 T(global opt: preprocess_formulae_Rlist2   ) = 1.199e-01 S  per = 5.76  per(accum) = 31.5
 T(global opt: rmmtasks init                ) = 2.342e-01 S  per = 11.3  per(accum) = 42.8
 T(global opt: qops memset on cpu           ) = 1.251e-06 S  per = 6.01e-05  per(accum) = 42.8
 T(global opt: preprocess_renorm_batchGPU   ) = 1.086e+00 S  per = 52.2  per(accum) = 95
 T(global opt: deallocate cpu and gpu memory) = 2.784e-03 S  per = 0.134  per(accum) = 95.1
 T(global opt: construct opS [ifdists=true] ) = 1.667e-06 S  per = 8.01e-05  per(accum) = 95.1
 T(global opt: reduction of opS & opH [nccl]) = 1.169e-06 S  per = 5.62e-05  per(accum) = 95.1
 T(global opt: qops memcpy gpu2cpu          ) = 5.841e-03 S  per = 0.281  per(accum) = 95.4
 T(global opt: reduction of opS & opH [mpi] ) = 5.593e-04 S  per = 0.0269  per(accum) = 95.4
 T(global opt: qops_pool join and erase     ) = 4.173e-02 S  per = 2.01  per(accum) = 97.4
 T(global opt: conversion from opAB to opPQ ) = 5.405e-02 S  per =  2.6  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.253e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=29/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=1217:9.285e-03MB:9.067e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:3.63 S:8.47 A:0 B:86.2 
 rqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4189:0.032MB:3.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.789e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.364e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(5,6,4) nnz=23:1.755e-04MB
qtensor3: wf3 own=1 _data=0x46793a40
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=5
 (9,1):3 (8,2):1 (9,3):1
 qbond: qcol nsym=3 dimAll=6
 (20,0):3 (20,-2):2 (21,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=23:1.755e-04MB
### DIAG TIMING: total=2.206e-01 t1=2.199e-05, t2=2.240e-03, t3=2.520e-03, t4=2.158e-01, t5=4.476e-06, t6=1.335e-05, t7=3.115e-06
duration_diagGPU:2.206e-01
duration_diagreduce:4.300e-08
duration_diagtransform:3.730e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.431e-02 S -----
rank=0 GPUmem(GB): used=3.121e-05 (oper)=3.121e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.383e-04 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper,hinter)=3.121e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.554e-03 S size(H_formulae)=813 size(Hxlst2)=6 T(Hmu/Hxlist)=2.036e-03,2.518e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.838e-03 S size(H_formulae)=813 size(Hxlst)=1990 -----
rank=0 GPUmem(GB): used=6.898e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.427e-07 batch[need]=3.262e-04 blksize=9 blksize0=3 batchsize=1990
rank=0 GPUmem(GB): used=3.955e-04 (oper,hinter,dvdson,batch)=3.121e-05,3.777e-05,3.427e-07,3.262e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=23 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.878e-04,9.941e-03,3.005e-02,1.243e-02,5.302e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=5.832e-04 speed=5.877e-04GB/S T(nccl)=4.647e-06 speed=7.375e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=126 t=9.9e-03 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=126 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=7.6e-03 per=1.5e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=126 i=3 t=7.6e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=126 i=4 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=126 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=126 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=126 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=126 t=1.2e+00 per=1.9e+01 cost=4.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=126 i=0 t=2.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=9.3e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=126 i=3 t=9.3e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=126 i=4 t=9.3e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=126 i=5 t=9.2e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=126 total t=3.7e+00 per=5.8e+01 cost=7.5e+06 flops=2.0e+06
 sigma_tot[red] counter=126 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.3e-06,4.2e-06,4.9e-06,7.2e-07,1.8e-07
settings: ndim=23 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328199520972 -1.116e+03  3.996e-03    1     1  5.313e-02 5.313e-02 5.310e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.914e-03,9.954e-03,3.004e-02,1.241e-02,5.433e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=1.908e-03 speed=1.796e-04GB/S T(nccl)=6.209e-06 speed=5.520e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=127 t=1.0e-02 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=127 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=7.6e-03 per=1.5e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=127 i=3 t=7.6e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=127 i=4 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=127 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=127 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=127 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=127 t=1.2e+00 per=1.9e+01 cost=4.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=127 i=0 t=2.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=9.4e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=127 i=3 t=9.4e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=127 i=4 t=9.3e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=127 i=5 t=9.3e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=127 total t=3.7e+00 per=5.8e+01 cost=7.5e+06 flops=2.0e+06
 sigma_tot[red] counter=127 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.1e-05,3.2e-06,9.0e-07,2.3e-07
    2   0 -    -116.328223639321 -2.412e-05  3.577e-04    2     2  1.207e-01 6.034e-02 5.376e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.124e-03,1.008e-02,3.009e-02,1.241e-02,5.472e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=2.119e-03 speed=1.618e-04GB/S T(nccl)=5.137e-06 speed=6.672e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=128 t=1.0e-02 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=128 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=7.5e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=128 i=3 t=7.5e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=128 i=4 t=7.6e-03 per=1.4e+01 cost=1.7e+04 flops=2.2e+06
 sigma[gemm] counter=128 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=128 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=128 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=128 t=1.2e+00 per=1.9e+01 cost=4.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=128 i=0 t=2.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=2.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=9.5e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=128 i=3 t=9.5e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=128 i=4 t=9.4e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=128 i=5 t=9.4e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=128 total t=3.8e+00 per=5.8e+01 cost=7.6e+06 flops=2.0e+06
 sigma_tot[red] counter=128 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,2.8e-06,9.9e-07,2.1e-07
    3   0 +    -116.328224067176 -4.279e-07  8.204e-05    3     3  1.925e-01 6.418e-02 5.411e-02
TIMING FOR Davidson : 1.925e-01  T(cal/comm/rest)=1.623e-01,3.220e-07,3.022e-02
decomposed t_rest=3.022e-02
 T(sub)    =5.478e-05 per=1.813e-01
 T(precond)=3.006e-02 per=9.948e+01
 T(ortho)  =1.339e-05 per=4.430e-02
 T(xcopy)  =5.000e-07 per=1.655e-03
 T(xnrm2)  =1.287e-06 per=4.259e-03
 T(other)  =8.735e-05 per=2.891e-01
optimized energies: isweep=0 ibond=29 dots=1 e[0]=-116.328224067176 nmvp=3
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.038e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=8 dimAll=24
 (20,0):3 (20,-2):2 (21,-1):6 (22,0):4 (22,-2):3 (23,-1):1 (21,1):3 (21,-3):2
timing for divide=8.7e-06
timing for compute=1.7e-02
timing for collect=2.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.7e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.7e-06,1.7e-02,0.0e+00,4.3e-06,2.5e-05 -----
decimation summary: 24->5 dwt=+0.000e+00 SvN=9.728e-01
 qbond: qkept nsym=3 dimAll=5
 (21,-1):3 (22,-2):1 (21,-3):1
----- TIMING for decimation_row(nkr): 1.688e-02 S T(decim/select/formRot)=1.661e-02,2.507e-04,1.959e-05 -----
----- TIMING FOR onedot_decimation: 1.695e-02 S T(wf/decim)=4.864e-05,1.690e-02 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.737e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.460e-02 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper)=3.121e-05
rank=0 GPUmem(GB): used=6.916e-05 (oper,site)=3.121e-05,1.714e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.540e-03 S -----
rank=0 GPUmem(GB): used=1.069e-04 (oper,site,rinter)=3.121e-05,1.714e-07,3.777e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.656e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=2.145e-03,1.511e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.855e-03 S size(rtasks)=185 size(Rlst)=1049 -----
rank=0 GPUmem(GB): used=1.069e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.719e-04 blksize=9 blksize0=3 batchsize=1049
rank=0 GPUmem(GB): used=2.789e-04 (oper,site,rinter,batch)=3.121e-05,1.714e-07,3.777e-05,1.719e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.641e-03,2.274e-02,9.974e-03
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=30 t=6.6e-03 per=1.7e+01 cost=1.9e+04 flops=2.8e+06
 renorm[gemm] counter=30 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=2 t=7.7e-03 per=1.9e+01 cost=2.5e+03 flops=3.2e+05
 renorm[gemm] counter=30 i=3 t=7.6e-03 per=1.9e+01 cost=8.0e+03 flops=1.1e+06
 renorm[gemm] counter=30 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=6 t=7.5e-03 per=1.9e+01 cost=1.9e+04 flops=2.6e+06
 renorm[gemm] counter=30 total t=2.3e-02 per=5.8e+01 cost=3.0e+04 flops=1.3e+06
 renorm[red] counter=30 t=1.0e-02 per=2.5e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=1.7e-01 t_gemm=6.6e-01 t_reduction=2.9e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=30 t=1.7e-01 per=1.5e+01 cost=1.1e+06 flops=6.1e+06
 renorm_tot[gemm] counter=30 i=0 t=4.7e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=1 t=3.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=2 t=9.7e-02 per=8.6e+00 cost=2.1e+05 flops=2.1e+06
 renorm_tot[gemm] counter=30 i=3 t=9.8e-02 per=8.7e+00 cost=2.7e+05 flops=2.7e+06
 renorm_tot[gemm] counter=30 i=4 t=1.2e-01 per=1.1e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=30 i=5 t=1.2e-01 per=1.1e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=30 i=6 t=2.2e-01 per=2.0e+01 cost=2.8e+06 flops=1.3e+07
 renorm_tot[gemm] counter=30 total t=6.6e-01 per=5.9e+01 cost=3.8e+06 flops=5.8e+06
 renorm_tot[red] counter=30 t=2.9e-01 per=2.6e+01 cost=1.3e+06 flops=4.4e+06
qops.to_cpu: size(tot)=661:5.0e-03MB:4.9e-06GB T(to_cpu)=1.7e-04S speed=2.9e-02GB/S
check ||H-H.dagger||=1.408e-16 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0686 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.706e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.870e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.423e-01 S #####
 T(local opt: fetch) = 1.229e-02 S  per = 2.27  per(accum) = 2.27
 T(local opt: hdiag) = 2.206e-01 S  per = 40.7  per(accum) = 43
 T(local opt: dvdsn) = 2.223e-01 S  per =   41  per(accum) = 84
 T(local opt: decim) = 1.696e-02 S  per = 3.13  per(accum) = 87.1
 T(local opt: guess) = 7.779e-05 S  per = 0.0143  per(accum) = 87.1
 T(local opt: renrm) = 6.980e-02 S  per = 12.9  per(accum) = 100
 T(local opt: save ) = 1.823e-04 S  per = 0.0336  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.223e-01 S  T(sum) = 2.221e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 9.724e-05 S  per = 0.0438  per(accum) = 0.0438
 T(local opt: symbolic_formulae           ) = 1.432e-02 S  per = 6.45  per(accum) = 6.49
 T(local opt: hintermediate init          ) = 3.538e-04 S  per = 0.159  per(accum) = 6.65
 T(local opt: preprocess_hformulae_Hxlist ) = 4.895e-03 S  per =  2.2  per(accum) = 8.86
 T(local opt: hmmtasks init               ) = 9.892e-03 S  per = 4.45  per(accum) = 13.3
 T(local opt: initial guess for dvdson    ) = 2.541e-06 S  per = 0.00114  per(accum) = 13.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.577e-01 S  per =   71  per(accum) = 84.3
 T(local opt: dvdson [cpu-gpu]            ) = 4.610e-03 S  per = 2.08  per(accum) = 86.4
 T(local opt: dvdson [nccl]               ) = 1.599e-05 S  per = 0.0072  per(accum) = 86.4
 T(local opt: dvdson [mpi]                ) = 3.220e-07 S  per = 0.000145  per(accum) = 86.4
 T(local opt: dvdson [rest part(linalg)]  ) = 3.022e-02 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 6.980e-02 S  T(sum) = 6.980e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.965e-05 S  per = 0.0998  per(accum) = 0.0998
 T(local opt: qops init                    ) = 1.472e-03 S  per = 2.11  per(accum) = 2.21
 T(local opt: symbolic_formulae_renorm     ) = 1.461e-02 S  per = 20.9  per(accum) = 23.1
 T(local opt: allocate qops on gpu         ) = 5.454e-05 S  per = 0.0781  per(accum) = 23.2
 T(local opt: site memcpy cpu2gpu          ) = 4.054e-04 S  per = 0.581  per(accum) = 23.8
 T(local opt: rintermediate init           ) = 2.551e-03 S  per = 3.65  per(accum) = 27.5
 T(local opt: preprocess_formulae_Rlist2   ) = 3.889e-03 S  per = 5.57  per(accum) = 33
 T(local opt: rmmtasks init                ) = 5.888e-03 S  per = 8.44  per(accum) = 41.5
 T(local opt: qops memset on cpu           ) = 6.200e-08 S  per = 8.88e-05  per(accum) = 41.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.945e-02 S  per = 56.5  per(accum) = 98
 T(local opt: deallocate cpu and gpu memory) = 5.275e-05 S  per = 0.0756  per(accum) = 98.1
 T(local opt: construct opS [ifdists=true] ) = 5.200e-08 S  per = 7.45e-05  per(accum) = 98.1
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 5.16e-05  per(accum) = 98.1
 T(local opt: qops memcpy gpu2cpu          ) = 1.737e-04 S  per = 0.249  per(accum) = 98.3
 T(local opt: reduction of opS & opH [mpi] ) = 1.506e-05 S  per = 0.0216  per(accum) = 98.3
 T(local opt: qops_pool join and erase     ) = 1.168e-03 S  per = 1.67  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.347e-06 S  per = 0.00193  per(accum) = 100
##### sweep opt: 1.733e+01 S #####
 T(sweep opt: fetch) = 3.738e-01 S  per = 2.16  per(accum) = 2.16
 T(sweep opt: hdiag) = 5.701e+00 S  per = 32.9  per(accum) = 35
 T(sweep opt: dvdsn) = 8.772e+00 S  per = 50.6  per(accum) = 85.7
 T(sweep opt: decim) = 3.258e-01 S  per = 1.88  per(accum) = 87.5
 T(sweep opt: guess) = 2.813e-03 S  per = 0.0162  per(accum) = 87.6
 T(sweep opt: renrm) = 2.150e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 7.046e-03 S  per = 0.0406  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.772e+00 S  T(sum) = 8.764e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 3.021e-03 S  per = 0.0345  per(accum) = 0.0345
 T(sweep opt: symbolic_formulae           ) = 4.074e-01 S  per = 4.65  per(accum) = 4.68
 T(sweep opt: hintermediate init          ) = 1.071e-02 S  per = 0.122  per(accum) = 4.81
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.299e-01 S  per = 1.48  per(accum) = 6.29
 T(sweep opt: hmmtasks init               ) = 2.498e-01 S  per = 2.85  per(accum) = 9.14
 T(sweep opt: initial guess for dvdson    ) = 9.108e-05 S  per = 0.00104  per(accum) = 9.14
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.574e+00 S  per =   75  per(accum) = 84.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.655e-01 S  per = 1.89  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 7.730e-04 S  per = 0.00882  per(accum) = 86.1
 T(sweep opt: dvdson [mpi]                ) = 1.537e-05 S  per = 0.000175  per(accum) = 86.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.222e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 2.150e+00 S  T(sum) = 2.150e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.318e-03 S  per = 0.154  per(accum) = 0.154
 T(sweep opt: qops init                    ) = 5.545e-02 S  per = 2.58  per(accum) = 2.73
 T(sweep opt: symbolic_formulae_renorm     ) = 3.907e-01 S  per = 18.2  per(accum) = 20.9
 T(sweep opt: allocate qops on gpu         ) = 1.716e-03 S  per = 0.0798  per(accum) = 21
 T(sweep opt: site memcpy cpu2gpu          ) = 3.435e-02 S  per =  1.6  per(accum) = 22.6
 T(sweep opt: rintermediate init           ) = 6.929e-02 S  per = 3.22  per(accum) = 25.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.238e-01 S  per = 5.76  per(accum) = 31.6
 T(sweep opt: rmmtasks init                ) = 2.400e-01 S  per = 11.2  per(accum) = 42.7
 T(sweep opt: qops memset on cpu           ) = 1.313e-06 S  per = 6.11e-05  per(accum) = 42.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.125e+00 S  per = 52.3  per(accum) = 95.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.837e-03 S  per = 0.132  per(accum) = 95.2
 T(sweep opt: construct opS [ifdists=true] ) = 1.719e-06 S  per = 7.99e-05  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.205e-06 S  per = 5.6e-05  per(accum) = 95.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.015e-03 S  per = 0.28  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.744e-04 S  per = 0.0267  per(accum) = 95.5
 T(sweep opt: qops_pool join and erase     ) = 4.290e-02 S  per = 1.99  per(accum) = 97.5
 T(sweep opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.51  per(accum) = 100
##### global opt: 1.733e+01 S #####
 T(global opt: fetch) = 3.738e-01 S  per = 2.16  per(accum) = 2.16
 T(global opt: hdiag) = 5.701e+00 S  per = 32.9  per(accum) = 35
 T(global opt: dvdsn) = 8.772e+00 S  per = 50.6  per(accum) = 85.7
 T(global opt: decim) = 3.258e-01 S  per = 1.88  per(accum) = 87.5
 T(global opt: guess) = 2.813e-03 S  per = 0.0162  per(accum) = 87.6
 T(global opt: renrm) = 2.150e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 7.046e-03 S  per = 0.0406  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.772e+00 S  T(sum) = 8.764e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 3.021e-03 S  per = 0.0345  per(accum) = 0.0345
 T(global opt: symbolic_formulae           ) = 4.074e-01 S  per = 4.65  per(accum) = 4.68
 T(global opt: hintermediate init          ) = 1.071e-02 S  per = 0.122  per(accum) = 4.81
 T(global opt: preprocess_hformulae_Hxlist ) = 1.299e-01 S  per = 1.48  per(accum) = 6.29
 T(global opt: hmmtasks init               ) = 2.498e-01 S  per = 2.85  per(accum) = 9.14
 T(global opt: initial guess for dvdson    ) = 9.108e-05 S  per = 0.00104  per(accum) = 9.14
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.574e+00 S  per =   75  per(accum) = 84.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.655e-01 S  per = 1.89  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 7.730e-04 S  per = 0.00882  per(accum) = 86.1
 T(global opt: dvdson [mpi]                ) = 1.537e-05 S  per = 0.000175  per(accum) = 86.1
 T(global opt: dvdson [rest part(linalg)]  ) = 1.222e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 2.150e+00 S  T(sum) = 2.150e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.318e-03 S  per = 0.154  per(accum) = 0.154
 T(global opt: qops init                    ) = 5.545e-02 S  per = 2.58  per(accum) = 2.73
 T(global opt: symbolic_formulae_renorm     ) = 3.907e-01 S  per = 18.2  per(accum) = 20.9
 T(global opt: allocate qops on gpu         ) = 1.716e-03 S  per = 0.0798  per(accum) = 21
 T(global opt: site memcpy cpu2gpu          ) = 3.435e-02 S  per =  1.6  per(accum) = 22.6
 T(global opt: rintermediate init           ) = 6.929e-02 S  per = 3.22  per(accum) = 25.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.238e-01 S  per = 5.76  per(accum) = 31.6
 T(global opt: rmmtasks init                ) = 2.400e-01 S  per = 11.2  per(accum) = 42.7
 T(global opt: qops memset on cpu           ) = 1.313e-06 S  per = 6.11e-05  per(accum) = 42.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.125e+00 S  per = 52.3  per(accum) = 95.1
 T(global opt: deallocate cpu and gpu memory) = 2.837e-03 S  per = 0.132  per(accum) = 95.2
 T(global opt: construct opS [ifdists=true] ) = 1.719e-06 S  per = 7.99e-05  per(accum) = 95.2
 T(global opt: reduction of opS & opH [nccl]) = 1.205e-06 S  per = 5.6e-05  per(accum) = 95.2
 T(global opt: qops memcpy gpu2cpu          ) = 6.015e-03 S  per = 0.28  per(accum) = 95.5
 T(global opt: reduction of opS & opH [mpi] ) = 5.744e-04 S  per = 0.0267  per(accum) = 95.5
 T(global opt: qops_pool join and erase     ) = 4.290e-02 S  per = 1.99  per(accum) = 97.5
 T(global opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.51  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.038e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=30/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=17:1.297e-04MB:1.267e-07GB
total mem of comb=1211:9.239e-03MB:9.023e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:4.05 S:12.2 A:0 B:81.1 
 rqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3367:0.0257MB:2.51e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.362e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,5,4) nnz=17:1.297e-04MB
qtensor3: wf3 own=1 _data=0x3a5d9dd0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=4
 (8,2):3 (7,3):1
 qbond: qcol nsym=3 dimAll=5
 (21,-1):3 (22,-2):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=24 size=17:1.297e-04MB
### DIAG TIMING: total=1.191e-01 t1=2.195e-05, t2=2.201e-03, t3=8.517e-04, t4=1.160e-01, t5=5.371e-06, t6=1.473e-05, t7=3.499e-06
duration_diagGPU:1.191e-01
duration_diagreduce:4.300e-08
duration_diagtransform:4.210e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.058e-02 S -----
rank=0 GPUmem(GB): used=2.509e-05 (oper)=2.509e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.484e-04 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper,hinter)=2.509e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.815e-03 S size(H_formulae)=607 size(Hxlst2)=5 T(Hmu/Hxlist)=1.413e-03,1.402e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.992e-03 S size(H_formulae)=607 size(Hxlst)=1152 -----
rank=0 GPUmem(GB): used=5.429e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.533e-07 batch[need]=1.888e-04 blksize=9 blksize0=3 batchsize=1152
rank=0 GPUmem(GB): used=2.434e-04 (oper,hinter,dvdson,batch)=2.509e-05,2.921e-05,2.533e-07,1.888e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=17 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.023e-03,1.007e-02,3.002e-02,1.262e-02,5.473e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=2.018e-03 speed=1.255e-04GB/S T(nccl)=4.815e-06 speed=5.261e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=129 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=129 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=129 i=3 t=7.4e-03 per=1.4e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=129 i=4 t=7.6e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=129 i=5 t=7.6e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=129 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=129 t=1.3e-02 per=2.4e+01 cost=7.8e+03 flops=6.2e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=129 t=1.2e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=129 i=0 t=2.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=2.2e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=9.5e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=129 i=3 t=9.5e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=129 i=4 t=9.5e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=129 i=5 t=9.5e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=129 total t=3.8e+00 per=5.8e+01 cost=7.6e+06 flops=2.0e+06
 sigma_tot[red] counter=129 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.6e-06,1.8e-06,7.4e-07,1.6e-07
settings: ndim=17 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328224067176 -1.116e+03  5.951e-03    1     1  5.485e-02 5.485e-02 5.482e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.619e-03,9.909e-03,2.985e-02,1.251e-02,5.391e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.613e-03 speed=1.570e-04GB/S T(nccl)=5.536e-06 speed=4.576e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=130 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=130 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=130 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=130 i=4 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=130 i=5 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=130 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=130 t=1.3e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=130 t=1.2e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=130 i=0 t=2.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=2.2e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=9.6e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=130 i=3 t=9.6e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=130 i=4 t=9.6e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=130 i=5 t=9.5e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=130 total t=3.8e+00 per=5.8e+01 cost=7.6e+06 flops=2.0e+06
 sigma_tot[red] counter=130 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.4e-05,3.3e-06,8.7e-07,2.3e-07
    2   0 -    -116.328278203751 -5.414e-05  5.345e-04    2     2  1.222e-01 6.110e-02 5.441e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.948e-03,1.000e-02,2.989e-02,1.246e-02,5.431e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.939e-03 speed=1.306e-04GB/S T(nccl)=8.638e-06 speed=2.933e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=131 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=131 i=0 t=3.2e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=2.7e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=7.6e-03 per=1.4e+01 cost=4.6e+03 flops=6.1e+05
 sigma[gemm] counter=131 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=131 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=131 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=131 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=131 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=131 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=131 i=0 t=2.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=2.2e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=9.7e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=131 i=3 t=9.7e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=131 i=4 t=9.6e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=131 i=5 t=9.6e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=131 total t=3.9e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=131 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,2.2e-05,1.7e-05,1.4e-06,3.1e-07
    3   0 -    -116.328279238851 -1.035e-06  1.702e-04    3     3  1.897e-01 6.324e-02 5.444e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.437e-04,1.012e-02,2.994e-02,1.245e-02,5.296e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=4.383e-04 speed=5.779e-04GB/S T(nccl)=5.408e-06 speed=4.684e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=132 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=132 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=7.6e-03 per=1.4e+01 cost=4.6e+03 flops=6.1e+05
 sigma[gemm] counter=132 i=3 t=7.4e-03 per=1.4e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=132 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=132 i=5 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=132 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=132 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=132 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=132 i=0 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=2.2e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=9.8e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=132 i=3 t=9.8e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=132 i=4 t=9.7e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=132 i=5 t=9.7e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=132 total t=3.9e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=132 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.0e-06,9.8e-07,2.4e-07
    4   0 +    -116.328279347223 -1.084e-07  1.611e-05    3     4  2.593e-01 6.482e-02 5.409e-02
TIMING FOR Davidson : 2.593e-01  T(cal/comm/rest)=2.164e-01,5.260e-07,4.292e-02
decomposed t_rest=4.292e-02
 T(sub)    =1.046e-04 per=2.437e-01
 T(precond)=4.268e-02 per=9.946e+01
 T(ortho)  =2.461e-05 per=5.734e-02
 T(xcopy)  =7.610e-07 per=1.773e-03
 T(xnrm2)  =1.824e-06 per=4.250e-03
 T(other)  =1.021e-04 per=2.378e-01
optimized energies: isweep=0 ibond=30 dots=1 e[0]=-116.328279347223 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.079e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=8 dimAll=20
 (21,-1):3 (22,-2):5 (21,-3):1 (23,-1):4 (24,-2):1 (23,-3):2 (22,0):3 (22,-4):1
timing for divide=8.6e-06
timing for compute=1.6e-02
timing for collect=2.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.6e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.6e-06,1.6e-02,0.0e+00,4.6e-06,2.3e-05 -----
decimation summary: 20->4 dwt=+1.110e-16 SvN=7.934e-01
 qbond: qkept nsym=2 dimAll=4
 (22,-2):3 (23,-3):1
----- TIMING for decimation_row(nkr): 1.670e-02 S T(decim/select/formRot)=1.648e-02,2.068e-04,1.777e-05 -----
----- TIMING FOR onedot_decimation: 1.677e-02 S T(wf/decim)=5.005e-05,1.672e-02 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=5.704e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.099e-02 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper)=2.509e-05
rank=0 GPUmem(GB): used=5.442e-05 (oper,site)=2.509e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.509e-03 S -----
rank=0 GPUmem(GB): used=8.363e-05 (oper,site,rinter)=2.509e-05,1.267e-07,2.921e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.527e-03 S size(rtasks)=141 size(Rlst2)=4 T(Rmu/Rlist)=1.580e-03,9.472e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.608e-03 S size(rtasks)=141 size(Rlst)=631 -----
rank=0 GPUmem(GB): used=8.363e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.034e-04 blksize=9 blksize0=3 batchsize=631
rank=0 GPUmem(GB): used=1.871e-04 (oper,site,rinter,batch)=2.509e-05,1.267e-07,2.921e-05,1.034e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.219e-03,2.260e-02,1.000e-02
----- TIMING FOR renorm : t_inter=6.2e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=31 t=6.2e-03 per=1.6e+01 cost=9.1e+03 flops=1.5e+06
 renorm[gemm] counter=31 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=1 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=2 t=7.6e-03 per=1.9e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=31 i=3 t=7.5e-03 per=1.9e+01 cost=3.8e+03 flops=5.0e+05
 renorm[gemm] counter=31 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=6 t=7.5e-03 per=1.9e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=31 total t=2.3e-02 per=5.8e+01 cost=1.6e+04 flops=7.2e+05
 renorm[red] counter=31 t=1.0e-02 per=2.6e+01 cost=7.0e+03 flops=7.0e+05
----- TIMING FOR renorm_tot : t_inter=1.8e-01 t_gemm=6.8e-01 t_reduction=3.0e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=31 t=1.8e-01 per=1.5e+01 cost=1.1e+06 flops=5.9e+06
 renorm_tot[gemm] counter=31 i=0 t=4.8e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=1 t=3.9e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=2 t=1.0e-01 per=9.0e+00 cost=2.1e+05 flops=2.0e+06
 renorm_tot[gemm] counter=31 i=3 t=1.1e-01 per=9.1e+00 cost=2.7e+05 flops=2.6e+06
 renorm_tot[gemm] counter=31 i=4 t=1.2e-01 per=1.0e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=31 i=5 t=1.2e-01 per=1.1e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=31 i=6 t=2.3e-01 per=2.0e+01 cost=2.8e+06 flops=1.2e+07
 renorm_tot[gemm] counter=31 total t=6.8e-01 per=5.9e+01 cost=3.8e+06 flops=5.6e+06
 renorm_tot[red] counter=31 t=3.0e-01 per=2.6e+01 cost=1.3e+06 flops=4.3e+06
qops.to_cpu: size(tot)=370:2.8e-03MB:2.8e-06GB T(to_cpu)=1.4e-04S speed=2.0e-02GB/S
check ||H-H.dagger||=1.288e-16 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0603 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=5.326e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.565e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.694e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.874e-01 S #####
 T(local opt: fetch) = 1.051e-02 S  per = 2.16  per(accum) = 2.16
 T(local opt: hdiag) = 1.191e-01 S  per = 24.4  per(accum) = 26.6
 T(local opt: dvdsn) = 2.791e-01 S  per = 57.3  per(accum) = 83.9
 T(local opt: decim) = 1.678e-02 S  per = 3.44  per(accum) = 87.3
 T(local opt: guess) = 6.902e-05 S  per = 0.0142  per(accum) = 87.3
 T(local opt: renrm) = 6.155e-02 S  per = 12.6  per(accum) = 100
 T(local opt: save ) = 1.915e-04 S  per = 0.0393  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.791e-01 S  T(sum) = 2.789e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 8.278e-05 S  per = 0.0297  per(accum) = 0.0297
 T(local opt: symbolic_formulae           ) = 1.060e-02 S  per =  3.8  per(accum) = 3.83
 T(local opt: hintermediate init          ) = 2.634e-04 S  per = 0.0944  per(accum) = 3.92
 T(local opt: preprocess_hformulae_Hxlist ) = 3.026e-03 S  per = 1.08  per(accum) = 5.01
 T(local opt: hmmtasks init               ) = 5.682e-03 S  per = 2.04  per(accum) = 7.04
 T(local opt: initial guess for dvdson    ) = 4.786e-06 S  per = 0.00172  per(accum) = 7.05
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.103e-01 S  per = 75.4  per(accum) = 82.5
 T(local opt: dvdson [cpu-gpu]            ) = 6.008e-03 S  per = 2.15  per(accum) = 84.6
 T(local opt: dvdson [nccl]               ) = 2.440e-05 S  per = 0.00875  per(accum) = 84.6
 T(local opt: dvdson [mpi]                ) = 5.260e-07 S  per = 0.000189  per(accum) = 84.6
 T(local opt: dvdson [rest part(linalg)]  ) = 4.292e-02 S  per = 15.4  per(accum) = 100
Detailed decomposition of T(renrm) = 6.155e-02 S  T(sum) = 6.155e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.618e-05 S  per = 0.108  per(accum) = 0.108
 T(local opt: qops init                    ) = 1.018e-03 S  per = 1.65  per(accum) = 1.76
 T(local opt: symbolic_formulae_renorm     ) = 1.101e-02 S  per = 17.9  per(accum) = 19.6
 T(local opt: allocate qops on gpu         ) = 4.855e-05 S  per = 0.0789  per(accum) = 19.7
 T(local opt: site memcpy cpu2gpu          ) = 4.953e-04 S  per = 0.805  per(accum) = 20.5
 T(local opt: rintermediate init           ) = 2.519e-03 S  per = 4.09  per(accum) = 24.6
 T(local opt: preprocess_formulae_Rlist2   ) = 2.630e-03 S  per = 4.27  per(accum) = 28.9
 T(local opt: rmmtasks init                ) = 3.432e-03 S  per = 5.58  per(accum) = 34.5
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 4.87e-05  per(accum) = 34.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.891e-02 S  per = 63.2  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 4.172e-05 S  per = 0.0678  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 6.000e-08 S  per = 9.75e-05  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 6.01e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.418e-04 S  per = 0.23  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.521e-05 S  per = 0.0247  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.217e-03 S  per = 1.98  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.682e-06 S  per = 0.00273  per(accum) = 100
##### sweep opt: 1.782e+01 S #####
 T(sweep opt: fetch) = 3.844e-01 S  per = 2.16  per(accum) = 2.16
 T(sweep opt: hdiag) = 5.820e+00 S  per = 32.7  per(accum) = 34.8
 T(sweep opt: dvdsn) = 9.051e+00 S  per = 50.8  per(accum) = 85.6
 T(sweep opt: decim) = 3.426e-01 S  per = 1.92  per(accum) = 87.5
 T(sweep opt: guess) = 2.882e-03 S  per = 0.0162  per(accum) = 87.5
 T(sweep opt: renrm) = 2.212e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 7.237e-03 S  per = 0.0406  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.051e+00 S  T(sum) = 9.043e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 3.104e-03 S  per = 0.0343  per(accum) = 0.0343
 T(sweep opt: symbolic_formulae           ) = 4.180e-01 S  per = 4.62  per(accum) = 4.66
 T(sweep opt: hintermediate init          ) = 1.098e-02 S  per = 0.121  per(accum) = 4.78
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.329e-01 S  per = 1.47  per(accum) = 6.25
 T(sweep opt: hmmtasks init               ) = 2.555e-01 S  per = 2.82  per(accum) = 9.07
 T(sweep opt: initial guess for dvdson    ) = 9.587e-05 S  per = 0.00106  per(accum) = 9.07
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.785e+00 S  per =   75  per(accum) = 84.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.715e-01 S  per =  1.9  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 7.974e-04 S  per = 0.00882  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 1.590e-05 S  per = 0.000176  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.265e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 2.212e+00 S  T(sum) = 2.212e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.385e-03 S  per = 0.153  per(accum) = 0.153
 T(sweep opt: qops init                    ) = 5.647e-02 S  per = 2.55  per(accum) = 2.71
 T(sweep opt: symbolic_formulae_renorm     ) = 4.017e-01 S  per = 18.2  per(accum) = 20.9
 T(sweep opt: allocate qops on gpu         ) = 1.765e-03 S  per = 0.0798  per(accum) = 20.9
 T(sweep opt: site memcpy cpu2gpu          ) = 3.484e-02 S  per = 1.58  per(accum) = 22.5
 T(sweep opt: rintermediate init           ) = 7.181e-02 S  per = 3.25  per(accum) = 25.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.264e-01 S  per = 5.72  per(accum) = 31.5
 T(sweep opt: rmmtasks init                ) = 2.435e-01 S  per =   11  per(accum) = 42.5
 T(sweep opt: qops memset on cpu           ) = 1.343e-06 S  per = 6.07e-05  per(accum) = 42.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.164e+00 S  per = 52.6  per(accum) = 95.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.879e-03 S  per = 0.13  per(accum) = 95.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.779e-06 S  per = 8.04e-05  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [nccl]) = 1.242e-06 S  per = 5.62e-05  per(accum) = 95.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.157e-03 S  per = 0.278  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.896e-04 S  per = 0.0267  per(accum) = 95.6
 T(sweep opt: qops_pool join and erase     ) = 4.411e-02 S  per = 1.99  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.44  per(accum) = 100
##### global opt: 1.782e+01 S #####
 T(global opt: fetch) = 3.844e-01 S  per = 2.16  per(accum) = 2.16
 T(global opt: hdiag) = 5.820e+00 S  per = 32.7  per(accum) = 34.8
 T(global opt: dvdsn) = 9.051e+00 S  per = 50.8  per(accum) = 85.6
 T(global opt: decim) = 3.426e-01 S  per = 1.92  per(accum) = 87.5
 T(global opt: guess) = 2.882e-03 S  per = 0.0162  per(accum) = 87.5
 T(global opt: renrm) = 2.212e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 7.237e-03 S  per = 0.0406  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.051e+00 S  T(sum) = 9.043e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 3.104e-03 S  per = 0.0343  per(accum) = 0.0343
 T(global opt: symbolic_formulae           ) = 4.180e-01 S  per = 4.62  per(accum) = 4.66
 T(global opt: hintermediate init          ) = 1.098e-02 S  per = 0.121  per(accum) = 4.78
 T(global opt: preprocess_hformulae_Hxlist ) = 1.329e-01 S  per = 1.47  per(accum) = 6.25
 T(global opt: hmmtasks init               ) = 2.555e-01 S  per = 2.82  per(accum) = 9.07
 T(global opt: initial guess for dvdson    ) = 9.587e-05 S  per = 0.00106  per(accum) = 9.07
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.785e+00 S  per =   75  per(accum) = 84.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.715e-01 S  per =  1.9  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 7.974e-04 S  per = 0.00882  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 1.590e-05 S  per = 0.000176  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 1.265e+00 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 2.212e+00 S  T(sum) = 2.212e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.385e-03 S  per = 0.153  per(accum) = 0.153
 T(global opt: qops init                    ) = 5.647e-02 S  per = 2.55  per(accum) = 2.71
 T(global opt: symbolic_formulae_renorm     ) = 4.017e-01 S  per = 18.2  per(accum) = 20.9
 T(global opt: allocate qops on gpu         ) = 1.765e-03 S  per = 0.0798  per(accum) = 20.9
 T(global opt: site memcpy cpu2gpu          ) = 3.484e-02 S  per = 1.58  per(accum) = 22.5
 T(global opt: rintermediate init           ) = 7.181e-02 S  per = 3.25  per(accum) = 25.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.264e-01 S  per = 5.72  per(accum) = 31.5
 T(global opt: rmmtasks init                ) = 2.435e-01 S  per =   11  per(accum) = 42.5
 T(global opt: qops memset on cpu           ) = 1.343e-06 S  per = 6.07e-05  per(accum) = 42.5
 T(global opt: preprocess_renorm_batchGPU   ) = 1.164e+00 S  per = 52.6  per(accum) = 95.1
 T(global opt: deallocate cpu and gpu memory) = 2.879e-03 S  per = 0.13  per(accum) = 95.3
 T(global opt: construct opS [ifdists=true] ) = 1.779e-06 S  per = 8.04e-05  per(accum) = 95.3
 T(global opt: reduction of opS & opH [nccl]) = 1.242e-06 S  per = 5.62e-05  per(accum) = 95.3
 T(global opt: qops memcpy gpu2cpu          ) = 6.157e-03 S  per = 0.278  per(accum) = 95.5
 T(global opt: reduction of opS & opH [mpi] ) = 5.896e-04 S  per = 0.0267  per(accum) = 95.6
 T(global opt: qops_pool join and erase     ) = 4.411e-02 S  per = 1.99  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.44  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-7.082e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=31/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=10:7.629e-05MB:7.451e-08GB
total mem of comb=1204:9.186e-03MB:8.970e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 rqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2851:0.0218MB:2.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,4,4) nnz=10:7.629e-05MB
qtensor3: wf3 own=1 _data=0x3aacc550
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (7,1):2 (6,2):1
 qbond: qcol nsym=2 dimAll=4
 (22,-2):3 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=10:7.629e-05MB
### DIAG TIMING: total=9.195e-02 t1=2.335e-05, t2=2.281e-03, t3=2.561e-03, t4=8.706e-02, t5=5.550e-06, t6=1.350e-05, t7=3.631e-06
duration_diagGPU:9.196e-02
duration_diagreduce:6.300e-08
duration_diagtransform:3.240e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 7.650e-03 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper)=2.124e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.771e-04 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper,hinter)=2.124e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.630e-03 S size(H_formulae)=435 size(Hxlst2)=3 T(Hmu/Hxlist)=1.006e-03,6.236e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.701e-03 S size(H_formulae)=435 size(Hxlst)=442 -----
rank=0 GPUmem(GB): used=4.225e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.490e-07 batch[need]=5.269e-05 blksize=6 blksize0=3 batchsize=442
rank=0 GPUmem(GB): used=9.509e-05 (oper,hinter,dvdson,batch)=2.124e-05,2.101e-05,1.490e-07,5.269e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=10 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.950e-03,9.944e-03,2.981e-02,1.238e-02,5.409e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.946e-03 speed=7.659e-05GB/S T(nccl)=4.646e-06 speed=3.207e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=133 t=9.9e-03 per=1.9e+01 cost=7.9e+03 flops=8.0e+05
 sigma[gemm] counter=133 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=133 i=3 t=7.6e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=133 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=133 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=133 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.5e+05
 sigma[red] counter=133 t=1.2e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=133 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=133 i=0 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=2.2e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=9.8e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=133 i=3 t=9.8e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=133 i=4 t=9.8e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=133 i=5 t=9.8e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=133 total t=3.9e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=133 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=9.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.1e-06,1.9e-06,6.8e-07,1.9e-07
settings: ndim=10 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.328279347224 -1.116e+03  9.851e-06    1     1  5.419e-02 5.419e-02 5.417e-02
TIMING FOR Davidson : 5.422e-02  T(cal/comm/rest)=5.417e-02,1.060e-07,4.676e-05
decomposed t_rest=4.676e-05
 T(sub)    =9.268e-06 per=1.982e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.930e-07 per=8.404e-01
 T(xnrm2)  =3.590e-07 per=7.677e-01
 T(other)  =3.674e-05 per=7.857e+01
optimized energies: isweep=0 ibond=31 dots=1 e[0]=-116.328279347224 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.316e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=6 dimAll=16
 (22,-2):3 (23,-3):4 (24,-2):4 (25,-3):1 (23,-1):3 (24,-4):1
timing for divide=1.8e-05
timing for compute=7.3e-03
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 7.4e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.8e-05,7.3e-03,0.0e+00,4.0e-06,1.3e-05 -----
decimation summary: 16->3 dwt=+0.000e+00 SvN=5.810e-01
 qbond: qkept nsym=2 dimAll=3
 (23,-1):2 (24,-2):1
----- TIMING for decimation_row(nkr): 7.590e-03 S T(decim/select/formRot)=7.404e-03,1.683e-04,1.736e-05 -----
----- TIMING FOR onedot_decimation: 7.650e-03 S T(wf/decim)=4.222e-05,7.608e-03 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.497e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 8.312e-03 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper)=2.124e-05
rank=0 GPUmem(GB): used=4.233e-05 (oper,site)=2.124e-05,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.499e-03 S -----
rank=0 GPUmem(GB): used=6.334e-05 (oper,site,rinter)=2.124e-05,7.451e-08,2.101e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.657e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.191e-03,4.659e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.693e-03 S size(rtasks)=105 size(Rlst)=244 -----
rank=0 GPUmem(GB): used=6.334e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.909e-05 blksize=6 blksize0=3 batchsize=244
rank=0 GPUmem(GB): used=9.242e-05 (oper,site,rinter,batch)=2.124e-05,7.451e-08,2.101e-05,2.909e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.083e-03,2.214e-02,9.998e-03
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=32 t=7.1e-03 per=1.8e+01 cost=4.0e+03 flops=5.6e+05
 renorm[gemm] counter=32 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=2 t=7.4e-03 per=1.9e+01 cost=3.7e+02 flops=5.0e+04
 renorm[gemm] counter=32 i=3 t=7.4e-03 per=1.9e+01 cost=1.7e+03 flops=2.4e+05
 renorm[gemm] counter=32 i=4 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=5 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=6 t=7.4e-03 per=1.9e+01 cost=2.0e+03 flops=2.8e+05
 renorm[gemm] counter=32 total t=2.2e-02 per=5.6e+01 cost=4.1e+03 flops=1.9e+05
 renorm[red] counter=32 t=1.0e-02 per=2.5e+01 cost=8.3e+02 flops=8.3e+04
----- TIMING FOR renorm_tot : t_inter=1.9e-01 t_gemm=7.0e-01 t_reduction=3.1e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=32 t=1.9e-01 per=1.6e+01 cost=1.1e+06 flops=5.7e+06
 renorm_tot[gemm] counter=32 i=0 t=4.9e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=1 t=4.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=2 t=1.1e-01 per=9.3e+00 cost=2.1e+05 flops=1.9e+06
 renorm_tot[gemm] counter=32 i=3 t=1.1e-01 per=9.4e+00 cost=2.7e+05 flops=2.4e+06
 renorm_tot[gemm] counter=32 i=4 t=1.2e-01 per=1.0e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=32 i=5 t=1.2e-01 per=1.0e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=32 i=6 t=2.3e-01 per=2.0e+01 cost=2.8e+06 flops=1.2e+07
 renorm_tot[gemm] counter=32 total t=7.0e-01 per=5.8e+01 cost=3.8e+06 flops=5.4e+06
 renorm_tot[red] counter=32 t=3.1e-01 per=2.6e+01 cost=1.3e+06 flops=4.2e+06
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.0e-04S speed=1.1e-02GB/S
check ||H-H.dagger||=7.850e-17 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.056 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.452e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.323e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-3.502e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.334e-01 S #####
 T(local opt: fetch) = 1.055e-02 S  per = 4.52  per(accum) = 4.52
 T(local opt: hdiag) = 9.199e-02 S  per = 39.4  per(accum) = 43.9
 T(local opt: dvdsn) = 6.578e-02 S  per = 28.2  per(accum) = 72.1
 T(local opt: decim) = 7.659e-03 S  per = 3.28  per(accum) = 75.4
 T(local opt: guess) = 9.278e-05 S  per = 0.0398  per(accum) = 75.4
 T(local opt: renrm) = 5.710e-02 S  per = 24.5  per(accum) = 99.9
 T(local opt: save ) = 2.083e-04 S  per = 0.0892  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.578e-02 S  T(sum) = 6.562e-02 S  per = 9.975e+01
 T(local opt: preprocess                  ) = 7.232e-05 S  per = 0.11  per(accum) = 0.11
 T(local opt: symbolic_formulae           ) = 7.661e-03 S  per = 11.7  per(accum) = 11.8
 T(local opt: hintermediate init          ) = 1.906e-04 S  per = 0.291  per(accum) = 12.1
 T(local opt: preprocess_hformulae_Hxlist ) = 1.716e-03 S  per = 2.62  per(accum) = 14.7
 T(local opt: hmmtasks init               ) = 1.753e-03 S  per = 2.67  per(accum) = 17.4
 T(local opt: initial guess for dvdson    ) = 2.388e-06 S  per = 0.00364  per(accum) = 17.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.222e-02 S  per = 79.6  per(accum) = 97
 T(local opt: dvdson [cpu-gpu]            ) = 1.946e-03 S  per = 2.97  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 4.646e-06 S  per = 0.00708  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.060e-07 S  per = 0.000162  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.676e-05 S  per = 0.0713  per(accum) = 100
Detailed decomposition of T(renrm) = 5.710e-02 S  T(sum) = 5.710e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.317e-05 S  per = 0.111  per(accum) = 0.111
 T(local opt: qops init                    ) = 8.977e-04 S  per = 1.57  per(accum) = 1.68
 T(local opt: symbolic_formulae_renorm     ) = 8.326e-03 S  per = 14.6  per(accum) = 16.3
 T(local opt: allocate qops on gpu         ) = 4.980e-05 S  per = 0.0872  per(accum) = 16.3
 T(local opt: site memcpy cpu2gpu          ) = 1.922e-03 S  per = 3.37  per(accum) = 19.7
 T(local opt: rintermediate init           ) = 2.509e-03 S  per = 4.39  per(accum) = 24.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.717e-03 S  per = 3.01  per(accum) = 27.1
 T(local opt: rmmtasks init                ) = 1.160e-03 S  per = 2.03  per(accum) = 29.1
 T(local opt: qops memset on cpu           ) = 2.800e-08 S  per = 4.9e-05  per(accum) = 29.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.930e-02 S  per = 68.8  per(accum) = 98
 T(local opt: deallocate cpu and gpu memory) = 3.254e-05 S  per = 0.057  per(accum) = 98
 T(local opt: construct opS [ifdists=true] ) = 4.000e-08 S  per = 7e-05  per(accum) = 98
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 6.48e-05  per(accum) = 98
 T(local opt: qops memcpy gpu2cpu          ) = 1.060e-04 S  per = 0.186  per(accum) = 98.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.434e-05 S  per = 0.0251  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 1.003e-03 S  per = 1.76  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.440e-06 S  per = 0.00252  per(accum) = 100
##### sweep opt: 1.805e+01 S #####
 T(sweep opt: fetch) = 3.949e-01 S  per = 2.19  per(accum) = 2.19
 T(sweep opt: hdiag) = 5.912e+00 S  per = 32.7  per(accum) = 34.9
 T(sweep opt: dvdsn) = 9.117e+00 S  per = 50.5  per(accum) = 85.4
 T(sweep opt: decim) = 3.502e-01 S  per = 1.94  per(accum) = 87.4
 T(sweep opt: guess) = 2.975e-03 S  per = 0.0165  per(accum) = 87.4
 T(sweep opt: renrm) = 2.269e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 7.445e-03 S  per = 0.0412  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.117e+00 S  T(sum) = 9.109e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 3.176e-03 S  per = 0.0349  per(accum) = 0.0349
 T(sweep opt: symbolic_formulae           ) = 4.257e-01 S  per = 4.67  per(accum) = 4.71
 T(sweep opt: hintermediate init          ) = 1.117e-02 S  per = 0.123  per(accum) = 4.83
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.346e-01 S  per = 1.48  per(accum) = 6.31
 T(sweep opt: hmmtasks init               ) = 2.572e-01 S  per = 2.82  per(accum) = 9.13
 T(sweep opt: initial guess for dvdson    ) = 9.825e-05 S  per = 0.00108  per(accum) = 9.13
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.837e+00 S  per = 75.1  per(accum) = 84.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.735e-01 S  per =  1.9  per(accum) = 86.1
 T(sweep opt: dvdson [nccl]               ) = 8.020e-04 S  per = 0.00881  per(accum) = 86.1
 T(sweep opt: dvdson [mpi]                ) = 1.600e-05 S  per = 0.000176  per(accum) = 86.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.265e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 2.269e+00 S  T(sum) = 2.269e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.448e-03 S  per = 0.152  per(accum) = 0.152
 T(sweep opt: qops init                    ) = 5.737e-02 S  per = 2.53  per(accum) = 2.68
 T(sweep opt: symbolic_formulae_renorm     ) = 4.100e-01 S  per = 18.1  per(accum) = 20.8
 T(sweep opt: allocate qops on gpu         ) = 1.815e-03 S  per = 0.08  per(accum) = 20.8
 T(sweep opt: site memcpy cpu2gpu          ) = 3.677e-02 S  per = 1.62  per(accum) = 22.5
 T(sweep opt: rintermediate init           ) = 7.432e-02 S  per = 3.28  per(accum) = 25.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.281e-01 S  per = 5.65  per(accum) = 31.4
 T(sweep opt: rmmtasks init                ) = 2.446e-01 S  per = 10.8  per(accum) = 42.2
 T(sweep opt: qops memset on cpu           ) = 1.371e-06 S  per = 6.04e-05  per(accum) = 42.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.204e+00 S  per =   53  per(accum) = 95.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.911e-03 S  per = 0.128  per(accum) = 95.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.819e-06 S  per = 8.02e-05  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [nccl]) = 1.279e-06 S  per = 5.64e-05  per(accum) = 95.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.263e-03 S  per = 0.276  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.039e-04 S  per = 0.0266  per(accum) = 95.6
 T(sweep opt: qops_pool join and erase     ) = 4.512e-02 S  per = 1.99  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.38  per(accum) = 100
##### global opt: 1.805e+01 S #####
 T(global opt: fetch) = 3.949e-01 S  per = 2.19  per(accum) = 2.19
 T(global opt: hdiag) = 5.912e+00 S  per = 32.7  per(accum) = 34.9
 T(global opt: dvdsn) = 9.117e+00 S  per = 50.5  per(accum) = 85.4
 T(global opt: decim) = 3.502e-01 S  per = 1.94  per(accum) = 87.4
 T(global opt: guess) = 2.975e-03 S  per = 0.0165  per(accum) = 87.4
 T(global opt: renrm) = 2.269e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 7.445e-03 S  per = 0.0412  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.117e+00 S  T(sum) = 9.109e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 3.176e-03 S  per = 0.0349  per(accum) = 0.0349
 T(global opt: symbolic_formulae           ) = 4.257e-01 S  per = 4.67  per(accum) = 4.71
 T(global opt: hintermediate init          ) = 1.117e-02 S  per = 0.123  per(accum) = 4.83
 T(global opt: preprocess_hformulae_Hxlist ) = 1.346e-01 S  per = 1.48  per(accum) = 6.31
 T(global opt: hmmtasks init               ) = 2.572e-01 S  per = 2.82  per(accum) = 9.13
 T(global opt: initial guess for dvdson    ) = 9.825e-05 S  per = 0.00108  per(accum) = 9.13
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.837e+00 S  per = 75.1  per(accum) = 84.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.735e-01 S  per =  1.9  per(accum) = 86.1
 T(global opt: dvdson [nccl]               ) = 8.020e-04 S  per = 0.00881  per(accum) = 86.1
 T(global opt: dvdson [mpi]                ) = 1.600e-05 S  per = 0.000176  per(accum) = 86.1
 T(global opt: dvdson [rest part(linalg)]  ) = 1.265e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 2.269e+00 S  T(sum) = 2.269e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.448e-03 S  per = 0.152  per(accum) = 0.152
 T(global opt: qops init                    ) = 5.737e-02 S  per = 2.53  per(accum) = 2.68
 T(global opt: symbolic_formulae_renorm     ) = 4.100e-01 S  per = 18.1  per(accum) = 20.8
 T(global opt: allocate qops on gpu         ) = 1.815e-03 S  per = 0.08  per(accum) = 20.8
 T(global opt: site memcpy cpu2gpu          ) = 3.677e-02 S  per = 1.62  per(accum) = 22.5
 T(global opt: rintermediate init           ) = 7.432e-02 S  per = 3.28  per(accum) = 25.7
 T(global opt: preprocess_formulae_Rlist2   ) = 1.281e-01 S  per = 5.65  per(accum) = 31.4
 T(global opt: rmmtasks init                ) = 2.446e-01 S  per = 10.8  per(accum) = 42.2
 T(global opt: qops memset on cpu           ) = 1.371e-06 S  per = 6.04e-05  per(accum) = 42.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.204e+00 S  per =   53  per(accum) = 95.2
 T(global opt: deallocate cpu and gpu memory) = 2.911e-03 S  per = 0.128  per(accum) = 95.3
 T(global opt: construct opS [ifdists=true] ) = 1.819e-06 S  per = 8.02e-05  per(accum) = 95.3
 T(global opt: reduction of opS & opH [nccl]) = 1.279e-06 S  per = 5.64e-05  per(accum) = 95.3
 T(global opt: qops memcpy gpu2cpu          ) = 6.263e-03 S  per = 0.276  per(accum) = 95.6
 T(global opt: reduction of opS & opH [mpi] ) = 6.039e-04 S  per = 0.0266  per(accum) = 95.6
 T(global opt: qops_pool join and erase     ) = 4.512e-02 S  per = 1.99  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.38  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-4.324e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=32/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=1208:9.216e-03MB:9.000e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=21970:1.676e-01MB:1.637e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
 rqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=24451:0.187MB:0.000182GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.325e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.675e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(64,3,4) nnz=14:1.068e-04MB
qtensor3: wf3 own=1 _data=0x4678ee00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=2 dimAll=3
 (23,-1):2 (24,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=128 size=14:1.068e-04MB
### DIAG TIMING: total=6.997e-02 t1=2.281e-05, t2=2.105e-04, t3=2.481e-03, t4=6.723e-02, t5=4.532e-06, t6=1.236e-05, t7=3.310e-06
duration_diagGPU:6.998e-02
duration_diagreduce:5.600e-08
duration_diagtransform:2.870e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 4.932e-03 S -----
rank=0 GPUmem(GB): used=1.822e-04 (oper)=1.822e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.210e-04 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper,hinter)=1.822e-04,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.231e-03 S size(H_formulae)=297 size(Hxlst2)=4 T(Hmu/Hxlist)=6.258e-04,6.049e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.271e-03 S size(H_formulae)=297 size(Hxlst)=438 -----
rank=0 GPUmem(GB): used=1.958e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.086e-07 batch[need]=4.895e-05 blksize=6 blksize0=2 batchsize=438
rank=0 GPUmem(GB): used=2.449e-04 (oper,hinter,dvdson,batch)=1.822e-04,1.359e-05,2.086e-07,4.895e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=14 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.114e-04,9.976e-03,3.022e-02,1.261e-02,5.362e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=8.067e-04 speed=2.586e-04GB/S T(nccl)=4.740e-06 speed=4.401e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=134 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=134 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=134 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=134 i=4 t=7.6e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=134 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=134 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=134 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=4.0e+00 t_reduction=1.6e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=134 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=134 i=0 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=2.2e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=9.9e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=134 i=3 t=9.9e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=134 i=4 t=9.8e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=134 i=5 t=9.8e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=134 total t=4.0e+00 per=5.8e+01 cost=7.7e+06 flops=1.9e+06
 sigma_tot[red] counter=134 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.2e+06
T(sub)=9.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.1e-06,1.9e-06,6.5e-07,1.9e-07
settings: ndim=14 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328279347224 -1.116e+03  1.121e-02    1     1  5.373e-02 5.373e-02 5.371e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.620e-04,9.895e-03,2.999e-02,1.251e-02,5.278e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=3.561e-04 speed=5.859e-04GB/S T(nccl)=5.907e-06 speed=3.532e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=135 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.7e+05
 sigma[gemm] counter=135 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=135 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=135 i=4 t=7.6e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=135 i=5 t=7.5e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=135 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=135 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=4.0e+00 t_reduction=1.6e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=135 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=135 i=0 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=2.3e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=135 i=3 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=135 i=4 t=9.9e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=135 i=5 t=9.9e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=135 total t=4.0e+00 per=5.8e+01 cost=7.7e+06 flops=1.9e+06
 sigma_tot[red] counter=135 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.4e-06,9.8e-07,2.6e-07
    2   0 -    -116.328864816862 -5.855e-04  3.175e-03    2     2  1.191e-01 5.956e-02 5.329e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.286e-03,9.973e-03,3.003e-02,1.270e-02,5.401e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.281e-03 speed=1.629e-04GB/S T(nccl)=5.613e-06 speed=3.717e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=136 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=136 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=136 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=136 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=136 i=5 t=7.7e-03 per=1.5e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=136 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=136 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.5e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=4.0e+00 t_reduction=1.7e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=136 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=136 i=0 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=2.3e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=136 i=3 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=136 i=4 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=136 i=5 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=136 total t=4.0e+00 per=5.8e+01 cost=7.7e+06 flops=1.9e+06
 sigma_tot[red] counter=136 t=1.7e+00 per=2.4e+01 cost=2.0e+06 flops=1.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.1e-06,9.7e-07,1.9e-07
    3   0 -    -116.328903031272 -3.821e-05  5.925e-04    3     3  1.828e-01 6.092e-02 5.357e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.233e-03,1.009e-02,3.002e-02,1.247e-02,5.483e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.228e-03 speed=9.363e-05GB/S T(nccl)=5.129e-06 speed=4.067e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=137 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=137 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=7.6e-03 per=1.5e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=137 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=137 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=137 i=5 t=7.4e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=137 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=137 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=4.0e+00 t_reduction=1.7e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=137 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=137 i=0 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=137 i=3 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=137 i=4 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=137 i=5 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=137 total t=4.0e+00 per=5.7e+01 cost=7.7e+06 flops=1.9e+06
 sigma_tot[red] counter=137 t=1.7e+00 per=2.4e+01 cost=2.0e+06 flops=1.2e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.6e-05,2.8e-06,9.9e-07,1.8e-07
    4   0 +    -116.328903814930 -7.837e-07  7.417e-05    3     4  2.546e-01 6.366e-02 5.391e-02
TIMING FOR Davidson : 2.546e-01  T(cal/comm/rest)=2.156e-01,4.900e-07,3.901e-02
decomposed t_rest=3.901e-02
 T(sub)    =7.931e-05 per=2.033e-01
 T(precond)=3.880e-02 per=9.946e+01
 T(ortho)  =2.131e-05 per=5.461e-02
 T(xcopy)  =6.480e-07 per=1.661e-03
 T(xnrm2)  =1.671e-06 per=4.283e-03
 T(other)  =1.079e-04 per=2.767e-01
optimized energies: isweep=0 ibond=32 dots=1 e[0]=-116.328903814930 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.395e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=6 dimAll=12
 (23,-1):2 (24,-2):3 (25,-1):3 (26,-2):1 (24,0):2 (25,-3):1
timing for divide=1.1e-05
timing for compute=1.2e-02
timing for collect=4.1e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,1.2e-02,0.0e+00,4.7e-06,4.1e-05 -----
decimation summary: 12->5 dwt=-2.220e-16 SvN=6.547e-01
 qbond: qkept nsym=3 dimAll=5
 (25,-1):3 (26,-2):1 (24,0):1
----- TIMING for decimation_row(nkr): 1.263e-02 S T(decim/select/formRot)=1.228e-02,3.143e-04,3.362e-05 -----
----- TIMING FOR onedot_decimation: 1.272e-02 S T(wf/decim)=5.562e-05,1.266e-02 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=266:2.029e-03MB:1.982e-06GB
        per(mem): H:4.14 C:38.3 S:6.77 P:1.13 Q:49.6 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.043e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 1.022e-02 S -----
rank=0 GPUmem(GB): used=3.406e-05 (oper)=2.047e-05
rank=0 GPUmem(GB): used=3.415e-05 (oper,site)=2.047e-05,8.941e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.489e-03 S -----
rank=0 GPUmem(GB): used=4.774e-05 (oper,site,rinter)=2.047e-05,8.941e-08,1.359e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.633e-03 S size(rtasks)=77 size(Rlst2)=9 T(Rmu/Rlist)=1.035e-03,5.986e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.681e-03 S size(rtasks)=77 size(Rlst)=246 -----
rank=0 GPUmem(GB): used=4.774e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.849e-05 blksize=9 blksize0=2 batchsize=246
rank=0 GPUmem(GB): used=8.623e-05 (oper,site,rinter,batch)=2.047e-05,8.941e-08,1.359e-05,3.849e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.570e-03,2.265e-02,9.956e-03
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=33 t=6.6e-03 per=1.7e+01 cost=2.3e+03 flops=3.5e+05
 renorm[gemm] counter=33 i=0 t=1.9e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=1 t=1.7e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=2 t=7.6e-03 per=1.9e+01 cost=5.3e+02 flops=6.9e+04
 renorm[gemm] counter=33 i=3 t=7.5e-03 per=1.9e+01 cost=1.3e+03 flops=1.7e+05
 renorm[gemm] counter=33 i=4 t=1.6e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=5 t=1.6e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=6 t=7.5e-03 per=1.9e+01 cost=4.0e+03 flops=5.3e+05
 renorm[gemm] counter=33 total t=2.3e-02 per=5.8e+01 cost=5.8e+03 flops=2.6e+05
 renorm[red] counter=33 t=1.0e-02 per=2.5e+01 cost=2.7e+03 flops=2.7e+05
----- TIMING FOR renorm_tot : t_inter=1.9e-01 t_gemm=7.2e-01 t_reduction=3.2e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=33 t=1.9e-01 per=1.6e+01 cost=1.1e+06 flops=5.5e+06
 renorm_tot[gemm] counter=33 i=0 t=5.1e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=1 t=4.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=2 t=1.2e-01 per=9.6e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=33 i=3 t=1.2e-01 per=9.7e+00 cost=2.7e+05 flops=2.3e+06
 renorm_tot[gemm] counter=33 i=4 t=1.2e-01 per=9.8e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=33 i=5 t=1.2e-01 per=9.8e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=33 i=6 t=2.4e-01 per=2.0e+01 cost=2.8e+06 flops=1.2e+07
 renorm_tot[gemm] counter=33 total t=7.2e-01 per=5.8e+01 cost=3.8e+06 flops=5.3e+06
 renorm_tot[red] counter=33 t=3.2e-01 per=2.6e+01 cost=1.3e+06 flops=4.1e+06
qops.to_cpu: size(tot)=266:2.0e-03MB:2.0e-06GB T(to_cpu)=1.0e-04S speed=2.0e-02GB/S
check ||H-H.dagger||=7.536e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0578 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.513e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.443e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.619e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.159e-01 S #####
 T(local opt: fetch) = 1.050e-02 S  per = 2.52  per(accum) = 2.52
 T(local opt: hdiag) = 7.002e-02 S  per = 16.8  per(accum) = 19.4
 T(local opt: dvdsn) = 2.631e-01 S  per = 63.3  per(accum) = 82.6
 T(local opt: decim) = 1.273e-02 S  per = 3.06  per(accum) = 85.7
 T(local opt: guess) = 1.670e-04 S  per = 0.0401  per(accum) = 85.7
 T(local opt: renrm) = 5.913e-02 S  per = 14.2  per(accum) = 99.9
 T(local opt: save ) = 3.071e-04 S  per = 0.0738  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.631e-01 S  T(sum) = 2.629e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 1.914e-04 S  per = 0.0728  per(accum) = 0.0728
 T(local opt: symbolic_formulae           ) = 4.941e-03 S  per = 1.88  per(accum) = 1.95
 T(local opt: hintermediate init          ) = 1.339e-04 S  per = 0.0509  per(accum) = 2
 T(local opt: preprocess_hformulae_Hxlist ) = 1.285e-03 S  per = 0.489  per(accum) = 2.49
 T(local opt: hmmtasks init               ) = 1.734e-03 S  per = 0.659  per(accum) = 3.15
 T(local opt: initial guess for dvdson    ) = 2.426e-06 S  per = 0.000923  per(accum) = 3.15
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.109e-01 S  per = 80.2  per(accum) = 83.4
 T(local opt: dvdson [cpu-gpu]            ) = 4.672e-03 S  per = 1.78  per(accum) = 85.2
 T(local opt: dvdson [nccl]               ) = 2.139e-05 S  per = 0.00814  per(accum) = 85.2
 T(local opt: dvdson [mpi]                ) = 4.900e-07 S  per = 0.000186  per(accum) = 85.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.901e-02 S  per = 14.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.913e-02 S  T(sum) = 5.913e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.069e-04 S  per = 0.181  per(accum) = 0.181
 T(local opt: qops init                    ) = 1.340e-03 S  per = 2.27  per(accum) = 2.45
 T(local opt: symbolic_formulae_renorm     ) = 1.023e-02 S  per = 17.3  per(accum) = 19.8
 T(local opt: allocate qops on gpu         ) = 6.664e-05 S  per = 0.113  per(accum) = 19.9
 T(local opt: site memcpy cpu2gpu          ) = 6.896e-04 S  per = 1.17  per(accum) = 21
 T(local opt: rintermediate init           ) = 2.503e-03 S  per = 4.23  per(accum) = 25.3
 T(local opt: preprocess_formulae_Rlist2   ) = 1.697e-03 S  per = 2.87  per(accum) = 28.1
 T(local opt: rmmtasks init                ) = 1.773e-03 S  per =    3  per(accum) = 31.1
 T(local opt: qops memset on cpu           ) = 6.800e-08 S  per = 0.000115  per(accum) = 31.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.929e-02 S  per = 66.4  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 3.676e-05 S  per = 0.0622  per(accum) = 97.6
 T(local opt: construct opS [ifdists=true] ) = 7.100e-08 S  per = 0.00012  per(accum) = 97.6
 T(local opt: reduction of opS & opH [nccl]) = 5.100e-08 S  per = 8.62e-05  per(accum) = 97.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.092e-04 S  per = 0.185  per(accum) = 97.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.953e-05 S  per = 0.033  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 1.271e-03 S  per = 2.15  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.712e-06 S  per = 0.0029  per(accum) = 100
##### sweep opt: 1.847e+01 S #####
 T(sweep opt: fetch) = 4.054e-01 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: hdiag) = 5.982e+00 S  per = 32.4  per(accum) = 34.6
 T(sweep opt: dvdsn) = 9.380e+00 S  per = 50.8  per(accum) = 85.4
 T(sweep opt: decim) = 3.630e-01 S  per = 1.97  per(accum) = 87.3
 T(sweep opt: guess) = 3.142e-03 S  per = 0.017  per(accum) = 87.4
 T(sweep opt: renrm) = 2.328e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 7.753e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.380e+00 S  T(sum) = 9.371e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 3.367e-03 S  per = 0.0359  per(accum) = 0.0359
 T(sweep opt: symbolic_formulae           ) = 4.306e-01 S  per =  4.6  per(accum) = 4.63
 T(sweep opt: hintermediate init          ) = 1.130e-02 S  per = 0.121  per(accum) = 4.75
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.359e-01 S  per = 1.45  per(accum) = 6.2
 T(sweep opt: hmmtasks init               ) = 2.589e-01 S  per = 2.76  per(accum) = 8.97
 T(sweep opt: initial guess for dvdson    ) = 1.007e-04 S  per = 0.00107  per(accum) = 8.97
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.048e+00 S  per = 75.2  per(accum) = 84.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.782e-01 S  per =  1.9  per(accum) = 86.1
 T(sweep opt: dvdson [nccl]               ) = 8.234e-04 S  per = 0.00879  per(accum) = 86.1
 T(sweep opt: dvdson [mpi]                ) = 1.649e-05 S  per = 0.000176  per(accum) = 86.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.304e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 2.328e+00 S  T(sum) = 2.328e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.555e-03 S  per = 0.153  per(accum) = 0.153
 T(sweep opt: qops init                    ) = 5.871e-02 S  per = 2.52  per(accum) = 2.67
 T(sweep opt: symbolic_formulae_renorm     ) = 4.202e-01 S  per = 18.1  per(accum) = 20.7
 T(sweep opt: allocate qops on gpu         ) = 1.881e-03 S  per = 0.0808  per(accum) = 20.8
 T(sweep opt: site memcpy cpu2gpu          ) = 3.746e-02 S  per = 1.61  per(accum) = 22.4
 T(sweep opt: rintermediate init           ) = 7.682e-02 S  per =  3.3  per(accum) = 25.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.298e-01 S  per = 5.58  per(accum) = 31.3
 T(sweep opt: rmmtasks init                ) = 2.464e-01 S  per = 10.6  per(accum) = 41.9
 T(sweep opt: qops memset on cpu           ) = 1.439e-06 S  per = 6.18e-05  per(accum) = 41.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.243e+00 S  per = 53.4  per(accum) = 95.3
 T(sweep opt: deallocate cpu and gpu memory) = 2.948e-03 S  per = 0.127  per(accum) = 95.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.890e-06 S  per = 8.12e-05  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.330e-06 S  per = 5.71e-05  per(accum) = 95.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.372e-03 S  per = 0.274  per(accum) = 95.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.235e-04 S  per = 0.0268  per(accum) = 95.7
 T(sweep opt: qops_pool join and erase     ) = 4.639e-02 S  per = 1.99  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.32  per(accum) = 100
##### global opt: 1.847e+01 S #####
 T(global opt: fetch) = 4.054e-01 S  per =  2.2  per(accum) = 2.2
 T(global opt: hdiag) = 5.982e+00 S  per = 32.4  per(accum) = 34.6
 T(global opt: dvdsn) = 9.380e+00 S  per = 50.8  per(accum) = 85.4
 T(global opt: decim) = 3.630e-01 S  per = 1.97  per(accum) = 87.3
 T(global opt: guess) = 3.142e-03 S  per = 0.017  per(accum) = 87.4
 T(global opt: renrm) = 2.328e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 7.753e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.380e+00 S  T(sum) = 9.371e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 3.367e-03 S  per = 0.0359  per(accum) = 0.0359
 T(global opt: symbolic_formulae           ) = 4.306e-01 S  per =  4.6  per(accum) = 4.63
 T(global opt: hintermediate init          ) = 1.130e-02 S  per = 0.121  per(accum) = 4.75
 T(global opt: preprocess_hformulae_Hxlist ) = 1.359e-01 S  per = 1.45  per(accum) = 6.2
 T(global opt: hmmtasks init               ) = 2.589e-01 S  per = 2.76  per(accum) = 8.97
 T(global opt: initial guess for dvdson    ) = 1.007e-04 S  per = 0.00107  per(accum) = 8.97
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.048e+00 S  per = 75.2  per(accum) = 84.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.782e-01 S  per =  1.9  per(accum) = 86.1
 T(global opt: dvdson [nccl]               ) = 8.234e-04 S  per = 0.00879  per(accum) = 86.1
 T(global opt: dvdson [mpi]                ) = 1.649e-05 S  per = 0.000176  per(accum) = 86.1
 T(global opt: dvdson [rest part(linalg)]  ) = 1.304e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 2.328e+00 S  T(sum) = 2.328e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.555e-03 S  per = 0.153  per(accum) = 0.153
 T(global opt: qops init                    ) = 5.871e-02 S  per = 2.52  per(accum) = 2.67
 T(global opt: symbolic_formulae_renorm     ) = 4.202e-01 S  per = 18.1  per(accum) = 20.7
 T(global opt: allocate qops on gpu         ) = 1.881e-03 S  per = 0.0808  per(accum) = 20.8
 T(global opt: site memcpy cpu2gpu          ) = 3.746e-02 S  per = 1.61  per(accum) = 22.4
 T(global opt: rintermediate init           ) = 7.682e-02 S  per =  3.3  per(accum) = 25.7
 T(global opt: preprocess_formulae_Rlist2   ) = 1.298e-01 S  per = 5.58  per(accum) = 31.3
 T(global opt: rmmtasks init                ) = 2.464e-01 S  per = 10.6  per(accum) = 41.9
 T(global opt: qops memset on cpu           ) = 1.439e-06 S  per = 6.18e-05  per(accum) = 41.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.243e+00 S  per = 53.4  per(accum) = 95.3
 T(global opt: deallocate cpu and gpu memory) = 2.948e-03 S  per = 0.127  per(accum) = 95.4
 T(global opt: construct opS [ifdists=true] ) = 1.890e-06 S  per = 8.12e-05  per(accum) = 95.4
 T(global opt: reduction of opS & opH [nccl]) = 1.330e-06 S  per = 5.71e-05  per(accum) = 95.4
 T(global opt: qops memcpy gpu2cpu          ) = 6.372e-03 S  per = 0.274  per(accum) = 95.7
 T(global opt: reduction of opS & opH [mpi] ) = 6.235e-04 S  per = 0.0268  per(accum) = 95.7
 T(global opt: qops_pool join and erase     ) = 4.639e-02 S  per = 1.99  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.32  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.402e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=33/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1144:8.728e-03MB:8.523e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=13:9.918e-05MB:9.686e-08GB
total mem of comb=1205:9.193e-03MB:8.978e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=1352:1.031e-02MB:1.007e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
 rqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=266:0.00203MB:1.98e-06GB
        per(mem): H:4.14 C:38.3 S:6.77 P:1.13 Q:49.6 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3954:0.0302MB:2.95e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.787e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.127e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(16,5,4) nnz=13:9.918e-05MB
qtensor3: wf3 own=1 _data=0x3ab5ec40
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=3 dimAll=5
 (25,-1):3 (26,-2):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=108 size=13:9.918e-05MB
### DIAG TIMING: total=8.927e-03 t1=2.809e-05, t2=2.169e-05, t3=3.618e-04, t4=8.491e-03, t5=5.302e-06, t6=1.552e-05, t7=3.875e-06
duration_diagGPU:8.940e-03
duration_diagreduce:6.600e-08
duration_diagtransform:7.070e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 3.590e-03 S -----
rank=0 GPUmem(GB): used=2.946e-05 (oper)=2.946e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.042e-04 S -----
rank=0 GPUmem(GB): used=3.681e-05 (oper,hinter)=2.946e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.180e-03 S size(H_formulae)=193 size(Hxlst2)=5 T(Hmu/Hxlist)=4.814e-04,6.984e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.235e-03 S size(H_formulae)=193 size(Hxlst)=448 -----
rank=0 GPUmem(GB): used=3.681e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.937e-07 batch[need]=5.341e-05 blksize=6 blksize0=3 batchsize=448
rank=0 GPUmem(GB): used=9.041e-05 (oper,hinter,dvdson,batch)=2.946e-05,7.346e-06,1.937e-07,5.341e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=13 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.545e-03,9.979e-03,2.986e-02,1.237e-02,5.376e-02
 analyze_tgpu[Hx]: ndim=13:9.686e-08GB T(cpu-gpu)=1.541e-03 speed=1.257e-04GB/S T(nccl)=4.931e-06 speed=3.929e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=138 t=1.0e-02 per=1.9e+01 cost=7.1e+03 flops=7.2e+05
 sigma[gemm] counter=138 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=138 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=138 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+03 flops=2.0e+05
 sigma[gemm] counter=138 i=5 t=7.4e-03 per=1.4e+01 cost=1.4e+03 flops=1.8e+05
 sigma[gemm] counter=138 total t=3.0e-02 per=5.7e+01 cost=6.3e+03 flops=2.1e+05
 sigma[red] counter=138 t=1.2e-02 per=2.4e+01 cost=2.6e+03 flops=2.1e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=4.1e+00 t_reduction=1.7e+00 tot=7.1e+00 -----
 sigma_tot[inter] counter=138 t=1.3e+00 per=1.9e+01 cost=4.5e+06 flops=3.4e+06
 sigma_tot[gemm] counter=138 i=0 t=2.7e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=1.9e+06
 sigma_tot[gemm] counter=138 i=3 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=138 i=4 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=138 i=5 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=138 total t=4.1e+00 per=5.7e+01 cost=7.7e+06 flops=1.9e+06
 sigma_tot[red] counter=138 t=1.7e+00 per=2.4e+01 cost=2.0e+06 flops=1.2e+06
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.0e-06,1.9e-06,7.2e-07,2.1e-07
settings: ndim=13 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.328903814930 -1.116e+03  6.275e-05    1     1  5.387e-02 5.387e-02 5.385e-02
TIMING FOR Davidson : 5.390e-02  T(cal/comm/rest)=5.385e-02,1.100e-07,4.826e-05
decomposed t_rest=4.826e-05
 T(sub)    =9.422e-06 per=1.952e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.450e-07 per=7.148e-01
 T(xnrm2)  =3.670e-07 per=7.604e-01
 T(other)  =3.813e-05 per=7.900e+01
optimized energies: isweep=0 ibond=33 dots=1 e[0]=-116.328903814930 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.749e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=8 dimAll=20
 (25,-1):4 (26,-2):4 (24,0):1 (27,-1):4 (28,-2):1 (26,0):4 (25,1):1 (27,-3):1
timing for divide=1.0e-05
timing for compute=1.2e-02
timing for collect=2.2e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,1.2e-02,0.0e+00,4.5e-06,2.2e-05 -----
decimation summary: 20->4 dwt=+0.000e+00 SvN=5.393e-01
 qbond: qkept nsym=3 dimAll=4
 (27,-1):2 (28,-2):1 (26,0):1
----- TIMING for decimation_row(nkr): 1.262e-02 S T(decim/select/formRot)=1.238e-02,2.181e-04,2.097e-05 -----
----- TIMING FOR onedot_decimation: 1.269e-02 S T(wf/decim)=5.587e-05,1.264e-02 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=123:9.384e-04MB:9.164e-07GB
        per(mem): H:4.88 C:58.5 S:6.5 P:0.813 Q:29.3 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.225e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 3.194e-03 S -----
rank=0 GPUmem(GB): used=2.765e-05 (oper)=2.030e-05
rank=0 GPUmem(GB): used=2.775e-05 (oper,site)=2.030e-05,9.686e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.500e-03 S -----
rank=0 GPUmem(GB): used=3.509e-05 (oper,site,rinter)=2.030e-05,9.686e-08,7.346e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.899e-04 S size(rtasks)=57 size(Rlst2)=9 T(Rmu/Rlist)=4.593e-04,4.306e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.316e-04 S size(rtasks)=57 size(Rlst)=273 -----
rank=0 GPUmem(GB): used=3.509e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.254e-05 blksize=6 blksize0=3 batchsize=273
rank=0 GPUmem(GB): used=6.764e-05 (oper,site,rinter,batch)=2.030e-05,9.686e-08,7.346e-06,3.254e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.558e-03,2.212e-02,9.929e-03
----- TIMING FOR renorm : t_inter=7.6e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=34 t=7.6e-03 per=1.9e+01 cost=3.6e+03 flops=4.7e+05
 renorm[gemm] counter=34 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=1 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=2 t=7.4e-03 per=1.9e+01 cost=7.0e+02 flops=9.5e+04
 renorm[gemm] counter=34 i=3 t=7.4e-03 per=1.9e+01 cost=1.5e+03 flops=2.1e+05
 renorm[gemm] counter=34 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=6 t=7.4e-03 per=1.9e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=34 total t=2.2e-02 per=5.6e+01 cost=4.6e+03 flops=2.1e+05
 renorm[red] counter=34 t=9.9e-03 per=2.5e+01 cost=1.2e+03 flops=1.2e+05
----- TIMING FOR renorm_tot : t_inter=2.0e-01 t_gemm=7.5e-01 t_reduction=3.3e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=34 t=2.0e-01 per=1.6e+01 cost=1.1e+06 flops=5.3e+06
 renorm_tot[gemm] counter=34 i=0 t=5.3e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=1 t=4.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=2 t=1.3e-01 per=9.9e+00 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=34 i=3 t=1.3e-01 per=1.0e+01 cost=2.8e+05 flops=2.2e+06
 renorm_tot[gemm] counter=34 i=4 t=1.2e-01 per=9.5e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=34 i=5 t=1.2e-01 per=9.5e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=34 i=6 t=2.5e-01 per=1.9e+01 cost=2.8e+06 flops=1.1e+07
 renorm_tot[gemm] counter=34 total t=7.5e-01 per=5.8e+01 cost=3.8e+06 flops=5.1e+06
 renorm_tot[red] counter=34 t=3.3e-01 per=2.6e+01 cost=1.3e+06 flops=3.9e+06
qops.to_cpu: size(tot)=123:9.4e-04MB:9.2e-07GB T(to_cpu)=7.8e-05S speed=1.2e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0509 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.862e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.187e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.513e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.485e-01 S #####
 T(local opt: fetch) = 1.316e-02 S  per = 8.87  per(accum) = 8.87
 T(local opt: hdiag) = 8.993e-03 S  per = 6.06  per(accum) = 14.9
 T(local opt: dvdsn) = 6.142e-02 S  per = 41.4  per(accum) = 56.3
 T(local opt: decim) = 1.270e-02 S  per = 8.56  per(accum) = 64.9
 T(local opt: guess) = 8.742e-05 S  per = 0.0589  per(accum) = 64.9
 T(local opt: renrm) = 5.188e-02 S  per = 34.9  per(accum) = 99.9
 T(local opt: save ) = 2.061e-04 S  per = 0.139  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.142e-02 S  T(sum) = 6.127e-02 S  per = 9.975e+01
 T(local opt: preprocess                  ) = 2.146e-04 S  per = 0.35  per(accum) = 0.35
 T(local opt: symbolic_formulae           ) = 3.600e-03 S  per = 5.88  per(accum) = 6.23
 T(local opt: hintermediate init          ) = 1.205e-04 S  per = 0.197  per(accum) = 6.42
 T(local opt: preprocess_hformulae_Hxlist ) = 1.258e-03 S  per = 2.05  per(accum) = 8.48
 T(local opt: hmmtasks init               ) = 2.172e-03 S  per = 3.54  per(accum) = 12
 T(local opt: initial guess for dvdson    ) = 2.695e-06 S  per = 0.0044  per(accum) = 12
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.230e-02 S  per = 85.4  per(accum) = 97.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.541e-03 S  per = 2.51  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 4.931e-06 S  per = 0.00805  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.100e-07 S  per = 0.00018  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.826e-05 S  per = 0.0788  per(accum) = 100
Detailed decomposition of T(renrm) = 5.188e-02 S  T(sum) = 5.188e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.420e-05 S  per = 0.143  per(accum) = 0.143
 T(local opt: qops init                    ) = 7.135e-04 S  per = 1.38  per(accum) = 1.52
 T(local opt: symbolic_formulae_renorm     ) = 3.205e-03 S  per = 6.18  per(accum) = 7.7
 T(local opt: allocate qops on gpu         ) = 5.200e-05 S  per =  0.1  per(accum) = 7.8
 T(local opt: site memcpy cpu2gpu          ) = 2.175e-03 S  per = 4.19  per(accum) = 12
 T(local opt: rintermediate init           ) = 2.511e-03 S  per = 4.84  per(accum) = 16.8
 T(local opt: preprocess_formulae_Rlist2   ) = 9.449e-04 S  per = 1.82  per(accum) = 18.6
 T(local opt: rmmtasks init                ) = 1.502e-03 S  per = 2.89  per(accum) = 21.5
 T(local opt: qops memset on cpu           ) = 6.800e-08 S  per = 0.000131  per(accum) = 21.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.969e-02 S  per = 76.5  per(accum) = 98
 T(local opt: deallocate cpu and gpu memory) = 3.191e-05 S  per = 0.0615  per(accum) = 98.1
 T(local opt: construct opS [ifdists=true] ) = 5.400e-08 S  per = 0.000104  per(accum) = 98.1
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 7.13e-05  per(accum) = 98.1
 T(local opt: qops memcpy gpu2cpu          ) = 8.466e-05 S  per = 0.163  per(accum) = 98.3
 T(local opt: reduction of opS & opH [mpi] ) = 1.531e-05 S  per = 0.0295  per(accum) = 98.3
 T(local opt: qops_pool join and erase     ) = 8.837e-04 S  per =  1.7  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.306e-06 S  per = 0.00252  per(accum) = 100
##### sweep opt: 1.862e+01 S #####
 T(sweep opt: fetch) = 4.186e-01 S  per = 2.25  per(accum) = 2.25
 T(sweep opt: hdiag) = 5.991e+00 S  per = 32.2  per(accum) = 34.4
 T(sweep opt: dvdsn) = 9.441e+00 S  per = 50.7  per(accum) = 85.1
 T(sweep opt: decim) = 3.757e-01 S  per = 2.02  per(accum) = 87.2
 T(sweep opt: guess) = 3.230e-03 S  per = 0.0173  per(accum) = 87.2
 T(sweep opt: renrm) = 2.380e+00 S  per = 12.8  per(accum) = 100
 T(sweep opt: save ) = 7.959e-03 S  per = 0.0427  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.441e+00 S  T(sum) = 9.433e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 3.582e-03 S  per = 0.038  per(accum) = 0.038
 T(sweep opt: symbolic_formulae           ) = 4.342e-01 S  per =  4.6  per(accum) = 4.64
 T(sweep opt: hintermediate init          ) = 1.142e-02 S  per = 0.121  per(accum) = 4.76
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.372e-01 S  per = 1.45  per(accum) = 6.22
 T(sweep opt: hmmtasks init               ) = 2.611e-01 S  per = 2.77  per(accum) = 8.99
 T(sweep opt: initial guess for dvdson    ) = 1.034e-04 S  per = 0.0011  per(accum) = 8.99
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.100e+00 S  per = 75.3  per(accum) = 84.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.797e-01 S  per = 1.91  per(accum) = 86.2
 T(sweep opt: dvdson [nccl]               ) = 8.284e-04 S  per = 0.00878  per(accum) = 86.2
 T(sweep opt: dvdson [mpi]                ) = 1.660e-05 S  per = 0.000176  per(accum) = 86.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.304e+00 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 2.380e+00 S  T(sum) = 2.380e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.629e-03 S  per = 0.152  per(accum) = 0.152
 T(sweep opt: qops init                    ) = 5.942e-02 S  per =  2.5  per(accum) = 2.65
 T(sweep opt: symbolic_formulae_renorm     ) = 4.234e-01 S  per = 17.8  per(accum) = 20.4
 T(sweep opt: allocate qops on gpu         ) = 1.933e-03 S  per = 0.0812  per(accum) = 20.5
 T(sweep opt: site memcpy cpu2gpu          ) = 3.963e-02 S  per = 1.67  per(accum) = 22.2
 T(sweep opt: rintermediate init           ) = 7.933e-02 S  per = 3.33  per(accum) = 25.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.308e-01 S  per = 5.49  per(accum) = 31
 T(sweep opt: rmmtasks init                ) = 2.479e-01 S  per = 10.4  per(accum) = 41.4
 T(sweep opt: qops memset on cpu           ) = 1.507e-06 S  per = 6.33e-05  per(accum) = 41.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.283e+00 S  per = 53.9  per(accum) = 95.3
 T(sweep opt: deallocate cpu and gpu memory) = 2.980e-03 S  per = 0.125  per(accum) = 95.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.944e-06 S  per = 8.17e-05  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.367e-06 S  per = 5.74e-05  per(accum) = 95.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.457e-03 S  per = 0.271  per(accum) = 95.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.388e-04 S  per = 0.0268  per(accum) = 95.7
 T(sweep opt: qops_pool join and erase     ) = 4.727e-02 S  per = 1.99  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.27  per(accum) = 100
##### global opt: 1.862e+01 S #####
 T(global opt: fetch) = 4.186e-01 S  per = 2.25  per(accum) = 2.25
 T(global opt: hdiag) = 5.991e+00 S  per = 32.2  per(accum) = 34.4
 T(global opt: dvdsn) = 9.441e+00 S  per = 50.7  per(accum) = 85.1
 T(global opt: decim) = 3.757e-01 S  per = 2.02  per(accum) = 87.2
 T(global opt: guess) = 3.230e-03 S  per = 0.0173  per(accum) = 87.2
 T(global opt: renrm) = 2.380e+00 S  per = 12.8  per(accum) = 100
 T(global opt: save ) = 7.959e-03 S  per = 0.0427  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.441e+00 S  T(sum) = 9.433e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 3.582e-03 S  per = 0.038  per(accum) = 0.038
 T(global opt: symbolic_formulae           ) = 4.342e-01 S  per =  4.6  per(accum) = 4.64
 T(global opt: hintermediate init          ) = 1.142e-02 S  per = 0.121  per(accum) = 4.76
 T(global opt: preprocess_hformulae_Hxlist ) = 1.372e-01 S  per = 1.45  per(accum) = 6.22
 T(global opt: hmmtasks init               ) = 2.611e-01 S  per = 2.77  per(accum) = 8.99
 T(global opt: initial guess for dvdson    ) = 1.034e-04 S  per = 0.0011  per(accum) = 8.99
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.100e+00 S  per = 75.3  per(accum) = 84.3
 T(global opt: dvdson [cpu-gpu]            ) = 1.797e-01 S  per = 1.91  per(accum) = 86.2
 T(global opt: dvdson [nccl]               ) = 8.284e-04 S  per = 0.00878  per(accum) = 86.2
 T(global opt: dvdson [mpi]                ) = 1.660e-05 S  per = 0.000176  per(accum) = 86.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.304e+00 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 2.380e+00 S  T(sum) = 2.380e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.629e-03 S  per = 0.152  per(accum) = 0.152
 T(global opt: qops init                    ) = 5.942e-02 S  per =  2.5  per(accum) = 2.65
 T(global opt: symbolic_formulae_renorm     ) = 4.234e-01 S  per = 17.8  per(accum) = 20.4
 T(global opt: allocate qops on gpu         ) = 1.933e-03 S  per = 0.0812  per(accum) = 20.5
 T(global opt: site memcpy cpu2gpu          ) = 3.963e-02 S  per = 1.67  per(accum) = 22.2
 T(global opt: rintermediate init           ) = 7.933e-02 S  per = 3.33  per(accum) = 25.5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.308e-01 S  per = 5.49  per(accum) = 31
 T(global opt: rmmtasks init                ) = 2.479e-01 S  per = 10.4  per(accum) = 41.4
 T(global opt: qops memset on cpu           ) = 1.507e-06 S  per = 6.33e-05  per(accum) = 41.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.283e+00 S  per = 53.9  per(accum) = 95.3
 T(global opt: deallocate cpu and gpu memory) = 2.980e-03 S  per = 0.125  per(accum) = 95.4
 T(global opt: construct opS [ifdists=true] ) = 1.944e-06 S  per = 8.17e-05  per(accum) = 95.4
 T(global opt: reduction of opS & opH [nccl]) = 1.367e-06 S  per = 5.74e-05  per(accum) = 95.4
 T(global opt: qops memcpy gpu2cpu          ) = 6.457e-03 S  per = 0.271  per(accum) = 95.7
 T(global opt: reduction of opS & opH [mpi] ) = 6.388e-04 S  per = 0.0268  per(accum) = 95.7
 T(global opt: qops_pool join and erase     ) = 4.727e-02 S  per = 1.99  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 5.405e-02 S  per = 2.27  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.488e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

======================================================================
sweep_data::summary isweep=0 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=1 dcut=100 eps=1.000e-04 noise=0.000e+00
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=1 e[0]=-116.148569549899 t=0.141
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=64 dwt=+0.000e+00 nmvp=3 e[0]=-116.178979049791 t=0.356
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=3 dwt=+1.110e-16 nmvp=6 e[0]=-116.201799839537 t=0.536
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=5 e[0]=-116.207979653445 t=0.485
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=5 dwt=-2.220e-16 nmvp=4 e[0]=-116.208089881617 t=0.462
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=6 dwt=+0.000e+00 nmvp=4 e[0]=-116.208828591192 t=0.596
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=6 dwt=+0.000e+00 nmvp=5 e[0]=-116.221564167486 t=0.694
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=6 dwt=+0.000e+00 nmvp=5 e[0]=-116.239302101363 t=0.774
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=7 dwt=+0.000e+00 nmvp=6 e[0]=-116.249940669273 t=0.980
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=7 dwt=-2.220e-16 nmvp=4 e[0]=-116.251301799857 t=0.866
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=7 dwt=+0.000e+00 nmvp=6 e[0]=-116.271896441599 t=0.848
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=6 dwt=+1.110e-16 nmvp=6 e[0]=-116.291888550589 t=0.702
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=6 e[0]=-116.301384902089 t=0.714
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=2 dwt=+0.000e+00 nmvp=5 e[0]=-116.309956986587 t=0.594
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=3 dwt=+0.000e+00 nmvp=4 e[0]=-116.309977015224 t=0.415
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=3 dwt=+1.110e-16 nmvp=5 e[0]=-116.311856917920 t=0.443
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=3 dwt=+0.000e+00 nmvp=4 e[0]=-116.314230523770 t=0.366
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=1 e[0]=-116.314230523770 t=0.150
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=64 dwt=+0.000e+00 nmvp=1 e[0]=-116.314230523770 t=0.210
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=3 dwt=+0.000e+00 nmvp=6 e[0]=-116.322004322050 t=0.486
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=2 dwt=+0.000e+00 nmvp=4 e[0]=-116.322036004501 t=0.401
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=4 dwt=+0.000e+00 nmvp=3 e[0]=-116.322036723062 t=0.401
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=6 dwt=+0.000e+00 nmvp=6 e[0]=-116.322162108317 t=0.705
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=7 dwt=-2.220e-16 nmvp=5 e[0]=-116.322363025516 t=0.734
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=5 e[0]=-116.323071653332 t=0.773
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=4 e[0]=-116.323142503667 t=0.899
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=6 dwt=+0.000e+00 nmvp=3 e[0]=-116.323153873735 t=0.786
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=6 dwt=+1.110e-16 nmvp=4 e[0]=-116.326036515321 t=0.671
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=6 dwt=+2.220e-16 nmvp=4 e[0]=-116.328199520972 t=0.603
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=5 dwt=+0.000e+00 nmvp=3 e[0]=-116.328224067176 t=0.542
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=4 dwt=+1.110e-16 nmvp=4 e[0]=-116.328279347223 t=0.487
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=3 dwt=+0.000e+00 nmvp=1 e[0]=-116.328279347224 t=0.233
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=5 dwt=-2.220e-16 nmvp=4 e[0]=-116.328903814930 t=0.416
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=4 dwt=+0.000e+00 nmvp=1 e[0]=-116.328903814930 t=0.148
 eav_max=-116.148569549899 [ibond=0]  dwt_min=-2.220e-16 [ibond=4]
 eav_min=-116.328903814930 [ibond=32]  dwt_max=2.220e-16 [ibond=28]
 eav_diff=0.180334265031
 sweep energies: isweep=0 dots=1 dcut=100 deff=5 dwt=-2.220e-16 e[0]=-116.328903814930
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  1     100 1.000e-04 0.000e+00 | 138 | 1.866e+01 | 1.866e+01 | 1.524e+00 4.818e+00 2.019e+00 8.361e+00 44.8
results: isweep, dcut, dwt, energies (delta_e)
            0     100 -2.220e-16 e[0]=-116.328903814930 (0.000e+00)
======================================================================
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=7.451e-09 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=4 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=8 dimAll=16
 (27,-1):3 (28,-2):3 (26,0):1 (29,-1):3 (30,-2):1 (28,0):3 (27,1):1 (29,-3):1
timing for divide=7.881e-06
timing for compute=1.279e-02
timing for collect=1.343e-05
----- TMING FOR decimation_genbasis(nkr): 1.281e-02 S T(divide/compute[cpu/gpu/rest]/collect)=7.881e-06,1.278e-02,0.000e+00,4.112e-06,1.343e-05 -----
decimation summary: 16->2 dwt=+0.000e+00 SvN=3.629e-01
 qbond: qkept nsym=2 dimAll=2
 (29,-1):1 (28,0):1
----- TIMING for decimation_row(nkr): 1.302e-02 S T(decim/select/formRot)=1.285e-02,1.534e-04,1.820e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=6 dimAll=8
 (29,-1):2 (28,0):1 (31,-1):1 (30,0):2 (29,1):1 (30,-2):1
timing for divide=6.990e-06
timing for compute=2.335e-02
timing for collect=3.146e-05
----- TMING FOR decimation_genbasis(nkr): 2.339e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.990e-06,2.335e-02,0.000e+00,5.540e-06,3.146e-05 -----
decimation summary: 8->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 2.360e-02 S T(decim/select/formRot)=2.343e-02,1.525e-04,1.711e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0 T(save)=7.88e-04S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=16 maxdiff=0.000e+00 deviate=0
 idx=2 node=(17,0) Drow=64 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=5.275e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=6.665e-16 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.331e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=9.424e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=9.691e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=8.883e-16 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=7.260e-16 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=9.738e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=3.147e-16 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=7.977e-16 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=1.144e-15 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=1.199e-15 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=5 maxdiff=3.745e-16 deviate=0
 idx=17 node=(2,0) Drow=4 maxdiff=1.016e-15 deviate=0
 idx=18 node=(1,0) Drow=2 maxdiff=4.441e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=2.220e-16 deviate=0
qtensor2: wf2 own=1 _data=0x45929bf0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x45929bf0
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 5.688e-04 S -----
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=725:0.00553MB:5.4e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=2:1.53e-05MB:1.49e-08GB
total mem of comb=775:0.00591MB:5.77e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.176e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=123:0.000938MB:9.16e-07GB
        per(mem): H:4.88 C:58.5 S:6.5 P:0.813 Q:29.3 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=26:0.000198MB:1.94e-07GB
        per(mem): H:7.69 C:73.1 S:3.85 P:0 Q:15.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.945e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 1.213e-03 S -----
rank=0 GPUmem(GB): used=1.851e-05 (oper)=1.851e-05
rank=0 GPUmem(GB): used=1.856e-05 (oper,site)=1.851e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=45
 no. of rintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.464e-03 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper,site,rinter)=1.851e-05,4.470e-08,2.682e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.201e-04 S size(rtasks)=45 size(Rlst2)=4 T(Rmu/Rlist)=2.674e-04,2.527e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.470e-04 S size(rtasks)=45 size(Rlst)=173 -----
rank=0 GPUmem(GB): used=2.124e-05 avail=6.176e+00 total=6.176e+00 batch[need]=9.023e-06 blksize=2 blksize0=2 batchsize=173
rank=0 GPUmem(GB): used=3.026e-05 (oper,site,rinter,batch)=1.851e-05,4.470e-08,2.682e-06,9.023e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.356e-03,2.228e-02,9.937e-03
----- TIMING FOR renorm : t_inter=8.4e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=4.1e-02 -----
 renorm[inter] counter=35 t=8.4e-03 per=2.1e+01 cost=7.9e+02 flops=9.5e+04
 renorm[gemm] counter=35 i=0 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=1 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=2 t=7.4e-03 per=1.8e+01 cost=2.3e+02 flops=3.1e+04
 renorm[gemm] counter=35 i=3 t=7.4e-03 per=1.8e+01 cost=4.2e+02 flops=5.7e+04
 renorm[gemm] counter=35 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=5 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=6 t=7.4e-03 per=1.8e+01 cost=5.2e+02 flops=7.0e+04
 renorm[gemm] counter=35 total t=2.2e-02 per=5.5e+01 cost=1.2e+03 flops=5.3e+04
 renorm[red] counter=35 t=9.9e-03 per=2.4e+01 cost=3.5e+02 flops=3.5e+04
----- TIMING FOR renorm_tot : t_inter=2.1e-01 t_gemm=7.7e-01 t_reduction=3.4e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=35 t=2.1e-01 per=1.6e+01 cost=1.1e+06 flops=5.1e+06
 renorm_tot[gemm] counter=35 i=0 t=5.4e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=1 t=4.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=2 t=1.3e-01 per=1.0e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=35 i=3 t=1.4e-01 per=1.0e+01 cost=2.8e+05 flops=2.0e+06
 renorm_tot[gemm] counter=35 i=4 t=1.2e-01 per=9.2e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=35 i=5 t=1.2e-01 per=9.2e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=35 i=6 t=2.6e-01 per=1.9e+01 cost=2.8e+06 flops=1.1e+07
 renorm_tot[gemm] counter=35 total t=7.7e-01 per=5.8e+01 cost=3.8e+06 flops=5.0e+06
 renorm_tot[red] counter=35 t=3.4e-01 per=2.6e+01 cost=1.3e+06 flops=3.8e+06
qops.to_cpu: size(tot)=26:2.0e-04MB:1.9e-07GB T(to_cpu)=5.1e-05S speed=3.8e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0481 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.994e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

coord=(0,0)
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=26:0.000198MB:1.94e-07GB
        per(mem): H:7.69 C:73.1 S:3.85 P:0 Q:15.4 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:40 S:0 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.138e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 3.628e-04 S -----
rank=0 GPUmem(GB): used=1.761e-05 (oper)=1.761e-05
rank=0 GPUmem(GB): used=1.762e-05 (oper,site)=1.761e-05,1.490e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.762e-05 (oper,site,rinter)=1.761e-05,1.490e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.431e-04 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=1.526e-04,9.046e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.565e-04 S size(rtasks)=41 size(Rlst)=54 -----
rank=0 GPUmem(GB): used=1.762e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.207e-06 blksize=1 blksize0=0 batchsize=54
rank=0 GPUmem(GB): used=1.883e-05 (oper,site,rinter,batch)=1.761e-05,1.490e-08,0.000e+00,1.207e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.913e-03,2.252e-02,1.008e-02
----- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.5e-02 -----
 renorm[inter] counter=36 t=1.9e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=0 t=1.7e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=1 t=1.2e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=2 t=7.6e-03 per=2.2e+01 cost=5.0e+01 flops=6.6e+03
 renorm[gemm] counter=36 i=3 t=7.5e-03 per=2.2e+01 cost=5.0e+01 flops=6.7e+03
 renorm[gemm] counter=36 i=4 t=1.2e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=5 t=1.1e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=6 t=7.5e-03 per=2.2e+01 cost=1.1e+02 flops=1.4e+04
 renorm[gemm] counter=36 total t=2.3e-02 per=6.5e+01 cost=2.1e+02 flops=9.2e+03
 renorm[red] counter=36 t=1.0e-02 per=2.9e+01 cost=1.1e+02 flops=1.1e+04
----- TIMING FOR renorm_tot : t_inter=2.1e-01 t_gemm=7.9e-01 t_reduction=3.5e-01 tot=1.4e+00 -----
 renorm_tot[inter] counter=36 t=2.1e-01 per=1.6e+01 cost=1.1e+06 flops=5.1e+06
 renorm_tot[gemm] counter=36 i=0 t=5.6e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=1 t=4.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=2 t=1.4e-01 per=1.0e+01 cost=2.1e+05 flops=1.5e+06
 renorm_tot[gemm] counter=36 i=3 t=1.4e-01 per=1.1e+01 cost=2.8e+05 flops=1.9e+06
 renorm_tot[gemm] counter=36 i=4 t=1.2e-01 per=8.9e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=36 i=5 t=1.2e-01 per=9.0e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=36 i=6 t=2.6e-01 per=1.9e+01 cost=2.8e+06 flops=1.1e+07
 renorm_tot[gemm] counter=36 total t=7.9e-01 per=5.8e+01 cost=3.8e+06 flops=4.8e+06
 renorm_tot[red] counter=36 t=3.5e-01 per=2.6e+01 cost=1.3e+06 flops=3.7e+06
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=3.8e-05S speed=1.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0364 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.935e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

matrix: Hmat_isweep0 size=(1,1)
     -1.163289038149e+02 

----- TIMING FOR sweep_opt: isweep=0 : 1.880e+01 S -----

----- TIMING FOR ctns::sweep_opt : 1.881e+01 S -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.498e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

Congrats! CTNS calculation finishes successfully. Sun Jan 12 11:15:57 2025

