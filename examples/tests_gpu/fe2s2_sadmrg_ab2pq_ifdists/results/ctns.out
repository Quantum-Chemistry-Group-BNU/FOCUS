
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Wed Jan  1 12:11:26 2025

GIT_HASH = 9a97ae153aaa5405988fe420a5df66f11e16fed2

mpisize = 2 maxthreads = 2

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNS
tosu2
maxdets 10 #000 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  2 10 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
ifdist1
ifdistc
ifnccl
#save_formulae
batchhvec 4 4 4
batchrenorm 4 4 4
alg_a2p 3
alg_b2q 3
ifoutcore
ifdists
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNS
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
ciroots = 
maxdets = 10
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
maxidx = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 0
alg_a2p = 3
alg_b2q = 3
notrunc = 0
ifoutcore = 1
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
ifdists = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 1
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0
mpisize_debug = 1

io::create_scratch scratch=./scratch

gpu_init
rank=0 deviceCount=8
CUDA Runtime version: 11070
CUBLAS version: 111003
nccl init: rank=0 size=2
nccl init: rank=1 size=2

mem_check: ifgpu=1
rank=0 CPUmem(GB): avail=4.806e+02 total=5.034e+02
rank=1 CPUmem(GB): avail=4.806e+02 total=5.034e+02
min=4.806e+02 max=4.806e+02 diff=0.000e+00
rank=0 GPUmem(GB): avail=3.842e+01 total=3.959e+01
rank=0 GPUmem(GB): avail=3.842e+01 total=3.959e+01
min=3.842e+01 max=3.842e+01 diff=0.000e+00
rank=0 CPUmem(GB): used=1.334e+00 pageheap_free=4.594e-02 change=1.334e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=10 ifortho=1
 iroot=0 <CI[trunc]|CI>=6.112239740347e-01

ctns::init_rbases rdm_svd=1.500e+00 thresh_proj=1.000e-10

idx=1 node=(18,0) type=1 rsupport=14 15 

idx=0 node=(19,0) type=0 rsupport=15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

idx=2 node=(17,0) type=1 rsupport=13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,9,3 dimBc=3 1-popBc= dim(space,lspace,rspace)=10,9,3 dimBc=3 1-popBc=0.000e+00 SvN=5.721e-010.000e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> :  SvN=3.066e-03 S -----
5.721e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.049e-03 S -----

idx=3 node=(16,0) type=1 rsupport=
idx=4 node=(15,0) type=1 rsupport=11 12 13 14 15 
12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,7,4 dimBc=2 1-popBc=2.220e-16 SvN=2.912e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.038e-04 S -----
 dim(space,lspace,rspace)=
idx=5 node=(14,0) type=1 rsupport=10 11 12 13 14 15 
10,8,4 dimBc=3 1-popBc=0 SvN=0.495
----- TIMING FOR ctns::right_projection<Qm,Tm> : ctns::right_projection<Qm,Tm> thresh_proj=1.207e-04 S -----

idx=6 node=(13,0) type=11.000e-10 rsupport=
9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,7,6 dimBc=4 1-popBc=1.110e-16 SvN=6.924e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.949e-05 S -----

idx=7 node=(12,0) type=1 rsupport=8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=10,7,8 dimBc=6 1-popBc=0 SvN=1.06
----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.609e-05 S -----
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
idx=8 node=(11,0) type=1 rsupport=7 8 9 10 11 12 13 14 15 

ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,7,10 dimBc=7 1-popBc=0.000e+00 SvN=1.399e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.202e-04 S -----
 dim(space,lspace,rspace)=10
idx=9 node=(10,0) type=1 rsupport=6 7 8 9 10 11 12 13 14 15 
,7,9 dimBc=7 1-popBc=2.22e-16 SvN=1.25
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.289e-04 S -----
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
idx=10 node=(9,0) type=1 rsupport=5 6 7 8 9 10 11 12 13 14 15 

ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,7,10 dimBc=7 1-popBc=0.000e+00 SvN=1.399e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 5.159e-05 S -----

idx=11 node=(8,0) type=1 rsupport=19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=10,6,10 dimBc=6 1-popBc=2.22e-16 SvN=1.14
----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.930e-05 S -----
ctns::right_projection<Qm,Tm> thresh_proj=
idx=12 node=(7,0) type=1 rsupport=18 19 5 6 7 8 9 10 11 12 13 14 15 
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,6,10 dimBc=6 1-popBc=2.220e-16 SvN=1.144e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 5.035e-05 S -----

idx=13 node=(6,0) type=1 rsupport=17 18 19 5 dim(space,lspace,rspace)= 10,6 76 ,8 910 10 dimBc=6 1-popBc= 11 12 13 14 15 
2.22e-16 SvN=1.14
----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.751e-05 S -----
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

idx=14 node=(5,0) type=1 rsupport=16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,5,10 dimBc=5 1-popBc=2.220e-16 SvN=9.257e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.859e-05 S -----

idx=15 node=(4,0) type=1 rsupport=4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=10,4,10 dimBc=4 1-popBc=2.22e-16ctns::right_projection<Qm,Tm> thresh_proj= SvN=1.000e-107.216e-01

----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.230e-05 S -----

idx=16 node=(3,0) type=1 rsupport=3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=10,3,10 dimBc=3 1-popBc=0 SvN=0.454
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.197e-05 S -----
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

idx=17 node=(2,0) type=1 rsupport=2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,2,10 dimBc=2 1-popBc=0.000e+00 SvN=2.370e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.146e-05 S -----

idx=18 node=(1,0) type=1 rsupport=1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=10,1,10 dimBc=1 1-popBc=0 SvN=0
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.717e-05 S -----
ctns::right_projection<Qm,Tm> thresh_proj=
idx=19 node=(0,0) type=0 rsupport=0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,1,10 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.715e-05 S -----
 dim(space,lspace,rspace)=10,1,10 dimBc=1 1-popBc=0 SvN=0
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.479e-05 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=2 node=(17,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=3 node=(16,0) type=1 shape=4,3 1-popBc=0.000e+00
 idx=4 node=(15,0) type=1 shape=4,2 1-popBc=2.220e-16
 idx=5 node=(14,0) type=1 shape=6,4 1-popBc=1.110e-16
 idx=6 node=(13,0) type=1 shape=8,6 1-popBc=0.000e+00
 idx=7 node=(12,0) type=1 shape=9,7 1-popBc=2.220e-16
 idx=8 node=(11,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=9 node=(10,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=10 node=(9,0) type=1 shape=10,6 1-popBc=2.220e-16
 idx=11 node=(8,0) type=1 shape=10,6 1-popBc=2.220e-16
 idx=12 node=(7,0) type=1 shape=10,6 1-popBc=2.220e-16
 idx=13 node=(6,0) type=1 shape=10,5 1-popBc=2.220e-16
 idx=14 node=(5,0) type=1 shape=10,4 1-popBc=2.220e-16
 idx=15 node=(4,0) type=1 shape=10,3 1-popBc=0.000e+00
 idx=16 node=(3,0) type=1 shape=10,2 1-popBc=0.000e+00
 idx=17 node=(2,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=18 node=(1,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=19 node=(0,0) type=0 shape=10,1 1-popBc=0.000e+00
maximum bond dimension = 7
----- TIMING FOR ctns::init_rbases : 4.065e-03 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=6.558e-06 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(3,4,4) maxdiff=1.133e-16 deviate=0 TIMING=2.275e-05 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(3,3,4) maxdiff=0.000e+00 deviate=0 TIMING=5.068e-06 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(3,3,4) maxdiff=4.965e-16 deviate=0 TIMING=4.793e-06 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(2,3,4) maxdiff=2.837e-16 deviate=0 TIMING=4.097e-06 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(4,2,4) maxdiff=2.236e-16 deviate=0 TIMING=5.013e-06 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(6,4,4) maxdiff=4.974e-16 deviate=0 TIMING=6.713e-06 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(7,6,4) maxdiff=7.501e-16 deviate=0 TIMING=6.602e-06 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(7,7,4) maxdiff=3.331e-16 deviate=0 TIMING=7.650e-06 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(7,7,4) maxdiff=0.000e+00 deviate=0 TIMING=8.501e-06 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(6,7,4) maxdiff=3.331e-16 deviate=0 TIMING=1.031e-05 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(6,6,4) maxdiff=0.000e+00 deviate=0 TIMING=7.035e-06 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(6,6,4) maxdiff=0.000e+00 deviate=0 TIMING=8.309e-06 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(5,6,4) maxdiff=4.441e-16 deviate=0 TIMING=8.173e-06 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(4,5,4) maxdiff=1.110e-16 deviate=0 TIMING=7.267e-06 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(3,4,4) maxdiff=2.220e-16 deviate=0 TIMING=5.691e-06 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(2,3,4) maxdiff=2.220e-16 deviate=0 TIMING=5.450e-06 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(1,2,4) maxdiff=0.000e+00 deviate=0 TIMING=4.825e-06 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(1,1,4) maxdiff=0.000e+00 deviate=0 TIMING=4.428e-06 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,1,4) maxdiff=0.000e+00 deviate=0 TIMING=4.648e-06 S
----- TIMING FOR ctns::init_rsites : 3.066e-04 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x5585ee0e8cd8
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 0
----- TIMING FOR ctns::init_rwfuns : 5.242e-05 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=7
----- TIMING FOR ctns::rcanon_canonicalize : 1.775e-03 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=3.144e-16 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=2.640e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=9.959e-16 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.140e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=3.142e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=1.570e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=4.441e-16 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=2.220e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=16 node=(3,0) Drow=2 maxdiff=3.331e-16 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x5585ee0e86a0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x5585ee0e86a0
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 1.131e-04 S -----
----- TIMING FOR ctns::rcanon_init : 1.162e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci T(save)=0.00091S

ctns::rcanon_tosu2 twos=0 thresh_tosu2=1e-08
>>> idx=1
 qbond: ys nsym=2 dimAll=3
 (2,2):1 (3,1):2
 sigs2sum=1 diff(1-sigs2sum)=-8.9e-16
>>> idx=2
 qbond: ys nsym=2 dimAll=3
 (3,3):1 (4,2):2
 sigs2sum=1 diff(1-sigs2sum)=-8.9e-16
>>> idx=3
 qbond: ys nsym=2 dimAll=3
 (5,3):2 (6,2):1
 sigs2sum=1 diff(1-sigs2sum)=-1.3e-15
>>> idx=4
 qbond: ys nsym=1 dimAll=2
 (7,3):2
 sigs2sum=1 diff(1-sigs2sum)=-1.8e-15
>>> idx=5
 qbond: ys nsym=3 dimAll=4
 (8,2):1 (8,4):1 (9,3):2
 sigs2sum=1 diff(1-sigs2sum)=-1.6e-15
>>> idx=6
 qbond: ys nsym=3 dimAll=6
 (10,2):2 (10,4):2 (11,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2e-15
>>> idx=7
 qbond: ys nsym=3 dimAll=8
 (12,2):3 (12,4):3 (13,3):2
 sigs2sum=1 diff(1-sigs2sum)=-1.8e-15
>>> idx=8
 qbond: ys nsym=3 dimAll=9
 (14,2):4 (14,4):4 (15,3):1
 sigs2sum=1 diff(1-sigs2sum)=-1.6e-15
>>> idx=9
 qbond: ys nsym=5 dimAll=16
 (15,1):4 (15,3):6 (15,5):4 (16,2):1 (16,4):1
 sigs2sum=1 diff(1-sigs2sum)=-1.3e-15
>>> idx=10
 qbond: ys nsym=7 dimAll=19
 (16,0):3 (16,2):5 (16,4):5 (16,6):3 (17,1):1 (17,3):1 (17,5):1
 sigs2sum=1 diff(1-sigs2sum)=-1.3e-15
>>> idx=11
 qbond: ys nsym=7 dimAll=19
 (18,0):3 (18,2):5 (18,4):5 (18,6):3 (19,1):1 (19,3):1 (19,5):1
 sigs2sum=1 diff(1-sigs2sum)=-1.6e-15
>>> idx=12
 qbond: ys nsym=7 dimAll=19
 (20,0):3 (20,2):5 (20,4):5 (20,6):3 (21,1):1 (21,3):1 (21,5):1
 sigs2sum=1 diff(1-sigs2sum)=-1.6e-15
>>> idx=13
 qbond: ys nsym=7 dimAll=17
 (21,1):3 (21,3):4 (21,5):4 (21,7):3 (22,2):1 (22,4):1 (22,6):1
 sigs2sum=1 diff(1-sigs2sum)=-1.3e-15
>>> idx=14
 qbond: ys nsym=7 dimAll=15
 (22,2):3 (22,4):3 (22,6):3 (22,8):3 (23,3):1 (23,5):1 (23,7):1
 sigs2sum=1 diff(1-sigs2sum)=-1.3e-15
>>> idx=15
 qbond: ys nsym=9 dimAll=14
 (23,1):2 (23,3):2 (23,5):2 (23,7):2 (23,9):2 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 sigs2sum=1 diff(1-sigs2sum)=-8.9e-16
>>> idx=16
 qbond: ys nsym=11 dimAll=11
 (24,0):1 (24,2):1 (24,4):1 (24,6):1 (24,8):1 (24,10):1 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 sigs2sum=1 diff(1-sigs2sum)=-1.3e-15
>>> idx=17
 qbond: ys nsym=6 dimAll=6
 (26,0):1 (26,2):1 (26,4):1 (26,6):1 (26,8):1 (26,10):1
 sigs2sum=1 diff(1-sigs2sum)=-6.7e-16
>>> idx=18
 qbond: ys nsym=6 dimAll=6
 (28,0):1 (28,2):1 (28,4):1 (28,6):1 (28,8):1 (28,10):1
 sigs2sum=1 diff(1-sigs2sum)=-4.4e-16
>>> idx=19
 qbond: ys nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16

ctns::updateRWFuns twos=0

### iroot=0 ###
> j=0 sym=(30,0,0) pop[j]=0.167 target sector!
matrix: rwfunW size=(1,1)
      4.0825e-01 
> j=2 sym=(30,2,0) pop[j]=0.357
matrix: rwfunW size=(1,1)
      5.9761e-01 
> j=6 sym=(30,4,0) pop[j]=0.298
matrix: rwfunW size=(1,1)
      5.4554e-01 
> j=12 sym=(30,6,0) pop[j]=0.139
matrix: rwfunW size=(1,1)
      3.7268e-01 
> j=20 sym=(30,8,0) pop[j]=0.0357
matrix: rwfunW size=(1,1)
      1.8898e-01 
> j=30 sym=(30,10,0) pop[j]=0.00397
matrix: rwfunW size=(1,1)
      6.2994e-02 
total pop=1 diff(1-pop)=-2.220446049e-16

comb::display_shape qkind=qNSz
 idx=0 node=(19,0) shape(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(3,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(3,3,4)
 idx=3 node=(16,0) shape(l,r,c)=(3,3,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,3,4)
 idx=5 node=(14,0) shape(l,r,c)=(4,2,4)
 idx=6 node=(13,0) shape(l,r,c)=(6,4,4)
 idx=7 node=(12,0) shape(l,r,c)=(7,6,4)
 idx=8 node=(11,0) shape(l,r,c)=(7,7,4)
 idx=9 node=(10,0) shape(l,r,c)=(7,7,4)
 idx=10 node=(9,0) shape(l,r,c)=(6,7,4)
 idx=11 node=(8,0) shape(l,r,c)=(6,6,4)
 idx=12 node=(7,0) shape(l,r,c)=(6,6,4)
 idx=13 node=(6,0) shape(l,r,c)=(5,6,4)
 idx=14 node=(5,0) shape(l,r,c)=(4,5,4)
 idx=15 node=(4,0) shape(l,r,c)=(3,4,4)
 idx=16 node=(3,0) shape(l,r,c)=(2,3,4)
 idx=17 node=(2,0) shape(l,r,c)=(1,2,4)
 idx=18 node=(1,0) shape(l,r,c)=(1,1,4)
 idx=19 node=(0,0) shape(l,r,c)=(1,1,4)
qtensor2: wf2 own=1 _data=0x5585ee0dbb90
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629394531e-06MB

comb::display_shape qkind=qNS
 idx=0 node=(19,0) shape(l,r,c)=(3,1,3) shapeU1(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(7,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(10,7,4)
 idx=3 node=(16,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(11,10,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,3,3) shapeU1(l,r,c)=(8,11,4)
 idx=5 node=(14,0) shape(l,r,c)=(4,2,3) shapeU1(l,r,c)=(16,8,4)
 idx=6 node=(13,0) shape(l,r,c)=(6,4,3) shapeU1(l,r,c)=(24,16,4)
 idx=7 node=(12,0) shape(l,r,c)=(8,6,3) shapeU1(l,r,c)=(32,24,4)
 idx=8 node=(11,0) shape(l,r,c)=(9,8,3) shapeU1(l,r,c)=(36,32,4)
 idx=9 node=(10,0) shape(l,r,c)=(16,9,3) shapeU1(l,r,c)=(64,36,4)
 idx=10 node=(9,0) shape(l,r,c)=(19,16,3) shapeU1(l,r,c)=(76,64,4)
 idx=11 node=(8,0) shape(l,r,c)=(19,19,3) shapeU1(l,r,c)=(76,76,4)
 idx=12 node=(7,0) shape(l,r,c)=(19,19,3) shapeU1(l,r,c)=(76,76,4)
 idx=13 node=(6,0) shape(l,r,c)=(17,19,3) shapeU1(l,r,c)=(85,76,4)
 idx=14 node=(5,0) shape(l,r,c)=(15,17,3) shapeU1(l,r,c)=(90,85,4)
 idx=15 node=(4,0) shape(l,r,c)=(14,15,3) shapeU1(l,r,c)=(84,90,4)
 idx=16 node=(3,0) shape(l,r,c)=(11,14,3) shapeU1(l,r,c)=(66,84,4)
 idx=17 node=(2,0) shape(l,r,c)=(6,11,3) shapeU1(l,r,c)=(36,66,4)
 idx=18 node=(1,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
 idx=19 node=(0,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
qtensor2: wf2 own=1 _data=0x5585ee0dbb88
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629394531e-06MB

Summary of sweep projection: nroot[nonsu2]=1 => nstate[su2]=1
----- TIMING FOR ctns::rcanon_tosu2 : 1.347e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci_su2 T(save)=0.00082S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=2.902e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=5.103e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=7.491e-16 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.331e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=3.141e-16 deviate=0
 idx=7 node=(12,0) Drow=8 maxdiff=2.220e-16 deviate=0
 idx=8 node=(11,0) Drow=9 maxdiff=0.000e+00 deviate=0
 idx=9 node=(10,0) Drow=16 maxdiff=1.456e-15 deviate=0
 idx=10 node=(9,0) Drow=19 maxdiff=1.012e-15 deviate=0
 idx=11 node=(8,0) Drow=19 maxdiff=8.124e-16 deviate=0
 idx=12 node=(7,0) Drow=19 maxdiff=1.528e-15 deviate=0
 idx=13 node=(6,0) Drow=17 maxdiff=9.613e-16 deviate=0
 idx=14 node=(5,0) Drow=15 maxdiff=7.789e-16 deviate=0
 idx=15 node=(4,0) Drow=14 maxdiff=7.126e-16 deviate=0
 idx=16 node=(3,0) Drow=11 maxdiff=4.441e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=2.220e-16 deviate=0
 idx=18 node=(1,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=6 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x5585ee0e8e00
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x5585ee0e8e00
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 5.858e-04 S -----
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.334e+00 pageheap_free=4.497e-02 change=2.754e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:1.221e-02MB:1.192e-05GB
 size(int2e) = 305370:2.330e+00MB:2.275e-03GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 8.327e-02 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNS
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=4.266e-02 change=2.294e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_save_sites scratch=./scratch/sweep T(save)=1.75e-02S
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=7.61e-03MB:7.44e-06GB
fname=./scratch/sweep/cop(19,0) size=7.44e-06GB T[save](info/data/tot)=0.001,0.000858,0.00186 speed=0.00399GB/S disk[used]=1.93e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/rop(19,0) size=7.44e-06GB T[save](info/data/tot)=0.00094,0.000785,0.00173 speed=0.00431GB/S disk[used]=2.7e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(18,0) size=7.44e-06GB T[save](info/data/tot)=0.000918,0.000755,0.00167 speed=0.00444GB/S disk[used]=3.47e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(17,0) size=7.44e-06GB T[save](info/data/tot)=0.000918,0.000793,0.00171 speed=0.00435GB/S disk[used]=4.24e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(16,0) size=7.44e-06GB T[save](info/data/tot)=0.000904,0.000766,0.00167 speed=0.00445GB/S disk[used]=5.01e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(15,0) size=7.44e-06GB T[save](info/data/tot)=0.000843,0.000748,0.00159 speed=0.00467GB/S disk[used]=5.78e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(14,0) size=7.44e-06GB T[save](info/data/tot)=0.000872,0.00071,0.00158 speed=0.0047GB/S disk[used]=6.55e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(13,0) size=7.44e-06GB T[save](info/data/tot)=0.00081,0.000735,0.00155 speed=0.00481GB/S disk[used]=7.32e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(12,0) size=7.44e-06GB T[save](info/data/tot)=0.000802,0.000743,0.00155 speed=0.00481GB/S disk[used]=8.09e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(11,0) size=7.44e-06GB T[save](info/data/tot)=0.000872,0.000702,0.00157 speed=0.00472GB/S disk[used]=8.86e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(10,0) size=7.44e-06GB T[save](info/data/tot)=0.00086,0.000738,0.0016 speed=0.00465GB/S disk[used]=9.63e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(9,0) size=7.44e-06GB T[save](info/data/tot)=0.000821,0.000711,0.00153 speed=0.00485GB/S disk[used]=0.000104GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(8,0) size=7.44e-06GB T[save](info/data/tot)=0.000821,0.000716,0.00154 speed=0.00484GB/S disk[used]=0.000112GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(7,0) size=7.44e-06GB T[save](info/data/tot)=0.000809,0.000717,0.00153 speed=0.00487GB/S disk[used]=0.000119GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(6,0) size=7.44e-06GB T[save](info/data/tot)=0.000826,0.000694,0.00152 speed=0.00489GB/S disk[used]=0.000127GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(5,0) size=7.44e-06GB T[save](info/data/tot)=0.000783,0.000738,0.00152 speed=0.00489GB/S disk[used]=0.000135GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(4,0) size=7.44e-06GB T[save](info/data/tot)=0.000815,0.00069,0.0015 speed=0.00494GB/S disk[used]=0.000142GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(3,0) size=7.44e-06GB T[save](info/data/tot)=0.000789,0.000704,0.00149 speed=0.00498GB/S disk[used]=0.00015GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(2,0) size=7.44e-06GB T[save](info/data/tot)=0.000794,0.000712,0.00151 speed=0.00494GB/S disk[used]=0.000158GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(1,0) size=7.44e-06GB T[save](info/data/tot)=0.00077,0.000693,0.00146 speed=0.00508GB/S disk[used]=0.000166GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(0,0) size=7.44e-06GB T[save](info/data/tot)=0.000792,0.000671,0.00146 speed=0.00508GB/S disk[used]=0.000173GB
----- TIMING FOR ctns::oper_init_dotCR : 1.135e-01 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.0309,0.0761,0.107

idx=1 coord=(18,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=5.417e-04 change=-1.782e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=1 scratch=./scratch/sweep size=5:3.73e-08GB T(load)=3.82e-04S speed=9.75e-05GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=47:0.000359MB:3.5e-07GB
        per(mem): C:8.51 S:38.3 H:10.6 A:0 B:42.6 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.605e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=8 : 5.329e-05 S -----
rank=0 GPUmem(GB): used=1.522e-05 (oper)=1.522e-05
rank=0 GPUmem(GB): used=1.526e-05 (oper,site)=1.522e-05,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=8
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.526e-05 (oper,site,rinter)=1.522e-05,3.725e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 9.683e-05 S size(rtasks)=8 size(Rlst2)=4 T(Rmu/Rlist)=1.465e-05,8.212e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.188e-04 S size(rtasks)=8 size(Rlst)=23 -----
rank=0 GPUmem(GB): used=1.526e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.542e-06 blksize=4 blksize0=0 batchsize=23
rank=0 GPUmem(GB): used=1.680e-05 (oper,site,rinter,batch)=1.522e-05,3.725e-08,0.000e+00,1.542e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.940e-05,5.595e-04,1.357e-04
----- TIMING FOR renorm : t_inter=1.9e-05 t_gemm=5.6e-04 t_reduction=1.4e-04 tot=7.1e-04 -----
 renorm[inter] counter=1 t=1.9e-05 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=5.6e-06 per=7.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=2.4e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=3.8e-04 per=5.3e+01 cost=2.2e+01 flops=5.8e+04
 renorm[gemm] counter=1 i=3 t=8.3e-05 per=1.2e+01 cost=3.2e+01 flops=3.9e+05
 renorm[gemm] counter=1 i=4 t=2.4e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=8.5e-05 per=1.2e+01 cost=1.4e+02 flops=1.6e+06
 renorm[gemm] counter=1 total t=5.6e-04 per=7.8e+01 cost=1.9e+02 flops=3.5e+05
 renorm[red] counter=1 t=1.4e-04 per=1.9e+01 cost=1.4e+02 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=1.9e-05 t_gemm=5.6e-04 t_reduction=1.4e-04 tot=7.1e-04 -----
 renorm_tot[inter] counter=1 t=1.9e-05 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=5.6e-06 per=7.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=2.4e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=3.8e-04 per=5.3e+01 cost=2.2e+01 flops=5.8e+04
 renorm_tot[gemm] counter=1 i=3 t=8.3e-05 per=1.2e+01 cost=3.2e+01 flops=3.9e+05
 renorm_tot[gemm] counter=1 i=4 t=2.4e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=8.5e-05 per=1.2e+01 cost=1.4e+02 flops=1.6e+06
 renorm_tot[gemm] counter=1 total t=5.6e-04 per=7.8e+01 cost=1.9e+02 flops=3.5e+05
 renorm_tot[red] counter=1 t=1.4e-04 per=1.9e+01 cost=1.4e+02 flops=1.0e+06
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.524e-05 (oper)=1.524e-05
rank=0 GPUmem(GB): used=1.527e-05 (oper,site,rinter)=1.524e-05,3.725e-08,0.000e+00
rank=0 GPUmem(GB): used=1.550e-05 (oper,site,rinter,batch)=1.524e-05,3.725e-08,0.000e+00,2.235e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.542e-03 S T(preprocess/alloc/comp/red/dealloc)=6.321e-04,7.192e-04,3.250e-03,5.012e-04,2.672e-05 -----
----- TIMING FOR oper_renorm_opS : 4.576e-03 S rank=0 -----
qops.to_cpu: size(tot)=47:3.586e-04MB:3.502e-07GB T(to_cpu)=2.961e-05S speed=1.183e-02GB/S
check ||H-H.dagger||=5.201e-16 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.00657 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=7.489e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=2.060e-04 change=-1.599e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.594e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.376e-02 S #####
 T(local oper_env: fetch) = 4.708e-03 S  per = 34.2  per(accum) = 34.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(local oper_env: renrm) = 7.631e-03 S  per = 55.5  per(accum) = 89.7
 T(local oper_env: save ) = 1.417e-03 S  per = 10.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.631e-03 S  T(sum) = 7.631e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 5.710e-05 S  per = 0.748  per(accum) = 0.748
 T(local oper_env: qops init                    ) = 3.408e-04 S  per = 4.47  per(accum) = 5.21
 T(local oper_env: symbolic_formulae_renorm     ) = 7.172e-05 S  per = 0.94  per(accum) = 6.15
 T(local oper_env: allocate qops on gpu         ) = 8.513e-05 S  per = 1.12  per(accum) = 7.27
 T(local oper_env: site memcpy cpu2gpu          ) = 4.300e-05 S  per = 0.564  per(accum) = 7.83
 T(local oper_env: rintermediate init           ) = 4.956e-05 S  per = 0.649  per(accum) = 8.48
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.370e-04 S  per =  1.8  per(accum) = 10.3
 T(local oper_env: rmmtasks init                ) = 1.162e-04 S  per = 1.52  per(accum) = 11.8
 T(local oper_env: qops memset on cpu           ) = 6.500e-08 S  per = 0.000852  per(accum) = 11.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 9.818e-04 S  per = 12.9  per(accum) = 24.7
 T(local oper_env: deallocate cpu and gpu memory) = 3.224e-05 S  per = 0.423  per(accum) = 25.1
 T(local oper_env: construct opS [ifdists=true] ) = 4.600e-03 S  per = 60.3  per(accum) = 85.4
 T(local oper_env: reduction of opS & opH [nccl]) = 1.978e-05 S  per = 0.259  per(accum) = 85.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.332e-05 S  per = 0.568  per(accum) = 86.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 5.189e-05 S  per = 0.68  per(accum) = 86.9
 T(local oper_env: qops_pool join and erase     ) = 1.001e-03 S  per = 13.1  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.520e-07 S  per = 0.00985  per(accum) = 100
##### sweep oper_env: 1.376e-02 S #####
 T(sweep oper_env: fetch) = 4.708e-03 S  per = 34.2  per(accum) = 34.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.2
 T(sweep oper_env: renrm) = 7.631e-03 S  per = 55.5  per(accum) = 89.7
 T(sweep oper_env: save ) = 1.417e-03 S  per = 10.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(sweep oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.631e-03 S  T(sum) = 7.631e-03 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 5.710e-05 S  per = 0.748  per(accum) = 0.748
 T(sweep oper_env: qops init                    ) = 3.408e-04 S  per = 4.47  per(accum) = 5.21
 T(sweep oper_env: symbolic_formulae_renorm     ) = 7.172e-05 S  per = 0.94  per(accum) = 6.15
 T(sweep oper_env: allocate qops on gpu         ) = 8.513e-05 S  per = 1.12  per(accum) = 7.27
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.300e-05 S  per = 0.564  per(accum) = 7.83
 T(sweep oper_env: rintermediate init           ) = 4.956e-05 S  per = 0.649  per(accum) = 8.48
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.370e-04 S  per =  1.8  per(accum) = 10.3
 T(sweep oper_env: rmmtasks init                ) = 1.162e-04 S  per = 1.52  per(accum) = 11.8
 T(sweep oper_env: qops memset on cpu           ) = 6.500e-08 S  per = 0.000852  per(accum) = 11.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 9.818e-04 S  per = 12.9  per(accum) = 24.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.224e-05 S  per = 0.423  per(accum) = 25.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.600e-03 S  per = 60.3  per(accum) = 85.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.978e-05 S  per = 0.259  per(accum) = 85.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.332e-05 S  per = 0.568  per(accum) = 86.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 5.189e-05 S  per = 0.68  per(accum) = 86.9
 T(sweep oper_env: qops_pool join and erase     ) = 1.001e-03 S  per = 13.1  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 7.520e-07 S  per = 0.00985  per(accum) = 100

idx=2 coord=(17,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=2 scratch=./scratch/sweep size=7:5.22e-08GB T(load)=3.24e-04S speed=1.61e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=47:0.000359MB:3.5e-07GB
        per(mem): C:8.51 S:38.3 H:10.6 A:0 B:42.6 
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:3 S:8 H:1 A:4 B:7 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=62:0.000473MB:4.62e-07GB
        per(mem): C:9.68 S:25.8 H:8.06 A:0 B:56.5 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.135e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=15 : 3.550e-05 S -----
rank=0 GPUmem(GB): used=8.248e-06 (oper)=8.248e-06
rank=0 GPUmem(GB): used=8.300e-06 (oper,site)=8.248e-06,5.215e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=15
 no. of rintermediate operators=4
 no. of coefficients=8:6.104e-05MB:5.960e-08GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.124e-05 S -----
rank=0 GPUmem(GB): used=8.360e-06 (oper,site,rinter)=8.248e-06,5.215e-08,5.960e-08
----- TIMING FOR preprocess_formulae_Rlist2 : 9.584e-05 S size(rtasks)=15 size(Rlst2)=4 T(Rmu/Rlist)=1.511e-05,8.068e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.102e-04 S size(rtasks)=15 size(Rlst)=56 -----
rank=0 GPUmem(GB): used=8.360e-06 avail=3.829e+01 total=3.829e+01 batch[need]=5.424e-06 blksize=4 blksize0=4 batchsize=56
rank=0 GPUmem(GB): used=1.378e-05 (oper,site,rinter,batch)=8.248e-06,5.215e-08,5.960e-08,5.424e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.001e-04,3.259e-04,9.288e-05
----- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=3.3e-04 t_reduction=9.3e-05 tot=5.2e-04 -----
 renorm[inter] counter=18 t=1.0e-04 per=1.9e+01 cost=1.8e+02 flops=1.8e+06
 renorm[gemm] counter=18 i=0 t=2.6e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=2.0e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=1.0e-04 per=2.0e+01 cost=1.3e+02 flops=1.3e+06
 renorm[gemm] counter=18 i=3 t=1.4e-04 per=2.7e+01 cost=2.1e+02 flops=1.6e+06
 renorm[gemm] counter=18 i=4 t=2.1e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=2.0e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=7.5e-05 per=1.4e+01 cost=4.9e+02 flops=6.6e+06
 renorm[gemm] counter=18 total t=3.3e-04 per=6.3e+01 cost=8.4e+02 flops=2.6e+06
 renorm[red] counter=18 t=9.3e-05 per=1.8e+01 cost=3.3e+02 flops=3.6e+06
----- TIMING FOR renorm_tot : t_inter=1.2e-04 t_gemm=8.8e-04 t_reduction=2.3e-04 tot=1.2e-03 -----
 renorm_tot[inter] counter=18 t=1.2e-04 per=9.7e+00 cost=1.8e+02 flops=1.5e+06
 renorm_tot[gemm] counter=18 i=0 t=8.2e-06 per=6.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=4.4e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=4.8e-04 per=3.9e+01 cost=1.6e+02 flops=3.2e+05
 renorm_tot[gemm] counter=18 i=3 t=2.2e-04 per=1.8e+01 cost=2.5e+02 flops=1.1e+06
 renorm_tot[gemm] counter=18 i=4 t=4.5e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=5 t=4.2e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=6 t=1.6e-04 per=1.3e+01 cost=6.3e+02 flops=4.0e+06
 renorm_tot[gemm] counter=18 total t=8.8e-04 per=7.2e+01 cost=1.0e+03 flops=1.2e+06
 renorm_tot[red] counter=18 t=2.3e-04 per=1.9e+01 cost=4.7e+02 flops=2.1e+06
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.693e-06 (oper)=8.263e-06
rank=0 GPUmem(GB): used=9.745e-06 (oper,site,rinter)=8.263e-06,5.215e-08,1.371e-06
rank=0 GPUmem(GB): used=1.040e-05 (oper,site,rinter,batch)=8.263e-06,5.215e-08,1.371e-06,6.557e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.387e-03 S T(preprocess/alloc/comp/red/dealloc)=8.467e-04,9.152e-04,3.996e-03,3.320e-04,1.123e-04 -----
----- TIMING FOR oper_renorm_opS : 5.414e-03 S rank=0 -----
qops.to_cpu: size(tot)=62:4.730e-04MB:4.619e-07GB T(to_cpu)=2.184e-05S speed=2.115e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.00691 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=7.629e-06 change=2.493e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=7.629e-06 change=-8.329e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.296e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.082e-02 S #####
 T(local oper_env: fetch) = 2.040e-03 S  per = 18.9  per(accum) = 18.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: renrm) = 7.437e-03 S  per = 68.8  per(accum) = 87.6
 T(local oper_env: save ) = 1.339e-03 S  per = 12.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.437e-03 S  T(sum) = 7.437e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.237e-05 S  per = 0.166  per(accum) = 0.166
 T(local oper_env: qops init                    ) = 2.463e-04 S  per = 3.31  per(accum) = 3.48
 T(local oper_env: symbolic_formulae_renorm     ) = 4.716e-05 S  per = 0.634  per(accum) = 4.11
 T(local oper_env: allocate qops on gpu         ) = 5.744e-05 S  per = 0.772  per(accum) = 4.88
 T(local oper_env: site memcpy cpu2gpu          ) = 2.386e-05 S  per = 0.321  per(accum) = 5.21
 T(local oper_env: rintermediate init           ) = 6.021e-05 S  per = 0.81  per(accum) = 6.01
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.155e-04 S  per = 1.55  per(accum) = 7.57
 T(local oper_env: rmmtasks init                ) = 9.986e-05 S  per = 1.34  per(accum) = 8.91
 T(local oper_env: qops memset on cpu           ) = 3.600e-08 S  per = 0.000484  per(accum) = 8.91
 T(local oper_env: preprocess_renorm_batchGPU   ) = 7.013e-04 S  per = 9.43  per(accum) = 18.3
 T(local oper_env: deallocate cpu and gpu memory) = 2.410e-05 S  per = 0.324  per(accum) = 18.7
 T(local oper_env: construct opS [ifdists=true] ) = 5.472e-03 S  per = 73.6  per(accum) = 92.2
 T(local oper_env: reduction of opS & opH [nccl]) = 1.910e-05 S  per = 0.257  per(accum) = 92.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.226e-05 S  per = 0.434  per(accum) = 92.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 9.403e-06 S  per = 0.126  per(accum) = 93.1
 T(local oper_env: qops_pool join and erase     ) = 5.154e-04 S  per = 6.93  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.620e-07 S  per = 0.00621  per(accum) = 100
##### sweep oper_env: 2.457e-02 S #####
 T(sweep oper_env: fetch) = 6.748e-03 S  per = 27.5  per(accum) = 27.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 27.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 27.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 27.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 27.5
 T(sweep oper_env: renrm) = 1.507e-02 S  per = 61.3  per(accum) = 88.8
 T(sweep oper_env: save ) = 2.756e-03 S  per = 11.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.471e+09 S  per = -3.471e+31
 T(sweep oper_env: preprocess                  ) = -3.471e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.507e-02 S  T(sum) = 1.507e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.947e-05 S  per = 0.461  per(accum) = 0.461
 T(sweep oper_env: qops init                    ) = 5.870e-04 S  per =  3.9  per(accum) = 4.36
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.189e-04 S  per = 0.789  per(accum) = 5.15
 T(sweep oper_env: allocate qops on gpu         ) = 1.426e-04 S  per = 0.946  per(accum) = 6.09
 T(sweep oper_env: site memcpy cpu2gpu          ) = 6.686e-05 S  per = 0.444  per(accum) = 6.54
 T(sweep oper_env: rintermediate init           ) = 1.098e-04 S  per = 0.728  per(accum) = 7.26
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.525e-04 S  per = 1.68  per(accum) = 8.94
 T(sweep oper_env: rmmtasks init                ) = 2.161e-04 S  per = 1.43  per(accum) = 10.4
 T(sweep oper_env: qops memset on cpu           ) = 1.010e-07 S  per = 0.00067  per(accum) = 10.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.683e-03 S  per = 11.2  per(accum) = 21.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.635e-05 S  per = 0.374  per(accum) = 21.9
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.007e-02 S  per = 66.8  per(accum) = 88.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.888e-05 S  per = 0.258  per(accum) = 89
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.558e-05 S  per = 0.502  per(accum) = 89.5
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 6.129e-05 S  per = 0.407  per(accum) = 89.9
 T(sweep oper_env: qops_pool join and erase     ) = 1.516e-03 S  per = 10.1  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.214e-06 S  per = 0.00806  per(accum) = 100

idx=3 coord=(16,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=3 scratch=./scratch/sweep size=8:5.96e-08GB T(load)=2.80e-04S speed=2.13e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:3 S:8 H:1 A:4 B:7 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=62:0.000473MB:4.62e-07GB
        per(mem): C:9.68 S:25.8 H:8.06 A:0 B:56.5 
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=79:0.000603MB:5.89e-07GB
        per(mem): C:10.1 S:20.3 H:6.33 A:0 B:63.3 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.185e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=23 : 2.890e-05 S -----
rank=0 GPUmem(GB): used=8.486e-06 (oper)=8.486e-06
rank=0 GPUmem(GB): used=8.546e-06 (oper,site)=8.486e-06,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=23
 no. of rintermediate operators=5
 no. of coefficients=17:1.297e-04MB:1.267e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.011e-05 S -----
rank=0 GPUmem(GB): used=8.672e-06 (oper,site,rinter)=8.486e-06,5.960e-08,1.267e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 8.837e-05 S size(rtasks)=23 size(Rlst2)=4 T(Rmu/Rlist)=1.529e-05,7.304e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.012e-04 S size(rtasks)=23 size(Rlst)=60 -----
rank=0 GPUmem(GB): used=8.672e-06 avail=3.829e+01 total=3.829e+01 batch[need]=5.811e-06 blksize=4 blksize0=4 batchsize=60
rank=0 GPUmem(GB): used=1.448e-05 (oper,site,rinter,batch)=8.486e-06,5.960e-08,1.267e-07,5.811e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.692e-05,2.099e-04,7.474e-05
----- TIMING FOR renorm : t_inter=7.7e-05 t_gemm=2.1e-04 t_reduction=7.5e-05 tot=3.6e-04 -----
 renorm[inter] counter=36 t=7.7e-05 per=2.1e+01 cost=3.8e+02 flops=5.0e+06
 renorm[gemm] counter=36 i=0 t=2.0e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=1 t=1.7e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=2 t=7.5e-05 per=2.1e+01 cost=1.5e+02 flops=2.0e+06
 renorm[gemm] counter=36 i=3 t=6.6e-05 per=1.8e+01 cost=3.5e+02 flops=5.3e+06
 renorm[gemm] counter=36 i=4 t=1.8e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=5 t=1.7e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=6 t=6.1e-05 per=1.7e+01 cost=6.0e+02 flops=9.7e+06
 renorm[gemm] counter=36 total t=2.1e-04 per=5.8e+01 cost=1.1e+03 flops=5.2e+06
 renorm[red] counter=36 t=7.5e-05 per=2.1e+01 cost=3.7e+02 flops=5.0e+06
----- TIMING FOR renorm_tot : t_inter=2.0e-04 t_gemm=1.1e-03 t_reduction=3.0e-04 tot=1.6e-03 -----
 renorm_tot[inter] counter=36 t=2.0e-04 per=1.2e+01 cost=5.6e+02 flops=2.9e+06
 renorm_tot[gemm] counter=36 i=0 t=1.0e-05 per=6.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=1 t=6.1e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=2 t=5.6e-04 per=3.5e+01 cost=3.0e+02 flops=5.5e+05
 renorm_tot[gemm] counter=36 i=3 t=2.9e-04 per=1.8e+01 cost=6.0e+02 flops=2.1e+06
 renorm_tot[gemm] counter=36 i=4 t=6.3e-06 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=5 t=6.0e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=6 t=2.2e-04 per=1.4e+01 cost=1.2e+03 flops=5.6e+06
 renorm_tot[gemm] counter=36 total t=1.1e-03 per=6.9e+01 cost=2.1e+03 flops=2.0e+06
 renorm_tot[red] counter=36 t=3.0e-04 per=1.9e+01 cost=8.5e+02 flops=2.8e+06
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.119e-05 (oper)=8.501e-06
rank=0 GPUmem(GB): used=1.125e-05 (oper,site,rinter)=8.501e-06,5.960e-08,2.563e-06
rank=0 GPUmem(GB): used=1.172e-05 (oper,site,rinter,batch)=8.501e-06,5.960e-08,2.563e-06,4.694e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.824e-03 S T(preprocess/alloc/comp/red/dealloc)=6.170e-04,6.672e-04,3.716e-03,3.019e-04,1.122e-04 -----
----- TIMING FOR oper_renorm_opS : 4.850e-03 S rank=0 -----
qops.to_cpu: size(tot)=79:6.027e-04MB:5.886e-07GB T(to_cpu)=2.256e-05S speed=2.609e-02GB/S
check ||H-H.dagger||=1.021e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.00603 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=3.080e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-8.425e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.296e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 9.497e-03 S #####
 T(local oper_env: fetch) = 1.703e-03 S  per = 17.9  per(accum) = 17.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: renrm) = 6.541e-03 S  per = 68.9  per(accum) = 86.8
 T(local oper_env: save ) = 1.254e-03 S  per = 13.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.541e-03 S  T(sum) = 6.541e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.359e-05 S  per = 0.208  per(accum) = 0.208
 T(local oper_env: qops init                    ) = 2.045e-04 S  per = 3.13  per(accum) = 3.33
 T(local oper_env: symbolic_formulae_renorm     ) = 3.895e-05 S  per = 0.595  per(accum) = 3.93
 T(local oper_env: allocate qops on gpu         ) = 4.618e-05 S  per = 0.706  per(accum) = 4.64
 T(local oper_env: site memcpy cpu2gpu          ) = 2.175e-05 S  per = 0.333  per(accum) = 4.97
 T(local oper_env: rintermediate init           ) = 4.334e-05 S  per = 0.663  per(accum) = 5.63
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.057e-04 S  per = 1.62  per(accum) = 7.25
 T(local oper_env: rmmtasks init                ) = 7.013e-05 S  per = 1.07  per(accum) = 8.32
 T(local oper_env: qops memset on cpu           ) = 3.700e-08 S  per = 0.000566  per(accum) = 8.32
 T(local oper_env: preprocess_renorm_batchGPU   ) = 5.011e-04 S  per = 7.66  per(accum) = 16
 T(local oper_env: deallocate cpu and gpu memory) = 2.047e-05 S  per = 0.313  per(accum) = 16.3
 T(local oper_env: construct opS [ifdists=true] ) = 4.908e-03 S  per =   75  per(accum) = 91.3
 T(local oper_env: reduction of opS & opH [nccl]) = 1.971e-05 S  per = 0.301  per(accum) = 91.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.215e-05 S  per = 0.492  per(accum) = 92.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.425e-05 S  per = 0.218  per(accum) = 92.3
 T(local oper_env: qops_pool join and erase     ) = 5.004e-04 S  per = 7.65  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.210e-07 S  per = 0.00797  per(accum) = 100
##### sweep oper_env: 3.407e-02 S #####
 T(sweep oper_env: fetch) = 8.451e-03 S  per = 24.8  per(accum) = 24.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 24.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 24.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 24.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 24.8
 T(sweep oper_env: renrm) = 2.161e-02 S  per = 63.4  per(accum) = 88.2
 T(sweep oper_env: save ) = 4.010e-03 S  per = 11.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.207e+09 S  per = -5.207e+31
 T(sweep oper_env: preprocess                  ) = -5.207e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.161e-02 S  T(sum) = 2.161e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 8.306e-05 S  per = 0.384  per(accum) = 0.384
 T(sweep oper_env: qops init                    ) = 7.916e-04 S  per = 3.66  per(accum) = 4.05
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.578e-04 S  per = 0.73  per(accum) = 4.78
 T(sweep oper_env: allocate qops on gpu         ) = 1.888e-04 S  per = 0.873  per(accum) = 5.65
 T(sweep oper_env: site memcpy cpu2gpu          ) = 8.861e-05 S  per = 0.41  per(accum) = 6.06
 T(sweep oper_env: rintermediate init           ) = 1.531e-04 S  per = 0.709  per(accum) = 6.77
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.581e-04 S  per = 1.66  per(accum) = 8.43
 T(sweep oper_env: rmmtasks init                ) = 2.862e-04 S  per = 1.32  per(accum) = 9.75
 T(sweep oper_env: qops memset on cpu           ) = 1.380e-07 S  per = 0.000639  per(accum) = 9.75
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.184e-03 S  per = 10.1  per(accum) = 19.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.681e-05 S  per = 0.355  per(accum) = 20.2
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.498e-02 S  per = 69.3  per(accum) = 89.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.858e-05 S  per = 0.271  per(accum) = 89.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.077e-04 S  per = 0.499  per(accum) = 90.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 7.554e-05 S  per = 0.35  per(accum) = 90.7
 T(sweep oper_env: qops_pool join and erase     ) = 2.017e-03 S  per = 9.33  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.735e-06 S  per = 0.00803  per(accum) = 100

idx=4 coord=(15,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=4 scratch=./scratch/sweep size=6:4.47e-08GB T(load)=2.95e-04S speed=1.52e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=79:0.000603MB:5.89e-07GB
        per(mem): C:10.1 S:20.3 H:6.33 A:0 B:63.3 
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:5 S:7 H:1 A:12 B:16 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=68:0.000519MB:5.07e-07GB
        per(mem): C:0 S:0 H:5.88 A:0 B:94.1 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.153e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=34 : 3.403e-05 S -----
rank=0 GPUmem(GB): used=8.531e-06 (oper)=8.531e-06
rank=0 GPUmem(GB): used=8.576e-06 (oper,site)=8.531e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=34
 no. of rintermediate operators=5
 no. of coefficients=25:1.907e-04MB:1.863e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.755e-05 S -----
rank=0 GPUmem(GB): used=8.762e-06 (oper,site,rinter)=8.531e-06,4.470e-08,1.863e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 7.563e-05 S size(rtasks)=34 size(Rlst2)=1 T(Rmu/Rlist)=1.875e-05,5.684e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.680e-05 S size(rtasks)=34 size(Rlst)=53 -----
rank=0 GPUmem(GB): used=8.762e-06 avail=3.829e+01 total=3.829e+01 batch[need]=5.133e-06 blksize=4 blksize0=4 batchsize=53
rank=0 GPUmem(GB): used=1.390e-05 (oper,site,rinter,batch)=8.531e-06,4.470e-08,1.863e-07,5.133e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.909e-05,1.832e-04,5.424e-05
----- TIMING FOR renorm : t_inter=6.9e-05 t_gemm=1.8e-04 t_reduction=5.4e-05 tot=3.1e-04 -----
 renorm[inter] counter=53 t=6.9e-05 per=2.3e+01 cost=2.4e+02 flops=3.5e+06
 renorm[gemm] counter=53 i=0 t=2.0e-06 per=6.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=1 t=1.7e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=2 t=6.1e-05 per=2.0e+01 cost=1.2e+02 flops=2.0e+06
 renorm[gemm] counter=53 i=3 t=6.4e-05 per=2.1e+01 cost=2.9e+02 flops=4.6e+06
 renorm[gemm] counter=53 i=4 t=1.7e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=5 t=1.7e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=6 t=5.1e-05 per=1.7e+01 cost=6.3e+02 flops=1.2e+07
 renorm[gemm] counter=53 total t=1.8e-04 per=6.0e+01 cost=1.0e+03 flops=5.7e+06
 renorm[red] counter=53 t=5.4e-05 per=1.8e+01 cost=4.2e+02 flops=7.8e+06
----- TIMING FOR renorm_tot : t_inter=2.7e-04 t_gemm=1.3e-03 t_reduction=3.6e-04 tot=1.9e-03 -----
 renorm_tot[inter] counter=53 t=2.7e-04 per=1.4e+01 cost=8.0e+02 flops=3.0e+06
 renorm_tot[gemm] counter=53 i=0 t=1.2e-05 per=6.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=1 t=7.8e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=2 t=6.2e-04 per=3.2e+01 cost=4.3e+02 flops=6.9e+05
 renorm_tot[gemm] counter=53 i=3 t=3.5e-04 per=1.8e+01 cost=8.9e+02 flops=2.5e+06
 renorm_tot[gemm] counter=53 i=4 t=8.0e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=5 t=7.7e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=6 t=2.7e-04 per=1.4e+01 cost=1.9e+03 flops=6.8e+06
 renorm_tot[gemm] counter=53 total t=1.3e-03 per=6.7e+01 cost=3.2e+03 flops=2.5e+06
 renorm_tot[red] counter=53 t=3.6e-04 per=1.9e+01 cost=1.3e+03 flops=3.6e+06
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 3.9e-04 S rank=0 -----
qops.to_cpu: size(tot)=68:5.2e-04MB:5.1e-07GB T(to_cpu)=2.3e-05S speed=2.2e-02GB/S
check ||H-H.dagger||=2.355e-16 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.00147 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=3.245e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-8.496e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-7.004e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 4.954e-03 S #####
 T(local oper_env: fetch) = 1.714e-03 S  per = 34.6  per(accum) = 34.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.6
 T(local oper_env: renrm) = 1.960e-03 S  per = 39.6  per(accum) = 74.2
 T(local oper_env: save ) = 1.279e-03 S  per = 25.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.960e-03 S  T(sum) = 1.960e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.569e-06 S  per = 0.488  per(accum) = 0.488
 T(local oper_env: qops init                    ) = 1.997e-04 S  per = 10.2  per(accum) = 10.7
 T(local oper_env: symbolic_formulae_renorm     ) = 4.325e-05 S  per = 2.21  per(accum) = 12.9
 T(local oper_env: allocate qops on gpu         ) = 4.283e-05 S  per = 2.18  per(accum) = 15.1
 T(local oper_env: site memcpy cpu2gpu          ) = 3.236e-05 S  per = 1.65  per(accum) = 16.7
 T(local oper_env: rintermediate init           ) = 4.265e-05 S  per = 2.18  per(accum) = 18.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 9.153e-05 S  per = 4.67  per(accum) = 23.6
 T(local oper_env: rmmtasks init                ) = 5.807e-05 S  per = 2.96  per(accum) = 26.5
 T(local oper_env: qops memset on cpu           ) = 4.000e-08 S  per = 0.00204  per(accum) = 26.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.616e-04 S  per = 23.5  per(accum) = 50.1
 T(local oper_env: deallocate cpu and gpu memory) = 1.833e-05 S  per = 0.935  per(accum) = 51
 T(local oper_env: construct opS [ifdists=true] ) = 4.104e-04 S  per = 20.9  per(accum) = 71.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.573e-05 S  per = 1.31  per(accum) = 73.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.318e-05 S  per = 1.69  per(accum) = 74.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 7.769e-06 S  per = 0.396  per(accum) = 75.3
 T(local oper_env: qops_pool join and erase     ) = 4.830e-04 S  per = 24.6  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.780e-07 S  per = 0.0244  per(accum) = 100
##### sweep oper_env: 3.902e-02 S #####
 T(sweep oper_env: fetch) = 1.016e-02 S  per =   26  per(accum) = 26
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: renrm) = 2.357e-02 S  per = 60.4  per(accum) = 86.4
 T(sweep oper_env: save ) = 5.289e-03 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.943e+09 S  per = -6.943e+31
 T(sweep oper_env: preprocess                  ) = -6.943e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.357e-02 S  T(sum) = 2.357e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.263e-05 S  per = 0.393  per(accum) = 0.393
 T(sweep oper_env: qops init                    ) = 9.913e-04 S  per = 4.21  per(accum) = 4.6
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.011e-04 S  per = 0.853  per(accum) = 5.45
 T(sweep oper_env: allocate qops on gpu         ) = 2.316e-04 S  per = 0.983  per(accum) = 6.43
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.210e-04 S  per = 0.513  per(accum) = 6.95
 T(sweep oper_env: rintermediate init           ) = 1.958e-04 S  per = 0.831  per(accum) = 7.78
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.497e-04 S  per = 1.91  per(accum) = 9.69
 T(sweep oper_env: rmmtasks init                ) = 3.443e-04 S  per = 1.46  per(accum) = 11.1
 T(sweep oper_env: qops memset on cpu           ) = 1.780e-07 S  per = 0.000755  per(accum) = 11.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.646e-03 S  per = 11.2  per(accum) = 22.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.514e-05 S  per = 0.404  per(accum) = 22.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.539e-02 S  per = 65.3  per(accum) = 88.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.432e-05 S  per = 0.358  per(accum) = 88.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.409e-04 S  per = 0.598  per(accum) = 89
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 8.330e-05 S  per = 0.353  per(accum) = 89.4
 T(sweep oper_env: qops_pool join and erase     ) = 2.500e-03 S  per = 10.6  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.213e-06 S  per = 0.00939  per(accum) = 100

idx=5 coord=(14,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=5 scratch=./scratch/sweep size=8:5.96e-08GB T(load)=2.85e-04S speed=2.09e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:5 S:7 H:1 A:12 B:16 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=68:0.000519MB:5.07e-07GB
        per(mem): C:0 S:0 H:5.88 A:0 B:94.1 
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:6 S:7 H:1 A:17 B:22 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=212:0.00162MB:1.58e-06GB
        per(mem): C:11.3 S:13.2 H:2.83 A:0 B:72.6 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.524e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=46 : 3.966e-05 S -----
rank=0 GPUmem(GB): used=9.522e-06 (oper)=9.522e-06
rank=0 GPUmem(GB): used=9.581e-06 (oper,site)=9.522e-06,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=46
 no. of rintermediate operators=5
 no. of coefficients=39:2.975e-04MB:2.906e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.961e-05 S -----
rank=0 GPUmem(GB): used=9.872e-06 (oper,site,rinter)=9.522e-06,5.960e-08,2.906e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.215e-04 S size(rtasks)=46 size(Rlst2)=9 T(Rmu/Rlist)=2.341e-05,9.801e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.346e-04 S size(rtasks)=46 size(Rlst)=98 -----
rank=0 GPUmem(GB): used=9.872e-06 avail=3.829e+01 total=3.829e+01 batch[need]=9.492e-06 blksize=4 blksize0=4 batchsize=98
rank=0 GPUmem(GB): used=1.936e-05 (oper,site,rinter,batch)=9.522e-06,5.960e-08,2.906e-07,9.492e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.682e-05,1.742e-04,8.056e-05
----- TIMING FOR renorm : t_inter=6.7e-05 t_gemm=1.7e-04 t_reduction=8.0e-05 tot=3.2e-04 -----
 renorm[inter] counter=54 t=6.7e-05 per=2.1e+01 cost=1.3e+03 flops=1.9e+07
 renorm[gemm] counter=54 i=0 t=1.9e-06 per=5.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=1 t=1.7e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=2 t=5.3e-05 per=1.7e+01 cost=1.3e+02 flops=2.4e+06
 renorm[gemm] counter=54 i=3 t=5.9e-05 per=1.8e+01 cost=7.7e+02 flops=1.3e+07
 renorm[gemm] counter=54 i=4 t=1.7e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=5 t=1.7e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=6 t=5.4e-05 per=1.7e+01 cost=6.9e+02 flops=1.3e+07
 renorm[gemm] counter=54 total t=1.7e-04 per=5.4e+01 cost=1.6e+03 flops=9.1e+06
 renorm[red] counter=54 t=8.0e-05 per=2.5e+01 cost=3.4e+02 flops=4.3e+06
----- TIMING FOR renorm_tot : t_inter=3.3e-04 t_gemm=1.4e-03 t_reduction=4.4e-04 tot=2.2e-03 -----
 renorm_tot[inter] counter=54 t=3.3e-04 per=1.5e+01 cost=2.1e+03 flops=6.3e+06
 renorm_tot[gemm] counter=54 i=0 t=1.4e-05 per=6.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=1 t=9.5e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=2 t=6.7e-04 per=3.0e+01 cost=5.6e+02 flops=8.3e+05
 renorm_tot[gemm] counter=54 i=3 t=4.1e-04 per=1.8e+01 cost=1.7e+03 flops=4.0e+06
 renorm_tot[gemm] counter=54 i=4 t=9.7e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=5 t=9.4e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=6 t=3.3e-04 per=1.5e+01 cost=2.6e+03 flops=7.8e+06
 renorm_tot[gemm] counter=54 total t=1.4e-03 per=6.5e+01 cost=4.8e+03 flops=3.3e+06
 renorm_tot[red] counter=54 t=4.4e-04 per=2.0e+01 cost=1.6e+03 flops=3.7e+06
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.521e-05 (oper)=9.552e-06
rank=0 GPUmem(GB): used=1.527e-05 (oper,site,rinter)=9.552e-06,5.960e-08,5.372e-06
rank=0 GPUmem(GB): used=1.624e-05 (oper,site,rinter,batch)=9.552e-06,5.960e-08,5.372e-06,9.686e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.264e-03 S T(preprocess/alloc/comp/red/dealloc)=6.075e-04,6.555e-04,3.181e-03,3.038e-04,1.003e-04 -----
----- TIMING FOR oper_renorm_opS : 4.287e-03 S rank=0 -----
qops.to_cpu: size(tot)=212:1.617e-03MB:1.580e-06GB T(to_cpu)=2.559e-05S speed=6.172e-02GB/S
check ||H-H.dagger||=1.570e-16 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.00547 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=4.877e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-8.623e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.013e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 8.883e-03 S #####
 T(local oper_env: fetch) = 1.664e-03 S  per = 18.7  per(accum) = 18.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(local oper_env: renrm) = 5.962e-03 S  per = 67.1  per(accum) = 85.9
 T(local oper_env: save ) = 1.256e-03 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.962e-03 S  T(sum) = 5.962e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.750e-06 S  per = 0.13  per(accum) = 0.13
 T(local oper_env: qops init                    ) = 2.215e-04 S  per = 3.72  per(accum) = 3.85
 T(local oper_env: symbolic_formulae_renorm     ) = 4.983e-05 S  per = 0.836  per(accum) = 4.68
 T(local oper_env: allocate qops on gpu         ) = 4.220e-05 S  per = 0.708  per(accum) = 5.39
 T(local oper_env: site memcpy cpu2gpu          ) = 2.118e-05 S  per = 0.355  per(accum) = 5.74
 T(local oper_env: rintermediate init           ) = 4.519e-05 S  per = 0.758  per(accum) = 6.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.406e-04 S  per = 2.36  per(accum) = 8.86
 T(local oper_env: rmmtasks init                ) = 7.776e-05 S  per =  1.3  per(accum) = 10.2
 T(local oper_env: qops memset on cpu           ) = 3.600e-08 S  per = 0.000604  per(accum) = 10.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.774e-04 S  per = 8.01  per(accum) = 18.2
 T(local oper_env: deallocate cpu and gpu memory) = 1.772e-05 S  per = 0.297  per(accum) = 18.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.300e-03 S  per = 72.1  per(accum) = 90.6
 T(local oper_env: reduction of opS & opH [nccl]) = 2.215e-05 S  per = 0.371  per(accum) = 91
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.649e-05 S  per = 0.612  per(accum) = 91.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.516e-05 S  per = 0.254  per(accum) = 91.8
 T(local oper_env: qops_pool join and erase     ) = 4.869e-04 S  per = 8.17  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.700e-07 S  per = 0.00788  per(accum) = 100
##### sweep oper_env: 4.791e-02 S #####
 T(sweep oper_env: fetch) = 1.183e-02 S  per = 24.7  per(accum) = 24.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 24.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 24.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 24.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 24.7
 T(sweep oper_env: renrm) = 2.953e-02 S  per = 61.6  per(accum) = 86.3
 T(sweep oper_env: save ) = 6.545e-03 S  per = 13.7  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.679e+09 S  per = -8.679e+31
 T(sweep oper_env: preprocess                  ) = -8.679e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.953e-02 S  T(sum) = 2.953e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.004e-04 S  per = 0.34  per(accum) = 0.34
 T(sweep oper_env: qops init                    ) = 1.213e-03 S  per = 4.11  per(accum) = 4.45
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.509e-04 S  per = 0.85  per(accum) = 5.3
 T(sweep oper_env: allocate qops on gpu         ) = 2.738e-04 S  per = 0.927  per(accum) = 6.22
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.421e-04 S  per = 0.481  per(accum) = 6.7
 T(sweep oper_env: rintermediate init           ) = 2.409e-04 S  per = 0.816  per(accum) = 7.52
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.903e-04 S  per =    2  per(accum) = 9.52
 T(sweep oper_env: rmmtasks init                ) = 4.220e-04 S  per = 1.43  per(accum) = 10.9
 T(sweep oper_env: qops memset on cpu           ) = 2.140e-07 S  per = 0.000725  per(accum) = 10.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.123e-03 S  per = 10.6  per(accum) = 21.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.129e-04 S  per = 0.382  per(accum) = 21.9
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.969e-02 S  per = 66.7  per(accum) = 88.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.065e-04 S  per = 0.361  per(accum) = 88.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.774e-04 S  per = 0.601  per(accum) = 89.5
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 9.846e-05 S  per = 0.333  per(accum) = 89.9
 T(sweep oper_env: qops_pool join and erase     ) = 2.987e-03 S  per = 10.1  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.683e-06 S  per = 0.00909  per(accum) = 100

idx=6 coord=(13,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=6 scratch=./scratch/sweep size=16:1.19e-07GB T(load)=2.78e-04S speed=4.28e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:6 S:7 H:1 A:17 B:22 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=212:0.00162MB:1.58e-06GB
        per(mem): C:11.3 S:13.2 H:2.83 A:0 B:72.6 
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:7 S:6 H:1 A:23 B:28 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=564:0.0043MB:4.2e-06GB
        per(mem): C:9.93 S:8.51 H:2.13 A:0 B:79.4 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.666e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=59 : 5.302e-05 S -----
rank=0 GPUmem(GB): used=1.322e-05 (oper)=1.322e-05
rank=0 GPUmem(GB): used=1.334e-05 (oper,site)=1.322e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=59
 no. of rintermediate operators=5
 no. of coefficients=54:4.120e-04MB:4.023e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.417e-05 S -----
rank=0 GPUmem(GB): used=1.374e-05 (oper,site,rinter)=1.322e-05,1.192e-07,4.023e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.546e-04 S size(rtasks)=59 size(Rlst2)=9 T(Rmu/Rlist)=2.884e-05,2.258e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.836e-04 S size(rtasks)=59 size(Rlst)=250 -----
rank=0 GPUmem(GB): used=1.374e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.421e-05 blksize=4 blksize0=4 batchsize=250
rank=0 GPUmem(GB): used=3.795e-05 (oper,site,rinter,batch)=1.322e-05,1.192e-07,4.023e-07,2.421e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.699e-05,1.932e-04,6.348e-05
----- TIMING FOR renorm : t_inter=7.7e-05 t_gemm=1.9e-04 t_reduction=6.3e-05 tot=3.3e-04 -----
 renorm[inter] counter=69 t=7.7e-05 per=2.3e+01 cost=1.9e+03 flops=2.5e+07
 renorm[gemm] counter=69 i=0 t=1.9e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=1 t=1.7e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=2 t=6.1e-05 per=1.8e+01 cost=4.4e+02 flops=7.2e+06
 renorm[gemm] counter=69 i=3 t=6.5e-05 per=2.0e+01 cost=2.1e+03 flops=3.2e+07
 renorm[gemm] counter=69 i=4 t=1.8e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=5 t=1.7e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=6 t=6.0e-05 per=1.8e+01 cost=3.1e+03 flops=5.2e+07
 renorm[gemm] counter=69 total t=1.9e-04 per=5.8e+01 cost=5.6e+03 flops=2.9e+07
 renorm[red] counter=69 t=6.3e-05 per=1.9e+01 cost=2.0e+03 flops=3.2e+07
----- TIMING FOR renorm_tot : t_inter=4.1e-04 t_gemm=1.6e-03 t_reduction=5.0e-04 tot=2.6e-03 -----
 renorm_tot[inter] counter=69 t=4.1e-04 per=1.6e+01 cost=4.0e+03 flops=9.8e+06
 renorm_tot[gemm] counter=69 i=0 t=1.6e-05 per=6.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=1 t=1.1e-05 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=2 t=7.3e-04 per=2.9e+01 cost=1.0e+03 flops=1.4e+06
 renorm_tot[gemm] counter=69 i=3 t=4.8e-04 per=1.9e+01 cost=3.7e+03 flops=7.8e+06
 renorm_tot[gemm] counter=69 i=4 t=1.1e-05 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=5 t=1.1e-05 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=6 t=3.9e-04 per=1.5e+01 cost=5.7e+03 flops=1.5e+07
 renorm_tot[gemm] counter=69 total t=1.6e-03 per=6.4e+01 cost=1.0e+04 flops=6.3e+06
 renorm_tot[red] counter=69 t=5.0e-04 per=2.0e+01 cost=3.6e+03 flops=7.2e+06
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.039e-05 (oper)=1.328e-05
rank=0 GPUmem(GB): used=2.051e-05 (oper,site,rinter)=1.328e-05,1.192e-07,6.713e-06
rank=0 GPUmem(GB): used=2.187e-05 (oper,site,rinter,batch)=1.328e-05,1.192e-07,6.713e-06,1.356e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.252e-03 S T(preprocess/alloc/comp/red/dealloc)=6.524e-04,6.983e-04,3.157e-03,2.773e-04,9.951e-05 -----
----- TIMING FOR oper_renorm_opS : 4.276e-03 S rank=0 -----
qops.to_cpu: size(tot)=564:4.303e-03MB:4.202e-06GB T(to_cpu)=2.841e-05S speed=1.479e-01GB/S
check ||H-H.dagger||=1.573e-16 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.00569 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=9.519e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-9.438e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-2.816e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 9.190e-03 S #####
 T(local oper_env: fetch) = 1.683e-03 S  per = 18.3  per(accum) = 18.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.3
 T(local oper_env: renrm) = 6.187e-03 S  per = 67.3  per(accum) = 85.6
 T(local oper_env: save ) = 1.319e-03 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.187e-03 S  T(sum) = 6.187e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.681e-06 S  per = 0.14  per(accum) = 0.14
 T(local oper_env: qops init                    ) = 2.303e-04 S  per = 3.72  per(accum) = 3.86
 T(local oper_env: symbolic_formulae_renorm     ) = 6.263e-05 S  per = 1.01  per(accum) = 4.87
 T(local oper_env: allocate qops on gpu         ) = 5.033e-05 S  per = 0.813  per(accum) = 5.69
 T(local oper_env: site memcpy cpu2gpu          ) = 2.121e-05 S  per = 0.343  per(accum) = 6.03
 T(local oper_env: rintermediate init           ) = 4.427e-05 S  per = 0.716  per(accum) = 6.75
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.953e-04 S  per = 4.77  per(accum) = 11.5
 T(local oper_env: rmmtasks init                ) = 1.156e-04 S  per = 1.87  per(accum) = 13.4
 T(local oper_env: qops memset on cpu           ) = 4.000e-08 S  per = 0.000646  per(accum) = 13.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.832e-04 S  per = 7.81  per(accum) = 21.2
 T(local oper_env: deallocate cpu and gpu memory) = 1.892e-05 S  per = 0.306  per(accum) = 21.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.291e-03 S  per = 69.4  per(accum) = 90.9
 T(local oper_env: reduction of opS & opH [nccl]) = 1.909e-05 S  per = 0.309  per(accum) = 91.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.870e-05 S  per = 0.625  per(accum) = 91.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.516e-05 S  per = 0.245  per(accum) = 92
 T(local oper_env: qops_pool join and erase     ) = 4.921e-04 S  per = 7.95  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.770e-07 S  per = 0.00771  per(accum) = 100
##### sweep oper_env: 5.710e-02 S #####
 T(sweep oper_env: fetch) = 1.351e-02 S  per = 23.7  per(accum) = 23.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 23.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 23.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 23.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 23.7
 T(sweep oper_env: renrm) = 3.572e-02 S  per = 62.6  per(accum) = 86.2
 T(sweep oper_env: save ) = 7.864e-03 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.041e+10 S  per = -1.041e+32
 T(sweep oper_env: preprocess                  ) = -1.041e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.572e-02 S  T(sum) = 3.572e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.091e-04 S  per = 0.305  per(accum) = 0.305
 T(sweep oper_env: qops init                    ) = 1.443e-03 S  per = 4.04  per(accum) = 4.35
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.135e-04 S  per = 0.878  per(accum) = 5.22
 T(sweep oper_env: allocate qops on gpu         ) = 3.241e-04 S  per = 0.907  per(accum) = 6.13
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.634e-04 S  per = 0.457  per(accum) = 6.59
 T(sweep oper_env: rintermediate init           ) = 2.852e-04 S  per = 0.799  per(accum) = 7.39
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.856e-04 S  per = 2.48  per(accum) = 9.87
 T(sweep oper_env: rmmtasks init                ) = 5.376e-04 S  per = 1.51  per(accum) = 11.4
 T(sweep oper_env: qops memset on cpu           ) = 2.540e-07 S  per = 0.000711  per(accum) = 11.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.606e-03 S  per = 10.1  per(accum) = 21.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.318e-04 S  per = 0.369  per(accum) = 21.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.398e-02 S  per = 67.1  per(accum) = 89
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.256e-04 S  per = 0.351  per(accum) = 89.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.161e-04 S  per = 0.605  per(accum) = 89.9
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.136e-04 S  per = 0.318  per(accum) = 90.3
 T(sweep oper_env: qops_pool join and erase     ) = 3.479e-03 S  per = 9.74  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.160e-06 S  per = 0.00885  per(accum) = 100

idx=7 coord=(12,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=7 scratch=./scratch/sweep size=28:2.09e-07GB T(load)=2.84e-04S speed=7.34e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:7 S:6 H:1 A:23 B:28 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=564:0.0043MB:4.2e-06GB
        per(mem): C:9.93 S:8.51 H:2.13 A:0 B:79.4 
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:8 S:6 H:1 A:28 B:40 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=1430:0.0109MB:1.07e-05GB
        per(mem): C:6.71 S:5.03 H:1.54 A:0 B:86.7 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.853e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 5.583e-05 S -----
rank=0 GPUmem(GB): used=2.229e-05 (oper)=2.229e-05
rank=0 GPUmem(GB): used=2.250e-05 (oper,site)=2.229e-05,2.086e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=77
 no. of rintermediate operators=5
 no. of coefficients=69:5.264e-04MB:5.141e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.039e-05 S -----
rank=0 GPUmem(GB): used=2.301e-05 (oper,site,rinter)=2.229e-05,2.086e-07,5.141e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 3.057e-04 S size(rtasks)=77 size(Rlst2)=9 T(Rmu/Rlist)=3.569e-05,2.700e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.453e-04 S size(rtasks)=77 size(Rlst)=315 -----
rank=0 GPUmem(GB): used=2.301e-05 avail=3.829e+01 total=3.829e+01 batch[need]=5.398e-05 blksize=9 blksize0=4 batchsize=315
rank=0 GPUmem(GB): used=7.699e-05 (oper,site,rinter,batch)=2.229e-05,2.086e-07,5.141e-07,5.398e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.140e-05,1.938e-04,6.825e-05
----- TIMING FOR renorm : t_inter=7.1e-05 t_gemm=1.9e-04 t_reduction=6.8e-05 tot=3.3e-04 -----
 renorm[inter] counter=83 t=7.1e-05 per=2.1e+01 cost=3.1e+03 flops=4.4e+07
 renorm[gemm] counter=83 i=0 t=1.9e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=1 t=1.7e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=2 t=5.3e-05 per=1.6e+01 cost=1.3e+03 flops=2.5e+07
 renorm[gemm] counter=83 i=3 t=6.8e-05 per=2.0e+01 cost=5.4e+03 flops=8.0e+07
 renorm[gemm] counter=83 i=4 t=1.7e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=5 t=1.7e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=6 t=6.5e-05 per=2.0e+01 cost=1.0e+04 flops=1.6e+08
 renorm[gemm] counter=83 total t=1.9e-04 per=5.8e+01 cost=1.7e+04 flops=8.9e+07
 renorm[red] counter=83 t=6.8e-05 per=2.0e+01 cost=5.2e+03 flops=7.6e+07
----- TIMING FOR renorm_tot : t_inter=4.8e-04 t_gemm=1.8e-03 t_reduction=5.7e-04 tot=2.9e-03 -----
 renorm_tot[inter] counter=83 t=4.8e-04 per=1.7e+01 cost=7.2e+03 flops=1.5e+07
 renorm_tot[gemm] counter=83 i=0 t=1.8e-05 per=6.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=1 t=1.3e-05 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=2 t=7.8e-04 per=2.7e+01 cost=2.3e+03 flops=3.0e+06
 renorm_tot[gemm] counter=83 i=3 t=5.4e-04 per=1.9e+01 cost=9.2e+03 flops=1.7e+07
 renorm_tot[gemm] counter=83 i=4 t=1.3e-05 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=5 t=1.3e-05 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=6 t=4.5e-04 per=1.6e+01 cost=1.6e+04 flops=3.6e+07
 renorm_tot[gemm] counter=83 total t=1.8e-03 per=6.4e+01 cost=2.8e+04 flops=1.5e+07
 renorm_tot[red] counter=83 t=5.7e-04 per=2.0e+01 cost=8.8e+03 flops=1.6e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.090e-05 (oper)=2.238e-05
rank=0 GPUmem(GB): used=3.111e-05 (oper,site,rinter)=2.238e-05,2.086e-07,8.002e-06
rank=0 GPUmem(GB): used=3.288e-05 (oper,site,rinter,batch)=2.238e-05,2.086e-07,8.002e-06,1.773e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.934e-03 S T(preprocess/alloc/comp/red/dealloc)=6.416e-04,6.935e-04,2.886e-03,2.439e-04,8.996e-05 -----
----- TIMING FOR oper_renorm_opS : 3.958e-03 S rank=0 -----
qops.to_cpu: size(tot)=1430:1.091e-02MB:1.065e-05GB T(to_cpu)=3.283e-05S speed=3.245e-01GB/S
check ||H-H.dagger||=3.140e-16 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0055 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.183e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-9.748e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-2.906e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 9.435e-03 S #####
 T(local oper_env: fetch) = 1.687e-03 S  per = 17.9  per(accum) = 17.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.9
 T(local oper_env: renrm) = 6.015e-03 S  per = 63.8  per(accum) = 81.6
 T(local oper_env: save ) = 1.733e-03 S  per = 18.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.015e-03 S  T(sum) = 6.015e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.858e-06 S  per = 0.147  per(accum) = 0.147
 T(local oper_env: qops init                    ) = 2.415e-04 S  per = 4.02  per(accum) = 4.16
 T(local oper_env: symbolic_formulae_renorm     ) = 6.542e-05 S  per = 1.09  per(accum) = 5.25
 T(local oper_env: allocate qops on gpu         ) = 5.009e-05 S  per = 0.833  per(accum) = 6.08
 T(local oper_env: site memcpy cpu2gpu          ) = 2.108e-05 S  per = 0.35  per(accum) = 6.43
 T(local oper_env: rintermediate init           ) = 4.346e-05 S  per = 0.723  per(accum) = 7.16
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.585e-04 S  per = 5.96  per(accum) = 13.1
 T(local oper_env: rmmtasks init                ) = 1.452e-04 S  per = 2.41  per(accum) = 15.5
 T(local oper_env: qops memset on cpu           ) = 4.200e-08 S  per = 0.000698  per(accum) = 15.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.842e-04 S  per = 8.05  per(accum) = 23.6
 T(local oper_env: deallocate cpu and gpu memory) = 2.191e-05 S  per = 0.364  per(accum) = 23.9
 T(local oper_env: construct opS [ifdists=true] ) = 3.972e-03 S  per =   66  per(accum) = 90
 T(local oper_env: reduction of opS & opH [nccl]) = 1.857e-05 S  per = 0.309  per(accum) = 90.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 6.264e-05 S  per = 1.04  per(accum) = 91.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.433e-05 S  per = 0.238  per(accum) = 91.6
 T(local oper_env: qops_pool join and erase     ) = 5.063e-04 S  per = 8.42  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.610e-07 S  per = 0.00766  per(accum) = 100
##### sweep oper_env: 6.653e-02 S #####
 T(sweep oper_env: fetch) = 1.520e-02 S  per = 22.8  per(accum) = 22.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(sweep oper_env: renrm) = 4.173e-02 S  per = 62.7  per(accum) = 85.6
 T(sweep oper_env: save ) = 9.597e-03 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.215e+10 S  per = -1.215e+32
 T(sweep oper_env: preprocess                  ) = -1.215e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.173e-02 S  T(sum) = 4.173e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.179e-04 S  per = 0.283  per(accum) = 0.283
 T(sweep oper_env: qops init                    ) = 1.685e-03 S  per = 4.04  per(accum) = 4.32
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.790e-04 S  per = 0.908  per(accum) = 5.23
 T(sweep oper_env: allocate qops on gpu         ) = 3.742e-04 S  per = 0.897  per(accum) = 6.12
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.844e-04 S  per = 0.442  per(accum) = 6.57
 T(sweep oper_env: rintermediate init           ) = 3.287e-04 S  per = 0.788  per(accum) = 7.35
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.244e-03 S  per = 2.98  per(accum) = 10.3
 T(sweep oper_env: rmmtasks init                ) = 6.828e-04 S  per = 1.64  per(accum) = 12
 T(sweep oper_env: qops memset on cpu           ) = 2.960e-07 S  per = 0.000709  per(accum) = 12
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.091e-03 S  per =  9.8  per(accum) = 21.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.537e-04 S  per = 0.368  per(accum) = 22.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.795e-02 S  per =   67  per(accum) = 89.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.441e-04 S  per = 0.345  per(accum) = 89.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.787e-04 S  per = 0.668  per(accum) = 90.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.279e-04 S  per = 0.307  per(accum) = 90.4
 T(sweep oper_env: qops_pool join and erase     ) = 3.985e-03 S  per = 9.55  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.621e-06 S  per = 0.00868  per(accum) = 100

idx=8 coord=(11,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=8 scratch=./scratch/sweep size=42:3.13e-07GB T(load)=2.93e-04S speed=1.07e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:8 S:6 H:1 A:28 B:40 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=1430:0.0109MB:1.07e-05GB
        per(mem): C:6.71 S:5.03 H:1.54 A:0 B:86.7 
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:9 S:5 H:1 A:40 B:44 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=2301:0.0176MB:1.71e-05GB
        per(mem): C:3.13 S:1.74 H:1.43 A:0 B:93.7 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=9.018e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=94 : 6.882e-05 S -----
rank=0 GPUmem(GB): used=3.523e-05 (oper)=3.523e-05
rank=0 GPUmem(GB): used=3.555e-05 (oper,site)=3.523e-05,3.129e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=94
 no. of rintermediate operators=5
 no. of coefficients=96:7.324e-04MB:7.153e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.030e-05 S -----
rank=0 GPUmem(GB): used=3.626e-05 (oper,site,rinter)=3.523e-05,3.129e-07,7.153e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 3.650e-04 S size(rtasks)=94 size(Rlst2)=9 T(Rmu/Rlist)=4.340e-05,3.216e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.100e-04 S size(rtasks)=94 size(Rlst)=378 -----
rank=0 GPUmem(GB): used=3.626e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.183e-04 blksize=16 blksize0=9 batchsize=378
rank=0 GPUmem(GB): used=1.545e-04 (oper,site,rinter,batch)=3.523e-05,3.129e-07,7.153e-07,1.183e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.882e-05,2.296e-04,7.493e-05
----- TIMING FOR renorm : t_inter=7.9e-05 t_gemm=2.3e-04 t_reduction=7.5e-05 tot=3.8e-04 -----
 renorm[inter] counter=96 t=7.9e-05 per=2.1e+01 cost=6.1e+03 flops=7.7e+07
 renorm[gemm] counter=96 i=0 t=1.9e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=96 i=1 t=1.7e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=96 i=2 t=6.9e-05 per=1.8e+01 cost=1.6e+03 flops=2.4e+07
 renorm[gemm] counter=96 i=3 t=8.3e-05 per=2.2e+01 cost=1.5e+04 flops=1.8e+08
 renorm[gemm] counter=96 i=4 t=1.7e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=96 i=5 t=1.7e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=96 i=6 t=7.0e-05 per=1.8e+01 cost=2.5e+04 flops=3.6e+08
 renorm[gemm] counter=96 total t=2.3e-04 per=6.0e+01 cost=4.2e+04 flops=1.8e+08
 renorm[red] counter=96 t=7.5e-05 per=2.0e+01 cost=1.0e+04 flops=1.4e+08
----- TIMING FOR renorm_tot : t_inter=5.6e-04 t_gemm=2.1e-03 t_reduction=6.4e-04 tot=3.3e-03 -----
 renorm_tot[inter] counter=96 t=5.6e-04 per=1.7e+01 cost=1.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=96 i=0 t=2.0e-05 per=6.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=96 i=1 t=1.4e-05 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=96 i=2 t=8.5e-04 per=2.6e+01 cost=4.0e+03 flops=4.7e+06
 renorm_tot[gemm] counter=96 i=3 t=6.3e-04 per=1.9e+01 cost=2.4e+04 flops=3.8e+07
 renorm_tot[gemm] counter=96 i=4 t=1.5e-05 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=96 i=5 t=1.4e-05 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=96 i=6 t=5.2e-04 per=1.6e+01 cost=4.1e+04 flops=7.9e+07
 renorm_tot[gemm] counter=96 total t=2.1e-03 per=6.3e+01 cost=6.9e+04 flops=3.4e+07
 renorm_tot[red] counter=96 t=6.4e-04 per=2.0e+01 cost=1.9e+04 flops=3.0e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.575e-05 (oper)=3.529e-05
rank=0 GPUmem(GB): used=4.607e-05 (oper,site,rinter)=3.529e-05,3.129e-07,9.745e-06
rank=0 GPUmem(GB): used=4.763e-05 (oper,site,rinter,batch)=3.529e-05,3.129e-07,9.745e-06,1.565e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.502e-03 S T(preprocess/alloc/comp/red/dealloc)=6.217e-04,6.726e-04,2.492e-03,2.328e-04,8.671e-05 -----
----- TIMING FOR oper_renorm_opS : 3.523e-03 S rank=0 -----
qops.to_cpu: size(tot)=2301:1.756e-02MB:1.714e-05GB T(to_cpu)=3.816e-05S speed=4.493e-01GB/S
check ||H-H.dagger||=3.931e-17 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.00521 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.477e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.022e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-3.025e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 8.721e-03 S #####
 T(local oper_env: fetch) = 1.646e-03 S  per = 18.9  per(accum) = 18.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.9
 T(local oper_env: renrm) = 5.748e-03 S  per = 65.9  per(accum) = 84.8
 T(local oper_env: save ) = 1.327e-03 S  per = 15.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.748e-03 S  T(sum) = 5.748e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.888e-05 S  per = 0.329  per(accum) = 0.329
 T(local oper_env: qops init                    ) = 2.587e-04 S  per =  4.5  per(accum) = 4.83
 T(local oper_env: symbolic_formulae_renorm     ) = 7.810e-05 S  per = 1.36  per(accum) = 6.19
 T(local oper_env: allocate qops on gpu         ) = 4.779e-05 S  per = 0.831  per(accum) = 7.02
 T(local oper_env: site memcpy cpu2gpu          ) = 2.087e-05 S  per = 0.363  per(accum) = 7.38
 T(local oper_env: rintermediate init           ) = 4.191e-05 S  per = 0.729  per(accum) = 8.11
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.189e-04 S  per = 7.29  per(accum) = 15.4
 T(local oper_env: rmmtasks init                ) = 1.664e-04 S  per = 2.89  per(accum) = 18.3
 T(local oper_env: qops memset on cpu           ) = 2.700e-08 S  per = 0.00047  per(accum) = 18.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 5.343e-04 S  per = 9.29  per(accum) = 27.6
 T(local oper_env: deallocate cpu and gpu memory) = 2.171e-05 S  per = 0.378  per(accum) = 28
 T(local oper_env: construct opS [ifdists=true] ) = 3.546e-03 S  per = 61.7  per(accum) = 89.7
 T(local oper_env: reduction of opS & opH [nccl]) = 1.798e-05 S  per = 0.313  per(accum) = 90
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.752e-05 S  per = 0.827  per(accum) = 90.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.411e-05 S  per = 0.245  per(accum) = 91
 T(local oper_env: qops_pool join and erase     ) = 5.144e-04 S  per = 8.95  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.370e-07 S  per = 0.0076  per(accum) = 100
##### sweep oper_env: 7.525e-02 S #####
 T(sweep oper_env: fetch) = 1.684e-02 S  per = 22.4  per(accum) = 22.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.4
 T(sweep oper_env: renrm) = 4.748e-02 S  per = 63.1  per(accum) = 85.5
 T(sweep oper_env: save ) = 1.092e-02 S  per = 14.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.389e+10 S  per = -1.389e+32
 T(sweep oper_env: preprocess                  ) = -1.389e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.748e-02 S  T(sum) = 4.748e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.368e-04 S  per = 0.288  per(accum) = 0.288
 T(sweep oper_env: qops init                    ) = 1.943e-03 S  per = 4.09  per(accum) = 4.38
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.571e-04 S  per = 0.963  per(accum) = 5.34
 T(sweep oper_env: allocate qops on gpu         ) = 4.220e-04 S  per = 0.889  per(accum) = 6.23
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.053e-04 S  per = 0.432  per(accum) = 6.66
 T(sweep oper_env: rintermediate init           ) = 3.706e-04 S  per = 0.78  per(accum) = 7.44
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.663e-03 S  per =  3.5  per(accum) = 10.9
 T(sweep oper_env: rmmtasks init                ) = 8.493e-04 S  per = 1.79  per(accum) = 12.7
 T(sweep oper_env: qops memset on cpu           ) = 3.230e-07 S  per = 0.00068  per(accum) = 12.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.625e-03 S  per = 9.74  per(accum) = 22.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.754e-04 S  per = 0.369  per(accum) = 22.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.150e-02 S  per = 66.3  per(accum) = 89.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.621e-04 S  per = 0.341  per(accum) = 89.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.263e-04 S  per = 0.687  per(accum) = 90.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.421e-04 S  per = 0.299  per(accum) = 90.5
 T(sweep oper_env: qops_pool join and erase     ) = 4.499e-03 S  per = 9.48  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 4.058e-06 S  per = 0.00855  per(accum) = 100

idx=9 coord=(10,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=9 scratch=./scratch/sweep size=96:7.15e-07GB T(load)=3.02e-04S speed=2.37e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHAB nops=C:9 S:5 H:1 A:40 B:44 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=2301:0.0176MB:1.71e-05GB
        per(mem): C:3.13 S:1.74 H:1.43 A:0 B:93.7 
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:10 S:5 H:1 A:49 B:56 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=7034:0.0537MB:5.24e-05GB
        per(mem): C:2.84 S:1.42 H:0.995 A:0 B:94.7 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.044e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=116 : 7.799e-05 S -----
rank=0 GPUmem(GB): used=7.699e-05 (oper)=7.699e-05
rank=0 GPUmem(GB): used=7.770e-05 (oper,site)=7.699e-05,7.153e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=116
 no. of rintermediate operators=5
 no. of coefficients=110:8.392e-04MB:8.196e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.307e-05 S -----
rank=0 GPUmem(GB): used=7.852e-05 (oper,site,rinter)=7.699e-05,7.153e-07,8.196e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 9.132e-04 S size(rtasks)=116 size(Rlst2)=25 T(Rmu/Rlist)=5.341e-05,8.597e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.017e-03 S size(rtasks)=116 size(Rlst)=978 -----
rank=0 GPUmem(GB): used=7.852e-05 avail=3.829e+01 total=3.829e+01 batch[need]=6.485e-04 blksize=36 blksize0=16 batchsize=978
rank=0 GPUmem(GB): used=7.270e-04 (oper,site,rinter,batch)=7.699e-05,7.153e-07,8.196e-07,6.485e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.480e-05,3.032e-04,9.919e-05
----- TIMING FOR renorm : t_inter=8.5e-05 t_gemm=3.0e-04 t_reduction=9.9e-05 tot=4.9e-04 -----
 renorm[inter] counter=108 t=8.5e-05 per=1.7e+01 cost=3.4e+04 flops=4.1e+08
 renorm[gemm] counter=108 i=0 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=108 i=1 t=1.7e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=108 i=2 t=8.5e-05 per=1.8e+01 cost=6.7e+03 flops=7.8e+07
 renorm[gemm] counter=108 i=3 t=9.0e-05 per=1.9e+01 cost=7.7e+04 flops=8.5e+08
 renorm[gemm] counter=108 i=4 t=1.7e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=108 i=5 t=1.7e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=108 i=6 t=1.2e-04 per=2.5e+01 cost=1.1e+05 flops=9.5e+08
 renorm[gemm] counter=108 total t=3.0e-04 per=6.2e+01 cost=2.0e+05 flops=6.5e+08
 renorm[red] counter=108 t=9.9e-05 per=2.0e+01 cost=3.2e+04 flops=3.3e+08
----- TIMING FOR renorm_tot : t_inter=6.4e-04 t_gemm=2.4e-03 t_reduction=7.4e-04 tot=3.8e-03 -----
 renorm_tot[inter] counter=108 t=6.4e-04 per=1.7e+01 cost=4.8e+04 flops=7.4e+07
 renorm_tot[gemm] counter=108 i=0 t=2.1e-05 per=5.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=108 i=1 t=1.6e-05 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=108 i=2 t=9.4e-04 per=2.5e+01 cost=1.1e+04 flops=1.1e+07
 renorm_tot[gemm] counter=108 i=3 t=7.2e-04 per=1.9e+01 cost=1.0e+05 flops=1.4e+08
 renorm_tot[gemm] counter=108 i=4 t=1.7e-05 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=108 i=5 t=1.6e-05 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=108 i=6 t=6.4e-04 per=1.7e+01 cost=1.6e+05 flops=2.4e+08
 renorm_tot[gemm] counter=108 total t=2.4e-03 per=6.3e+01 cost=2.7e+05 flops=1.1e+08
 renorm_tot[red] counter=108 t=7.4e-04 per=2.0e+01 cost=5.1e+04 flops=6.9e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=8.850e-05 (oper)=7.714e-05
rank=0 GPUmem(GB): used=8.921e-05 (oper,site,rinter)=7.714e-05,7.153e-07,1.054e-05
rank=0 GPUmem(GB): used=1.009e-04 (oper,site,rinter,batch)=7.714e-05,7.153e-07,1.054e-05,1.167e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.118e-03 S T(preprocess/alloc/comp/red/dealloc)=1.212e-03,1.273e-03,2.535e-03,2.097e-04,8.141e-05 -----
----- TIMING FOR oper_renorm_opS : 4.142e-03 S rank=0 -----
----- TIMING FOR oper_renorm : 6.855e-03 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=2.703e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=7.477e-04 change=-1.187e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=16,16 size(op)=168:1.282e-03MB size(tot)=7034:5.367e-02MB:5.241e-05GB
        per(mem): C:2.84 S:1.42 H:0.995 P:0 Q:94.7 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=7.095e-04 change=2.440e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=7.095e-04 change=1.207e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.048e-04 avail=3.829e+01 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1ctns::oper_b2q ifab=0 ifkr=1 maxsize=6664:4.965e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:56 
        dim(bra,ket)=16,16 size(op)=168:1.282e-03MB size(tot)=6664:5.084e-02MB:4.965e-05GB
        per(mem): B:100 
   init qops_tmp: dt=8.75e-05 tinit=8.75e-05
   copy opB to qops_tmps: dt=5.46e-06 tcopy=5.46e-06
   bcast: size(opB)=6664:4.97e-05GB dt=3.03e-05 speed=1.64GB/s tcomm=3.03e-05
   compute opQ from opB: dt=0.000113 tcomp=0.000113
iproc=0
 qops_tmp: oplist=N nops=N:56 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=6664:0.0508MB:4.97e-05GB
        per(mem): N:100 
   init qops_tmp: dt=6.31e-05 tinit=0.000151
   from opB to opB.H(): dt=0.00015 tadjt=0.00015
   bcast: size(opN)=6664:4.97e-05GB dt=2.66e-05 speed=1.87GB/s tcomm=5.69e-05
   compute opQ from opB.H(): dt=8.11e-05 tcomp=0.000194
----- TIMING FOR oper_b2qGPU : 0.0013 S T(init/copy/adjt+bcast/comp/rest)=0.000269,5.49e-06,0.000449,0.000354,0.000224 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=6.866e-04 change=4.321e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.048e-04 avail=3.829e+01 before qops2.to_cpu
iproc=1
 qops_tmp: oplist=B nops=B:54 
        dim(bra,ket)=16,16 size(op)=168:0.00128174MB size(tot)=6426:0.0490265MB:4.78774e-05GB
        per(mem): B:100 
   init qops_tmp: dt=5.78e-05 tinit=0.000199
   copy opB to qops_tmps: dt=4.7e-06 tcopy=4.73e-06
   bcast: size(opB)=6426:4.79e-05GB dt=2.29e-05 speed=2.09GB/s tcomm=0.00035
   compute opQ from opB: dt=8.06e-05 tcomp=0.000283
iproc=1
 qops_tmp: oplist=N nops=N:54 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=6426:0.049MB:4.79e-05GB
        per(mem): N:100 
   init qops_tmp: dt=5.77e-05 tinit=0.000257
   from opB to opB.H(): dt=0.000149 tadjt=0.000149
   bcast: size(opN)=6426:4.79e-05GB dt=2.29e-05 speed=2.09GB/s tcomm=0.000372
   compute opQ from opB.H(): dt=9.07e-05 tcomp=0.000373
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=6.866e-04 change=5.341e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.048e-04 avail=3.829e+01 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=6.866e-04 change=-5.960e-08 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 before move
rank=0 GPUmem(GB): used=1.048e-04 avail=3.829e+01 before move
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=6.866e-04 change=-2.454e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after move
rank=0 GPUmem(GB): used=5.241e-05 avail=3.829e+01 after move
----- TIMING FOR oper_ab2pq : 2.615e-03 S T(init/copyCSH/opP/opQ/to_gpu/to_cpu/move)=4.909e-04,1.363e-05,6.483e-05,1.318e-03,0.000e+00,3.886e-04,3.382e-04 -----
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=6.866e-04 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-5.156e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.325e-02 S #####
 T(local oper_env: fetch) = 1.685e-03 S  per = 12.7  per(accum) = 12.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: renrm) = 1.024e-02 S  per = 77.2  per(accum) = 90
 T(local oper_env: save ) = 1.332e-03 S  per =   10  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.024e-02 S  T(sum) = 1.024e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.411e-05 S  per = 0.138  per(accum) = 0.138
 T(local oper_env: qops init                    ) = 4.002e-04 S  per = 3.91  per(accum) = 4.05
 T(local oper_env: symbolic_formulae_renorm     ) = 8.753e-05 S  per = 0.855  per(accum) = 4.9
 T(local oper_env: allocate qops on gpu         ) = 4.959e-05 S  per = 0.484  per(accum) = 5.39
 T(local oper_env: site memcpy cpu2gpu          ) = 2.126e-05 S  per = 0.208  per(accum) = 5.6
 T(local oper_env: rintermediate init           ) = 5.256e-05 S  per = 0.513  per(accum) = 6.11
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.028e-03 S  per =   10  per(accum) = 16.1
 T(local oper_env: rmmtasks init                ) = 3.760e-04 S  per = 3.67  per(accum) = 19.8
 T(local oper_env: qops memset on cpu           ) = 5.700e-08 S  per = 0.000557  per(accum) = 19.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 6.386e-04 S  per = 6.24  per(accum) = 26.1
 T(local oper_env: deallocate cpu and gpu memory) = 2.614e-05 S  per = 0.255  per(accum) = 26.3
 T(local oper_env: construct opS [ifdists=true] ) = 4.157e-03 S  per = 40.6  per(accum) = 66.9
 T(local oper_env: reduction of opS & opH [nccl]) = 1.819e-05 S  per = 0.178  per(accum) = 67.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.000e-08 S  per = 0.000391  per(accum) = 67.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 5.000e-08 S  per = 0.000488  per(accum) = 67.1
 T(local oper_env: qops_pool join and erase     ) = 6.356e-04 S  per = 6.21  per(accum) = 73.3
 T(local oper_env: conversion from opAB to opPQ ) = 2.732e-03 S  per = 26.7  per(accum) = 100
##### sweep oper_env: 8.850e-02 S #####
 T(sweep oper_env: fetch) = 1.853e-02 S  per = 20.9  per(accum) = 20.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.9
 T(sweep oper_env: renrm) = 5.772e-02 S  per = 65.2  per(accum) = 86.2
 T(sweep oper_env: save ) = 1.226e-02 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.562e+10 S  per = -1.562e+32
 T(sweep oper_env: preprocess                  ) = -1.562e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.772e-02 S  T(sum) = 5.772e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.509e-04 S  per = 0.261  per(accum) = 0.261
 T(sweep oper_env: qops init                    ) = 2.344e-03 S  per = 4.06  per(accum) = 4.32
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.446e-04 S  per = 0.944  per(accum) = 5.27
 T(sweep oper_env: allocate qops on gpu         ) = 4.716e-04 S  per = 0.817  per(accum) = 6.08
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.266e-04 S  per = 0.393  per(accum) = 6.47
 T(sweep oper_env: rintermediate init           ) = 4.232e-04 S  per = 0.733  per(accum) = 7.21
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.691e-03 S  per = 4.66  per(accum) = 11.9
 T(sweep oper_env: rmmtasks init                ) = 1.225e-03 S  per = 2.12  per(accum) = 14
 T(sweep oper_env: qops memset on cpu           ) = 3.800e-07 S  per = 0.000658  per(accum) = 14
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.263e-03 S  per = 9.12  per(accum) = 23.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.016e-04 S  per = 0.349  per(accum) = 23.5
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.566e-02 S  per = 61.8  per(accum) = 85.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.803e-04 S  per = 0.312  per(accum) = 85.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.263e-04 S  per = 0.565  per(accum) = 86.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.421e-04 S  per = 0.246  per(accum) = 86.4
 T(sweep oper_env: qops_pool join and erase     ) = 5.135e-03 S  per =  8.9  per(accum) = 95.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.736e-03 S  per = 4.74  per(accum) = 100

idx=10 coord=(9,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=10 scratch=./scratch/sweep size=152:1.13e-06GB T(load)=2.91e-04S speed=3.89e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=7034:0.0537MB:5.24e-05GB
        per(mem): C:2.84 S:1.42 H:0.995 P:0 Q:94.7 
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:11 S:4 H:1 P:40 Q:46 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=6142:0.0469MB:4.58e-05GB
        per(mem): C:4.66 S:1.69 H:1.16 P:0 Q:92.5 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.159e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=98 : 3.063e-04 S -----
rank=0 GPUmem(GB): used=1.056e-04 (oper)=1.056e-04
rank=0 GPUmem(GB): used=1.067e-04 (oper,site)=1.056e-04,1.132e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=98
 no. of rintermediate operators=132
 no. of coefficients=1320:1.007e-02MB:9.835e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.916e-05 S -----
rank=0 GPUmem(GB): used=1.166e-04 (oper,site,rinter)=1.056e-04,1.132e-06,9.835e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.128e-03 S size(rtasks)=98 size(Rlst2)=49 T(Rmu/Rlist)=1.308e-04,2.997e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.253e-03 S size(rtasks)=98 size(Rlst)=3571 -----
rank=0 GPUmem(GB): used=1.166e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.783e-03 blksize=30 blksize0=6 batchsize=3571
rank=0 GPUmem(GB): used=1.899e-03 (oper,site,rinter,batch)=1.056e-04,1.132e-06,9.835e-06,1.783e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.845e-05,4.799e-04,1.255e-04
----- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=4.8e-04 t_reduction=1.3e-04 tot=7.0e-04 -----
 renorm[inter] counter=119 t=9.8e-05 per=1.4e+01 cost=1.1e+05 flops=1.1e+09
 renorm[gemm] counter=119 i=0 t=1.8e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=119 i=1 t=1.7e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=119 i=2 t=1.4e-04 per=2.0e+01 cost=1.9e+04 flops=1.4e+08
 renorm[gemm] counter=119 i=3 t=1.8e-04 per=2.5e+01 cost=1.8e+05 flops=1.0e+09
 renorm[gemm] counter=119 i=4 t=1.7e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=119 i=5 t=1.6e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=119 i=6 t=1.6e-04 per=2.3e+01 cost=3.2e+05 flops=2.0e+09
 renorm[gemm] counter=119 total t=4.8e-04 per=6.8e+01 cost=5.2e+05 flops=1.1e+09
 renorm[red] counter=119 t=1.3e-04 per=1.8e+01 cost=8.4e+04 flops=6.7e+08
----- TIMING FOR renorm_tot : t_inter=7.4e-04 t_gemm=2.8e-03 t_reduction=8.7e-04 tot=4.5e-03 -----
 renorm_tot[inter] counter=119 t=7.4e-04 per=1.7e+01 cost=1.6e+05 flops=2.1e+08
 renorm_tot[gemm] counter=119 i=0 t=2.3e-05 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=119 i=1 t=1.8e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=119 i=2 t=1.1e-03 per=2.4e+01 cost=3.0e+04 flops=2.8e+07
 renorm_tot[gemm] counter=119 i=3 t=8.9e-04 per=2.0e+01 cost=2.8e+05 flops=3.2e+08
 renorm_tot[gemm] counter=119 i=4 t=1.8e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=119 i=5 t=1.8e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=119 i=6 t=8.0e-04 per=1.8e+01 cost=4.7e+05 flops=5.9e+08
 renorm_tot[gemm] counter=119 total t=2.8e-03 per=6.4e+01 cost=7.9e+05 flops=2.8e+08
 renorm_tot[red] counter=119 t=8.7e-04 per=1.9e+01 cost=1.3e+05 flops=1.6e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.165e-04 (oper)=1.058e-04
rank=0 GPUmem(GB): used=1.177e-04 (oper,site,rinter)=1.058e-04,1.132e-06,8.941e-07
rank=0 GPUmem(GB): used=1.284e-04 (oper,site,rinter,batch)=1.058e-04,1.132e-06,8.941e-07,1.076e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.555e-03 S T(preprocess/alloc/comp/red/dealloc)=6.548e-04,7.100e-04,1.593e-03,1.789e-04,5.300e-05 -----
----- TIMING FOR oper_renorm_opS : 2.576e-03 S rank=0 -----
qops.to_cpu: size(tot)=6142:4.686e-02MB:4.576e-05GB T(to_cpu)=4.654e-05S speed=9.834e-01GB/S
check ||H-H.dagger||=6.868e-15 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.00938 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=9.613e-04 change=1.023e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=2.411e-03 change=-2.070e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.140e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.311e-02 S #####
 T(local oper_env: fetch) = 1.729e-03 S  per = 13.2  per(accum) = 13.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(local oper_env: renrm) = 9.986e-03 S  per = 76.2  per(accum) = 89.4
 T(local oper_env: save ) = 1.393e-03 S  per = 10.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.986e-03 S  T(sum) = 9.986e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.620e-06 S  per = 0.0863  per(accum) = 0.0863
 T(local oper_env: qops init                    ) = 5.004e-04 S  per = 5.01  per(accum) = 5.1
 T(local oper_env: symbolic_formulae_renorm     ) = 3.177e-04 S  per = 3.18  per(accum) = 8.28
 T(local oper_env: allocate qops on gpu         ) = 5.281e-05 S  per = 0.529  per(accum) = 8.81
 T(local oper_env: site memcpy cpu2gpu          ) = 2.408e-05 S  per = 0.241  per(accum) = 9.05
 T(local oper_env: rintermediate init           ) = 5.384e-05 S  per = 0.539  per(accum) = 9.59
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.272e-03 S  per = 32.8  per(accum) = 42.4
 T(local oper_env: rmmtasks init                ) = 1.326e-03 S  per = 13.3  per(accum) = 55.6
 T(local oper_env: qops memset on cpu           ) = 5.200e-08 S  per = 0.000521  per(accum) = 55.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 8.966e-04 S  per = 8.98  per(accum) = 64.6
 T(local oper_env: deallocate cpu and gpu memory) = 2.089e-04 S  per = 2.09  per(accum) = 66.7
 T(local oper_env: construct opS [ifdists=true] ) = 2.632e-03 S  per = 26.4  per(accum) = 93.1
 T(local oper_env: reduction of opS & opH [nccl]) = 1.819e-05 S  per = 0.182  per(accum) = 93.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 6.033e-05 S  per = 0.604  per(accum) = 93.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.610e-05 S  per = 0.161  per(accum) = 94
 T(local oper_env: qops_pool join and erase     ) = 5.972e-04 S  per = 5.98  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.840e-07 S  per = 0.00485  per(accum) = 100
##### sweep oper_env: 1.016e-01 S #####
 T(sweep oper_env: fetch) = 2.026e-02 S  per = 19.9  per(accum) = 19.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.9
 T(sweep oper_env: renrm) = 6.770e-02 S  per = 66.6  per(accum) = 86.6
 T(sweep oper_env: save ) = 1.365e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+10 S  per = -1.736e+32
 T(sweep oper_env: preprocess                  ) = -1.736e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.770e-02 S  T(sum) = 6.770e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.595e-04 S  per = 0.236  per(accum) = 0.236
 T(sweep oper_env: qops init                    ) = 2.844e-03 S  per =  4.2  per(accum) = 4.44
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.623e-04 S  per = 1.27  per(accum) = 5.71
 T(sweep oper_env: allocate qops on gpu         ) = 5.244e-04 S  per = 0.775  per(accum) = 6.48
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.506e-04 S  per = 0.37  per(accum) = 6.85
 T(sweep oper_env: rintermediate init           ) = 4.770e-04 S  per = 0.705  per(accum) = 7.56
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.963e-03 S  per = 8.81  per(accum) = 16.4
 T(sweep oper_env: rmmtasks init                ) = 2.552e-03 S  per = 3.77  per(accum) = 20.1
 T(sweep oper_env: qops memset on cpu           ) = 4.320e-07 S  per = 0.000638  per(accum) = 20.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.160e-03 S  per =  9.1  per(accum) = 29.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.104e-04 S  per = 0.606  per(accum) = 29.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.829e-02 S  per = 56.6  per(accum) = 86.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.985e-04 S  per = 0.293  per(accum) = 86.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.866e-04 S  per = 0.571  per(accum) = 87.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.582e-04 S  per = 0.234  per(accum) = 87.5
 T(sweep oper_env: qops_pool join and erase     ) = 5.732e-03 S  per = 8.47  per(accum) = 96
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.736e-03 S  per = 4.04  per(accum) = 100

idx=11 coord=(8,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=11 scratch=./scratch/sweep size=97:7.23e-07GB T(load)=2.99e-04S speed=2.42e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:11 S:4 H:1 P:40 Q:46 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=6142:0.0469MB:4.58e-05GB
        per(mem): C:4.66 S:1.69 H:1.16 P:0 Q:92.5 
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:12 S:3 H:1 P:31 Q:36 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=4907:0.0374MB:3.66e-05GB
        per(mem): C:6.36 S:1.59 H:1.45 P:0 Q:90.6 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.097e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=80 : 2.493e-04 S -----
rank=0 GPUmem(GB): used=8.976e-05 (oper)=8.976e-05
rank=0 GPUmem(GB): used=9.048e-05 (oper,site)=8.976e-05,7.227e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=80
 no. of rintermediate operators=103
 no. of coefficients=1133:8.644e-03MB:8.442e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.149e-05 S -----
rank=0 GPUmem(GB): used=9.892e-05 (oper,site,rinter)=8.976e-05,7.227e-07,8.442e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.901e-03 S size(rtasks)=80 size(Rlst2)=49 T(Rmu/Rlist)=9.756e-05,1.803e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.068e-03 S size(rtasks)=80 size(Rlst)=2234 -----
rank=0 GPUmem(GB): used=9.892e-05 avail=3.829e+01 total=3.829e+01 batch[need]=9.321e-04 blksize=25 blksize0=5 batchsize=2234
rank=0 GPUmem(GB): used=1.031e-03 (oper,site,rinter,batch)=8.976e-05,7.227e-07,8.442e-06,9.321e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.664e-05,3.294e-04,1.005e-04
----- TIMING FOR renorm : t_inter=8.7e-05 t_gemm=3.3e-04 t_reduction=1.0e-04 tot=5.2e-04 -----
 renorm[inter] counter=127 t=8.7e-05 per=1.7e+01 cost=5.9e+04 flops=6.9e+08
 renorm[gemm] counter=127 i=0 t=1.8e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=127 i=1 t=1.6e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=127 i=2 t=1.0e-04 per=2.0e+01 cost=1.5e+04 flops=1.5e+08
 renorm[gemm] counter=127 i=3 t=1.1e-04 per=2.2e+01 cost=6.2e+04 flops=5.5e+08
 renorm[gemm] counter=127 i=4 t=1.6e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=127 i=5 t=1.7e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=127 i=6 t=1.1e-04 per=2.1e+01 cost=1.7e+05 flops=1.5e+09
 renorm[gemm] counter=127 total t=3.3e-04 per=6.4e+01 cost=2.5e+05 flops=7.5e+08
 renorm[red] counter=127 t=1.0e-04 per=1.9e+01 cost=7.6e+04 flops=7.6e+08
----- TIMING FOR renorm_tot : t_inter=8.3e-04 t_gemm=3.2e-03 t_reduction=9.7e-04 tot=5.0e-03 -----
 renorm_tot[inter] counter=127 t=8.3e-04 per=1.7e+01 cost=2.2e+05 flops=2.6e+08
 renorm_tot[gemm] counter=127 i=0 t=2.5e-05 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=127 i=1 t=1.9e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=127 i=2 t=1.2e-03 per=2.4e+01 cost=4.5e+04 flops=3.8e+07
 renorm_tot[gemm] counter=127 i=3 t=1.0e-03 per=2.0e+01 cost=3.4e+05 flops=3.4e+08
 renorm_tot[gemm] counter=127 i=4 t=2.0e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=127 i=5 t=1.9e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=127 i=6 t=9.1e-04 per=1.8e+01 cost=6.4e+05 flops=7.0e+08
 renorm_tot[gemm] counter=127 total t=3.2e-03 per=6.4e+01 cost=1.0e+06 flops=3.2e+08
 renorm_tot[red] counter=127 t=9.7e-04 per=1.9e+01 cost=2.1e+05 flops=2.2e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.913e-05 (oper)=8.995e-05
rank=0 GPUmem(GB): used=9.985e-05 (oper,site,rinter)=8.995e-05,7.227e-07,7.376e-07
rank=0 GPUmem(GB): used=1.039e-04 (oper,site,rinter,batch)=8.995e-05,7.227e-07,7.376e-07,4.053e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.995e-03 S T(preprocess/alloc/comp/red/dealloc)=3.874e-04,4.367e-04,1.195e-03,3.136e-04,3.581e-05 -----
----- TIMING FOR oper_renorm_opS : 2.019e-03 S rank=0 -----
qops.to_cpu: size(tot)=4907:3.744e-02MB:3.656e-05GB T(to_cpu)=3.974e-05S speed=9.201e-01GB/S
check ||H-H.dagger||=1.964e-18 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.00655 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=6.868e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=1.358e-03 change=-1.842e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.471e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.032e-02 S #####
 T(local oper_env: fetch) = 1.811e-03 S  per = 17.5  per(accum) = 17.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: renrm) = 7.218e-03 S  per = 69.9  per(accum) = 87.5
 T(local oper_env: save ) = 1.294e-03 S  per = 12.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.218e-03 S  T(sum) = 7.218e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.166e-06 S  per = 0.113  per(accum) = 0.113
 T(local oper_env: qops init                    ) = 4.378e-04 S  per = 6.06  per(accum) = 6.18
 T(local oper_env: symbolic_formulae_renorm     ) = 2.596e-04 S  per =  3.6  per(accum) = 9.77
 T(local oper_env: allocate qops on gpu         ) = 4.998e-05 S  per = 0.692  per(accum) = 10.5
 T(local oper_env: site memcpy cpu2gpu          ) = 2.065e-05 S  per = 0.286  per(accum) = 10.8
 T(local oper_env: rintermediate init           ) = 5.614e-05 S  per = 0.778  per(accum) = 11.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.083e-03 S  per = 28.9  per(accum) = 40.4
 T(local oper_env: rmmtasks init                ) = 7.480e-04 S  per = 10.4  per(accum) = 50.7
 T(local oper_env: qops memset on cpu           ) = 3.700e-08 S  per = 0.000513  per(accum) = 50.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 6.577e-04 S  per = 9.11  per(accum) = 59.9
 T(local oper_env: deallocate cpu and gpu memory) = 3.223e-05 S  per = 0.446  per(accum) = 60.3
 T(local oper_env: construct opS [ifdists=true] ) = 2.033e-03 S  per = 28.2  per(accum) = 88.5
 T(local oper_env: reduction of opS & opH [nccl]) = 1.006e-04 S  per = 1.39  per(accum) = 89.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.956e-05 S  per = 0.687  per(accum) = 90.5
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.083e-05 S  per = 0.289  per(accum) = 90.8
 T(local oper_env: qops_pool join and erase     ) = 6.613e-04 S  per = 9.16  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.210e-07 S  per = 0.00722  per(accum) = 100
##### sweep oper_env: 1.119e-01 S #####
 T(sweep oper_env: fetch) = 2.207e-02 S  per = 19.7  per(accum) = 19.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: renrm) = 7.492e-02 S  per = 66.9  per(accum) = 86.6
 T(sweep oper_env: save ) = 1.494e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.909e+10 S  per = -1.909e+32
 T(sweep oper_env: preprocess                  ) = -1.909e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.492e-02 S  T(sum) = 7.492e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.677e-04 S  per = 0.224  per(accum) = 0.224
 T(sweep oper_env: qops init                    ) = 3.282e-03 S  per = 4.38  per(accum) = 4.6
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.122e-03 S  per =  1.5  per(accum) = 6.1
 T(sweep oper_env: allocate qops on gpu         ) = 5.744e-04 S  per = 0.767  per(accum) = 6.87
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.713e-04 S  per = 0.362  per(accum) = 7.23
 T(sweep oper_env: rintermediate init           ) = 5.331e-04 S  per = 0.712  per(accum) = 7.94
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.046e-03 S  per = 10.7  per(accum) = 18.7
 T(sweep oper_env: rmmtasks init                ) = 3.300e-03 S  per =  4.4  per(accum) = 23.1
 T(sweep oper_env: qops memset on cpu           ) = 4.690e-07 S  per = 0.000626  per(accum) = 23.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.818e-03 S  per =  9.1  per(accum) = 32.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.427e-04 S  per = 0.591  per(accum) = 32.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.032e-02 S  per = 53.8  per(accum) = 86.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.991e-04 S  per = 0.399  per(accum) = 87
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.362e-04 S  per = 0.582  per(accum) = 87.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.790e-04 S  per = 0.239  per(accum) = 87.8
 T(sweep oper_env: qops_pool join and erase     ) = 6.394e-03 S  per = 8.53  per(accum) = 96.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.737e-03 S  per = 3.65  per(accum) = 100

idx=12 coord=(7,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=12 scratch=./scratch/sweep size=97:7.23e-07GB T(load)=3.22e-04S speed=2.24e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:12 S:3 H:1 P:31 Q:36 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=4907:0.0374MB:3.66e-05GB
        per(mem): C:6.36 S:1.59 H:1.45 P:0 Q:90.6 
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:13 S:3 H:1 P:27 Q:26 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=3698:0.0282MB:2.76e-05GB
        per(mem): C:9.14 S:2.11 H:1.92 P:0 Q:86.8 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.052e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=67 : 2.070e-04 S -----
rank=0 GPUmem(GB): used=7.155e-05 (oper)=7.155e-05
rank=0 GPUmem(GB): used=7.227e-05 (oper,site)=7.155e-05,7.227e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=67
 no. of rintermediate operators=79
 no. of coefficients=948:7.233e-03MB:7.063e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.398e-05 S -----
rank=0 GPUmem(GB): used=7.933e-05 (oper,site,rinter)=7.155e-05,7.227e-07,7.063e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.441e-03 S size(rtasks)=67 size(Rlst2)=49 T(Rmu/Rlist)=7.929e-05,1.362e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.574e-03 S size(rtasks)=67 size(Rlst)=1644 -----
rank=0 GPUmem(GB): used=7.933e-05 avail=3.829e+01 total=3.829e+01 batch[need]=6.859e-04 blksize=25 blksize0=5 batchsize=1644
rank=0 GPUmem(GB): used=7.653e-04 (oper,site,rinter,batch)=7.155e-05,7.227e-07,7.063e-06,6.859e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.402e-05,3.038e-04,1.056e-04
----- TIMING FOR renorm : t_inter=8.4e-05 t_gemm=3.0e-04 t_reduction=1.1e-04 tot=4.9e-04 -----
 renorm[inter] counter=134 t=8.4e-05 per=1.7e+01 cost=4.7e+04 flops=5.6e+08
 renorm[gemm] counter=134 i=0 t=1.8e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=134 i=1 t=1.6e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=134 i=2 t=8.8e-05 per=1.8e+01 cost=1.1e+04 flops=1.3e+08
 renorm[gemm] counter=134 i=3 t=9.9e-05 per=2.0e+01 cost=4.6e+04 flops=4.6e+08
 renorm[gemm] counter=134 i=4 t=1.7e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=134 i=5 t=1.6e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=134 i=6 t=1.1e-04 per=2.2e+01 cost=1.2e+05 flops=1.1e+09
 renorm[gemm] counter=134 total t=3.0e-04 per=6.2e+01 cost=1.8e+05 flops=5.9e+08
 renorm[red] counter=134 t=1.1e-04 per=2.1e+01 cost=5.6e+04 flops=5.3e+08
----- TIMING FOR renorm_tot : t_inter=9.1e-04 t_gemm=3.5e-03 t_reduction=1.1e-03 tot=5.5e-03 -----
 renorm_tot[inter] counter=134 t=9.1e-04 per=1.7e+01 cost=2.6e+05 flops=2.9e+08
 renorm_tot[gemm] counter=134 i=0 t=2.7e-05 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=134 i=1 t=2.1e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=134 i=2 t=1.3e-03 per=2.3e+01 cost=5.6e+04 flops=4.4e+07
 renorm_tot[gemm] counter=134 i=3 t=1.1e-03 per=2.0e+01 cost=3.9e+05 flops=3.5e+08
 renorm_tot[gemm] counter=134 i=4 t=2.2e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=134 i=5 t=2.1e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=134 i=6 t=1.0e-03 per=1.9e+01 cost=7.7e+05 flops=7.5e+08
 renorm_tot[gemm] counter=134 total t=3.5e-03 per=6.4e+01 cost=1.2e+06 flops=3.5e+08
 renorm_tot[red] counter=134 t=1.1e-03 per=2.0e+01 cost=2.7e+05 flops=2.5e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.961e-05 (oper)=7.174e-05
rank=0 GPUmem(GB): used=8.033e-05 (oper,site,rinter)=7.174e-05,7.227e-07,8.047e-07
rank=0 GPUmem(GB): used=8.439e-05 (oper,site,rinter,batch)=7.174e-05,7.227e-07,8.047e-07,4.053e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.835e-03 S T(preprocess/alloc/comp/red/dealloc)=3.957e-04,4.493e-04,1.197e-03,1.342e-04,4.147e-05 -----
----- TIMING FOR oper_renorm_opS : 1.854e-03 S rank=0 -----
qops.to_cpu: size(tot)=3698:2.821e-02MB:2.755e-05GB T(to_cpu)=3.461e-05S speed=7.961e-01GB/S
check ||H-H.dagger||=1.372e-18 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.00549 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=5.193e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=8.469e-04 change=-1.609e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.471e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 9.147e-03 S #####
 T(local oper_env: fetch) = 1.785e-03 S  per = 19.5  per(accum) = 19.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: renrm) = 6.091e-03 S  per = 66.6  per(accum) = 86.1
 T(local oper_env: save ) = 1.271e-03 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.091e-03 S  T(sum) = 6.091e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.683e-06 S  per = 0.159  per(accum) = 0.159
 T(local oper_env: qops init                    ) = 3.936e-04 S  per = 6.46  per(accum) = 6.62
 T(local oper_env: symbolic_formulae_renorm     ) = 2.174e-04 S  per = 3.57  per(accum) = 10.2
 T(local oper_env: allocate qops on gpu         ) = 5.046e-05 S  per = 0.828  per(accum) = 11
 T(local oper_env: site memcpy cpu2gpu          ) = 2.367e-05 S  per = 0.389  per(accum) = 11.4
 T(local oper_env: rintermediate init           ) = 4.617e-05 S  per = 0.758  per(accum) = 12.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.591e-03 S  per = 26.1  per(accum) = 38.3
 T(local oper_env: rmmtasks init                ) = 5.555e-04 S  per = 9.12  per(accum) = 47.4
 T(local oper_env: qops memset on cpu           ) = 3.600e-08 S  per = 0.000591  per(accum) = 47.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 6.298e-04 S  per = 10.3  per(accum) = 57.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.843e-05 S  per = 0.467  per(accum) = 58.2
 T(local oper_env: construct opS [ifdists=true] ) = 1.873e-03 S  per = 30.7  per(accum) = 89
 T(local oper_env: reduction of opS & opH [nccl]) = 1.823e-05 S  per = 0.299  per(accum) = 89.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.416e-05 S  per = 0.725  per(accum) = 90
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.019e-05 S  per = 0.331  per(accum) = 90.3
 T(local oper_env: qops_pool join and erase     ) = 5.898e-04 S  per = 9.68  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.090e-07 S  per = 0.00671  per(accum) = 100
##### sweep oper_env: 1.211e-01 S #####
 T(sweep oper_env: fetch) = 2.385e-02 S  per = 19.7  per(accum) = 19.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: renrm) = 8.101e-02 S  per = 66.9  per(accum) = 86.6
 T(sweep oper_env: save ) = 1.621e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.083e+10 S  per = -2.083e+32
 T(sweep oper_env: preprocess                  ) = -2.083e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.101e-02 S  T(sum) = 8.101e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.774e-04 S  per = 0.219  per(accum) = 0.219
 T(sweep oper_env: qops init                    ) = 3.675e-03 S  per = 4.54  per(accum) = 4.76
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.339e-03 S  per = 1.65  per(accum) = 6.41
 T(sweep oper_env: allocate qops on gpu         ) = 6.248e-04 S  per = 0.771  per(accum) = 7.18
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.950e-04 S  per = 0.364  per(accum) = 7.54
 T(sweep oper_env: rintermediate init           ) = 5.793e-04 S  per = 0.715  per(accum) = 8.26
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 9.637e-03 S  per = 11.9  per(accum) = 20.2
 T(sweep oper_env: rmmtasks init                ) = 3.855e-03 S  per = 4.76  per(accum) = 24.9
 T(sweep oper_env: qops memset on cpu           ) = 5.050e-07 S  per = 0.000623  per(accum) = 24.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.448e-03 S  per = 9.19  per(accum) = 34.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.711e-04 S  per = 0.581  per(accum) = 34.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.219e-02 S  per = 52.1  per(accum) = 86.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.173e-04 S  per = 0.392  per(accum) = 87.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.803e-04 S  per = 0.593  per(accum) = 87.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.992e-04 S  per = 0.246  per(accum) = 88
 T(sweep oper_env: qops_pool join and erase     ) = 6.983e-03 S  per = 8.62  per(accum) = 96.6
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.737e-03 S  per = 3.38  per(accum) = 100

idx=13 coord=(6,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=13 scratch=./scratch/sweep size=134:9.98e-07GB T(load)=3.22e-04S speed=3.10e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:13 S:3 H:1 P:27 Q:26 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=3698:0.0282MB:2.76e-05GB
        per(mem): C:9.14 S:2.11 H:1.92 P:0 Q:86.8 
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:14 S:2 H:1 P:18 Q:20 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=2305:0.0176MB:1.72e-05GB
        per(mem): C:13.4 S:1.91 H:2.3 P:0 Q:82.4 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.001e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=53 : 1.666e-04 S -----
rank=0 GPUmem(GB): used=5.216e-05 (oper)=5.216e-05
rank=0 GPUmem(GB): used=5.316e-05 (oper,site)=5.216e-05,9.984e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=53
 no. of rintermediate operators=58
 no. of coefficients=754:5.753e-03MB:5.618e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.541e-05 S -----
rank=0 GPUmem(GB): used=5.878e-05 (oper,site,rinter)=5.216e-05,9.984e-07,5.618e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.930e-03 S size(rtasks)=53 size(Rlst2)=49 T(Rmu/Rlist)=5.857e-05,1.871e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.103e-03 S size(rtasks)=53 size(Rlst)=2258 -----
rank=0 GPUmem(GB): used=5.878e-05 avail=3.829e+01 total=3.829e+01 batch[need]=7.739e-04 blksize=20 blksize0=5 batchsize=2258
rank=0 GPUmem(GB): used=8.327e-04 (oper,site,rinter,batch)=5.216e-05,9.984e-07,5.618e-06,7.739e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.839e-05,5.342e-04,1.479e-04
----- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=5.3e-04 t_reduction=1.5e-04 tot=7.8e-04 -----
 renorm[inter] counter=141 t=9.8e-05 per=1.3e+01 cost=7.2e+04 flops=7.4e+08
 renorm[gemm] counter=141 i=0 t=1.8e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=141 i=1 t=1.6e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=141 i=2 t=1.6e-04 per=2.0e+01 cost=1.1e+04 flops=6.9e+07
 renorm[gemm] counter=141 i=3 t=2.0e-04 per=2.6e+01 cost=7.2e+04 flops=3.6e+08
 renorm[gemm] counter=141 i=4 t=1.7e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=141 i=5 t=1.6e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=141 i=6 t=1.7e-04 per=2.2e+01 cost=1.1e+05 flops=6.5e+08
 renorm[gemm] counter=141 total t=5.3e-04 per=6.8e+01 cost=1.9e+05 flops=3.6e+08
 renorm[red] counter=141 t=1.5e-04 per=1.9e+01 cost=3.4e+04 flops=2.3e+08
----- TIMING FOR renorm_tot : t_inter=1.0e-03 t_gemm=4.0e-03 t_reduction=1.2e-03 tot=6.2e-03 -----
 renorm_tot[inter] counter=141 t=1.0e-03 per=1.6e+01 cost=3.4e+05 flops=3.3e+08
 renorm_tot[gemm] counter=141 i=0 t=2.9e-05 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=141 i=1 t=2.3e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=141 i=2 t=1.4e-03 per=2.3e+01 cost=6.7e+04 flops=4.7e+07
 renorm_tot[gemm] counter=141 i=3 t=1.3e-03 per=2.1e+01 cost=4.6e+05 flops=3.5e+08
 renorm_tot[gemm] counter=141 i=4 t=2.3e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=141 i=5 t=2.3e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=141 i=6 t=1.2e-03 per=1.9e+01 cost=8.7e+05 flops=7.4e+08
 renorm_tot[gemm] counter=141 total t=4.0e-03 per=6.4e+01 cost=1.4e+06 flops=3.5e+08
 renorm_tot[red] counter=141 t=1.2e-03 per=2.0e+01 cost=3.0e+05 flops=2.5e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.852e-05 (oper)=5.233e-05
rank=0 GPUmem(GB): used=5.952e-05 (oper,site,rinter)=5.233e-05,9.984e-07,5.811e-07
rank=0 GPUmem(GB): used=7.049e-05 (oper,site,rinter,batch)=5.233e-05,9.984e-07,5.811e-07,1.097e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.625e-03 S T(preprocess/alloc/comp/red/dealloc)=4.537e-04,5.131e-04,9.469e-04,1.202e-04,3.348e-05 -----
----- TIMING FOR oper_renorm_opS : 1.645e-03 S rank=0 -----
qops.to_cpu: size(tot)=2305:1.759e-02MB:1.717e-05GB T(to_cpu)=3.016e-05S speed=5.694e-01GB/S
check ||H-H.dagger||=1.401e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.00656 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=2.975e-04 change=6.216e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=1.595e-03 change=-1.670e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.495e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.019e-02 S #####
 T(local oper_env: fetch) = 1.733e-03 S  per =   17  per(accum) = 17
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17
 T(local oper_env: renrm) = 7.171e-03 S  per = 70.4  per(accum) = 87.4
 T(local oper_env: save ) = 1.283e-03 S  per = 12.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.171e-03 S  T(sum) = 7.171e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.600e-05 S  per = 0.223  per(accum) = 0.223
 T(local oper_env: qops init                    ) = 3.377e-04 S  per = 4.71  per(accum) = 4.93
 T(local oper_env: symbolic_formulae_renorm     ) = 1.782e-04 S  per = 2.48  per(accum) = 7.42
 T(local oper_env: allocate qops on gpu         ) = 4.917e-05 S  per = 0.686  per(accum) = 8.1
 T(local oper_env: site memcpy cpu2gpu          ) = 3.018e-05 S  per = 0.421  per(accum) = 8.52
 T(local oper_env: rintermediate init           ) = 4.840e-05 S  per = 0.675  per(accum) = 9.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.118e-03 S  per = 29.5  per(accum) = 38.7
 T(local oper_env: rmmtasks init                ) = 7.619e-04 S  per = 10.6  per(accum) = 49.4
 T(local oper_env: qops memset on cpu           ) = 3.600e-08 S  per = 0.000502  per(accum) = 49.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 9.517e-04 S  per = 13.3  per(accum) = 62.6
 T(local oper_env: deallocate cpu and gpu memory) = 5.847e-05 S  per = 0.815  per(accum) = 63.5
 T(local oper_env: construct opS [ifdists=true] ) = 1.659e-03 S  per = 23.1  per(accum) = 86.6
 T(local oper_env: reduction of opS & opH [nccl]) = 3.071e-04 S  per = 4.28  per(accum) = 90.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.022e-05 S  per = 0.561  per(accum) = 91.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.641e-05 S  per = 0.229  per(accum) = 91.7
 T(local oper_env: qops_pool join and erase     ) = 5.976e-04 S  per = 8.33  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.000e-07 S  per = 0.00697  per(accum) = 100
##### sweep oper_env: 1.313e-01 S #####
 T(sweep oper_env: fetch) = 2.559e-02 S  per = 19.5  per(accum) = 19.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: renrm) = 8.818e-02 S  per = 67.2  per(accum) = 86.7
 T(sweep oper_env: save ) = 1.750e-02 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.256e+10 S  per = -2.256e+32
 T(sweep oper_env: preprocess                  ) = -2.256e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.818e-02 S  T(sum) = 8.818e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.934e-04 S  per = 0.219  per(accum) = 0.219
 T(sweep oper_env: qops init                    ) = 4.013e-03 S  per = 4.55  per(accum) = 4.77
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.517e-03 S  per = 1.72  per(accum) = 6.49
 T(sweep oper_env: allocate qops on gpu         ) = 6.740e-04 S  per = 0.764  per(accum) = 7.26
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.251e-04 S  per = 0.369  per(accum) = 7.62
 T(sweep oper_env: rintermediate init           ) = 6.277e-04 S  per = 0.712  per(accum) = 8.34
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.175e-02 S  per = 13.3  per(accum) = 21.7
 T(sweep oper_env: rmmtasks init                ) = 4.617e-03 S  per = 5.24  per(accum) = 26.9
 T(sweep oper_env: qops memset on cpu           ) = 5.410e-07 S  per = 0.000613  per(accum) = 26.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.399e-03 S  per = 9.52  per(accum) = 36.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.296e-04 S  per = 0.601  per(accum) = 37
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.385e-02 S  per = 49.7  per(accum) = 86.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.244e-04 S  per = 0.708  per(accum) = 87.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.206e-04 S  per = 0.59  per(accum) = 88.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.156e-04 S  per = 0.245  per(accum) = 88.3
 T(sweep oper_env: qops_pool join and erase     ) = 7.581e-03 S  per =  8.6  per(accum) = 96.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.738e-03 S  per =  3.1  per(accum) = 100

idx=14 coord=(5,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=14 scratch=./scratch/sweep size=100:7.45e-07GB T(load)=3.17e-04S speed=2.35e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:14 S:2 H:1 P:18 Q:20 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=2305:0.0176MB:1.72e-05GB
        per(mem): C:13.4 S:1.91 H:2.3 P:0 Q:82.4 
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:15 S:2 H:1 P:12 Q:16 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=1433:0.0109MB:1.07e-05GB
        per(mem): C:18.8 S:2.51 H:2.72 P:0 Q:75.9 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=9.703e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=44 : 1.327e-04 S -----
rank=0 GPUmem(GB): used=3.529e-05 (oper)=3.529e-05
rank=0 GPUmem(GB): used=3.603e-05 (oper,site)=3.529e-05,7.451e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=44
 no. of rintermediate operators=44
 no. of coefficients=616:4.700e-03MB:4.590e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.401e-05 S -----
rank=0 GPUmem(GB): used=4.062e-05 (oper,site,rinter)=3.529e-05,7.451e-07,4.590e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.664e-03 S size(rtasks)=44 size(Rlst2)=49 T(Rmu/Rlist)=5.162e-05,1.613e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.803e-03 S size(rtasks)=44 size(Rlst)=1939 -----
rank=0 GPUmem(GB): used=4.062e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.190e-04 blksize=12 blksize0=4 batchsize=1939
rank=0 GPUmem(GB): used=4.596e-04 (oper,site,rinter,batch)=3.529e-05,7.451e-07,4.590e-06,4.190e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.900e-05,3.535e-04,1.331e-04
----- TIMING FOR renorm : t_inter=8.9e-05 t_gemm=3.5e-04 t_reduction=1.3e-04 tot=5.8e-04 -----
 renorm[inter] counter=146 t=8.9e-05 per=1.5e+01 cost=5.2e+04 flops=5.8e+08
 renorm[gemm] counter=146 i=0 t=1.8e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=1 t=1.6e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=2 t=1.1e-04 per=1.8e+01 cost=6.9e+03 flops=6.5e+07
 renorm[gemm] counter=146 i=3 t=1.3e-04 per=2.2e+01 cost=3.8e+04 flops=3.0e+08
 renorm[gemm] counter=146 i=4 t=1.7e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=5 t=1.6e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=6 t=1.1e-04 per=2.0e+01 cost=5.4e+04 flops=4.8e+08
 renorm[gemm] counter=146 total t=3.5e-04 per=6.1e+01 cost=9.9e+04 flops=2.8e+08
 renorm[red] counter=146 t=1.3e-04 per=2.3e+01 cost=2.0e+04 flops=1.5e+08
----- TIMING FOR renorm_tot : t_inter=1.1e-03 t_gemm=4.4e-03 t_reduction=1.4e-03 tot=6.8e-03 -----
 renorm_tot[inter] counter=146 t=1.1e-03 per=1.6e+01 cost=3.9e+05 flops=3.5e+08
 renorm_tot[gemm] counter=146 i=0 t=3.0e-05 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=1 t=2.4e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=2 t=1.5e-03 per=2.2e+01 cost=7.4e+04 flops=4.8e+07
 renorm_tot[gemm] counter=146 i=3 t=1.4e-03 per=2.1e+01 cost=5.0e+05 flops=3.5e+08
 renorm_tot[gemm] counter=146 i=4 t=2.5e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=5 t=2.4e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=6 t=1.3e-03 per=1.9e+01 cost=9.3e+05 flops=7.1e+08
 renorm_tot[gemm] counter=146 total t=4.4e-03 per=6.4e+01 cost=1.5e+06 flops=3.4e+08
 renorm_tot[red] counter=146 t=1.4e-03 per=2.0e+01 cost=3.2e+05 flops=2.4e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.064e-05 (oper)=3.542e-05
rank=0 GPUmem(GB): used=4.138e-05 (oper,site,rinter)=3.542e-05,7.451e-07,6.258e-07
rank=0 GPUmem(GB): used=5.029e-05 (oper,site,rinter,batch)=3.542e-05,7.451e-07,6.258e-07,8.911e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.122e-03 S T(preprocess/alloc/comp/red/dealloc)=3.457e-04,4.001e-04,5.773e-04,1.033e-04,3.145e-05 -----
----- TIMING FOR oper_renorm_opS : 1.139e-03 S rank=0 -----
qops.to_cpu: size(tot)=1433:1.093e-02MB:1.068e-05GB T(to_cpu)=2.670e-05S speed=3.998e-01GB/S
check ||H-H.dagger||=1.527e-17 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.00528 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=5.217e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=1.007e-03 change=-1.515e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.512e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 8.871e-03 S #####
 T(local oper_env: fetch) = 1.726e-03 S  per = 19.5  per(accum) = 19.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: renrm) = 5.865e-03 S  per = 66.1  per(accum) = 85.6
 T(local oper_env: save ) = 1.280e-03 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.865e-03 S  T(sum) = 5.865e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.550e-06 S  per = 0.129  per(accum) = 0.129
 T(local oper_env: qops init                    ) = 3.128e-04 S  per = 5.33  per(accum) = 5.46
 T(local oper_env: symbolic_formulae_renorm     ) = 1.433e-04 S  per = 2.44  per(accum) = 7.9
 T(local oper_env: allocate qops on gpu         ) = 4.916e-05 S  per = 0.838  per(accum) = 8.74
 T(local oper_env: site memcpy cpu2gpu          ) = 2.487e-05 S  per = 0.424  per(accum) = 9.17
 T(local oper_env: rintermediate init           ) = 4.449e-05 S  per = 0.759  per(accum) = 9.93
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.817e-03 S  per =   31  per(accum) = 40.9
 T(local oper_env: rmmtasks init                ) = 7.110e-04 S  per = 12.1  per(accum) = 53
 T(local oper_env: qops memset on cpu           ) = 4.900e-08 S  per = 0.000835  per(accum) = 53
 T(local oper_env: preprocess_renorm_batchGPU   ) = 7.186e-04 S  per = 12.3  per(accum) = 65.3
 T(local oper_env: deallocate cpu and gpu memory) = 2.758e-05 S  per = 0.47  per(accum) = 65.8
 T(local oper_env: construct opS [ifdists=true] ) = 1.152e-03 S  per = 19.6  per(accum) = 85.4
 T(local oper_env: reduction of opS & opH [nccl]) = 2.259e-04 S  per = 3.85  per(accum) = 89.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.628e-05 S  per = 0.619  per(accum) = 89.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.656e-05 S  per = 0.282  per(accum) = 90.2
 T(local oper_env: qops_pool join and erase     ) = 5.772e-04 S  per = 9.84  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.340e-07 S  per = 0.0074  per(accum) = 100
##### sweep oper_env: 1.401e-01 S #####
 T(sweep oper_env: fetch) = 2.731e-02 S  per = 19.5  per(accum) = 19.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: renrm) = 9.405e-02 S  per = 67.1  per(accum) = 86.6
 T(sweep oper_env: save ) = 1.878e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.430e+10 S  per = -2.430e+32
 T(sweep oper_env: preprocess                  ) = -2.430e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.405e-02 S  T(sum) = 9.405e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.009e-04 S  per = 0.214  per(accum) = 0.214
 T(sweep oper_env: qops init                    ) = 4.326e-03 S  per =  4.6  per(accum) = 4.81
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.661e-03 S  per = 1.77  per(accum) = 6.58
 T(sweep oper_env: allocate qops on gpu         ) = 7.231e-04 S  per = 0.769  per(accum) = 7.35
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.500e-04 S  per = 0.372  per(accum) = 7.72
 T(sweep oper_env: rintermediate init           ) = 6.722e-04 S  per = 0.715  per(accum) = 8.43
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.357e-02 S  per = 14.4  per(accum) = 22.9
 T(sweep oper_env: rmmtasks init                ) = 5.328e-03 S  per = 5.67  per(accum) = 28.5
 T(sweep oper_env: qops memset on cpu           ) = 5.900e-07 S  per = 0.000627  per(accum) = 28.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 9.118e-03 S  per = 9.69  per(accum) = 38.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.571e-04 S  per = 0.592  per(accum) = 38.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.501e-02 S  per = 47.9  per(accum) = 86.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.503e-04 S  per = 0.904  per(accum) = 87.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.568e-04 S  per = 0.592  per(accum) = 88.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.322e-04 S  per = 0.247  per(accum) = 88.4
 T(sweep oper_env: qops_pool join and erase     ) = 8.158e-03 S  per = 8.67  per(accum) = 97.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.738e-03 S  per = 2.91  per(accum) = 100

idx=15 coord=(4,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=15 scratch=./scratch/sweep size=72:5.36e-07GB T(load)=3.10e-04S speed=1.73e-03GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:15 S:2 H:1 P:12 Q:16 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=1433:0.0109MB:1.07e-05GB
        per(mem): C:18.8 S:2.51 H:2.72 P:0 Q:75.9 
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=742:0.00566MB:5.53e-06GB
        per(mem): C:34.5 S:4.31 H:3.23 P:0 Q:58 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.011e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=35 : 1.054e-04 S -----
rank=0 GPUmem(GB): used=2.364e-05 (oper)=2.364e-05
rank=0 GPUmem(GB): used=2.418e-05 (oper,site)=2.364e-05,5.364e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=35
 no. of rintermediate operators=28
 no. of coefficients=420:3.204e-03MB:3.129e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.366e-05 S -----
rank=0 GPUmem(GB): used=2.731e-05 (oper,site,rinter)=2.364e-05,5.364e-07,3.129e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.575e-03 S size(rtasks)=35 size(Rlst2)=81 T(Rmu/Rlist)=3.487e-05,1.540e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.696e-03 S size(rtasks)=35 size(Rlst)=1708 -----
rank=0 GPUmem(GB): used=2.731e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.036e-04 blksize=6 blksize0=3 batchsize=1708
rank=0 GPUmem(GB): used=2.309e-04 (oper,site,rinter,batch)=2.364e-05,5.364e-07,3.129e-06,2.036e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.138e-05,2.622e-04,1.148e-04
----- TIMING FOR renorm : t_inter=8.1e-05 t_gemm=2.6e-04 t_reduction=1.1e-04 tot=4.6e-04 -----
 renorm[inter] counter=149 t=8.1e-05 per=1.8e+01 cost=3.2e+04 flops=4.0e+08
 renorm[gemm] counter=149 i=0 t=1.9e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=149 i=1 t=1.6e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=149 i=2 t=7.1e-05 per=1.6e+01 cost=3.8e+03 flops=5.3e+07
 renorm[gemm] counter=149 i=3 t=8.0e-05 per=1.7e+01 cost=1.6e+04 flops=2.0e+08
 renorm[gemm] counter=149 i=4 t=1.7e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=149 i=5 t=1.6e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=149 i=6 t=1.0e-04 per=2.3e+01 cost=1.8e+04 flops=1.7e+08
 renorm[gemm] counter=149 total t=2.6e-04 per=5.7e+01 cost=3.8e+04 flops=1.5e+08
 renorm[red] counter=149 t=1.1e-04 per=2.5e+01 cost=8.4e+03 flops=7.3e+07
----- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=4.6e-03 t_reduction=1.5e-03 tot=7.3e-03 -----
 renorm_tot[inter] counter=149 t=1.2e-03 per=1.6e+01 cost=4.2e+05 flops=3.6e+08
 renorm_tot[gemm] counter=149 i=0 t=3.2e-05 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=149 i=1 t=2.6e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=149 i=2 t=1.6e-03 per=2.2e+01 cost=7.8e+04 flops=4.9e+07
 renorm_tot[gemm] counter=149 i=3 t=1.5e-03 per=2.1e+01 cost=5.2e+05 flops=3.4e+08
 renorm_tot[gemm] counter=149 i=4 t=2.7e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=149 i=5 t=2.6e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=149 i=6 t=1.4e-03 per=1.9e+01 cost=9.5e+05 flops=6.7e+08
 renorm_tot[gemm] counter=149 total t=4.6e-03 per=6.4e+01 cost=1.5e+06 flops=3.3e+08
 renorm_tot[red] counter=149 t=1.5e-03 per=2.0e+01 cost=3.3e+05 flops=2.2e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.756e-05 (oper)=2.376e-05
rank=0 GPUmem(GB): used=2.810e-05 (oper,site,rinter)=2.376e-05,5.364e-07,6.706e-07
rank=0 GPUmem(GB): used=3.361e-05 (oper,site,rinter,batch)=2.376e-05,5.364e-07,6.706e-07,5.513e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.440e-03 S T(preprocess/alloc/comp/red/dealloc)=4.525e-04,5.054e-04,8.095e-04,7.997e-05,3.641e-05 -----
----- TIMING FOR oper_renorm_opS : 1.458e-03 S rank=0 -----
qops.to_cpu: size(tot)=742:5.661e-03MB:5.528e-06GB T(to_cpu)=2.276e-05S speed=2.428e-01GB/S
check ||H-H.dagger||=6.939e-18 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.00502 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=4.514e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=7.401e-04 change=-1.412e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 8.627e-03 S #####
 T(local oper_env: fetch) = 1.745e-03 S  per = 20.2  per(accum) = 20.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.2
 T(local oper_env: renrm) = 5.599e-03 S  per = 64.9  per(accum) = 85.1
 T(local oper_env: save ) = 1.283e-03 S  per = 14.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.599e-03 S  T(sum) = 5.599e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.376e-05 S  per = 0.246  per(accum) = 0.246
 T(local oper_env: qops init                    ) = 3.589e-04 S  per = 6.41  per(accum) = 6.66
 T(local oper_env: symbolic_formulae_renorm     ) = 1.151e-04 S  per = 2.05  per(accum) = 8.71
 T(local oper_env: allocate qops on gpu         ) = 4.904e-05 S  per = 0.876  per(accum) = 9.59
 T(local oper_env: site memcpy cpu2gpu          ) = 2.046e-05 S  per = 0.365  per(accum) = 9.95
 T(local oper_env: rintermediate init           ) = 4.781e-05 S  per = 0.854  per(accum) = 10.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.709e-03 S  per = 30.5  per(accum) = 41.3
 T(local oper_env: rmmtasks init                ) = 5.436e-04 S  per = 9.71  per(accum) = 51
 T(local oper_env: qops memset on cpu           ) = 6.600e-08 S  per = 0.00118  per(accum) = 51
 T(local oper_env: preprocess_renorm_batchGPU   ) = 6.032e-04 S  per = 10.8  per(accum) = 61.8
 T(local oper_env: deallocate cpu and gpu memory) = 2.621e-05 S  per = 0.468  per(accum) = 62.3
 T(local oper_env: construct opS [ifdists=true] ) = 1.479e-03 S  per = 26.4  per(accum) = 88.7
 T(local oper_env: reduction of opS & opH [nccl]) = 1.790e-05 S  per = 0.32  per(accum) = 89
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.234e-05 S  per = 0.577  per(accum) = 89.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.166e-05 S  per = 0.387  per(accum) = 90
 T(local oper_env: qops_pool join and erase     ) = 5.614e-04 S  per =   10  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.900e-07 S  per = 0.00875  per(accum) = 100
##### sweep oper_env: 1.488e-01 S #####
 T(sweep oper_env: fetch) = 2.906e-02 S  per = 19.5  per(accum) = 19.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: renrm) = 9.965e-02 S  per =   67  per(accum) = 86.5
 T(sweep oper_env: save ) = 2.006e-02 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.604e+10 S  per = -2.604e+32
 T(sweep oper_env: preprocess                  ) = -2.604e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.965e-02 S  T(sum) = 9.965e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.147e-04 S  per = 0.215  per(accum) = 0.215
 T(sweep oper_env: qops init                    ) = 4.685e-03 S  per =  4.7  per(accum) = 4.92
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.776e-03 S  per = 1.78  per(accum) = 6.7
 T(sweep oper_env: allocate qops on gpu         ) = 7.722e-04 S  per = 0.775  per(accum) = 7.47
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.705e-04 S  per = 0.372  per(accum) = 7.85
 T(sweep oper_env: rintermediate init           ) = 7.200e-04 S  per = 0.723  per(accum) = 8.57
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.528e-02 S  per = 15.3  per(accum) = 23.9
 T(sweep oper_env: rmmtasks init                ) = 5.872e-03 S  per = 5.89  per(accum) = 29.8
 T(sweep oper_env: qops memset on cpu           ) = 6.560e-07 S  per = 0.000658  per(accum) = 29.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 9.721e-03 S  per = 9.76  per(accum) = 39.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.833e-04 S  per = 0.585  per(accum) = 40.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.648e-02 S  per = 46.6  per(accum) = 86.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.682e-04 S  per = 0.871  per(accum) = 87.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.892e-04 S  per = 0.591  per(accum) = 88.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.539e-04 S  per = 0.255  per(accum) = 88.5
 T(sweep oper_env: qops_pool join and erase     ) = 8.719e-03 S  per = 8.75  per(accum) = 97.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.739e-03 S  per = 2.75  per(accum) = 100

idx=16 coord=(3,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=16 scratch=./scratch/sweep size=42:3.13e-07GB T(load)=3.20e-04S speed=9.77e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=742:0.00566MB:5.53e-06GB
        per(mem): C:34.5 S:4.31 H:3.23 P:0 Q:58 
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:17 S:1 H:1 P:4 Q:7 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=319:0.00243MB:2.38e-06GB
        per(mem): C:53.3 S:3.13 H:3.45 P:0 Q:40.1 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.053e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=29 : 8.116e-05 S -----
rank=0 GPUmem(GB): used=1.534e-05 (oper)=1.534e-05
rank=0 GPUmem(GB): used=1.565e-05 (oper,site)=1.534e-05,3.129e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=29
 no. of rintermediate operators=18
 no. of coefficients=288:2.197e-03MB:2.146e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.680e-05 S -----
rank=0 GPUmem(GB): used=1.780e-05 (oper,site,rinter)=1.534e-05,3.129e-07,2.146e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.736e-03 S size(rtasks)=29 size(Rlst2)=121 T(Rmu/Rlist)=2.724e-05,1.708e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.860e-03 S size(rtasks)=29 size(Rlst)=1779 -----
rank=0 GPUmem(GB): used=1.780e-05 avail=3.829e+01 total=3.829e+01 batch[need]=9.278e-05 blksize=2 blksize0=2 batchsize=1779
rank=0 GPUmem(GB): used=1.106e-04 (oper,site,rinter,batch)=1.534e-05,3.129e-07,2.146e-06,9.278e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.046e-05,2.036e-04,1.017e-04
----- TIMING FOR renorm : t_inter=8.0e-05 t_gemm=2.0e-04 t_reduction=1.0e-04 tot=3.9e-04 -----
 renorm[inter] counter=154 t=8.0e-05 per=2.1e+01 cost=2.0e+04 flops=2.5e+08
 renorm[gemm] counter=154 i=0 t=1.8e-06 per=4.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=154 i=1 t=1.6e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=154 i=2 t=6.3e-05 per=1.6e+01 cost=1.5e+03 flops=2.4e+07
 renorm[gemm] counter=154 i=3 t=6.8e-05 per=1.8e+01 cost=5.3e+03 flops=7.7e+07
 renorm[gemm] counter=154 i=4 t=2.0e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=154 i=5 t=2.1e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=154 i=6 t=6.5e-05 per=1.7e+01 cost=5.1e+03 flops=7.9e+07
 renorm[gemm] counter=154 total t=2.0e-04 per=5.3e+01 cost=1.2e+04 flops=5.8e+07
 renorm[red] counter=154 t=1.0e-04 per=2.6e+01 cost=3.6e+03 flops=3.5e+07
----- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=4.8e-03 t_reduction=1.6e-03 tot=7.7e-03 -----
 renorm_tot[inter] counter=154 t=1.3e-03 per=1.6e+01 cost=4.4e+05 flops=3.5e+08
 renorm_tot[gemm] counter=154 i=0 t=3.4e-05 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=154 i=1 t=2.8e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=154 i=2 t=1.7e-03 per=2.2e+01 cost=7.9e+04 flops=4.8e+07
 renorm_tot[gemm] counter=154 i=3 t=1.6e-03 per=2.1e+01 cost=5.2e+05 flops=3.3e+08
 renorm_tot[gemm] counter=154 i=4 t=2.9e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=154 i=5 t=2.8e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=154 i=6 t=1.5e-03 per=1.9e+01 cost=9.5e+05 flops=6.5e+08
 renorm_tot[gemm] counter=154 total t=4.8e-03 per=6.3e+01 cost=1.6e+06 flops=3.2e+08
 renorm_tot[red] counter=154 t=1.6e-03 per=2.0e+01 cost=3.3e+05 flops=2.1e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.792e-05 (oper)=1.542e-05
rank=0 GPUmem(GB): used=1.823e-05 (oper,site,rinter)=1.542e-05,3.129e-07,3.576e-07
rank=0 GPUmem(GB): used=2.595e-05 (oper,site,rinter,batch)=1.542e-05,3.129e-07,3.576e-07,7.719e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.626e-04 S T(preprocess/alloc/comp/red/dealloc)=3.406e-04,3.935e-04,2.697e-04,6.615e-05,2.688e-05 -----
----- TIMING FOR oper_renorm_opS : 7.769e-04 S rank=0 -----
qops.to_cpu: size(tot)=319:2.434e-03MB:2.377e-06GB T(to_cpu)=2.161e-05S speed=1.100e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0044 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=4.469e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=3.891e-04 change=-1.442e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-2.898e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 8.098e-03 S #####
 T(local oper_env: fetch) = 1.784e-03 S  per =   22  per(accum) = 22
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: renrm) = 5.003e-03 S  per = 61.8  per(accum) = 83.8
 T(local oper_env: save ) = 1.311e-03 S  per = 16.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.003e-03 S  T(sum) = 5.003e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 4.313e-05 S  per = 0.862  per(accum) = 0.862
 T(local oper_env: qops init                    ) = 4.222e-04 S  per = 8.44  per(accum) = 9.3
 T(local oper_env: symbolic_formulae_renorm     ) = 9.076e-05 S  per = 1.81  per(accum) = 11.1
 T(local oper_env: allocate qops on gpu         ) = 4.636e-05 S  per = 0.927  per(accum) = 12
 T(local oper_env: site memcpy cpu2gpu          ) = 2.532e-05 S  per = 0.506  per(accum) = 12.5
 T(local oper_env: rintermediate init           ) = 3.934e-05 S  per = 0.786  per(accum) = 13.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.874e-03 S  per = 37.5  per(accum) = 50.8
 T(local oper_env: rmmtasks init                ) = 4.743e-04 S  per = 9.48  per(accum) = 60.3
 T(local oper_env: qops memset on cpu           ) = 4.000e-08 S  per = 0.000799  per(accum) = 60.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 5.360e-04 S  per = 10.7  per(accum) = 71
 T(local oper_env: deallocate cpu and gpu memory) = 2.512e-05 S  per = 0.502  per(accum) = 71.5
 T(local oper_env: construct opS [ifdists=true] ) = 7.882e-04 S  per = 15.8  per(accum) = 87.2
 T(local oper_env: reduction of opS & opH [nccl]) = 1.884e-05 S  per = 0.376  per(accum) = 87.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.080e-05 S  per = 0.616  per(accum) = 88.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 3.111e-05 S  per = 0.622  per(accum) = 88.9
 T(local oper_env: qops_pool join and erase     ) = 5.571e-04 S  per = 11.1  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.050e-07 S  per = 0.00809  per(accum) = 100
##### sweep oper_env: 1.569e-01 S #####
 T(sweep oper_env: fetch) = 3.084e-02 S  per = 19.7  per(accum) = 19.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.7
 T(sweep oper_env: renrm) = 1.047e-01 S  per = 66.7  per(accum) = 86.4
 T(sweep oper_env: save ) = 2.137e-02 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.777e+10 S  per = -2.777e+32
 T(sweep oper_env: preprocess                  ) = -2.777e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.047e-01 S  T(sum) = 1.047e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.578e-04 S  per = 0.246  per(accum) = 0.246
 T(sweep oper_env: qops init                    ) = 5.107e-03 S  per = 4.88  per(accum) = 5.13
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.867e-03 S  per = 1.78  per(accum) = 6.91
 T(sweep oper_env: allocate qops on gpu         ) = 8.185e-04 S  per = 0.782  per(accum) = 7.69
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.958e-04 S  per = 0.378  per(accum) = 8.07
 T(sweep oper_env: rintermediate init           ) = 7.593e-04 S  per = 0.726  per(accum) = 8.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.716e-02 S  per = 16.4  per(accum) = 25.2
 T(sweep oper_env: rmmtasks init                ) = 6.346e-03 S  per = 6.06  per(accum) = 31.3
 T(sweep oper_env: qops memset on cpu           ) = 6.960e-07 S  per = 0.000665  per(accum) = 31.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.026e-02 S  per =  9.8  per(accum) = 41.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.085e-04 S  per = 0.581  per(accum) = 41.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.727e-02 S  per = 45.2  per(accum) = 86.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.870e-04 S  per = 0.848  per(accum) = 87.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.200e-04 S  per = 0.592  per(accum) = 88.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.850e-04 S  per = 0.272  per(accum) = 88.5
 T(sweep oper_env: qops_pool join and erase     ) = 9.277e-03 S  per = 8.86  per(accum) = 97.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.739e-03 S  per = 2.62  per(accum) = 100

idx=17 coord=(2,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=17 scratch=./scratch/sweep size=16:1.19e-07GB T(load)=3.17e-04S speed=3.76e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:17 S:1 H:1 P:4 Q:7 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=319:0.00243MB:2.38e-06GB
        per(mem): C:53.3 S:3.13 H:3.45 P:0 Q:40.1 
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:18 S:1 H:1 P:1 Q:4 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=48:0.000366MB:3.58e-07GB
        per(mem): C:0 S:0 H:12.5 P:0 Q:87.5 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.808e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 5.572e-05 S -----
rank=0 GPUmem(GB): used=1.017e-05 (oper)=1.017e-05
rank=0 GPUmem(GB): used=1.029e-05 (oper,site)=1.017e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=24
 no. of rintermediate operators=9
 no. of coefficients=153:1.167e-03MB:1.140e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.643e-05 S -----
rank=0 GPUmem(GB): used=1.143e-05 (oper,site,rinter)=1.017e-05,1.192e-07,1.140e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.822e-04 S size(rtasks)=24 size(Rlst2)=36 T(Rmu/Rlist)=2.159e-05,5.606e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.328e-04 S size(rtasks)=24 size(Rlst)=610 -----
rank=0 GPUmem(GB): used=1.143e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.818e-05 blksize=1 blksize0=1 batchsize=610
rank=0 GPUmem(GB): used=2.961e-05 (oper,site,rinter,batch)=1.017e-05,1.192e-07,1.140e-06,1.818e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.189e-05,1.483e-04,6.978e-05
----- TIMING FOR renorm : t_inter=7.2e-05 t_gemm=1.5e-04 t_reduction=7.0e-05 tot=2.9e-04 -----
 renorm[inter] counter=156 t=7.2e-05 per=2.5e+01 cost=3.9e+03 flops=5.5e+07
 renorm[gemm] counter=156 i=0 t=1.7e-06 per=6.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=156 i=1 t=1.6e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=156 i=2 t=4.9e-05 per=1.7e+01 cost=3.6e+02 flops=7.4e+06
 renorm[gemm] counter=156 i=3 t=4.6e-05 per=1.6e+01 cost=6.6e+02 flops=1.4e+07
 renorm[gemm] counter=156 i=4 t=1.7e-06 per=5.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=156 i=5 t=1.6e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=156 i=6 t=4.7e-05 per=1.6e+01 cost=1.2e+03 flops=2.6e+07
 renorm[gemm] counter=156 total t=1.5e-04 per=5.1e+01 cost=2.2e+03 flops=1.5e+07
 renorm[red] counter=156 t=7.0e-05 per=2.4e+01 cost=1.2e+03 flops=1.8e+07
----- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=5.0e-03 t_reduction=1.6e-03 tot=8.0e-03 -----
 renorm_tot[inter] counter=156 t=1.3e-03 per=1.7e+01 cost=4.5e+05 flops=3.3e+08
 renorm_tot[gemm] counter=156 i=0 t=3.6e-05 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=156 i=1 t=2.9e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=156 i=2 t=1.7e-03 per=2.2e+01 cost=8.0e+04 flops=4.7e+07
 renorm_tot[gemm] counter=156 i=3 t=1.6e-03 per=2.0e+01 cost=5.2e+05 flops=3.2e+08
 renorm_tot[gemm] counter=156 i=4 t=3.0e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=156 i=5 t=2.9e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=156 i=6 t=1.5e-03 per=1.9e+01 cost=9.5e+05 flops=6.3e+08
 renorm_tot[gemm] counter=156 total t=5.0e-03 per=6.3e+01 cost=1.6e+06 flops=3.1e+08
 renorm_tot[red] counter=156 t=1.6e-03 per=2.1e+01 cost=3.3e+05 flops=2.0e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 7.2e-05 S rank=0 -----
qops.to_cpu: size(tot)=48:3.7e-04MB:3.6e-07GB T(to_cpu)=1.9e-05S speed=1.9e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00186 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.701e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=3.281e-04 change=-1.196e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.885e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 5.527e-03 S #####
 T(local oper_env: fetch) = 1.762e-03 S  per = 31.9  per(accum) = 31.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 31.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 31.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 31.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 31.9
 T(local oper_env: renrm) = 2.457e-03 S  per = 44.5  per(accum) = 76.4
 T(local oper_env: save ) = 1.307e-03 S  per = 23.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.457e-03 S  T(sum) = 2.457e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.533e-05 S  per = 0.624  per(accum) = 0.624
 T(local oper_env: qops init                    ) = 2.434e-04 S  per =  9.9  per(accum) = 10.5
 T(local oper_env: symbolic_formulae_renorm     ) = 6.516e-05 S  per = 2.65  per(accum) = 13.2
 T(local oper_env: allocate qops on gpu         ) = 4.285e-05 S  per = 1.74  per(accum) = 14.9
 T(local oper_env: site memcpy cpu2gpu          ) = 2.493e-05 S  per = 1.01  per(accum) = 15.9
 T(local oper_env: rintermediate init           ) = 3.832e-05 S  per = 1.56  per(accum) = 17.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.421e-04 S  per = 26.1  per(accum) = 43.6
 T(local oper_env: rmmtasks init                ) = 1.825e-04 S  per = 7.43  per(accum) = 51.1
 T(local oper_env: qops memset on cpu           ) = 3.600e-08 S  per = 0.00146  per(accum) = 51.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.364e-04 S  per = 17.8  per(accum) = 68.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.967e-05 S  per =  0.8  per(accum) = 69.6
 T(local oper_env: construct opS [ifdists=true] ) = 8.837e-05 S  per =  3.6  per(accum) = 73.2
 T(local oper_env: reduction of opS & opH [nccl]) = 2.521e-05 S  per = 1.03  per(accum) = 74.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.846e-05 S  per = 1.16  per(accum) = 75.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.054e-05 S  per = 0.836  per(accum) = 76.2
 T(local oper_env: qops_pool join and erase     ) = 5.837e-04 S  per = 23.8  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.630e-07 S  per = 0.0188  per(accum) = 100
##### sweep oper_env: 1.624e-01 S #####
 T(sweep oper_env: fetch) = 3.260e-02 S  per = 20.1  per(accum) = 20.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(sweep oper_env: renrm) = 1.071e-01 S  per =   66  per(accum) = 86
 T(sweep oper_env: save ) = 2.268e-02 S  per =   14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.951e+10 S  per = -2.951e+32
 T(sweep oper_env: preprocess                  ) = -2.951e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.071e-01 S  T(sum) = 1.071e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.731e-04 S  per = 0.255  per(accum) = 0.255
 T(sweep oper_env: qops init                    ) = 5.350e-03 S  per =    5  per(accum) = 5.25
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.932e-03 S  per =  1.8  per(accum) = 7.05
 T(sweep oper_env: allocate qops on gpu         ) = 8.614e-04 S  per = 0.804  per(accum) = 7.86
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.207e-04 S  per = 0.393  per(accum) = 8.25
 T(sweep oper_env: rintermediate init           ) = 7.977e-04 S  per = 0.745  per(accum) = 9
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.780e-02 S  per = 16.6  per(accum) = 25.6
 T(sweep oper_env: rmmtasks init                ) = 6.528e-03 S  per =  6.1  per(accum) = 31.7
 T(sweep oper_env: qops memset on cpu           ) = 7.320e-07 S  per = 0.000683  per(accum) = 31.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.069e-02 S  per = 9.98  per(accum) = 41.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.281e-04 S  per = 0.586  per(accum) = 42.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.736e-02 S  per = 44.2  per(accum) = 86.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.122e-04 S  per = 0.852  per(accum) = 87.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.484e-04 S  per = 0.605  per(accum) = 88
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.055e-04 S  per = 0.285  per(accum) = 88.2
 T(sweep oper_env: qops_pool join and erase     ) = 9.860e-03 S  per = 9.21  per(accum) = 97.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.740e-03 S  per = 2.56  per(accum) = 100

idx=18 coord=(1,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=18 scratch=./scratch/sweep size=6:4.47e-08GB T(load)=3.14e-04S speed=1.42e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:18 S:1 H:1 P:1 Q:4 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=48:0.000366MB:3.58e-07GB
        per(mem): C:0 S:0 H:12.5 P:0 Q:87.5 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:19 S:0 H:1 P:0 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): C:0 H:22.2 Q:77.8 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.639e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=22 : 3.911e-05 S -----
rank=0 GPUmem(GB): used=7.994e-06 (oper)=7.994e-06
rank=0 GPUmem(GB): used=8.039e-06 (oper,site)=7.994e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=22
 no. of rintermediate operators=4
 no. of coefficients=72:5.493e-04MB:5.364e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.827e-05 S -----
rank=0 GPUmem(GB): used=8.576e-06 (oper,site,rinter)=7.994e-06,4.470e-08,5.364e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 8.660e-05 S size(rtasks)=22 size(Rlst2)=36 T(Rmu/Rlist)=1.700e-05,6.956e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.707e-05 S size(rtasks)=22 size(Rlst)=51 -----
rank=0 GPUmem(GB): used=8.576e-06 avail=3.829e+01 total=3.829e+01 batch[need]=1.140e-06 blksize=1 blksize0=0 batchsize=51
rank=0 GPUmem(GB): used=9.716e-06 (oper,site,rinter,batch)=7.994e-06,4.470e-08,5.364e-07,1.140e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.702e-06,1.585e-04,5.506e-05
----- TIMING FOR renorm : t_inter=5.6e-06 t_gemm=1.6e-04 t_reduction=5.5e-05 tot=2.2e-04 -----
 renorm[inter] counter=157 t=5.6e-06 per=2.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=157 i=0 t=2.2e-06 per=1.0e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=157 i=1 t=1.7e-06 per=7.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=157 i=2 t=6.2e-05 per=2.8e+01 cost=1.2e+01 flops=1.9e+05
 renorm[gemm] counter=157 i=3 t=4.6e-05 per=2.1e+01 cost=5.4e+01 flops=1.2e+06
 renorm[gemm] counter=157 i=4 t=1.7e-06 per=7.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=157 i=5 t=1.6e-06 per=7.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=157 i=6 t=4.3e-05 per=2.0e+01 cost=1.0e+02 flops=2.4e+06
 renorm[gemm] counter=157 total t=1.6e-04 per=7.2e+01 cost=1.7e+02 flops=1.1e+06
 renorm[red] counter=157 t=5.5e-05 per=2.5e+01 cost=1.0e+02 flops=1.9e+06
----- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=5.1e-03 t_reduction=1.7e-03 tot=8.2e-03 -----
 renorm_tot[inter] counter=157 t=1.3e-03 per=1.6e+01 cost=4.5e+05 flops=3.3e+08
 renorm_tot[gemm] counter=157 i=0 t=3.8e-05 per=4.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=157 i=1 t=3.1e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=157 i=2 t=1.8e-03 per=2.2e+01 cost=8.0e+04 flops=4.5e+07
 renorm_tot[gemm] counter=157 i=3 t=1.7e-03 per=2.0e+01 cost=5.2e+05 flops=3.1e+08
 renorm_tot[gemm] counter=157 i=4 t=3.2e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=157 i=5 t=3.1e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=157 i=6 t=1.6e-03 per=1.9e+01 cost=9.5e+05 flops=6.1e+08
 renorm_tot[gemm] counter=157 total t=5.1e-03 per=6.3e+01 cost=1.6e+06 flops=3.0e+08
 renorm_tot[red] counter=157 t=1.7e-03 per=2.1e+01 cost=3.3e+05 flops=2.0e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 1.7e-05 S rank=0 -----
qops.to_cpu: size(tot)=27:2.1e-04MB:2.0e-07GB T(to_cpu)=1.7e-05S speed=1.2e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00101 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=3.234e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-8.945e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.013e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 4.539e-03 S #####
 T(local oper_env: fetch) = 1.730e-03 S  per = 38.1  per(accum) = 38.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 38.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 38.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 38.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 38.1
 T(local oper_env: renrm) = 1.530e-03 S  per = 33.7  per(accum) = 71.8
 T(local oper_env: save ) = 1.279e-03 S  per = 28.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.530e-03 S  T(sum) = 1.530e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.284e-06 S  per = 0.476  per(accum) = 0.476
 T(local oper_env: qops init                    ) = 2.277e-04 S  per = 14.9  per(accum) = 15.4
 T(local oper_env: symbolic_formulae_renorm     ) = 4.849e-05 S  per = 3.17  per(accum) = 18.5
 T(local oper_env: allocate qops on gpu         ) = 4.281e-05 S  per =  2.8  per(accum) = 21.3
 T(local oper_env: site memcpy cpu2gpu          ) = 2.116e-05 S  per = 1.38  per(accum) = 22.7
 T(local oper_env: rintermediate init           ) = 4.283e-05 S  per =  2.8  per(accum) = 25.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.013e-04 S  per = 6.62  per(accum) = 32.1
 T(local oper_env: rmmtasks init                ) = 5.375e-05 S  per = 3.51  per(accum) = 35.6
 T(local oper_env: qops memset on cpu           ) = 4.100e-08 S  per = 0.00268  per(accum) = 35.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.625e-04 S  per = 23.7  per(accum) = 59.3
 T(local oper_env: deallocate cpu and gpu memory) = 1.587e-05 S  per = 1.04  per(accum) = 60.4
 T(local oper_env: construct opS [ifdists=true] ) = 3.225e-05 S  per = 2.11  per(accum) = 62.5
 T(local oper_env: reduction of opS & opH [nccl]) = 2.423e-05 S  per = 1.58  per(accum) = 64.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.697e-05 S  per = 1.76  per(accum) = 65.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.389e-05 S  per = 0.908  per(accum) = 66.7
 T(local oper_env: qops_pool join and erase     ) = 5.087e-04 S  per = 33.2  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 3.620e-07 S  per = 0.0237  per(accum) = 100
##### sweep oper_env: 1.669e-01 S #####
 T(sweep oper_env: fetch) = 3.433e-02 S  per = 20.6  per(accum) = 20.6
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: renrm) = 1.086e-01 S  per = 65.1  per(accum) = 85.6
 T(sweep oper_env: save ) = 2.396e-02 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.124e+10 S  per = -3.124e+32
 T(sweep oper_env: preprocess                  ) = -3.124e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.086e-01 S  T(sum) = 1.086e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.804e-04 S  per = 0.258  per(accum) = 0.258
 T(sweep oper_env: qops init                    ) = 5.578e-03 S  per = 5.13  per(accum) = 5.39
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.980e-03 S  per = 1.82  per(accum) = 7.22
 T(sweep oper_env: allocate qops on gpu         ) = 9.042e-04 S  per = 0.832  per(accum) = 8.05
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.419e-04 S  per = 0.407  per(accum) = 8.45
 T(sweep oper_env: rintermediate init           ) = 8.405e-04 S  per = 0.774  per(accum) = 9.23
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.790e-02 S  per = 16.5  per(accum) = 25.7
 T(sweep oper_env: rmmtasks init                ) = 6.582e-03 S  per = 6.06  per(accum) = 31.8
 T(sweep oper_env: qops memset on cpu           ) = 7.730e-07 S  per = 0.000712  per(accum) = 31.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.106e-02 S  per = 10.2  per(accum) = 41.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.440e-04 S  per = 0.593  per(accum) = 42.5
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.739e-02 S  per = 43.6  per(accum) = 86.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.365e-04 S  per = 0.862  per(accum) = 87
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.754e-04 S  per = 0.622  per(accum) = 87.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.194e-04 S  per = 0.294  per(accum) = 87.9
 T(sweep oper_env: qops_pool join and erase     ) = 1.037e-02 S  per = 9.54  per(accum) = 97.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.740e-03 S  per = 2.52  per(accum) = 100

idx=19 coord=(0,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=1:7.63e-06MB:7.45e-09GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=19 scratch=./scratch/sweep size=6:4.47e-08GB T(load)=2.81e-04S speed=1.59e-04GB/S
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:7.61e-03MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:19 S:0 H:1 P:0 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): C:0 H:22.2 Q:77.8 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:20 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=6,6 size(op)=6:4.58e-05MB size(tot)=6:4.58e-05MB:4.47e-08GB
        per(mem): C:0 H:100 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.606e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=21 : 2.195e-05 S -----
rank=0 GPUmem(GB): used=7.682e-06 (oper)=7.682e-06
rank=0 GPUmem(GB): used=7.726e-06 (oper,site)=7.682e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=7.726e-06 (oper,site,rinter)=7.682e-06,4.470e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 7.100e-05 S size(rtasks)=21 size(Rlst2)=36 T(Rmu/Rlist)=1.479e-05,5.617e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.193e-05 S size(rtasks)=21 size(Rlst)=36 -----
rank=0 GPUmem(GB): used=7.726e-06 avail=3.829e+01 total=3.829e+01 batch[need]=8.047e-07 blksize=1 blksize0=0 batchsize=36
rank=0 GPUmem(GB): used=8.531e-06 (oper,site,rinter,batch)=7.682e-06,4.470e-08,0.000e+00,8.047e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.669e-06,1.618e-04,5.142e-05
----- TIMING FOR renorm : t_inter=5.6e-06 t_gemm=1.6e-04 t_reduction=5.1e-05 tot=2.2e-04 -----
 renorm[inter] counter=158 t=5.6e-06 per=2.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=158 i=0 t=2.1e-06 per=9.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=158 i=1 t=1.8e-06 per=8.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=158 i=2 t=6.7e-05 per=3.1e+01 cost=2.4e+01 flops=3.6e+05
 renorm[gemm] counter=158 i=3 t=4.5e-05 per=2.0e+01 cost=2.4e+01 flops=5.4e+05
 renorm[gemm] counter=158 i=4 t=1.7e-06 per=7.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=158 i=5 t=1.6e-06 per=7.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=158 i=6 t=4.3e-05 per=2.0e+01 cost=7.2e+01 flops=1.7e+06
 renorm[gemm] counter=158 total t=1.6e-04 per=7.4e+01 cost=1.2e+02 flops=7.4e+05
 renorm[red] counter=158 t=5.1e-05 per=2.3e+01 cost=7.2e+01 flops=1.4e+06
----- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=5.3e-03 t_reduction=1.7e-03 tot=8.4e-03 -----
 renorm_tot[inter] counter=158 t=1.3e-03 per=1.6e+01 cost=4.5e+05 flops=3.3e+08
 renorm_tot[gemm] counter=158 i=0 t=4.0e-05 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=158 i=1 t=3.3e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=158 i=2 t=1.8e-03 per=2.2e+01 cost=8.0e+04 flops=4.3e+07
 renorm_tot[gemm] counter=158 i=3 t=1.7e-03 per=2.0e+01 cost=5.2e+05 flops=3.0e+08
 renorm_tot[gemm] counter=158 i=4 t=3.4e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=158 i=5 t=3.3e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=158 i=6 t=1.6e-03 per=1.9e+01 cost=9.5e+05 flops=5.9e+08
 renorm_tot[gemm] counter=158 total t=5.3e-03 per=6.3e+01 cost=1.6e+06 flops=2.9e+08
 renorm_tot[red] counter=158 t=1.7e-03 per=2.1e+01 cost=3.3e+05 flops=1.9e+08
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 2.0e-06 S rank=0 -----
qops.to_cpu: size(tot)=6:4.6e-05MB:4.5e-08GB T(to_cpu)=1.6e-05S speed=2.7e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.000971 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=2.122e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-8.748e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.013e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 5.323e-03 S #####
 T(local oper_env: fetch) = 2.621e-03 S  per = 49.2  per(accum) = 49.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 49.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 49.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 49.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 49.2
 T(local oper_env: renrm) = 1.480e-03 S  per = 27.8  per(accum) = 77.1
 T(local oper_env: save ) = 1.221e-03 S  per = 22.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.480e-03 S  T(sum) = 1.480e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.109e-06 S  per = 0.48  per(accum) = 0.48
 T(local oper_env: qops init                    ) = 2.248e-04 S  per = 15.2  per(accum) = 15.7
 T(local oper_env: symbolic_formulae_renorm     ) = 3.080e-05 S  per = 2.08  per(accum) = 17.7
 T(local oper_env: allocate qops on gpu         ) = 4.550e-05 S  per = 3.07  per(accum) = 20.8
 T(local oper_env: site memcpy cpu2gpu          ) = 2.803e-05 S  per = 1.89  per(accum) = 22.7
 T(local oper_env: rintermediate init           ) = 2.530e-05 S  per = 1.71  per(accum) = 24.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 8.618e-05 S  per = 5.82  per(accum) = 30.2
 T(local oper_env: rmmtasks init                ) = 4.502e-05 S  per = 3.04  per(accum) = 33.3
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 0.00203  per(accum) = 33.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.759e-04 S  per = 25.4  per(accum) = 58.7
 T(local oper_env: deallocate cpu and gpu memory) = 1.741e-05 S  per = 1.18  per(accum) = 59.9
 T(local oper_env: construct opS [ifdists=true] ) = 1.919e-05 S  per =  1.3  per(accum) = 61.1
 T(local oper_env: reduction of opS & opH [nccl]) = 2.756e-05 S  per = 1.86  per(accum) = 63
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.599e-05 S  per = 1.76  per(accum) = 64.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.902e-05 S  per = 1.28  per(accum) = 66
 T(local oper_env: qops_pool join and erase     ) = 5.023e-04 S  per = 33.9  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 3.450e-07 S  per = 0.0233  per(accum) = 100
##### sweep oper_env: 1.723e-01 S #####
 T(sweep oper_env: fetch) = 3.696e-02 S  per = 21.5  per(accum) = 21.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 21.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 21.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 21.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 21.5
 T(sweep oper_env: renrm) = 1.101e-01 S  per = 63.9  per(accum) = 85.4
 T(sweep oper_env: save ) = 2.518e-02 S  per = 14.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.298e+10 S  per = -3.298e+32
 T(sweep oper_env: preprocess                  ) = -3.298e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.101e-01 S  T(sum) = 1.101e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.875e-04 S  per = 0.261  per(accum) = 0.261
 T(sweep oper_env: qops init                    ) = 5.803e-03 S  per = 5.27  per(accum) = 5.53
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.011e-03 S  per = 1.83  per(accum) = 7.36
 T(sweep oper_env: allocate qops on gpu         ) = 9.497e-04 S  per = 0.862  per(accum) = 8.22
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.699e-04 S  per = 0.427  per(accum) = 8.65
 T(sweep oper_env: rintermediate init           ) = 8.658e-04 S  per = 0.786  per(accum) = 9.43
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.798e-02 S  per = 16.3  per(accum) = 25.8
 T(sweep oper_env: rmmtasks init                ) = 6.627e-03 S  per = 6.02  per(accum) = 31.8
 T(sweep oper_env: qops memset on cpu           ) = 8.030e-07 S  per = 0.000729  per(accum) = 31.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.143e-02 S  per = 10.4  per(accum) = 42.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.614e-04 S  per = 0.601  per(accum) = 42.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.741e-02 S  per = 43.1  per(accum) = 85.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.640e-04 S  per = 0.875  per(accum) = 86.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.014e-04 S  per = 0.637  per(accum) = 87.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.384e-04 S  per = 0.307  per(accum) = 87.6
 T(sweep oper_env: qops_pool join and erase     ) = 1.087e-02 S  per = 9.87  per(accum) = 97.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.740e-03 S  per = 2.49  per(accum) = 100
ctns::rcanon_load_sites scratch=./scratch/sweep T(load)=0.0049S
----- TIMING FOR ctns::oper_env_right : 3.031e-01 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.114,0.037,0.0999,0.0354,0.286
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=1.200e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=4.470e-08GB T[load](info/setup/data/tot)=2.667e-04,4.048e-05,2.348e-04,5.420e-04 speed=8.248e-05GB/S
matrix: Hij size=(1,1)
     -1.161471167558e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-2.980e-08 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

ctns::oper_init_dotL isym=3 ifkr=1 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=7.614e-03MB:7.436e-06GB
fname=./scratch/sweep/lop(0,0) size=7.44e-06GB T[save](info/data/tot)=0.000678,0.000624,0.0013 speed=0.00571GB/S disk[used]=0.000421GB
----- TIMING FOR ctns::oper_init_dotL : 5.079e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x5585ee0c6540
qinfo3su2: site0new sym=(0,0) dir=1,0,1 couple=0
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=9 size=3:2.29e-05MB
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=938:0.00716MB:6.99e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=940:0.00717MB:7e-06GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=1.945e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_save_sites scratch=./scratch/sweep T(save)=1.03e-02S

isweep=0 ibond=0/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-1.691e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=17 scratch=./scratch/sweep size=16:1.19e-07GB T(load)=3.34e-04S speed=3.57e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=16:1.22e-04MB:1.19e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=18:1.37e-04MB:1.34e-07GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=1.885e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:17 S:1 H:1 P:4 Q:7 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=319:0.00243MB:2.38e-06GB
        per(mem): C:53.3 S:3.13 H:3.45 P:0 Q:40.1 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3313:0.0253MB:2.47e-05GB
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=2.618e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=-9.596e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(3,11,3,3) nnz=4:3.052e-05MB
qtensor4: wf4 own=1 _data=0x5585ee1e0d40
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=11 dimAll=11
 (24,0):1 (24,2):1 (24,4):1 (24,6):1 (24,8):1 (24,10):1 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=4 nblocks=430 size=4:3.052e-05MB
### DIAG TIMING: total=3.088e-04 t1=2.194e-05, t2=1.775e-05, t3=2.157e-05, t4=1.861e-04, t5=7.347e-06, t6=4.697e-05, t7=7.151e-06
duration_diagGPU:3.265e-04
duration_diagreduce:3.800e-08
duration_diagtransform:1.110e-07
----- TIMING FOR symbolic_formulae_twodot with size=111 : 1.983e-04 S -----
rank=0 GPUmem(GB): used=2.468e-05 (oper)=2.468e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=111
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.016e-05 S -----
rank=0 GPUmem(GB): used=2.620e-05 (oper,hinter)=2.468e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.914e-04 S size(H_formulae)=111 size(Hxlst2)=4 T(Hmu/Hxlist)=8.194e-05,5.094e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.272e-04 S size(H_formulae)=111 size(Hxlst)=180 -----
rank=0 GPUmem(GB): used=2.620e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=5.960e-08 batch[need]=5.364e-06 blksize=1 blksize0=1 batchsize=180
rank=0 GPUmem(GB): used=3.163e-05 (oper,hinter,dvdson,batch)=2.468e-05,1.520e-06,5.960e-08,5.364e-06
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=4 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.479e-05,7.496e-05,2.117e-04,1.509e-04,5.227e-04
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=2.206e-05 speed=2.701e-03GB/S T(nccl)=5.272e-05 speed=1.131e-03GB/S
----- TIMING FOR sigma : t_inter=7.5e-05 t_gemm=2.1e-04 t_reduction=1.5e-04 tot=4.4e-04 -----
 sigma[inter] counter=1 t=7.5e-05 per=1.7e+01 cost=2.0e+02 flops=2.7e+06
 sigma[gemm] counter=1 i=0 t=2.6e-06 per=5.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=2.0e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=2.0e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=3 t=2.0e-06 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=4 t=5.4e-05 per=1.2e+01 cost=1.3e+02 flops=2.5e+06
 sigma[gemm] counter=1 i=5 t=5.1e-05 per=1.2e+01 cost=1.3e+02 flops=2.6e+06
 sigma[gemm] counter=1 i=6 t=5.0e-05 per=1.2e+01 cost=1.0e+02 flops=2.0e+06
 sigma[gemm] counter=1 i=7 t=4.7e-05 per=1.1e+01 cost=1.0e+02 flops=2.1e+06
 sigma[gemm] counter=1 total t=2.1e-04 per=4.8e+01 cost=4.7e+02 flops=2.2e+06
 sigma[red] counter=1 t=1.5e-04 per=3.4e+01 cost=3.6e+02 flops=2.4e+06
----- TIMING FOR sigma_tot : t_inter=7.5e-05 t_gemm=2.1e-04 t_reduction=1.5e-04 tot=4.4e-04 -----
 sigma_tot[inter] counter=1 t=7.5e-05 per=1.7e+01 cost=2.0e+02 flops=2.7e+06
 sigma_tot[gemm] counter=1 i=0 t=2.6e-06 per=5.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=2.0e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=2.0e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=3 t=2.0e-06 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=4 t=5.4e-05 per=1.2e+01 cost=1.3e+02 flops=2.5e+06
 sigma_tot[gemm] counter=1 i=5 t=5.1e-05 per=1.2e+01 cost=1.3e+02 flops=2.6e+06
 sigma_tot[gemm] counter=1 i=6 t=5.0e-05 per=1.2e+01 cost=1.0e+02 flops=2.0e+06
 sigma_tot[gemm] counter=1 i=7 t=4.7e-05 per=1.1e+01 cost=1.0e+02 flops=2.1e+06
 sigma_tot[gemm] counter=1 total t=2.1e-04 per=4.8e+01 cost=4.7e+02 flops=2.2e+06
 sigma_tot[red] counter=1 t=1.5e-04 per=3.4e+01 cost=3.6e+02 flops=2.4e+06
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.3e-06,1.4e-06,1.1e-06,2.8e-07
settings: ndim=4 neig=1 maxcycle=30 nbuff=4 memory=4e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.147116755810 -1.116e+03  5.974e-02    1     1  7.738e-04 7.738e-04 7.309e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.671e-05,5.995e-05,2.276e-04,1.760e-04,5.347e-04
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=2.319e-05 speed=2.570e-03GB/S T(nccl)=4.352e-05 speed=1.370e-03GB/S
----- TIMING FOR sigma : t_inter=6.0e-05 t_gemm=2.3e-04 t_reduction=1.8e-04 tot=4.6e-04 -----
 sigma[inter] counter=2 t=6.0e-05 per=1.3e+01 cost=2.0e+02 flops=3.4e+06
 sigma[gemm] counter=2 i=0 t=2.8e-06 per=6.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=2.3e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=2.3e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=3 t=2.3e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=4 t=5.5e-05 per=1.2e+01 cost=1.3e+02 flops=2.4e+06
 sigma[gemm] counter=2 i=5 t=5.2e-05 per=1.1e+01 cost=1.3e+02 flops=2.5e+06
 sigma[gemm] counter=2 i=6 t=5.6e-05 per=1.2e+01 cost=1.0e+02 flops=1.8e+06
 sigma[gemm] counter=2 i=7 t=5.4e-05 per=1.2e+01 cost=1.0e+02 flops=1.9e+06
 sigma[gemm] counter=2 total t=2.3e-04 per=4.9e+01 cost=4.7e+02 flops=2.1e+06
 sigma[red] counter=2 t=1.8e-04 per=3.8e+01 cost=3.6e+02 flops=2.0e+06
----- TIMING FOR sigma_tot : t_inter=1.3e-04 t_gemm=4.4e-04 t_reduction=3.3e-04 tot=9.0e-04 -----
 sigma_tot[inter] counter=2 t=1.3e-04 per=1.5e+01 cost=4.1e+02 flops=3.0e+06
 sigma_tot[gemm] counter=2 i=0 t=5.4e-06 per=6.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=4.3e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=4.3e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=3 t=4.3e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=4 t=1.1e-04 per=1.2e+01 cost=2.6e+02 flops=2.4e+06
 sigma_tot[gemm] counter=2 i=5 t=1.0e-04 per=1.2e+01 cost=2.6e+02 flops=2.5e+06
 sigma_tot[gemm] counter=2 i=6 t=1.1e-04 per=1.2e+01 cost=2.0e+02 flops=1.9e+06
 sigma_tot[gemm] counter=2 i=7 t=1.0e-04 per=1.1e+01 cost=2.0e+02 flops=2.0e+06
 sigma_tot[gemm] counter=2 total t=4.4e-04 per=4.9e+01 cost=9.4e+02 flops=2.1e+06
 sigma_tot[red] counter=2 t=3.3e-04 per=3.6e+01 cost=7.2e+02 flops=2.2e+06
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,2.2e-05,2.4e-06,1.8e-06,2.1e-07
    2   0 -    -116.177424126215 -3.031e-02  3.883e-03    2     2  1.659e-03 8.295e-04 7.538e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.350e-05,5.812e-05,2.228e-04,1.592e-04,5.074e-04
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=2.247e-05 speed=2.653e-03GB/S T(nccl)=4.103e-05 speed=1.453e-03GB/S
----- TIMING FOR sigma : t_inter=5.8e-05 t_gemm=2.2e-04 t_reduction=1.6e-04 tot=4.4e-04 -----
 sigma[inter] counter=3 t=5.8e-05 per=1.3e+01 cost=2.0e+02 flops=3.5e+06
 sigma[gemm] counter=3 i=0 t=2.8e-06 per=6.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=2.3e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=2.4e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=3 t=2.3e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=4 t=5.4e-05 per=1.2e+01 cost=1.3e+02 flops=2.5e+06
 sigma[gemm] counter=3 i=5 t=5.2e-05 per=1.2e+01 cost=1.3e+02 flops=2.6e+06
 sigma[gemm] counter=3 i=6 t=5.4e-05 per=1.2e+01 cost=1.0e+02 flops=1.9e+06
 sigma[gemm] counter=3 i=7 t=5.3e-05 per=1.2e+01 cost=1.0e+02 flops=1.9e+06
 sigma[gemm] counter=3 total t=2.2e-04 per=5.1e+01 cost=4.7e+02 flops=2.1e+06
 sigma[red] counter=3 t=1.6e-04 per=3.6e+01 cost=3.6e+02 flops=2.3e+06
----- TIMING FOR sigma_tot : t_inter=1.9e-04 t_gemm=6.6e-04 t_reduction=4.9e-04 tot=1.3e-03 -----
 sigma_tot[inter] counter=3 t=1.9e-04 per=1.4e+01 cost=6.1e+02 flops=3.2e+06
 sigma_tot[gemm] counter=3 i=0 t=8.2e-06 per=6.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=6.6e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=6.6e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=3 t=6.7e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=4 t=1.6e-04 per=1.2e+01 cost=4.0e+02 flops=2.4e+06
 sigma_tot[gemm] counter=3 i=5 t=1.6e-04 per=1.2e+01 cost=4.0e+02 flops=2.5e+06
 sigma_tot[gemm] counter=3 i=6 t=1.6e-04 per=1.2e+01 cost=3.1e+02 flops=1.9e+06
 sigma_tot[gemm] counter=3 i=7 t=1.5e-04 per=1.2e+01 cost=3.1e+02 flops=2.0e+06
 sigma_tot[gemm] counter=3 total t=6.6e-04 per=4.9e+01 cost=1.4e+03 flops=2.1e+06
 sigma_tot[red] counter=3 t=4.9e-04 per=3.6e+01 cost=1.1e+03 flops=2.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,1.7e-05,2.2e-06,1.3e-06,2.2e-07
    3   0 +    -116.177526452453 -1.023e-04  2.607e-06    3     3  2.496e-03 8.320e-04 7.621e-04
TIMING FOR Davidson : 2.519e-03  T(cal/comm/rest)=2.286e-03,2.204e-06,2.306e-04
decomposed t_rest=2.306e-04
 T(sub)    =6.478e-05 per=2.809e+01
 T(precond)=1.604e-05 per=6.955e+00
 T(ortho)  =4.090e-06 per=1.774e+00
 T(xcopy)  =6.110e-07 per=2.649e-01
 T(xnrm2)  =4.770e-07 per=2.068e-01
 T(other)  =1.446e-04 per=6.271e+01
optimized energies: isweep=0 ibond=0 dots=2 e[0]=-116.177526452453 nmvp=3
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=3.586e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
timing for divide=1.0e-05
timing for compute=3.3e-05
timing for collect=9.8e-06
----- TMING FOR decimation_genbasis(su2): 5.3e-05 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,2.7e-05,0.0e+00,5.7e-06,9.8e-06 -----
decimation summary: 10->2 dwt=+1.110e-16 SvN=5.084e-01
 qbond: qkept nsym=2 dimAll=2
 (4,0):1 (3,1):1
----- TIMING for decimation_row(nkr): 9.788e-04 S T(decim/select/formRot)=1.137e-04,8.520e-04,1.317e-05 -----
----- TIMING FOR twodot_decimation: 1.105e-03 S T(wf/decim)=8.245e-05,1.023e-03 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=19:1.450e-04MB:1.416e-07GB
        per(mem): C:10.5 S:47.4 H:10.5 A:0 B:31.6 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.685e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=8 : 1.858e-05 S -----
rank=0 GPUmem(GB): used=2.397e-05 (oper)=1.501e-05
rank=0 GPUmem(GB): used=2.399e-05 (oper,site)=1.501e-05,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=8
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=2.399e-05 (oper,site,rinter)=1.501e-05,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 5.438e-05 S size(rtasks)=8 size(Rlst2)=4 T(Rmu/Rlist)=9.858e-06,4.447e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.561e-05 S size(rtasks)=8 size(Rlst)=28 -----
rank=0 GPUmem(GB): used=2.399e-05 avail=3.829e+01 total=3.829e+01 batch[need]=6.258e-07 blksize=1 blksize0=0 batchsize=28
rank=0 GPUmem(GB): used=2.462e-05 (oper,site,rinter,batch)=1.501e-05,2.235e-08,0.000e+00,6.258e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.402e-06,1.837e-04,9.494e-05
----- TIMING FOR renorm : t_inter=6.3e-06 t_gemm=1.8e-04 t_reduction=9.5e-05 tot=2.8e-04 -----
 renorm[inter] counter=1 t=6.3e-06 per=2.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=2.7e-06 per=9.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=2.0e-06 per=7.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=2.0e-06 per=7.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=2.0e-06 per=7.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=7.1e-05 per=2.5e+01 cost=1.4e+01 flops=2.0e+05
 renorm[gemm] counter=1 i=5 t=5.2e-05 per=1.8e+01 cost=2.8e+01 flops=5.3e+05
 renorm[gemm] counter=1 i=6 t=5.1e-05 per=1.8e+01 cost=5.6e+01 flops=1.1e+06
 renorm[gemm] counter=1 total t=1.8e-04 per=6.4e+01 cost=9.8e+01 flops=5.3e+05
 renorm[red] counter=1 t=9.5e-05 per=3.3e+01 cost=5.6e+01 flops=5.9e+05
----- TIMING FOR renorm_tot : t_inter=6.3e-06 t_gemm=1.8e-04 t_reduction=9.5e-05 tot=2.8e-04 -----
 renorm_tot[inter] counter=1 t=6.3e-06 per=2.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=2.7e-06 per=9.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=2.0e-06 per=7.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=2.0e-06 per=7.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=2.0e-06 per=7.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=7.1e-05 per=2.5e+01 cost=1.4e+01 flops=2.0e+05
 renorm_tot[gemm] counter=1 i=5 t=5.2e-05 per=1.8e+01 cost=2.8e+01 flops=5.3e+05
 renorm_tot[gemm] counter=1 i=6 t=5.1e-05 per=1.8e+01 cost=5.6e+01 flops=1.1e+06
 renorm_tot[gemm] counter=1 total t=1.8e-04 per=6.4e+01 cost=9.8e+01 flops=5.3e+05
 renorm_tot[red] counter=1 t=9.5e-05 per=3.3e+01 cost=5.6e+01 flops=5.9e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.398e-05 (oper)=1.502e-05
rank=0 GPUmem(GB): used=2.400e-05 (oper,site,rinter)=1.502e-05,2.235e-08,0.000e+00
rank=0 GPUmem(GB): used=2.409e-05 (oper,site,rinter,batch)=1.502e-05,2.235e-08,0.000e+00,8.941e-08
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.361e-03 S T(preprocess/alloc/comp/red/dealloc)=4.315e-04,4.863e-04,3.446e-03,3.651e-04,2.637e-05 -----
----- TIMING FOR oper_renorm_opS : 4.383e-03 S rank=0 -----
qops.to_cpu: size(tot)=19:1.450e-04MB:1.416e-07GB T(to_cpu)=1.973e-05S speed=7.176e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00547 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.238e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=2.441e-04 change=-1.822e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=2.441e-04 change=-9.388e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 2.066e-02 S #####
 T(local opt: fetch) = 6.200e-03 S  per =   30  per(accum) = 30
 T(local opt: hdiag) = 4.735e-04 S  per = 2.29  per(accum) = 32.3
 T(local opt: dvdsn) = 4.536e-03 S  per =   22  per(accum) = 54.2
 T(local opt: decim) = 1.142e-03 S  per = 5.52  per(accum) = 59.8
 T(local opt: guess) = 7.867e-05 S  per = 0.381  per(accum) = 60.2
 T(local opt: renrm) = 6.468e-03 S  per = 31.3  per(accum) = 91.5
 T(local opt: save ) = 1.766e-03 S  per = 8.55  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.536e-03 S  T(sum) = 4.239e-03 S  per = 9.345e+01
 T(local opt: preprocess                  ) = 5.182e-04 S  per = 12.2  per(accum) = 12.2
 T(local opt: symbolic_formulae           ) = 2.122e-04 S  per = 5.01  per(accum) = 17.2
 T(local opt: hintermediate init          ) = 7.728e-05 S  per = 1.82  per(accum) = 19.1
 T(local opt: preprocess_hformulae_Hxlist ) = 6.372e-04 S  per =   15  per(accum) = 34.1
 T(local opt: hmmtasks init               ) = 1.239e-04 S  per = 2.92  per(accum) = 37
 T(local opt: initial guess for dvdson    ) = 1.516e-04 S  per = 3.58  per(accum) = 40.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.081e-03 S  per = 49.1  per(accum) = 89.7
 T(local opt: dvdson [cpu-gpu]            ) = 6.772e-05 S  per =  1.6  per(accum) = 91.3
 T(local opt: dvdson [nccl]               ) = 1.373e-04 S  per = 3.24  per(accum) = 94.5
 T(local opt: dvdson [mpi]                ) = 2.204e-06 S  per = 0.052  per(accum) = 94.6
 T(local opt: dvdson [rest part(linalg)]  ) = 2.306e-04 S  per = 5.44  per(accum) = 100
Detailed decomposition of T(renrm) = 6.468e-03 S  T(sum) = 6.468e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.284e-05 S  per = 0.662  per(accum) = 0.662
 T(local opt: qops init                    ) = 2.359e-04 S  per = 3.65  per(accum) = 4.31
 T(local opt: symbolic_formulae_renorm     ) = 3.337e-05 S  per = 0.516  per(accum) = 4.83
 T(local opt: allocate qops on gpu         ) = 5.536e-05 S  per = 0.856  per(accum) = 5.68
 T(local opt: site memcpy cpu2gpu          ) = 2.718e-05 S  per = 0.42  per(accum) = 6.1
 T(local opt: rintermediate init           ) = 2.744e-05 S  per = 0.424  per(accum) = 6.53
 T(local opt: preprocess_formulae_Rlist2   ) = 7.512e-05 S  per = 1.16  per(accum) = 7.69
 T(local opt: rmmtasks init                ) = 8.293e-05 S  per = 1.28  per(accum) = 8.97
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 0.000587  per(accum) = 8.97
 T(local opt: preprocess_renorm_batchGPU   ) = 4.605e-04 S  per = 7.12  per(accum) = 16.1
 T(local opt: deallocate cpu and gpu memory) = 1.963e-05 S  per = 0.304  per(accum) = 16.4
 T(local opt: construct opS [ifdists=true] ) = 4.395e-03 S  per =   68  per(accum) = 84.3
 T(local opt: reduction of opS & opH [nccl]) = 1.929e-05 S  per = 0.298  per(accum) = 84.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.969e-05 S  per = 0.459  per(accum) = 85.1
 T(local opt: reduction of opS & opH [mpi] ) = 9.163e-06 S  per = 0.142  per(accum) = 85.2
 T(local opt: qops_pool join and erase     ) = 9.532e-04 S  per = 14.7  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.411e-06 S  per = 0.0218  per(accum) = 100
ctns::rcanon_save_site idx=18 scratch=./scratch/sweep size=3:2.2e-08GB T(load)=0.00055S speed=4e-05GB/S
##### sweep opt: 2.066e-02 S #####
 T(sweep opt: fetch) = 6.200e-03 S  per =   30  per(accum) = 30
 T(sweep opt: hdiag) = 4.735e-04 S  per = 2.29  per(accum) = 32.3
 T(sweep opt: dvdsn) = 4.536e-03 S  per =   22  per(accum) = 54.2
 T(sweep opt: decim) = 1.142e-03 S  per = 5.52  per(accum) = 59.8
 T(sweep opt: guess) = 7.867e-05 S  per = 0.381  per(accum) = 60.2
 T(sweep opt: renrm) = 6.468e-03 S  per = 31.3  per(accum) = 91.5
 T(sweep opt: save ) = 1.766e-03 S  per = 8.55  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.536e-03 S  T(sum) = 4.239e-03 S  per = 9.345e+01
 T(sweep opt: preprocess                  ) = 5.182e-04 S  per = 12.2  per(accum) = 12.2
 T(sweep opt: symbolic_formulae           ) = 2.122e-04 S  per = 5.01  per(accum) = 17.2
 T(sweep opt: hintermediate init          ) = 7.728e-05 S  per = 1.82  per(accum) = 19.1
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.372e-04 S  per =   15  per(accum) = 34.1
 T(sweep opt: hmmtasks init               ) = 1.239e-04 S  per = 2.92  per(accum) = 37
 T(sweep opt: initial guess for dvdson    ) = 1.516e-04 S  per = 3.58  per(accum) = 40.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.081e-03 S  per = 49.1  per(accum) = 89.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.772e-05 S  per =  1.6  per(accum) = 91.3
 T(sweep opt: dvdson [nccl]               ) = 1.373e-04 S  per = 3.24  per(accum) = 94.5
 T(sweep opt: dvdson [mpi]                ) = 2.204e-06 S  per = 0.052  per(accum) = 94.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.306e-04 S  per = 5.44  per(accum) = 100
Detailed decomposition of T(renrm) = 6.468e-03 S  T(sum) = 6.468e-03 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.284e-05 S  per = 0.662  per(accum) = 0.662
 T(sweep opt: qops init                    ) = 2.359e-04 S  per = 3.65  per(accum) = 4.31
 T(sweep opt: symbolic_formulae_renorm     ) = 3.337e-05 S  per = 0.516  per(accum) = 4.83
 T(sweep opt: allocate qops on gpu         ) = 5.536e-05 S  per = 0.856  per(accum) = 5.68
 T(sweep opt: site memcpy cpu2gpu          ) = 2.718e-05 S  per = 0.42  per(accum) = 6.1
 T(sweep opt: rintermediate init           ) = 2.744e-05 S  per = 0.424  per(accum) = 6.53
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.512e-05 S  per = 1.16  per(accum) = 7.69
 T(sweep opt: rmmtasks init                ) = 8.293e-05 S  per = 1.28  per(accum) = 8.97
 T(sweep opt: qops memset on cpu           ) = 3.800e-08 S  per = 0.000587  per(accum) = 8.97
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.605e-04 S  per = 7.12  per(accum) = 16.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.963e-05 S  per = 0.304  per(accum) = 16.4
 T(sweep opt: construct opS [ifdists=true] ) = 4.395e-03 S  per =   68  per(accum) = 84.3
 T(sweep opt: reduction of opS & opH [nccl]) = 1.929e-05 S  per = 0.298  per(accum) = 84.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.969e-05 S  per = 0.459  per(accum) = 85.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 9.163e-06 S  per = 0.142  per(accum) = 85.2
 T(sweep opt: qops_pool join and erase     ) = 9.532e-04 S  per = 14.7  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.411e-06 S  per = 0.0218  per(accum) = 100
##### global opt: 2.066e-02 S #####
 T(global opt: fetch) = 6.200e-03 S  per =   30  per(accum) = 30
 T(global opt: hdiag) = 4.735e-04 S  per = 2.29  per(accum) = 32.3
 T(global opt: dvdsn) = 4.536e-03 S  per =   22  per(accum) = 54.2
 T(global opt: decim) = 1.142e-03 S  per = 5.52  per(accum) = 59.8
 T(global opt: guess) = 7.867e-05 S  per = 0.381  per(accum) = 60.2
 T(global opt: renrm) = 6.468e-03 S  per = 31.3  per(accum) = 91.5
 T(global opt: save ) = 1.766e-03 S  per = 8.55  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.536e-03 S  T(sum) = 4.239e-03 S  per = 9.345e+01
 T(global opt: preprocess                  ) = 5.182e-04 S  per = 12.2  per(accum) = 12.2
 T(global opt: symbolic_formulae           ) = 2.122e-04 S  per = 5.01  per(accum) = 17.2
 T(global opt: hintermediate init          ) = 7.728e-05 S  per = 1.82  per(accum) = 19.1
 T(global opt: preprocess_hformulae_Hxlist ) = 6.372e-04 S  per =   15  per(accum) = 34.1
 T(global opt: hmmtasks init               ) = 1.239e-04 S  per = 2.92  per(accum) = 37
 T(global opt: initial guess for dvdson    ) = 1.516e-04 S  per = 3.58  per(accum) = 40.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.081e-03 S  per = 49.1  per(accum) = 89.7
 T(global opt: dvdson [cpu-gpu]            ) = 6.772e-05 S  per =  1.6  per(accum) = 91.3
 T(global opt: dvdson [nccl]               ) = 1.373e-04 S  per = 3.24  per(accum) = 94.5
 T(global opt: dvdson [mpi]                ) = 2.204e-06 S  per = 0.052  per(accum) = 94.6
 T(global opt: dvdson [rest part(linalg)]  ) = 2.306e-04 S  per = 5.44  per(accum) = 100
Detailed decomposition of T(renrm) = 6.468e-03 S  T(sum) = 6.468e-03 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.284e-05 S  per = 0.662  per(accum) = 0.662
 T(global opt: qops init                    ) = 2.359e-04 S  per = 3.65  per(accum) = 4.31
 T(global opt: symbolic_formulae_renorm     ) = 3.337e-05 S  per = 0.516  per(accum) = 4.83
 T(global opt: allocate qops on gpu         ) = 5.536e-05 S  per = 0.856  per(accum) = 5.68
 T(global opt: site memcpy cpu2gpu          ) = 2.718e-05 S  per = 0.42  per(accum) = 6.1
 T(global opt: rintermediate init           ) = 2.744e-05 S  per = 0.424  per(accum) = 6.53
 T(global opt: preprocess_formulae_Rlist2   ) = 7.512e-05 S  per = 1.16  per(accum) = 7.69
 T(global opt: rmmtasks init                ) = 8.293e-05 S  per = 1.28  per(accum) = 8.97
 T(global opt: qops memset on cpu           ) = 3.800e-08 S  per = 0.000587  per(accum) = 8.97
 T(global opt: preprocess_renorm_batchGPU   ) = 4.605e-04 S  per = 7.12  per(accum) = 16.1
 T(global opt: deallocate cpu and gpu memory) = 1.963e-05 S  per = 0.304  per(accum) = 16.4
 T(global opt: construct opS [ifdists=true] ) = 4.395e-03 S  per =   68  per(accum) = 84.3
 T(global opt: reduction of opS & opH [nccl]) = 1.929e-05 S  per = 0.298  per(accum) = 84.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.969e-05 S  per = 0.459  per(accum) = 85.1
 T(global opt: reduction of opS & opH [mpi] ) = 9.163e-06 S  per = 0.142  per(accum) = 85.2
 T(global opt: qops_pool join and erase     ) = 9.532e-04 S  per = 14.7  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.411e-06 S  per = 0.0218  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-3.605e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=1/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=16 scratch=./scratch/sweep size=42:3.13e-07GB T(load)=3.32e-04S speed=9.44e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=58:4.43e-04MB:4.32e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=62:4.73e-04MB:4.62e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=2.898e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=19:1.450e-04MB:1.416e-07GB
        per(mem): C:10.5 S:47.4 H:10.5 A:0 B:31.6 
 rqops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=742:0.00566MB:5.53e-06GB
        per(mem): C:34.5 S:4.31 H:3.23 P:0 Q:58 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2757:0.021MB:2.05e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.993e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-5.305e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,14,3,3) nnz=9:6.866e-05MB
qtensor4: wf4 own=1 _data=0x5585ee22d4a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=9 dimAll=14
 (23,1):2 (23,3):2 (23,5):2 (23,7):2 (23,9):2 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=6 nblocks=252 size=9:6.866e-05MB
### DIAG TIMING: total=4.310e-04 t1=1.646e-05, t2=1.266e-05, t3=1.449e-05, t4=3.371e-04, t5=6.804e-06, t6=3.645e-05, t7=7.018e-06
duration_diagGPU:4.382e-04
duration_diagreduce:3.700e-08
duration_diagtransform:1.390e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 1.738e-04 S -----
rank=0 GPUmem(GB): used=2.054e-05 (oper)=2.054e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=518:3.952e-03MB:3.859e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.610e-05 S -----
rank=0 GPUmem(GB): used=2.440e-05 (oper,hinter)=2.054e-05,3.859e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.872e-04 S size(H_formulae)=107 size(Hxlst2)=6 T(Hmu/Hxlist)=5.044e-05,7.368e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.210e-04 S size(H_formulae)=107 size(Hxlst)=402 -----
rank=0 GPUmem(GB): used=2.440e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.341e-07 batch[need]=2.097e-05 blksize=2 blksize0=2 batchsize=402
rank=0 GPUmem(GB): used=4.550e-05 (oper,hinter,dvdson,batch)=2.054e-05,3.859e-06,1.341e-07,2.097e-05
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=9 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.730e-05,7.328e-05,2.092e-04,2.240e-04,5.789e-04
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.161e-05 speed=6.207e-03GB/S T(nccl)=4.569e-05 speed=2.935e-03GB/S
----- TIMING FOR sigma : t_inter=7.3e-05 t_gemm=2.1e-04 t_reduction=2.2e-04 tot=5.1e-04 -----
 sigma[inter] counter=4 t=7.3e-05 per=1.4e+01 cost=4.8e+03 flops=6.5e+07
 sigma[gemm] counter=4 i=0 t=1.9e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=1.6e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=1.6e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=3 t=1.7e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=4 t=5.8e-05 per=1.2e+01 cost=5.5e+02 flops=9.4e+06
 sigma[gemm] counter=4 i=5 t=5.3e-05 per=1.1e+01 cost=5.5e+02 flops=1.0e+07
 sigma[gemm] counter=4 i=6 t=4.6e-05 per=9.0e+00 cost=3.8e+02 flops=8.4e+06
 sigma[gemm] counter=4 i=7 t=4.5e-05 per=8.9e+00 cost=3.6e+02 flops=8.1e+06
 sigma[gemm] counter=4 total t=2.1e-04 per=4.1e+01 cost=1.8e+03 flops=8.8e+06
 sigma[red] counter=4 t=2.2e-04 per=4.4e+01 cost=1.2e+03 flops=5.3e+06
----- TIMING FOR sigma_tot : t_inter=2.7e-04 t_gemm=8.7e-04 t_reduction=7.1e-04 tot=1.8e-03 -----
 sigma_tot[inter] counter=4 t=2.7e-04 per=1.4e+01 cost=5.4e+03 flops=2.0e+07
 sigma_tot[gemm] counter=4 i=0 t=1.0e-05 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=8.3e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=8.3e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=3 t=8.3e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=4 t=2.2e-04 per=1.2e+01 cost=9.4e+02 flops=4.3e+06
 sigma_tot[gemm] counter=4 i=5 t=2.1e-04 per=1.1e+01 cost=9.4e+02 flops=4.5e+06
 sigma_tot[gemm] counter=4 i=6 t=2.1e-04 per=1.1e+01 cost=6.9e+02 flops=3.4e+06
 sigma_tot[gemm] counter=4 i=7 t=2.0e-04 per=1.1e+01 cost=6.7e+02 flops=3.4e+06
 sigma_tot[gemm] counter=4 total t=8.7e-04 per=4.7e+01 cost=3.2e+03 flops=3.7e+06
 sigma_tot[red] counter=4 t=7.1e-04 per=3.8e+01 cost=2.3e+03 flops=3.2e+06
T(sub)=5.3e-06 T(gemm/eig/ortho/gemm/axpy)=1.8e-06,2.1e-06,7.4e-07,5.6e-07,1.6e-07
settings: ndim=9 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.177526452453 -1.116e+03  6.213e-02    1     1  6.637e-04 6.637e-04 6.496e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.964e-05,6.029e-05,2.301e-04,2.225e-04,5.761e-04
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.072e-05 speed=6.473e-03GB/S T(nccl)=3.892e-05 speed=3.446e-03GB/S
----- TIMING FOR sigma : t_inter=6.0e-05 t_gemm=2.3e-04 t_reduction=2.2e-04 tot=5.1e-04 -----
 sigma[inter] counter=5 t=6.0e-05 per=1.2e+01 cost=4.8e+03 flops=8.0e+07
 sigma[gemm] counter=5 i=0 t=2.0e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=2.0e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=3 t=1.9e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=4 t=6.2e-05 per=1.2e+01 cost=5.5e+02 flops=8.9e+06
 sigma[gemm] counter=5 i=5 t=5.9e-05 per=1.2e+01 cost=5.5e+02 flops=9.3e+06
 sigma[gemm] counter=5 i=6 t=5.1e-05 per=9.9e+00 cost=3.8e+02 flops=7.5e+06
 sigma[gemm] counter=5 i=7 t=5.0e-05 per=9.8e+00 cost=3.6e+02 flops=7.2e+06
 sigma[gemm] counter=5 total t=2.3e-04 per=4.5e+01 cost=1.8e+03 flops=8.0e+06
 sigma[red] counter=5 t=2.2e-04 per=4.3e+01 cost=1.2e+03 flops=5.3e+06
----- TIMING FOR sigma_tot : t_inter=3.3e-04 t_gemm=1.1e-03 t_reduction=9.3e-04 tot=2.4e-03 -----
 sigma_tot[inter] counter=5 t=3.3e-04 per=1.4e+01 cost=1.0e+04 flops=3.1e+07
 sigma_tot[gemm] counter=5 i=0 t=1.2e-05 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=1.0e-05 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=1.0e-05 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=3 t=1.0e-05 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=4 t=2.8e-04 per=1.2e+01 cost=1.5e+03 flops=5.3e+06
 sigma_tot[gemm] counter=5 i=5 t=2.7e-04 per=1.1e+01 cost=1.5e+03 flops=5.6e+06
 sigma_tot[gemm] counter=5 i=6 t=2.6e-04 per=1.1e+01 cost=1.1e+03 flops=4.2e+06
 sigma_tot[gemm] counter=5 i=7 t=2.5e-04 per=1.1e+01 cost=1.0e+03 flops=4.1e+06
 sigma_tot[gemm] counter=5 total t=1.1e-03 per=4.7e+01 cost=5.1e+03 flops=4.6e+06
 sigma_tot[red] counter=5 t=9.3e-04 per=4.0e+01 cost=3.4e+03 flops=3.7e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.1e-05,1.9e-06,1.2e-06,2.0e-07
    2   0 -    -116.199122515660 -2.160e-02  1.974e-02    2     2  1.576e-03 7.880e-04 7.516e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.847e-05,6.311e-05,2.286e-04,2.211e-04,5.741e-04
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.051e-05 speed=6.538e-03GB/S T(nccl)=3.795e-05 speed=3.533e-03GB/S
----- TIMING FOR sigma : t_inter=6.3e-05 t_gemm=2.3e-04 t_reduction=2.2e-04 tot=5.1e-04 -----
 sigma[inter] counter=6 t=6.3e-05 per=1.2e+01 cost=4.8e+03 flops=7.6e+07
 sigma[gemm] counter=6 i=0 t=2.4e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=1.9e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=3 t=1.9e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=4 t=6.2e-05 per=1.2e+01 cost=5.5e+02 flops=8.9e+06
 sigma[gemm] counter=6 i=5 t=5.9e-05 per=1.1e+01 cost=5.5e+02 flops=9.3e+06
 sigma[gemm] counter=6 i=6 t=5.0e-05 per=9.8e+00 cost=3.8e+02 flops=7.7e+06
 sigma[gemm] counter=6 i=7 t=4.9e-05 per=9.6e+00 cost=3.6e+02 flops=7.4e+06
 sigma[gemm] counter=6 total t=2.3e-04 per=4.5e+01 cost=1.8e+03 flops=8.1e+06
 sigma[red] counter=6 t=2.2e-04 per=4.3e+01 cost=1.2e+03 flops=5.4e+06
----- TIMING FOR sigma_tot : t_inter=3.9e-04 t_gemm=1.3e-03 t_reduction=1.2e-03 tot=2.9e-03 -----
 sigma_tot[inter] counter=6 t=3.9e-04 per=1.4e+01 cost=1.5e+04 flops=3.9e+07
 sigma_tot[gemm] counter=6 i=0 t=1.4e-05 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=1.2e-05 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=1.2e-05 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=3 t=1.2e-05 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=4 t=3.4e-04 per=1.2e+01 cost=2.0e+03 flops=5.9e+06
 sigma_tot[gemm] counter=6 i=5 t=3.3e-04 per=1.1e+01 cost=2.0e+03 flops=6.2e+06
 sigma_tot[gemm] counter=6 i=6 t=3.1e-04 per=1.1e+01 cost=1.5e+03 flops=4.7e+06
 sigma_tot[gemm] counter=6 i=7 t=3.0e-04 per=1.0e+01 cost=1.4e+03 flops=4.7e+06
 sigma_tot[gemm] counter=6 total t=1.3e-03 per=4.6e+01 cost=6.9e+03 flops=5.2e+06
 sigma_tot[red] counter=6 t=1.2e-03 per=4.0e+01 cost=4.6e+03 flops=4.0e+06
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-06,1.2e-05,1.4e-06,9.5e-07,1.6e-07
    3   0 -    -116.200256352489 -1.134e-03  3.227e-03    3     3  2.277e-03 7.590e-04 7.233e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.850e-05,5.811e-05,2.282e-04,2.209e-04,5.683e-04
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.036e-05 speed=6.586e-03GB/S T(nccl)=3.814e-05 speed=3.517e-03GB/S
----- TIMING FOR sigma : t_inter=5.8e-05 t_gemm=2.3e-04 t_reduction=2.2e-04 tot=5.1e-04 -----
 sigma[inter] counter=7 t=5.8e-05 per=1.1e+01 cost=4.8e+03 flops=8.3e+07
 sigma[gemm] counter=7 i=0 t=2.0e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=1.9e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=3 t=1.9e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=4 t=6.0e-05 per=1.2e+01 cost=5.5e+02 flops=9.1e+06
 sigma[gemm] counter=7 i=5 t=5.9e-05 per=1.2e+01 cost=5.5e+02 flops=9.3e+06
 sigma[gemm] counter=7 i=6 t=5.0e-05 per=9.9e+00 cost=3.8e+02 flops=7.6e+06
 sigma[gemm] counter=7 i=7 t=5.1e-05 per=1.0e+01 cost=3.6e+02 flops=7.2e+06
 sigma[gemm] counter=7 total t=2.3e-04 per=4.5e+01 cost=1.8e+03 flops=8.1e+06
 sigma[red] counter=7 t=2.2e-04 per=4.4e+01 cost=1.2e+03 flops=5.4e+06
----- TIMING FOR sigma_tot : t_inter=4.5e-04 t_gemm=1.6e-03 t_reduction=1.4e-03 tot=3.4e-03 -----
 sigma_tot[inter] counter=7 t=4.5e-04 per=1.3e+01 cost=2.0e+04 flops=4.4e+07
 sigma_tot[gemm] counter=7 i=0 t=1.6e-05 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=1.4e-05 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=1.4e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=3 t=1.4e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=4 t=4.0e-04 per=1.2e+01 cost=2.6e+03 flops=6.4e+06
 sigma_tot[gemm] counter=7 i=5 t=3.9e-04 per=1.1e+01 cost=2.6e+03 flops=6.7e+06
 sigma_tot[gemm] counter=7 i=6 t=3.6e-04 per=1.1e+01 cost=1.8e+03 flops=5.2e+06
 sigma_tot[gemm] counter=7 i=7 t=3.5e-04 per=1.0e+01 cost=1.8e+03 flops=5.0e+06
 sigma_tot[gemm] counter=7 total t=1.6e-03 per=4.6e+01 cost=8.8e+03 flops=5.6e+06
 sigma_tot[red] counter=7 t=1.4e-03 per=4.1e+01 cost=5.8e+03 flops=4.2e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-06,7.0e-06,1.4e-06,8.5e-07,1.4e-07
    4   0 -    -116.200293375986 -3.702e-05  6.151e-04    3     4  2.963e-03 7.408e-04 7.072e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.747e-05,5.710e-05,2.269e-04,2.171e-04,5.612e-04
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=1.998e-05 speed=6.712e-03GB/S T(nccl)=3.749e-05 speed=3.577e-03GB/S
----- TIMING FOR sigma : t_inter=5.7e-05 t_gemm=2.3e-04 t_reduction=2.2e-04 tot=5.0e-04 -----
 sigma[inter] counter=8 t=5.7e-05 per=1.1e+01 cost=4.8e+03 flops=8.4e+07
 sigma[gemm] counter=8 i=0 t=1.9e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=3 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=4 t=6.0e-05 per=1.2e+01 cost=5.5e+02 flops=9.1e+06
 sigma[gemm] counter=8 i=5 t=5.9e-05 per=1.2e+01 cost=5.5e+02 flops=9.3e+06
 sigma[gemm] counter=8 i=6 t=5.0e-05 per=1.0e+01 cost=3.8e+02 flops=7.7e+06
 sigma[gemm] counter=8 i=7 t=5.0e-05 per=9.9e+00 cost=3.6e+02 flops=7.3e+06
 sigma[gemm] counter=8 total t=2.3e-04 per=4.5e+01 cost=1.8e+03 flops=8.1e+06
 sigma[red] counter=8 t=2.2e-04 per=4.3e+01 cost=1.2e+03 flops=5.5e+06
----- TIMING FOR sigma_tot : t_inter=5.0e-04 t_gemm=1.8e-03 t_reduction=1.6e-03 tot=3.9e-03 -----
 sigma_tot[inter] counter=8 t=5.0e-04 per=1.3e+01 cost=2.5e+04 flops=4.9e+07
 sigma_tot[gemm] counter=8 i=0 t=1.8e-05 per=4.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=1.6e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=1.6e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=3 t=1.6e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=4 t=4.6e-04 per=1.2e+01 cost=3.1e+03 flops=6.8e+06
 sigma_tot[gemm] counter=8 i=5 t=4.4e-04 per=1.1e+01 cost=3.1e+03 flops=7.1e+06
 sigma_tot[gemm] counter=8 i=6 t=4.1e-04 per=1.1e+01 cost=2.2e+03 flops=5.5e+06
 sigma_tot[gemm] counter=8 i=7 t=4.0e-04 per=1.0e+01 cost=2.1e+03 flops=5.3e+06
 sigma_tot[gemm] counter=8 total t=1.8e-03 per=4.6e+01 cost=1.1e+04 flops=6.0e+06
 sigma_tot[red] counter=8 t=1.6e-03 per=4.1e+01 cost=7.0e+03 flops=4.4e+06
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=1.3e-06,5.6e-06,1.3e-06,8.3e-07,1.2e-07
    5   0 -    -116.200295015218 -1.639e-06  1.722e-04    3     5  3.639e-03 7.279e-04 6.958e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.824e-05,5.901e-05,2.260e-04,2.197e-04,5.658e-04
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.071e-05 speed=6.475e-03GB/S T(nccl)=3.753e-05 speed=3.573e-03GB/S
----- TIMING FOR sigma : t_inter=5.9e-05 t_gemm=2.3e-04 t_reduction=2.2e-04 tot=5.0e-04 -----
 sigma[inter] counter=9 t=5.9e-05 per=1.2e+01 cost=4.8e+03 flops=8.1e+07
 sigma[gemm] counter=9 i=0 t=1.9e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=3 t=1.9e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=4 t=5.9e-05 per=1.2e+01 cost=5.5e+02 flops=9.3e+06
 sigma[gemm] counter=9 i=5 t=5.9e-05 per=1.2e+01 cost=5.5e+02 flops=9.2e+06
 sigma[gemm] counter=9 i=6 t=4.9e-05 per=9.8e+00 cost=3.8e+02 flops=7.8e+06
 sigma[gemm] counter=9 i=7 t=5.0e-05 per=9.9e+00 cost=3.6e+02 flops=7.3e+06
 sigma[gemm] counter=9 total t=2.3e-04 per=4.5e+01 cost=1.8e+03 flops=8.2e+06
 sigma[red] counter=9 t=2.2e-04 per=4.4e+01 cost=1.2e+03 flops=5.4e+06
----- TIMING FOR sigma_tot : t_inter=5.6e-04 t_gemm=2.0e-03 t_reduction=1.8e-03 tot=4.4e-03 -----
 sigma_tot[inter] counter=9 t=5.6e-04 per=1.3e+01 cost=2.9e+04 flops=5.2e+07
 sigma_tot[gemm] counter=9 i=0 t=2.0e-05 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=1.8e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=1.8e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=3 t=1.8e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=4 t=5.2e-04 per=1.2e+01 cost=3.7e+03 flops=7.0e+06
 sigma_tot[gemm] counter=9 i=5 t=5.0e-04 per=1.2e+01 cost=3.7e+03 flops=7.3e+06
 sigma_tot[gemm] counter=9 i=6 t=4.6e-04 per=1.0e+01 cost=2.6e+03 flops=5.7e+06
 sigma_tot[gemm] counter=9 i=7 t=4.5e-04 per=1.0e+01 cost=2.5e+03 flops=5.5e+06
 sigma_tot[gemm] counter=9 total t=2.0e-03 per=4.6e+01 cost=1.2e+04 flops=6.2e+06
 sigma_tot[red] counter=9 t=1.8e-03 per=4.1e+01 cost=8.2e+03 flops=4.5e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-06,7.0e-06,1.3e-06,8.5e-07,1.2e-07
    6   0 +    -116.200295182410 -1.672e-07  4.298e-05    3     6  4.479e-03 7.465e-04 6.964e-04
TIMING FOR Davidson : 4.488e-03  T(cal/comm/rest)=4.178e-03,1.550e-06,3.081e-04
decomposed t_rest=3.081e-04
 T(sub)    =7.047e-05 per=2.287e+01
 T(precond)=1.442e-05 per=4.678e+00
 T(ortho)  =6.702e-06 per=2.175e+00
 T(xcopy)  =6.790e-07 per=2.204e-01
 T(xnrm2)  =6.700e-07 per=2.174e-01
 T(other)  =2.152e-04 per=6.984e+01
optimized energies: isweep=0 ibond=1 dots=2 e[0]=-116.200295182410 nmvp=6
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=3.210e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=5 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=5 dimAll=7
 (4,0):2 (6,0):1 (5,1):2 (3,1):1 (4,2):1
timing for divide=6.3e-06
timing for compute=1.8e-05
timing for collect=3.0e-06
----- TMING FOR decimation_genbasis(su2): 2.8e-05 S T(divide/compute[cpu/gpu/rest]/collect)=6.3e-06,1.6e-05,0.0e+00,2.0e-06,3.0e-06 -----
decimation summary: 7->4 dwt=+1.110e-16 SvN=5.745e-01
 qbond: qkept nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
----- TIMING for decimation_row(nkr): 7.999e-04 S T(decim/select/formRot)=4.458e-05,7.461e-04,9.143e-06 -----
----- TIMING FOR twodot_decimation: 8.560e-04 S T(wf/decim)=5.085e-05,8.052e-04 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:3 S:9 H:1 A:4 B:7 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=94:7.172e-04MB:7.004e-07GB
        per(mem): C:12.8 S:38.3 H:6.38 A:1.06 B:41.5 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.130e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=15 : 2.548e-05 S -----
rank=0 GPUmem(GB): used=1.957e-05 (oper)=8.278e-06
rank=0 GPUmem(GB): used=1.962e-05 (oper,site)=8.278e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=15
 no. of rintermediate operators=4
 no. of coefficients=8:6.104e-05MB:5.960e-08GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.115e-05 S -----
rank=0 GPUmem(GB): used=1.968e-05 (oper,site,rinter)=8.278e-06,4.470e-08,5.960e-08
----- TIMING FOR preprocess_formulae_Rlist2 : 9.211e-05 S size(rtasks)=15 size(Rlst2)=9 T(Rmu/Rlist)=1.215e-05,7.992e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.831e-05 S size(rtasks)=15 size(Rlst)=63 -----
rank=0 GPUmem(GB): used=1.968e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.694e-06 blksize=4 blksize0=1 batchsize=63
rank=0 GPUmem(GB): used=2.437e-05 (oper,site,rinter,batch)=8.278e-06,4.470e-08,5.960e-08,4.694e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.260e-05,1.744e-04,9.372e-05
----- TIMING FOR renorm : t_inter=7.3e-05 t_gemm=1.7e-04 t_reduction=9.4e-05 tot=3.4e-04 -----
 renorm[inter] counter=20 t=7.3e-05 per=2.1e+01 cost=8.0e+01 flops=1.1e+06
 renorm[gemm] counter=20 i=0 t=2.0e-06 per=6.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=1 t=1.9e-06 per=5.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=2 t=1.9e-06 per=5.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=3 t=1.8e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=4 t=5.3e-05 per=1.6e+01 cost=4.4e+01 flops=8.3e+05
 renorm[gemm] counter=20 i=5 t=5.1e-05 per=1.5e+01 cost=1.0e+02 flops=2.0e+06
 renorm[gemm] counter=20 i=6 t=6.2e-05 per=1.8e+01 cost=3.1e+02 flops=4.9e+06
 renorm[gemm] counter=20 total t=1.7e-04 per=5.1e+01 cost=4.5e+02 flops=2.6e+06
 renorm[red] counter=20 t=9.4e-05 per=2.8e+01 cost=3.1e+02 flops=3.3e+06
----- TIMING FOR renorm_tot : t_inter=7.9e-05 t_gemm=3.6e-04 t_reduction=1.9e-04 tot=6.2e-04 -----
 renorm_tot[inter] counter=20 t=7.9e-05 per=1.3e+01 cost=8.0e+01 flops=1.0e+06
 renorm_tot[gemm] counter=20 i=0 t=4.7e-06 per=7.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=1 t=3.9e-06 per=6.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=2 t=3.9e-06 per=6.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=3 t=3.9e-06 per=6.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=4 t=1.2e-04 per=2.0e+01 cost=5.8e+01 flops=4.7e+05
 renorm_tot[gemm] counter=20 i=5 t=1.0e-04 per=1.7e+01 cost=1.3e+02 flops=1.3e+06
 renorm_tot[gemm] counter=20 i=6 t=1.1e-04 per=1.8e+01 cost=3.6e+02 flops=3.2e+06
 renorm_tot[gemm] counter=20 total t=3.6e-04 per=5.7e+01 cost=5.5e+02 flops=1.5e+06
 renorm_tot[red] counter=20 t=1.9e-04 per=3.0e+01 cost=3.6e+02 flops=1.9e+06
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.108e-05 (oper)=8.307e-06
rank=0 GPUmem(GB): used=2.112e-05 (oper,site,rinter)=8.307e-06,4.470e-08,1.416e-06
rank=0 GPUmem(GB): used=2.170e-05 (oper,site,rinter,batch)=8.307e-06,4.470e-08,1.416e-06,5.811e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.582e-03 S T(preprocess/alloc/comp/red/dealloc)=8.637e-04,8.967e-04,4.219e-03,3.285e-04,1.078e-04 -----
----- TIMING FOR oper_renorm_opS : 5.601e-03 S rank=0 -----
qops.to_cpu: size(tot)=94:7.172e-04MB:7.004e-07GB T(to_cpu)=2.069e-05S speed=3.386e-02GB/S
check ||H-H.dagger||=6.280e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00658 S rank=0 -----
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=2.687e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.032e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.177e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 1.883e-02 S #####
 T(local opt: fetch) = 2.240e-03 S  per = 11.9  per(accum) = 11.9
 T(local opt: hdiag) = 4.848e-04 S  per = 2.58  per(accum) = 14.5
 T(local opt: dvdsn) = 6.166e-03 S  per = 32.8  per(accum) = 47.2
 T(local opt: decim) = 8.784e-04 S  per = 4.67  per(accum) = 51.9
 T(local opt: guess) = 7.082e-05 S  per = 0.376  per(accum) = 52.3
 T(local opt: renrm) = 7.238e-03 S  per = 38.4  per(accum) = 90.7
 T(local opt: save ) = 1.747e-03 S  per = 9.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.166e-03 S  T(sum) = 5.954e-03 S  per = 9.656e+01
 T(local opt: preprocess                  ) = 1.926e-04 S  per = 3.23  per(accum) = 3.23
 T(local opt: symbolic_formulae           ) = 1.786e-04 S  per =    3  per(accum) = 6.23
 T(local opt: hintermediate init          ) = 3.349e-05 S  per = 0.563  per(accum) = 6.8
 T(local opt: preprocess_hformulae_Hxlist ) = 8.243e-04 S  per = 13.8  per(accum) = 20.6
 T(local opt: hmmtasks init               ) = 1.621e-04 S  per = 2.72  per(accum) = 23.4
 T(local opt: initial guess for dvdson    ) = 7.475e-05 S  per = 1.26  per(accum) = 24.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.819e-03 S  per = 64.1  per(accum) = 88.8
 T(local opt: dvdson [cpu-gpu]            ) = 1.239e-04 S  per = 2.08  per(accum) = 90.8
 T(local opt: dvdson [nccl]               ) = 2.357e-04 S  per = 3.96  per(accum) = 94.8
 T(local opt: dvdson [mpi]                ) = 1.550e-06 S  per = 0.026  per(accum) = 94.8
 T(local opt: dvdson [rest part(linalg)]  ) = 3.081e-04 S  per = 5.18  per(accum) = 100
Detailed decomposition of T(renrm) = 7.238e-03 S  T(sum) = 7.238e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.183e-05 S  per = 0.578  per(accum) = 0.578
 T(local opt: qops init                    ) = 2.001e-04 S  per = 2.76  per(accum) = 3.34
 T(local opt: symbolic_formulae_renorm     ) = 2.940e-05 S  per = 0.406  per(accum) = 3.75
 T(local opt: allocate qops on gpu         ) = 4.540e-05 S  per = 0.627  per(accum) = 4.38
 T(local opt: site memcpy cpu2gpu          ) = 1.827e-05 S  per = 0.252  per(accum) = 4.63
 T(local opt: rintermediate init           ) = 2.746e-05 S  per = 0.379  per(accum) = 5.01
 T(local opt: preprocess_formulae_Rlist2   ) = 1.014e-04 S  per =  1.4  per(accum) = 6.41
 T(local opt: rmmtasks init                ) = 6.273e-05 S  per = 0.867  per(accum) = 7.27
 T(local opt: qops memset on cpu           ) = 2.800e-08 S  per = 0.000387  per(accum) = 7.27
 T(local opt: preprocess_renorm_batchGPU   ) = 4.215e-04 S  per = 5.82  per(accum) = 13.1
 T(local opt: deallocate cpu and gpu memory) = 2.010e-05 S  per = 0.278  per(accum) = 13.4
 T(local opt: construct opS [ifdists=true] ) = 5.607e-03 S  per = 77.5  per(accum) = 90.8
 T(local opt: reduction of opS & opH [nccl]) = 1.781e-05 S  per = 0.246  per(accum) = 91.1
 T(local opt: qops memcpy gpu2cpu          ) = 2.459e-05 S  per = 0.34  per(accum) = 91.4
 T(local opt: reduction of opS & opH [mpi] ) = 7.139e-06 S  per = 0.0986  per(accum) = 91.5
 T(local opt: qops_pool join and erase     ) = 6.124e-04 S  per = 8.46  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.391e-06 S  per = 0.0192  per(accum) = 100
ctns::rcanon_save_site idx=17 scratch=./scratch/sweep size=6:4.5e-08GB T(load)=0.00053S speed=8.4e-05GB/S
##### sweep opt: 3.949e-02 S #####
 T(sweep opt: fetch) = 8.440e-03 S  per = 21.4  per(accum) = 21.4
 T(sweep opt: hdiag) = 9.583e-04 S  per = 2.43  per(accum) = 23.8
 T(sweep opt: dvdsn) = 1.070e-02 S  per = 27.1  per(accum) = 50.9
 T(sweep opt: decim) = 2.020e-03 S  per = 5.11  per(accum) = 56
 T(sweep opt: guess) = 1.495e-04 S  per = 0.379  per(accum) = 56.4
 T(sweep opt: renrm) = 1.371e-02 S  per = 34.7  per(accum) = 91.1
 T(sweep opt: save ) = 3.514e-03 S  per =  8.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.070e-02 S  T(sum) = 1.019e-02 S  per = 9.524e+01
 T(sweep opt: preprocess                  ) = 7.108e-04 S  per = 6.97  per(accum) = 6.97
 T(sweep opt: symbolic_formulae           ) = 3.908e-04 S  per = 3.83  per(accum) = 10.8
 T(sweep opt: hintermediate init          ) = 1.108e-04 S  per = 1.09  per(accum) = 11.9
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.461e-03 S  per = 14.3  per(accum) = 26.2
 T(sweep opt: hmmtasks init               ) = 2.860e-04 S  per = 2.81  per(accum) = 29
 T(sweep opt: initial guess for dvdson    ) = 2.264e-04 S  per = 2.22  per(accum) = 31.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.900e-03 S  per = 57.9  per(accum) = 89.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.916e-04 S  per = 1.88  per(accum) = 91
 T(sweep opt: dvdson [nccl]               ) = 3.730e-04 S  per = 3.66  per(accum) = 94.7
 T(sweep opt: dvdson [mpi]                ) = 3.754e-06 S  per = 0.0368  per(accum) = 94.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.388e-04 S  per = 5.29  per(accum) = 100
Detailed decomposition of T(renrm) = 1.371e-02 S  T(sum) = 1.371e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.467e-05 S  per = 0.618  per(accum) = 0.618
 T(sweep opt: qops init                    ) = 4.361e-04 S  per = 3.18  per(accum) = 3.8
 T(sweep opt: symbolic_formulae_renorm     ) = 6.276e-05 S  per = 0.458  per(accum) = 4.26
 T(sweep opt: allocate qops on gpu         ) = 1.008e-04 S  per = 0.735  per(accum) = 4.99
 T(sweep opt: site memcpy cpu2gpu          ) = 4.545e-05 S  per = 0.332  per(accum) = 5.32
 T(sweep opt: rintermediate init           ) = 5.490e-05 S  per = 0.401  per(accum) = 5.72
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.765e-04 S  per = 1.29  per(accum) = 7.01
 T(sweep opt: rmmtasks init                ) = 1.457e-04 S  per = 1.06  per(accum) = 8.07
 T(sweep opt: qops memset on cpu           ) = 6.600e-08 S  per = 0.000482  per(accum) = 8.07
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.820e-04 S  per = 6.43  per(accum) = 14.5
 T(sweep opt: deallocate cpu and gpu memory) = 3.973e-05 S  per = 0.29  per(accum) = 14.8
 T(sweep opt: construct opS [ifdists=true] ) = 1.000e-02 S  per =   73  per(accum) = 87.8
 T(sweep opt: reduction of opS & opH [nccl]) = 3.710e-05 S  per = 0.271  per(accum) = 88
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.428e-05 S  per = 0.396  per(accum) = 88.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.630e-05 S  per = 0.119  per(accum) = 88.6
 T(sweep opt: qops_pool join and erase     ) = 1.566e-03 S  per = 11.4  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 2.802e-06 S  per = 0.0204  per(accum) = 100
##### global opt: 3.949e-02 S #####
 T(global opt: fetch) = 8.440e-03 S  per = 21.4  per(accum) = 21.4
 T(global opt: hdiag) = 9.583e-04 S  per = 2.43  per(accum) = 23.8
 T(global opt: dvdsn) = 1.070e-02 S  per = 27.1  per(accum) = 50.9
 T(global opt: decim) = 2.020e-03 S  per = 5.11  per(accum) = 56
 T(global opt: guess) = 1.495e-04 S  per = 0.379  per(accum) = 56.4
 T(global opt: renrm) = 1.371e-02 S  per = 34.7  per(accum) = 91.1
 T(global opt: save ) = 3.514e-03 S  per =  8.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.070e-02 S  T(sum) = 1.019e-02 S  per = 9.524e+01
 T(global opt: preprocess                  ) = 7.108e-04 S  per = 6.97  per(accum) = 6.97
 T(global opt: symbolic_formulae           ) = 3.908e-04 S  per = 3.83  per(accum) = 10.8
 T(global opt: hintermediate init          ) = 1.108e-04 S  per = 1.09  per(accum) = 11.9
 T(global opt: preprocess_hformulae_Hxlist ) = 1.461e-03 S  per = 14.3  per(accum) = 26.2
 T(global opt: hmmtasks init               ) = 2.860e-04 S  per = 2.81  per(accum) = 29
 T(global opt: initial guess for dvdson    ) = 2.264e-04 S  per = 2.22  per(accum) = 31.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.900e-03 S  per = 57.9  per(accum) = 89.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.916e-04 S  per = 1.88  per(accum) = 91
 T(global opt: dvdson [nccl]               ) = 3.730e-04 S  per = 3.66  per(accum) = 94.7
 T(global opt: dvdson [mpi]                ) = 3.754e-06 S  per = 0.0368  per(accum) = 94.7
 T(global opt: dvdson [rest part(linalg)]  ) = 5.388e-04 S  per = 5.29  per(accum) = 100
Detailed decomposition of T(renrm) = 1.371e-02 S  T(sum) = 1.371e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.467e-05 S  per = 0.618  per(accum) = 0.618
 T(global opt: qops init                    ) = 4.361e-04 S  per = 3.18  per(accum) = 3.8
 T(global opt: symbolic_formulae_renorm     ) = 6.276e-05 S  per = 0.458  per(accum) = 4.26
 T(global opt: allocate qops on gpu         ) = 1.008e-04 S  per = 0.735  per(accum) = 4.99
 T(global opt: site memcpy cpu2gpu          ) = 4.545e-05 S  per = 0.332  per(accum) = 5.32
 T(global opt: rintermediate init           ) = 5.490e-05 S  per = 0.401  per(accum) = 5.72
 T(global opt: preprocess_formulae_Rlist2   ) = 1.765e-04 S  per = 1.29  per(accum) = 7.01
 T(global opt: rmmtasks init                ) = 1.457e-04 S  per = 1.06  per(accum) = 8.07
 T(global opt: qops memset on cpu           ) = 6.600e-08 S  per = 0.000482  per(accum) = 8.07
 T(global opt: preprocess_renorm_batchGPU   ) = 8.820e-04 S  per = 6.43  per(accum) = 14.5
 T(global opt: deallocate cpu and gpu memory) = 3.973e-05 S  per = 0.29  per(accum) = 14.8
 T(global opt: construct opS [ifdists=true] ) = 1.000e-02 S  per =   73  per(accum) = 87.8
 T(global opt: reduction of opS & opH [nccl]) = 3.710e-05 S  per = 0.271  per(accum) = 88
 T(global opt: qops memcpy gpu2cpu          ) = 5.428e-05 S  per = 0.396  per(accum) = 88.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.630e-05 S  per = 0.119  per(accum) = 88.6
 T(global opt: qops_pool join and erase     ) = 1.566e-03 S  per = 11.4  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 2.802e-06 S  per = 0.0204  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-3.234e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=2/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=15 scratch=./scratch/sweep size=72:5.36e-07GB T(load)=3.08e-04S speed=1.74e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=114:8.70e-04MB:8.49e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=9:6.87e-05MB:6.71e-08GB
total mem of comb=124:9.46e-04MB:9.24e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.866e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:3 S:9 H:1 A:4 B:7 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=94:7.172e-04MB:7.004e-07GB
        per(mem): C:12.8 S:38.3 H:6.38 A:1.06 B:41.5 
 rqops: oplist=CSHPQ nops=C:15 S:2 H:1 P:12 Q:16 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=1433:0.0109MB:1.07e-05GB
        per(mem): C:18.8 S:2.51 H:2.72 P:0 Q:75.9 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3523:0.0269MB:2.62e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.679e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.103e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(4,15,3,3) nnz=22:1.678e-04MB
qtensor4: wf4 own=1 _data=0x5585f6c6f4a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
 qbond: qcol nsym=7 dimAll=15
 (22,2):3 (22,4):3 (22,6):3 (22,8):3 (23,3):1 (23,5):1 (23,7):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=7 nblocks=308 size=22:1.678e-04MB
### DIAG TIMING: total=6.392e-04 t1=1.749e-05, t2=1.328e-05, t3=1.480e-05, t4=5.439e-04, t5=5.430e-06, t6=3.651e-05, t7=7.712e-06
duration_diagGPU:6.464e-04
duration_diagreduce:5.500e-08
duration_diagtransform:1.400e-07
----- TIMING FOR symbolic_formulae_twodot with size=143 : 2.216e-04 S -----
rank=0 GPUmem(GB): used=2.625e-05 (oper)=2.625e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=143
 no. of hintermediate operators=62
 no. of coefficients=814:6.210e-03MB:6.065e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.711e-05 S -----
rank=0 GPUmem(GB): used=3.231e-05 (oper,hinter)=2.625e-05,6.065e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.241e-03 S size(H_formulae)=143 size(Hxlst2)=7 T(Hmu/Hxlist)=5.700e-05,1.184e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.298e-03 S size(H_formulae)=143 size(Hxlst)=650 -----
rank=0 GPUmem(GB): used=3.231e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.278e-07 batch[need]=8.233e-05 blksize=6 blksize0=4 batchsize=650
rank=0 GPUmem(GB): used=1.150e-04 (oper,hinter,dvdson,batch)=2.625e-05,6.065e-06,3.278e-07,8.233e-05
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=22 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.790e-05,8.272e-05,3.325e-04,1.928e-04,6.816e-04
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.122e-05 speed=1.545e-02GB/S T(nccl)=4.668e-05 speed=7.023e-03GB/S
----- TIMING FOR sigma : t_inter=8.3e-05 t_gemm=3.3e-04 t_reduction=1.9e-04 tot=6.1e-04 -----
 sigma[inter] counter=10 t=8.3e-05 per=1.4e+01 cost=1.4e+04 flops=1.7e+08
 sigma[gemm] counter=10 i=0 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=1.7e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=1.7e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=3 t=1.6e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=4 t=9.0e-05 per=1.5e+01 cost=2.6e+03 flops=2.9e+07
 sigma[gemm] counter=10 i=5 t=8.5e-05 per=1.4e+01 cost=2.7e+03 flops=3.2e+07
 sigma[gemm] counter=10 i=6 t=8.1e-05 per=1.3e+01 cost=2.5e+03 flops=3.1e+07
 sigma[gemm] counter=10 i=7 t=7.0e-05 per=1.1e+01 cost=2.4e+03 flops=3.4e+07
 sigma[gemm] counter=10 total t=3.3e-04 per=5.5e+01 cost=1.0e+04 flops=3.1e+07
 sigma[red] counter=10 t=1.9e-04 per=3.2e+01 cost=4.1e+03 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=6.5e-04 t_gemm=2.3e-03 t_reduction=2.0e-03 tot=5.0e-03 -----
 sigma_tot[inter] counter=10 t=6.5e-04 per=1.3e+01 cost=4.4e+04 flops=6.7e+07
 sigma_tot[gemm] counter=10 i=0 t=2.2e-05 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=2.0e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=2.0e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=3 t=1.9e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=4 t=6.1e-04 per=1.2e+01 cost=6.3e+03 flops=1.0e+07
 sigma_tot[gemm] counter=10 i=5 t=5.9e-04 per=1.2e+01 cost=6.4e+03 flops=1.1e+07
 sigma_tot[gemm] counter=10 i=6 t=5.4e-04 per=1.1e+01 cost=5.1e+03 flops=9.5e+06
 sigma_tot[gemm] counter=10 i=7 t=5.2e-04 per=1.0e+01 cost=4.8e+03 flops=9.3e+06
 sigma_tot[gemm] counter=10 total t=2.3e-03 per=4.7e+01 cost=2.3e+04 flops=9.7e+06
 sigma_tot[red] counter=10 t=2.0e-03 per=4.0e+01 cost=1.2e+04 flops=6.1e+06
T(sub)=6.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.2e-06,2.4e-06,9.2e-07,7.5e-07,1.9e-07
settings: ndim=22 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.200295182409 -1.116e+03  6.222e-02    1     1  7.751e-04 7.751e-04 7.598e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.235e-05,7.332e-05,3.548e-04,2.005e-04,6.946e-04
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.076e-05 speed=1.579e-02GB/S T(nccl)=4.160e-05 speed=7.881e-03GB/S
----- TIMING FOR sigma : t_inter=7.3e-05 t_gemm=3.5e-04 t_reduction=2.0e-04 tot=6.3e-04 -----
 sigma[inter] counter=11 t=7.3e-05 per=1.2e+01 cost=1.4e+04 flops=1.9e+08
 sigma[gemm] counter=11 i=0 t=2.0e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=4 t=8.8e-05 per=1.4e+01 cost=2.6e+03 flops=3.0e+07
 sigma[gemm] counter=11 i=5 t=9.0e-05 per=1.4e+01 cost=2.7e+03 flops=3.0e+07
 sigma[gemm] counter=11 i=6 t=8.1e-05 per=1.3e+01 cost=2.5e+03 flops=3.0e+07
 sigma[gemm] counter=11 i=7 t=8.8e-05 per=1.4e+01 cost=2.4e+03 flops=2.7e+07
 sigma[gemm] counter=11 total t=3.5e-04 per=5.6e+01 cost=1.0e+04 flops=2.9e+07
 sigma[red] counter=11 t=2.0e-04 per=3.2e+01 cost=4.1e+03 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=7.2e-04 t_gemm=2.7e-03 t_reduction=2.2e-03 tot=5.6e-03 -----
 sigma_tot[inter] counter=11 t=7.2e-04 per=1.3e+01 cost=5.8e+04 flops=8.0e+07
 sigma_tot[gemm] counter=11 i=0 t=2.4e-05 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=2.1e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=2.1e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=3 t=2.1e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=4 t=7.0e-04 per=1.2e+01 cost=9.0e+03 flops=1.3e+07
 sigma_tot[gemm] counter=11 i=5 t=6.8e-04 per=1.2e+01 cost=9.1e+03 flops=1.3e+07
 sigma_tot[gemm] counter=11 i=6 t=6.2e-04 per=1.1e+01 cost=7.6e+03 flops=1.2e+07
 sigma_tot[gemm] counter=11 i=7 t=6.1e-04 per=1.1e+01 cost=7.2e+03 flops=1.2e+07
 sigma_tot[gemm] counter=11 total t=2.7e-03 per=4.8e+01 cost=3.3e+04 flops=1.2e+07
 sigma_tot[red] counter=11 t=2.2e-03 per=3.9e+01 cost=1.6e+04 flops=7.4e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,9.2e-06,2.3e-06,1.1e-06,2.2e-07
    2   0 -    -116.214498322664 -1.420e-02  1.954e-02    2     2  1.695e-03 8.476e-04 8.130e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.075e-05,7.152e-05,3.476e-04,2.037e-04,6.871e-04
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.068e-05 speed=1.585e-02GB/S T(nccl)=4.007e-05 speed=8.182e-03GB/S
----- TIMING FOR sigma : t_inter=7.1e-05 t_gemm=3.5e-04 t_reduction=2.0e-04 tot=6.2e-04 -----
 sigma[inter] counter=12 t=7.1e-05 per=1.1e+01 cost=1.4e+04 flops=2.0e+08
 sigma[gemm] counter=12 i=0 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=4 t=8.6e-05 per=1.4e+01 cost=2.6e+03 flops=3.1e+07
 sigma[gemm] counter=12 i=5 t=8.9e-05 per=1.4e+01 cost=2.7e+03 flops=3.0e+07
 sigma[gemm] counter=12 i=6 t=8.3e-05 per=1.3e+01 cost=2.5e+03 flops=3.0e+07
 sigma[gemm] counter=12 i=7 t=8.2e-05 per=1.3e+01 cost=2.4e+03 flops=2.9e+07
 sigma[gemm] counter=12 total t=3.5e-04 per=5.6e+01 cost=1.0e+04 flops=2.9e+07
 sigma[red] counter=12 t=2.0e-04 per=3.3e+01 cost=4.1e+03 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=7.9e-04 t_gemm=3.0e-03 t_reduction=2.4e-03 tot=6.2e-03 -----
 sigma_tot[inter] counter=12 t=7.9e-04 per=1.3e+01 cost=7.2e+04 flops=9.1e+07
 sigma_tot[gemm] counter=12 i=0 t=2.6e-05 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=2.3e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=2.3e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=3 t=2.3e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=4 t=7.9e-04 per=1.3e+01 cost=1.2e+04 flops=1.5e+07
 sigma_tot[gemm] counter=12 i=5 t=7.7e-04 per=1.2e+01 cost=1.2e+04 flops=1.5e+07
 sigma_tot[gemm] counter=12 i=6 t=7.0e-04 per=1.1e+01 cost=1.0e+04 flops=1.4e+07
 sigma_tot[gemm] counter=12 i=7 t=6.9e-04 per=1.1e+01 cost=9.6e+03 flops=1.4e+07
 sigma_tot[gemm] counter=12 total t=3.0e-03 per=4.9e+01 cost=4.3e+04 flops=1.4e+07
 sigma_tot[red] counter=12 t=2.4e-03 per=3.9e+01 cost=2.0e+04 flops=8.5e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,1.2e-05,1.6e-06,1.0e-06,1.7e-07
    3   0 -    -116.215692407464 -1.194e-03  6.197e-03    3     3  2.596e-03 8.653e-04 8.295e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.999e-05,7.289e-05,3.446e-04,1.994e-04,6.801e-04
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.044e-05 speed=1.604e-02GB/S T(nccl)=3.955e-05 speed=8.289e-03GB/S
----- TIMING FOR sigma : t_inter=7.3e-05 t_gemm=3.4e-04 t_reduction=2.0e-04 tot=6.2e-04 -----
 sigma[inter] counter=13 t=7.3e-05 per=1.2e+01 cost=1.4e+04 flops=1.9e+08
 sigma[gemm] counter=13 i=0 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=4 t=8.6e-05 per=1.4e+01 cost=2.6e+03 flops=3.1e+07
 sigma[gemm] counter=13 i=5 t=8.9e-05 per=1.4e+01 cost=2.7e+03 flops=3.0e+07
 sigma[gemm] counter=13 i=6 t=8.1e-05 per=1.3e+01 cost=2.5e+03 flops=3.1e+07
 sigma[gemm] counter=13 i=7 t=8.1e-05 per=1.3e+01 cost=2.4e+03 flops=2.9e+07
 sigma[gemm] counter=13 total t=3.4e-04 per=5.6e+01 cost=1.0e+04 flops=3.0e+07
 sigma[red] counter=13 t=2.0e-04 per=3.2e+01 cost=4.1e+03 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=8.6e-04 t_gemm=3.4e-03 t_reduction=2.6e-03 tot=6.9e-03 -----
 sigma_tot[inter] counter=13 t=8.6e-04 per=1.3e+01 cost=8.6e+04 flops=1.0e+08
 sigma_tot[gemm] counter=13 i=0 t=2.8e-05 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=2.5e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=2.5e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=3 t=2.5e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=4 t=8.7e-04 per=1.3e+01 cost=1.4e+04 flops=1.6e+07
 sigma_tot[gemm] counter=13 i=5 t=8.6e-04 per=1.2e+01 cost=1.4e+04 flops=1.7e+07
 sigma_tot[gemm] counter=13 i=6 t=7.8e-04 per=1.1e+01 cost=1.3e+04 flops=1.6e+07
 sigma_tot[gemm] counter=13 i=7 t=7.7e-04 per=1.1e+01 cost=1.2e+04 flops=1.5e+07
 sigma_tot[gemm] counter=13 total t=3.4e-03 per=4.9e+01 cost=5.3e+04 flops=1.6e+07
 sigma_tot[red] counter=13 t=2.6e-03 per=3.8e+01 cost=2.4e+04 flops=9.4e+06
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-06,8.4e-06,1.5e-06,8.9e-07,1.3e-07
    4   0 -    -116.215785169807 -9.276e-05  1.460e-03    3     4  3.399e-03 8.498e-04 8.152e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.850e-05,7.310e-05,3.444e-04,1.963e-04,6.751e-04
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.010e-05 speed=1.631e-02GB/S T(nccl)=3.841e-05 speed=8.535e-03GB/S
----- TIMING FOR sigma : t_inter=7.3e-05 t_gemm=3.4e-04 t_reduction=2.0e-04 tot=6.1e-04 -----
 sigma[inter] counter=14 t=7.3e-05 per=1.2e+01 cost=1.4e+04 flops=1.9e+08
 sigma[gemm] counter=14 i=0 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=4 t=8.5e-05 per=1.4e+01 cost=2.6e+03 flops=3.1e+07
 sigma[gemm] counter=14 i=5 t=8.8e-05 per=1.4e+01 cost=2.7e+03 flops=3.0e+07
 sigma[gemm] counter=14 i=6 t=8.1e-05 per=1.3e+01 cost=2.5e+03 flops=3.1e+07
 sigma[gemm] counter=14 i=7 t=8.2e-05 per=1.3e+01 cost=2.4e+03 flops=2.9e+07
 sigma[gemm] counter=14 total t=3.4e-04 per=5.6e+01 cost=1.0e+04 flops=3.0e+07
 sigma[red] counter=14 t=2.0e-04 per=3.2e+01 cost=4.1e+03 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=9.4e-04 t_gemm=3.7e-03 t_reduction=2.8e-03 tot=7.5e-03 -----
 sigma_tot[inter] counter=14 t=9.4e-04 per=1.3e+01 cost=1.0e+05 flops=1.1e+08
 sigma_tot[gemm] counter=14 i=0 t=3.0e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=2.7e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=2.7e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=3 t=2.7e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=4 t=9.6e-04 per=1.3e+01 cost=1.7e+04 flops=1.8e+07
 sigma_tot[gemm] counter=14 i=5 t=9.4e-04 per=1.3e+01 cost=1.7e+04 flops=1.8e+07
 sigma_tot[gemm] counter=14 i=6 t=8.6e-04 per=1.2e+01 cost=1.5e+04 flops=1.7e+07
 sigma_tot[gemm] counter=14 i=7 t=8.5e-04 per=1.1e+01 cost=1.4e+04 flops=1.7e+07
 sigma_tot[gemm] counter=14 total t=3.7e-03 per=5.0e+01 cost=6.3e+04 flops=1.7e+07
 sigma_tot[red] counter=14 t=2.8e-03 per=3.8e+01 cost=2.9e+04 flops=1.0e+07
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-06,7.9e-06,1.5e-06,9.2e-07,1.2e-07
    5   0 -    -116.215791754882 -6.585e-06  4.041e-04    3     5  4.208e-03 8.416e-04 8.072e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.875e-05,7.092e-05,3.413e-04,1.941e-04,6.679e-04
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.005e-05 speed=1.635e-02GB/S T(nccl)=3.871e-05 speed=8.469e-03GB/S
----- TIMING FOR sigma : t_inter=7.1e-05 t_gemm=3.4e-04 t_reduction=1.9e-04 tot=6.1e-04 -----
 sigma[inter] counter=15 t=7.1e-05 per=1.2e+01 cost=1.4e+04 flops=2.0e+08
 sigma[gemm] counter=15 i=0 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=3 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=4 t=8.4e-05 per=1.4e+01 cost=2.6e+03 flops=3.1e+07
 sigma[gemm] counter=15 i=5 t=8.8e-05 per=1.4e+01 cost=2.7e+03 flops=3.1e+07
 sigma[gemm] counter=15 i=6 t=8.1e-05 per=1.3e+01 cost=2.5e+03 flops=3.1e+07
 sigma[gemm] counter=15 i=7 t=8.1e-05 per=1.3e+01 cost=2.4e+03 flops=2.9e+07
 sigma[gemm] counter=15 total t=3.4e-04 per=5.6e+01 cost=1.0e+04 flops=3.0e+07
 sigma[red] counter=15 t=1.9e-04 per=3.2e+01 cost=4.1e+03 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.0e-03 t_gemm=4.1e-03 t_reduction=3.0e-03 tot=8.1e-03 -----
 sigma_tot[inter] counter=15 t=1.0e-03 per=1.2e+01 cost=1.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=15 i=0 t=3.2e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=2.9e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=2.9e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=3 t=2.9e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=4 t=1.0e-03 per=1.3e+01 cost=1.9e+04 flops=1.9e+07
 sigma_tot[gemm] counter=15 i=5 t=1.0e-03 per=1.3e+01 cost=2.0e+04 flops=1.9e+07
 sigma_tot[gemm] counter=15 i=6 t=9.5e-04 per=1.2e+01 cost=1.7e+04 flops=1.9e+07
 sigma_tot[gemm] counter=15 i=7 t=9.3e-04 per=1.2e+01 cost=1.7e+04 flops=1.8e+07
 sigma_tot[gemm] counter=15 total t=4.1e-03 per=5.0e+01 cost=7.3e+04 flops=1.8e+07
 sigma_tot[red] counter=15 t=3.0e-03 per=3.7e+01 cost=3.3e+04 flops=1.1e+07
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-06,7.9e-06,1.4e-06,8.4e-07,1.3e-07
    6   0 -    -116.215792238422 -4.835e-07  1.486e-04    3     6  5.102e-03 8.504e-04 8.170e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.451e-04,7.653e-05,3.420e-04,1.960e-04,1.363e-03
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.089e-05 speed=1.569e-02GB/S T(nccl)=7.242e-04 speed=4.527e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-05 t_gemm=3.4e-04 t_reduction=2.0e-04 tot=6.1e-04 -----
 sigma[inter] counter=16 t=7.6e-05 per=1.2e+01 cost=1.4e+04 flops=1.9e+08
 sigma[gemm] counter=16 i=0 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=4 t=8.5e-05 per=1.4e+01 cost=2.6e+03 flops=3.1e+07
 sigma[gemm] counter=16 i=5 t=8.7e-05 per=1.4e+01 cost=2.7e+03 flops=3.1e+07
 sigma[gemm] counter=16 i=6 t=8.2e-05 per=1.3e+01 cost=2.5e+03 flops=3.0e+07
 sigma[gemm] counter=16 i=7 t=8.1e-05 per=1.3e+01 cost=2.4e+03 flops=2.9e+07
 sigma[gemm] counter=16 total t=3.4e-04 per=5.6e+01 cost=1.0e+04 flops=3.0e+07
 sigma[red] counter=16 t=2.0e-04 per=3.2e+01 cost=4.1e+03 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-03 t_gemm=4.4e-03 t_reduction=3.2e-03 tot=8.7e-03 -----
 sigma_tot[inter] counter=16 t=1.1e-03 per=1.2e+01 cost=1.3e+05 flops=1.2e+08
 sigma_tot[gemm] counter=16 i=0 t=3.4e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=3.1e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=3.1e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=3 t=3.1e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=4 t=1.1e-03 per=1.3e+01 cost=2.2e+04 flops=2.0e+07
 sigma_tot[gemm] counter=16 i=5 t=1.1e-03 per=1.3e+01 cost=2.2e+04 flops=2.0e+07
 sigma_tot[gemm] counter=16 i=6 t=1.0e-03 per=1.2e+01 cost=2.0e+04 flops=1.9e+07
 sigma_tot[gemm] counter=16 i=7 t=1.0e-03 per=1.2e+01 cost=1.9e+04 flops=1.9e+07
 sigma_tot[gemm] counter=16 total t=4.4e-03 per=5.1e+01 cost=8.4e+04 flops=1.9e+07
 sigma_tot[red] counter=16 t=3.2e-03 per=3.7e+01 cost=3.7e+04 flops=1.2e+07
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.2e-06,8.2e-06,1.5e-06,9.2e-07,1.3e-07
    7   0 +    -116.215792300366 -6.194e-08  5.489e-05    3     7  6.588e-03 9.412e-04 9.086e-04
TIMING FOR Davidson : 6.597e-03  T(cal/comm/rest)=6.360e-03,1.352e-06,2.356e-04
decomposed t_rest=2.356e-04
 T(sub)    =9.072e-05 per=3.851e+01
 T(precond)=1.570e-05 per=6.664e+00
 T(ortho)  =8.147e-06 per=3.459e+00
 T(xcopy)  =8.460e-07 per=3.592e-01
 T(xnrm2)  =8.530e-07 per=3.621e-01
 T(other)  =1.193e-04 per=5.064e+01
optimized energies: isweep=0 ibond=2 dots=2 e[0]=-116.215792300366 nmvp=7
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=4.482e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=7 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=7 dimAll=15
 (5,1):3 (7,1):3 (6,0):3 (6,2):3 (8,0):1 (4,2):1 (5,3):1
timing for divide=6.8e-06
timing for compute=2.4e-05
timing for collect=3.1e-06
----- TMING FOR decimation_genbasis(su2): 3.3e-05 S T(divide/compute[cpu/gpu/rest]/collect)=6.8e-06,2.1e-05,0.0e+00,2.1e-06,3.1e-06 -----
decimation summary: 15->7 dwt=+0.000e+00 SvN=6.051e-01
 qbond: qkept nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
----- TIMING for decimation_row(nkr): 8.574e-04 S T(decim/select/formRot)=5.087e-05,7.620e-04,4.456e-05 -----
----- TIMING FOR twodot_decimation: 9.162e-04 S T(wf/decim)=5.291e-05,8.633e-04 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=362:2.762e-03MB:2.697e-06GB
        per(mem): C:13.3 S:26.5 H:5.25 A:2.49 B:52.5 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=7.145e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=23 : 3.197e-05 S -----
rank=0 GPUmem(GB): used=2.433e-05 (oper)=1.083e-05
rank=0 GPUmem(GB): used=2.448e-05 (oper,site)=1.083e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=23
 no. of rintermediate operators=5
 no. of coefficients=17:1.297e-04MB:1.267e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.810e-05 S -----
rank=0 GPUmem(GB): used=2.460e-05 (oper,site,rinter)=1.083e-05,1.416e-07,1.267e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.525e-04 S size(rtasks)=23 size(Rlst2)=9 T(Rmu/Rlist)=2.310e-05,1.294e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.612e-04 S size(rtasks)=23 size(Rlst)=109 -----
rank=0 GPUmem(GB): used=2.460e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.868e-05 blksize=9 blksize0=4 batchsize=109
rank=0 GPUmem(GB): used=4.328e-05 (oper,site,rinter,batch)=1.083e-05,1.416e-07,1.267e-07,1.868e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.370e-05,2.144e-04,8.856e-05
----- TIMING FOR renorm : t_inter=8.4e-05 t_gemm=2.1e-04 t_reduction=8.8e-05 tot=3.9e-04 -----
 renorm[inter] counter=38 t=8.4e-05 per=2.2e+01 cost=4.7e+02 flops=5.6e+06
 renorm[gemm] counter=38 i=0 t=2.0e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=1 t=1.9e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=2 t=1.8e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=3 t=1.8e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=4 t=6.9e-05 per=1.8e+01 cost=2.9e+02 flops=4.2e+06
 renorm[gemm] counter=38 i=5 t=7.2e-05 per=1.9e+01 cost=8.4e+02 flops=1.2e+07
 renorm[gemm] counter=38 i=6 t=6.6e-05 per=1.7e+01 cost=2.4e+03 flops=3.6e+07
 renorm[gemm] counter=38 total t=2.1e-04 per=5.5e+01 cost=3.5e+03 flops=1.6e+07
 renorm[red] counter=38 t=8.8e-05 per=2.3e+01 cost=1.6e+03 flops=1.8e+07
----- TIMING FOR renorm_tot : t_inter=1.6e-04 t_gemm=5.7e-04 t_reduction=2.8e-04 tot=1.0e-03 -----
 renorm_tot[inter] counter=38 t=1.6e-04 per=1.6e+01 cost=5.5e+02 flops=3.4e+06
 renorm_tot[gemm] counter=38 i=0 t=6.8e-06 per=6.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=1 t=5.8e-06 per=5.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=2 t=5.7e-06 per=5.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=3 t=5.7e-06 per=5.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=4 t=1.9e-04 per=1.9e+01 cost=3.4e+02 flops=1.8e+06
 renorm_tot[gemm] counter=38 i=5 t=1.8e-04 per=1.7e+01 cost=9.7e+02 flops=5.6e+06
 renorm_tot[gemm] counter=38 i=6 t=1.8e-04 per=1.8e+01 cost=2.8e+03 flops=1.5e+07
 renorm_tot[gemm] counter=38 total t=5.7e-04 per=5.7e+01 cost=4.1e+03 flops=7.1e+06
 renorm_tot[red] counter=38 t=2.8e-04 per=2.7e+01 cost=1.9e+03 flops=6.9e+06
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.711e-05 (oper)=1.092e-05
rank=0 GPUmem(GB): used=2.725e-05 (oper,site,rinter)=1.092e-05,1.416e-07,2.563e-06
rank=0 GPUmem(GB): used=3.051e-05 (oper,site,rinter,batch)=1.092e-05,1.416e-07,2.563e-06,3.256e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.772e-03 S T(preprocess/alloc/comp/red/dealloc)=9.886e-04,1.024e-03,4.289e-03,3.150e-04,1.146e-04 -----
----- TIMING FOR oper_renorm_opS : 5.796e-03 S rank=0 -----
qops.to_cpu: size(tot)=362:2.762e-03MB:2.697e-06GB T(to_cpu)=2.216e-05S speed=1.217e-01GB/S
check ||H-H.dagger||=5.227e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00692 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=4.245e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.023e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.669e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 2.204e-02 S #####
 T(local opt: fetch) = 2.163e-03 S  per = 9.81  per(accum) = 9.81
 T(local opt: hdiag) = 7.005e-04 S  per = 3.18  per(accum) = 13
 T(local opt: dvdsn) = 8.869e-03 S  per = 40.2  per(accum) = 53.2
 T(local opt: decim) = 9.385e-04 S  per = 4.26  per(accum) = 57.5
 T(local opt: guess) = 6.870e-05 S  per = 0.312  per(accum) = 57.8
 T(local opt: renrm) = 7.505e-03 S  per = 34.1  per(accum) = 91.9
 T(local opt: save ) = 1.794e-03 S  per = 8.14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.869e-03 S  T(sum) = 8.671e-03 S  per = 9.776e+01
 T(local opt: preprocess                  ) = 2.352e-04 S  per = 2.71  per(accum) = 2.71
 T(local opt: symbolic_formulae           ) = 2.263e-04 S  per = 2.61  per(accum) = 5.32
 T(local opt: hintermediate init          ) = 3.460e-05 S  per = 0.399  per(accum) = 5.72
 T(local opt: preprocess_hformulae_Hxlist ) = 1.301e-03 S  per =   15  per(accum) = 20.7
 T(local opt: hmmtasks init               ) = 1.859e-04 S  per = 2.14  per(accum) = 22.9
 T(local opt: initial guess for dvdson    ) = 9.085e-05 S  per = 1.05  per(accum) = 23.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.247e-03 S  per = 60.5  per(accum) = 84.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.441e-04 S  per = 1.66  per(accum) = 86.1
 T(local opt: dvdson [nccl]               ) = 9.692e-04 S  per = 11.2  per(accum) = 97.3
 T(local opt: dvdson [mpi]                ) = 1.352e-06 S  per = 0.0156  per(accum) = 97.3
 T(local opt: dvdson [rest part(linalg)]  ) = 2.356e-04 S  per = 2.72  per(accum) = 100
Detailed decomposition of T(renrm) = 7.505e-03 S  T(sum) = 7.505e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.155e-05 S  per = 0.554  per(accum) = 0.554
 T(local opt: qops init                    ) = 2.059e-04 S  per = 2.74  per(accum) = 3.3
 T(local opt: symbolic_formulae_renorm     ) = 3.608e-05 S  per = 0.481  per(accum) = 3.78
 T(local opt: allocate qops on gpu         ) = 4.436e-05 S  per = 0.591  per(accum) = 4.37
 T(local opt: site memcpy cpu2gpu          ) = 2.102e-05 S  per = 0.28  per(accum) = 4.65
 T(local opt: rintermediate init           ) = 2.455e-05 S  per = 0.327  per(accum) = 4.98
 T(local opt: preprocess_formulae_Rlist2   ) = 1.644e-04 S  per = 2.19  per(accum) = 7.17
 T(local opt: rmmtasks init                ) = 8.000e-05 S  per = 1.07  per(accum) = 8.23
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.00052  per(accum) = 8.23
 T(local opt: preprocess_renorm_batchGPU   ) = 4.691e-04 S  per = 6.25  per(accum) = 14.5
 T(local opt: deallocate cpu and gpu memory) = 2.093e-05 S  per = 0.279  per(accum) = 14.8
 T(local opt: construct opS [ifdists=true] ) = 5.802e-03 S  per = 77.3  per(accum) = 92.1
 T(local opt: reduction of opS & opH [nccl]) = 1.898e-05 S  per = 0.253  per(accum) = 92.3
 T(local opt: qops memcpy gpu2cpu          ) = 2.591e-05 S  per = 0.345  per(accum) = 92.7
 T(local opt: reduction of opS & opH [mpi] ) = 7.839e-06 S  per = 0.104  per(accum) = 92.8
 T(local opt: qops_pool join and erase     ) = 5.396e-04 S  per = 7.19  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.026e-06 S  per = 0.0403  per(accum) = 100
ctns::rcanon_save_site idx=16 scratch=./scratch/sweep size=19:1.4e-07GB T(load)=0.00053S speed=0.00027GB/S
##### sweep opt: 6.153e-02 S #####
 T(sweep opt: fetch) = 1.060e-02 S  per = 17.2  per(accum) = 17.2
 T(sweep opt: hdiag) = 1.659e-03 S  per =  2.7  per(accum) = 19.9
 T(sweep opt: dvdsn) = 1.957e-02 S  per = 31.8  per(accum) = 51.7
 T(sweep opt: decim) = 2.958e-03 S  per = 4.81  per(accum) = 56.5
 T(sweep opt: guess) = 2.182e-04 S  per = 0.355  per(accum) = 56.9
 T(sweep opt: renrm) = 2.121e-02 S  per = 34.5  per(accum) = 91.4
 T(sweep opt: save ) = 5.308e-03 S  per = 8.63  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.957e-02 S  T(sum) = 1.886e-02 S  per = 9.638e+01
 T(sweep opt: preprocess                  ) = 9.459e-04 S  per = 5.01  per(accum) = 5.01
 T(sweep opt: symbolic_formulae           ) = 6.171e-04 S  per = 3.27  per(accum) = 8.29
 T(sweep opt: hintermediate init          ) = 1.454e-04 S  per = 0.771  per(accum) = 9.06
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.763e-03 S  per = 14.6  per(accum) = 23.7
 T(sweep opt: hmmtasks init               ) = 4.718e-04 S  per =  2.5  per(accum) = 26.2
 T(sweep opt: initial guess for dvdson    ) = 3.172e-04 S  per = 1.68  per(accum) = 27.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.115e-02 S  per = 59.1  per(accum) = 87
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.357e-04 S  per = 1.78  per(accum) = 88.8
 T(sweep opt: dvdson [nccl]               ) = 1.342e-03 S  per = 7.12  per(accum) = 95.9
 T(sweep opt: dvdson [mpi]                ) = 5.106e-06 S  per = 0.0271  per(accum) = 95.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.743e-04 S  per =  4.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.121e-02 S  T(sum) = 2.121e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.262e-04 S  per = 0.595  per(accum) = 0.595
 T(sweep opt: qops init                    ) = 6.419e-04 S  per = 3.03  per(accum) = 3.62
 T(sweep opt: symbolic_formulae_renorm     ) = 9.885e-05 S  per = 0.466  per(accum) = 4.09
 T(sweep opt: allocate qops on gpu         ) = 1.451e-04 S  per = 0.684  per(accum) = 4.77
 T(sweep opt: site memcpy cpu2gpu          ) = 6.647e-05 S  per = 0.313  per(accum) = 5.08
 T(sweep opt: rintermediate init           ) = 7.945e-05 S  per = 0.375  per(accum) = 5.46
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.409e-04 S  per = 1.61  per(accum) = 7.07
 T(sweep opt: rmmtasks init                ) = 2.257e-04 S  per = 1.06  per(accum) = 8.13
 T(sweep opt: qops memset on cpu           ) = 1.050e-07 S  per = 0.000495  per(accum) = 8.13
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.351e-03 S  per = 6.37  per(accum) = 14.5
 T(sweep opt: deallocate cpu and gpu memory) = 6.067e-05 S  per = 0.286  per(accum) = 14.8
 T(sweep opt: construct opS [ifdists=true] ) = 1.580e-02 S  per = 74.5  per(accum) = 89.3
 T(sweep opt: reduction of opS & opH [nccl]) = 5.608e-05 S  per = 0.264  per(accum) = 89.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.018e-05 S  per = 0.378  per(accum) = 89.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.414e-05 S  per = 0.114  per(accum) = 90
 T(sweep opt: qops_pool join and erase     ) = 2.105e-03 S  per = 9.92  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 5.828e-06 S  per = 0.0275  per(accum) = 100
##### global opt: 6.153e-02 S #####
 T(global opt: fetch) = 1.060e-02 S  per = 17.2  per(accum) = 17.2
 T(global opt: hdiag) = 1.659e-03 S  per =  2.7  per(accum) = 19.9
 T(global opt: dvdsn) = 1.957e-02 S  per = 31.8  per(accum) = 51.7
 T(global opt: decim) = 2.958e-03 S  per = 4.81  per(accum) = 56.5
 T(global opt: guess) = 2.182e-04 S  per = 0.355  per(accum) = 56.9
 T(global opt: renrm) = 2.121e-02 S  per = 34.5  per(accum) = 91.4
 T(global opt: save ) = 5.308e-03 S  per = 8.63  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.957e-02 S  T(sum) = 1.886e-02 S  per = 9.638e+01
 T(global opt: preprocess                  ) = 9.459e-04 S  per = 5.01  per(accum) = 5.01
 T(global opt: symbolic_formulae           ) = 6.171e-04 S  per = 3.27  per(accum) = 8.29
 T(global opt: hintermediate init          ) = 1.454e-04 S  per = 0.771  per(accum) = 9.06
 T(global opt: preprocess_hformulae_Hxlist ) = 2.763e-03 S  per = 14.6  per(accum) = 23.7
 T(global opt: hmmtasks init               ) = 4.718e-04 S  per =  2.5  per(accum) = 26.2
 T(global opt: initial guess for dvdson    ) = 3.172e-04 S  per = 1.68  per(accum) = 27.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.115e-02 S  per = 59.1  per(accum) = 87
 T(global opt: dvdson [cpu-gpu]            ) = 3.357e-04 S  per = 1.78  per(accum) = 88.8
 T(global opt: dvdson [nccl]               ) = 1.342e-03 S  per = 7.12  per(accum) = 95.9
 T(global opt: dvdson [mpi]                ) = 5.106e-06 S  per = 0.0271  per(accum) = 95.9
 T(global opt: dvdson [rest part(linalg)]  ) = 7.743e-04 S  per =  4.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.121e-02 S  T(sum) = 2.121e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.262e-04 S  per = 0.595  per(accum) = 0.595
 T(global opt: qops init                    ) = 6.419e-04 S  per = 3.03  per(accum) = 3.62
 T(global opt: symbolic_formulae_renorm     ) = 9.885e-05 S  per = 0.466  per(accum) = 4.09
 T(global opt: allocate qops on gpu         ) = 1.451e-04 S  per = 0.684  per(accum) = 4.77
 T(global opt: site memcpy cpu2gpu          ) = 6.647e-05 S  per = 0.313  per(accum) = 5.08
 T(global opt: rintermediate init           ) = 7.945e-05 S  per = 0.375  per(accum) = 5.46
 T(global opt: preprocess_formulae_Rlist2   ) = 3.409e-04 S  per = 1.61  per(accum) = 7.07
 T(global opt: rmmtasks init                ) = 2.257e-04 S  per = 1.06  per(accum) = 8.13
 T(global opt: qops memset on cpu           ) = 1.050e-07 S  per = 0.000495  per(accum) = 8.13
 T(global opt: preprocess_renorm_batchGPU   ) = 1.351e-03 S  per = 6.37  per(accum) = 14.5
 T(global opt: deallocate cpu and gpu memory) = 6.067e-05 S  per = 0.286  per(accum) = 14.8
 T(global opt: construct opS [ifdists=true] ) = 1.580e-02 S  per = 74.5  per(accum) = 89.3
 T(global opt: reduction of opS & opH [nccl]) = 5.608e-05 S  per = 0.264  per(accum) = 89.6
 T(global opt: qops memcpy gpu2cpu          ) = 8.018e-05 S  per = 0.378  per(accum) = 89.9
 T(global opt: reduction of opS & opH [mpi] ) = 2.414e-05 S  per = 0.114  per(accum) = 90
 T(global opt: qops_pool join and erase     ) = 2.105e-03 S  per = 9.92  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 5.828e-06 S  per = 0.0275  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-4.515e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=3/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=14 scratch=./scratch/sweep size=100:7.45e-07GB T(load)=3.29e-04S speed=2.27e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=172:1.31e-03MB:1.28e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=22:1.68e-04MB:1.64e-07GB
total mem of comb=195:1.49e-03MB:1.45e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.512e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=362:2.762e-03MB:2.697e-06GB
        per(mem): C:13.3 S:26.5 H:5.25 A:2.49 B:52.5 
 rqops: oplist=CSHPQ nops=C:14 S:2 H:1 P:18 Q:20 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=2305:0.0176MB:1.72e-05GB
        per(mem): C:13.4 S:1.91 H:2.3 P:0 Q:82.4 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4663:0.0356MB:3.47e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.006e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,17,3,3) nnz=119:9.079e-04MB
qtensor4: wf4 own=1 _data=0x5585ee522000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
 qbond: qcol nsym=7 dimAll=17
 (21,1):3 (21,3):4 (21,5):4 (21,7):3 (22,2):1 (22,4):1 (22,6):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=336 size=119:9.079e-04MB
### DIAG TIMING: total=1.373e-03 t1=1.666e-05, t2=1.797e-05, t3=1.617e-05, t4=1.271e-03, t5=7.250e-06, t6=3.717e-05, t7=7.429e-06
duration_diagGPU:1.382e-03
duration_diagreduce:3.600e-08
duration_diagtransform:5.390e-07
----- TIMING FOR symbolic_formulae_twodot with size=191 : 3.045e-04 S -----
rank=0 GPUmem(GB): used=3.474e-05 (oper)=3.474e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=191
 no. of hintermediate operators=91
 no. of coefficients=1173:8.949e-03MB:8.740e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.088e-05 S -----
rank=0 GPUmem(GB): used=4.348e-05 (oper,hinter)=3.474e-05,8.740e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.878e-03 S size(H_formulae)=191 size(Hxlst2)=21 T(Hmu/Hxlist)=8.766e-05,7.791e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.282e-03 S size(H_formulae)=191 size(Hxlst)=3856 -----
rank=0 GPUmem(GB): used=4.348e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.773e-06 batch[need]=9.768e-04 blksize=12 blksize0=9 batchsize=3856
rank=0 GPUmem(GB): used=1.022e-03 (oper,hinter,dvdson,batch)=3.474e-05,8.740e-06,1.773e-06,9.768e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=119 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.793e-05,1.133e-04,5.174e-04,6.027e-04,1.320e-03
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=2.421e-05 speed=7.326e-02GB/S T(nccl)=5.373e-05 speed=3.301e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=5.2e-04 t_reduction=6.0e-04 tot=1.2e-03 -----
 sigma[inter] counter=17 t=1.1e-04 per=9.2e+00 cost=1.5e+05 flops=1.3e+09
 sigma[gemm] counter=17 i=0 t=8.1e-06 per=6.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=3.0e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=2.5e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=3 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=4 t=1.4e-04 per=1.1e+01 cost=3.5e+04 flops=2.5e+08
 sigma[gemm] counter=17 i=5 t=1.6e-04 per=1.3e+01 cost=3.5e+04 flops=2.3e+08
 sigma[gemm] counter=17 i=6 t=1.1e-04 per=8.6e+00 cost=5.0e+04 flops=4.8e+08
 sigma[gemm] counter=17 i=7 t=1.0e-04 per=8.2e+00 cost=4.9e+04 flops=4.9e+08
 sigma[gemm] counter=17 total t=5.2e-04 per=4.2e+01 cost=1.7e+05 flops=3.3e+08
 sigma[red] counter=17 t=6.0e-04 per=4.9e+01 cost=4.6e+04 flops=7.6e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-03 t_gemm=4.9e-03 t_reduction=3.8e-03 tot=9.9e-03 -----
 sigma_tot[inter] counter=17 t=1.2e-03 per=1.2e+01 cost=2.8e+05 flops=2.3e+08
 sigma_tot[gemm] counter=17 i=0 t=4.2e-05 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=3.4e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=3.3e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=3 t=3.3e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=4 t=1.3e-03 per=1.3e+01 cost=5.7e+04 flops=4.5e+07
 sigma_tot[gemm] counter=17 i=5 t=1.3e-03 per=1.3e+01 cost=5.8e+04 flops=4.5e+07
 sigma_tot[gemm] counter=17 i=6 t=1.1e-03 per=1.1e+01 cost=7.0e+04 flops=6.2e+07
 sigma_tot[gemm] counter=17 i=7 t=1.1e-03 per=1.1e+01 cost=6.8e+04 flops=6.1e+07
 sigma_tot[gemm] counter=17 total t=4.9e-03 per=5.0e+01 cost=2.5e+05 flops=5.1e+07
 sigma_tot[red] counter=17 t=3.8e-03 per=3.8e+01 cost=8.2e+04 flops=2.2e+07
T(sub)=8.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,2.9e-06,1.2e-06,1.2e-06,3.0e-07
settings: ndim=119 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.215792300366 -1.116e+03  9.651e-03    1     1  1.636e-03 1.636e-03 1.603e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.035e-05,1.032e-04,5.979e-04,6.250e-04,1.401e-03
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=2.371e-05 speed=7.478e-02GB/S T(nccl)=4.664e-05 speed=3.802e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=6.0e-04 t_reduction=6.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=18 t=1.0e-04 per=7.8e+00 cost=1.5e+05 flops=1.5e+09
 sigma[gemm] counter=18 i=0 t=2.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=4 t=1.6e-04 per=1.2e+01 cost=3.5e+04 flops=2.2e+08
 sigma[gemm] counter=18 i=5 t=1.9e-04 per=1.5e+01 cost=3.5e+04 flops=1.8e+08
 sigma[gemm] counter=18 i=6 t=1.2e-04 per=9.1e+00 cost=5.0e+04 flops=4.2e+08
 sigma[gemm] counter=18 i=7 t=1.2e-04 per=9.0e+00 cost=4.9e+04 flops=4.1e+08
 sigma[gemm] counter=18 total t=6.0e-04 per=4.5e+01 cost=1.7e+05 flops=2.8e+08
 sigma[red] counter=18 t=6.2e-04 per=4.7e+01 cost=4.6e+04 flops=7.3e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-03 t_gemm=5.5e-03 t_reduction=4.4e-03 tot=1.1e-02 -----
 sigma_tot[inter] counter=18 t=1.3e-03 per=1.2e+01 cost=4.3e+05 flops=3.3e+08
 sigma_tot[gemm] counter=18 i=0 t=4.5e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=3.6e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=3.6e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=3 t=3.5e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=4 t=1.4e-03 per=1.3e+01 cost=9.1e+04 flops=6.4e+07
 sigma_tot[gemm] counter=18 i=5 t=1.5e-03 per=1.3e+01 cost=9.3e+04 flops=6.3e+07
 sigma_tot[gemm] counter=18 i=6 t=1.3e-03 per=1.1e+01 cost=1.2e+05 flops=9.6e+07
 sigma_tot[gemm] counter=18 i=7 t=1.2e-03 per=1.1e+01 cost=1.2e+05 flops=9.5e+07
 sigma_tot[gemm] counter=18 total t=5.5e-03 per=4.9e+01 cost=4.2e+05 flops=7.7e+07
 sigma_tot[red] counter=18 t=4.4e-03 per=3.9e+01 cost=1.3e+05 flops=2.9e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.1e-05,3.6e-06,1.6e-06,3.2e-07
    2   0 -    -116.216193153148 -4.009e-04  2.956e-03    2     2  3.331e-03 1.665e-03 1.610e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.798e-05,1.023e-04,5.311e-04,5.908e-04,1.297e-03
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=2.268e-05 speed=7.817e-02GB/S T(nccl)=4.530e-05 speed=3.915e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=5.3e-04 t_reduction=5.9e-04 tot=1.2e-03 -----
 sigma[inter] counter=19 t=1.0e-04 per=8.4e+00 cost=1.5e+05 flops=1.5e+09
 sigma[gemm] counter=19 i=0 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=4 t=1.5e-04 per=1.2e+01 cost=3.5e+04 flops=2.3e+08
 sigma[gemm] counter=19 i=5 t=1.6e-04 per=1.3e+01 cost=3.5e+04 flops=2.2e+08
 sigma[gemm] counter=19 i=6 t=1.0e-04 per=8.6e+00 cost=5.0e+04 flops=4.8e+08
 sigma[gemm] counter=19 i=7 t=1.0e-04 per=8.6e+00 cost=4.9e+04 flops=4.7e+08
 sigma[gemm] counter=19 total t=5.3e-04 per=4.3e+01 cost=1.7e+05 flops=3.2e+08
 sigma[red] counter=19 t=5.9e-04 per=4.8e+01 cost=4.6e+04 flops=7.7e+07
----- TIMING FOR sigma_tot : t_inter=1.4e-03 t_gemm=6.1e-03 t_reduction=5.0e-03 tot=1.2e-02 -----
 sigma_tot[inter] counter=19 t=1.4e-03 per=1.1e+01 cost=5.8e+05 flops=4.1e+08
 sigma_tot[gemm] counter=19 i=0 t=4.7e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=3.8e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=3.8e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=3 t=3.7e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=4 t=1.6e-03 per=1.3e+01 cost=1.3e+05 flops=8.0e+07
 sigma_tot[gemm] counter=19 i=5 t=1.6e-03 per=1.3e+01 cost=1.3e+05 flops=7.9e+07
 sigma_tot[gemm] counter=19 i=6 t=1.4e-03 per=1.1e+01 cost=1.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=19 i=7 t=1.3e-03 per=1.1e+01 cost=1.7e+05 flops=1.2e+08
 sigma_tot[gemm] counter=19 total t=6.1e-03 per=4.9e+01 cost=5.9e+05 flops=9.8e+07
 sigma_tot[red] counter=19 t=5.0e-03 per=4.0e+01 cost=1.7e+05 flops=3.5e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,2.3e-06,1.5e-06,2.4e-07
    3   0 -    -116.216231819045 -3.867e-05  1.098e-03    3     3  4.777e-03 1.592e-03 1.540e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.442e-05,8.987e-05,5.191e-04,5.833e-04,1.260e-03
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=2.155e-05 speed=8.230e-02GB/S T(nccl)=4.288e-05 speed=4.136e-02GB/S
----- TIMING FOR sigma : t_inter=9.0e-05 t_gemm=5.2e-04 t_reduction=5.8e-04 tot=1.2e-03 -----
 sigma[inter] counter=20 t=9.0e-05 per=7.5e+00 cost=1.5e+05 flops=1.7e+09
 sigma[gemm] counter=20 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=3 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=4 t=1.3e-04 per=1.1e+01 cost=3.5e+04 flops=2.6e+08
 sigma[gemm] counter=20 i=5 t=1.7e-04 per=1.4e+01 cost=3.5e+04 flops=2.1e+08
 sigma[gemm] counter=20 i=6 t=1.1e-04 per=8.9e+00 cost=5.0e+04 flops=4.7e+08
 sigma[gemm] counter=20 i=7 t=1.1e-04 per=8.8e+00 cost=4.9e+04 flops=4.7e+08
 sigma[gemm] counter=20 total t=5.2e-04 per=4.4e+01 cost=1.7e+05 flops=3.3e+08
 sigma[red] counter=20 t=5.8e-04 per=4.9e+01 cost=4.6e+04 flops=7.8e+07
----- TIMING FOR sigma_tot : t_inter=1.5e-03 t_gemm=6.6e-03 t_reduction=5.6e-03 tot=1.4e-02 -----
 sigma_tot[inter] counter=20 t=1.5e-03 per=1.1e+01 cost=7.3e+05 flops=4.9e+08
 sigma_tot[gemm] counter=20 i=0 t=4.9e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=4.0e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=4.0e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=3 t=3.9e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=4 t=1.7e-03 per=1.2e+01 cost=1.6e+05 flops=9.4e+07
 sigma_tot[gemm] counter=20 i=5 t=1.8e-03 per=1.3e+01 cost=1.6e+05 flops=9.1e+07
 sigma_tot[gemm] counter=20 i=6 t=1.5e-03 per=1.1e+01 cost=2.2e+05 flops=1.5e+08
 sigma_tot[gemm] counter=20 i=7 t=1.4e-03 per=1.1e+01 cost=2.2e+05 flops=1.5e+08
 sigma_tot[gemm] counter=20 total t=6.6e-03 per=4.8e+01 cost=7.6e+05 flops=1.2e+08
 sigma_tot[red] counter=20 t=5.6e-03 per=4.1e+01 cost=2.2e+05 flops=3.9e+07
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,2.0e-06,1.3e-06,1.9e-07
    4   0 -    -116.216235377587 -3.559e-06  3.848e-04    3     4  6.184e-03 1.546e-03 1.495e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.449e-05,8.759e-05,5.109e-04,5.831e-04,1.250e-03
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=2.171e-05 speed=8.167e-02GB/S T(nccl)=4.277e-05 speed=4.146e-02GB/S
----- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=5.1e-04 t_reduction=5.8e-04 tot=1.2e-03 -----
 sigma[inter] counter=21 t=8.8e-05 per=7.4e+00 cost=1.5e+05 flops=1.7e+09
 sigma[gemm] counter=21 i=0 t=2.1e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=3 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=4 t=1.3e-04 per=1.1e+01 cost=3.5e+04 flops=2.6e+08
 sigma[gemm] counter=21 i=5 t=1.6e-04 per=1.3e+01 cost=3.5e+04 flops=2.2e+08
 sigma[gemm] counter=21 i=6 t=1.1e-04 per=9.1e+00 cost=5.0e+04 flops=4.7e+08
 sigma[gemm] counter=21 i=7 t=1.0e-04 per=8.9e+00 cost=4.9e+04 flops=4.7e+08
 sigma[gemm] counter=21 total t=5.1e-04 per=4.3e+01 cost=1.7e+05 flops=3.3e+08
 sigma[red] counter=21 t=5.8e-04 per=4.9e+01 cost=4.6e+04 flops=7.8e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-03 t_gemm=7.1e-03 t_reduction=6.2e-03 tot=1.5e-02 -----
 sigma_tot[inter] counter=21 t=1.6e-03 per=1.1e+01 cost=8.8e+05 flops=5.6e+08
 sigma_tot[gemm] counter=21 i=0 t=5.1e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=4.2e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=4.2e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=3 t=4.1e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=4 t=1.8e-03 per=1.2e+01 cost=1.9e+05 flops=1.1e+08
 sigma_tot[gemm] counter=21 i=5 t=2.0e-03 per=1.3e+01 cost=2.0e+05 flops=1.0e+08
 sigma_tot[gemm] counter=21 i=6 t=1.6e-03 per=1.1e+01 cost=2.7e+05 flops=1.7e+08
 sigma_tot[gemm] counter=21 i=7 t=1.5e-03 per=1.0e+01 cost=2.7e+05 flops=1.7e+08
 sigma_tot[gemm] counter=21 total t=7.1e-03 per=4.8e+01 cost=9.3e+05 flops=1.3e+08
 sigma_tot[red] counter=21 t=6.2e-03 per=4.2e+01 cost=2.6e+05 flops=4.3e+07
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,2.0e-06,1.3e-06,1.9e-07
    5   0 -    -116.216235753288 -3.757e-07  1.510e-04    3     5  7.674e-03 1.535e-03 1.486e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.704e-05,8.773e-05,5.175e-04,5.882e-04,1.264e-03
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=2.235e-05 speed=7.933e-02GB/S T(nccl)=4.468e-05 speed=3.968e-02GB/S
----- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=5.2e-04 t_reduction=5.9e-04 tot=1.2e-03 -----
 sigma[inter] counter=22 t=8.8e-05 per=7.4e+00 cost=1.5e+05 flops=1.7e+09
 sigma[gemm] counter=22 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=3 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=4 t=1.3e-04 per=1.1e+01 cost=3.5e+04 flops=2.6e+08
 sigma[gemm] counter=22 i=5 t=1.6e-04 per=1.3e+01 cost=3.5e+04 flops=2.2e+08
 sigma[gemm] counter=22 i=6 t=1.1e-04 per=9.4e+00 cost=5.0e+04 flops=4.5e+08
 sigma[gemm] counter=22 i=7 t=1.0e-04 per=8.7e+00 cost=4.9e+04 flops=4.7e+08
 sigma[gemm] counter=22 total t=5.2e-04 per=4.3e+01 cost=1.7e+05 flops=3.3e+08
 sigma[red] counter=22 t=5.9e-04 per=4.9e+01 cost=4.6e+04 flops=7.7e+07
----- TIMING FOR sigma_tot : t_inter=1.7e-03 t_gemm=7.6e-03 t_reduction=6.8e-03 tot=1.6e-02 -----
 sigma_tot[inter] counter=22 t=1.7e-03 per=1.0e+01 cost=1.0e+06 flops=6.2e+08
 sigma_tot[gemm] counter=22 i=0 t=5.3e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=4.4e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=4.4e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=3 t=4.3e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=4 t=2.0e-03 per=1.2e+01 cost=2.3e+05 flops=1.2e+08
 sigma_tot[gemm] counter=22 i=5 t=2.1e-03 per=1.3e+01 cost=2.3e+05 flops=1.1e+08
 sigma_tot[gemm] counter=22 i=6 t=1.7e-03 per=1.1e+01 cost=3.2e+05 flops=1.9e+08
 sigma_tot[gemm] counter=22 i=7 t=1.7e-03 per=1.0e+01 cost=3.2e+05 flops=1.9e+08
 sigma_tot[gemm] counter=22 total t=7.6e-03 per=4.7e+01 cost=1.1e+06 flops=1.4e+08
 sigma_tot[red] counter=22 t=6.8e-03 per=4.2e+01 cost=3.1e+05 flops=4.6e+07
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,1.9e-06,1.3e-06,2.0e-07
    6   0 +    -116.216235822396 -6.911e-08  5.084e-05    3     6  9.163e-03 1.527e-03 1.479e-03
TIMING FOR Davidson : 9.174e-03  T(cal/comm/rest)=8.875e-03,1.740e-06,2.972e-04
decomposed t_rest=2.972e-04
 T(sub)    =1.107e-04 per=3.726e+01
 T(precond)=1.742e-05 per=5.859e+00
 T(ortho)  =9.823e-06 per=3.305e+00
 T(xcopy)  =8.800e-07 per=2.961e-01
 T(xnrm2)  =1.230e-06 per=4.138e-01
 T(other)  =1.572e-04 per=5.287e+01
optimized energies: isweep=0 ibond=3 dots=2 e[0]=-116.216235822396 nmvp=6
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=6.561e-04 change=1.199e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=8 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=8 dimAll=28
 (7,1):6 (9,1):3 (8,0):3 (8,2):6 (6,2):4 (7,3):4 (5,3):1 (6,4):1
timing for divide=7.8e-06
timing for compute=4.3e-05
timing for collect=4.6e-06
----- TMING FOR decimation_genbasis(su2): 5.6e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.8e-06,4.1e-05,0.0e+00,2.1e-06,4.6e-06 -----
decimation summary: 28->10 dwt=+1.070e-06 SvN=4.910e-01
 qbond: qkept nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
----- TIMING for decimation_row(nkr): 9.617e-04 S T(decim/select/formRot)=7.563e-05,8.702e-04,1.589e-05 -----
----- TIMING FOR twodot_decimation: 1.035e-03 S T(wf/decim)=6.742e-05,9.678e-04 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:5 S:8 H:1 A:12 B:16 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=778:5.936e-03MB:5.797e-06GB
        per(mem): C:13.5 S:21.6 H:2.57 A:10.9 B:51.4 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=6.561e-04 change=1.087e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=34 : 4.498e-05 S -----
rank=0 GPUmem(GB): used=3.210e-05 (oper)=1.593e-05
rank=0 GPUmem(GB): used=3.245e-05 (oper,site)=1.593e-05,3.427e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=34
 no. of rintermediate operators=5
 no. of coefficients=25:1.907e-04MB:1.863e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.112e-05 S -----
rank=0 GPUmem(GB): used=3.263e-05 (oper,site,rinter)=1.593e-05,3.427e-07,1.863e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 4.234e-04 S size(rtasks)=34 size(Rlst2)=36 T(Rmu/Rlist)=2.280e-05,4.005e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.388e-04 S size(rtasks)=34 size(Rlst)=328 -----
rank=0 GPUmem(GB): used=3.263e-05 avail=3.829e+01 total=3.829e+01 batch[need]=6.843e-05 blksize=9 blksize0=9 batchsize=328
rank=0 GPUmem(GB): used=1.011e-04 (oper,site,rinter,batch)=1.593e-05,3.427e-07,1.863e-07,6.843e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.141e-05,2.899e-04,1.790e-04
----- TIMING FOR renorm : t_inter=8.1e-05 t_gemm=2.9e-04 t_reduction=1.8e-04 tot=5.5e-04 -----
 renorm[inter] counter=55 t=8.1e-05 per=1.5e+01 cost=3.1e+03 flops=3.8e+07
 renorm[gemm] counter=55 i=0 t=2.2e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=1 t=1.9e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=2 t=2.0e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=3 t=2.0e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=4 t=8.6e-05 per=1.6e+01 cost=1.1e+03 flops=1.3e+07
 renorm[gemm] counter=55 i=5 t=8.7e-05 per=1.6e+01 cost=5.8e+03 flops=6.6e+07
 renorm[gemm] counter=55 i=6 t=1.1e-04 per=2.0e+01 cost=6.7e+03 flops=6.2e+07
 renorm[gemm] counter=55 total t=2.9e-04 per=5.3e+01 cost=1.4e+04 flops=4.7e+07
 renorm[red] counter=55 t=1.8e-04 per=3.3e+01 cost=2.4e+03 flops=1.4e+07
----- TIMING FOR renorm_tot : t_inter=2.4e-04 t_gemm=8.6e-04 t_reduction=4.6e-04 tot=1.6e-03 -----
 renorm_tot[inter] counter=55 t=2.4e-04 per=1.6e+01 cost=3.6e+03 flops=1.5e+07
 renorm_tot[gemm] counter=55 i=0 t=8.9e-06 per=5.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=1 t=7.7e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=2 t=7.7e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=3 t=7.7e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=4 t=2.8e-04 per=1.8e+01 cost=1.5e+03 flops=5.3e+06
 renorm_tot[gemm] counter=55 i=5 t=2.6e-04 per=1.7e+01 cost=6.7e+03 flops=2.6e+07
 renorm_tot[gemm] counter=55 i=6 t=2.9e-04 per=1.8e+01 cost=9.4e+03 flops=3.3e+07
 renorm_tot[gemm] counter=55 total t=8.6e-04 per=5.5e+01 cost=1.8e+04 flops=2.1e+07
 renorm_tot[red] counter=55 t=4.6e-04 per=2.9e+01 cost=4.4e+03 flops=9.5e+06
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.629e-05 (oper)=1.609e-05
rank=0 GPUmem(GB): used=3.663e-05 (oper,site,rinter)=1.609e-05,3.427e-07,3.844e-06
rank=0 GPUmem(GB): used=4.999e-05 (oper,site,rinter,batch)=1.609e-05,3.427e-07,3.844e-06,1.335e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.908e-03 S T(preprocess/alloc/comp/red/dealloc)=1.953e-03,1.992e-03,4.492e-03,2.832e-04,1.121e-04 -----
----- TIMING FOR oper_renorm_opS : 6.930e-03 S rank=0 -----
qops.to_cpu: size(tot)=778:5.936e-03MB:5.797e-06GB T(to_cpu)=2.483e-05S speed=2.335e-01GB/S
check ||H-H.dagger||=7.191e-15 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.00872 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=4.120e-04 change=1.041e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=9.918e-04 change=-1.121e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=9.918e-04 change=-3.427e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 3.588e-02 S #####
 T(local opt: fetch) = 2.191e-03 S  per = 6.11  per(accum) = 6.11
 T(local opt: hdiag) = 1.441e-03 S  per = 4.02  per(accum) = 10.1
 T(local opt: dvdsn) = 1.992e-02 S  per = 55.5  per(accum) = 65.7
 T(local opt: decim) = 1.061e-03 S  per = 2.96  per(accum) = 68.6
 T(local opt: guess) = 1.048e-04 S  per = 0.292  per(accum) = 68.9
 T(local opt: renrm) = 9.343e-03 S  per =   26  per(accum) = 94.9
 T(local opt: save ) = 1.813e-03 S  per = 5.05  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.992e-02 S  T(sum) = 1.969e-02 S  per = 9.883e+01
 T(local opt: preprocess                  ) = 2.699e-04 S  per = 1.37  per(accum) = 1.37
 T(local opt: symbolic_formulae           ) = 3.091e-04 S  per = 1.57  per(accum) = 2.94
 T(local opt: hintermediate init          ) = 3.812e-05 S  per = 0.194  per(accum) = 3.13
 T(local opt: preprocess_hformulae_Hxlist ) = 8.373e-03 S  per = 42.5  per(accum) = 45.7
 T(local opt: hmmtasks init               ) = 1.377e-03 S  per = 6.99  per(accum) = 52.7
 T(local opt: initial guess for dvdson    ) = 1.470e-04 S  per = 0.747  per(accum) = 53.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 8.463e-03 S  per =   43  per(accum) = 96.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.362e-04 S  per = 0.692  per(accum) = 97.1
 T(local opt: dvdson [nccl]               ) = 2.760e-04 S  per =  1.4  per(accum) = 98.5
 T(local opt: dvdson [mpi]                ) = 1.740e-06 S  per = 0.00884  per(accum) = 98.5
 T(local opt: dvdson [rest part(linalg)]  ) = 2.972e-04 S  per = 1.51  per(accum) = 100
Detailed decomposition of T(renrm) = 9.343e-03 S  T(sum) = 9.343e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.573e-05 S  per = 0.489  per(accum) = 0.489
 T(local opt: qops init                    ) = 3.034e-04 S  per = 3.25  per(accum) = 3.74
 T(local opt: symbolic_formulae_renorm     ) = 4.930e-05 S  per = 0.528  per(accum) = 4.27
 T(local opt: allocate qops on gpu         ) = 5.171e-05 S  per = 0.554  per(accum) = 4.82
 T(local opt: site memcpy cpu2gpu          ) = 2.098e-05 S  per = 0.225  per(accum) = 5.04
 T(local opt: rintermediate init           ) = 2.790e-05 S  per = 0.299  per(accum) = 5.34
 T(local opt: preprocess_formulae_Rlist2   ) = 4.430e-04 S  per = 4.74  per(accum) = 10.1
 T(local opt: rmmtasks init                ) = 1.614e-04 S  per = 1.73  per(accum) = 11.8
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.000417  per(accum) = 11.8
 T(local opt: preprocess_renorm_batchGPU   ) = 6.380e-04 S  per = 6.83  per(accum) = 18.6
 T(local opt: deallocate cpu and gpu memory) = 2.518e-05 S  per = 0.27  per(accum) = 18.9
 T(local opt: construct opS [ifdists=true] ) = 6.937e-03 S  per = 74.2  per(accum) = 93.2
 T(local opt: reduction of opS & opH [nccl]) = 1.883e-05 S  per = 0.202  per(accum) = 93.4
 T(local opt: qops memcpy gpu2cpu          ) = 2.877e-05 S  per = 0.308  per(accum) = 93.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.137e-05 S  per = 0.122  per(accum) = 93.8
 T(local opt: qops_pool join and erase     ) = 5.779e-04 S  per = 6.19  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.369e-06 S  per = 0.0254  per(accum) = 100
ctns::rcanon_save_site idx=15 scratch=./scratch/sweep size=46:3.4e-07GB T(load)=0.0006S speed=0.00057GB/S
##### sweep opt: 9.741e-02 S #####
 T(sweep opt: fetch) = 1.279e-02 S  per = 13.1  per(accum) = 13.1
 T(sweep opt: hdiag) = 3.100e-03 S  per = 3.18  per(accum) = 16.3
 T(sweep opt: dvdsn) = 3.949e-02 S  per = 40.5  per(accum) = 56.9
 T(sweep opt: decim) = 4.019e-03 S  per = 4.13  per(accum) = 61
 T(sweep opt: guess) = 3.230e-04 S  per = 0.332  per(accum) = 61.3
 T(sweep opt: renrm) = 3.055e-02 S  per = 31.4  per(accum) = 92.7
 T(sweep opt: save ) = 7.121e-03 S  per = 7.31  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.949e-02 S  T(sum) = 3.855e-02 S  per = 9.762e+01
 T(sweep opt: preprocess                  ) = 1.216e-03 S  per = 3.15  per(accum) = 3.15
 T(sweep opt: symbolic_formulae           ) = 9.261e-04 S  per =  2.4  per(accum) = 5.56
 T(sweep opt: hintermediate init          ) = 1.835e-04 S  per = 0.476  per(accum) = 6.03
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.114e-02 S  per = 28.9  per(accum) = 34.9
 T(sweep opt: hmmtasks init               ) = 1.848e-03 S  per = 4.79  per(accum) = 39.7
 T(sweep opt: initial guess for dvdson    ) = 4.642e-04 S  per =  1.2  per(accum) = 40.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.961e-02 S  per = 50.9  per(accum) = 91.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.720e-04 S  per = 1.22  per(accum) = 93
 T(sweep opt: dvdson [nccl]               ) = 1.618e-03 S  per =  4.2  per(accum) = 97.2
 T(sweep opt: dvdson [mpi]                ) = 6.846e-06 S  per = 0.0178  per(accum) = 97.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.072e-03 S  per = 2.78  per(accum) = 100
Detailed decomposition of T(renrm) = 3.055e-02 S  T(sum) = 3.055e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.719e-04 S  per = 0.563  per(accum) = 0.563
 T(sweep opt: qops init                    ) = 9.454e-04 S  per = 3.09  per(accum) = 3.66
 T(sweep opt: symbolic_formulae_renorm     ) = 1.481e-04 S  per = 0.485  per(accum) = 4.14
 T(sweep opt: allocate qops on gpu         ) = 1.968e-04 S  per = 0.644  per(accum) = 4.79
 T(sweep opt: site memcpy cpu2gpu          ) = 8.744e-05 S  per = 0.286  per(accum) = 5.07
 T(sweep opt: rintermediate init           ) = 1.073e-04 S  per = 0.351  per(accum) = 5.42
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.839e-04 S  per = 2.57  per(accum) = 7.99
 T(sweep opt: rmmtasks init                ) = 3.871e-04 S  per = 1.27  per(accum) = 9.26
 T(sweep opt: qops memset on cpu           ) = 1.440e-07 S  per = 0.000471  per(accum) = 9.26
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.989e-03 S  per = 6.51  per(accum) = 15.8
 T(sweep opt: deallocate cpu and gpu memory) = 8.585e-05 S  per = 0.281  per(accum) = 16
 T(sweep opt: construct opS [ifdists=true] ) = 2.274e-02 S  per = 74.4  per(accum) = 90.5
 T(sweep opt: reduction of opS & opH [nccl]) = 7.492e-05 S  per = 0.245  per(accum) = 90.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.090e-04 S  per = 0.357  per(accum) = 91.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.551e-05 S  per = 0.116  per(accum) = 91.2
 T(sweep opt: qops_pool join and erase     ) = 2.683e-03 S  per = 8.78  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 8.197e-06 S  per = 0.0268  per(accum) = 100
##### global opt: 9.741e-02 S #####
 T(global opt: fetch) = 1.279e-02 S  per = 13.1  per(accum) = 13.1
 T(global opt: hdiag) = 3.100e-03 S  per = 3.18  per(accum) = 16.3
 T(global opt: dvdsn) = 3.949e-02 S  per = 40.5  per(accum) = 56.9
 T(global opt: decim) = 4.019e-03 S  per = 4.13  per(accum) = 61
 T(global opt: guess) = 3.230e-04 S  per = 0.332  per(accum) = 61.3
 T(global opt: renrm) = 3.055e-02 S  per = 31.4  per(accum) = 92.7
 T(global opt: save ) = 7.121e-03 S  per = 7.31  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.949e-02 S  T(sum) = 3.855e-02 S  per = 9.762e+01
 T(global opt: preprocess                  ) = 1.216e-03 S  per = 3.15  per(accum) = 3.15
 T(global opt: symbolic_formulae           ) = 9.261e-04 S  per =  2.4  per(accum) = 5.56
 T(global opt: hintermediate init          ) = 1.835e-04 S  per = 0.476  per(accum) = 6.03
 T(global opt: preprocess_hformulae_Hxlist ) = 1.114e-02 S  per = 28.9  per(accum) = 34.9
 T(global opt: hmmtasks init               ) = 1.848e-03 S  per = 4.79  per(accum) = 39.7
 T(global opt: initial guess for dvdson    ) = 4.642e-04 S  per =  1.2  per(accum) = 40.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.961e-02 S  per = 50.9  per(accum) = 91.8
 T(global opt: dvdson [cpu-gpu]            ) = 4.720e-04 S  per = 1.22  per(accum) = 93
 T(global opt: dvdson [nccl]               ) = 1.618e-03 S  per =  4.2  per(accum) = 97.2
 T(global opt: dvdson [mpi]                ) = 6.846e-06 S  per = 0.0178  per(accum) = 97.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.072e-03 S  per = 2.78  per(accum) = 100
Detailed decomposition of T(renrm) = 3.055e-02 S  T(sum) = 3.055e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.719e-04 S  per = 0.563  per(accum) = 0.563
 T(global opt: qops init                    ) = 9.454e-04 S  per = 3.09  per(accum) = 3.66
 T(global opt: symbolic_formulae_renorm     ) = 1.481e-04 S  per = 0.485  per(accum) = 4.14
 T(global opt: allocate qops on gpu         ) = 1.968e-04 S  per = 0.644  per(accum) = 4.79
 T(global opt: site memcpy cpu2gpu          ) = 8.744e-05 S  per = 0.286  per(accum) = 5.07
 T(global opt: rintermediate init           ) = 1.073e-04 S  per = 0.351  per(accum) = 5.42
 T(global opt: preprocess_formulae_Rlist2   ) = 7.839e-04 S  per = 2.57  per(accum) = 7.99
 T(global opt: rmmtasks init                ) = 3.871e-04 S  per = 1.27  per(accum) = 9.26
 T(global opt: qops memset on cpu           ) = 1.440e-07 S  per = 0.000471  per(accum) = 9.26
 T(global opt: preprocess_renorm_batchGPU   ) = 1.989e-03 S  per = 6.51  per(accum) = 15.8
 T(global opt: deallocate cpu and gpu memory) = 8.585e-05 S  per = 0.281  per(accum) = 16
 T(global opt: construct opS [ifdists=true] ) = 2.274e-02 S  per = 74.4  per(accum) = 90.5
 T(global opt: reduction of opS & opH [nccl]) = 7.492e-05 S  per = 0.245  per(accum) = 90.7
 T(global opt: qops memcpy gpu2cpu          ) = 1.090e-04 S  per = 0.357  per(accum) = 91.1
 T(global opt: reduction of opS & opH [mpi] ) = 3.551e-05 S  per = 0.116  per(accum) = 91.2
 T(global opt: qops_pool join and erase     ) = 2.683e-03 S  per = 8.78  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 8.197e-06 S  per = 0.0268  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.204e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=4/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=13 scratch=./scratch/sweep size=134:9.98e-07GB T(load)=3.14e-04S speed=3.18e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=234:1.79e-03MB:1.74e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=49:3.74e-04MB:3.65e-07GB
total mem of comb=284:2.17e-03MB:2.12e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.495e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:5 S:8 H:1 A:12 B:16 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=778:5.936e-03MB:5.797e-06GB
        per(mem): C:13.5 S:21.6 H:2.57 A:10.9 B:51.4 
 rqops: oplist=CSHPQ nops=C:13 S:3 H:1 P:27 Q:26 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=3698:0.0282MB:2.76e-05GB
        per(mem): C:9.14 S:2.11 H:1.92 P:0 Q:86.8 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=6472:0.0494MB:4.82e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.069e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-3.010e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=225:1.717e-03MB
qtensor4: wf4 own=1 _data=0x5585e9c77000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
 qbond: qcol nsym=7 dimAll=19
 (20,0):3 (20,2):5 (20,4):5 (20,6):3 (21,1):1 (21,3):1 (21,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=44 nblocks=648 size=225:1.717e-03MB
### DIAG TIMING: total=3.054e-03 t1=1.772e-05, t2=2.261e-05, t3=2.052e-05, t4=2.941e-03, t5=6.886e-06, t6=3.809e-05, t7=6.882e-06
duration_diagGPU:3.062e-03
duration_diagreduce:3.600e-08
duration_diagtransform:3.860e-07
----- TIMING FOR symbolic_formulae_twodot with size=247 : 4.372e-04 S -----
rank=0 GPUmem(GB): used=4.822e-05 (oper)=4.822e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=247
 no. of hintermediate operators=122
 no. of coefficients=1502:1.146e-02MB:1.119e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.942e-05 S -----
rank=0 GPUmem(GB): used=5.941e-05 (oper,hinter)=4.822e-05,1.119e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.750e-02 S size(H_formulae)=247 size(Hxlst2)=44 T(Hmu/Hxlist)=1.107e-04,2.739e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.841e-02 S size(H_formulae)=247 size(Hxlst)=14156 -----
rank=0 GPUmem(GB): used=5.941e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.353e-06 batch[need]=4.219e-03 blksize=15 blksize0=9 batchsize=14156
rank=0 GPUmem(GB): used=4.282e-03 (oper,hinter,dvdson,batch)=4.822e-05,1.119e-05,3.353e-06,4.219e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=225 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.042e-05,2.145e-04,9.153e-04,9.738e-04,2.194e-03
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.386e-05 speed=1.405e-01GB/S T(nccl)=5.656e-05 speed=5.928e-02GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=9.1e-04 t_reduction=9.7e-04 tot=2.1e-03 -----
 sigma[inter] counter=23 t=2.1e-04 per=1.0e+01 cost=7.4e+05 flops=3.5e+09
 sigma[gemm] counter=23 i=0 t=2.0e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=1.7e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=1.7e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=3 t=1.7e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=4 t=2.3e-04 per=1.1e+01 cost=1.4e+05 flops=6.2e+08
 sigma[gemm] counter=23 i=5 t=2.4e-04 per=1.1e+01 cost=1.5e+05 flops=6.3e+08
 sigma[gemm] counter=23 i=6 t=2.1e-04 per=1.0e+01 cost=1.4e+05 flops=6.7e+08
 sigma[gemm] counter=23 i=7 t=2.3e-04 per=1.1e+01 cost=1.5e+05 flops=6.6e+08
 sigma[gemm] counter=23 total t=9.1e-04 per=4.4e+01 cost=5.9e+05 flops=6.4e+08
 sigma[red] counter=23 t=9.7e-04 per=4.6e+01 cost=1.6e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-03 t_gemm=8.5e-03 t_reduction=7.7e-03 tot=1.8e-02 -----
 sigma_tot[inter] counter=23 t=1.9e-03 per=1.0e+01 cost=1.8e+06 flops=9.4e+08
 sigma_tot[gemm] counter=23 i=0 t=5.5e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=4.6e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=4.6e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=3 t=4.5e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=4 t=2.2e-03 per=1.2e+01 cost=3.7e+05 flops=1.7e+08
 sigma_tot[gemm] counter=23 i=5 t=2.4e-03 per=1.3e+01 cost=3.8e+05 flops=1.6e+08
 sigma_tot[gemm] counter=23 i=6 t=1.9e-03 per=1.0e+01 cost=4.7e+05 flops=2.5e+08
 sigma_tot[gemm] counter=23 i=7 t=1.9e-03 per=1.0e+01 cost=4.6e+05 flops=2.5e+08
 sigma_tot[gemm] counter=23 total t=8.5e-03 per=4.7e+01 cost=1.7e+06 flops=2.0e+08
 sigma_tot[red] counter=23 t=7.7e-03 per=4.3e+01 cost=4.7e+05 flops=6.0e+07
T(sub)=9.6e-06 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,3.4e-06,1.1e-06,1.1e-06,2.8e-07
settings: ndim=225 neig=1 maxcycle=30 nbuff=4 memory=3e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.216235107147 -1.116e+03  1.315e-02    1     1  2.537e-03 2.537e-03 2.503e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.919e-05,1.943e-04,1.037e-03,1.037e-03,2.343e-03
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.215e-05 speed=1.514e-01GB/S T(nccl)=4.704e-05 speed=7.128e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.0e-03 t_reduction=1.0e-03 tot=2.3e-03 -----
 sigma[inter] counter=24 t=1.9e-04 per=8.6e+00 cost=7.4e+05 flops=3.8e+09
 sigma[gemm] counter=24 i=0 t=2.0e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=1.9e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=3 t=1.9e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=4 t=2.5e-04 per=1.1e+01 cost=1.4e+05 flops=5.7e+08
 sigma[gemm] counter=24 i=5 t=2.8e-04 per=1.3e+01 cost=1.5e+05 flops=5.2e+08
 sigma[gemm] counter=24 i=6 t=2.5e-04 per=1.1e+01 cost=1.4e+05 flops=5.8e+08
 sigma[gemm] counter=24 i=7 t=2.5e-04 per=1.1e+01 cost=1.5e+05 flops=6.1e+08
 sigma[gemm] counter=24 total t=1.0e-03 per=4.6e+01 cost=5.9e+05 flops=5.6e+08
 sigma[red] counter=24 t=1.0e-03 per=4.6e+01 cost=1.6e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=2.1e-03 t_gemm=9.6e-03 t_reduction=8.8e-03 tot=2.0e-02 -----
 sigma_tot[inter] counter=24 t=2.1e-03 per=1.0e+01 cost=2.5e+06 flops=1.2e+09
 sigma_tot[gemm] counter=24 i=0 t=5.7e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=4.8e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=4.8e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=3 t=4.7e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=4 t=2.5e-03 per=1.2e+01 cost=5.2e+05 flops=2.1e+08
 sigma_tot[gemm] counter=24 i=5 t=2.6e-03 per=1.3e+01 cost=5.3e+05 flops=2.0e+08
 sigma_tot[gemm] counter=24 i=6 t=2.1e-03 per=1.1e+01 cost=6.1e+05 flops=2.8e+08
 sigma_tot[gemm] counter=24 i=7 t=2.1e-03 per=1.0e+01 cost=6.1e+05 flops=2.9e+08
 sigma_tot[gemm] counter=24 total t=9.6e-03 per=4.7e+01 cost=2.3e+06 flops=2.4e+08
 sigma_tot[red] counter=24 t=8.8e-03 per=4.3e+01 cost=6.2e+05 flops=7.1e+07
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=8.4e-06,1.6e-05,2.7e-06,1.8e-06,2.4e-07
    2   0 -    -116.217230900952 -9.958e-04  5.902e-03    2     2  5.181e-03 2.591e-03 2.528e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.884e-05,2.046e-04,1.028e-03,1.031e-03,2.337e-03
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.210e-05 speed=1.517e-01GB/S T(nccl)=4.674e-05 speed=7.173e-02GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=1.0e-03 t_reduction=1.0e-03 tot=2.3e-03 -----
 sigma[inter] counter=25 t=2.0e-04 per=9.0e+00 cost=7.4e+05 flops=3.6e+09
 sigma[gemm] counter=25 i=0 t=2.0e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=1.9e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=1.9e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=3 t=1.8e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=4 t=2.5e-04 per=1.1e+01 cost=1.4e+05 flops=5.8e+08
 sigma[gemm] counter=25 i=5 t=2.7e-04 per=1.2e+01 cost=1.5e+05 flops=5.5e+08
 sigma[gemm] counter=25 i=6 t=2.5e-04 per=1.1e+01 cost=1.4e+05 flops=5.8e+08
 sigma[gemm] counter=25 i=7 t=2.5e-04 per=1.1e+01 cost=1.5e+05 flops=5.9e+08
 sigma[gemm] counter=25 total t=1.0e-03 per=4.5e+01 cost=5.9e+05 flops=5.7e+08
 sigma[red] counter=25 t=1.0e-03 per=4.6e+01 cost=1.6e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-03 t_gemm=1.1e-02 t_reduction=9.8e-03 tot=2.3e-02 -----
 sigma_tot[inter] counter=25 t=2.3e-03 per=1.0e+01 cost=3.3e+06 flops=1.4e+09
 sigma_tot[gemm] counter=25 i=0 t=5.9e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=5.0e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=5.0e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=3 t=4.9e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=4 t=2.7e-03 per=1.2e+01 cost=6.6e+05 flops=2.5e+08
 sigma_tot[gemm] counter=25 i=5 t=2.9e-03 per=1.3e+01 cost=6.8e+05 flops=2.3e+08
 sigma_tot[gemm] counter=25 i=6 t=2.4e-03 per=1.1e+01 cost=7.5e+05 flops=3.2e+08
 sigma_tot[gemm] counter=25 i=7 t=2.4e-03 per=1.0e+01 cost=7.6e+05 flops=3.2e+08
 sigma_tot[gemm] counter=25 total t=1.1e-02 per=4.7e+01 cost=2.9e+06 flops=2.7e+08
 sigma_tot[red] counter=25 t=9.8e-03 per=4.3e+01 cost=7.8e+05 flops=7.9e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,1.6e-05,2.1e-06,1.8e-06,2.4e-07
    3   0 -    -116.217352341305 -1.214e-04  2.403e-03    3     3  7.778e-03 2.593e-03 2.533e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.644e-05,1.829e-04,1.012e-03,1.027e-03,2.293e-03
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.140e-05 speed=1.567e-01GB/S T(nccl)=4.504e-05 speed=7.443e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.0e-03 t_reduction=1.0e-03 tot=2.2e-03 -----
 sigma[inter] counter=26 t=1.8e-04 per=8.2e+00 cost=7.4e+05 flops=4.1e+09
 sigma[gemm] counter=26 i=0 t=2.0e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=2.0e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=3 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=4 t=2.4e-04 per=1.1e+01 cost=1.4e+05 flops=5.9e+08
 sigma[gemm] counter=26 i=5 t=2.8e-04 per=1.2e+01 cost=1.5e+05 flops=5.4e+08
 sigma[gemm] counter=26 i=6 t=2.4e-04 per=1.1e+01 cost=1.4e+05 flops=5.9e+08
 sigma[gemm] counter=26 i=7 t=2.4e-04 per=1.1e+01 cost=1.5e+05 flops=6.2e+08
 sigma[gemm] counter=26 total t=1.0e-03 per=4.6e+01 cost=5.9e+05 flops=5.8e+08
 sigma[red] counter=26 t=1.0e-03 per=4.6e+01 cost=1.6e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=2.5e-03 t_gemm=1.2e-02 t_reduction=1.1e-02 tot=2.5e-02 -----
 sigma_tot[inter] counter=26 t=2.5e-03 per=9.9e+00 cost=4.0e+06 flops=1.6e+09
 sigma_tot[gemm] counter=26 i=0 t=6.1e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=5.2e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=5.1e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=3 t=5.1e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=4 t=2.9e-03 per=1.2e+01 cost=8.1e+05 flops=2.7e+08
 sigma_tot[gemm] counter=26 i=5 t=3.2e-03 per=1.3e+01 cost=8.3e+05 flops=2.6e+08
 sigma_tot[gemm] counter=26 i=6 t=2.6e-03 per=1.1e+01 cost=9.0e+05 flops=3.4e+08
 sigma_tot[gemm] counter=26 i=7 t=2.6e-03 per=1.1e+01 cost=9.1e+05 flops=3.5e+08
 sigma_tot[gemm] counter=26 total t=1.2e-02 per=4.7e+01 cost=3.4e+06 flops=3.0e+08
 sigma_tot[red] counter=26 t=1.1e-02 per=4.4e+01 cost=9.3e+05 flops=8.6e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.2e-05,1.9e-06,1.7e-06,2.5e-07
    4   0 -    -116.217369818296 -1.748e-05  8.241e-04    3     4  1.033e-02 2.583e-03 2.524e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.730e-05,1.930e-04,1.068e-03,1.037e-03,2.369e-03
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.140e-05 speed=1.567e-01GB/S T(nccl)=4.590e-05 speed=7.304e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=1.0e-03 tot=2.3e-03 -----
 sigma[inter] counter=27 t=1.9e-04 per=8.4e+00 cost=7.4e+05 flops=3.9e+09
 sigma[gemm] counter=27 i=0 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=1.9e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=3 t=1.9e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=4 t=2.5e-04 per=1.1e+01 cost=1.4e+05 flops=5.9e+08
 sigma[gemm] counter=27 i=5 t=2.8e-04 per=1.2e+01 cost=1.5e+05 flops=5.2e+08
 sigma[gemm] counter=27 i=6 t=2.7e-04 per=1.2e+01 cost=1.4e+05 flops=5.3e+08
 sigma[gemm] counter=27 i=7 t=2.6e-04 per=1.1e+01 cost=1.5e+05 flops=5.7e+08
 sigma[gemm] counter=27 total t=1.1e-03 per=4.6e+01 cost=5.9e+05 flops=5.5e+08
 sigma[red] counter=27 t=1.0e-03 per=4.5e+01 cost=1.6e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=2.7e-03 t_gemm=1.3e-02 t_reduction=1.2e-02 tot=2.7e-02 -----
 sigma_tot[inter] counter=27 t=2.7e-03 per=9.8e+00 cost=4.7e+06 flops=1.8e+09
 sigma_tot[gemm] counter=27 i=0 t=6.3e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=5.4e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=5.3e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=3 t=5.3e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=4 t=3.2e-03 per=1.2e+01 cost=9.5e+05 flops=3.0e+08
 sigma_tot[gemm] counter=27 i=5 t=3.5e-03 per=1.3e+01 cost=9.8e+05 flops=2.8e+08
 sigma_tot[gemm] counter=27 i=6 t=2.9e-03 per=1.1e+01 cost=1.0e+06 flops=3.6e+08
 sigma_tot[gemm] counter=27 i=7 t=2.9e-03 per=1.1e+01 cost=1.1e+06 flops=3.7e+08
 sigma_tot[gemm] counter=27 total t=1.3e-02 per=4.7e+01 cost=4.0e+06 flops=3.2e+08
 sigma_tot[red] counter=27 t=1.2e-02 per=4.4e+01 cost=1.1e+06 flops=9.2e+07
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.2e-05,1.8e-06,1.5e-06,2.3e-07
    5   0 -    -116.217371742201 -1.924e-06  2.959e-04    3     5  1.294e-02 2.587e-03 2.531e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.761e-05,1.849e-04,1.024e-03,1.025e-03,2.305e-03
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.189e-05 speed=1.532e-01GB/S T(nccl)=4.573e-05 speed=7.332e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.0e-03 t_reduction=1.0e-03 tot=2.2e-03 -----
 sigma[inter] counter=28 t=1.8e-04 per=8.3e+00 cost=7.4e+05 flops=4.0e+09
 sigma[gemm] counter=28 i=0 t=2.0e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=2.0e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=3 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=4 t=2.6e-04 per=1.2e+01 cost=1.4e+05 flops=5.6e+08
 sigma[gemm] counter=28 i=5 t=2.7e-04 per=1.2e+01 cost=1.5e+05 flops=5.5e+08
 sigma[gemm] counter=28 i=6 t=2.4e-04 per=1.1e+01 cost=1.4e+05 flops=6.1e+08
 sigma[gemm] counter=28 i=7 t=2.5e-04 per=1.1e+01 cost=1.5e+05 flops=5.9e+08
 sigma[gemm] counter=28 total t=1.0e-03 per=4.6e+01 cost=5.9e+05 flops=5.7e+08
 sigma[red] counter=28 t=1.0e-03 per=4.6e+01 cost=1.6e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-03 t_gemm=1.4e-02 t_reduction=1.3e-02 tot=2.9e-02 -----
 sigma_tot[inter] counter=28 t=2.8e-03 per=9.7e+00 cost=5.5e+06 flops=1.9e+09
 sigma_tot[gemm] counter=28 i=0 t=6.5e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=5.6e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=5.5e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=3 t=5.4e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=4 t=3.4e-03 per=1.2e+01 cost=1.1e+06 flops=3.2e+08
 sigma_tot[gemm] counter=28 i=5 t=3.7e-03 per=1.3e+01 cost=1.1e+06 flops=3.0e+08
 sigma_tot[gemm] counter=28 i=6 t=3.1e-03 per=1.1e+01 cost=1.2e+06 flops=3.8e+08
 sigma_tot[gemm] counter=28 i=7 t=3.1e-03 per=1.1e+01 cost=1.2e+06 flops=3.9e+08
 sigma_tot[gemm] counter=28 total t=1.4e-02 per=4.7e+01 cost=4.6e+06 flops=3.4e+08
 sigma_tot[red] counter=28 t=1.3e-02 per=4.4e+01 cost=1.2e+06 flops=9.6e+07
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.2e-05,1.9e-06,1.5e-06,2.5e-07
    6   0 -    -116.217372032857 -2.907e-07  1.396e-04    3     6  1.550e-02 2.584e-03 2.528e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.644e-05,1.868e-04,1.029e-03,1.023e-03,2.308e-03
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.085e-05 speed=1.608e-01GB/S T(nccl)=4.559e-05 speed=7.354e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.0e-03 t_reduction=1.0e-03 tot=2.2e-03 -----
 sigma[inter] counter=29 t=1.9e-04 per=8.3e+00 cost=7.4e+05 flops=4.0e+09
 sigma[gemm] counter=29 i=0 t=3.1e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=3.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=3 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=4 t=2.5e-04 per=1.1e+01 cost=1.4e+05 flops=5.7e+08
 sigma[gemm] counter=29 i=5 t=2.7e-04 per=1.2e+01 cost=1.5e+05 flops=5.5e+08
 sigma[gemm] counter=29 i=6 t=2.4e-04 per=1.1e+01 cost=1.4e+05 flops=6.0e+08
 sigma[gemm] counter=29 i=7 t=2.6e-04 per=1.1e+01 cost=1.5e+05 flops=5.8e+08
 sigma[gemm] counter=29 total t=1.0e-03 per=4.6e+01 cost=5.9e+05 flops=5.7e+08
 sigma[red] counter=29 t=1.0e-03 per=4.6e+01 cost=1.6e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=3.0e-03 t_gemm=1.5e-02 t_reduction=1.4e-02 tot=3.2e-02 -----
 sigma_tot[inter] counter=29 t=3.0e-03 per=9.6e+00 cost=6.2e+06 flops=2.1e+09
 sigma_tot[gemm] counter=29 i=0 t=6.8e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=5.8e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=5.8e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=3 t=5.7e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=4 t=3.7e-03 per=1.2e+01 cost=1.2e+06 flops=3.4e+08
 sigma_tot[gemm] counter=29 i=5 t=4.0e-03 per=1.3e+01 cost=1.3e+06 flops=3.2e+08
 sigma_tot[gemm] counter=29 i=6 t=3.4e-03 per=1.1e+01 cost=1.3e+06 flops=3.9e+08
 sigma_tot[gemm] counter=29 i=7 t=3.4e-03 per=1.1e+01 cost=1.4e+06 flops=4.0e+08
 sigma_tot[gemm] counter=29 total t=1.5e-02 per=4.6e+01 cost=5.2e+06 flops=3.5e+08
 sigma_tot[red] counter=29 t=1.4e-02 per=4.4e+01 cost=1.4e+06 flops=1.0e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.2e-05,1.9e-06,1.5e-06,2.5e-07
    7   0 +    -116.217372098439 -6.558e-08  5.394e-05    3     7  1.806e-02 2.580e-03 2.525e-03
TIMING FOR Davidson : 1.808e-02  T(cal/comm/rest)=1.767e-02,3.102e-06,3.987e-04
decomposed t_rest=3.987e-04
 T(sub)    =1.497e-04 per=3.754e+01
 T(precond)=2.140e-05 per=5.366e+00
 T(ortho)  =1.089e-05 per=2.731e+00
 T(xcopy)  =1.082e-06 per=2.714e-01
 T(xnrm2)  =1.460e-06 per=3.662e-01
 T(other)  =2.142e-04 per=5.372e+01
optimized energies: isweep=0 ibond=4 dots=2 e[0]=-116.217372098439 nmvp=7
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=5.669e-03 change=3.647e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=13 dimAll=40
 (8,2):8 (10,2):4 (9,1):6 (9,3):5 (7,1):3 (8,0):2 (7,3):4 (8,4):3 (11,1):1 (10,0):1 (6,2):1 (6,4):1 (7,5):1
timing for divide=1.3e-05
timing for compute=8.4e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.3e-05,7.3e-05,0.0e+00,1.1e-05,1.3e-05 -----
decimation summary: 40->10 dwt=+1.978e-04 SvN=1.078e+00
 qbond: qkept nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
----- TIMING for decimation_row(nkr): 1.134e-03 S T(decim/select/formRot)=1.508e-04,9.605e-04,2.219e-05 -----
----- TIMING FOR twodot_decimation: 1.257e-03 S T(wf/decim)=1.145e-04,1.142e-03 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:6 S:8 H:1 A:18 B:20 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=1162:8.865e-03MB:8.658e-06GB
        per(mem): C:9.29 S:12.4 H:2.58 A:0 B:75.7 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=6.432e-03 change=6.738e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 5.783e-05 S -----
rank=0 GPUmem(GB): used=4.052e-05 (oper)=2.189e-05
rank=0 GPUmem(GB): used=4.094e-05 (oper,site)=2.189e-05,4.247e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=45
 no. of rintermediate operators=5
 no. of coefficients=39:2.975e-04MB:2.906e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.068e-05 S -----
rank=0 GPUmem(GB): used=4.123e-05 (oper,site,rinter)=2.189e-05,4.247e-07,2.906e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.990e-04 S size(rtasks)=45 size(Rlst2)=16 T(Rmu/Rlist)=3.345e-05,5.655e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.227e-04 S size(rtasks)=45 size(Rlst)=501 -----
rank=0 GPUmem(GB): used=4.123e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.568e-04 blksize=16 blksize0=9 batchsize=501
rank=0 GPUmem(GB): used=1.980e-04 (oper,site,rinter,batch)=2.189e-05,4.247e-07,2.906e-07,1.568e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.112e-04,5.482e-04,1.998e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=5.5e-04 t_reduction=2.0e-04 tot=8.6e-04 -----
 renorm[inter] counter=71 t=1.1e-04 per=1.3e+01 cost=5.1e+03 flops=4.6e+07
 renorm[gemm] counter=71 i=0 t=2.0e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=2 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=3 t=1.8e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=4 t=1.6e-04 per=1.9e+01 cost=1.5e+03 flops=9.1e+06
 renorm[gemm] counter=71 i=5 t=1.7e-04 per=2.0e+01 cost=9.3e+03 flops=5.3e+07
 renorm[gemm] counter=71 i=6 t=2.0e-04 per=2.4e+01 cost=1.5e+04 flops=7.4e+07
 renorm[gemm] counter=71 total t=5.5e-04 per=6.4e+01 cost=2.6e+04 flops=4.7e+07
 renorm[red] counter=71 t=2.0e-04 per=2.3e+01 cost=6.6e+03 flops=3.3e+07
----- TIMING FOR renorm_tot : t_inter=3.5e-04 t_gemm=1.4e-03 t_reduction=6.6e-04 tot=2.4e-03 -----
 renorm_tot[inter] counter=71 t=3.5e-04 per=1.5e+01 cost=8.8e+03 flops=2.5e+07
 renorm_tot[gemm] counter=71 i=0 t=1.1e-05 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=1 t=9.6e-06 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=2 t=9.6e-06 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=3 t=9.5e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=4 t=4.4e-04 per=1.8e+01 cost=3.0e+03 flops=6.7e+06
 renorm_tot[gemm] counter=71 i=5 t=4.4e-04 per=1.8e+01 cost=1.6e+04 flops=3.7e+07
 renorm_tot[gemm] counter=71 i=6 t=4.9e-04 per=2.0e+01 cost=2.5e+04 flops=5.0e+07
 renorm_tot[gemm] counter=71 total t=1.4e-03 per=5.8e+01 cost=4.4e+04 flops=3.1e+07
 renorm_tot[red] counter=71 t=6.6e-04 per=2.7e+01 cost=1.1e+04 flops=1.7e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.642e-05 (oper)=2.202e-05
rank=0 GPUmem(GB): used=4.685e-05 (oper,site,rinter)=2.202e-05,4.247e-07,5.484e-06
rank=0 GPUmem(GB): used=6.230e-05 (oper,site,rinter,batch)=2.202e-05,4.247e-07,5.484e-06,1.545e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.072e-03 S T(preprocess/alloc/comp/red/dealloc)=1.728e-03,1.769e-03,4.890e-03,2.761e-04,1.105e-04 -----
----- TIMING FOR oper_renorm_opS : 7.108e-03 S rank=0 -----
qops.to_cpu: size(tot)=1162:8.865e-03MB:8.658e-06GB T(to_cpu)=2.843e-05S speed=3.045e-01GB/S
check ||H-H.dagger||=2.834e-15 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0095 S rank=0 -----
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=6.355e-03 change=1.504e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=6.355e-03 change=-1.298e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=6.355e-03 change=-3.800e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 7.226e-02 S #####
 T(local opt: fetch) = 2.254e-03 S  per = 3.12  per(accum) = 3.12
 T(local opt: hdiag) = 3.162e-03 S  per = 4.38  per(accum) = 7.49
 T(local opt: dvdsn) = 5.313e-02 S  per = 73.5  per(accum) = 81
 T(local opt: decim) = 1.290e-03 S  per = 1.79  per(accum) = 82.8
 T(local opt: guess) = 1.377e-04 S  per = 0.19  per(accum) = 83
 T(local opt: renrm) = 1.046e-02 S  per = 14.5  per(accum) = 97.5
 T(local opt: save ) = 1.836e-03 S  per = 2.54  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.313e-02 S  T(sum) = 5.243e-02 S  per = 9.869e+01
 T(local opt: preprocess                  ) = 5.898e-04 S  per = 1.12  per(accum) = 1.12
 T(local opt: symbolic_formulae           ) = 4.444e-04 S  per = 0.848  per(accum) = 1.97
 T(local opt: hintermediate init          ) = 4.702e-05 S  per = 0.0897  per(accum) = 2.06
 T(local opt: preprocess_hformulae_Hxlist ) = 2.854e-02 S  per = 54.4  per(accum) = 56.5
 T(local opt: hmmtasks init               ) = 4.505e-03 S  per = 8.59  per(accum) = 65.1
 T(local opt: initial guess for dvdson    ) = 2.271e-04 S  per = 0.433  per(accum) = 65.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.719e-02 S  per = 32.8  per(accum) = 98.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.536e-04 S  per = 0.293  per(accum) = 98.6
 T(local opt: dvdson [nccl]               ) = 3.326e-04 S  per = 0.634  per(accum) = 99.2
 T(local opt: dvdson [mpi]                ) = 3.102e-06 S  per = 0.00592  per(accum) = 99.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.987e-04 S  per = 0.761  per(accum) = 100
Detailed decomposition of T(renrm) = 1.046e-02 S  T(sum) = 1.046e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.356e-05 S  per = 0.608  per(accum) = 0.608
 T(local opt: qops init                    ) = 3.235e-04 S  per = 3.09  per(accum) = 3.7
 T(local opt: symbolic_formulae_renorm     ) = 6.782e-05 S  per = 0.648  per(accum) = 4.35
 T(local opt: allocate qops on gpu         ) = 5.747e-05 S  per = 0.549  per(accum) = 4.9
 T(local opt: site memcpy cpu2gpu          ) = 2.223e-05 S  per = 0.213  per(accum) = 5.11
 T(local opt: rintermediate init           ) = 2.704e-05 S  per = 0.259  per(accum) = 5.37
 T(local opt: preprocess_formulae_Rlist2   ) = 6.269e-04 S  per = 5.99  per(accum) = 11.4
 T(local opt: rmmtasks init                ) = 2.132e-04 S  per = 2.04  per(accum) = 13.4
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 0.000306  per(accum) = 13.4
 T(local opt: preprocess_renorm_batchGPU   ) = 9.460e-04 S  per = 9.05  per(accum) = 22.4
 T(local opt: deallocate cpu and gpu memory) = 2.938e-05 S  per = 0.281  per(accum) = 22.7
 T(local opt: construct opS [ifdists=true] ) = 7.117e-03 S  per =   68  per(accum) = 90.8
 T(local opt: reduction of opS & opH [nccl]) = 1.828e-05 S  per = 0.175  per(accum) = 91
 T(local opt: qops memcpy gpu2cpu          ) = 3.772e-05 S  per = 0.361  per(accum) = 91.3
 T(local opt: reduction of opS & opH [mpi] ) = 1.171e-05 S  per = 0.112  per(accum) = 91.4
 T(local opt: qops_pool join and erase     ) = 8.928e-04 S  per = 8.54  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.114e-06 S  per = 0.0393  per(accum) = 100
ctns::rcanon_save_site idx=14 scratch=./scratch/sweep size=57:4.2e-07GB T(load)=0.00057S speed=0.00075GB/S
##### sweep opt: 1.697e-01 S #####
 T(sweep opt: fetch) = 1.505e-02 S  per = 8.87  per(accum) = 8.87
 T(sweep opt: hdiag) = 6.262e-03 S  per = 3.69  per(accum) = 12.6
 T(sweep opt: dvdsn) = 9.262e-02 S  per = 54.6  per(accum) = 67.1
 T(sweep opt: decim) = 5.309e-03 S  per = 3.13  per(accum) = 70.3
 T(sweep opt: guess) = 4.607e-04 S  per = 0.272  per(accum) = 70.5
 T(sweep opt: renrm) = 4.101e-02 S  per = 24.2  per(accum) = 94.7
 T(sweep opt: save ) = 8.958e-03 S  per = 5.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.262e-02 S  T(sum) = 9.098e-02 S  per = 9.823e+01
 T(sweep opt: preprocess                  ) = 1.806e-03 S  per = 1.98  per(accum) = 1.98
 T(sweep opt: symbolic_formulae           ) = 1.370e-03 S  per = 1.51  per(accum) = 3.49
 T(sweep opt: hintermediate init          ) = 2.305e-04 S  per = 0.253  per(accum) = 3.74
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.967e-02 S  per = 43.6  per(accum) = 47.4
 T(sweep opt: hmmtasks init               ) = 6.353e-03 S  per = 6.98  per(accum) = 54.3
 T(sweep opt: initial guess for dvdson    ) = 6.913e-04 S  per = 0.76  per(accum) = 55.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.680e-02 S  per = 40.4  per(accum) = 95.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.256e-04 S  per = 0.688  per(accum) = 96.2
 T(sweep opt: dvdson [nccl]               ) = 1.951e-03 S  per = 2.14  per(accum) = 98.4
 T(sweep opt: dvdson [mpi]                ) = 9.948e-06 S  per = 0.0109  per(accum) = 98.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.470e-03 S  per = 1.62  per(accum) = 100
Detailed decomposition of T(renrm) = 4.101e-02 S  T(sum) = 4.101e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.355e-04 S  per = 0.574  per(accum) = 0.574
 T(sweep opt: qops init                    ) = 1.269e-03 S  per = 3.09  per(accum) = 3.67
 T(sweep opt: symbolic_formulae_renorm     ) = 2.160e-04 S  per = 0.527  per(accum) = 4.19
 T(sweep opt: allocate qops on gpu         ) = 2.543e-04 S  per = 0.62  per(accum) = 4.81
 T(sweep opt: site memcpy cpu2gpu          ) = 1.097e-04 S  per = 0.267  per(accum) = 5.08
 T(sweep opt: rintermediate init           ) = 1.344e-04 S  per = 0.328  per(accum) = 5.41
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.411e-03 S  per = 3.44  per(accum) = 8.85
 T(sweep opt: rmmtasks init                ) = 6.003e-04 S  per = 1.46  per(accum) = 10.3
 T(sweep opt: qops memset on cpu           ) = 1.760e-07 S  per = 0.000429  per(accum) = 10.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.935e-03 S  per = 7.16  per(accum) = 17.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.152e-04 S  per = 0.281  per(accum) = 17.8
 T(sweep opt: construct opS [ifdists=true] ) = 2.986e-02 S  per = 72.8  per(accum) = 90.6
 T(sweep opt: reduction of opS & opH [nccl]) = 9.320e-05 S  per = 0.227  per(accum) = 90.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.467e-04 S  per = 0.358  per(accum) = 91.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.722e-05 S  per = 0.115  per(accum) = 91.3
 T(sweep opt: qops_pool join and erase     ) = 3.576e-03 S  per = 8.72  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.231e-05 S  per = 0.03  per(accum) = 100
##### global opt: 1.697e-01 S #####
 T(global opt: fetch) = 1.505e-02 S  per = 8.87  per(accum) = 8.87
 T(global opt: hdiag) = 6.262e-03 S  per = 3.69  per(accum) = 12.6
 T(global opt: dvdsn) = 9.262e-02 S  per = 54.6  per(accum) = 67.1
 T(global opt: decim) = 5.309e-03 S  per = 3.13  per(accum) = 70.3
 T(global opt: guess) = 4.607e-04 S  per = 0.272  per(accum) = 70.5
 T(global opt: renrm) = 4.101e-02 S  per = 24.2  per(accum) = 94.7
 T(global opt: save ) = 8.958e-03 S  per = 5.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.262e-02 S  T(sum) = 9.098e-02 S  per = 9.823e+01
 T(global opt: preprocess                  ) = 1.806e-03 S  per = 1.98  per(accum) = 1.98
 T(global opt: symbolic_formulae           ) = 1.370e-03 S  per = 1.51  per(accum) = 3.49
 T(global opt: hintermediate init          ) = 2.305e-04 S  per = 0.253  per(accum) = 3.74
 T(global opt: preprocess_hformulae_Hxlist ) = 3.967e-02 S  per = 43.6  per(accum) = 47.4
 T(global opt: hmmtasks init               ) = 6.353e-03 S  per = 6.98  per(accum) = 54.3
 T(global opt: initial guess for dvdson    ) = 6.913e-04 S  per = 0.76  per(accum) = 55.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.680e-02 S  per = 40.4  per(accum) = 95.5
 T(global opt: dvdson [cpu-gpu]            ) = 6.256e-04 S  per = 0.688  per(accum) = 96.2
 T(global opt: dvdson [nccl]               ) = 1.951e-03 S  per = 2.14  per(accum) = 98.4
 T(global opt: dvdson [mpi]                ) = 9.948e-06 S  per = 0.0109  per(accum) = 98.4
 T(global opt: dvdson [rest part(linalg)]  ) = 1.470e-03 S  per = 1.62  per(accum) = 100
Detailed decomposition of T(renrm) = 4.101e-02 S  T(sum) = 4.101e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.355e-04 S  per = 0.574  per(accum) = 0.574
 T(global opt: qops init                    ) = 1.269e-03 S  per = 3.09  per(accum) = 3.67
 T(global opt: symbolic_formulae_renorm     ) = 2.160e-04 S  per = 0.527  per(accum) = 4.19
 T(global opt: allocate qops on gpu         ) = 2.543e-04 S  per = 0.62  per(accum) = 4.81
 T(global opt: site memcpy cpu2gpu          ) = 1.097e-04 S  per = 0.267  per(accum) = 5.08
 T(global opt: rintermediate init           ) = 1.344e-04 S  per = 0.328  per(accum) = 5.41
 T(global opt: preprocess_formulae_Rlist2   ) = 1.411e-03 S  per = 3.44  per(accum) = 8.85
 T(global opt: rmmtasks init                ) = 6.003e-04 S  per = 1.46  per(accum) = 10.3
 T(global opt: qops memset on cpu           ) = 1.760e-07 S  per = 0.000429  per(accum) = 10.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.935e-03 S  per = 7.16  per(accum) = 17.5
 T(global opt: deallocate cpu and gpu memory) = 1.152e-04 S  per = 0.281  per(accum) = 17.8
 T(global opt: construct opS [ifdists=true] ) = 2.986e-02 S  per = 72.8  per(accum) = 90.6
 T(global opt: reduction of opS & opH [nccl]) = 9.320e-05 S  per = 0.227  per(accum) = 90.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.467e-04 S  per = 0.358  per(accum) = 91.1
 T(global opt: reduction of opS & opH [mpi] ) = 4.722e-05 S  per = 0.115  per(accum) = 91.3
 T(global opt: qops_pool join and erase     ) = 3.576e-03 S  per = 8.72  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.231e-05 S  per = 0.03  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-3.653e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=5/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=12 scratch=./scratch/sweep size=97:7.23e-07GB T(load)=3.46e-04S speed=2.09e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=231:1.76e-03MB:1.72e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=92:7.02e-04MB:6.85e-07GB
total mem of comb=324:2.47e-03MB:2.41e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.471e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:8 H:1 A:18 B:20 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=1162:8.865e-03MB:8.658e-06GB
        per(mem): C:9.29 S:12.4 H:2.58 A:0 B:75.7 
 rqops: oplist=CSHPQ nops=C:12 S:3 H:1 P:31 Q:36 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=4907:0.0374MB:3.66e-05GB
        per(mem): C:6.36 S:1.59 H:1.45 P:0 Q:90.6 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=8065:0.0615MB:6.01e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.122e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-3.773e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=194:1.480e-03MB
qtensor4: wf4 own=1 _data=0x5585f6d08300
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
 qbond: qcol nsym=7 dimAll=19
 (18,0):3 (18,2):5 (18,4):5 (18,6):3 (19,1):1 (19,3):1 (19,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=432 size=194:1.480e-03MB
### DIAG TIMING: total=2.785e-03 t1=1.815e-05, t2=1.956e-05, t3=1.877e-05, t4=2.679e-03, t5=6.077e-06, t6=3.761e-05, t7=6.567e-06
duration_diagGPU:2.801e-03
duration_diagreduce:3.700e-08
duration_diagtransform:9.100e-07
----- TIMING FOR symbolic_formulae_twodot with size=310 : 5.553e-04 S -----
rank=0 GPUmem(GB): used=6.009e-05 (oper)=6.009e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=310
 no. of hintermediate operators=156
 no. of coefficients=1848:1.410e-02MB:1.377e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.420e-05 S -----
rank=0 GPUmem(GB): used=7.386e-05 (oper,hinter)=6.009e-05,1.377e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.442e-02 S size(H_formulae)=310 size(Hxlst2)=29 T(Hmu/Hxlist)=1.278e-04,2.429e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.522e-02 S size(H_formulae)=310 size(Hxlst)=10368 -----
rank=0 GPUmem(GB): used=7.386e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.891e-06 batch[need]=4.403e-03 blksize=20 blksize0=16 batchsize=10368
rank=0 GPUmem(GB): used=4.480e-03 (oper,hinter,dvdson,batch)=6.009e-05,1.377e-05,2.891e-06,4.403e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=194 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.963e-05,1.892e-04,8.895e-04,7.956e-04,1.983e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=3.106e-05 speed=9.308e-02GB/S T(nccl)=6.857e-05 speed=4.216e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=8.9e-04 t_reduction=8.0e-04 tot=1.9e-03 -----
 sigma[inter] counter=30 t=1.9e-04 per=1.0e+01 cost=5.3e+05 flops=2.8e+09
 sigma[gemm] counter=30 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=1.7e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=1.7e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=3 t=1.7e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=4 t=2.2e-04 per=1.2e+01 cost=1.5e+05 flops=6.8e+08
 sigma[gemm] counter=30 i=5 t=2.1e-04 per=1.1e+01 cost=1.5e+05 flops=7.0e+08
 sigma[gemm] counter=30 i=6 t=2.2e-04 per=1.2e+01 cost=2.2e+05 flops=9.9e+08
 sigma[gemm] counter=30 i=7 t=2.3e-04 per=1.3e+01 cost=2.1e+05 flops=9.0e+08
 sigma[gemm] counter=30 total t=8.9e-04 per=4.7e+01 cost=7.3e+05 flops=8.2e+08
 sigma[red] counter=30 t=8.0e-04 per=4.2e+01 cost=1.5e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=3.2e-03 t_gemm=1.6e-02 t_reduction=1.5e-02 tot=3.4e-02 -----
 sigma_tot[inter] counter=30 t=3.2e-03 per=9.6e+00 cost=6.8e+06 flops=2.1e+09
 sigma_tot[gemm] counter=30 i=0 t=7.0e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=5.9e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=6.0e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=3 t=5.9e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=4 t=3.9e-03 per=1.2e+01 cost=1.4e+06 flops=3.5e+08
 sigma_tot[gemm] counter=30 i=5 t=4.2e-03 per=1.3e+01 cost=1.4e+06 flops=3.4e+08
 sigma_tot[gemm] counter=30 i=6 t=3.6e-03 per=1.1e+01 cost=1.6e+06 flops=4.3e+08
 sigma_tot[gemm] counter=30 i=7 t=3.6e-03 per=1.1e+01 cost=1.6e+06 flops=4.3e+08
 sigma_tot[gemm] counter=30 total t=1.6e-02 per=4.7e+01 cost=5.9e+06 flops=3.8e+08
 sigma_tot[red] counter=30 t=1.5e-02 per=4.4e+01 cost=1.6e+06 flops=1.1e+08
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.6e-06,9.7e-07,4.0e-06,2.7e-07
settings: ndim=194 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.217292960069 -1.116e+03  5.493e-02    1     1  2.304e-03 2.304e-03 2.258e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.909e-05,1.600e-04,1.020e-03,8.379e-04,2.092e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=2.231e-05 speed=1.296e-01GB/S T(nccl)=4.678e-05 speed=6.180e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.0e-03 t_reduction=8.4e-04 tot=2.0e-03 -----
 sigma[inter] counter=31 t=1.6e-04 per=7.9e+00 cost=5.3e+05 flops=3.3e+09
 sigma[gemm] counter=31 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=1.9e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=3 t=2.0e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=4 t=2.2e-04 per=1.1e+01 cost=1.5e+05 flops=6.6e+08
 sigma[gemm] counter=31 i=5 t=2.5e-04 per=1.2e+01 cost=1.5e+05 flops=5.9e+08
 sigma[gemm] counter=31 i=6 t=2.6e-04 per=1.3e+01 cost=2.2e+05 flops=8.5e+08
 sigma[gemm] counter=31 i=7 t=2.8e-04 per=1.4e+01 cost=2.1e+05 flops=7.5e+08
 sigma[gemm] counter=31 total t=1.0e-03 per=5.1e+01 cost=7.3e+05 flops=7.1e+08
 sigma[red] counter=31 t=8.4e-04 per=4.2e+01 cost=1.5e+05 flops=1.8e+08
----- TIMING FOR sigma_tot : t_inter=3.4e-03 t_gemm=1.7e-02 t_reduction=1.6e-02 tot=3.6e-02 -----
 sigma_tot[inter] counter=31 t=3.4e-03 per=9.5e+00 cost=7.3e+06 flops=2.2e+09
 sigma_tot[gemm] counter=31 i=0 t=7.2e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=6.1e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=6.2e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=3 t=6.1e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=4 t=4.1e-03 per=1.2e+01 cost=1.5e+06 flops=3.7e+08
 sigma_tot[gemm] counter=31 i=5 t=4.5e-03 per=1.3e+01 cost=1.6e+06 flops=3.5e+08
 sigma_tot[gemm] counter=31 i=6 t=3.9e-03 per=1.1e+01 cost=1.8e+06 flops=4.6e+08
 sigma_tot[gemm] counter=31 i=7 t=3.9e-03 per=1.1e+01 cost=1.8e+06 flops=4.6e+08
 sigma_tot[gemm] counter=31 total t=1.7e-02 per=4.7e+01 cost=6.7e+06 flops=4.0e+08
 sigma_tot[red] counter=31 t=1.6e-02 per=4.4e+01 cost=1.7e+06 flops=1.1e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,1.8e-05,3.0e-06,1.8e-06,2.8e-07
    2   0 -    -116.232659895835 -1.537e-02  2.305e-02    2     2  4.709e-03 2.355e-03 2.284e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.638e-05,1.486e-04,9.944e-04,8.352e-04,2.049e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=2.138e-05 speed=1.352e-01GB/S T(nccl)=4.500e-05 speed=6.424e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.9e-04 t_reduction=8.3e-04 tot=2.0e-03 -----
 sigma[inter] counter=32 t=1.5e-04 per=7.5e+00 cost=5.3e+05 flops=3.6e+09
 sigma[gemm] counter=32 i=0 t=2.0e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=1.9e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=1.9e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=3 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=4 t=2.2e-04 per=1.1e+01 cost=1.5e+05 flops=6.8e+08
 sigma[gemm] counter=32 i=5 t=2.6e-04 per=1.3e+01 cost=1.5e+05 flops=5.6e+08
 sigma[gemm] counter=32 i=6 t=2.5e-04 per=1.3e+01 cost=2.2e+05 flops=8.7e+08
 sigma[gemm] counter=32 i=7 t=2.6e-04 per=1.3e+01 cost=2.1e+05 flops=8.2e+08
 sigma[gemm] counter=32 total t=9.9e-04 per=5.0e+01 cost=7.3e+05 flops=7.3e+08
 sigma[red] counter=32 t=8.3e-04 per=4.2e+01 cost=1.5e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=3.5e-03 t_gemm=1.8e-02 t_reduction=1.6e-02 tot=3.8e-02 -----
 sigma_tot[inter] counter=32 t=3.5e-03 per=9.4e+00 cost=7.8e+06 flops=2.2e+09
 sigma_tot[gemm] counter=32 i=0 t=7.4e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=6.3e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=6.4e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=3 t=6.3e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=4 t=4.4e-03 per=1.2e+01 cost=1.7e+06 flops=3.9e+08
 sigma_tot[gemm] counter=32 i=5 t=4.7e-03 per=1.3e+01 cost=1.7e+06 flops=3.6e+08
 sigma_tot[gemm] counter=32 i=6 t=4.1e-03 per=1.1e+01 cost=2.0e+06 flops=4.8e+08
 sigma_tot[gemm] counter=32 i=7 t=4.2e-03 per=1.1e+01 cost=2.0e+06 flops=4.8e+08
 sigma_tot[gemm] counter=32 total t=1.8e-02 per=4.7e+01 cost=7.4e+06 flops=4.2e+08
 sigma_tot[red] counter=32 t=1.6e-02 per=4.4e+01 cost=1.9e+06 flops=1.1e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.6e-05,2.0e-06,1.7e-06,2.7e-07
    3   0 -    -116.234226590508 -1.567e-03  9.046e-03    3     3  7.015e-03 2.338e-03 2.273e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.702e-05,1.476e-04,9.830e-04,8.240e-04,2.026e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=2.145e-05 speed=1.348e-01GB/S T(nccl)=4.557e-05 speed=6.344e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.8e-04 t_reduction=8.2e-04 tot=2.0e-03 -----
 sigma[inter] counter=33 t=1.5e-04 per=7.5e+00 cost=5.3e+05 flops=3.6e+09
 sigma[gemm] counter=33 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=3 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=4 t=2.2e-04 per=1.1e+01 cost=1.5e+05 flops=6.7e+08
 sigma[gemm] counter=33 i=5 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=5.9e+08
 sigma[gemm] counter=33 i=6 t=2.5e-04 per=1.3e+01 cost=2.2e+05 flops=8.9e+08
 sigma[gemm] counter=33 i=7 t=2.6e-04 per=1.3e+01 cost=2.1e+05 flops=8.2e+08
 sigma[gemm] counter=33 total t=9.8e-04 per=5.0e+01 cost=7.3e+05 flops=7.4e+08
 sigma[red] counter=33 t=8.2e-04 per=4.2e+01 cost=1.5e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=3.7e-03 t_gemm=1.9e-02 t_reduction=1.7e-02 tot=3.9e-02 -----
 sigma_tot[inter] counter=33 t=3.7e-03 per=9.3e+00 cost=8.3e+06 flops=2.3e+09
 sigma_tot[gemm] counter=33 i=0 t=7.6e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=6.5e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=6.6e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=3 t=6.5e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=4 t=4.6e-03 per=1.2e+01 cost=1.8e+06 flops=4.0e+08
 sigma_tot[gemm] counter=33 i=5 t=5.0e-03 per=1.3e+01 cost=1.9e+06 flops=3.7e+08
 sigma_tot[gemm] counter=33 i=6 t=4.4e-03 per=1.1e+01 cost=2.2e+06 flops=5.1e+08
 sigma_tot[gemm] counter=33 i=7 t=4.4e-03 per=1.1e+01 cost=2.2e+06 flops=5.0e+08
 sigma_tot[gemm] counter=33 total t=1.9e-02 per=4.7e+01 cost=8.1e+06 flops=4.4e+08
 sigma_tot[red] counter=33 t=1.7e-02 per=4.4e+01 cost=2.0e+06 flops=1.2e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.2e-05,2.1e-06,1.5e-06,1.9e-07
    4   0 -    -116.234459483751 -2.329e-04  3.726e-03    3     4  9.281e-03 2.320e-03 2.259e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.445e-05,1.482e-04,9.897e-04,8.254e-04,2.042e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=2.460e-05 speed=1.175e-01GB/S T(nccl)=4.985e-05 speed=5.800e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.9e-04 t_reduction=8.3e-04 tot=2.0e-03 -----
 sigma[inter] counter=34 t=1.5e-04 per=7.5e+00 cost=5.3e+05 flops=3.6e+09
 sigma[gemm] counter=34 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=2.0e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=3 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=4 t=2.2e-04 per=1.1e+01 cost=1.5e+05 flops=6.7e+08
 sigma[gemm] counter=34 i=5 t=2.4e-04 per=1.2e+01 cost=1.5e+05 flops=6.0e+08
 sigma[gemm] counter=34 i=6 t=2.5e-04 per=1.3e+01 cost=2.2e+05 flops=8.7e+08
 sigma[gemm] counter=34 i=7 t=2.7e-04 per=1.4e+01 cost=2.1e+05 flops=8.0e+08
 sigma[gemm] counter=34 total t=9.9e-04 per=5.0e+01 cost=7.3e+05 flops=7.3e+08
 sigma[red] counter=34 t=8.3e-04 per=4.2e+01 cost=1.5e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=3.8e-03 t_gemm=2.0e-02 t_reduction=1.8e-02 tot=4.1e-02 -----
 sigma_tot[inter] counter=34 t=3.8e-03 per=9.2e+00 cost=8.9e+06 flops=2.3e+09
 sigma_tot[gemm] counter=34 i=0 t=7.8e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=6.7e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=6.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=3 t=6.7e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=4 t=4.8e-03 per=1.2e+01 cost=2.0e+06 flops=4.1e+08
 sigma_tot[gemm] counter=34 i=5 t=5.2e-03 per=1.3e+01 cost=2.0e+06 flops=3.8e+08
 sigma_tot[gemm] counter=34 i=6 t=4.6e-03 per=1.1e+01 cost=2.4e+06 flops=5.3e+08
 sigma_tot[gemm] counter=34 i=7 t=4.7e-03 per=1.1e+01 cost=2.4e+06 flops=5.2e+08
 sigma_tot[gemm] counter=34 total t=2.0e-02 per=4.7e+01 cost=8.8e+06 flops=4.5e+08
 sigma_tot[red] counter=34 t=1.8e-02 per=4.4e+01 cost=2.2e+06 flops=1.2e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.2e-05,2.1e-06,1.4e-06,1.6e-07
    5   0 -    -116.234499291415 -3.981e-05  1.449e-03    3     5  1.155e-02 2.311e-03 2.252e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.693e-05,1.498e-04,9.840e-04,8.273e-04,2.032e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=2.131e-05 speed=1.357e-01GB/S T(nccl)=4.562e-05 speed=6.337e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.8e-04 t_reduction=8.3e-04 tot=2.0e-03 -----
 sigma[inter] counter=35 t=1.5e-04 per=7.6e+00 cost=5.3e+05 flops=3.5e+09
 sigma[gemm] counter=35 i=0 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=3 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=4 t=2.2e-04 per=1.1e+01 cost=1.5e+05 flops=6.7e+08
 sigma[gemm] counter=35 i=5 t=2.4e-04 per=1.2e+01 cost=1.5e+05 flops=6.1e+08
 sigma[gemm] counter=35 i=6 t=2.6e-04 per=1.3e+01 cost=2.2e+05 flops=8.6e+08
 sigma[gemm] counter=35 i=7 t=2.6e-04 per=1.3e+01 cost=2.1e+05 flops=8.2e+08
 sigma[gemm] counter=35 total t=9.8e-04 per=5.0e+01 cost=7.3e+05 flops=7.4e+08
 sigma[red] counter=35 t=8.3e-04 per=4.2e+01 cost=1.5e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=4.0e-03 t_gemm=2.1e-02 t_reduction=1.9e-02 tot=4.3e-02 -----
 sigma_tot[inter] counter=35 t=4.0e-03 per=9.1e+00 cost=9.4e+06 flops=2.4e+09
 sigma_tot[gemm] counter=35 i=0 t=8.0e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=6.9e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=7.0e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=3 t=6.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=4 t=5.0e-03 per=1.2e+01 cost=2.1e+06 flops=4.2e+08
 sigma_tot[gemm] counter=35 i=5 t=5.4e-03 per=1.3e+01 cost=2.1e+06 flops=3.9e+08
 sigma_tot[gemm] counter=35 i=6 t=4.9e-03 per=1.1e+01 cost=2.7e+06 flops=5.4e+08
 sigma_tot[gemm] counter=35 i=7 t=4.9e-03 per=1.1e+01 cost=2.6e+06 flops=5.3e+08
 sigma_tot[gemm] counter=35 total t=2.1e-02 per=4.7e+01 cost=9.6e+06 flops=4.6e+08
 sigma_tot[red] counter=35 t=1.9e-02 per=4.3e+01 cost=2.3e+06 flops=1.2e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.2e-05,2.0e-06,1.4e-06,1.7e-07
    6   0 -    -116.234505308352 -6.017e-06  4.517e-04    3     6  1.383e-02 2.305e-03 2.248e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.652e-05,1.465e-04,9.859e-04,8.236e-04,2.027e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=2.124e-05 speed=1.361e-01GB/S T(nccl)=4.528e-05 speed=6.385e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.9e-04 t_reduction=8.2e-04 tot=2.0e-03 -----
 sigma[inter] counter=36 t=1.5e-04 per=7.5e+00 cost=5.3e+05 flops=3.6e+09
 sigma[gemm] counter=36 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=3 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=4 t=2.1e-04 per=1.1e+01 cost=1.5e+05 flops=6.9e+08
 sigma[gemm] counter=36 i=5 t=2.6e-04 per=1.3e+01 cost=1.5e+05 flops=5.6e+08
 sigma[gemm] counter=36 i=6 t=2.5e-04 per=1.3e+01 cost=2.2e+05 flops=8.8e+08
 sigma[gemm] counter=36 i=7 t=2.5e-04 per=1.3e+01 cost=2.1e+05 flops=8.3e+08
 sigma[gemm] counter=36 total t=9.9e-04 per=5.0e+01 cost=7.3e+05 flops=7.4e+08
 sigma[red] counter=36 t=8.2e-04 per=4.2e+01 cost=1.5e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=4.1e-03 t_gemm=2.2e-02 t_reduction=2.0e-02 tot=4.5e-02 -----
 sigma_tot[inter] counter=36 t=4.1e-03 per=9.1e+00 cost=9.9e+06 flops=2.4e+09
 sigma_tot[gemm] counter=36 i=0 t=8.2e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=7.1e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=7.2e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=3 t=7.0e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=4 t=5.2e-03 per=1.2e+01 cost=2.3e+06 flops=4.3e+08
 sigma_tot[gemm] counter=36 i=5 t=5.7e-03 per=1.3e+01 cost=2.3e+06 flops=4.0e+08
 sigma_tot[gemm] counter=36 i=6 t=5.1e-03 per=1.1e+01 cost=2.9e+06 flops=5.6e+08
 sigma_tot[gemm] counter=36 i=7 t=5.2e-03 per=1.1e+01 cost=2.8e+06 flops=5.5e+08
 sigma_tot[gemm] counter=36 total t=2.2e-02 per=4.8e+01 cost=1.0e+07 flops=4.8e+08
 sigma_tot[red] counter=36 t=2.0e-02 per=4.3e+01 cost=2.5e+06 flops=1.3e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.2e-05,1.9e-06,1.4e-06,1.8e-07
    7   0 -    -116.234506073987 -7.656e-07  2.023e-04    3     7  1.610e-02 2.300e-03 2.243e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.588e-05,1.441e-04,9.726e-04,8.287e-04,2.015e-03
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=2.101e-05 speed=1.376e-01GB/S T(nccl)=4.488e-05 speed=6.442e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=9.7e-04 t_reduction=8.3e-04 tot=1.9e-03 -----
 sigma[inter] counter=37 t=1.4e-04 per=7.4e+00 cost=5.3e+05 flops=3.7e+09
 sigma[gemm] counter=37 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=3 t=1.9e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=4 t=2.1e-04 per=1.1e+01 cost=1.5e+05 flops=6.9e+08
 sigma[gemm] counter=37 i=5 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=5.9e+08
 sigma[gemm] counter=37 i=6 t=2.5e-04 per=1.3e+01 cost=2.2e+05 flops=8.9e+08
 sigma[gemm] counter=37 i=7 t=2.6e-04 per=1.3e+01 cost=2.1e+05 flops=8.2e+08
 sigma[gemm] counter=37 total t=9.7e-04 per=5.0e+01 cost=7.3e+05 flops=7.5e+08
 sigma[red] counter=37 t=8.3e-04 per=4.3e+01 cost=1.5e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=4.3e-03 t_gemm=2.3e-02 t_reduction=2.1e-02 tot=4.7e-02 -----
 sigma_tot[inter] counter=37 t=4.3e-03 per=9.0e+00 cost=1.0e+07 flops=2.5e+09
 sigma_tot[gemm] counter=37 i=0 t=8.4e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=7.3e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=7.3e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=3 t=7.2e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=4 t=5.4e-03 per=1.1e+01 cost=2.4e+06 flops=4.4e+08
 sigma_tot[gemm] counter=37 i=5 t=5.9e-03 per=1.3e+01 cost=2.4e+06 flops=4.1e+08
 sigma_tot[gemm] counter=37 i=6 t=5.4e-03 per=1.1e+01 cost=3.1e+06 flops=5.8e+08
 sigma_tot[gemm] counter=37 i=7 t=5.4e-03 per=1.2e+01 cost=3.0e+06 flops=5.6e+08
 sigma_tot[gemm] counter=37 total t=2.3e-02 per=4.8e+01 cost=1.1e+07 flops=4.9e+08
 sigma_tot[red] counter=37 t=2.1e-02 per=4.3e+01 cost=2.6e+06 flops=1.3e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.1e-05,2.0e-06,1.4e-06,1.5e-07
    8   0 +    -116.234506198197 -1.242e-07  6.082e-05    3     8  1.836e-02 2.295e-03 2.238e-03
TIMING FOR Davidson : 1.838e-02  T(cal/comm/rest)=1.791e-02,1.747e-06,4.676e-04
decomposed t_rest=4.676e-04
 T(sub)    =1.748e-04 per=3.737e+01
 T(precond)=2.533e-05 per=5.417e+00
 T(ortho)  =1.312e-05 per=2.806e+00
 T(xcopy)  =1.077e-06 per=2.303e-01
 T(xnrm2)  =1.811e-06 per=3.873e-01
 T(other)  =2.515e-04 per=5.379e+01
optimized energies: isweep=0 ibond=5 dots=2 e[0]=-116.234506198197 nmvp=8
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=3.670e-03 change=2.762e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=10 dimAll=40
 (9,3):7 (11,3):4 (10,2):9 (10,4):5 (9,1):5 (11,1):3 (10,0):3 (8,2):2 (8,4):1 (9,5):1
timing for divide=1.0e-05
timing for compute=7.5e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 9.8e-05 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,6.5e-05,0.0e+00,1.1e-05,1.3e-05 -----
decimation summary: 40->10 dwt=+5.145e-02 SvN=1.503e+00
 qbond: qkept nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
----- TIMING for decimation_row(nkr): 1.073e-03 S T(decim/select/formRot)=1.414e-04,9.068e-04,2.431e-05 -----
----- TIMING FOR twodot_decimation: 1.185e-03 S T(wf/decim)=9.906e-05,1.086e-03 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:7 S:7 H:1 A:27 B:26 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1249:9.529e-03MB:9.306e-06GB
        per(mem): C:6.73 S:6.73 H:2.24 A:0 B:84.3 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=3.670e-03 change=1.326e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=61 : 8.612e-05 S -----
rank=0 GPUmem(GB): used=4.660e-05 (oper)=2.540e-05
rank=0 GPUmem(GB): used=4.707e-05 (oper,site)=2.540e-05,4.619e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=61
 no. of rintermediate operators=5
 no. of coefficients=50:3.815e-04MB:3.725e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.837e-05 S -----
rank=0 GPUmem(GB): used=4.744e-05 (oper,site,rinter)=2.540e-05,4.619e-07,3.725e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 8.456e-04 S size(rtasks)=61 size(Rlst2)=25 T(Rmu/Rlist)=6.423e-05,7.813e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.856e-04 S size(rtasks)=61 size(Rlst)=675 -----
rank=0 GPUmem(GB): used=4.744e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.464e-04 blksize=16 blksize0=16 batchsize=675
rank=0 GPUmem(GB): used=2.939e-04 (oper,site,rinter,batch)=2.540e-05,4.619e-07,3.725e-07,2.464e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.330e-04,5.354e-04,1.724e-04
----- TIMING FOR renorm : t_inter=1.3e-04 t_gemm=5.3e-04 t_reduction=1.7e-04 tot=8.4e-04 -----
 renorm[inter] counter=86 t=1.3e-04 per=1.6e+01 cost=1.2e+04 flops=9.1e+07
 renorm[gemm] counter=86 i=0 t=2.1e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=1 t=2.0e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=2 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=3 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=4 t=1.8e-04 per=2.1e+01 cost=2.5e+03 flops=1.4e+07
 renorm[gemm] counter=86 i=5 t=2.0e-04 per=2.4e+01 cost=2.0e+04 flops=9.9e+07
 renorm[gemm] counter=86 i=6 t=1.4e-04 per=1.7e+01 cost=2.4e+04 flops=1.7e+08
 renorm[gemm] counter=86 total t=5.3e-04 per=6.4e+01 cost=4.6e+04 flops=8.7e+07
 renorm[red] counter=86 t=1.7e-04 per=2.1e+01 cost=7.6e+03 flops=4.4e+07
----- TIMING FOR renorm_tot : t_inter=4.9e-04 t_gemm=1.9e-03 t_reduction=8.3e-04 tot=3.3e-03 -----
 renorm_tot[inter] counter=86 t=4.9e-04 per=1.5e+01 cost=2.1e+04 flops=4.3e+07
 renorm_tot[gemm] counter=86 i=0 t=1.3e-05 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=1 t=1.2e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=2 t=1.1e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=3 t=1.1e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=4 t=6.2e-04 per=1.9e+01 cost=5.5e+03 flops=8.9e+06
 renorm_tot[gemm] counter=86 i=5 t=6.4e-04 per=2.0e+01 cost=3.6e+04 flops=5.7e+07
 renorm_tot[gemm] counter=86 i=6 t=6.3e-04 per=1.9e+01 cost=4.8e+04 flops=7.6e+07
 renorm_tot[gemm] counter=86 total t=1.9e-03 per=6.0e+01 cost=9.0e+04 flops=4.6e+07
 renorm_tot[red] counter=86 t=8.3e-04 per=2.5e+01 cost=1.9e+04 flops=2.2e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.362e-05 (oper)=2.549e-05
rank=0 GPUmem(GB): used=5.408e-05 (oper,site,rinter)=2.549e-05,4.619e-07,6.557e-06
rank=0 GPUmem(GB): used=7.964e-05 (oper,site,rinter,batch)=2.549e-05,4.619e-07,6.557e-06,2.556e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.608e-03 S T(preprocess/alloc/comp/red/dealloc)=1.654e-03,1.709e-03,5.520e-03,2.514e-04,1.039e-04 -----
----- TIMING FOR oper_renorm_opS : 7.641e-03 S rank=0 -----
qops.to_cpu: size(tot)=1249:9.529e-03MB:9.306e-06GB T(to_cpu)=3.840e-05S speed=2.423e-01GB/S
check ||H-H.dagger||=6.407e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0107 S rank=0 -----
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=4.402e-03 change=1.948e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=4.410e-03 change=-1.356e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=4.410e-03 change=-3.695e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 7.126e-02 S #####
 T(local opt: fetch) = 2.828e-03 S  per = 3.97  per(accum) = 3.97
 T(local opt: hdiag) = 2.916e-03 S  per = 4.09  per(accum) = 8.06
 T(local opt: dvdsn) = 5.055e-02 S  per = 70.9  per(accum) = 79
 T(local opt: decim) = 1.223e-03 S  per = 1.72  per(accum) = 80.7
 T(local opt: guess) = 1.256e-04 S  per = 0.176  per(accum) = 80.9
 T(local opt: renrm) = 1.176e-02 S  per = 16.5  per(accum) = 97.4
 T(local opt: save ) = 1.859e-03 S  per = 2.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.055e-02 S  T(sum) = 4.993e-02 S  per = 9.876e+01
 T(local opt: preprocess                  ) = 3.944e-04 S  per = 0.79  per(accum) = 0.79
 T(local opt: symbolic_formulae           ) = 5.703e-04 S  per = 1.14  per(accum) = 1.93
 T(local opt: hintermediate init          ) = 9.704e-05 S  per = 0.194  per(accum) = 2.13
 T(local opt: preprocess_hformulae_Hxlist ) = 2.559e-02 S  per = 51.3  per(accum) = 53.4
 T(local opt: hmmtasks init               ) = 4.700e-03 S  per = 9.41  per(accum) = 62.8
 T(local opt: initial guess for dvdson    ) = 1.930e-04 S  per = 0.387  per(accum) = 63.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.733e-02 S  per = 34.7  per(accum) = 97.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.844e-04 S  per = 0.369  per(accum) = 98.3
 T(local opt: dvdson [nccl]               ) = 3.915e-04 S  per = 0.784  per(accum) = 99.1
 T(local opt: dvdson [mpi]                ) = 1.747e-06 S  per = 0.0035  per(accum) = 99.1
 T(local opt: dvdson [rest part(linalg)]  ) = 4.676e-04 S  per = 0.937  per(accum) = 100
Detailed decomposition of T(renrm) = 1.176e-02 S  T(sum) = 1.176e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.227e-05 S  per = 0.53  per(accum) = 0.53
 T(local opt: qops init                    ) = 4.004e-04 S  per = 3.41  per(accum) = 3.94
 T(local opt: symbolic_formulae_renorm     ) = 9.672e-05 S  per = 0.823  per(accum) = 4.76
 T(local opt: allocate qops on gpu         ) = 5.948e-05 S  per = 0.506  per(accum) = 5.26
 T(local opt: site memcpy cpu2gpu          ) = 3.145e-05 S  per = 0.267  per(accum) = 5.53
 T(local opt: rintermediate init           ) = 5.683e-05 S  per = 0.483  per(accum) = 6.01
 T(local opt: preprocess_formulae_Rlist2   ) = 8.959e-04 S  per = 7.62  per(accum) = 13.6
 T(local opt: rmmtasks init                ) = 3.215e-04 S  per = 2.73  per(accum) = 16.4
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 0.000374  per(accum) = 16.4
 T(local opt: preprocess_renorm_batchGPU   ) = 1.018e-03 S  per = 8.66  per(accum) = 25
 T(local opt: deallocate cpu and gpu memory) = 3.717e-05 S  per = 0.316  per(accum) = 25.3
 T(local opt: construct opS [ifdists=true] ) = 7.660e-03 S  per = 65.1  per(accum) = 90.5
 T(local opt: reduction of opS & opH [nccl]) = 1.883e-05 S  per = 0.16  per(accum) = 90.7
 T(local opt: qops memcpy gpu2cpu          ) = 4.792e-05 S  per = 0.408  per(accum) = 91.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.388e-05 S  per = 0.118  per(accum) = 91.2
 T(local opt: qops_pool join and erase     ) = 1.032e-03 S  per = 8.78  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.819e-06 S  per = 0.041  per(accum) = 100
ctns::rcanon_save_site idx=13 scratch=./scratch/sweep size=62:4.6e-07GB T(load)=0.00058S speed=0.0008GB/S
##### sweep opt: 2.409e-01 S #####
 T(sweep opt: fetch) = 1.788e-02 S  per = 7.42  per(accum) = 7.42
 T(sweep opt: hdiag) = 9.177e-03 S  per = 3.81  per(accum) = 11.2
 T(sweep opt: dvdsn) = 1.432e-01 S  per = 59.4  per(accum) = 70.7
 T(sweep opt: decim) = 6.532e-03 S  per = 2.71  per(accum) = 73.4
 T(sweep opt: guess) = 5.862e-04 S  per = 0.243  per(accum) = 73.6
 T(sweep opt: renrm) = 5.277e-02 S  per = 21.9  per(accum) = 95.5
 T(sweep opt: save ) = 1.082e-02 S  per = 4.49  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.432e-01 S  T(sum) = 1.409e-01 S  per = 9.842e+01
 T(sweep opt: preprocess                  ) = 2.200e-03 S  per = 1.56  per(accum) = 1.56
 T(sweep opt: symbolic_formulae           ) = 1.941e-03 S  per = 1.38  per(accum) = 2.94
 T(sweep opt: hintermediate init          ) = 3.276e-04 S  per = 0.232  per(accum) = 3.17
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.527e-02 S  per = 46.3  per(accum) = 49.5
 T(sweep opt: hmmtasks init               ) = 1.105e-02 S  per = 7.84  per(accum) = 57.3
 T(sweep opt: initial guess for dvdson    ) = 8.843e-04 S  per = 0.628  per(accum) = 58
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.413e-02 S  per = 38.4  per(accum) = 96.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 8.100e-04 S  per = 0.575  per(accum) = 97
 T(sweep opt: dvdson [nccl]               ) = 2.342e-03 S  per = 1.66  per(accum) = 98.6
 T(sweep opt: dvdson [mpi]                ) = 1.170e-05 S  per = 0.0083  per(accum) = 98.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.938e-03 S  per = 1.38  per(accum) = 100
Detailed decomposition of T(renrm) = 5.277e-02 S  T(sum) = 5.277e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.978e-04 S  per = 0.564  per(accum) = 0.564
 T(sweep opt: qops init                    ) = 1.669e-03 S  per = 3.16  per(accum) = 3.73
 T(sweep opt: symbolic_formulae_renorm     ) = 3.127e-04 S  per = 0.593  per(accum) = 4.32
 T(sweep opt: allocate qops on gpu         ) = 3.138e-04 S  per = 0.595  per(accum) = 4.91
 T(sweep opt: site memcpy cpu2gpu          ) = 1.411e-04 S  per = 0.267  per(accum) = 5.18
 T(sweep opt: rintermediate init           ) = 1.912e-04 S  per = 0.362  per(accum) = 5.54
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.307e-03 S  per = 4.37  per(accum) = 9.92
 T(sweep opt: rmmtasks init                ) = 9.218e-04 S  per = 1.75  per(accum) = 11.7
 T(sweep opt: qops memset on cpu           ) = 2.200e-07 S  per = 0.000417  per(accum) = 11.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.954e-03 S  per = 7.49  per(accum) = 19.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.524e-04 S  per = 0.289  per(accum) = 19.4
 T(sweep opt: construct opS [ifdists=true] ) = 3.752e-02 S  per = 71.1  per(accum) = 90.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.120e-04 S  per = 0.212  per(accum) = 90.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.946e-04 S  per = 0.369  per(accum) = 91.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.110e-05 S  per = 0.116  per(accum) = 91.2
 T(sweep opt: qops_pool join and erase     ) = 4.608e-03 S  per = 8.73  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.713e-05 S  per = 0.0325  per(accum) = 100
##### global opt: 2.409e-01 S #####
 T(global opt: fetch) = 1.788e-02 S  per = 7.42  per(accum) = 7.42
 T(global opt: hdiag) = 9.177e-03 S  per = 3.81  per(accum) = 11.2
 T(global opt: dvdsn) = 1.432e-01 S  per = 59.4  per(accum) = 70.7
 T(global opt: decim) = 6.532e-03 S  per = 2.71  per(accum) = 73.4
 T(global opt: guess) = 5.862e-04 S  per = 0.243  per(accum) = 73.6
 T(global opt: renrm) = 5.277e-02 S  per = 21.9  per(accum) = 95.5
 T(global opt: save ) = 1.082e-02 S  per = 4.49  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.432e-01 S  T(sum) = 1.409e-01 S  per = 9.842e+01
 T(global opt: preprocess                  ) = 2.200e-03 S  per = 1.56  per(accum) = 1.56
 T(global opt: symbolic_formulae           ) = 1.941e-03 S  per = 1.38  per(accum) = 2.94
 T(global opt: hintermediate init          ) = 3.276e-04 S  per = 0.232  per(accum) = 3.17
 T(global opt: preprocess_hformulae_Hxlist ) = 6.527e-02 S  per = 46.3  per(accum) = 49.5
 T(global opt: hmmtasks init               ) = 1.105e-02 S  per = 7.84  per(accum) = 57.3
 T(global opt: initial guess for dvdson    ) = 8.843e-04 S  per = 0.628  per(accum) = 58
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.413e-02 S  per = 38.4  per(accum) = 96.4
 T(global opt: dvdson [cpu-gpu]            ) = 8.100e-04 S  per = 0.575  per(accum) = 97
 T(global opt: dvdson [nccl]               ) = 2.342e-03 S  per = 1.66  per(accum) = 98.6
 T(global opt: dvdson [mpi]                ) = 1.170e-05 S  per = 0.0083  per(accum) = 98.6
 T(global opt: dvdson [rest part(linalg)]  ) = 1.938e-03 S  per = 1.38  per(accum) = 100
Detailed decomposition of T(renrm) = 5.277e-02 S  T(sum) = 5.277e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.978e-04 S  per = 0.564  per(accum) = 0.564
 T(global opt: qops init                    ) = 1.669e-03 S  per = 3.16  per(accum) = 3.73
 T(global opt: symbolic_formulae_renorm     ) = 3.127e-04 S  per = 0.593  per(accum) = 4.32
 T(global opt: allocate qops on gpu         ) = 3.138e-04 S  per = 0.595  per(accum) = 4.91
 T(global opt: site memcpy cpu2gpu          ) = 1.411e-04 S  per = 0.267  per(accum) = 5.18
 T(global opt: rintermediate init           ) = 1.912e-04 S  per = 0.362  per(accum) = 5.54
 T(global opt: preprocess_formulae_Rlist2   ) = 2.307e-03 S  per = 4.37  per(accum) = 9.92
 T(global opt: rmmtasks init                ) = 9.218e-04 S  per = 1.75  per(accum) = 11.7
 T(global opt: qops memset on cpu           ) = 2.200e-07 S  per = 0.000417  per(accum) = 11.7
 T(global opt: preprocess_renorm_batchGPU   ) = 3.954e-03 S  per = 7.49  per(accum) = 19.2
 T(global opt: deallocate cpu and gpu memory) = 1.524e-04 S  per = 0.289  per(accum) = 19.4
 T(global opt: construct opS [ifdists=true] ) = 3.752e-02 S  per = 71.1  per(accum) = 90.5
 T(global opt: reduction of opS & opH [nccl]) = 1.120e-04 S  per = 0.212  per(accum) = 90.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.946e-04 S  per = 0.369  per(accum) = 91.1
 T(global opt: reduction of opS & opH [mpi] ) = 6.110e-05 S  per = 0.116  per(accum) = 91.2
 T(global opt: qops_pool join and erase     ) = 4.608e-03 S  per = 8.73  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.713e-05 S  per = 0.0325  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-2.767e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=6/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=11 scratch=./scratch/sweep size=97:7.23e-07GB T(load)=3.41e-04S speed=2.12e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=194:1.48e-03MB:1.45e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=49:3.74e-04MB:3.65e-07GB
total mem of comb=244:1.86e-03MB:1.82e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.471e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:7 S:7 H:1 A:27 B:26 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1249:9.529e-03MB:9.306e-06GB
        per(mem): C:6.73 S:6.73 H:2.24 A:0 B:84.3 
 rqops: oplist=CSHPQ nops=C:11 S:4 H:1 P:40 Q:46 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=6142:0.0469MB:4.58e-05GB
        per(mem): C:4.66 S:1.69 H:1.16 P:0 Q:92.5 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=9387:0.0716MB:6.99e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.195e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-4.536e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=62:4.730e-04MB
qtensor4: wf4 own=1 _data=0x5585f638d600
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
 qbond: qcol nsym=7 dimAll=19
 (16,0):3 (16,2):5 (16,4):5 (16,6):3 (17,1):1 (17,3):1 (17,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=513 size=62:4.730e-04MB
### DIAG TIMING: total=2.359e-03 t1=1.700e-05, t2=1.441e-05, t3=1.897e-05, t4=2.259e-03, t5=5.905e-06, t6=3.728e-05, t7=6.217e-06
duration_diagGPU:2.368e-03
duration_diagreduce:5.700e-08
duration_diagtransform:2.350e-07
----- TIMING FOR symbolic_formulae_twodot with size=388 : 7.109e-04 S -----
rank=0 GPUmem(GB): used=6.994e-05 (oper)=6.994e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=388
 no. of hintermediate operators=201
 no. of coefficients=2367:1.806e-02MB:1.764e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.330e-05 S -----
rank=0 GPUmem(GB): used=8.757e-05 (oper,hinter)=6.994e-05,1.764e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.607e-03 S size(H_formulae)=388 size(Hxlst2)=15 T(Hmu/Hxlist)=1.745e-04,7.433e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.034e-03 S size(H_formulae)=388 size(Hxlst)=4312 -----
rank=0 GPUmem(GB): used=8.757e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=9.239e-07 batch[need]=1.831e-03 blksize=20 blksize0=16 batchsize=4312
rank=0 GPUmem(GB): used=1.920e-03 (oper,hinter,dvdson,batch)=6.994e-05,1.764e-05,9.239e-07,1.831e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=62 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.433e-05,1.453e-04,6.318e-04,3.809e-04,1.240e-03
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.383e-05 speed=3.877e-02GB/S T(nccl)=5.050e-05 speed=1.830e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=6.3e-04 t_reduction=3.8e-04 tot=1.2e-03 -----
 sigma[inter] counter=38 t=1.5e-04 per=1.3e+01 cost=2.3e+05 flops=1.6e+09
 sigma[gemm] counter=38 i=0 t=2.4e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=1.9e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=3 t=1.9e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=4 t=1.6e-04 per=1.4e+01 cost=3.6e+04 flops=2.2e+08
 sigma[gemm] counter=38 i=5 t=1.6e-04 per=1.4e+01 cost=3.6e+04 flops=2.2e+08
 sigma[gemm] counter=38 i=6 t=1.5e-04 per=1.3e+01 cost=5.8e+04 flops=3.8e+08
 sigma[gemm] counter=38 i=7 t=1.5e-04 per=1.3e+01 cost=5.8e+04 flops=3.9e+08
 sigma[gemm] counter=38 total t=6.3e-04 per=5.5e+01 cost=1.9e+05 flops=3.0e+08
 sigma[red] counter=38 t=3.8e-04 per=3.3e+01 cost=4.3e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=4.4e-03 t_gemm=2.3e-02 t_reduction=2.1e-02 tot=4.8e-02 -----
 sigma_tot[inter] counter=38 t=4.4e-03 per=9.1e+00 cost=1.1e+07 flops=2.4e+09
 sigma_tot[gemm] counter=38 i=0 t=8.7e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=7.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=7.5e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=3 t=7.4e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=4 t=5.6e-03 per=1.2e+01 cost=2.5e+06 flops=4.4e+08
 sigma_tot[gemm] counter=38 i=5 t=6.1e-03 per=1.3e+01 cost=2.5e+06 flops=4.0e+08
 sigma_tot[gemm] counter=38 i=6 t=5.5e-03 per=1.1e+01 cost=3.2e+06 flops=5.7e+08
 sigma_tot[gemm] counter=38 i=7 t=5.6e-03 per=1.2e+01 cost=3.1e+06 flops=5.5e+08
 sigma_tot[gemm] counter=38 total t=2.3e-02 per=4.8e+01 cost=1.1e+07 flops=4.8e+08
 sigma_tot[red] counter=38 t=2.1e-02 per=4.3e+01 cost=2.7e+06 flops=1.3e+08
T(sub)=8.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.4e-06,1.2e-06,1.2e-06,2.9e-07
settings: ndim=62 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.218052701478 -1.116e+03  6.554e-02    1     1  1.566e-03 1.566e-03 1.538e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.901e-05,1.527e-04,7.637e-04,4.242e-04,1.415e-03
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.235e-05 speed=4.134e-02GB/S T(nccl)=4.667e-05 speed=1.980e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=7.6e-04 t_reduction=4.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=39 t=1.5e-04 per=1.1e+01 cost=2.3e+05 flops=1.5e+09
 sigma[gemm] counter=39 i=0 t=2.7e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=4 t=1.9e-04 per=1.4e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=39 i=5 t=2.0e-04 per=1.5e+01 cost=3.6e+04 flops=1.8e+08
 sigma[gemm] counter=39 i=6 t=1.9e-04 per=1.4e+01 cost=5.8e+04 flops=3.1e+08
 sigma[gemm] counter=39 i=7 t=1.8e-04 per=1.4e+01 cost=5.8e+04 flops=3.2e+08
 sigma[gemm] counter=39 total t=7.6e-04 per=5.7e+01 cost=1.9e+05 flops=2.5e+08
 sigma[red] counter=39 t=4.2e-04 per=3.2e+01 cost=4.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=4.6e-03 t_gemm=2.4e-02 t_reduction=2.1e-02 tot=5.0e-02 -----
 sigma_tot[inter] counter=39 t=4.6e-03 per=9.2e+00 cost=1.1e+07 flops=2.4e+09
 sigma_tot[gemm] counter=39 i=0 t=8.9e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=7.7e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=7.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=3 t=7.6e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=4 t=5.8e-03 per=1.2e+01 cost=2.5e+06 flops=4.3e+08
 sigma_tot[gemm] counter=39 i=5 t=6.3e-03 per=1.3e+01 cost=2.5e+06 flops=4.0e+08
 sigma_tot[gemm] counter=39 i=6 t=5.7e-03 per=1.2e+01 cost=3.2e+06 flops=5.6e+08
 sigma_tot[gemm] counter=39 i=7 t=5.8e-03 per=1.2e+01 cost=3.2e+06 flops=5.5e+08
 sigma_tot[gemm] counter=39 total t=2.4e-02 per=4.8e+01 cost=1.1e+07 flops=4.8e+08
 sigma_tot[red] counter=39 t=2.1e-02 per=4.3e+01 cost=2.7e+06 flops=1.3e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.2e-05,3.3e-06,1.5e-06,2.8e-07
    2   0 -    -116.236358060038 -1.831e-02  2.245e-02    2     2  3.313e-03 1.656e-03 1.603e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.897e-05,1.477e-04,7.525e-04,4.172e-04,1.391e-03
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.275e-05 speed=4.062e-02GB/S T(nccl)=4.622e-05 speed=1.999e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=7.5e-04 t_reduction=4.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=40 t=1.5e-04 per=1.1e+01 cost=2.3e+05 flops=1.6e+09
 sigma[gemm] counter=40 i=0 t=2.7e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=4 t=1.8e-04 per=1.4e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=40 i=5 t=1.9e-04 per=1.4e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=40 i=6 t=1.8e-04 per=1.4e+01 cost=5.8e+04 flops=3.2e+08
 sigma[gemm] counter=40 i=7 t=1.9e-04 per=1.4e+01 cost=5.8e+04 flops=3.1e+08
 sigma[gemm] counter=40 total t=7.5e-04 per=5.7e+01 cost=1.9e+05 flops=2.5e+08
 sigma[red] counter=40 t=4.2e-04 per=3.2e+01 cost=4.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=4.7e-03 t_gemm=2.5e-02 t_reduction=2.2e-02 tot=5.1e-02 -----
 sigma_tot[inter] counter=40 t=4.7e-03 per=9.2e+00 cost=1.1e+07 flops=2.4e+09
 sigma_tot[gemm] counter=40 i=0 t=9.2e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=7.9e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=8.0e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=3 t=7.9e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=4 t=6.0e-03 per=1.2e+01 cost=2.5e+06 flops=4.2e+08
 sigma_tot[gemm] counter=40 i=5 t=6.5e-03 per=1.3e+01 cost=2.5e+06 flops=3.9e+08
 sigma_tot[gemm] counter=40 i=6 t=5.9e-03 per=1.2e+01 cost=3.3e+06 flops=5.6e+08
 sigma_tot[gemm] counter=40 i=7 t=6.0e-03 per=1.2e+01 cost=3.2e+06 flops=5.4e+08
 sigma_tot[gemm] counter=40 total t=2.5e-02 per=4.8e+01 cost=1.2e+07 flops=4.7e+08
 sigma_tot[red] counter=40 t=2.2e-02 per=4.3e+01 cost=2.8e+06 flops=1.3e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,2.1e-05,2.7e-06,1.5e-06,2.9e-07
    3   0 -    -116.237815456215 -1.457e-03  8.140e-03    3     3  5.006e-03 1.669e-03 1.611e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.003e-05,1.519e-04,7.590e-04,4.333e-04,1.419e-03
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.369e-05 speed=3.901e-02GB/S T(nccl)=4.635e-05 speed=1.993e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=7.6e-04 t_reduction=4.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=41 t=1.5e-04 per=1.1e+01 cost=2.3e+05 flops=1.5e+09
 sigma[gemm] counter=41 i=0 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=4 t=1.8e-04 per=1.4e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=41 i=5 t=1.9e-04 per=1.4e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=41 i=6 t=1.9e-04 per=1.4e+01 cost=5.8e+04 flops=3.0e+08
 sigma[gemm] counter=41 i=7 t=1.9e-04 per=1.4e+01 cost=5.8e+04 flops=3.1e+08
 sigma[gemm] counter=41 total t=7.6e-04 per=5.6e+01 cost=1.9e+05 flops=2.5e+08
 sigma[red] counter=41 t=4.3e-04 per=3.2e+01 cost=4.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=4.9e-03 t_gemm=2.5e-02 t_reduction=2.2e-02 tot=5.2e-02 -----
 sigma_tot[inter] counter=41 t=4.9e-03 per=9.3e+00 cost=1.1e+07 flops=2.3e+09
 sigma_tot[gemm] counter=41 i=0 t=9.4e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=8.2e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=8.2e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=3 t=8.1e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=4 t=6.2e-03 per=1.2e+01 cost=2.6e+06 flops=4.2e+08
 sigma_tot[gemm] counter=41 i=5 t=6.7e-03 per=1.3e+01 cost=2.6e+06 flops=3.9e+08
 sigma_tot[gemm] counter=41 i=6 t=6.1e-03 per=1.2e+01 cost=3.3e+06 flops=5.5e+08
 sigma_tot[gemm] counter=41 i=7 t=6.2e-03 per=1.2e+01 cost=3.3e+06 flops=5.3e+08
 sigma_tot[gemm] counter=41 total t=2.5e-02 per=4.8e+01 cost=1.2e+07 flops=4.6e+08
 sigma_tot[red] counter=41 t=2.2e-02 per=4.2e+01 cost=2.8e+06 flops=1.3e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,2.3e-06,1.3e-06,2.6e-07
    4   0 -    -116.238019717468 -2.043e-04  2.814e-03    3     4  6.726e-03 1.682e-03 1.624e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.471e-05,1.448e-04,7.509e-04,4.165e-04,1.391e-03
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.825e-05 speed=3.270e-02GB/S T(nccl)=4.646e-05 speed=1.989e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.5e-04 t_reduction=4.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=42 t=1.4e-04 per=1.1e+01 cost=2.3e+05 flops=1.6e+09
 sigma[gemm] counter=42 i=0 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=4 t=1.8e-04 per=1.4e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=42 i=5 t=2.0e-04 per=1.5e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=42 i=6 t=1.8e-04 per=1.4e+01 cost=5.8e+04 flops=3.2e+08
 sigma[gemm] counter=42 i=7 t=1.8e-04 per=1.4e+01 cost=5.8e+04 flops=3.2e+08
 sigma[gemm] counter=42 total t=7.5e-04 per=5.7e+01 cost=1.9e+05 flops=2.5e+08
 sigma[red] counter=42 t=4.2e-04 per=3.2e+01 cost=4.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=5.0e-03 t_gemm=2.6e-02 t_reduction=2.3e-02 tot=5.4e-02 -----
 sigma_tot[inter] counter=42 t=5.0e-03 per=9.3e+00 cost=1.2e+07 flops=2.3e+09
 sigma_tot[gemm] counter=42 i=0 t=9.6e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=8.4e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=8.4e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=3 t=8.3e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=4 t=6.3e-03 per=1.2e+01 cost=2.6e+06 flops=4.1e+08
 sigma_tot[gemm] counter=42 i=5 t=6.9e-03 per=1.3e+01 cost=2.6e+06 flops=3.8e+08
 sigma_tot[gemm] counter=42 i=6 t=6.3e-03 per=1.2e+01 cost=3.4e+06 flops=5.4e+08
 sigma_tot[gemm] counter=42 i=7 t=6.3e-03 per=1.2e+01 cost=3.3e+06 flops=5.3e+08
 sigma_tot[gemm] counter=42 total t=2.6e-02 per=4.9e+01 cost=1.2e+07 flops=4.6e+08
 sigma_tot[red] counter=42 t=2.3e-02 per=4.2e+01 cost=2.9e+06 flops=1.3e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,2.2e-06,1.3e-06,2.3e-07
    5   0 -    -116.238042505393 -2.279e-05  7.202e-04    3     5  8.422e-03 1.684e-03 1.627e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.830e-05,1.465e-04,7.746e-04,4.208e-04,1.414e-03
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.229e-05 speed=4.146e-02GB/S T(nccl)=4.601e-05 speed=2.008e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=7.7e-04 t_reduction=4.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=43 t=1.5e-04 per=1.1e+01 cost=2.3e+05 flops=1.6e+09
 sigma[gemm] counter=43 i=0 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=3 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=4 t=1.8e-04 per=1.4e+01 cost=3.6e+04 flops=2.0e+08
 sigma[gemm] counter=43 i=5 t=2.2e-04 per=1.6e+01 cost=3.6e+04 flops=1.7e+08
 sigma[gemm] counter=43 i=6 t=1.9e-04 per=1.4e+01 cost=5.8e+04 flops=3.1e+08
 sigma[gemm] counter=43 i=7 t=1.8e-04 per=1.3e+01 cost=5.8e+04 flops=3.3e+08
 sigma[gemm] counter=43 total t=7.7e-04 per=5.8e+01 cost=1.9e+05 flops=2.4e+08
 sigma[red] counter=43 t=4.2e-04 per=3.1e+01 cost=4.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=5.1e-03 t_gemm=2.7e-02 t_reduction=2.3e-02 tot=5.5e-02 -----
 sigma_tot[inter] counter=43 t=5.1e-03 per=9.3e+00 cost=1.2e+07 flops=2.3e+09
 sigma_tot[gemm] counter=43 i=0 t=9.9e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=8.6e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=8.7e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=3 t=8.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=4 t=6.5e-03 per=1.2e+01 cost=2.6e+06 flops=4.0e+08
 sigma_tot[gemm] counter=43 i=5 t=7.1e-03 per=1.3e+01 cost=2.7e+06 flops=3.7e+08
 sigma_tot[gemm] counter=43 i=6 t=6.5e-03 per=1.2e+01 cost=3.5e+06 flops=5.3e+08
 sigma_tot[gemm] counter=43 i=7 t=6.5e-03 per=1.2e+01 cost=3.4e+06 flops=5.2e+08
 sigma_tot[gemm] counter=43 total t=2.7e-02 per=4.9e+01 cost=1.2e+07 flops=4.5e+08
 sigma_tot[red] counter=43 t=2.3e-02 per=4.2e+01 cost=2.9e+06 flops=1.3e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,2.2e-06,1.3e-06,2.2e-07
    6   0 -    -116.238044081056 -1.576e-06  1.845e-04    3     6  1.012e-02 1.687e-03 1.629e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.627e-05,1.435e-04,7.107e-04,3.929e-04,1.318e-03
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.168e-05 speed=4.261e-02GB/S T(nccl)=4.459e-05 speed=2.072e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.1e-04 t_reduction=3.9e-04 tot=1.2e-03 -----
 sigma[inter] counter=44 t=1.4e-04 per=1.2e+01 cost=2.3e+05 flops=1.6e+09
 sigma[gemm] counter=44 i=0 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=4 t=1.8e-04 per=1.5e+01 cost=3.6e+04 flops=2.0e+08
 sigma[gemm] counter=44 i=5 t=1.9e-04 per=1.5e+01 cost=3.6e+04 flops=1.9e+08
 sigma[gemm] counter=44 i=6 t=1.7e-04 per=1.4e+01 cost=5.8e+04 flops=3.4e+08
 sigma[gemm] counter=44 i=7 t=1.6e-04 per=1.3e+01 cost=5.8e+04 flops=3.6e+08
 sigma[gemm] counter=44 total t=7.1e-04 per=5.7e+01 cost=1.9e+05 flops=2.7e+08
 sigma[red] counter=44 t=3.9e-04 per=3.2e+01 cost=4.3e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=5.3e-03 t_gemm=2.8e-02 t_reduction=2.3e-02 tot=5.6e-02 -----
 sigma_tot[inter] counter=44 t=5.3e-03 per=9.4e+00 cost=1.2e+07 flops=2.3e+09
 sigma_tot[gemm] counter=44 i=0 t=1.0e-04 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=8.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=8.9e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=3 t=8.7e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=4 t=6.7e-03 per=1.2e+01 cost=2.7e+06 flops=4.0e+08
 sigma_tot[gemm] counter=44 i=5 t=7.3e-03 per=1.3e+01 cost=2.7e+06 flops=3.7e+08
 sigma_tot[gemm] counter=44 i=6 t=6.6e-03 per=1.2e+01 cost=3.5e+06 flops=5.3e+08
 sigma_tot[gemm] counter=44 i=7 t=6.7e-03 per=1.2e+01 cost=3.5e+06 flops=5.2e+08
 sigma_tot[gemm] counter=44 total t=2.8e-02 per=4.9e+01 cost=1.2e+07 flops=4.5e+08
 sigma_tot[red] counter=44 t=2.3e-02 per=4.2e+01 cost=2.9e+06 flops=1.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.2e-05,2.0e-06,1.2e-06,1.5e-07
    7   0 +    -116.238044195480 -1.144e-07  5.542e-05    3     7  1.171e-02 1.673e-03 1.616e-03
TIMING FOR Davidson : 1.173e-02  T(cal/comm/rest)=1.131e-02,1.980e-06,4.226e-04
decomposed t_rest=4.226e-04
 T(sub)    =1.452e-04 per=3.437e+01
 T(precond)=2.087e-05 per=4.938e+00
 T(ortho)  =1.121e-05 per=2.653e+00
 T(xcopy)  =9.100e-07 per=2.153e-01
 T(xnrm2)  =1.457e-06 per=3.448e-01
 T(other)  =2.429e-04 per=5.748e+01
optimized energies: isweep=0 ibond=6 dots=2 e[0]=-116.238044195480 nmvp=7
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.366e-03 change=1.564e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=11 dimAll=37
 (10,2):6 (12,2):4 (11,1):8 (11,3):6 (10,0):4 (12,0):3 (9,3):1 (10,4):2 (12,4):1 (11,5):1 (9,1):1
timing for divide=1.1e-05
timing for compute=4.3e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(su2): 6.4e-05 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,3.4e-05,0.0e+00,8.9e-06,1.0e-05 -----
decimation summary: 37->10 dwt=+2.363e-04 SvN=1.336e+00
 qbond: qkept nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
----- TIMING for decimation_row(nkr): 1.036e-03 S T(decim/select/formRot)=1.130e-04,8.943e-04,2.876e-05 -----
----- TIMING FOR twodot_decimation: 1.153e-03 S T(wf/decim)=1.070e-04,1.046e-03 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:8 S:7 H:1 A:31 B:36 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1666:1.271e-02MB:1.241e-05GB
        per(mem): C:5.76 S:5.04 H:1.68 A:0 B:87.5 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.343e-03 change=1.636e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 9.400e-05 S -----
rank=0 GPUmem(GB): used=5.423e-05 (oper)=2.915e-05
rank=0 GPUmem(GB): used=5.452e-05 (oper,site)=2.915e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=76
 no. of rintermediate operators=5
 no. of coefficients=67:5.112e-04MB:4.992e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.700e-05 S -----
rank=0 GPUmem(GB): used=5.502e-05 (oper,site,rinter)=2.915e-05,2.980e-07,4.992e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 7.882e-04 S size(rtasks)=76 size(Rlst2)=25 T(Rmu/Rlist)=4.861e-05,7.395e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.217e-04 S size(rtasks)=76 size(Rlst)=622 -----
rank=0 GPUmem(GB): used=5.502e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.271e-04 blksize=16 blksize0=16 batchsize=622
rank=0 GPUmem(GB): used=2.821e-04 (oper,site,rinter,batch)=2.915e-05,2.980e-07,4.992e-07,2.271e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.146e-04,3.553e-04,1.675e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=3.5e-04 t_reduction=1.7e-04 tot=6.4e-04 -----
 renorm[inter] counter=100 t=1.1e-04 per=1.8e+01 cost=1.4e+04 flops=1.2e+08
 renorm[gemm] counter=100 i=0 t=2.2e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=1 t=2.0e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=2 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=3 t=2.0e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=4 t=1.1e-04 per=1.7e+01 cost=1.1e+03 flops=1.1e+07
 renorm[gemm] counter=100 i=5 t=1.3e-04 per=2.1e+01 cost=1.3e+04 flops=9.9e+07
 renorm[gemm] counter=100 i=6 t=1.1e-04 per=1.7e+01 cost=1.1e+04 flops=1.0e+08
 renorm[gemm] counter=100 total t=3.5e-04 per=5.6e+01 cost=2.5e+04 flops=7.2e+07
 renorm[red] counter=100 t=1.7e-04 per=2.6e+01 cost=3.5e+03 flops=2.1e+07
----- TIMING FOR renorm_tot : t_inter=6.0e-04 t_gemm=2.3e-03 t_reduction=9.9e-04 tot=3.9e-03 -----
 renorm_tot[inter] counter=100 t=6.0e-04 per=1.5e+01 cost=3.5e+04 flops=5.8e+07
 renorm_tot[gemm] counter=100 i=0 t=1.5e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=1 t=1.4e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=2 t=1.3e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=3 t=1.3e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=4 t=7.3e-04 per=1.9e+01 cost=6.7e+03 flops=9.2e+06
 renorm_tot[gemm] counter=100 i=5 t=7.7e-04 per=2.0e+01 cost=4.9e+04 flops=6.4e+07
 renorm_tot[gemm] counter=100 i=6 t=7.4e-04 per=1.9e+01 cost=5.9e+04 flops=8.0e+07
 renorm_tot[gemm] counter=100 total t=2.3e-03 per=5.9e+01 cost=1.2e+05 flops=5.0e+07
 renorm_tot[red] counter=100 t=9.9e-04 per=2.6e+01 cost=2.2e+04 flops=2.2e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.297e-05 (oper)=2.924e-05
rank=0 GPUmem(GB): used=6.327e-05 (oper,site,rinter)=2.924e-05,2.980e-07,8.158e-06
rank=0 GPUmem(GB): used=7.568e-05 (oper,site,rinter,batch)=2.924e-05,2.980e-07,8.158e-06,1.241e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.051e-03 S T(preprocess/alloc/comp/red/dealloc)=1.477e-03,1.540e-03,4.161e-03,2.377e-04,8.856e-05 -----
----- TIMING FOR oper_renorm_opS : 6.078e-03 S rank=0 -----
qops.to_cpu: size(tot)=1666:1.271e-02MB:1.241e-05GB T(to_cpu)=3.637e-05S speed=3.413e-01GB/S
check ||H-H.dagger||=6.920e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.00888 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.038e-03 change=1.928e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.038e-03 change=-1.473e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.038e-03 change=-3.830e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 4.179e-02 S #####
 T(local opt: fetch) = 2.711e-03 S  per = 6.49  per(accum) = 6.49
 T(local opt: hdiag) = 2.448e-03 S  per = 5.86  per(accum) = 12.3
 T(local opt: dvdsn) = 2.362e-02 S  per = 56.5  per(accum) = 68.9
 T(local opt: decim) = 1.186e-03 S  per = 2.84  per(accum) = 71.7
 T(local opt: guess) = 1.239e-04 S  per = 0.296  per(accum) = 72
 T(local opt: renrm) = 9.800e-03 S  per = 23.5  per(accum) = 95.5
 T(local opt: save ) = 1.897e-03 S  per = 4.54  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.362e-02 S  T(sum) = 2.304e-02 S  per = 9.754e+01
 T(local opt: preprocess                  ) = 4.475e-04 S  per = 1.94  per(accum) = 1.94
 T(local opt: symbolic_formulae           ) = 7.185e-04 S  per = 3.12  per(accum) = 5.06
 T(local opt: hintermediate init          ) = 6.146e-05 S  per = 0.267  per(accum) = 5.33
 T(local opt: preprocess_hformulae_Hxlist ) = 8.058e-03 S  per =   35  per(accum) = 40.3
 T(local opt: hmmtasks init               ) = 1.853e-03 S  per = 8.04  per(accum) = 48.3
 T(local opt: initial guess for dvdson    ) = 1.700e-04 S  per = 0.738  per(accum) = 49.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.082e-02 S  per = 46.9  per(accum) = 96
 T(local opt: dvdson [cpu-gpu]            ) = 1.648e-04 S  per = 0.715  per(accum) = 96.7
 T(local opt: dvdson [nccl]               ) = 3.268e-04 S  per = 1.42  per(accum) = 98.2
 T(local opt: dvdson [mpi]                ) = 1.980e-06 S  per = 0.00859  per(accum) = 98.2
 T(local opt: dvdson [rest part(linalg)]  ) = 4.226e-04 S  per = 1.83  per(accum) = 100
Detailed decomposition of T(renrm) = 9.800e-03 S  T(sum) = 9.800e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.188e-05 S  per = 0.631  per(accum) = 0.631
 T(local opt: qops init                    ) = 4.441e-04 S  per = 4.53  per(accum) = 5.16
 T(local opt: symbolic_formulae_renorm     ) = 1.054e-04 S  per = 1.08  per(accum) = 6.24
 T(local opt: allocate qops on gpu         ) = 6.063e-05 S  per = 0.619  per(accum) = 6.86
 T(local opt: site memcpy cpu2gpu          ) = 2.650e-05 S  per = 0.27  per(accum) = 7.13
 T(local opt: rintermediate init           ) = 5.675e-05 S  per = 0.579  per(accum) = 7.71
 T(local opt: preprocess_formulae_Rlist2   ) = 8.328e-04 S  per =  8.5  per(accum) = 16.2
 T(local opt: rmmtasks init                ) = 3.056e-04 S  per = 3.12  per(accum) = 19.3
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.000439  per(accum) = 19.3
 T(local opt: preprocess_renorm_batchGPU   ) = 8.239e-04 S  per = 8.41  per(accum) = 27.7
 T(local opt: deallocate cpu and gpu memory) = 2.908e-05 S  per = 0.297  per(accum) = 28
 T(local opt: construct opS [ifdists=true] ) = 6.122e-03 S  per = 62.5  per(accum) = 90.5
 T(local opt: reduction of opS & opH [nccl]) = 1.862e-05 S  per = 0.19  per(accum) = 90.7
 T(local opt: qops memcpy gpu2cpu          ) = 4.560e-05 S  per = 0.465  per(accum) = 91.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.277e-05 S  per = 0.13  per(accum) = 91.3
 T(local opt: qops_pool join and erase     ) = 8.520e-04 S  per = 8.69  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.400e-06 S  per = 0.0245  per(accum) = 100
ctns::rcanon_save_site idx=12 scratch=./scratch/sweep size=40:3e-07GB T(load)=0.00056S speed=0.00053GB/S
##### sweep opt: 2.827e-01 S #####
 T(sweep opt: fetch) = 2.059e-02 S  per = 7.28  per(accum) = 7.28
 T(sweep opt: hdiag) = 1.163e-02 S  per = 4.11  per(accum) = 11.4
 T(sweep opt: dvdsn) = 1.668e-01 S  per =   59  per(accum) = 70.4
 T(sweep opt: decim) = 7.718e-03 S  per = 2.73  per(accum) = 73.1
 T(sweep opt: guess) = 7.101e-04 S  per = 0.251  per(accum) = 73.4
 T(sweep opt: renrm) = 6.257e-02 S  per = 22.1  per(accum) = 95.5
 T(sweep opt: save ) = 1.271e-02 S  per =  4.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.668e-01 S  T(sum) = 1.639e-01 S  per = 9.829e+01
 T(sweep opt: preprocess                  ) = 2.647e-03 S  per = 1.61  per(accum) = 1.61
 T(sweep opt: symbolic_formulae           ) = 2.659e-03 S  per = 1.62  per(accum) = 3.24
 T(sweep opt: hintermediate init          ) = 3.890e-04 S  per = 0.237  per(accum) = 3.47
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.332e-02 S  per = 44.7  per(accum) = 48.2
 T(sweep opt: hmmtasks init               ) = 1.291e-02 S  per = 7.87  per(accum) = 56.1
 T(sweep opt: initial guess for dvdson    ) = 1.054e-03 S  per = 0.643  per(accum) = 56.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.495e-02 S  per = 39.6  per(accum) = 96.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 9.748e-04 S  per = 0.595  per(accum) = 96.9
 T(sweep opt: dvdson [nccl]               ) = 2.669e-03 S  per = 1.63  per(accum) = 98.6
 T(sweep opt: dvdson [mpi]                ) = 1.368e-05 S  per = 0.00834  per(accum) = 98.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.360e-03 S  per = 1.44  per(accum) = 100
Detailed decomposition of T(renrm) = 6.257e-02 S  T(sum) = 6.257e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.596e-04 S  per = 0.575  per(accum) = 0.575
 T(sweep opt: qops init                    ) = 2.113e-03 S  per = 3.38  per(accum) = 3.95
 T(sweep opt: symbolic_formulae_renorm     ) = 4.181e-04 S  per = 0.668  per(accum) = 4.62
 T(sweep opt: allocate qops on gpu         ) = 3.744e-04 S  per = 0.598  per(accum) = 5.22
 T(sweep opt: site memcpy cpu2gpu          ) = 1.676e-04 S  per = 0.268  per(accum) = 5.49
 T(sweep opt: rintermediate init           ) = 2.480e-04 S  per = 0.396  per(accum) = 5.88
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.140e-03 S  per = 5.02  per(accum) = 10.9
 T(sweep opt: rmmtasks init                ) = 1.227e-03 S  per = 1.96  per(accum) = 12.9
 T(sweep opt: qops memset on cpu           ) = 2.630e-07 S  per = 0.00042  per(accum) = 12.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.777e-03 S  per = 7.64  per(accum) = 20.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.815e-04 S  per = 0.29  per(accum) = 20.8
 T(sweep opt: construct opS [ifdists=true] ) = 4.364e-02 S  per = 69.7  per(accum) = 90.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.306e-04 S  per = 0.209  per(accum) = 90.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.402e-04 S  per = 0.384  per(accum) = 91.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.387e-05 S  per = 0.118  per(accum) = 91.2
 T(sweep opt: qops_pool join and erase     ) = 5.460e-03 S  per = 8.73  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.953e-05 S  per = 0.0312  per(accum) = 100
##### global opt: 2.827e-01 S #####
 T(global opt: fetch) = 2.059e-02 S  per = 7.28  per(accum) = 7.28
 T(global opt: hdiag) = 1.163e-02 S  per = 4.11  per(accum) = 11.4
 T(global opt: dvdsn) = 1.668e-01 S  per =   59  per(accum) = 70.4
 T(global opt: decim) = 7.718e-03 S  per = 2.73  per(accum) = 73.1
 T(global opt: guess) = 7.101e-04 S  per = 0.251  per(accum) = 73.4
 T(global opt: renrm) = 6.257e-02 S  per = 22.1  per(accum) = 95.5
 T(global opt: save ) = 1.271e-02 S  per =  4.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.668e-01 S  T(sum) = 1.639e-01 S  per = 9.829e+01
 T(global opt: preprocess                  ) = 2.647e-03 S  per = 1.61  per(accum) = 1.61
 T(global opt: symbolic_formulae           ) = 2.659e-03 S  per = 1.62  per(accum) = 3.24
 T(global opt: hintermediate init          ) = 3.890e-04 S  per = 0.237  per(accum) = 3.47
 T(global opt: preprocess_hformulae_Hxlist ) = 7.332e-02 S  per = 44.7  per(accum) = 48.2
 T(global opt: hmmtasks init               ) = 1.291e-02 S  per = 7.87  per(accum) = 56.1
 T(global opt: initial guess for dvdson    ) = 1.054e-03 S  per = 0.643  per(accum) = 56.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.495e-02 S  per = 39.6  per(accum) = 96.3
 T(global opt: dvdson [cpu-gpu]            ) = 9.748e-04 S  per = 0.595  per(accum) = 96.9
 T(global opt: dvdson [nccl]               ) = 2.669e-03 S  per = 1.63  per(accum) = 98.6
 T(global opt: dvdson [mpi]                ) = 1.368e-05 S  per = 0.00834  per(accum) = 98.6
 T(global opt: dvdson [rest part(linalg)]  ) = 2.360e-03 S  per = 1.44  per(accum) = 100
Detailed decomposition of T(renrm) = 6.257e-02 S  T(sum) = 6.257e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.596e-04 S  per = 0.575  per(accum) = 0.575
 T(global opt: qops init                    ) = 2.113e-03 S  per = 3.38  per(accum) = 3.95
 T(global opt: symbolic_formulae_renorm     ) = 4.181e-04 S  per = 0.668  per(accum) = 4.62
 T(global opt: allocate qops on gpu         ) = 3.744e-04 S  per = 0.598  per(accum) = 5.22
 T(global opt: site memcpy cpu2gpu          ) = 1.676e-04 S  per = 0.268  per(accum) = 5.49
 T(global opt: rintermediate init           ) = 2.480e-04 S  per = 0.396  per(accum) = 5.88
 T(global opt: preprocess_formulae_Rlist2   ) = 3.140e-03 S  per = 5.02  per(accum) = 10.9
 T(global opt: rmmtasks init                ) = 1.227e-03 S  per = 1.96  per(accum) = 12.9
 T(global opt: qops memset on cpu           ) = 2.630e-07 S  per = 0.00042  per(accum) = 12.9
 T(global opt: preprocess_renorm_batchGPU   ) = 4.777e-03 S  per = 7.64  per(accum) = 20.5
 T(global opt: deallocate cpu and gpu memory) = 1.815e-04 S  per = 0.29  per(accum) = 20.8
 T(global opt: construct opS [ifdists=true] ) = 4.364e-02 S  per = 69.7  per(accum) = 90.5
 T(global opt: reduction of opS & opH [nccl]) = 1.306e-04 S  per = 0.209  per(accum) = 90.7
 T(global opt: qops memcpy gpu2cpu          ) = 2.402e-04 S  per = 0.384  per(accum) = 91.1
 T(global opt: reduction of opS & opH [mpi] ) = 7.387e-05 S  per = 0.118  per(accum) = 91.2
 T(global opt: qops_pool join and erase     ) = 5.460e-03 S  per = 8.73  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.953e-05 S  per = 0.0312  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.573e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=7/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=10 scratch=./scratch/sweep size=152:1.13e-06GB T(load)=3.29e-04S speed=3.44e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=249:1.90e-03MB:1.86e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=49:3.74e-04MB:3.65e-07GB
total mem of comb=299:2.28e-03MB:2.23e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.140e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:7 H:1 A:31 B:36 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1666:1.271e-02MB:1.241e-05GB
        per(mem): C:5.76 S:5.04 H:1.68 A:0 B:87.5 
 rqops: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=7034:0.0537MB:5.24e-05GB
        per(mem): C:2.84 S:1.42 H:0.995 P:0 Q:94.7 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=10696:0.0816MB:7.97e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.094e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-5.299e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,16,3,3) nnz=168:1.282e-03MB
qtensor4: wf4 own=1 _data=0x5585f6bfe100
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
 qbond: qcol nsym=5 dimAll=16
 (15,1):4 (15,3):6 (15,5):4 (16,2):1 (16,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=380 size=168:1.282e-03MB
### DIAG TIMING: total=5.788e-03 t1=1.629e-05, t2=1.844e-05, t3=1.715e-05, t4=5.676e-03, t5=8.988e-06, t6=4.270e-05, t7=8.401e-06
duration_diagGPU:5.810e-03
duration_diagreduce:8.400e-08
duration_diagtransform:3.690e-07
----- TIMING FOR symbolic_formulae_twodot with size=452 : 1.036e-03 S -----
rank=0 GPUmem(GB): used=7.969e-05 (oper)=7.969e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=452
 no. of hintermediate operators=227
 no. of coefficients=2776:2.118e-02MB:2.068e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.400e-04 S -----
rank=0 GPUmem(GB): used=1.004e-04 (oper,hinter)=7.969e-05,2.068e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.177e-02 S size(H_formulae)=452 size(Hxlst2)=29 T(Hmu/Hxlist)=2.768e-04,3.150e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.290e-02 S size(H_formulae)=452 size(Hxlst)=16180 -----
rank=0 GPUmem(GB): used=1.004e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.503e-06 batch[need]=7.836e-03 blksize=24 blksize0=16 batchsize=16180
rank=0 GPUmem(GB): used=7.939e-03 (oper,hinter,dvdson,batch)=7.969e-05,2.068e-05,2.503e-06,7.836e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=168 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.210e-05,1.992e-04,8.566e-04,1.030e-03,2.178e-03
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.605e-05 speed=9.611e-02GB/S T(nccl)=5.606e-05 speed=4.466e-02GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=8.6e-04 t_reduction=1.0e-03 tot=2.1e-03 -----
 sigma[inter] counter=45 t=2.0e-04 per=9.6e+00 cost=1.0e+06 flops=5.1e+09
 sigma[gemm] counter=45 i=0 t=2.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=2.0e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=3 t=2.0e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=4 t=2.2e-04 per=1.1e+01 cost=2.2e+05 flops=9.7e+08
 sigma[gemm] counter=45 i=5 t=2.1e-04 per=1.0e+01 cost=2.2e+05 flops=1.0e+09
 sigma[gemm] counter=45 i=6 t=2.0e-04 per=9.8e+00 cost=2.5e+05 flops=1.2e+09
 sigma[gemm] counter=45 i=7 t=2.1e-04 per=9.9e+00 cost=2.5e+05 flops=1.2e+09
 sigma[gemm] counter=45 total t=8.6e-04 per=4.1e+01 cost=9.4e+05 flops=1.1e+09
 sigma[red] counter=45 t=1.0e-03 per=4.9e+01 cost=2.0e+05 flops=2.0e+08
----- TIMING FOR sigma_tot : t_inter=5.5e-03 t_gemm=2.9e-02 t_reduction=2.4e-02 tot=5.8e-02 -----
 sigma_tot[inter] counter=45 t=5.5e-03 per=9.4e+00 cost=1.3e+07 flops=2.4e+09
 sigma_tot[gemm] counter=45 i=0 t=1.0e-04 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=9.0e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=9.1e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=3 t=8.9e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=4 t=6.9e-03 per=1.2e+01 cost=2.9e+06 flops=4.2e+08
 sigma_tot[gemm] counter=45 i=5 t=7.5e-03 per=1.3e+01 cost=2.9e+06 flops=3.9e+08
 sigma_tot[gemm] counter=45 i=6 t=6.8e-03 per=1.2e+01 cost=3.8e+06 flops=5.5e+08
 sigma_tot[gemm] counter=45 i=7 t=6.9e-03 per=1.2e+01 cost=3.7e+06 flops=5.4e+08
 sigma_tot[gemm] counter=45 total t=2.9e-02 per=4.9e+01 cost=1.3e+07 flops=4.7e+08
 sigma_tot[red] counter=45 t=2.4e-02 per=4.2e+01 cost=3.1e+06 flops=1.3e+08
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,3.8e-06,1.1e-06,1.8e-06,2.6e-07
settings: ndim=168 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.237931699330 -1.116e+03  5.705e-02    1     1  2.522e-03 2.522e-03 2.491e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.046e-05,1.895e-04,9.815e-04,1.082e-03,2.328e-03
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.446e-05 speed=1.023e-01GB/S T(nccl)=4.600e-05 speed=5.442e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.8e-04 t_reduction=1.1e-03 tot=2.3e-03 -----
 sigma[inter] counter=46 t=1.9e-04 per=8.4e+00 cost=1.0e+06 flops=5.4e+09
 sigma[gemm] counter=46 i=0 t=2.0e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=1.9e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=3 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=4 t=2.3e-04 per=1.0e+01 cost=2.2e+05 flops=9.4e+08
 sigma[gemm] counter=46 i=5 t=2.6e-04 per=1.2e+01 cost=2.2e+05 flops=8.3e+08
 sigma[gemm] counter=46 i=6 t=2.4e-04 per=1.1e+01 cost=2.5e+05 flops=1.0e+09
 sigma[gemm] counter=46 i=7 t=2.4e-04 per=1.1e+01 cost=2.5e+05 flops=1.1e+09
 sigma[gemm] counter=46 total t=9.8e-04 per=4.4e+01 cost=9.4e+05 flops=9.6e+08
 sigma[red] counter=46 t=1.1e-03 per=4.8e+01 cost=2.0e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=5.7e-03 t_gemm=3.0e-02 t_reduction=2.6e-02 tot=6.1e-02 -----
 sigma_tot[inter] counter=46 t=5.7e-03 per=9.4e+00 cost=1.4e+07 flops=2.5e+09
 sigma_tot[gemm] counter=46 i=0 t=1.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=9.2e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=9.3e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=3 t=9.1e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=4 t=7.2e-03 per=1.2e+01 cost=3.1e+06 flops=4.3e+08
 sigma_tot[gemm] counter=46 i=5 t=7.8e-03 per=1.3e+01 cost=3.1e+06 flops=4.0e+08
 sigma_tot[gemm] counter=46 i=6 t=7.1e-03 per=1.2e+01 cost=4.0e+06 flops=5.7e+08
 sigma_tot[gemm] counter=46 i=7 t=7.1e-03 per=1.2e+01 cost=4.0e+06 flops=5.6e+08
 sigma_tot[gemm] counter=46 total t=3.0e-02 per=4.9e+01 cost=1.4e+07 flops=4.8e+08
 sigma_tot[red] counter=46 t=2.6e-02 per=4.2e+01 cost=3.3e+06 flops=1.3e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,1.6e-05,2.8e-06,1.6e-06,2.4e-07
    2   0 -    -116.247601693789 -9.670e-03  2.179e-02    2     2  5.208e-03 2.604e-03 2.544e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.629e-05,1.811e-04,9.667e-04,1.083e-03,2.301e-03
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.155e-05 speed=1.162e-01GB/S T(nccl)=4.474e-05 speed=5.596e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=9.7e-04 t_reduction=1.1e-03 tot=2.2e-03 -----
 sigma[inter] counter=47 t=1.8e-04 per=8.1e+00 cost=1.0e+06 flops=5.7e+09
 sigma[gemm] counter=47 i=0 t=2.0e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=1.9e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=3 t=2.0e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=4 t=2.3e-04 per=1.0e+01 cost=2.2e+05 flops=9.6e+08
 sigma[gemm] counter=47 i=5 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.7e+08
 sigma[gemm] counter=47 i=6 t=2.3e-04 per=1.0e+01 cost=2.5e+05 flops=1.1e+09
 sigma[gemm] counter=47 i=7 t=2.5e-04 per=1.1e+01 cost=2.5e+05 flops=1.0e+09
 sigma[gemm] counter=47 total t=9.7e-04 per=4.3e+01 cost=9.4e+05 flops=9.7e+08
 sigma[red] counter=47 t=1.1e-03 per=4.9e+01 cost=2.0e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=5.9e-03 t_gemm=3.0e-02 t_reduction=2.7e-02 tot=6.3e-02 -----
 sigma_tot[inter] counter=47 t=5.9e-03 per=9.3e+00 cost=1.5e+07 flops=2.6e+09
 sigma_tot[gemm] counter=47 i=0 t=1.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=9.4e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=9.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=3 t=9.3e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=4 t=7.4e-03 per=1.2e+01 cost=3.3e+06 flops=4.5e+08
 sigma_tot[gemm] counter=47 i=5 t=8.0e-03 per=1.3e+01 cost=3.3e+06 flops=4.2e+08
 sigma_tot[gemm] counter=47 i=6 t=7.3e-03 per=1.2e+01 cost=4.3e+06 flops=5.8e+08
 sigma_tot[gemm] counter=47 i=7 t=7.4e-03 per=1.2e+01 cost=4.2e+06 flops=5.7e+08
 sigma_tot[gemm] counter=47 total t=3.0e-02 per=4.8e+01 cost=1.5e+07 flops=5.0e+08
 sigma_tot[red] counter=47 t=2.7e-02 per=4.2e+01 cost=3.6e+06 flops=1.3e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,1.6e-05,2.0e-06,3.3e-06,2.3e-07
    3   0 -    -116.248767971210 -1.166e-03  8.644e-03    3     3  7.779e-03 2.593e-03 2.533e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.577e-05,1.605e-04,9.863e-04,1.096e-03,2.313e-03
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.183e-05 speed=1.147e-01GB/S T(nccl)=4.394e-05 speed=5.698e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=9.9e-04 t_reduction=1.1e-03 tot=2.2e-03 -----
 sigma[inter] counter=48 t=1.6e-04 per=7.2e+00 cost=1.0e+06 flops=6.4e+09
 sigma[gemm] counter=48 i=0 t=2.0e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=3 t=1.9e-06 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=4 t=2.4e-04 per=1.1e+01 cost=2.2e+05 flops=9.1e+08
 sigma[gemm] counter=48 i=5 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.6e+08
 sigma[gemm] counter=48 i=6 t=2.3e-04 per=1.0e+01 cost=2.5e+05 flops=1.1e+09
 sigma[gemm] counter=48 i=7 t=2.6e-04 per=1.1e+01 cost=2.5e+05 flops=9.8e+08
 sigma[gemm] counter=48 total t=9.9e-04 per=4.4e+01 cost=9.4e+05 flops=9.5e+08
 sigma[red] counter=48 t=1.1e-03 per=4.9e+01 cost=2.0e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=6.0e-03 t_gemm=3.1e-02 t_reduction=2.8e-02 tot=6.5e-02 -----
 sigma_tot[inter] counter=48 t=6.0e-03 per=9.2e+00 cost=1.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=48 i=0 t=1.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=9.6e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=9.7e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=3 t=9.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=4 t=7.6e-03 per=1.2e+01 cost=3.5e+06 flops=4.6e+08
 sigma_tot[gemm] counter=48 i=5 t=8.3e-03 per=1.3e+01 cost=3.6e+06 flops=4.3e+08
 sigma_tot[gemm] counter=48 i=6 t=7.5e-03 per=1.2e+01 cost=4.5e+06 flops=6.0e+08
 sigma_tot[gemm] counter=48 i=7 t=7.6e-03 per=1.2e+01 cost=4.5e+06 flops=5.9e+08
 sigma_tot[gemm] counter=48 total t=3.1e-02 per=4.8e+01 cost=1.6e+07 flops=5.1e+08
 sigma_tot[red] counter=48 t=2.8e-02 per=4.2e+01 cost=3.8e+06 flops=1.4e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.2e-05,2.1e-06,1.5e-06,2.0e-07
    4   0 -    -116.248968824981 -2.009e-04  3.032e-03    3     4  1.034e-02 2.586e-03 2.528e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.610e-05,1.574e-04,9.637e-04,1.075e-03,2.266e-03
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.117e-05 speed=1.183e-01GB/S T(nccl)=4.494e-05 speed=5.571e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=9.6e-04 t_reduction=1.1e-03 tot=2.2e-03 -----
 sigma[inter] counter=49 t=1.6e-04 per=7.2e+00 cost=1.0e+06 flops=6.5e+09
 sigma[gemm] counter=49 i=0 t=2.0e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=1.9e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=3 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=4 t=2.4e-04 per=1.1e+01 cost=2.2e+05 flops=9.1e+08
 sigma[gemm] counter=49 i=5 t=2.4e-04 per=1.1e+01 cost=2.2e+05 flops=8.9e+08
 sigma[gemm] counter=49 i=6 t=2.3e-04 per=1.1e+01 cost=2.5e+05 flops=1.1e+09
 sigma[gemm] counter=49 i=7 t=2.4e-04 per=1.1e+01 cost=2.5e+05 flops=1.0e+09
 sigma[gemm] counter=49 total t=9.6e-04 per=4.4e+01 cost=9.4e+05 flops=9.7e+08
 sigma[red] counter=49 t=1.1e-03 per=4.9e+01 cost=2.0e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=6.2e-03 t_gemm=3.2e-02 t_reduction=2.9e-02 tot=6.7e-02 -----
 sigma_tot[inter] counter=49 t=6.2e-03 per=9.2e+00 cost=1.7e+07 flops=2.8e+09
 sigma_tot[gemm] counter=49 i=0 t=1.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=9.8e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=9.9e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=3 t=9.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=4 t=7.9e-03 per=1.2e+01 cost=3.8e+06 flops=4.8e+08
 sigma_tot[gemm] counter=49 i=5 t=8.5e-03 per=1.3e+01 cost=3.8e+06 flops=4.4e+08
 sigma_tot[gemm] counter=49 i=6 t=7.8e-03 per=1.2e+01 cost=4.8e+06 flops=6.1e+08
 sigma_tot[gemm] counter=49 i=7 t=7.9e-03 per=1.2e+01 cost=4.7e+06 flops=6.0e+08
 sigma_tot[gemm] counter=49 total t=3.2e-02 per=4.8e+01 cost=1.7e+07 flops=5.2e+08
 sigma_tot[red] counter=49 t=2.9e-02 per=4.3e+01 cost=4.0e+06 flops=1.4e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.2e-05,2.0e-06,1.7e-06,2.2e-07
    5   0 -    -116.248992623280 -2.380e-05  9.245e-04    3     5  1.284e-02 2.569e-03 2.513e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.659e-05,1.648e-04,9.661e-04,1.071e-03,2.272e-03
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.201e-05 speed=1.137e-01GB/S T(nccl)=4.458e-05 speed=5.616e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=9.7e-04 t_reduction=1.1e-03 tot=2.2e-03 -----
 sigma[inter] counter=50 t=1.6e-04 per=7.5e+00 cost=1.0e+06 flops=6.2e+09
 sigma[gemm] counter=50 i=0 t=2.1e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=2.0e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=2.0e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=3 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=4 t=2.4e-04 per=1.1e+01 cost=2.2e+05 flops=9.0e+08
 sigma[gemm] counter=50 i=5 t=2.4e-04 per=1.1e+01 cost=2.2e+05 flops=9.0e+08
 sigma[gemm] counter=50 i=6 t=2.3e-04 per=1.0e+01 cost=2.5e+05 flops=1.1e+09
 sigma[gemm] counter=50 i=7 t=2.4e-04 per=1.1e+01 cost=2.5e+05 flops=1.0e+09
 sigma[gemm] counter=50 total t=9.7e-04 per=4.4e+01 cost=9.4e+05 flops=9.7e+08
 sigma[red] counter=50 t=1.1e-03 per=4.9e+01 cost=2.0e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=6.3e-03 t_gemm=3.3e-02 t_reduction=3.0e-02 tot=7.0e-02 -----
 sigma_tot[inter] counter=50 t=6.3e-03 per=9.1e+00 cost=1.8e+07 flops=2.9e+09
 sigma_tot[gemm] counter=50 i=0 t=1.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=3 t=9.9e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=4 t=8.1e-03 per=1.2e+01 cost=4.0e+06 flops=4.9e+08
 sigma_tot[gemm] counter=50 i=5 t=8.7e-03 per=1.3e+01 cost=4.0e+06 flops=4.6e+08
 sigma_tot[gemm] counter=50 i=6 t=8.0e-03 per=1.2e+01 cost=5.0e+06 flops=6.3e+08
 sigma_tot[gemm] counter=50 i=7 t=8.1e-03 per=1.2e+01 cost=5.0e+06 flops=6.1e+08
 sigma_tot[gemm] counter=50 total t=3.3e-02 per=4.8e+01 cost=1.8e+07 flops=5.4e+08
 sigma_tot[red] counter=50 t=3.0e-02 per=4.3e+01 cost=4.2e+06 flops=1.4e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.2e-05,2.1e-06,1.7e-06,2.4e-07
    6   0 -    -116.248994383554 -1.760e-06  1.963e-04    3     6  1.537e-02 2.562e-03 2.507e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.505e-05,1.738e-04,9.728e-04,1.077e-03,2.293e-03
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.130e-05 speed=1.175e-01GB/S T(nccl)=4.375e-05 speed=5.722e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=9.7e-04 t_reduction=1.1e-03 tot=2.2e-03 -----
 sigma[inter] counter=51 t=1.7e-04 per=7.8e+00 cost=1.0e+06 flops=5.9e+09
 sigma[gemm] counter=51 i=0 t=2.0e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=2.0e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=2.0e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=3 t=1.9e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=4 t=2.3e-04 per=1.1e+01 cost=2.2e+05 flops=9.3e+08
 sigma[gemm] counter=51 i=5 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.7e+08
 sigma[gemm] counter=51 i=6 t=2.5e-04 per=1.1e+01 cost=2.5e+05 flops=1.0e+09
 sigma[gemm] counter=51 i=7 t=2.3e-04 per=1.1e+01 cost=2.5e+05 flops=1.1e+09
 sigma[gemm] counter=51 total t=9.7e-04 per=4.4e+01 cost=9.4e+05 flops=9.6e+08
 sigma[red] counter=51 t=1.1e-03 per=4.8e+01 cost=2.0e+05 flops=1.9e+08
----- TIMING FOR sigma_tot : t_inter=6.5e-03 t_gemm=3.4e-02 t_reduction=3.1e-02 tot=7.2e-02 -----
 sigma_tot[inter] counter=51 t=6.5e-03 per=9.1e+00 cost=1.9e+07 flops=3.0e+09
 sigma_tot[gemm] counter=51 i=0 t=1.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=3 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=4 t=8.3e-03 per=1.2e+01 cost=4.2e+06 flops=5.0e+08
 sigma_tot[gemm] counter=51 i=5 t=9.0e-03 per=1.3e+01 cost=4.2e+06 flops=4.7e+08
 sigma_tot[gemm] counter=51 i=6 t=8.3e-03 per=1.1e+01 cost=5.3e+06 flops=6.4e+08
 sigma_tot[gemm] counter=51 i=7 t=8.4e-03 per=1.2e+01 cost=5.2e+06 flops=6.3e+08
 sigma_tot[gemm] counter=51 total t=3.4e-02 per=4.8e+01 cost=1.9e+07 flops=5.5e+08
 sigma_tot[red] counter=51 t=3.1e-02 per=4.3e+01 cost=4.4e+06 flops=1.4e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.2e-05,1.8e-06,1.5e-06,2.2e-07
    7   0 +    -116.248994471347 -8.779e-08  5.467e-05    3     7  1.791e-02 2.558e-03 2.505e-03
TIMING FOR Davidson : 1.792e-02  T(cal/comm/rest)=1.753e-02,2.499e-06,3.861e-04
decomposed t_rest=3.861e-04
 T(sub)    =1.472e-04 per=3.812e+01
 T(precond)=2.013e-05 per=5.215e+00
 T(ortho)  =1.077e-05 per=2.789e+00
 T(xcopy)  =8.230e-07 per=2.131e-01
 T(xnrm2)  =1.437e-06 per=3.722e-01
 T(other)  =2.058e-04 per=5.329e+01
optimized energies: isweep=0 ibond=7 dots=2 e[0]=-116.248994471347 nmvp=7
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=6.790e-03 change=4.104e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=11 dimAll=37
 (12,2):6 (14,2):4 (13,1):8 (13,3):6 (12,0):4 (14,0):3 (11,1):1 (11,3):1 (12,4):2 (14,4):1 (13,5):1
timing for divide=1.1e-05
timing for compute=9.8e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,8.9e-05,0.0e+00,9.4e-06,1.2e-05 -----
decimation summary: 37->10 dwt=+5.960e-04 SvN=1.233e+00
 qbond: qkept nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
----- TIMING for decimation_row(nkr): 1.108e-03 S T(decim/select/formRot)=1.672e-04,9.196e-04,2.108e-05 -----
----- TIMING FOR twodot_decimation: 1.210e-03 S T(wf/decim)=8.903e-05,1.121e-03 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:9 S:6 H:1 A:40 B:46 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2071:1.580e-02MB:1.543e-05GB
        per(mem): C:5.21 S:3.48 H:1.35 A:0 B:90 
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=6.767e-03 change=1.985e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=96 : 1.012e-04 S -----
rank=0 GPUmem(GB): used=6.340e-05 (oper)=3.528e-05
rank=0 GPUmem(GB): used=6.370e-05 (oper,site)=3.528e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=96
 no. of rintermediate operators=5
 no. of coefficients=89:6.790e-04MB:6.631e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.558e-05 S -----
rank=0 GPUmem(GB): used=6.436e-05 (oper,site,rinter)=3.528e-05,2.980e-07,6.631e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 9.138e-04 S size(rtasks)=96 size(Rlst2)=25 T(Rmu/Rlist)=6.322e-05,8.506e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.642e-04 S size(rtasks)=96 size(Rlst)=799 -----
rank=0 GPUmem(GB): used=6.436e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.917e-04 blksize=16 blksize0=16 batchsize=799
rank=0 GPUmem(GB): used=3.561e-04 (oper,site,rinter,batch)=3.528e-05,2.980e-07,6.631e-07,2.917e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.106e-04,3.697e-04,1.471e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=3.7e-04 t_reduction=1.5e-04 tot=6.3e-04 -----
 renorm[inter] counter=113 t=1.1e-04 per=1.8e+01 cost=1.9e+04 flops=1.8e+08
 renorm[gemm] counter=113 i=0 t=2.1e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=1 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=2 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=4 t=1.1e-04 per=1.8e+01 cost=1.2e+03 flops=1.0e+07
 renorm[gemm] counter=113 i=5 t=1.5e-04 per=2.3e+01 cost=1.7e+04 flops=1.2e+08
 renorm[gemm] counter=113 i=6 t=1.0e-04 per=1.7e+01 cost=1.5e+04 flops=1.4e+08
 renorm[gemm] counter=113 total t=3.7e-04 per=5.9e+01 cost=3.3e+04 flops=9.0e+07
 renorm[red] counter=113 t=1.5e-04 per=2.3e+01 cost=4.5e+03 flops=3.1e+07
----- TIMING FOR renorm_tot : t_inter=7.1e-04 t_gemm=2.7e-03 t_reduction=1.1e-03 tot=4.5e-03 -----
 renorm_tot[inter] counter=113 t=7.1e-04 per=1.6e+01 cost=5.4e+04 flops=7.6e+07
 renorm_tot[gemm] counter=113 i=0 t=1.7e-05 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=1 t=1.5e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=2 t=1.5e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=3 t=1.5e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=4 t=8.4e-04 per=1.9e+01 cost=7.8e+03 flops=9.3e+06
 renorm_tot[gemm] counter=113 i=5 t=9.2e-04 per=2.0e+01 cost=6.7e+04 flops=7.3e+07
 renorm_tot[gemm] counter=113 i=6 t=8.5e-04 per=1.9e+01 cost=7.4e+04 flops=8.8e+07
 renorm_tot[gemm] counter=113 total t=2.7e-03 per=5.9e+01 cost=1.5e+05 flops=5.6e+07
 renorm_tot[red] counter=113 t=1.1e-03 per=2.5e+01 cost=2.7e+04 flops=2.3e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.366e-05 (oper)=3.537e-05
rank=0 GPUmem(GB): used=7.396e-05 (oper,site,rinter)=3.537e-05,2.980e-07,9.514e-06
rank=0 GPUmem(GB): used=8.637e-05 (oper,site,rinter,batch)=3.537e-05,2.980e-07,9.514e-06,1.241e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.244e-03 S T(preprocess/alloc/comp/red/dealloc)=1.227e-03,1.282e-03,3.639e-03,2.167e-04,8.564e-05 -----
----- TIMING FOR oper_renorm_opS : 5.273e-03 S rank=0 -----
----- TIMING FOR oper_renorm : 8.160e-03 S rank=0 -----
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=6.279e-03 change=2.231e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=7.904e-03 change=-1.445e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::oper_ab2pq coord=(8,0) superblock=lc alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=CSHPQ nops=C:9 S:6 H:1 P:59 Q:66 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2881:2.198e-02MB:2.147e-05GB
        per(mem): C:3.75 S:2.5 H:0.972 P:0 Q:92.8 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=7.904e-03 change=2.841e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=7.904e-03 change=9.388e-07 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=6.501e-05 avail=3.829e+01 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1ctns::oper_b2q ifab=0 ifkr=1 maxsize=1863:1.388e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:46 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1863:1.421e-02MB:1.388e-05GB
        per(mem): B:100 
   init qops_tmp: dt=7.49e-05 tinit=7.49e-05
   copy opB to qops_tmps: dt=3.89e-06 tcopy=3.89e-06
   bcast: size(opB)=1863:1.39e-05GB dt=2.55e-05 speed=0.545GB/s tcomm=2.55e-05
   compute opQ from opB: dt=0.000136 tcomp=0.000136
iproc=0
 qops_tmp: oplist=N nops=N:46 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=1863:0.0142MB:1.39e-05GB
        per(mem): N:100 
   init qops_tmp: dt=5.23e-05 tinit=0.000127
   from opB to opB.H(): dt=0.000128 tadjt=0.000128
   bcast: size(opN)=1863:1.39e-05GB dt=2.31e-05 speed=0.6GB/s tcomm=4.86e-05
   compute opQ from opB.H(): dt=0.000102 tcomp=0.000237
iproc=1
 qops_tmp: oplist=B nops=B:44 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=1782:0.0136MB:1.33e-05GB
        per(mem): B:100 
   init qops_tmp: dt=4.54e-05 tinit=0.000158
   copy opB to qops_tmps: dt=4.21e-06 tcopy=4.24e-06
   bcast: size(opB)=1782:1.33e-05GB dt=1.98e-05 speed=0.671GB/s tcomm=0.000335
   compute opQ from opB: dt=8.46e-05 tcomp=0.000303
iproc=1
 qops_tmp: oplist=N nops=N:44 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=1782:0.0136MB:1.33e-05GB
        per(mem): N:100 
   init qops_tmp: dt=4.54e-05 tinit=0.000203
   from opB to opB.H(): dt=0.000122 tadjt=0.000122
   bcast: size(opN)=1782:1.33e-05GB dt=1.98e-05 speed=0.671GB/s tcomm=0.000355
   compute opQ from opB.H(): dt=8.22e-05 tcomp=0.000386
----- TIMING FOR oper_b2qGPU : 0.00124 S T(init/copy/adjt+bcast/comp/rest)=0.00022,3.92e-06,0.000423,0.000404,0.000193 -----
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=7.904e-03 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=6.501e-05 avail=3.829e+01 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=7.881e-03 change=2.289e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=6.501e-05 avail=3.829e+01 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=7.881e-03 change=-5.960e-08 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 before move
rank=0 GPUmem(GB): used=6.501e-05 avail=3.829e+01 before move
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=7.881e-03 change=-2.081e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after move
rank=0 GPUmem(GB): used=4.958e-05 avail=3.829e+01 after move
----- TIMING FOR oper_ab2pq : 2.596e-03 S T(init/copyCSH/opP/opQ/to_gpu/to_cpu/move)=6.099e-04,1.406e-05,7.757e-06,1.255e-03,0.000e+00,3.820e-04,3.278e-04 -----
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=7.881e-03 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=7.881e-03 change=-3.830e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 8.281e-02 S #####
 T(local opt: fetch) = 2.559e-03 S  per = 3.09  per(accum) = 3.09
 T(local opt: hdiag) = 5.876e-03 S  per =  7.1  per(accum) = 10.2
 T(local opt: dvdsn) = 5.931e-02 S  per = 71.6  per(accum) = 81.8
 T(local opt: decim) = 1.242e-03 S  per =  1.5  per(accum) = 83.3
 T(local opt: guess) = 1.000e-04 S  per = 0.121  per(accum) = 83.4
 T(local opt: renrm) = 1.185e-02 S  per = 14.3  per(accum) = 97.7
 T(local opt: save ) = 1.872e-03 S  per = 2.26  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.931e-02 S  T(sum) = 5.861e-02 S  per = 9.882e+01
 T(local opt: preprocess                  ) = 4.538e-04 S  per = 0.774  per(accum) = 0.774
 T(local opt: symbolic_formulae           ) = 1.055e-03 S  per =  1.8  per(accum) = 2.57
 T(local opt: hintermediate init          ) = 1.891e-04 S  per = 0.323  per(accum) = 2.9
 T(local opt: preprocess_hformulae_Hxlist ) = 3.306e-02 S  per = 56.4  per(accum) = 59.3
 T(local opt: hmmtasks init               ) = 5.756e-03 S  per = 9.82  per(accum) = 69.1
 T(local opt: initial guess for dvdson    ) = 1.677e-04 S  per = 0.286  per(accum) = 69.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.705e-02 S  per = 29.1  per(accum) = 98.5
 T(local opt: dvdson [cpu-gpu]            ) = 1.584e-04 S  per = 0.27  per(accum) = 98.8
 T(local opt: dvdson [nccl]               ) = 3.240e-04 S  per = 0.553  per(accum) = 99.3
 T(local opt: dvdson [mpi]                ) = 2.499e-06 S  per = 0.00426  per(accum) = 99.3
 T(local opt: dvdson [rest part(linalg)]  ) = 3.861e-04 S  per = 0.659  per(accum) = 100
Detailed decomposition of T(renrm) = 1.185e-02 S  T(sum) = 1.185e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.975e-05 S  per = 0.504  per(accum) = 0.504
 T(local opt: qops init                    ) = 4.752e-04 S  per = 4.01  per(accum) = 4.51
 T(local opt: symbolic_formulae_renorm     ) = 1.114e-04 S  per = 0.94  per(accum) = 5.45
 T(local opt: allocate qops on gpu         ) = 5.957e-05 S  per = 0.503  per(accum) = 5.96
 T(local opt: site memcpy cpu2gpu          ) = 2.570e-05 S  per = 0.217  per(accum) = 6.17
 T(local opt: rintermediate init           ) = 4.784e-05 S  per = 0.404  per(accum) = 6.58
 T(local opt: preprocess_formulae_Rlist2   ) = 9.749e-04 S  per = 8.23  per(accum) = 14.8
 T(local opt: rmmtasks init                ) = 3.285e-04 S  per = 2.77  per(accum) = 17.6
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 0.000287  per(accum) = 17.6
 T(local opt: preprocess_renorm_batchGPU   ) = 8.032e-04 S  per = 6.78  per(accum) = 24.4
 T(local opt: deallocate cpu and gpu memory) = 2.638e-05 S  per = 0.223  per(accum) = 24.6
 T(local opt: construct opS [ifdists=true] ) = 5.288e-03 S  per = 44.6  per(accum) = 69.2
 T(local opt: reduction of opS & opH [nccl]) = 1.920e-05 S  per = 0.162  per(accum) = 69.4
 T(local opt: qops memcpy gpu2cpu          ) = 3.500e-08 S  per = 0.000295  per(accum) = 69.4
 T(local opt: reduction of opS & opH [mpi] ) = 6.200e-08 S  per = 0.000523  per(accum) = 69.4
 T(local opt: qops_pool join and erase     ) = 8.919e-04 S  per = 7.53  per(accum) = 76.9
 T(local opt: conversion from opAB to opPQ ) = 2.739e-03 S  per = 23.1  per(accum) = 100
ctns::rcanon_save_site idx=11 scratch=./scratch/sweep size=40:3e-07GB T(load)=0.00057S speed=0.00052GB/S
##### sweep opt: 3.655e-01 S #####
 T(sweep opt: fetch) = 2.315e-02 S  per = 6.33  per(accum) = 6.33
 T(sweep opt: hdiag) = 1.750e-02 S  per = 4.79  per(accum) = 11.1
 T(sweep opt: dvdsn) = 2.261e-01 S  per = 61.9  per(accum) = 73
 T(sweep opt: decim) = 8.960e-03 S  per = 2.45  per(accum) = 75.4
 T(sweep opt: guess) = 8.101e-04 S  per = 0.222  per(accum) = 75.6
 T(sweep opt: renrm) = 7.442e-02 S  per = 20.4  per(accum) = 96
 T(sweep opt: save ) = 1.459e-02 S  per = 3.99  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.261e-01 S  T(sum) = 2.226e-01 S  per = 9.843e+01
 T(sweep opt: preprocess                  ) = 3.101e-03 S  per = 1.39  per(accum) = 1.39
 T(sweep opt: symbolic_formulae           ) = 3.714e-03 S  per = 1.67  per(accum) = 3.06
 T(sweep opt: hintermediate init          ) = 5.781e-04 S  per = 0.26  per(accum) = 3.32
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.064e-01 S  per = 47.8  per(accum) = 51.1
 T(sweep opt: hmmtasks init               ) = 1.866e-02 S  per = 8.39  per(accum) = 59.5
 T(sweep opt: initial guess for dvdson    ) = 1.222e-03 S  per = 0.549  per(accum) = 60.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 8.200e-02 S  per = 36.8  per(accum) = 96.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.133e-03 S  per = 0.509  per(accum) = 97.4
 T(sweep opt: dvdson [nccl]               ) = 2.993e-03 S  per = 1.34  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 1.617e-05 S  per = 0.00727  per(accum) = 98.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.747e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm) = 7.442e-02 S  T(sum) = 7.442e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.194e-04 S  per = 0.564  per(accum) = 0.564
 T(sweep opt: qops init                    ) = 2.589e-03 S  per = 3.48  per(accum) = 4.04
 T(sweep opt: symbolic_formulae_renorm     ) = 5.295e-04 S  per = 0.711  per(accum) = 4.75
 T(sweep opt: allocate qops on gpu         ) = 4.340e-04 S  per = 0.583  per(accum) = 5.34
 T(sweep opt: site memcpy cpu2gpu          ) = 1.933e-04 S  per = 0.26  per(accum) = 5.6
 T(sweep opt: rintermediate init           ) = 2.958e-04 S  per = 0.397  per(accum) = 5.99
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.114e-03 S  per = 5.53  per(accum) = 11.5
 T(sweep opt: rmmtasks init                ) = 1.556e-03 S  per = 2.09  per(accum) = 13.6
 T(sweep opt: qops memset on cpu           ) = 2.970e-07 S  per = 0.000399  per(accum) = 13.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.581e-03 S  per =  7.5  per(accum) = 21.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.079e-04 S  per = 0.279  per(accum) = 21.4
 T(sweep opt: construct opS [ifdists=true] ) = 4.893e-02 S  per = 65.7  per(accum) = 87.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.498e-04 S  per = 0.201  per(accum) = 87.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.402e-04 S  per = 0.323  per(accum) = 87.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.393e-05 S  per = 0.0993  per(accum) = 87.8
 T(sweep opt: qops_pool join and erase     ) = 6.352e-03 S  per = 8.53  per(accum) = 96.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.759e-03 S  per = 3.71  per(accum) = 100
##### global opt: 3.655e-01 S #####
 T(global opt: fetch) = 2.315e-02 S  per = 6.33  per(accum) = 6.33
 T(global opt: hdiag) = 1.750e-02 S  per = 4.79  per(accum) = 11.1
 T(global opt: dvdsn) = 2.261e-01 S  per = 61.9  per(accum) = 73
 T(global opt: decim) = 8.960e-03 S  per = 2.45  per(accum) = 75.4
 T(global opt: guess) = 8.101e-04 S  per = 0.222  per(accum) = 75.6
 T(global opt: renrm) = 7.442e-02 S  per = 20.4  per(accum) = 96
 T(global opt: save ) = 1.459e-02 S  per = 3.99  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.261e-01 S  T(sum) = 2.226e-01 S  per = 9.843e+01
 T(global opt: preprocess                  ) = 3.101e-03 S  per = 1.39  per(accum) = 1.39
 T(global opt: symbolic_formulae           ) = 3.714e-03 S  per = 1.67  per(accum) = 3.06
 T(global opt: hintermediate init          ) = 5.781e-04 S  per = 0.26  per(accum) = 3.32
 T(global opt: preprocess_hformulae_Hxlist ) = 1.064e-01 S  per = 47.8  per(accum) = 51.1
 T(global opt: hmmtasks init               ) = 1.866e-02 S  per = 8.39  per(accum) = 59.5
 T(global opt: initial guess for dvdson    ) = 1.222e-03 S  per = 0.549  per(accum) = 60.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 8.200e-02 S  per = 36.8  per(accum) = 96.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.133e-03 S  per = 0.509  per(accum) = 97.4
 T(global opt: dvdson [nccl]               ) = 2.993e-03 S  per = 1.34  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 1.617e-05 S  per = 0.00727  per(accum) = 98.8
 T(global opt: dvdson [rest part(linalg)]  ) = 2.747e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm) = 7.442e-02 S  T(sum) = 7.442e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.194e-04 S  per = 0.564  per(accum) = 0.564
 T(global opt: qops init                    ) = 2.589e-03 S  per = 3.48  per(accum) = 4.04
 T(global opt: symbolic_formulae_renorm     ) = 5.295e-04 S  per = 0.711  per(accum) = 4.75
 T(global opt: allocate qops on gpu         ) = 4.340e-04 S  per = 0.583  per(accum) = 5.34
 T(global opt: site memcpy cpu2gpu          ) = 1.933e-04 S  per = 0.26  per(accum) = 5.6
 T(global opt: rintermediate init           ) = 2.958e-04 S  per = 0.397  per(accum) = 5.99
 T(global opt: preprocess_formulae_Rlist2   ) = 4.114e-03 S  per = 5.53  per(accum) = 11.5
 T(global opt: rmmtasks init                ) = 1.556e-03 S  per = 2.09  per(accum) = 13.6
 T(global opt: qops memset on cpu           ) = 2.970e-07 S  per = 0.000399  per(accum) = 13.6
 T(global opt: preprocess_renorm_batchGPU   ) = 5.581e-03 S  per =  7.5  per(accum) = 21.1
 T(global opt: deallocate cpu and gpu memory) = 2.079e-04 S  per = 0.279  per(accum) = 21.4
 T(global opt: construct opS [ifdists=true] ) = 4.893e-02 S  per = 65.7  per(accum) = 87.1
 T(global opt: reduction of opS & opH [nccl]) = 1.498e-04 S  per = 0.201  per(accum) = 87.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.402e-04 S  per = 0.323  per(accum) = 87.7
 T(global opt: reduction of opS & opH [mpi] ) = 7.393e-05 S  per = 0.0993  per(accum) = 87.8
 T(global opt: qops_pool join and erase     ) = 6.352e-03 S  per = 8.53  per(accum) = 96.3
 T(global opt: conversion from opAB to opPQ ) = 2.759e-03 S  per = 3.71  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-4.111e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=8/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=9 scratch=./scratch/sweep size=96:7.15e-07GB T(load)=3.32e-04S speed=2.15e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=248:1.89e-03MB:1.85e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=80:6.10e-04MB:5.96e-07GB
total mem of comb=329:2.51e-03MB:2.45e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=5.156e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:9 S:6 H:1 P:59 Q:66 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2881:2.198e-02MB:2.147e-05GB
        per(mem): C:3.75 S:2.5 H:0.972 P:0 Q:92.8 
 rqops: oplist=CSHAB nops=C:9 S:5 H:1 A:40 B:44 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=2301:0.0176MB:1.71e-05GB
        per(mem): C:3.13 S:1.74 H:1.43 A:0 B:93.7 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=7178:0.0548MB:5.35e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.194e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,9,3,3) nnz=151:1.152e-03MB
qtensor4: wf4 own=1 _data=0x5585ee53e000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
 qbond: qcol nsym=3 dimAll=9
 (14,2):4 (14,4):4 (15,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=26 nblocks=228 size=151:1.152e-03MB
### DIAG TIMING: total=5.741e-03 t1=1.952e-05, t2=2.184e-05, t3=1.848e-05, t4=5.629e-03, t5=7.134e-06, t6=3.801e-05, t7=6.878e-06
duration_diagGPU:5.758e-03
duration_diagreduce:7.400e-08
duration_diagtransform:3.130e-07
----- TIMING FOR symbolic_formulae_twodot with size=523 : 8.826e-04 S -----
rank=0 GPUmem(GB): used=5.348e-05 (oper)=5.348e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=523
 no. of hintermediate operators=259
 no. of coefficients=3136:2.393e-02MB:2.337e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.462e-05 S -----
rank=0 GPUmem(GB): used=7.685e-05 (oper,hinter)=5.348e-05,2.337e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.941e-02 S size(H_formulae)=523 size(Hxlst2)=26 T(Hmu/Hxlist)=2.554e-04,2.916e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.066e-02 S size(H_formulae)=523 size(Hxlst)=16506 -----
rank=0 GPUmem(GB): used=7.685e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.250e-06 batch[need]=6.026e-03 blksize=16 blksize0=16 batchsize=16506
rank=0 GPUmem(GB): used=6.105e-03 (oper,hinter,dvdson,batch)=5.348e-05,2.337e-05,2.250e-06,6.026e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=151 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.730e-05,1.941e-04,7.025e-04,7.413e-04,1.737e-03
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=2.787e-05 speed=8.075e-02GB/S T(nccl)=5.943e-05 speed=3.786e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=7.0e-04 t_reduction=7.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=52 t=1.9e-04 per=1.2e+01 cost=1.2e+06 flops=6.4e+09
 sigma[gemm] counter=52 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=1.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=3 t=1.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=4 t=1.5e-04 per=9.3e+00 cost=3.3e+05 flops=2.2e+09
 sigma[gemm] counter=52 i=5 t=2.1e-04 per=1.3e+01 cost=3.4e+05 flops=1.6e+09
 sigma[gemm] counter=52 i=6 t=1.7e-04 per=1.1e+01 cost=1.5e+05 flops=8.6e+08
 sigma[gemm] counter=52 i=7 t=1.6e-04 per=9.5e+00 cost=1.7e+05 flops=1.1e+09
 sigma[gemm] counter=52 total t=7.0e-04 per=4.3e+01 cost=9.9e+05 flops=1.4e+09
 sigma[red] counter=52 t=7.4e-04 per=4.5e+01 cost=2.0e+05 flops=2.7e+08
----- TIMING FOR sigma_tot : t_inter=6.7e-03 t_gemm=3.5e-02 t_reduction=3.2e-02 tot=7.3e-02 -----
 sigma_tot[inter] counter=52 t=6.7e-03 per=9.1e+00 cost=2.0e+07 flops=3.1e+09
 sigma_tot[gemm] counter=52 i=0 t=1.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=3 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=4 t=8.5e-03 per=1.2e+01 cost=4.5e+06 flops=5.3e+08
 sigma_tot[gemm] counter=52 i=5 t=9.2e-03 per=1.3e+01 cost=4.5e+06 flops=4.9e+08
 sigma_tot[gemm] counter=52 i=6 t=8.4e-03 per=1.1e+01 cost=5.4e+06 flops=6.4e+08
 sigma_tot[gemm] counter=52 i=7 t=8.5e-03 per=1.2e+01 cost=5.4e+06 flops=6.3e+08
 sigma_tot[gemm] counter=52 total t=3.5e-02 per=4.8e+01 cost=2.0e+07 flops=5.7e+08
 sigma_tot[red] counter=52 t=3.2e-02 per=4.3e+01 cost=4.6e+06 flops=1.4e+08
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,5.9e-06,1.0e-06,2.5e-06,2.7e-07
settings: ndim=151 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.248757672847 -1.116e+03  2.443e-02    1     1  2.035e-03 2.035e-03 1.997e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.823e-05,1.648e-04,7.393e-04,7.840e-04,1.761e-03
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=2.225e-05 speed=1.011e-01GB/S T(nccl)=4.598e-05 speed=4.894e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=7.4e-04 t_reduction=7.8e-04 tot=1.7e-03 -----
 sigma[inter] counter=53 t=1.6e-04 per=9.8e+00 cost=1.2e+06 flops=7.5e+09
 sigma[gemm] counter=53 i=0 t=2.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=3 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=4 t=1.6e-04 per=9.5e+00 cost=3.3e+05 flops=2.1e+09
 sigma[gemm] counter=53 i=5 t=2.1e-04 per=1.2e+01 cost=3.4e+05 flops=1.6e+09
 sigma[gemm] counter=53 i=6 t=1.9e-04 per=1.2e+01 cost=1.5e+05 flops=7.7e+08
 sigma[gemm] counter=53 i=7 t=1.7e-04 per=1.0e+01 cost=1.7e+05 flops=9.8e+08
 sigma[gemm] counter=53 total t=7.4e-04 per=4.4e+01 cost=9.9e+05 flops=1.3e+09
 sigma[red] counter=53 t=7.8e-04 per=4.6e+01 cost=2.0e+05 flops=2.6e+08
----- TIMING FOR sigma_tot : t_inter=6.9e-03 t_gemm=3.6e-02 t_reduction=3.2e-02 tot=7.5e-02 -----
 sigma_tot[inter] counter=53 t=6.9e-03 per=9.2e+00 cost=2.2e+07 flops=3.2e+09
 sigma_tot[gemm] counter=53 i=0 t=1.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=3 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=4 t=8.7e-03 per=1.2e+01 cost=4.9e+06 flops=5.6e+08
 sigma_tot[gemm] counter=53 i=5 t=9.4e-03 per=1.3e+01 cost=4.9e+06 flops=5.2e+08
 sigma_tot[gemm] counter=53 i=6 t=8.6e-03 per=1.1e+01 cost=5.6e+06 flops=6.4e+08
 sigma_tot[gemm] counter=53 i=7 t=8.7e-03 per=1.2e+01 cost=5.6e+06 flops=6.4e+08
 sigma_tot[gemm] counter=53 total t=3.6e-02 per=4.8e+01 cost=2.1e+07 flops=5.8e+08
 sigma_tot[red] counter=53 t=3.2e-02 per=4.3e+01 cost=4.8e+06 flops=1.5e+08
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,3.2e-05,2.8e-06,3.1e-06,3.3e-07
    2   0 -    -116.250671974043 -1.914e-03  6.274e-03    2     2  4.170e-03 2.085e-03 2.001e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.601e-05,1.474e-04,7.366e-04,7.795e-04,1.734e-03
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=2.168e-05 speed=1.038e-01GB/S T(nccl)=4.434e-05 speed=5.075e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=7.4e-04 t_reduction=7.8e-04 tot=1.7e-03 -----
 sigma[inter] counter=54 t=1.5e-04 per=8.9e+00 cost=1.2e+06 flops=8.4e+09
 sigma[gemm] counter=54 i=0 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=4 t=1.6e-04 per=9.7e+00 cost=3.3e+05 flops=2.1e+09
 sigma[gemm] counter=54 i=5 t=2.1e-04 per=1.3e+01 cost=3.4e+05 flops=1.6e+09
 sigma[gemm] counter=54 i=6 t=1.8e-04 per=1.1e+01 cost=1.5e+05 flops=8.2e+08
 sigma[gemm] counter=54 i=7 t=1.8e-04 per=1.1e+01 cost=1.7e+05 flops=9.4e+08
 sigma[gemm] counter=54 total t=7.4e-04 per=4.4e+01 cost=9.9e+05 flops=1.3e+09
 sigma[red] counter=54 t=7.8e-04 per=4.7e+01 cost=2.0e+05 flops=2.6e+08
----- TIMING FOR sigma_tot : t_inter=7.0e-03 t_gemm=3.7e-02 t_reduction=3.3e-02 tot=7.7e-02 -----
 sigma_tot[inter] counter=54 t=7.0e-03 per=9.2e+00 cost=2.3e+07 flops=3.3e+09
 sigma_tot[gemm] counter=54 i=0 t=1.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=3 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=4 t=8.8e-03 per=1.1e+01 cost=5.2e+06 flops=5.9e+08
 sigma_tot[gemm] counter=54 i=5 t=9.6e-03 per=1.3e+01 cost=5.2e+06 flops=5.4e+08
 sigma_tot[gemm] counter=54 i=6 t=8.8e-03 per=1.1e+01 cost=5.7e+06 flops=6.5e+08
 sigma_tot[gemm] counter=54 i=7 t=8.9e-03 per=1.2e+01 cost=5.7e+06 flops=6.5e+08
 sigma_tot[gemm] counter=54 total t=3.7e-02 per=4.8e+01 cost=2.2e+07 flops=6.0e+08
 sigma_tot[red] counter=54 t=3.3e-02 per=4.3e+01 cost=5.0e+06 flops=1.5e+08
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,2.3e-05,2.0e-06,1.6e-06,2.0e-07
    3   0 -    -116.250763625795 -9.165e-05  1.816e-03    3     3  6.213e-03 2.071e-03 1.994e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.645e-05,1.451e-04,7.467e-04,7.757e-04,1.738e-03
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=2.138e-05 speed=1.052e-01GB/S T(nccl)=4.506e-05 speed=4.993e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=7.5e-04 t_reduction=7.8e-04 tot=1.7e-03 -----
 sigma[inter] counter=55 t=1.5e-04 per=8.7e+00 cost=1.2e+06 flops=8.5e+09
 sigma[gemm] counter=55 i=0 t=2.8e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=2.6e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=3 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=4 t=1.7e-04 per=1.0e+01 cost=3.3e+05 flops=2.0e+09
 sigma[gemm] counter=55 i=5 t=2.1e-04 per=1.3e+01 cost=3.4e+05 flops=1.6e+09
 sigma[gemm] counter=55 i=6 t=1.8e-04 per=1.1e+01 cost=1.5e+05 flops=8.2e+08
 sigma[gemm] counter=55 i=7 t=1.7e-04 per=1.0e+01 cost=1.7e+05 flops=9.7e+08
 sigma[gemm] counter=55 total t=7.5e-04 per=4.5e+01 cost=9.9e+05 flops=1.3e+09
 sigma[red] counter=55 t=7.8e-04 per=4.7e+01 cost=2.0e+05 flops=2.6e+08
----- TIMING FOR sigma_tot : t_inter=7.2e-03 t_gemm=3.7e-02 t_reduction=3.4e-02 tot=7.8e-02 -----
 sigma_tot[inter] counter=55 t=7.2e-03 per=9.1e+00 cost=2.4e+07 flops=3.4e+09
 sigma_tot[gemm] counter=55 i=0 t=1.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=3 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=4 t=9.0e-03 per=1.1e+01 cost=5.5e+06 flops=6.2e+08
 sigma_tot[gemm] counter=55 i=5 t=9.8e-03 per=1.3e+01 cost=5.6e+06 flops=5.7e+08
 sigma_tot[gemm] counter=55 i=6 t=9.0e-03 per=1.1e+01 cost=5.9e+06 flops=6.5e+08
 sigma_tot[gemm] counter=55 i=7 t=9.0e-03 per=1.2e+01 cost=5.9e+06 flops=6.5e+08
 sigma_tot[gemm] counter=55 total t=3.7e-02 per=4.8e+01 cost=2.3e+07 flops=6.1e+08
 sigma_tot[red] counter=55 t=3.4e-02 per=4.3e+01 cost=5.2e+06 flops=1.5e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.3e-05,1.9e-06,1.4e-06,2.0e-07
    4   0 -    -116.250772291414 -8.666e-06  6.851e-04    3     4  8.204e-03 2.051e-03 1.980e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.523e-05,1.407e-04,7.214e-04,7.734e-04,1.705e-03
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=2.177e-05 speed=1.034e-01GB/S T(nccl)=4.347e-05 speed=5.177e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.2e-04 t_reduction=7.7e-04 tot=1.6e-03 -----
 sigma[inter] counter=56 t=1.4e-04 per=8.6e+00 cost=1.2e+06 flops=8.8e+09
 sigma[gemm] counter=56 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=4 t=1.6e-04 per=9.7e+00 cost=3.3e+05 flops=2.1e+09
 sigma[gemm] counter=56 i=5 t=2.0e-04 per=1.2e+01 cost=3.4e+05 flops=1.7e+09
 sigma[gemm] counter=56 i=6 t=1.8e-04 per=1.1e+01 cost=1.5e+05 flops=8.4e+08
 sigma[gemm] counter=56 i=7 t=1.7e-04 per=1.1e+01 cost=1.7e+05 flops=9.5e+08
 sigma[gemm] counter=56 total t=7.2e-04 per=4.4e+01 cost=9.9e+05 flops=1.4e+09
 sigma[red] counter=56 t=7.7e-04 per=4.7e+01 cost=2.0e+05 flops=2.6e+08
----- TIMING FOR sigma_tot : t_inter=7.3e-03 t_gemm=3.8e-02 t_reduction=3.5e-02 tot=8.0e-02 -----
 sigma_tot[inter] counter=56 t=7.3e-03 per=9.1e+00 cost=2.5e+07 flops=3.5e+09
 sigma_tot[gemm] counter=56 i=0 t=1.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=3 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=4 t=9.1e-03 per=1.1e+01 cost=5.9e+06 flops=6.4e+08
 sigma_tot[gemm] counter=56 i=5 t=1.0e-02 per=1.3e+01 cost=5.9e+06 flops=5.9e+08
 sigma_tot[gemm] counter=56 i=6 t=9.2e-03 per=1.1e+01 cost=6.0e+06 flops=6.6e+08
 sigma_tot[gemm] counter=56 i=7 t=9.2e-03 per=1.1e+01 cost=6.1e+06 flops=6.6e+08
 sigma_tot[gemm] counter=56 total t=3.8e-02 per=4.7e+01 cost=2.4e+07 flops=6.3e+08
 sigma_tot[red] counter=56 t=3.5e-02 per=4.3e+01 cost=5.4e+06 flops=1.5e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,1.9e-06,1.3e-06,2.0e-07
    5   0 -    -116.250773469210 -1.178e-06  1.611e-04    3     5  1.015e-02 2.030e-03 1.964e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.548e-05,1.390e-04,7.254e-04,7.780e-04,1.712e-03
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=2.129e-05 speed=1.057e-01GB/S T(nccl)=4.420e-05 speed=5.091e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.2e-04 t_reduction=7.8e-04 tot=1.6e-03 -----
 sigma[inter] counter=57 t=1.4e-04 per=8.5e+00 cost=1.2e+06 flops=8.9e+09
 sigma[gemm] counter=57 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=4 t=1.6e-04 per=9.8e+00 cost=3.3e+05 flops=2.1e+09
 sigma[gemm] counter=57 i=5 t=2.0e-04 per=1.2e+01 cost=3.4e+05 flops=1.7e+09
 sigma[gemm] counter=57 i=6 t=1.9e-04 per=1.2e+01 cost=1.5e+05 flops=7.9e+08
 sigma[gemm] counter=57 i=7 t=1.6e-04 per=1.0e+01 cost=1.7e+05 flops=1.0e+09
 sigma[gemm] counter=57 total t=7.2e-04 per=4.4e+01 cost=9.9e+05 flops=1.4e+09
 sigma[red] counter=57 t=7.8e-04 per=4.7e+01 cost=2.0e+05 flops=2.6e+08
----- TIMING FOR sigma_tot : t_inter=7.4e-03 t_gemm=3.9e-02 t_reduction=3.6e-02 tot=8.2e-02 -----
 sigma_tot[inter] counter=57 t=7.4e-03 per=9.1e+00 cost=2.7e+07 flops=3.6e+09
 sigma_tot[gemm] counter=57 i=0 t=1.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=3 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=4 t=9.3e-03 per=1.1e+01 cost=6.2e+06 flops=6.7e+08
 sigma_tot[gemm] counter=57 i=5 t=1.0e-02 per=1.3e+01 cost=6.2e+06 flops=6.1e+08
 sigma_tot[gemm] counter=57 i=6 t=9.4e-03 per=1.1e+01 cost=6.2e+06 flops=6.6e+08
 sigma_tot[gemm] counter=57 i=7 t=9.4e-03 per=1.1e+01 cost=6.2e+06 flops=6.6e+08
 sigma_tot[gemm] counter=57 total t=3.9e-02 per=4.7e+01 cost=2.5e+07 flops=6.4e+08
 sigma_tot[red] counter=57 t=3.6e-02 per=4.3e+01 cost=5.6e+06 flops=1.6e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.1e-05,1.8e-06,1.4e-06,1.9e-07
    6   0 +    -116.250773542643 -7.343e-08  3.777e-05    3     6  1.211e-02 2.018e-03 1.956e-03
TIMING FOR Davidson : 1.213e-02  T(cal/comm/rest)=1.174e-02,9.338e-06,3.853e-04
decomposed t_rest=3.853e-04
 T(sub)    =1.504e-04 per=3.904e+01
 T(precond)=1.839e-05 per=4.773e+00
 T(ortho)  =8.799e-06 per=2.283e+00
 T(xcopy)  =8.600e-07 per=2.232e-01
 T(xnrm2)  =1.278e-06 per=3.317e-01
 T(other)  =2.056e-04 per=5.335e+01
optimized energies: isweep=0 ibond=8 dots=2 e[0]=-116.250773542643 nmvp=6
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.087e-03 change=4.157e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=11 dimAll=37
 (14,2):6 (16,2):4 (15,1):8 (15,3):6 (14,0):4 (16,0):3 (13,1):1 (13,3):1 (14,4):2 (16,4):1 (15,5):1
timing for divide=9.1e-06
timing for compute=9.3e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=9.1e-06,8.8e-05,0.0e+00,5.1e-06,1.2e-05 -----
decimation summary: 37->10 dwt=+4.871e-03 SvN=1.161e+00
 qbond: qkept nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
----- TIMING for decimation_row(nkr): 1.150e-03 S T(decim/select/formRot)=1.607e-04,9.635e-04,2.553e-05 -----
----- TIMING FOR twodot_decimation: 1.232e-03 S T(wf/decim)=6.844e-05,1.164e-03 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=2657:2.027e-02MB:1.980e-05GB
        per(mem): C:4.14 S:2.07 H:1.05 P:0 Q:92.7 
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=8.087e-03 change=2.399e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=116 : 5.015e-04 S -----
rank=0 GPUmem(GB): used=7.950e-05 (oper)=4.870e-05
rank=0 GPUmem(GB): used=7.994e-05 (oper,site)=4.870e-05,4.396e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=116
 no. of rintermediate operators=161
 no. of coefficients=1449:1.105e-02MB:1.080e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.668e-05 S -----
rank=0 GPUmem(GB): used=9.073e-05 (oper,site,rinter)=4.870e-05,4.396e-07,1.080e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.514e-03 S size(rtasks)=116 size(Rlst2)=25 T(Rmu/Rlist)=2.153e-04,3.298e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.727e-03 S size(rtasks)=116 size(Rlst)=3254 -----
rank=0 GPUmem(GB): used=9.073e-05 avail=3.829e+01 total=3.829e+01 batch[need]=8.970e-04 blksize=16 blksize0=4 batchsize=3254
rank=0 GPUmem(GB): used=9.878e-04 (oper,site,rinter,batch)=4.870e-05,4.396e-07,1.080e-05,8.970e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.062e-04,4.101e-04,1.627e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=4.1e-04 t_reduction=1.6e-04 tot=6.8e-04 -----
 renorm[inter] counter=125 t=1.1e-04 per=1.6e+01 cost=5.6e+04 flops=5.3e+08
 renorm[gemm] counter=125 i=0 t=1.8e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=1 t=1.6e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=2 t=1.6e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=3 t=1.6e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=4 t=1.2e-04 per=1.7e+01 cost=8.6e+03 flops=7.4e+07
 renorm[gemm] counter=125 i=5 t=1.5e-04 per=2.1e+01 cost=4.9e+04 flops=3.4e+08
 renorm[gemm] counter=125 i=6 t=1.4e-04 per=2.1e+01 cost=1.1e+05 flops=7.5e+08
 renorm[gemm] counter=125 total t=4.1e-04 per=6.0e+01 cost=1.6e+05 flops=4.0e+08
 renorm[red] counter=125 t=1.6e-04 per=2.4e+01 cost=4.4e+04 flops=2.7e+08
----- TIMING FOR renorm_tot : t_inter=8.2e-04 t_gemm=3.1e-03 t_reduction=1.3e-03 tot=5.2e-03 -----
 renorm_tot[inter] counter=125 t=8.2e-04 per=1.6e+01 cost=1.1e+05 flops=1.4e+08
 renorm_tot[gemm] counter=125 i=0 t=1.9e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=1 t=1.7e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=2 t=1.7e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=3 t=1.7e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=4 t=9.6e-04 per=1.8e+01 cost=1.6e+04 flops=1.7e+07
 renorm_tot[gemm] counter=125 i=5 t=1.1e-03 per=2.0e+01 cost=1.2e+05 flops=1.1e+08
 renorm_tot[gemm] counter=125 i=6 t=9.9e-04 per=1.9e+01 cost=1.8e+05 flops=1.8e+08
 renorm_tot[gemm] counter=125 total t=3.1e-03 per=5.9e+01 cost=3.1e+05 flops=1.0e+08
 renorm_tot[red] counter=125 t=1.3e-03 per=2.5e+01 cost=7.1e+04 flops=5.4e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.138e-05 (oper)=4.878e-05
rank=0 GPUmem(GB): used=9.182e-05 (oper,site,rinter)=4.878e-05,4.396e-07,1.006e-06
rank=0 GPUmem(GB): used=1.073e-04 (oper,site,rinter,batch)=4.878e-05,4.396e-07,1.006e-06,1.544e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.034e-03 S T(preprocess/alloc/comp/red/dealloc)=6.204e-04,6.564e-04,1.988e-03,3.126e-04,6.000e-05 -----
----- TIMING FOR oper_renorm_opS : 3.051e-03 S rank=0 -----
qops.to_cpu: size(tot)=2657:2.027e-02MB:1.980e-05GB T(to_cpu)=5.097e-05S speed=3.884e-01GB/S
check ||H-H.dagger||=9.613e-15 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.00991 S rank=0 -----
rank=0 CPUmem(GB): used=1.344e+00 pageheap_free=6.935e-03 change=9.488e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=9.315e-03 change=-2.133e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=9.315e-03 change=-3.979e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 7.367e-02 S #####
 T(local opt: fetch) = 2.476e-03 S  per = 3.36  per(accum) = 3.36
 T(local opt: hdiag) = 5.871e-03 S  per = 7.97  per(accum) = 11.3
 T(local opt: dvdsn) = 5.121e-02 S  per = 69.5  per(accum) = 80.8
 T(local opt: decim) = 1.266e-03 S  per = 1.72  per(accum) = 82.6
 T(local opt: guess) = 8.012e-05 S  per = 0.109  per(accum) = 82.7
 T(local opt: renrm) = 1.089e-02 S  per = 14.8  per(accum) = 97.5
 T(local opt: save ) = 1.874e-03 S  per = 2.54  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.121e-02 S  T(sum) = 5.046e-02 S  per = 9.854e+01
 T(local opt: preprocess                  ) = 2.696e-04 S  per = 0.534  per(accum) = 0.534
 T(local opt: symbolic_formulae           ) = 8.982e-04 S  per = 1.78  per(accum) = 2.31
 T(local opt: hintermediate init          ) = 1.115e-04 S  per = 0.221  per(accum) = 2.54
 T(local opt: preprocess_hformulae_Hxlist ) = 3.088e-02 S  per = 61.2  per(accum) = 63.7
 T(local opt: hmmtasks init               ) = 5.990e-03 S  per = 11.9  per(accum) = 75.6
 T(local opt: initial guess for dvdson    ) = 1.805e-04 S  per = 0.358  per(accum) = 76
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.132e-02 S  per = 22.4  per(accum) = 98.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.362e-04 S  per = 0.27  per(accum) = 98.7
 T(local opt: dvdson [nccl]               ) = 2.825e-04 S  per = 0.56  per(accum) = 99.2
 T(local opt: dvdson [mpi]                ) = 9.338e-06 S  per = 0.0185  per(accum) = 99.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.853e-04 S  per = 0.764  per(accum) = 100
Detailed decomposition of T(renrm) = 1.089e-02 S  T(sum) = 1.089e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.216e-05 S  per = 0.571  per(accum) = 0.571
 T(local opt: qops init                    ) = 5.086e-04 S  per = 4.67  per(accum) = 5.24
 T(local opt: symbolic_formulae_renorm     ) = 5.139e-04 S  per = 4.72  per(accum) = 9.96
 T(local opt: allocate qops on gpu         ) = 5.664e-05 S  per = 0.52  per(accum) = 10.5
 T(local opt: site memcpy cpu2gpu          ) = 2.701e-05 S  per = 0.248  per(accum) = 10.7
 T(local opt: rintermediate init           ) = 7.538e-05 S  per = 0.692  per(accum) = 11.4
 T(local opt: preprocess_formulae_Rlist2   ) = 3.746e-03 S  per = 34.4  per(accum) = 45.8
 T(local opt: rmmtasks init                ) = 9.594e-04 S  per = 8.81  per(accum) = 54.6
 T(local opt: qops memset on cpu           ) = 6.700e-08 S  per = 0.000615  per(accum) = 54.6
 T(local opt: preprocess_renorm_batchGPU   ) = 8.385e-04 S  per =  7.7  per(accum) = 62.3
 T(local opt: deallocate cpu and gpu memory) = 4.411e-05 S  per = 0.405  per(accum) = 62.7
 T(local opt: construct opS [ifdists=true] ) = 3.057e-03 S  per = 28.1  per(accum) = 90.8
 T(local opt: reduction of opS & opH [nccl]) = 1.844e-05 S  per = 0.169  per(accum) = 91
 T(local opt: qops memcpy gpu2cpu          ) = 5.498e-05 S  per = 0.505  per(accum) = 91.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.026e-05 S  per = 0.0942  per(accum) = 91.6
 T(local opt: qops_pool join and erase     ) = 9.170e-04 S  per = 8.42  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.457e-06 S  per = 0.0226  per(accum) = 100
ctns::rcanon_save_site idx=10 scratch=./scratch/sweep size=59:4.4e-07GB T(load)=0.00058S speed=0.00076GB/S
##### sweep opt: 4.392e-01 S #####
 T(sweep opt: fetch) = 2.562e-02 S  per = 5.83  per(accum) = 5.83
 T(sweep opt: hdiag) = 2.337e-02 S  per = 5.32  per(accum) = 11.2
 T(sweep opt: dvdsn) = 2.773e-01 S  per = 63.1  per(accum) = 74.3
 T(sweep opt: decim) = 1.023e-02 S  per = 2.33  per(accum) = 76.6
 T(sweep opt: guess) = 8.902e-04 S  per = 0.203  per(accum) = 76.8
 T(sweep opt: renrm) = 8.531e-02 S  per = 19.4  per(accum) = 96.3
 T(sweep opt: save ) = 1.646e-02 S  per = 3.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.773e-01 S  T(sum) = 2.730e-01 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 3.371e-03 S  per = 1.23  per(accum) = 1.23
 T(sweep opt: symbolic_formulae           ) = 4.613e-03 S  per = 1.69  per(accum) = 2.92
 T(sweep opt: hintermediate init          ) = 6.895e-04 S  per = 0.253  per(accum) = 3.18
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.373e-01 S  per = 50.3  per(accum) = 53.5
 T(sweep opt: hmmtasks init               ) = 2.465e-02 S  per = 9.03  per(accum) = 62.5
 T(sweep opt: initial guess for dvdson    ) = 1.403e-03 S  per = 0.514  per(accum) = 63
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 9.331e-02 S  per = 34.2  per(accum) = 97.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.269e-03 S  per = 0.465  per(accum) = 97.6
 T(sweep opt: dvdson [nccl]               ) = 3.276e-03 S  per =  1.2  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 2.551e-05 S  per = 0.00934  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.132e-03 S  per = 1.15  per(accum) = 100
Detailed decomposition of T(renrm) = 8.531e-02 S  T(sum) = 8.531e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.816e-04 S  per = 0.564  per(accum) = 0.564
 T(sweep opt: qops init                    ) = 3.097e-03 S  per = 3.63  per(accum) = 4.19
 T(sweep opt: symbolic_formulae_renorm     ) = 1.043e-03 S  per = 1.22  per(accum) = 5.42
 T(sweep opt: allocate qops on gpu         ) = 4.906e-04 S  per = 0.575  per(accum) = 5.99
 T(sweep opt: site memcpy cpu2gpu          ) = 2.203e-04 S  per = 0.258  per(accum) = 6.25
 T(sweep opt: rintermediate init           ) = 3.712e-04 S  per = 0.435  per(accum) = 6.69
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.861e-03 S  per = 9.21  per(accum) = 15.9
 T(sweep opt: rmmtasks init                ) = 2.515e-03 S  per = 2.95  per(accum) = 18.8
 T(sweep opt: qops memset on cpu           ) = 3.640e-07 S  per = 0.000427  per(accum) = 18.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.419e-03 S  per = 7.52  per(accum) = 26.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.520e-04 S  per = 0.295  per(accum) = 26.7
 T(sweep opt: construct opS [ifdists=true] ) = 5.198e-02 S  per = 60.9  per(accum) = 87.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.683e-04 S  per = 0.197  per(accum) = 87.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.952e-04 S  per = 0.346  per(accum) = 88.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.419e-05 S  per = 0.0987  per(accum) = 88.2
 T(sweep opt: qops_pool join and erase     ) = 7.269e-03 S  per = 8.52  per(accum) = 96.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.761e-03 S  per = 3.24  per(accum) = 100
##### global opt: 4.392e-01 S #####
 T(global opt: fetch) = 2.562e-02 S  per = 5.83  per(accum) = 5.83
 T(global opt: hdiag) = 2.337e-02 S  per = 5.32  per(accum) = 11.2
 T(global opt: dvdsn) = 2.773e-01 S  per = 63.1  per(accum) = 74.3
 T(global opt: decim) = 1.023e-02 S  per = 2.33  per(accum) = 76.6
 T(global opt: guess) = 8.902e-04 S  per = 0.203  per(accum) = 76.8
 T(global opt: renrm) = 8.531e-02 S  per = 19.4  per(accum) = 96.3
 T(global opt: save ) = 1.646e-02 S  per = 3.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.773e-01 S  T(sum) = 2.730e-01 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 3.371e-03 S  per = 1.23  per(accum) = 1.23
 T(global opt: symbolic_formulae           ) = 4.613e-03 S  per = 1.69  per(accum) = 2.92
 T(global opt: hintermediate init          ) = 6.895e-04 S  per = 0.253  per(accum) = 3.18
 T(global opt: preprocess_hformulae_Hxlist ) = 1.373e-01 S  per = 50.3  per(accum) = 53.5
 T(global opt: hmmtasks init               ) = 2.465e-02 S  per = 9.03  per(accum) = 62.5
 T(global opt: initial guess for dvdson    ) = 1.403e-03 S  per = 0.514  per(accum) = 63
 T(global opt: dvdson [Hx_batchGPU]        ) = 9.331e-02 S  per = 34.2  per(accum) = 97.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.269e-03 S  per = 0.465  per(accum) = 97.6
 T(global opt: dvdson [nccl]               ) = 3.276e-03 S  per =  1.2  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 2.551e-05 S  per = 0.00934  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 3.132e-03 S  per = 1.15  per(accum) = 100
Detailed decomposition of T(renrm) = 8.531e-02 S  T(sum) = 8.531e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.816e-04 S  per = 0.564  per(accum) = 0.564
 T(global opt: qops init                    ) = 3.097e-03 S  per = 3.63  per(accum) = 4.19
 T(global opt: symbolic_formulae_renorm     ) = 1.043e-03 S  per = 1.22  per(accum) = 5.42
 T(global opt: allocate qops on gpu         ) = 4.906e-04 S  per = 0.575  per(accum) = 5.99
 T(global opt: site memcpy cpu2gpu          ) = 2.203e-04 S  per = 0.258  per(accum) = 6.25
 T(global opt: rintermediate init           ) = 3.712e-04 S  per = 0.435  per(accum) = 6.69
 T(global opt: preprocess_formulae_Rlist2   ) = 7.861e-03 S  per = 9.21  per(accum) = 15.9
 T(global opt: rmmtasks init                ) = 2.515e-03 S  per = 2.95  per(accum) = 18.8
 T(global opt: qops memset on cpu           ) = 3.640e-07 S  per = 0.000427  per(accum) = 18.8
 T(global opt: preprocess_renorm_batchGPU   ) = 6.419e-03 S  per = 7.52  per(accum) = 26.4
 T(global opt: deallocate cpu and gpu memory) = 2.520e-04 S  per = 0.295  per(accum) = 26.7
 T(global opt: construct opS [ifdists=true] ) = 5.198e-02 S  per = 60.9  per(accum) = 87.6
 T(global opt: reduction of opS & opH [nccl]) = 1.683e-04 S  per = 0.197  per(accum) = 87.8
 T(global opt: qops memcpy gpu2cpu          ) = 2.952e-04 S  per = 0.346  per(accum) = 88.1
 T(global opt: reduction of opS & opH [mpi] ) = 8.419e-05 S  per = 0.0987  per(accum) = 88.2
 T(global opt: qops_pool join and erase     ) = 7.269e-03 S  per = 8.52  per(accum) = 96.8
 T(global opt: conversion from opAB to opPQ ) = 2.761e-03 S  per = 3.24  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-4.163e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=9/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=8 scratch=./scratch/sweep size=42:3.13e-07GB T(load)=3.20e-04S speed=9.76e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=138:1.05e-03MB:1.03e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=57:4.35e-04MB:4.25e-07GB
total mem of comb=196:1.50e-03MB:1.46e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=3.025e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=2657:2.027e-02MB:1.980e-05GB
        per(mem): C:4.14 S:2.07 H:1.05 P:0 Q:92.7 
 rqops: oplist=CSHAB nops=C:8 S:6 H:1 A:28 B:40 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=1430:0.0109MB:1.07e-05GB
        per(mem): C:6.71 S:5.03 H:1.54 A:0 B:86.7 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=6083:0.0464MB:4.53e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.957e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.103e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,8,3,3) nnz=114:8.698e-04MB
qtensor4: wf4 own=1 _data=0x5585f681b000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
 qbond: qcol nsym=3 dimAll=8
 (12,2):3 (12,4):3 (13,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=20 nblocks=240 size=114:8.698e-04MB
### DIAG TIMING: total=4.450e-03 t1=1.513e-05, t2=1.776e-05, t3=1.783e-05, t4=4.347e-03, t5=6.739e-06, t6=3.805e-05, t7=7.095e-06
duration_diagGPU:4.460e-03
duration_diagreduce:5.700e-08
duration_diagtransform:3.120e-07
----- TIMING FOR symbolic_formulae_twodot with size=449 : 7.469e-04 S -----
rank=0 GPUmem(GB): used=4.532e-05 (oper)=4.532e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=449
 no. of hintermediate operators=226
 no. of coefficients=2834:2.162e-02MB:2.111e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.419e-05 S -----
rank=0 GPUmem(GB): used=6.644e-05 (oper,hinter)=4.532e-05,2.111e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.841e-02 S size(H_formulae)=449 size(Hxlst2)=20 T(Hmu/Hxlist)=1.887e-04,1.822e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.942e-02 S size(H_formulae)=449 size(Hxlst)=9474 -----
rank=0 GPUmem(GB): used=6.644e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.699e-06 batch[need]=2.400e-03 blksize=12 blksize0=9 batchsize=9474
rank=0 GPUmem(GB): used=2.468e-03 (oper,hinter,dvdson,batch)=4.532e-05,2.111e-05,1.699e-06,2.400e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=114 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.771e-05,1.814e-04,8.588e-04,5.266e-04,1.666e-03
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.716e-05 speed=6.254e-02GB/S T(nccl)=6.055e-05 speed=2.806e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=8.6e-04 t_reduction=5.3e-04 tot=1.6e-03 -----
 sigma[inter] counter=58 t=1.8e-04 per=1.2e+01 cost=4.4e+05 flops=2.4e+09
 sigma[gemm] counter=58 i=0 t=3.0e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=3 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=4 t=1.9e-04 per=1.2e+01 cost=1.2e+05 flops=6.5e+08
 sigma[gemm] counter=58 i=5 t=2.4e-04 per=1.5e+01 cost=1.3e+05 flops=5.3e+08
 sigma[gemm] counter=58 i=6 t=2.0e-04 per=1.3e+01 cost=8.6e+04 flops=4.2e+08
 sigma[gemm] counter=58 i=7 t=2.1e-04 per=1.3e+01 cost=9.0e+04 flops=4.3e+08
 sigma[gemm] counter=58 total t=8.6e-04 per=5.5e+01 cost=4.3e+05 flops=5.0e+08
 sigma[red] counter=58 t=5.3e-04 per=3.4e+01 cost=1.0e+05 flops=2.0e+08
----- TIMING FOR sigma_tot : t_inter=7.6e-03 t_gemm=4.0e-02 t_reduction=3.6e-02 tot=8.3e-02 -----
 sigma_tot[inter] counter=58 t=7.6e-03 per=9.2e+00 cost=2.7e+07 flops=3.5e+09
 sigma_tot[gemm] counter=58 i=0 t=1.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=3 t=1.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=4 t=9.5e-03 per=1.1e+01 cost=6.3e+06 flops=6.7e+08
 sigma_tot[gemm] counter=58 i=5 t=1.0e-02 per=1.3e+01 cost=6.4e+06 flops=6.1e+08
 sigma_tot[gemm] counter=58 i=6 t=9.6e-03 per=1.1e+01 cost=6.2e+06 flops=6.5e+08
 sigma_tot[gemm] counter=58 i=7 t=9.6e-03 per=1.1e+01 cost=6.3e+06 flops=6.6e+08
 sigma_tot[gemm] counter=58 total t=4.0e-02 per=4.8e+01 cost=2.5e+07 flops=6.4e+08
 sigma_tot[red] counter=58 t=3.6e-02 per=4.3e+01 cost=5.7e+06 flops=1.6e+08
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,4.1e-06,1.6e-06,1.5e-06,4.5e-07
settings: ndim=114 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.248461708954 -1.116e+03  6.701e-02    1     1  2.093e-03 2.093e-03 2.051e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.023e-05,1.653e-04,1.026e-03,6.568e-04,1.935e-03
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.584e-05 speed=6.574e-02GB/S T(nccl)=5.439e-05 speed=3.123e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.0e-03 t_reduction=6.6e-04 tot=1.8e-03 -----
 sigma[inter] counter=59 t=1.7e-04 per=8.9e+00 cost=4.4e+05 flops=2.7e+09
 sigma[gemm] counter=59 i=0 t=3.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=3.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=3.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=3 t=3.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=4 t=2.2e-04 per=1.2e+01 cost=1.2e+05 flops=5.7e+08
 sigma[gemm] counter=59 i=5 t=2.7e-04 per=1.5e+01 cost=1.3e+05 flops=4.8e+08
 sigma[gemm] counter=59 i=6 t=2.6e-04 per=1.4e+01 cost=8.6e+04 flops=3.3e+08
 sigma[gemm] counter=59 i=7 t=2.6e-04 per=1.4e+01 cost=9.0e+04 flops=3.4e+08
 sigma[gemm] counter=59 total t=1.0e-03 per=5.6e+01 cost=4.3e+05 flops=4.2e+08
 sigma[red] counter=59 t=6.6e-04 per=3.6e+01 cost=1.0e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=7.8e-03 t_gemm=4.1e-02 t_reduction=3.7e-02 tot=8.5e-02 -----
 sigma_tot[inter] counter=59 t=7.8e-03 per=9.2e+00 cost=2.8e+07 flops=3.5e+09
 sigma_tot[gemm] counter=59 i=0 t=1.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=3 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=4 t=9.7e-03 per=1.1e+01 cost=6.4e+06 flops=6.6e+08
 sigma_tot[gemm] counter=59 i=5 t=1.1e-02 per=1.3e+01 cost=6.5e+06 flops=6.0e+08
 sigma_tot[gemm] counter=59 i=6 t=9.8e-03 per=1.2e+01 cost=6.3e+06 flops=6.4e+08
 sigma_tot[gemm] counter=59 i=7 t=9.8e-03 per=1.2e+01 cost=6.4e+06 flops=6.5e+08
 sigma_tot[gemm] counter=59 total t=4.1e-02 per=4.8e+01 cost=2.6e+07 flops=6.3e+08
 sigma_tot[red] counter=59 t=3.7e-02 per=4.3e+01 cost=5.8e+06 flops=1.6e+08
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=8.2e-06,1.9e-05,4.7e-06,2.3e-06,4.9e-07
    2   0 -    -116.264421556857 -1.596e-02  2.513e-02    2     2  4.532e-03 2.266e-03 2.185e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.005e-05,1.744e-04,1.099e-03,6.911e-04,2.052e-03
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.555e-05 speed=6.649e-02GB/S T(nccl)=5.450e-05 speed=3.117e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.1e-03 t_reduction=6.9e-04 tot=2.0e-03 -----
 sigma[inter] counter=60 t=1.7e-04 per=8.9e+00 cost=4.4e+05 flops=2.5e+09
 sigma[gemm] counter=60 i=0 t=3.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=3.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=3.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=3 t=3.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=4 t=2.4e-04 per=1.2e+01 cost=1.2e+05 flops=5.3e+08
 sigma[gemm] counter=60 i=5 t=3.1e-04 per=1.6e+01 cost=1.3e+05 flops=4.2e+08
 sigma[gemm] counter=60 i=6 t=2.7e-04 per=1.4e+01 cost=8.6e+04 flops=3.2e+08
 sigma[gemm] counter=60 i=7 t=2.8e-04 per=1.4e+01 cost=9.0e+04 flops=3.3e+08
 sigma[gemm] counter=60 total t=1.1e-03 per=5.6e+01 cost=4.3e+05 flops=3.9e+08
 sigma[red] counter=60 t=6.9e-04 per=3.5e+01 cost=1.0e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=8.0e-03 t_gemm=4.2e-02 t_reduction=3.7e-02 tot=8.7e-02 -----
 sigma_tot[inter] counter=60 t=8.0e-03 per=9.2e+00 cost=2.8e+07 flops=3.5e+09
 sigma_tot[gemm] counter=60 i=0 t=1.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=3 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=4 t=1.0e-02 per=1.1e+01 cost=6.6e+06 flops=6.6e+08
 sigma_tot[gemm] counter=60 i=5 t=1.1e-02 per=1.3e+01 cost=6.6e+06 flops=6.0e+08
 sigma_tot[gemm] counter=60 i=6 t=1.0e-02 per=1.2e+01 cost=6.4e+06 flops=6.4e+08
 sigma_tot[gemm] counter=60 i=7 t=1.0e-02 per=1.2e+01 cost=6.5e+06 flops=6.4e+08
 sigma_tot[gemm] counter=60 total t=4.2e-02 per=4.8e+01 cost=2.6e+07 flops=6.3e+08
 sigma_tot[red] counter=60 t=3.7e-02 per=4.3e+01 cost=5.9e+06 flops=1.6e+08
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.6e-06,2.2e-05,3.7e-06,2.5e-06,3.3e-07
    3   0 -    -116.266390591391 -1.969e-03  9.422e-03    3     3  7.026e-03 2.342e-03 2.260e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.928e-05,1.777e-04,1.093e-03,6.909e-04,2.047e-03
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.489e-05 speed=6.825e-02GB/S T(nccl)=5.439e-05 speed=3.123e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.1e-03 t_reduction=6.9e-04 tot=2.0e-03 -----
 sigma[inter] counter=61 t=1.8e-04 per=9.1e+00 cost=4.4e+05 flops=2.5e+09
 sigma[gemm] counter=61 i=0 t=3.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=3.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=3.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=3 t=3.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=4 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.3e+08
 sigma[gemm] counter=61 i=5 t=2.9e-04 per=1.5e+01 cost=1.3e+05 flops=4.4e+08
 sigma[gemm] counter=61 i=6 t=2.8e-04 per=1.4e+01 cost=8.6e+04 flops=3.1e+08
 sigma[gemm] counter=61 i=7 t=2.8e-04 per=1.4e+01 cost=9.0e+04 flops=3.2e+08
 sigma[gemm] counter=61 total t=1.1e-03 per=5.6e+01 cost=4.3e+05 flops=3.9e+08
 sigma[red] counter=61 t=6.9e-04 per=3.5e+01 cost=1.0e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=8.1e-03 t_gemm=4.3e-02 t_reduction=3.8e-02 tot=8.9e-02 -----
 sigma_tot[inter] counter=61 t=8.1e-03 per=9.1e+00 cost=2.8e+07 flops=3.5e+09
 sigma_tot[gemm] counter=61 i=0 t=1.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=3 t=1.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=4 t=1.0e-02 per=1.1e+01 cost=6.7e+06 flops=6.6e+08
 sigma_tot[gemm] counter=61 i=5 t=1.1e-02 per=1.3e+01 cost=6.7e+06 flops=5.9e+08
 sigma_tot[gemm] counter=61 i=6 t=1.0e-02 per=1.2e+01 cost=6.5e+06 flops=6.3e+08
 sigma_tot[gemm] counter=61 i=7 t=1.0e-02 per=1.2e+01 cost=6.6e+06 flops=6.3e+08
 sigma_tot[gemm] counter=61 total t=4.3e-02 per=4.8e+01 cost=2.7e+07 flops=6.2e+08
 sigma_tot[red] counter=61 t=3.8e-02 per=4.3e+01 cost=6.0e+06 flops=1.6e+08
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,1.9e-05,3.1e-06,2.3e-06,2.4e-07
    4   0 -    -116.266651227099 -2.606e-04  4.244e-03    3     4  9.534e-03 2.383e-03 2.302e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.938e-05,1.743e-04,1.098e-03,6.837e-04,2.042e-03
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.575e-05 speed=6.597e-02GB/S T(nccl)=5.363e-05 speed=3.167e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.1e-03 t_reduction=6.8e-04 tot=2.0e-03 -----
 sigma[inter] counter=62 t=1.7e-04 per=8.9e+00 cost=4.4e+05 flops=2.5e+09
 sigma[gemm] counter=62 i=0 t=3.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=3.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=3.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=3 t=3.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=4 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.3e+08
 sigma[gemm] counter=62 i=5 t=3.0e-04 per=1.5e+01 cost=1.3e+05 flops=4.3e+08
 sigma[gemm] counter=62 i=6 t=2.7e-04 per=1.4e+01 cost=8.6e+04 flops=3.2e+08
 sigma[gemm] counter=62 i=7 t=2.8e-04 per=1.4e+01 cost=9.0e+04 flops=3.3e+08
 sigma[gemm] counter=62 total t=1.1e-03 per=5.6e+01 cost=4.3e+05 flops=3.9e+08
 sigma[red] counter=62 t=6.8e-04 per=3.5e+01 cost=1.0e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=8.3e-03 t_gemm=4.4e-02 t_reduction=3.9e-02 tot=9.1e-02 -----
 sigma_tot[inter] counter=62 t=8.3e-03 per=9.1e+00 cost=2.9e+07 flops=3.5e+09
 sigma_tot[gemm] counter=62 i=0 t=1.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=3 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=4 t=1.0e-02 per=1.1e+01 cost=6.8e+06 flops=6.5e+08
 sigma_tot[gemm] counter=62 i=5 t=1.2e-02 per=1.3e+01 cost=6.9e+06 flops=5.9e+08
 sigma_tot[gemm] counter=62 i=6 t=1.1e-02 per=1.2e+01 cost=6.6e+06 flops=6.2e+08
 sigma_tot[gemm] counter=62 i=7 t=1.1e-02 per=1.2e+01 cost=6.7e+06 flops=6.3e+08
 sigma_tot[gemm] counter=62 total t=4.4e-02 per=4.8e+01 cost=2.7e+07 flops=6.1e+08
 sigma_tot[red] counter=62 t=3.9e-02 per=4.3e+01 cost=6.1e+06 flops=1.6e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.5e-06,1.7e-05,3.1e-06,2.2e-06,2.4e-07
    5   0 -    -116.266697415709 -4.619e-05  1.196e-03    3     5  1.203e-02 2.406e-03 2.325e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.919e-05,1.787e-04,1.089e-03,6.726e-04,2.025e-03
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.527e-05 speed=6.721e-02GB/S T(nccl)=5.391e-05 speed=3.151e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.1e-03 t_reduction=6.7e-04 tot=1.9e-03 -----
 sigma[inter] counter=63 t=1.8e-04 per=9.2e+00 cost=4.4e+05 flops=2.5e+09
 sigma[gemm] counter=63 i=0 t=3.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=3.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=3.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=3 t=3.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=4 t=2.4e-04 per=1.2e+01 cost=1.2e+05 flops=5.3e+08
 sigma[gemm] counter=63 i=5 t=2.9e-04 per=1.5e+01 cost=1.3e+05 flops=4.5e+08
 sigma[gemm] counter=63 i=6 t=2.7e-04 per=1.4e+01 cost=8.6e+04 flops=3.2e+08
 sigma[gemm] counter=63 i=7 t=2.8e-04 per=1.5e+01 cost=9.0e+04 flops=3.2e+08
 sigma[gemm] counter=63 total t=1.1e-03 per=5.6e+01 cost=4.3e+05 flops=4.0e+08
 sigma[red] counter=63 t=6.7e-04 per=3.5e+01 cost=1.0e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=8.5e-03 t_gemm=4.5e-02 t_reduction=3.9e-02 tot=9.3e-02 -----
 sigma_tot[inter] counter=63 t=8.5e-03 per=9.1e+00 cost=2.9e+07 flops=3.4e+09
 sigma_tot[gemm] counter=63 i=0 t=1.5e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=3 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=4 t=1.1e-02 per=1.1e+01 cost=6.9e+06 flops=6.5e+08
 sigma_tot[gemm] counter=63 i=5 t=1.2e-02 per=1.3e+01 cost=7.0e+06 flops=5.9e+08
 sigma_tot[gemm] counter=63 i=6 t=1.1e-02 per=1.2e+01 cost=6.7e+06 flops=6.1e+08
 sigma_tot[gemm] counter=63 i=7 t=1.1e-02 per=1.2e+01 cost=6.8e+06 flops=6.2e+08
 sigma_tot[gemm] counter=63 total t=4.5e-02 per=4.8e+01 cost=2.7e+07 flops=6.1e+08
 sigma_tot[red] counter=63 t=3.9e-02 per=4.2e+01 cost=6.2e+06 flops=1.6e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,1.8e-05,3.0e-06,2.1e-06,2.9e-07
    6   0 -    -116.266700925753 -3.510e-06  3.469e-04    3     6  1.451e-02 2.418e-03 2.338e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.390e-05,1.679e-04,8.513e-04,5.118e-04,1.611e-03
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.258e-05 speed=7.522e-02GB/S T(nccl)=5.131e-05 speed=3.311e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.5e-04 t_reduction=5.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=64 t=1.7e-04 per=1.1e+01 cost=4.4e+05 flops=2.6e+09
 sigma[gemm] counter=64 i=0 t=3.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=3.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=3.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=3 t=3.1e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=4 t=2.0e-04 per=1.3e+01 cost=1.2e+05 flops=6.3e+08
 sigma[gemm] counter=64 i=5 t=2.2e-04 per=1.5e+01 cost=1.3e+05 flops=5.8e+08
 sigma[gemm] counter=64 i=6 t=2.1e-04 per=1.4e+01 cost=8.6e+04 flops=4.2e+08
 sigma[gemm] counter=64 i=7 t=2.1e-04 per=1.4e+01 cost=9.0e+04 flops=4.4e+08
 sigma[gemm] counter=64 total t=8.5e-04 per=5.6e+01 cost=4.3e+05 flops=5.1e+08
 sigma[red] counter=64 t=5.1e-04 per=3.3e+01 cost=1.0e+05 flops=2.0e+08
----- TIMING FOR sigma_tot : t_inter=8.7e-03 t_gemm=4.6e-02 t_reduction=4.0e-02 tot=9.4e-02 -----
 sigma_tot[inter] counter=64 t=8.7e-03 per=9.2e+00 cost=3.0e+07 flops=3.4e+09
 sigma_tot[gemm] counter=64 i=0 t=1.5e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=3 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=4 t=1.1e-02 per=1.1e+01 cost=7.1e+06 flops=6.5e+08
 sigma_tot[gemm] counter=64 i=5 t=1.2e-02 per=1.3e+01 cost=7.1e+06 flops=5.9e+08
 sigma_tot[gemm] counter=64 i=6 t=1.1e-02 per=1.2e+01 cost=6.8e+06 flops=6.1e+08
 sigma_tot[gemm] counter=64 i=7 t=1.1e-02 per=1.2e+01 cost=6.9e+06 flops=6.1e+08
 sigma_tot[gemm] counter=64 total t=4.6e-02 per=4.9e+01 cost=2.8e+07 flops=6.1e+08
 sigma_tot[red] counter=64 t=4.0e-02 per=4.2e+01 cost=6.3e+06 flops=1.6e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.3e-05,2.4e-06,1.5e-06,2.0e-07
    7   0 +    -116.266701220275 -2.945e-07  9.912e-05    3     7  1.642e-02 2.346e-03 2.268e-03
TIMING FOR Davidson : 1.644e-02  T(cal/comm/rest)=1.588e-02,3.028e-06,5.609e-04
decomposed t_rest=5.609e-04
 T(sub)    =1.960e-04 per=3.493e+01
 T(precond)=2.906e-05 per=5.180e+00
 T(ortho)  =1.662e-05 per=2.963e+00
 T(xcopy)  =1.337e-06 per=2.384e-01
 T(xnrm2)  =2.069e-06 per=3.689e-01
 T(other)  =3.159e-04 per=5.631e+01
optimized energies: isweep=0 ibond=9 dots=2 e[0]=-116.266701220275 nmvp=7
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=3.532e-03 change=2.574e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=12 dimAll=40
 (15,1):5 (17,1):4 (16,0):4 (16,2):8 (15,3):5 (17,3):3 (16,4):5 (14,2):1 (14,4):1 (15,5):2 (17,5):1 (16,6):1
timing for divide=9.5e-06
timing for compute=8.3e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(su2): 1.0e-04 S T(divide/compute[cpu/gpu/rest]/collect)=9.5e-06,7.1e-05,0.0e+00,1.1e-05,1.2e-05 -----
decimation summary: 40->10 dwt=+1.232e-03 SvN=1.012e+00
 qbond: qkept nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
----- TIMING for decimation_row(nkr): 1.138e-03 S T(decim/select/formRot)=1.599e-04,9.456e-04,3.234e-05 -----
----- TIMING FOR twodot_decimation: 1.224e-03 S T(wf/decim)=7.578e-05,1.148e-03 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:11 S:5 H:1 P:40 Q:44 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=2530:1.930e-02MB:1.885e-05GB
        per(mem): C:6.96 S:3.16 H:1.34 P:1.58 Q:87 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=3.532e-03 change=1.490e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=96 : 4.925e-04 S -----
rank=0 GPUmem(GB): used=7.463e-05 (oper)=4.608e-05
rank=0 GPUmem(GB): used=7.508e-05 (oper,site)=4.608e-05,4.470e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=96
 no. of rintermediate operators=128
 no. of coefficients=1280:9.766e-03MB:9.537e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.816e-05 S -----
rank=0 GPUmem(GB): used=8.462e-05 (oper,site,rinter)=4.608e-05,4.470e-07,9.537e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.978e-03 S size(rtasks)=96 size(Rlst2)=16 T(Rmu/Rlist)=2.151e-04,2.763e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.256e-03 S size(rtasks)=96 size(Rlst)=2042 -----
rank=0 GPUmem(GB): used=8.462e-05 avail=3.829e+01 total=3.829e+01 batch[need]=5.629e-04 blksize=16 blksize0=4 batchsize=2042
rank=0 GPUmem(GB): used=6.475e-04 (oper,site,rinter,batch)=4.608e-05,4.470e-07,9.537e-06,5.629e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.140e-04,3.395e-04,1.435e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=3.4e-04 t_reduction=1.4e-04 tot=6.0e-04 -----
 renorm[inter] counter=133 t=1.1e-04 per=1.9e+01 cost=4.0e+04 flops=3.5e+08
 renorm[gemm] counter=133 i=0 t=2.1e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=133 i=1 t=1.8e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=133 i=2 t=1.8e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=133 i=3 t=1.8e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=133 i=4 t=9.4e-05 per=1.6e+01 cost=7.1e+03 flops=7.6e+07
 renorm[gemm] counter=133 i=5 t=1.3e-04 per=2.2e+01 cost=3.6e+04 flops=2.7e+08
 renorm[gemm] counter=133 i=6 t=1.0e-04 per=1.7e+01 cost=9.6e+04 flops=9.3e+08
 renorm[gemm] counter=133 total t=3.4e-04 per=5.7e+01 cost=1.4e+05 flops=4.1e+08
 renorm[red] counter=133 t=1.4e-04 per=2.4e+01 cost=4.4e+04 flops=3.1e+08
----- TIMING FOR renorm_tot : t_inter=9.3e-04 t_gemm=3.4e-03 t_reduction=1.4e-03 tot=5.8e-03 -----
 renorm_tot[inter] counter=133 t=9.3e-04 per=1.6e+01 cost=1.5e+05 flops=1.6e+08
 renorm_tot[gemm] counter=133 i=0 t=2.1e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=133 i=1 t=1.9e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=133 i=2 t=1.9e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=133 i=3 t=1.9e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=133 i=4 t=1.0e-03 per=1.8e+01 cost=2.4e+04 flops=2.2e+07
 renorm_tot[gemm] counter=133 i=5 t=1.2e-03 per=2.1e+01 cost=1.5e+05 flops=1.3e+08
 renorm_tot[gemm] counter=133 i=6 t=1.1e-03 per=1.9e+01 cost=2.8e+05 flops=2.5e+08
 renorm_tot[gemm] counter=133 total t=3.4e-03 per=5.9e+01 cost=4.5e+05 flops=1.3e+08
 renorm_tot[red] counter=133 t=1.4e-03 per=2.5e+01 cost=1.1e+05 flops=7.9e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=8.541e-05 (oper)=4.620e-05
rank=0 GPUmem(GB): used=8.585e-05 (oper,site,rinter)=4.620e-05,4.470e-07,1.118e-06
rank=0 GPUmem(GB): used=9.909e-05 (oper,site,rinter,batch)=4.620e-05,4.470e-07,1.118e-06,1.323e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.897e-03 S T(preprocess/alloc/comp/red/dealloc)=6.060e-04,6.586e-04,1.987e-03,1.759e-04,5.917e-05 -----
----- TIMING FOR oper_renorm_opS : 2.920e-03 S rank=0 -----
qops.to_cpu: size(tot)=2530:1.930e-02MB:1.885e-05GB T(to_cpu)=4.250e-05S speed=4.435e-01GB/S
check ||H-H.dagger||=8.141e-15 coord=(10,0) rank=0
----- TIMING FOR oper_renorm : 0.00922 S rank=0 -----
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=4.158e-03 change=6.403e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=4.601e-03 change=-1.772e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=4.601e-03 change=-3.546e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 6.404e-02 S #####
 T(local opt: fetch) = 2.541e-03 S  per = 3.97  per(accum) = 3.97
 T(local opt: hdiag) = 4.510e-03 S  per = 7.04  per(accum) = 11
 T(local opt: dvdsn) = 4.363e-02 S  per = 68.1  per(accum) = 79.1
 T(local opt: decim) = 1.264e-03 S  per = 1.97  per(accum) = 81.1
 T(local opt: guess) = 8.662e-05 S  per = 0.135  per(accum) = 81.2
 T(local opt: renrm) = 1.012e-02 S  per = 15.8  per(accum) = 97
 T(local opt: save ) = 1.892e-03 S  per = 2.95  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.363e-02 S  T(sum) = 4.297e-02 S  per = 9.849e+01
 T(local opt: preprocess                  ) = 2.235e-04 S  per = 0.52  per(accum) = 0.52
 T(local opt: symbolic_formulae           ) = 7.540e-04 S  per = 1.75  per(accum) = 2.27
 T(local opt: hintermediate init          ) = 6.195e-05 S  per = 0.144  per(accum) = 2.42
 T(local opt: preprocess_hformulae_Hxlist ) = 1.964e-02 S  per = 45.7  per(accum) = 48.1
 T(local opt: hmmtasks init               ) = 5.674e-03 S  per = 13.2  per(accum) = 61.3
 T(local opt: initial guess for dvdson    ) = 1.796e-04 S  per = 0.418  per(accum) = 61.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.532e-02 S  per = 35.6  per(accum) = 97.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.771e-04 S  per = 0.412  per(accum) = 97.8
 T(local opt: dvdson [nccl]               ) = 3.827e-04 S  per = 0.891  per(accum) = 98.7
 T(local opt: dvdson [mpi]                ) = 3.028e-06 S  per = 0.00705  per(accum) = 98.7
 T(local opt: dvdson [rest part(linalg)]  ) = 5.609e-04 S  per = 1.31  per(accum) = 100
Detailed decomposition of T(renrm) = 1.012e-02 S  T(sum) = 1.012e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.242e-05 S  per = 0.617  per(accum) = 0.617
 T(local opt: qops init                    ) = 4.531e-04 S  per = 4.48  per(accum) = 5.09
 T(local opt: symbolic_formulae_renorm     ) = 5.065e-04 S  per =    5  per(accum) = 10.1
 T(local opt: allocate qops on gpu         ) = 6.675e-05 S  per = 0.659  per(accum) = 10.8
 T(local opt: site memcpy cpu2gpu          ) = 2.975e-05 S  per = 0.294  per(accum) = 11
 T(local opt: rintermediate init           ) = 8.533e-05 S  per = 0.843  per(accum) = 11.9
 T(local opt: preprocess_formulae_Rlist2   ) = 3.274e-03 S  per = 32.3  per(accum) = 44.2
 T(local opt: rmmtasks init                ) = 9.824e-04 S  per =  9.7  per(accum) = 53.9
 T(local opt: qops memset on cpu           ) = 8.800e-08 S  per = 0.000869  per(accum) = 53.9
 T(local opt: preprocess_renorm_batchGPU   ) = 7.655e-04 S  per = 7.56  per(accum) = 61.5
 T(local opt: deallocate cpu and gpu memory) = 4.590e-05 S  per = 0.453  per(accum) = 62
 T(local opt: construct opS [ifdists=true] ) = 2.934e-03 S  per =   29  per(accum) = 90.9
 T(local opt: reduction of opS & opH [nccl]) = 1.806e-05 S  per = 0.178  per(accum) = 91.1
 T(local opt: qops memcpy gpu2cpu          ) = 5.207e-05 S  per = 0.514  per(accum) = 91.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.120e-05 S  per = 0.111  per(accum) = 91.7
 T(local opt: qops_pool join and erase     ) = 8.313e-04 S  per = 8.21  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.304e-06 S  per = 0.0425  per(accum) = 100
ctns::rcanon_save_site idx=9 scratch=./scratch/sweep size=60:4.5e-07GB T(load)=0.00058S speed=0.00077GB/S
##### sweep opt: 5.032e-01 S #####
 T(sweep opt: fetch) = 2.816e-02 S  per =  5.6  per(accum) = 5.6
 T(sweep opt: hdiag) = 2.788e-02 S  per = 5.54  per(accum) = 11.1
 T(sweep opt: dvdsn) = 3.209e-01 S  per = 63.8  per(accum) = 74.9
 T(sweep opt: decim) = 1.149e-02 S  per = 2.28  per(accum) = 77.2
 T(sweep opt: guess) = 9.768e-04 S  per = 0.194  per(accum) = 77.4
 T(sweep opt: renrm) = 9.544e-02 S  per =   19  per(accum) = 96.4
 T(sweep opt: save ) = 1.835e-02 S  per = 3.65  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.209e-01 S  T(sum) = 3.160e-01 S  per = 9.846e+01
 T(sweep opt: preprocess                  ) = 3.594e-03 S  per = 1.14  per(accum) = 1.14
 T(sweep opt: symbolic_formulae           ) = 5.367e-03 S  per =  1.7  per(accum) = 2.84
 T(sweep opt: hintermediate init          ) = 7.515e-04 S  per = 0.238  per(accum) = 3.07
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.569e-01 S  per = 49.7  per(accum) = 52.7
 T(sweep opt: hmmtasks init               ) = 3.033e-02 S  per =  9.6  per(accum) = 62.3
 T(sweep opt: initial guess for dvdson    ) = 1.582e-03 S  per = 0.501  per(accum) = 62.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.086e-01 S  per = 34.4  per(accum) = 97.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.446e-03 S  per = 0.458  per(accum) = 97.7
 T(sweep opt: dvdson [nccl]               ) = 3.658e-03 S  per = 1.16  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 2.854e-05 S  per = 0.00903  per(accum) = 98.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.693e-03 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm) = 9.544e-02 S  T(sum) = 9.544e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.440e-04 S  per = 0.57  per(accum) = 0.57
 T(sweep opt: qops init                    ) = 3.550e-03 S  per = 3.72  per(accum) = 4.29
 T(sweep opt: symbolic_formulae_renorm     ) = 1.550e-03 S  per = 1.62  per(accum) = 5.91
 T(sweep opt: allocate qops on gpu         ) = 5.574e-04 S  per = 0.584  per(accum) = 6.5
 T(sweep opt: site memcpy cpu2gpu          ) = 2.501e-04 S  per = 0.262  per(accum) = 6.76
 T(sweep opt: rintermediate init           ) = 4.565e-04 S  per = 0.478  per(accum) = 7.24
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.114e-02 S  per = 11.7  per(accum) = 18.9
 T(sweep opt: rmmtasks init                ) = 3.498e-03 S  per = 3.66  per(accum) = 22.6
 T(sweep opt: qops memset on cpu           ) = 4.520e-07 S  per = 0.000474  per(accum) = 22.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.185e-03 S  per = 7.53  per(accum) = 30.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.979e-04 S  per = 0.312  per(accum) = 30.4
 T(sweep opt: construct opS [ifdists=true] ) = 5.492e-02 S  per = 57.5  per(accum) = 88
 T(sweep opt: reduction of opS & opH [nccl]) = 1.863e-04 S  per = 0.195  per(accum) = 88.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.473e-04 S  per = 0.364  per(accum) = 88.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 9.539e-05 S  per =  0.1  per(accum) = 88.6
 T(sweep opt: qops_pool join and erase     ) = 8.100e-03 S  per = 8.49  per(accum) = 97.1
 T(sweep opt: conversion from opAB to opPQ ) = 2.765e-03 S  per =  2.9  per(accum) = 100
##### global opt: 5.032e-01 S #####
 T(global opt: fetch) = 2.816e-02 S  per =  5.6  per(accum) = 5.6
 T(global opt: hdiag) = 2.788e-02 S  per = 5.54  per(accum) = 11.1
 T(global opt: dvdsn) = 3.209e-01 S  per = 63.8  per(accum) = 74.9
 T(global opt: decim) = 1.149e-02 S  per = 2.28  per(accum) = 77.2
 T(global opt: guess) = 9.768e-04 S  per = 0.194  per(accum) = 77.4
 T(global opt: renrm) = 9.544e-02 S  per =   19  per(accum) = 96.4
 T(global opt: save ) = 1.835e-02 S  per = 3.65  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.209e-01 S  T(sum) = 3.160e-01 S  per = 9.846e+01
 T(global opt: preprocess                  ) = 3.594e-03 S  per = 1.14  per(accum) = 1.14
 T(global opt: symbolic_formulae           ) = 5.367e-03 S  per =  1.7  per(accum) = 2.84
 T(global opt: hintermediate init          ) = 7.515e-04 S  per = 0.238  per(accum) = 3.07
 T(global opt: preprocess_hformulae_Hxlist ) = 1.569e-01 S  per = 49.7  per(accum) = 52.7
 T(global opt: hmmtasks init               ) = 3.033e-02 S  per =  9.6  per(accum) = 62.3
 T(global opt: initial guess for dvdson    ) = 1.582e-03 S  per = 0.501  per(accum) = 62.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.086e-01 S  per = 34.4  per(accum) = 97.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.446e-03 S  per = 0.458  per(accum) = 97.7
 T(global opt: dvdson [nccl]               ) = 3.658e-03 S  per = 1.16  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 2.854e-05 S  per = 0.00903  per(accum) = 98.8
 T(global opt: dvdson [rest part(linalg)]  ) = 3.693e-03 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm) = 9.544e-02 S  T(sum) = 9.544e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.440e-04 S  per = 0.57  per(accum) = 0.57
 T(global opt: qops init                    ) = 3.550e-03 S  per = 3.72  per(accum) = 4.29
 T(global opt: symbolic_formulae_renorm     ) = 1.550e-03 S  per = 1.62  per(accum) = 5.91
 T(global opt: allocate qops on gpu         ) = 5.574e-04 S  per = 0.584  per(accum) = 6.5
 T(global opt: site memcpy cpu2gpu          ) = 2.501e-04 S  per = 0.262  per(accum) = 6.76
 T(global opt: rintermediate init           ) = 4.565e-04 S  per = 0.478  per(accum) = 7.24
 T(global opt: preprocess_formulae_Rlist2   ) = 1.114e-02 S  per = 11.7  per(accum) = 18.9
 T(global opt: rmmtasks init                ) = 3.498e-03 S  per = 3.66  per(accum) = 22.6
 T(global opt: qops memset on cpu           ) = 4.520e-07 S  per = 0.000474  per(accum) = 22.6
 T(global opt: preprocess_renorm_batchGPU   ) = 7.185e-03 S  per = 7.53  per(accum) = 30.1
 T(global opt: deallocate cpu and gpu memory) = 2.979e-04 S  per = 0.312  per(accum) = 30.4
 T(global opt: construct opS [ifdists=true] ) = 5.492e-02 S  per = 57.5  per(accum) = 88
 T(global opt: reduction of opS & opH [nccl]) = 1.863e-04 S  per = 0.195  per(accum) = 88.2
 T(global opt: qops memcpy gpu2cpu          ) = 3.473e-04 S  per = 0.364  per(accum) = 88.5
 T(global opt: reduction of opS & opH [mpi] ) = 9.539e-05 S  per =  0.1  per(accum) = 88.6
 T(global opt: qops_pool join and erase     ) = 8.100e-03 S  per = 8.49  per(accum) = 97.1
 T(global opt: conversion from opAB to opPQ ) = 2.765e-03 S  per =  2.9  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-2.580e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=10/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=7 scratch=./scratch/sweep size=28:2.09e-07GB T(load)=3.44e-04S speed=6.07e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=70:5.34e-04MB:5.22e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=50:3.81e-04MB:3.73e-07GB
total mem of comb=121:9.23e-04MB:9.02e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=2.906e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:11 S:5 H:1 P:40 Q:44 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=2530:1.930e-02MB:1.885e-05GB
        per(mem): C:6.96 S:3.16 H:1.34 P:1.58 Q:87 
 rqops: oplist=CSHAB nops=C:7 S:6 H:1 A:23 B:28 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=564:0.0043MB:4.2e-06GB
        per(mem): C:9.93 S:8.51 H:2.13 A:0 B:79.4 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5090:0.0388MB:3.79e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.699e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-3.874e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,6,3,3) nnz=66:5.035e-04MB
qtensor4: wf4 own=1 _data=0x5585ee574fc0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
 qbond: qcol nsym=3 dimAll=6
 (10,2):2 (10,4):2 (11,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=192 size=66:5.035e-04MB
### DIAG TIMING: total=2.648e-03 t1=1.569e-05, t2=1.532e-05, t3=1.658e-05, t4=2.552e-03, t5=5.833e-06, t6=3.657e-05, t7=6.112e-06
duration_diagGPU:2.664e-03
duration_diagreduce:3.200e-08
duration_diagtransform:2.370e-07
----- TIMING FOR symbolic_formulae_twodot with size=398 : 6.693e-04 S -----
rank=0 GPUmem(GB): used=3.792e-05 (oper)=3.792e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=398
 no. of hintermediate operators=212
 no. of coefficients=2490:1.900e-02MB:1.855e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.504e-05 S -----
rank=0 GPUmem(GB): used=5.648e-05 (oper,hinter)=3.792e-05,1.855e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.315e-03 S size(H_formulae)=398 size(Hxlst2)=15 T(Hmu/Hxlist)=1.645e-04,9.150e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.858e-03 S size(H_formulae)=398 size(Hxlst)=5714 -----
rank=0 GPUmem(GB): used=5.648e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=9.835e-07 batch[need]=8.940e-04 blksize=8 blksize0=4 batchsize=5714
rank=0 GPUmem(GB): used=9.515e-04 (oper,hinter,dvdson,batch)=3.792e-05,1.855e-05,9.835e-07,8.940e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=66 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.682e-05,1.110e-04,3.662e-04,4.038e-04,9.653e-04
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.850e-05 speed=3.451e-02GB/S T(nccl)=4.832e-05 speed=2.035e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=3.7e-04 t_reduction=4.0e-04 tot=8.8e-04 -----
 sigma[inter] counter=65 t=1.1e-04 per=1.3e+01 cost=2.7e+05 flops=2.4e+09
 sigma[gemm] counter=65 i=0 t=1.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=1.6e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=3 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=4 t=8.0e-05 per=9.1e+00 cost=4.9e+04 flops=6.1e+08
 sigma[gemm] counter=65 i=5 t=1.2e-04 per=1.4e+01 cost=4.7e+04 flops=3.8e+08
 sigma[gemm] counter=65 i=6 t=8.0e-05 per=9.0e+00 cost=4.5e+04 flops=5.7e+08
 sigma[gemm] counter=65 i=7 t=7.5e-05 per=8.5e+00 cost=4.5e+04 flops=6.0e+08
 sigma[gemm] counter=65 total t=3.7e-04 per=4.2e+01 cost=1.9e+05 flops=5.1e+08
 sigma[red] counter=65 t=4.0e-04 per=4.6e+01 cost=5.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=8.8e-03 t_gemm=4.6e-02 t_reduction=4.0e-02 tot=9.5e-02 -----
 sigma_tot[inter] counter=65 t=8.8e-03 per=9.2e+00 cost=3.0e+07 flops=3.4e+09
 sigma_tot[gemm] counter=65 i=0 t=1.5e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=3 t=1.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=4 t=1.1e-02 per=1.1e+01 cost=7.1e+06 flops=6.5e+08
 sigma_tot[gemm] counter=65 i=5 t=1.2e-02 per=1.3e+01 cost=7.2e+06 flops=5.8e+08
 sigma_tot[gemm] counter=65 i=6 t=1.1e-02 per=1.2e+01 cost=6.8e+06 flops=6.1e+08
 sigma_tot[gemm] counter=65 i=7 t=1.1e-02 per=1.2e+01 cost=6.9e+06 flops=6.1e+08
 sigma_tot[gemm] counter=65 total t=4.6e-02 per=4.8e+01 cost=2.8e+07 flops=6.1e+08
 sigma_tot[red] counter=65 t=4.0e-02 per=4.2e+01 cost=6.4e+06 flops=1.6e+08
T(sub)=7.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,2.8e-06,9.7e-07,9.6e-07,2.4e-07
settings: ndim=66 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.265955787654 -1.116e+03  6.723e-02    1     1  1.263e-03 1.263e-03 1.238e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.495e-05,1.002e-04,3.907e-04,4.162e-04,9.764e-04
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.140e-05 speed=4.597e-02GB/S T(nccl)=4.356e-05 speed=2.258e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=3.9e-04 t_reduction=4.2e-04 tot=9.1e-04 -----
 sigma[inter] counter=66 t=1.0e-04 per=1.1e+01 cost=2.7e+05 flops=2.7e+09
 sigma[gemm] counter=66 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=3 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=4 t=8.3e-05 per=9.1e+00 cost=4.9e+04 flops=5.9e+08
 sigma[gemm] counter=66 i=5 t=1.3e-04 per=1.4e+01 cost=4.7e+04 flops=3.6e+08
 sigma[gemm] counter=66 i=6 t=8.6e-05 per=9.5e+00 cost=4.5e+04 flops=5.3e+08
 sigma[gemm] counter=66 i=7 t=8.4e-05 per=9.3e+00 cost=4.5e+04 flops=5.4e+08
 sigma[gemm] counter=66 total t=3.9e-04 per=4.3e+01 cost=1.9e+05 flops=4.8e+08
 sigma[red] counter=66 t=4.2e-04 per=4.6e+01 cost=5.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=8.9e-03 t_gemm=4.7e-02 t_reduction=4.1e-02 tot=9.6e-02 -----
 sigma_tot[inter] counter=66 t=8.9e-03 per=9.2e+00 cost=3.0e+07 flops=3.4e+09
 sigma_tot[gemm] counter=66 i=0 t=1.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=3 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=4 t=1.1e-02 per=1.1e+01 cost=7.2e+06 flops=6.5e+08
 sigma_tot[gemm] counter=66 i=5 t=1.2e-02 per=1.3e+01 cost=7.2e+06 flops=5.8e+08
 sigma_tot[gemm] counter=66 i=6 t=1.1e-02 per=1.2e+01 cost=6.9e+06 flops=6.1e+08
 sigma_tot[gemm] counter=66 i=7 t=1.1e-02 per=1.2e+01 cost=6.9e+06 flops=6.1e+08
 sigma_tot[gemm] counter=66 total t=4.7e-02 per=4.8e+01 cost=2.8e+07 flops=6.0e+08
 sigma_tot[red] counter=66 t=4.1e-02 per=4.2e+01 cost=6.4e+06 flops=1.6e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,2.6e-06,1.1e-06,2.0e-07
    2   0 -    -116.283268563121 -1.731e-02  1.917e-02    2     2  2.540e-03 1.270e-03 1.224e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.277e-05,9.012e-05,3.779e-04,4.122e-04,9.468e-04
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.076e-05 speed=4.736e-02GB/S T(nccl)=4.201e-05 speed=2.341e-02GB/S
----- TIMING FOR sigma : t_inter=9.0e-05 t_gemm=3.8e-04 t_reduction=4.1e-04 tot=8.8e-04 -----
 sigma[inter] counter=67 t=9.0e-05 per=1.0e+01 cost=2.7e+05 flops=3.0e+09
 sigma[gemm] counter=67 i=0 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=3 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=4 t=7.7e-05 per=8.7e+00 cost=4.9e+04 flops=6.4e+08
 sigma[gemm] counter=67 i=5 t=1.3e-04 per=1.4e+01 cost=4.7e+04 flops=3.7e+08
 sigma[gemm] counter=67 i=6 t=8.4e-05 per=9.5e+00 cost=4.5e+04 flops=5.4e+08
 sigma[gemm] counter=67 i=7 t=8.2e-05 per=9.4e+00 cost=4.5e+04 flops=5.5e+08
 sigma[gemm] counter=67 total t=3.8e-04 per=4.3e+01 cost=1.9e+05 flops=4.9e+08
 sigma[red] counter=67 t=4.1e-04 per=4.7e+01 cost=5.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=9.0e-03 t_gemm=4.7e-02 t_reduction=4.1e-02 tot=9.7e-02 -----
 sigma_tot[inter] counter=67 t=9.0e-03 per=9.2e+00 cost=3.1e+07 flops=3.4e+09
 sigma_tot[gemm] counter=67 i=0 t=1.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=3 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=4 t=1.1e-02 per=1.1e+01 cost=7.2e+06 flops=6.5e+08
 sigma_tot[gemm] counter=67 i=5 t=1.3e-02 per=1.3e+01 cost=7.3e+06 flops=5.8e+08
 sigma_tot[gemm] counter=67 i=6 t=1.1e-02 per=1.2e+01 cost=6.9e+06 flops=6.1e+08
 sigma_tot[gemm] counter=67 i=7 t=1.1e-02 per=1.2e+01 cost=7.0e+06 flops=6.1e+08
 sigma_tot[gemm] counter=67 total t=4.7e-02 per=4.8e+01 cost=2.8e+07 flops=6.0e+08
 sigma_tot[red] counter=67 t=4.1e-02 per=4.2e+01 cost=6.5e+06 flops=1.6e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,2.0e-06,1.2e-06,1.7e-07
    3   0 -    -116.284692016057 -1.423e-03  9.291e-03    3     3  3.742e-03 1.247e-03 1.197e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.360e-05,9.450e-05,3.815e-04,4.154e-04,9.586e-04
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.104e-05 speed=4.675e-02GB/S T(nccl)=4.256e-05 speed=2.311e-02GB/S
----- TIMING FOR sigma : t_inter=9.4e-05 t_gemm=3.8e-04 t_reduction=4.2e-04 tot=8.9e-04 -----
 sigma[inter] counter=68 t=9.4e-05 per=1.1e+01 cost=2.7e+05 flops=2.8e+09
 sigma[gemm] counter=68 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=3 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=4 t=8.1e-05 per=9.0e+00 cost=4.9e+04 flops=6.1e+08
 sigma[gemm] counter=68 i=5 t=1.3e-04 per=1.5e+01 cost=4.7e+04 flops=3.7e+08
 sigma[gemm] counter=68 i=6 t=8.3e-05 per=9.3e+00 cost=4.5e+04 flops=5.5e+08
 sigma[gemm] counter=68 i=7 t=8.1e-05 per=9.1e+00 cost=4.5e+04 flops=5.6e+08
 sigma[gemm] counter=68 total t=3.8e-04 per=4.3e+01 cost=1.9e+05 flops=4.9e+08
 sigma[red] counter=68 t=4.2e-04 per=4.7e+01 cost=5.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=9.1e-03 t_gemm=4.7e-02 t_reduction=4.2e-02 tot=9.8e-02 -----
 sigma_tot[inter] counter=68 t=9.1e-03 per=9.2e+00 cost=3.1e+07 flops=3.4e+09
 sigma_tot[gemm] counter=68 i=0 t=1.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=3 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=4 t=1.1e-02 per=1.1e+01 cost=7.3e+06 flops=6.5e+08
 sigma_tot[gemm] counter=68 i=5 t=1.3e-02 per=1.3e+01 cost=7.3e+06 flops=5.8e+08
 sigma_tot[gemm] counter=68 i=6 t=1.1e-02 per=1.2e+01 cost=6.9e+06 flops=6.1e+08
 sigma_tot[gemm] counter=68 i=7 t=1.1e-02 per=1.2e+01 cost=7.0e+06 flops=6.1e+08
 sigma_tot[gemm] counter=68 total t=4.7e-02 per=4.8e+01 cost=2.9e+07 flops=6.0e+08
 sigma_tot[red] counter=68 t=4.2e-02 per=4.2e+01 cost=6.5e+06 flops=1.6e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.1e-05,1.8e-06,1.1e-06,1.5e-07
    4   0 -    -116.284939065654 -2.470e-04  3.261e-03    3     4  4.943e-03 1.236e-03 1.187e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.358e-05,8.973e-05,3.749e-04,4.089e-04,9.410e-04
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.119e-05 speed=4.641e-02GB/S T(nccl)=4.238e-05 speed=2.320e-02GB/S
----- TIMING FOR sigma : t_inter=9.0e-05 t_gemm=3.7e-04 t_reduction=4.1e-04 tot=8.7e-04 -----
 sigma[inter] counter=69 t=9.0e-05 per=1.0e+01 cost=2.7e+05 flops=3.0e+09
 sigma[gemm] counter=69 i=0 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=3 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=4 t=7.7e-05 per=8.8e+00 cost=4.9e+04 flops=6.4e+08
 sigma[gemm] counter=69 i=5 t=1.3e-04 per=1.5e+01 cost=4.7e+04 flops=3.7e+08
 sigma[gemm] counter=69 i=6 t=8.4e-05 per=9.6e+00 cost=4.5e+04 flops=5.4e+08
 sigma[gemm] counter=69 i=7 t=7.9e-05 per=9.1e+00 cost=4.5e+04 flops=5.7e+08
 sigma[gemm] counter=69 total t=3.7e-04 per=4.3e+01 cost=1.9e+05 flops=5.0e+08
 sigma[red] counter=69 t=4.1e-04 per=4.7e+01 cost=5.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=9.2e-03 t_gemm=4.8e-02 t_reduction=4.2e-02 tot=9.9e-02 -----
 sigma_tot[inter] counter=69 t=9.2e-03 per=9.3e+00 cost=3.1e+07 flops=3.4e+09
 sigma_tot[gemm] counter=69 i=0 t=1.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=3 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=4 t=1.1e-02 per=1.1e+01 cost=7.3e+06 flops=6.5e+08
 sigma_tot[gemm] counter=69 i=5 t=1.3e-02 per=1.3e+01 cost=7.4e+06 flops=5.8e+08
 sigma_tot[gemm] counter=69 i=6 t=1.2e-02 per=1.2e+01 cost=7.0e+06 flops=6.1e+08
 sigma_tot[gemm] counter=69 i=7 t=1.2e-02 per=1.2e+01 cost=7.1e+06 flops=6.1e+08
 sigma_tot[gemm] counter=69 total t=4.8e-02 per=4.8e+01 cost=2.9e+07 flops=6.0e+08
 sigma_tot[red] counter=69 t=4.2e-02 per=4.2e+01 cost=6.6e+06 flops=1.6e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.1e-05,1.9e-06,1.1e-06,1.5e-07
    5   0 -    -116.284965677036 -2.661e-05  8.213e-04    3     5  6.140e-03 1.228e-03 1.177e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.308e-05,8.757e-05,3.751e-04,4.167e-04,9.461e-04
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.080e-05 speed=4.728e-02GB/S T(nccl)=4.228e-05 speed=2.326e-02GB/S
----- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=3.7e-04 t_reduction=4.2e-04 tot=8.8e-04 -----
 sigma[inter] counter=70 t=8.8e-05 per=1.0e+01 cost=2.7e+05 flops=3.1e+09
 sigma[gemm] counter=70 i=0 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=3 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=4 t=7.7e-05 per=8.8e+00 cost=4.9e+04 flops=6.3e+08
 sigma[gemm] counter=70 i=5 t=1.2e-04 per=1.4e+01 cost=4.7e+04 flops=3.8e+08
 sigma[gemm] counter=70 i=6 t=8.3e-05 per=9.5e+00 cost=4.5e+04 flops=5.4e+08
 sigma[gemm] counter=70 i=7 t=8.2e-05 per=9.4e+00 cost=4.5e+04 flops=5.5e+08
 sigma[gemm] counter=70 total t=3.7e-04 per=4.3e+01 cost=1.9e+05 flops=5.0e+08
 sigma[red] counter=70 t=4.2e-04 per=4.7e+01 cost=5.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=9.2e-03 t_gemm=4.8e-02 t_reduction=4.2e-02 tot=1.0e-01 -----
 sigma_tot[inter] counter=70 t=9.2e-03 per=9.3e+00 cost=3.1e+07 flops=3.4e+09
 sigma_tot[gemm] counter=70 i=0 t=1.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=3 t=1.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=4 t=1.1e-02 per=1.1e+01 cost=7.4e+06 flops=6.5e+08
 sigma_tot[gemm] counter=70 i=5 t=1.3e-02 per=1.3e+01 cost=7.4e+06 flops=5.7e+08
 sigma_tot[gemm] counter=70 i=6 t=1.2e-02 per=1.2e+01 cost=7.0e+06 flops=6.1e+08
 sigma_tot[gemm] counter=70 i=7 t=1.2e-02 per=1.2e+01 cost=7.1e+06 flops=6.1e+08
 sigma_tot[gemm] counter=70 total t=4.8e-02 per=4.8e+01 cost=2.9e+07 flops=6.0e+08
 sigma_tot[red] counter=70 t=4.2e-02 per=4.3e+01 cost=6.6e+06 flops=1.6e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.1e-05,1.9e-06,1.0e-06,1.4e-07
    6   0 -    -116.284967142752 -1.466e-06  2.087e-04    3     6  7.330e-03 1.222e-03 1.172e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.300e-05,9.041e-05,3.765e-04,4.125e-04,9.459e-04
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.117e-05 speed=4.645e-02GB/S T(nccl)=4.183e-05 speed=2.351e-02GB/S
----- TIMING FOR sigma : t_inter=9.0e-05 t_gemm=3.8e-04 t_reduction=4.1e-04 tot=8.8e-04 -----
 sigma[inter] counter=71 t=9.0e-05 per=1.0e+01 cost=2.7e+05 flops=3.0e+09
 sigma[gemm] counter=71 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=3 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=4 t=7.9e-05 per=9.0e+00 cost=4.9e+04 flops=6.2e+08
 sigma[gemm] counter=71 i=5 t=1.3e-04 per=1.4e+01 cost=4.7e+04 flops=3.7e+08
 sigma[gemm] counter=71 i=6 t=8.0e-05 per=9.1e+00 cost=4.5e+04 flops=5.6e+08
 sigma[gemm] counter=71 i=7 t=8.3e-05 per=9.4e+00 cost=4.5e+04 flops=5.5e+08
 sigma[gemm] counter=71 total t=3.8e-04 per=4.3e+01 cost=1.9e+05 flops=5.0e+08
 sigma[red] counter=71 t=4.1e-04 per=4.7e+01 cost=5.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=9.3e-03 t_gemm=4.8e-02 t_reduction=4.3e-02 tot=1.0e-01 -----
 sigma_tot[inter] counter=71 t=9.3e-03 per=9.3e+00 cost=3.2e+07 flops=3.4e+09
 sigma_tot[gemm] counter=71 i=0 t=1.7e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=3 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=4 t=1.1e-02 per=1.1e+01 cost=7.4e+06 flops=6.5e+08
 sigma_tot[gemm] counter=71 i=5 t=1.3e-02 per=1.3e+01 cost=7.5e+06 flops=5.7e+08
 sigma_tot[gemm] counter=71 i=6 t=1.2e-02 per=1.2e+01 cost=7.1e+06 flops=6.1e+08
 sigma_tot[gemm] counter=71 i=7 t=1.2e-02 per=1.2e+01 cost=7.2e+06 flops=6.1e+08
 sigma_tot[gemm] counter=71 total t=4.8e-02 per=4.8e+01 cost=2.9e+07 flops=6.0e+08
 sigma_tot[red] counter=71 t=4.3e-02 per=4.3e+01 cost=6.7e+06 flops=1.6e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.1e-05,1.8e-06,1.0e-06,1.4e-07
    7   0 +    -116.284967260831 -1.181e-07  7.495e-05    3     7  8.507e-03 1.215e-03 1.167e-03
TIMING FOR Davidson : 8.518e-03  T(cal/comm/rest)=8.169e-03,1.856e-06,3.476e-04
decomposed t_rest=3.476e-04
 T(sub)    =1.211e-04 per=3.483e+01
 T(precond)=1.764e-05 per=5.076e+00
 T(ortho)  =9.125e-06 per=2.625e+00
 T(xcopy)  =9.000e-07 per=2.589e-01
 T(xnrm2)  =1.178e-06 per=3.389e-01
 T(other)  =1.976e-04 per=5.687e+01
optimized energies: isweep=0 ibond=10 dots=2 e[0]=-116.284967260831 nmvp=7
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.129e-03 change=1.690e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=9 dimAll=40
 (16,2):5 (18,2):5 (17,1):4 (17,3):10 (16,4):5 (18,4):5 (17,5):4 (15,3):1 (19,3):1
timing for divide=5.4e-06
timing for compute=3.7e-05
timing for collect=4.3e-06
----- TMING FOR decimation_genbasis(su2): 4.6e-05 S T(divide/compute[cpu/gpu/rest]/collect)=5.4e-06,3.4e-05,0.0e+00,2.3e-06,4.3e-06 -----
decimation summary: 40->10 dwt=+7.393e-07 SvN=7.321e-01
 qbond: qkept nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
----- TIMING for decimation_row(nkr): 9.347e-04 S T(decim/select/formRot)=6.600e-05,8.553e-04,1.337e-05 -----
----- TIMING FOR twodot_decimation: 9.852e-04 S T(wf/decim)=4.458e-05,9.407e-04 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:12 S:4 H:1 P:28 Q:40 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=2102:1.604e-02MB:1.566e-05GB
        per(mem): C:12 S:4 H:1.43 P:2.66 Q:79.9 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.129e-03 change=1.277e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=81 : 3.411e-04 S -----
rank=0 GPUmem(GB): used=6.793e-05 (oper)=4.195e-05
rank=0 GPUmem(GB): used=6.835e-05 (oper,site)=4.195e-05,4.172e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=81
 no. of rintermediate operators=108
 no. of coefficients=1188:9.064e-03MB:8.851e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.186e-05 S -----
rank=0 GPUmem(GB): used=7.720e-05 (oper,site,rinter)=4.195e-05,4.172e-07,8.851e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.885e-03 S size(rtasks)=81 size(Rlst2)=16 T(Rmu/Rlist)=1.223e-04,1.763e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.074e-03 S size(rtasks)=81 size(Rlst)=1632 -----
rank=0 GPUmem(GB): used=7.720e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.499e-04 blksize=16 blksize0=4 batchsize=1632
rank=0 GPUmem(GB): used=5.271e-04 (oper,site,rinter,batch)=4.195e-05,4.172e-07,8.851e-06,4.499e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.003e-04,4.510e-04,1.626e-04
----- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=4.5e-04 t_reduction=1.6e-04 tot=7.1e-04 -----
 renorm[inter] counter=142 t=1.0e-04 per=1.4e+01 cost=5.4e+04 flops=5.4e+08
 renorm[gemm] counter=142 i=0 t=2.0e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=142 i=1 t=1.9e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=142 i=2 t=1.9e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=142 i=3 t=1.8e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=142 i=4 t=1.5e-04 per=2.1e+01 cost=7.7e+03 flops=5.3e+07
 renorm[gemm] counter=142 i=5 t=1.3e-04 per=1.8e+01 cost=3.1e+04 flops=2.5e+08
 renorm[gemm] counter=142 i=6 t=1.7e-04 per=2.4e+01 cost=5.8e+04 flops=3.4e+08
 renorm[gemm] counter=142 total t=4.5e-04 per=6.3e+01 cost=9.7e+04 flops=2.1e+08
 renorm[red] counter=142 t=1.6e-04 per=2.3e+01 cost=2.4e+04 flops=1.5e+08
----- TIMING FOR renorm_tot : t_inter=1.0e-03 t_gemm=3.9e-03 t_reduction=1.6e-03 tot=6.5e-03 -----
 renorm_tot[inter] counter=142 t=1.0e-03 per=1.6e+01 cost=2.0e+05 flops=2.0e+08
 renorm_tot[gemm] counter=142 i=0 t=2.3e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=142 i=1 t=2.1e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=142 i=2 t=2.1e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=142 i=3 t=2.1e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=142 i=4 t=1.2e-03 per=1.8e+01 cost=3.1e+04 flops=2.6e+07
 renorm_tot[gemm] counter=142 i=5 t=1.3e-03 per=2.0e+01 cost=1.8e+05 flops=1.4e+08
 renorm_tot[gemm] counter=142 i=6 t=1.3e-03 per=1.9e+01 cost=3.3e+05 flops=2.7e+08
 renorm_tot[gemm] counter=142 total t=3.9e-03 per=5.9e+01 cost=5.5e+05 flops=1.4e+08
 renorm_tot[red] counter=142 t=1.6e-03 per=2.5e+01 cost=1.4e+05 flops=8.6e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.793e-05 (oper)=4.210e-05
rank=0 GPUmem(GB): used=7.834e-05 (oper,site,rinter)=4.210e-05,4.172e-07,9.835e-07
rank=0 GPUmem(GB): used=8.716e-05 (oper,site,rinter,batch)=4.210e-05,4.172e-07,9.835e-07,8.821e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.507e-03 S T(preprocess/alloc/comp/red/dealloc)=4.333e-04,4.697e-04,1.816e-03,1.553e-04,5.147e-05 -----
----- TIMING FOR oper_renorm_opS : 2.520e-03 S rank=0 -----
qops.to_cpu: size(tot)=2102:1.604e-02MB:1.566e-05GB T(to_cpu)=3.531e-05S speed=4.436e-01GB/S
check ||H-H.dagger||=9.492e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.00696 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.808e-03 change=5.352e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=3.777e-03 change=-1.546e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=3.777e-03 change=-2.801e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 3.820e-02 S #####
 T(local opt: fetch) = 2.432e-03 S  per = 6.37  per(accum) = 6.37
 T(local opt: hdiag) = 2.745e-03 S  per = 7.19  per(accum) = 13.6
 T(local opt: dvdsn) = 2.240e-02 S  per = 58.6  per(accum) = 72.2
 T(local opt: decim) = 1.013e-03 S  per = 2.65  per(accum) = 74.9
 T(local opt: guess) = 5.625e-05 S  per = 0.147  per(accum) = 75
 T(local opt: renrm) = 7.714e-03 S  per = 20.2  per(accum) = 95.2
 T(local opt: save ) = 1.835e-03 S  per =  4.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.240e-02 S  T(sum) = 2.217e-02 S  per = 9.895e+01
 T(local opt: preprocess                  ) = 1.879e-04 S  per = 0.848  per(accum) = 0.848
 T(local opt: symbolic_formulae           ) = 6.827e-04 S  per = 3.08  per(accum) = 3.93
 T(local opt: hintermediate init          ) = 8.475e-05 S  per = 0.382  per(accum) = 4.31
 T(local opt: preprocess_hformulae_Hxlist ) = 9.903e-03 S  per = 44.7  per(accum) = 49
 T(local opt: hmmtasks init               ) = 2.698e-03 S  per = 12.2  per(accum) = 61.2
 T(local opt: initial guess for dvdson    ) = 9.294e-05 S  per = 0.419  per(accum) = 61.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 7.711e-03 S  per = 34.8  per(accum) = 96.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.549e-04 S  per = 0.699  per(accum) = 97.1
 T(local opt: dvdson [nccl]               ) = 3.029e-04 S  per = 1.37  per(accum) = 98.4
 T(local opt: dvdson [mpi]                ) = 1.856e-06 S  per = 0.00837  per(accum) = 98.4
 T(local opt: dvdson [rest part(linalg)]  ) = 3.476e-04 S  per = 1.57  per(accum) = 100
Detailed decomposition of T(renrm) = 7.714e-03 S  T(sum) = 7.714e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.250e-05 S  per = 0.551  per(accum) = 0.551
 T(local opt: qops init                    ) = 3.303e-04 S  per = 4.28  per(accum) = 4.83
 T(local opt: symbolic_formulae_renorm     ) = 3.458e-04 S  per = 4.48  per(accum) = 9.31
 T(local opt: allocate qops on gpu         ) = 5.207e-05 S  per = 0.675  per(accum) = 9.99
 T(local opt: site memcpy cpu2gpu          ) = 1.933e-05 S  per = 0.251  per(accum) = 10.2
 T(local opt: rintermediate init           ) = 3.840e-05 S  per = 0.498  per(accum) = 10.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.082e-03 S  per =   27  per(accum) = 37.7
 T(local opt: rmmtasks init                ) = 6.919e-04 S  per = 8.97  per(accum) = 46.7
 T(local opt: qops memset on cpu           ) = 9.400e-08 S  per = 0.00122  per(accum) = 46.7
 T(local opt: preprocess_renorm_batchGPU   ) = 7.820e-04 S  per = 10.1  per(accum) = 56.8
 T(local opt: deallocate cpu and gpu memory) = 2.790e-05 S  per = 0.362  per(accum) = 57.2
 T(local opt: construct opS [ifdists=true] ) = 2.526e-03 S  per = 32.7  per(accum) = 89.9
 T(local opt: reduction of opS & opH [nccl]) = 1.797e-05 S  per = 0.233  per(accum) = 90.2
 T(local opt: qops memcpy gpu2cpu          ) = 3.921e-05 S  per = 0.508  per(accum) = 90.7
 T(local opt: reduction of opS & opH [mpi] ) = 8.600e-06 S  per = 0.111  per(accum) = 90.8
 T(local opt: qops_pool join and erase     ) = 7.079e-04 S  per = 9.18  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.530e-06 S  per = 0.0328  per(accum) = 100
ctns::rcanon_save_site idx=8 scratch=./scratch/sweep size=56:4.2e-07GB T(load)=0.00058S speed=0.00072GB/S
##### sweep opt: 5.414e-01 S #####
 T(sweep opt: fetch) = 3.060e-02 S  per = 5.65  per(accum) = 5.65
 T(sweep opt: hdiag) = 3.063e-02 S  per = 5.66  per(accum) = 11.3
 T(sweep opt: dvdsn) = 3.433e-01 S  per = 63.4  per(accum) = 74.7
 T(sweep opt: decim) = 1.250e-02 S  per = 2.31  per(accum) = 77
 T(sweep opt: guess) = 1.033e-03 S  per = 0.191  per(accum) = 77.2
 T(sweep opt: renrm) = 1.032e-01 S  per = 19.1  per(accum) = 96.3
 T(sweep opt: save ) = 2.019e-02 S  per = 3.73  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.433e-01 S  T(sum) = 3.382e-01 S  per = 9.849e+01
 T(sweep opt: preprocess                  ) = 3.782e-03 S  per = 1.12  per(accum) = 1.12
 T(sweep opt: symbolic_formulae           ) = 6.049e-03 S  per = 1.79  per(accum) = 2.91
 T(sweep opt: hintermediate init          ) = 8.363e-04 S  per = 0.247  per(accum) = 3.15
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.668e-01 S  per = 49.3  per(accum) = 52.5
 T(sweep opt: hmmtasks init               ) = 3.303e-02 S  per = 9.77  per(accum) = 62.3
 T(sweep opt: initial guess for dvdson    ) = 1.675e-03 S  per = 0.495  per(accum) = 62.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.163e-01 S  per = 34.4  per(accum) = 97.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.601e-03 S  per = 0.474  per(accum) = 97.6
 T(sweep opt: dvdson [nccl]               ) = 3.961e-03 S  per = 1.17  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 3.040e-05 S  per = 0.00899  per(accum) = 98.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.040e-03 S  per = 1.19  per(accum) = 100
Detailed decomposition of T(renrm) = 1.032e-01 S  T(sum) = 1.032e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.865e-04 S  per = 0.569  per(accum) = 0.569
 T(sweep opt: qops init                    ) = 3.881e-03 S  per = 3.76  per(accum) = 4.33
 T(sweep opt: symbolic_formulae_renorm     ) = 1.896e-03 S  per = 1.84  per(accum) = 6.17
 T(sweep opt: allocate qops on gpu         ) = 6.094e-04 S  per = 0.591  per(accum) = 6.76
 T(sweep opt: site memcpy cpu2gpu          ) = 2.694e-04 S  per = 0.261  per(accum) = 7.02
 T(sweep opt: rintermediate init           ) = 4.949e-04 S  per = 0.48  per(accum) = 7.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.322e-02 S  per = 12.8  per(accum) = 20.3
 T(sweep opt: rmmtasks init                ) = 4.189e-03 S  per = 4.06  per(accum) = 24.4
 T(sweep opt: qops memset on cpu           ) = 5.460e-07 S  per = 0.000529  per(accum) = 24.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.967e-03 S  per = 7.72  per(accum) = 32.1
 T(sweep opt: deallocate cpu and gpu memory) = 3.258e-04 S  per = 0.316  per(accum) = 32.4
 T(sweep opt: construct opS [ifdists=true] ) = 5.744e-02 S  per = 55.7  per(accum) = 88.1
 T(sweep opt: reduction of opS & opH [nccl]) = 2.043e-04 S  per = 0.198  per(accum) = 88.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.865e-04 S  per = 0.375  per(accum) = 88.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.040e-04 S  per = 0.101  per(accum) = 88.8
 T(sweep opt: qops_pool join and erase     ) = 8.808e-03 S  per = 8.54  per(accum) = 97.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.768e-03 S  per = 2.68  per(accum) = 100
##### global opt: 5.414e-01 S #####
 T(global opt: fetch) = 3.060e-02 S  per = 5.65  per(accum) = 5.65
 T(global opt: hdiag) = 3.063e-02 S  per = 5.66  per(accum) = 11.3
 T(global opt: dvdsn) = 3.433e-01 S  per = 63.4  per(accum) = 74.7
 T(global opt: decim) = 1.250e-02 S  per = 2.31  per(accum) = 77
 T(global opt: guess) = 1.033e-03 S  per = 0.191  per(accum) = 77.2
 T(global opt: renrm) = 1.032e-01 S  per = 19.1  per(accum) = 96.3
 T(global opt: save ) = 2.019e-02 S  per = 3.73  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.433e-01 S  T(sum) = 3.382e-01 S  per = 9.849e+01
 T(global opt: preprocess                  ) = 3.782e-03 S  per = 1.12  per(accum) = 1.12
 T(global opt: symbolic_formulae           ) = 6.049e-03 S  per = 1.79  per(accum) = 2.91
 T(global opt: hintermediate init          ) = 8.363e-04 S  per = 0.247  per(accum) = 3.15
 T(global opt: preprocess_hformulae_Hxlist ) = 1.668e-01 S  per = 49.3  per(accum) = 52.5
 T(global opt: hmmtasks init               ) = 3.303e-02 S  per = 9.77  per(accum) = 62.3
 T(global opt: initial guess for dvdson    ) = 1.675e-03 S  per = 0.495  per(accum) = 62.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.163e-01 S  per = 34.4  per(accum) = 97.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.601e-03 S  per = 0.474  per(accum) = 97.6
 T(global opt: dvdson [nccl]               ) = 3.961e-03 S  per = 1.17  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 3.040e-05 S  per = 0.00899  per(accum) = 98.8
 T(global opt: dvdson [rest part(linalg)]  ) = 4.040e-03 S  per = 1.19  per(accum) = 100
Detailed decomposition of T(renrm) = 1.032e-01 S  T(sum) = 1.032e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.865e-04 S  per = 0.569  per(accum) = 0.569
 T(global opt: qops init                    ) = 3.881e-03 S  per = 3.76  per(accum) = 4.33
 T(global opt: symbolic_formulae_renorm     ) = 1.896e-03 S  per = 1.84  per(accum) = 6.17
 T(global opt: allocate qops on gpu         ) = 6.094e-04 S  per = 0.591  per(accum) = 6.76
 T(global opt: site memcpy cpu2gpu          ) = 2.694e-04 S  per = 0.261  per(accum) = 7.02
 T(global opt: rintermediate init           ) = 4.949e-04 S  per = 0.48  per(accum) = 7.5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.322e-02 S  per = 12.8  per(accum) = 20.3
 T(global opt: rmmtasks init                ) = 4.189e-03 S  per = 4.06  per(accum) = 24.4
 T(global opt: qops memset on cpu           ) = 5.460e-07 S  per = 0.000529  per(accum) = 24.4
 T(global opt: preprocess_renorm_batchGPU   ) = 7.967e-03 S  per = 7.72  per(accum) = 32.1
 T(global opt: deallocate cpu and gpu memory) = 3.258e-04 S  per = 0.316  per(accum) = 32.4
 T(global opt: construct opS [ifdists=true] ) = 5.744e-02 S  per = 55.7  per(accum) = 88.1
 T(global opt: reduction of opS & opH [nccl]) = 2.043e-04 S  per = 0.198  per(accum) = 88.3
 T(global opt: qops memcpy gpu2cpu          ) = 3.865e-04 S  per = 0.375  per(accum) = 88.7
 T(global opt: reduction of opS & opH [mpi] ) = 1.040e-04 S  per = 0.101  per(accum) = 88.8
 T(global opt: qops_pool join and erase     ) = 8.808e-03 S  per = 8.54  per(accum) = 97.3
 T(global opt: conversion from opAB to opPQ ) = 2.768e-03 S  per = 2.68  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.696e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=11/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=6 scratch=./scratch/sweep size=16:1.19e-07GB T(load)=3.29e-04S speed=3.63e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=44:3.36e-04MB:3.28e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=38:2.90e-04MB:2.83e-07GB
total mem of comb=83:6.33e-04MB:6.18e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=2.816e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:12 S:4 H:1 P:28 Q:40 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=2102:1.604e-02MB:1.566e-05GB
        per(mem): C:12 S:4 H:1.43 P:2.66 Q:79.9 
 rqops: oplist=CSHAB nops=C:6 S:7 H:1 A:17 B:22 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=212:0.00162MB:1.58e-06GB
        per(mem): C:11.3 S:13.2 H:2.83 A:0 B:72.6 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4310:0.0329MB:3.21e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.544e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.252e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,4,3,3) nnz=51:3.891e-04MB
qtensor4: wf4 own=1 _data=0x5585ee1176c0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
 qbond: qcol nsym=3 dimAll=4
 (8,2):1 (8,4):1 (9,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=2.180e-03 t1=2.562e-05, t2=1.856e-05, t3=1.630e-05, t4=2.068e-03, t5=7.152e-06, t6=3.726e-05, t7=7.156e-06
duration_diagGPU:2.197e-03
duration_diagreduce:3.300e-08
duration_diagtransform:1.810e-07
----- TIMING FOR symbolic_formulae_twodot with size=319 : 5.864e-04 S -----
rank=0 GPUmem(GB): used=3.211e-05 (oper)=3.211e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=319
 no. of hintermediate operators=166
 no. of coefficients=1975:1.507e-02MB:1.471e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.116e-05 S -----
rank=0 GPUmem(GB): used=4.683e-05 (oper,hinter)=3.211e-05,1.471e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 8.661e-03 S size(H_formulae)=319 size(Hxlst2)=15 T(Hmu/Hxlist)=1.410e-04,8.520e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.219e-03 S size(H_formulae)=319 size(Hxlst)=4744 -----
rank=0 GPUmem(GB): used=4.683e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=7.600e-07 batch[need]=8.836e-04 blksize=8 blksize0=8 batchsize=4744
rank=0 GPUmem(GB): used=9.312e-04 (oper,hinter,dvdson,batch)=3.211e-05,1.471e-05,7.600e-07,8.836e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.857e-05,1.376e-04,7.616e-04,3.452e-04,1.332e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.476e-05 speed=3.070e-02GB/S T(nccl)=5.381e-05 speed=1.412e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.6e-04 t_reduction=3.4e-04 tot=1.2e-03 -----
 sigma[inter] counter=72 t=1.4e-04 per=1.1e+01 cost=2.1e+05 flops=1.5e+09
 sigma[gemm] counter=72 i=0 t=2.6e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=3 t=2.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=4 t=1.5e-04 per=1.2e+01 cost=2.6e+04 flops=1.7e+08
 sigma[gemm] counter=72 i=5 t=1.6e-04 per=1.3e+01 cost=2.6e+04 flops=1.6e+08
 sigma[gemm] counter=72 i=6 t=2.3e-04 per=1.8e+01 cost=3.1e+04 flops=1.3e+08
 sigma[gemm] counter=72 i=7 t=2.1e-04 per=1.7e+01 cost=2.9e+04 flops=1.4e+08
 sigma[gemm] counter=72 total t=7.6e-04 per=6.1e+01 cost=1.1e+05 flops=1.5e+08
 sigma[red] counter=72 t=3.4e-04 per=2.8e+01 cost=3.4e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=9.5e-03 t_gemm=4.9e-02 t_reduction=4.3e-02 tot=1.0e-01 -----
 sigma_tot[inter] counter=72 t=9.5e-03 per=9.3e+00 cost=3.2e+07 flops=3.4e+09
 sigma_tot[gemm] counter=72 i=0 t=1.7e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=3 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=4 t=1.2e-02 per=1.1e+01 cost=7.4e+06 flops=6.4e+08
 sigma_tot[gemm] counter=72 i=5 t=1.3e-02 per=1.3e+01 cost=7.5e+06 flops=5.7e+08
 sigma_tot[gemm] counter=72 i=6 t=1.2e-02 per=1.2e+01 cost=7.1e+06 flops=6.0e+08
 sigma_tot[gemm] counter=72 i=7 t=1.2e-02 per=1.2e+01 cost=7.2e+06 flops=6.0e+08
 sigma_tot[gemm] counter=72 total t=4.9e-02 per=4.8e+01 cost=2.9e+07 flops=5.9e+08
 sigma_tot[red] counter=72 t=4.3e-02 per=4.2e+01 cost=6.7e+06 flops=1.6e+08
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.1e-06,1.3e-06,1.1e-06,3.4e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.284966887172 -1.116e+03  5.064e-02    1     1  1.702e-03 1.702e-03 1.666e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.282e-05,1.404e-04,9.174e-04,4.047e-04,1.541e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.448e-05 speed=3.104e-02GB/S T(nccl)=4.834e-05 speed=1.572e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=9.2e-04 t_reduction=4.0e-04 tot=1.5e-03 -----
 sigma[inter] counter=73 t=1.4e-04 per=9.6e+00 cost=2.1e+05 flops=1.5e+09
 sigma[gemm] counter=73 i=0 t=2.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=2.5e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=3 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=4 t=1.8e-04 per=1.2e+01 cost=2.6e+04 flops=1.5e+08
 sigma[gemm] counter=73 i=5 t=1.9e-04 per=1.3e+01 cost=2.6e+04 flops=1.4e+08
 sigma[gemm] counter=73 i=6 t=2.7e-04 per=1.8e+01 cost=3.1e+04 flops=1.1e+08
 sigma[gemm] counter=73 i=7 t=2.7e-04 per=1.8e+01 cost=2.9e+04 flops=1.1e+08
 sigma[gemm] counter=73 total t=9.2e-04 per=6.3e+01 cost=1.1e+05 flops=1.2e+08
 sigma[red] counter=73 t=4.0e-04 per=2.8e+01 cost=3.4e+04 flops=8.5e+07
----- TIMING FOR sigma_tot : t_inter=9.6e-03 t_gemm=5.0e-02 t_reduction=4.4e-02 tot=1.0e-01 -----
 sigma_tot[inter] counter=73 t=9.6e-03 per=9.3e+00 cost=3.2e+07 flops=3.3e+09
 sigma_tot[gemm] counter=73 i=0 t=1.7e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=3 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=4 t=1.2e-02 per=1.1e+01 cost=7.5e+06 flops=6.4e+08
 sigma_tot[gemm] counter=73 i=5 t=1.3e-02 per=1.3e+01 cost=7.5e+06 flops=5.6e+08
 sigma_tot[gemm] counter=73 i=6 t=1.2e-02 per=1.2e+01 cost=7.1e+06 flops=5.9e+08
 sigma_tot[gemm] counter=73 i=7 t=1.2e-02 per=1.2e+01 cost=7.2e+06 flops=5.9e+08
 sigma_tot[gemm] counter=73 total t=5.0e-02 per=4.9e+01 cost=2.9e+07 flops=5.9e+08
 sigma_tot[red] counter=73 t=4.4e-02 per=4.2e+01 cost=6.8e+06 flops=1.5e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.2e-05,3.5e-06,1.6e-06,3.3e-07
    2   0 -    -116.290956146613 -5.989e-03  1.085e-02    2     2  3.599e-03 1.799e-03 1.732e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.140e-05,1.396e-04,9.027e-04,4.209e-04,1.540e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.362e-05 speed=3.217e-02GB/S T(nccl)=4.777e-05 speed=1.591e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=9.0e-04 t_reduction=4.2e-04 tot=1.5e-03 -----
 sigma[inter] counter=74 t=1.4e-04 per=9.5e+00 cost=2.1e+05 flops=1.5e+09
 sigma[gemm] counter=74 i=0 t=2.8e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=3 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=4 t=1.7e-04 per=1.2e+01 cost=2.6e+04 flops=1.5e+08
 sigma[gemm] counter=74 i=5 t=1.9e-04 per=1.3e+01 cost=2.6e+04 flops=1.4e+08
 sigma[gemm] counter=74 i=6 t=2.7e-04 per=1.8e+01 cost=3.1e+04 flops=1.1e+08
 sigma[gemm] counter=74 i=7 t=2.6e-04 per=1.8e+01 cost=2.9e+04 flops=1.1e+08
 sigma[gemm] counter=74 total t=9.0e-04 per=6.2e+01 cost=1.1e+05 flops=1.2e+08
 sigma[red] counter=74 t=4.2e-04 per=2.9e+01 cost=3.4e+04 flops=8.2e+07
----- TIMING FOR sigma_tot : t_inter=9.7e-03 t_gemm=5.1e-02 t_reduction=4.4e-02 tot=1.0e-01 -----
 sigma_tot[inter] counter=74 t=9.7e-03 per=9.3e+00 cost=3.2e+07 flops=3.3e+09
 sigma_tot[gemm] counter=74 i=0 t=1.7e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=3 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=4 t=1.2e-02 per=1.1e+01 cost=7.5e+06 flops=6.3e+08
 sigma_tot[gemm] counter=74 i=5 t=1.4e-02 per=1.3e+01 cost=7.5e+06 flops=5.5e+08
 sigma_tot[gemm] counter=74 i=6 t=1.2e-02 per=1.2e+01 cost=7.2e+06 flops=5.8e+08
 sigma_tot[gemm] counter=74 i=7 t=1.2e-02 per=1.2e+01 cost=7.3e+06 flops=5.8e+08
 sigma_tot[gemm] counter=74 total t=5.1e-02 per=4.9e+01 cost=2.9e+07 flops=5.8e+08
 sigma_tot[red] counter=74 t=4.4e-02 per=4.2e+01 cost=6.8e+06 flops=1.5e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.6e-05,2.7e-06,1.8e-06,2.9e-07
    3   0 -    -116.291453914930 -4.978e-04  2.000e-03    3     3  5.456e-03 1.819e-03 1.753e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.040e-05,1.310e-04,9.072e-04,4.133e-04,1.526e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.350e-05 speed=3.233e-02GB/S T(nccl)=4.690e-05 speed=1.620e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=9.1e-04 t_reduction=4.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=75 t=1.3e-04 per=9.0e+00 cost=2.1e+05 flops=1.6e+09
 sigma[gemm] counter=75 i=0 t=2.8e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=3 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=4 t=1.8e-04 per=1.2e+01 cost=2.6e+04 flops=1.5e+08
 sigma[gemm] counter=75 i=5 t=1.9e-04 per=1.3e+01 cost=2.6e+04 flops=1.4e+08
 sigma[gemm] counter=75 i=6 t=2.7e-04 per=1.8e+01 cost=3.1e+04 flops=1.2e+08
 sigma[gemm] counter=75 i=7 t=2.6e-04 per=1.8e+01 cost=2.9e+04 flops=1.1e+08
 sigma[gemm] counter=75 total t=9.1e-04 per=6.2e+01 cost=1.1e+05 flops=1.2e+08
 sigma[red] counter=75 t=4.1e-04 per=2.8e+01 cost=3.4e+04 flops=8.3e+07
----- TIMING FOR sigma_tot : t_inter=9.9e-03 t_gemm=5.2e-02 t_reduction=4.4e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=75 t=9.9e-03 per=9.3e+00 cost=3.2e+07 flops=3.3e+09
 sigma_tot[gemm] counter=75 i=0 t=1.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=3 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=4 t=1.2e-02 per=1.1e+01 cost=7.5e+06 flops=6.2e+08
 sigma_tot[gemm] counter=75 i=5 t=1.4e-02 per=1.3e+01 cost=7.6e+06 flops=5.5e+08
 sigma_tot[gemm] counter=75 i=6 t=1.3e-02 per=1.2e+01 cost=7.2e+06 flops=5.7e+08
 sigma_tot[gemm] counter=75 i=7 t=1.3e-02 per=1.2e+01 cost=7.3e+06 flops=5.7e+08
 sigma_tot[gemm] counter=75 total t=5.2e-02 per=4.9e+01 cost=3.0e+07 flops=5.7e+08
 sigma_tot[red] counter=75 t=4.4e-02 per=4.2e+01 cost=6.8e+06 flops=1.5e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,2.5e-06,1.5e-06,2.4e-07
    4   0 -    -116.291463949187 -1.003e-05  4.314e-04    3     4  7.322e-03 1.830e-03 1.767e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.087e-05,1.321e-04,9.309e-04,4.099e-04,1.548e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.377e-05 speed=3.198e-02GB/S T(nccl)=4.711e-05 speed=1.613e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=9.3e-04 t_reduction=4.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=76 t=1.3e-04 per=9.0e+00 cost=2.1e+05 flops=1.6e+09
 sigma[gemm] counter=76 i=0 t=2.8e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=2.5e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=2.5e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=3 t=2.5e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=4 t=1.8e-04 per=1.2e+01 cost=2.6e+04 flops=1.5e+08
 sigma[gemm] counter=76 i=5 t=2.0e-04 per=1.4e+01 cost=2.6e+04 flops=1.3e+08
 sigma[gemm] counter=76 i=6 t=2.8e-04 per=1.9e+01 cost=3.1e+04 flops=1.1e+08
 sigma[gemm] counter=76 i=7 t=2.6e-04 per=1.8e+01 cost=2.9e+04 flops=1.1e+08
 sigma[gemm] counter=76 total t=9.3e-04 per=6.3e+01 cost=1.1e+05 flops=1.2e+08
 sigma[red] counter=76 t=4.1e-04 per=2.8e+01 cost=3.4e+04 flops=8.4e+07
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.3e-02 t_reduction=4.5e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=76 t=1.0e-02 per=9.3e+00 cost=3.3e+07 flops=3.3e+09
 sigma_tot[gemm] counter=76 i=0 t=1.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=3 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=4 t=1.2e-02 per=1.1e+01 cost=7.5e+06 flops=6.1e+08
 sigma_tot[gemm] counter=76 i=5 t=1.4e-02 per=1.3e+01 cost=7.6e+06 flops=5.4e+08
 sigma_tot[gemm] counter=76 i=6 t=1.3e-02 per=1.2e+01 cost=7.2e+06 flops=5.6e+08
 sigma_tot[gemm] counter=76 i=7 t=1.3e-02 per=1.2e+01 cost=7.3e+06 flops=5.6e+08
 sigma_tot[gemm] counter=76 total t=5.3e-02 per=4.9e+01 cost=3.0e+07 flops=5.6e+08
 sigma_tot[red] counter=76 t=4.5e-02 per=4.2e+01 cost=6.9e+06 flops=1.5e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,2.5e-06,1.4e-06,2.4e-07
    5   0 -    -116.291464608223 -6.590e-07  1.600e-04    3     5  9.194e-03 1.839e-03 1.776e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.584e-05,1.321e-04,9.291e-04,4.090e-04,1.550e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.340e-05 speed=3.248e-02GB/S T(nccl)=5.244e-05 speed=1.449e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=9.3e-04 t_reduction=4.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=77 t=1.3e-04 per=9.0e+00 cost=2.1e+05 flops=1.6e+09
 sigma[gemm] counter=77 i=0 t=2.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=2.5e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=2.6e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=3 t=2.5e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=4 t=1.8e-04 per=1.2e+01 cost=2.6e+04 flops=1.5e+08
 sigma[gemm] counter=77 i=5 t=2.0e-04 per=1.4e+01 cost=2.6e+04 flops=1.3e+08
 sigma[gemm] counter=77 i=6 t=2.7e-04 per=1.9e+01 cost=3.1e+04 flops=1.1e+08
 sigma[gemm] counter=77 i=7 t=2.6e-04 per=1.8e+01 cost=2.9e+04 flops=1.1e+08
 sigma[gemm] counter=77 total t=9.3e-04 per=6.3e+01 cost=1.1e+05 flops=1.2e+08
 sigma[red] counter=77 t=4.1e-04 per=2.8e+01 cost=3.4e+04 flops=8.4e+07
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.4e-02 t_reduction=4.5e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=77 t=1.0e-02 per=9.3e+00 cost=3.3e+07 flops=3.2e+09
 sigma_tot[gemm] counter=77 i=0 t=1.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=3 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=4 t=1.2e-02 per=1.1e+01 cost=7.6e+06 flops=6.1e+08
 sigma_tot[gemm] counter=77 i=5 t=1.4e-02 per=1.3e+01 cost=7.6e+06 flops=5.4e+08
 sigma_tot[gemm] counter=77 i=6 t=1.3e-02 per=1.2e+01 cost=7.3e+06 flops=5.5e+08
 sigma_tot[gemm] counter=77 i=7 t=1.3e-02 per=1.2e+01 cost=7.3e+06 flops=5.5e+08
 sigma_tot[gemm] counter=77 total t=5.4e-02 per=4.9e+01 cost=3.0e+07 flops=5.5e+08
 sigma_tot[red] counter=77 t=4.5e-02 per=4.1e+01 cost=6.9e+06 flops=1.5e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.4e-05,2.6e-06,1.5e-06,2.5e-07
    6   0 +    -116.291464685952 -7.773e-08  5.642e-05    3     6  1.109e-02 1.849e-03 1.786e-03
TIMING FOR Davidson : 1.111e-02  T(cal/comm/rest)=1.072e-02,2.065e-06,3.914e-04
decomposed t_rest=3.914e-04
 T(sub)    =1.239e-04 per=3.165e+01
 T(precond)=1.976e-05 per=5.048e+00
 T(ortho)  =9.980e-06 per=2.550e+00
 T(xcopy)  =1.092e-06 per=2.790e-01
 T(xnrm2)  =1.225e-06 per=3.130e-01
 T(other)  =2.355e-04 per=6.016e+01
optimized energies: isweep=0 ibond=11 dots=2 e[0]=-116.291464685952 nmvp=6
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=9.918e-04 change=1.421e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=9 dimAll=40
 (18,2):6 (20,2):5 (19,1):4 (19,3):10 (18,4):5 (20,4):4 (19,5):3 (17,3):2 (21,3):1
timing for divide=7.4e-06
timing for compute=5.7e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 7.7e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.4e-06,4.6e-05,0.0e+00,1.1e-05,1.3e-05 -----
decimation summary: 40->9 dwt=+0.000e+00 SvN=4.139e-01
 qbond: qkept nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
----- TIMING for decimation_row(nkr): 1.039e-03 S T(decim/select/formRot)=1.336e-04,8.813e-04,2.451e-05 -----
----- TIMING FOR twodot_decimation: 1.122e-03 S T(wf/decim)=7.085e-05,1.051e-03 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:13 S:4 H:1 P:23 Q:28 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=1271:9.697e-03MB:9.470e-06GB
        per(mem): C:18.4 S:5.66 H:1.81 P:3.62 Q:70.5 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=9.918e-04 change=1.043e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=65 : 3.828e-04 S -----
rank=0 GPUmem(GB): used=5.472e-05 (oper)=3.257e-05
rank=0 GPUmem(GB): used=5.507e-05 (oper,site)=3.257e-05,3.576e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=65
 no. of rintermediate operators=79
 no. of coefficients=948:7.233e-03MB:7.063e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.682e-05 S -----
rank=0 GPUmem(GB): used=6.214e-05 (oper,site,rinter)=3.257e-05,3.576e-07,7.063e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.107e-03 S size(rtasks)=65 size(Rlst2)=16 T(Rmu/Rlist)=1.429e-04,1.964e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.300e-03 S size(rtasks)=65 size(Rlst)=1242 -----
rank=0 GPUmem(GB): used=6.214e-05 avail=3.829e+01 total=3.829e+01 batch[need]=3.054e-04 blksize=12 blksize0=8 batchsize=1242
rank=0 GPUmem(GB): used=3.675e-04 (oper,site,rinter,batch)=3.257e-05,3.576e-07,7.063e-06,3.054e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.264e-04,4.933e-04,1.344e-04
----- TIMING FOR renorm : t_inter=1.3e-04 t_gemm=4.9e-04 t_reduction=1.3e-04 tot=7.5e-04 -----
 renorm[inter] counter=151 t=1.3e-04 per=1.7e+01 cost=4.6e+04 flops=3.7e+08
 renorm[gemm] counter=151 i=0 t=2.8e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=151 i=1 t=2.4e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=151 i=2 t=2.3e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=151 i=3 t=2.3e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=151 i=4 t=1.7e-04 per=2.3e+01 cost=6.0e+03 flops=3.4e+07
 renorm[gemm] counter=151 i=5 t=1.6e-04 per=2.2e+01 cost=1.9e+04 flops=1.2e+08
 renorm[gemm] counter=151 i=6 t=1.4e-04 per=1.9e+01 cost=3.3e+04 flops=2.3e+08
 renorm[gemm] counter=151 total t=4.9e-04 per=6.5e+01 cost=5.8e+04 flops=1.2e+08
 renorm[red] counter=151 t=1.3e-04 per=1.8e+01 cost=1.5e+04 flops=1.1e+08
----- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=4.4e-03 t_reduction=1.7e-03 tot=7.3e-03 -----
 renorm_tot[inter] counter=151 t=1.2e-03 per=1.6e+01 cost=2.5e+05 flops=2.2e+08
 renorm_tot[gemm] counter=151 i=0 t=2.6e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=151 i=1 t=2.3e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=151 i=2 t=2.3e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=151 i=3 t=2.3e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=151 i=4 t=1.4e-03 per=1.9e+01 cost=3.7e+04 flops=2.7e+07
 renorm_tot[gemm] counter=151 i=5 t=1.5e-03 per=2.1e+01 cost=2.0e+05 flops=1.4e+08
 renorm_tot[gemm] counter=151 i=6 t=1.4e-03 per=1.9e+01 cost=3.7e+05 flops=2.6e+08
 renorm_tot[gemm] counter=151 total t=4.4e-03 per=6.0e+01 cost=6.1e+05 flops=1.4e+08
 renorm_tot[red] counter=151 t=1.7e-03 per=2.4e+01 cost=1.5e+05 flops=8.8e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.299e-05 (oper)=3.270e-05
rank=0 GPUmem(GB): used=6.334e-05 (oper,site,rinter)=3.270e-05,3.576e-07,1.073e-06
rank=0 GPUmem(GB): used=7.416e-05 (oper,site,rinter,batch)=3.270e-05,3.576e-07,1.073e-06,1.082e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.704e-03 S T(preprocess/alloc/comp/red/dealloc)=5.650e-04,6.181e-04,1.883e-03,1.400e-04,4.959e-05 -----
----- TIMING FOR oper_renorm_opS : 2.744e-03 S rank=0 -----
qops.to_cpu: size(tot)=1271:9.697e-03MB:9.470e-06GB T(to_cpu)=3.371e-05S speed=2.809e-01GB/S
check ||H-H.dagger||=2.273e-14 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.00787 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.297e-03 change=4.100e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.572e-03 change=-1.396e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.572e-03 change=-2.742e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 4.040e-02 S #####
 T(local opt: fetch) = 2.421e-03 S  per = 5.99  per(accum) = 5.99
 T(local opt: hdiag) = 2.282e-03 S  per = 5.65  per(accum) = 11.6
 T(local opt: dvdsn) = 2.404e-02 S  per = 59.5  per(accum) = 71.1
 T(local opt: decim) = 1.164e-03 S  per = 2.88  per(accum) = 74
 T(local opt: guess) = 8.722e-05 S  per = 0.216  per(accum) = 74.2
 T(local opt: renrm) = 8.586e-03 S  per = 21.3  per(accum) = 95.5
 T(local opt: save ) = 1.819e-03 S  per =  4.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.404e-02 S  T(sum) = 2.361e-02 S  per = 9.820e+01
 T(local opt: preprocess                  ) = 1.912e-04 S  per = 0.81  per(accum) = 0.81
 T(local opt: symbolic_formulae           ) = 5.996e-04 S  per = 2.54  per(accum) = 3.35
 T(local opt: hintermediate init          ) = 7.875e-05 S  per = 0.334  per(accum) = 3.68
 T(local opt: preprocess_hformulae_Hxlist ) = 9.248e-03 S  per = 39.2  per(accum) = 42.9
 T(local opt: hmmtasks init               ) = 2.261e-03 S  per = 9.58  per(accum) = 52.4
 T(local opt: initial guess for dvdson    ) = 1.146e-04 S  per = 0.485  per(accum) = 52.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.028e-02 S  per = 43.5  per(accum) = 96.5
 T(local opt: dvdson [cpu-gpu]            ) = 1.435e-04 S  per = 0.608  per(accum) = 97.1
 T(local opt: dvdson [nccl]               ) = 2.964e-04 S  per = 1.26  per(accum) = 98.3
 T(local opt: dvdson [mpi]                ) = 2.065e-06 S  per = 0.00875  per(accum) = 98.3
 T(local opt: dvdson [rest part(linalg)]  ) = 3.914e-04 S  per = 1.66  per(accum) = 100
Detailed decomposition of T(renrm) = 8.586e-03 S  T(sum) = 8.586e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.204e-05 S  per = 0.723  per(accum) = 0.723
 T(local opt: qops init                    ) = 4.216e-04 S  per = 4.91  per(accum) = 5.63
 T(local opt: symbolic_formulae_renorm     ) = 3.970e-04 S  per = 4.62  per(accum) = 10.3
 T(local opt: allocate qops on gpu         ) = 8.401e-05 S  per = 0.978  per(accum) = 11.2
 T(local opt: site memcpy cpu2gpu          ) = 3.227e-05 S  per = 0.376  per(accum) = 11.6
 T(local opt: rintermediate init           ) = 8.610e-05 S  per =    1  per(accum) = 12.6
 T(local opt: preprocess_formulae_Rlist2   ) = 2.317e-03 S  per =   27  per(accum) = 39.6
 T(local opt: rmmtasks init                ) = 7.251e-04 S  per = 8.44  per(accum) = 48
 T(local opt: qops memset on cpu           ) = 5.700e-08 S  per = 0.000664  per(accum) = 48
 T(local opt: preprocess_renorm_batchGPU   ) = 9.366e-04 S  per = 10.9  per(accum) = 58.9
 T(local opt: deallocate cpu and gpu memory) = 3.304e-05 S  per = 0.385  per(accum) = 59.3
 T(local opt: construct opS [ifdists=true] ) = 2.761e-03 S  per = 32.2  per(accum) = 91.5
 T(local opt: reduction of opS & opH [nccl]) = 1.900e-05 S  per = 0.221  per(accum) = 91.7
 T(local opt: qops memcpy gpu2cpu          ) = 4.297e-05 S  per =  0.5  per(accum) = 92.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.121e-05 S  per = 0.131  per(accum) = 92.3
 T(local opt: qops_pool join and erase     ) = 6.551e-04 S  per = 7.63  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.386e-06 S  per = 0.0278  per(accum) = 100
ctns::rcanon_save_site idx=7 scratch=./scratch/sweep size=48:3.6e-07GB T(load)=0.00057S speed=0.00062GB/S
##### sweep opt: 5.818e-01 S #####
 T(sweep opt: fetch) = 3.302e-02 S  per = 5.67  per(accum) = 5.67
 T(sweep opt: hdiag) = 3.291e-02 S  per = 5.66  per(accum) = 11.3
 T(sweep opt: dvdsn) = 3.674e-01 S  per = 63.1  per(accum) = 74.5
 T(sweep opt: decim) = 1.367e-02 S  per = 2.35  per(accum) = 76.8
 T(sweep opt: guess) = 1.120e-03 S  per = 0.193  per(accum) = 77
 T(sweep opt: renrm) = 1.117e-01 S  per = 19.2  per(accum) = 96.2
 T(sweep opt: save ) = 2.201e-02 S  per = 3.78  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.674e-01 S  T(sum) = 3.618e-01 S  per = 9.847e+01
 T(sweep opt: preprocess                  ) = 3.973e-03 S  per =  1.1  per(accum) = 1.1
 T(sweep opt: symbolic_formulae           ) = 6.649e-03 S  per = 1.84  per(accum) = 2.94
 T(sweep opt: hintermediate init          ) = 9.150e-04 S  per = 0.253  per(accum) = 3.19
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.761e-01 S  per = 48.7  per(accum) = 51.9
 T(sweep opt: hmmtasks init               ) = 3.529e-02 S  per = 9.75  per(accum) = 61.6
 T(sweep opt: initial guess for dvdson    ) = 1.790e-03 S  per = 0.495  per(accum) = 62.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.266e-01 S  per =   35  per(accum) = 97.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.745e-03 S  per = 0.482  per(accum) = 97.6
 T(sweep opt: dvdson [nccl]               ) = 4.258e-03 S  per = 1.18  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 3.246e-05 S  per = 0.00897  per(accum) = 98.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.432e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm) = 1.117e-01 S  T(sum) = 1.117e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.485e-04 S  per = 0.58  per(accum) = 0.58
 T(sweep opt: qops init                    ) = 4.302e-03 S  per = 3.85  per(accum) = 4.43
 T(sweep opt: symbolic_formulae_renorm     ) = 2.293e-03 S  per = 2.05  per(accum) = 6.48
 T(sweep opt: allocate qops on gpu         ) = 6.934e-04 S  per = 0.621  per(accum) = 7.1
 T(sweep opt: site memcpy cpu2gpu          ) = 3.017e-04 S  per = 0.27  per(accum) = 7.37
 T(sweep opt: rintermediate init           ) = 5.810e-04 S  per = 0.52  per(accum) = 7.89
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.553e-02 S  per = 13.9  per(accum) = 21.8
 T(sweep opt: rmmtasks init                ) = 4.915e-03 S  per =  4.4  per(accum) = 26.2
 T(sweep opt: qops memset on cpu           ) = 6.030e-07 S  per = 0.00054  per(accum) = 26.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.903e-03 S  per = 7.97  per(accum) = 34.2
 T(sweep opt: deallocate cpu and gpu memory) = 3.588e-04 S  per = 0.321  per(accum) = 34.5
 T(sweep opt: construct opS [ifdists=true] ) = 6.020e-02 S  per = 53.9  per(accum) = 88.4
 T(sweep opt: reduction of opS & opH [nccl]) = 2.233e-04 S  per =  0.2  per(accum) = 88.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.295e-04 S  per = 0.384  per(accum) = 88.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.152e-04 S  per = 0.103  per(accum) = 89.1
 T(sweep opt: qops_pool join and erase     ) = 9.463e-03 S  per = 8.47  per(accum) = 97.5
 T(sweep opt: conversion from opAB to opPQ ) = 2.770e-03 S  per = 2.48  per(accum) = 100
##### global opt: 5.818e-01 S #####
 T(global opt: fetch) = 3.302e-02 S  per = 5.67  per(accum) = 5.67
 T(global opt: hdiag) = 3.291e-02 S  per = 5.66  per(accum) = 11.3
 T(global opt: dvdsn) = 3.674e-01 S  per = 63.1  per(accum) = 74.5
 T(global opt: decim) = 1.367e-02 S  per = 2.35  per(accum) = 76.8
 T(global opt: guess) = 1.120e-03 S  per = 0.193  per(accum) = 77
 T(global opt: renrm) = 1.117e-01 S  per = 19.2  per(accum) = 96.2
 T(global opt: save ) = 2.201e-02 S  per = 3.78  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.674e-01 S  T(sum) = 3.618e-01 S  per = 9.847e+01
 T(global opt: preprocess                  ) = 3.973e-03 S  per =  1.1  per(accum) = 1.1
 T(global opt: symbolic_formulae           ) = 6.649e-03 S  per = 1.84  per(accum) = 2.94
 T(global opt: hintermediate init          ) = 9.150e-04 S  per = 0.253  per(accum) = 3.19
 T(global opt: preprocess_hformulae_Hxlist ) = 1.761e-01 S  per = 48.7  per(accum) = 51.9
 T(global opt: hmmtasks init               ) = 3.529e-02 S  per = 9.75  per(accum) = 61.6
 T(global opt: initial guess for dvdson    ) = 1.790e-03 S  per = 0.495  per(accum) = 62.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.266e-01 S  per =   35  per(accum) = 97.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.745e-03 S  per = 0.482  per(accum) = 97.6
 T(global opt: dvdson [nccl]               ) = 4.258e-03 S  per = 1.18  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 3.246e-05 S  per = 0.00897  per(accum) = 98.8
 T(global opt: dvdson [rest part(linalg)]  ) = 4.432e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm) = 1.117e-01 S  T(sum) = 1.117e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.485e-04 S  per = 0.58  per(accum) = 0.58
 T(global opt: qops init                    ) = 4.302e-03 S  per = 3.85  per(accum) = 4.43
 T(global opt: symbolic_formulae_renorm     ) = 2.293e-03 S  per = 2.05  per(accum) = 6.48
 T(global opt: allocate qops on gpu         ) = 6.934e-04 S  per = 0.621  per(accum) = 7.1
 T(global opt: site memcpy cpu2gpu          ) = 3.017e-04 S  per = 0.27  per(accum) = 7.37
 T(global opt: rintermediate init           ) = 5.810e-04 S  per = 0.52  per(accum) = 7.89
 T(global opt: preprocess_formulae_Rlist2   ) = 1.553e-02 S  per = 13.9  per(accum) = 21.8
 T(global opt: rmmtasks init                ) = 4.915e-03 S  per =  4.4  per(accum) = 26.2
 T(global opt: qops memset on cpu           ) = 6.030e-07 S  per = 0.00054  per(accum) = 26.2
 T(global opt: preprocess_renorm_batchGPU   ) = 8.903e-03 S  per = 7.97  per(accum) = 34.2
 T(global opt: deallocate cpu and gpu memory) = 3.588e-04 S  per = 0.321  per(accum) = 34.5
 T(global opt: construct opS [ifdists=true] ) = 6.020e-02 S  per = 53.9  per(accum) = 88.4
 T(global opt: reduction of opS & opH [nccl]) = 2.233e-04 S  per =  0.2  per(accum) = 88.6
 T(global opt: qops memcpy gpu2cpu          ) = 4.295e-04 S  per = 0.384  per(accum) = 88.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.152e-04 S  per = 0.103  per(accum) = 89.1
 T(global opt: qops_pool join and erase     ) = 9.463e-03 S  per = 8.47  per(accum) = 97.5
 T(global opt: conversion from opAB to opPQ ) = 2.770e-03 S  per = 2.48  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.426e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=12/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=5 scratch=./scratch/sweep size=8:5.96e-08GB T(load)=3.29e-04S speed=1.81e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=24:1.83e-04MB:1.79e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=26:1.98e-04MB:1.94e-07GB
total mem of comb=51:3.89e-04MB:3.80e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.013e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:13 S:4 H:1 P:23 Q:28 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=1271:9.697e-03MB:9.470e-06GB
        per(mem): C:18.4 S:5.66 H:1.81 P:3.62 Q:70.5 
 rqops: oplist=CSHAB nops=C:5 S:7 H:1 A:12 B:16 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=68:0.000519MB:5.07e-07GB
        per(mem): C:0 S:0 H:5.88 A:0 B:94.1 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3335:0.0254MB:2.48e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.170e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.192e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(9,2,3,3) nnz=36:2.747e-04MB
qtensor4: wf4 own=1 _data=0x5585ef61b440
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
 qbond: qcol nsym=1 dimAll=2
 (7,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=9 nblocks=64 size=36:2.747e-04MB
### DIAG TIMING: total=1.249e-03 t1=1.664e-05, t2=1.406e-05, t3=1.484e-05, t4=1.153e-03, t5=6.966e-06, t6=3.671e-05, t7=6.223e-06
duration_diagGPU:1.265e-03
duration_diagreduce:3.100e-08
duration_diagtransform:1.600e-07
----- TIMING FOR symbolic_formulae_twodot with size=255 : 4.306e-04 S -----
rank=0 GPUmem(GB): used=2.485e-05 (oper)=2.485e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=255
 no. of hintermediate operators=131
 no. of coefficients=1619:1.235e-02MB:1.206e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.637e-05 S -----
rank=0 GPUmem(GB): used=3.691e-05 (oper,hinter)=2.485e-05,1.206e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.098e-03 S size(H_formulae)=255 size(Hxlst2)=9 T(Hmu/Hxlist)=1.052e-04,2.993e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.252e-03 S size(H_formulae)=255 size(Hxlst)=1842 -----
rank=0 GPUmem(GB): used=3.691e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=5.364e-07 batch[need]=2.608e-04 blksize=6 blksize0=6 batchsize=1842
rank=0 GPUmem(GB): used=2.982e-04 (oper,hinter,dvdson,batch)=2.485e-05,1.206e-05,5.364e-07,2.608e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=36 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.871e-05,8.628e-05,3.040e-04,1.991e-04,6.648e-04
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.177e-05 speed=2.464e-02GB/S T(nccl)=4.693e-05 speed=1.143e-02GB/S
----- TIMING FOR sigma : t_inter=8.6e-05 t_gemm=3.0e-04 t_reduction=2.0e-04 tot=5.9e-04 -----
 sigma[inter] counter=78 t=8.6e-05 per=1.5e+01 cost=9.2e+04 flops=1.1e+09
 sigma[gemm] counter=78 i=0 t=1.9e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=1.7e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=1.7e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=3 t=1.7e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=4 t=6.1e-05 per=1.0e+01 cost=1.3e+04 flops=2.1e+08
 sigma[gemm] counter=78 i=5 t=8.1e-05 per=1.4e+01 cost=1.3e+04 flops=1.7e+08
 sigma[gemm] counter=78 i=6 t=7.8e-05 per=1.3e+01 cost=1.2e+04 flops=1.6e+08
 sigma[gemm] counter=78 i=7 t=7.6e-05 per=1.3e+01 cost=1.2e+04 flops=1.6e+08
 sigma[gemm] counter=78 total t=3.0e-04 per=5.2e+01 cost=5.1e+04 flops=1.7e+08
 sigma[red] counter=78 t=2.0e-04 per=3.4e+01 cost=1.5e+04 flops=7.7e+07
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.4e-02 t_reduction=4.5e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=78 t=1.0e-02 per=9.3e+00 cost=3.3e+07 flops=3.2e+09
 sigma_tot[gemm] counter=78 i=0 t=1.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=3 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=4 t=1.3e-02 per=1.1e+01 cost=7.6e+06 flops=6.1e+08
 sigma_tot[gemm] counter=78 i=5 t=1.4e-02 per=1.3e+01 cost=7.6e+06 flops=5.4e+08
 sigma_tot[gemm] counter=78 i=6 t=1.3e-02 per=1.2e+01 cost=7.3e+06 flops=5.4e+08
 sigma_tot[gemm] counter=78 i=7 t=1.3e-02 per=1.2e+01 cost=7.4e+06 flops=5.5e+08
 sigma_tot[gemm] counter=78 total t=5.4e-02 per=4.9e+01 cost=3.0e+07 flops=5.5e+08
 sigma_tot[red] counter=78 t=4.5e-02 per=4.1e+01 cost=6.9e+06 flops=1.5e+08
T(sub)=6.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,2.4e-06,9.6e-07,8.9e-07,2.0e-07
settings: ndim=36 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.291464685952 -1.116e+03  5.531e-02    1     1  8.442e-04 8.442e-04 8.210e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.276e-05,7.164e-05,3.381e-04,2.054e-04,6.845e-04
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.179e-05 speed=2.462e-02GB/S T(nccl)=4.098e-05 speed=1.309e-02GB/S
----- TIMING FOR sigma : t_inter=7.2e-05 t_gemm=3.4e-04 t_reduction=2.1e-04 tot=6.1e-04 -----
 sigma[inter] counter=79 t=7.2e-05 per=1.2e+01 cost=9.2e+04 flops=1.3e+09
 sigma[gemm] counter=79 i=0 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=4 t=6.6e-05 per=1.1e+01 cost=1.3e+04 flops=2.0e+08
 sigma[gemm] counter=79 i=5 t=8.4e-05 per=1.4e+01 cost=1.3e+04 flops=1.6e+08
 sigma[gemm] counter=79 i=6 t=9.1e-05 per=1.5e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=79 i=7 t=8.9e-05 per=1.5e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=79 total t=3.4e-04 per=5.5e+01 cost=5.1e+04 flops=1.5e+08
 sigma[red] counter=79 t=2.1e-04 per=3.3e+01 cost=1.5e+04 flops=7.5e+07
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.4e-02 t_reduction=4.6e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=79 t=1.0e-02 per=9.3e+00 cost=3.3e+07 flops=3.2e+09
 sigma_tot[gemm] counter=79 i=0 t=1.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=3 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=4 t=1.3e-02 per=1.1e+01 cost=7.6e+06 flops=6.0e+08
 sigma_tot[gemm] counter=79 i=5 t=1.4e-02 per=1.3e+01 cost=7.6e+06 flops=5.3e+08
 sigma_tot[gemm] counter=79 i=6 t=1.3e-02 per=1.2e+01 cost=7.3e+06 flops=5.4e+08
 sigma_tot[gemm] counter=79 i=7 t=1.3e-02 per=1.2e+01 cost=7.4e+06 flops=5.5e+08
 sigma_tot[gemm] counter=79 total t=5.4e-02 per=4.9e+01 cost=3.0e+07 flops=5.5e+08
 sigma_tot[red] counter=79 t=4.6e-02 per=4.1e+01 cost=6.9e+06 flops=1.5e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,9.5e-06,2.5e-06,1.0e-06,2.0e-07
    2   0 -    -116.298300665264 -6.836e-03  1.037e-02    2     2  1.771e-03 8.857e-04 8.371e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.120e-05,6.834e-05,3.466e-04,2.044e-04,6.839e-04
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.108e-05 speed=2.544e-02GB/S T(nccl)=4.012e-05 speed=1.337e-02GB/S
----- TIMING FOR sigma : t_inter=6.8e-05 t_gemm=3.5e-04 t_reduction=2.0e-04 tot=6.2e-04 -----
 sigma[inter] counter=80 t=6.8e-05 per=1.1e+01 cost=9.2e+04 flops=1.3e+09
 sigma[gemm] counter=80 i=0 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=4 t=7.7e-05 per=1.2e+01 cost=1.3e+04 flops=1.7e+08
 sigma[gemm] counter=80 i=5 t=8.3e-05 per=1.3e+01 cost=1.3e+04 flops=1.6e+08
 sigma[gemm] counter=80 i=6 t=8.9e-05 per=1.4e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=80 i=7 t=9.0e-05 per=1.4e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=80 total t=3.5e-04 per=5.6e+01 cost=5.1e+04 flops=1.5e+08
 sigma[red] counter=80 t=2.0e-04 per=3.3e+01 cost=1.5e+04 flops=7.5e+07
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.5e-02 t_reduction=4.6e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=80 t=1.0e-02 per=9.3e+00 cost=3.3e+07 flops=3.2e+09
 sigma_tot[gemm] counter=80 i=0 t=1.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=3 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=4 t=1.3e-02 per=1.1e+01 cost=7.6e+06 flops=6.0e+08
 sigma_tot[gemm] counter=80 i=5 t=1.4e-02 per=1.3e+01 cost=7.7e+06 flops=5.3e+08
 sigma_tot[gemm] counter=80 i=6 t=1.4e-02 per=1.2e+01 cost=7.3e+06 flops=5.4e+08
 sigma_tot[gemm] counter=80 i=7 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.5e+08
 sigma_tot[gemm] counter=80 total t=5.5e-02 per=4.9e+01 cost=3.0e+07 flops=5.5e+08
 sigma_tot[red] counter=80 t=4.6e-02 per=4.1e+01 cost=6.9e+06 flops=1.5e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,1.2e-05,1.9e-06,1.0e-06,1.6e-07
    3   0 -    -116.298781495821 -4.808e-04  3.350e-03    3     3  2.591e-03 8.635e-04 8.190e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.926e-05,6.745e-05,3.419e-04,2.047e-04,6.763e-04
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.056e-05 speed=2.609e-02GB/S T(nccl)=3.870e-05 speed=1.386e-02GB/S
----- TIMING FOR sigma : t_inter=6.7e-05 t_gemm=3.4e-04 t_reduction=2.0e-04 tot=6.1e-04 -----
 sigma[inter] counter=81 t=6.7e-05 per=1.1e+01 cost=9.2e+04 flops=1.4e+09
 sigma[gemm] counter=81 i=0 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=4 t=6.5e-05 per=1.1e+01 cost=1.3e+04 flops=2.0e+08
 sigma[gemm] counter=81 i=5 t=8.4e-05 per=1.4e+01 cost=1.3e+04 flops=1.6e+08
 sigma[gemm] counter=81 i=6 t=9.6e-05 per=1.6e+01 cost=1.2e+04 flops=1.3e+08
 sigma[gemm] counter=81 i=7 t=8.9e-05 per=1.4e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=81 total t=3.4e-04 per=5.6e+01 cost=5.1e+04 flops=1.5e+08
 sigma[red] counter=81 t=2.0e-04 per=3.3e+01 cost=1.5e+04 flops=7.5e+07
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.5e-02 t_reduction=4.6e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=81 t=1.0e-02 per=9.3e+00 cost=3.3e+07 flops=3.2e+09
 sigma_tot[gemm] counter=81 i=0 t=1.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=3 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=4 t=1.3e-02 per=1.1e+01 cost=7.6e+06 flops=6.0e+08
 sigma_tot[gemm] counter=81 i=5 t=1.5e-02 per=1.3e+01 cost=7.7e+06 flops=5.3e+08
 sigma_tot[gemm] counter=81 i=6 t=1.4e-02 per=1.2e+01 cost=7.3e+06 flops=5.4e+08
 sigma_tot[gemm] counter=81 i=7 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.4e+08
 sigma_tot[gemm] counter=81 total t=5.5e-02 per=4.9e+01 cost=3.0e+07 flops=5.4e+08
 sigma_tot[red] counter=81 t=4.6e-02 per=4.1e+01 cost=7.0e+06 flops=1.5e+08
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,9.1e-06,1.6e-06,1.0e-06,1.5e-07
    4   0 -    -116.298816092521 -3.460e-05  1.166e-03    3     4  3.392e-03 8.479e-04 8.065e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.887e-05,6.592e-05,3.257e-04,2.009e-04,6.541e-04
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.034e-05 speed=2.637e-02GB/S T(nccl)=3.853e-05 speed=1.392e-02GB/S
----- TIMING FOR sigma : t_inter=6.6e-05 t_gemm=3.3e-04 t_reduction=2.0e-04 tot=5.9e-04 -----
 sigma[inter] counter=82 t=6.6e-05 per=1.1e+01 cost=9.2e+04 flops=1.4e+09
 sigma[gemm] counter=82 i=0 t=1.9e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=1.9e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=3 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=4 t=6.1e-05 per=1.0e+01 cost=1.3e+04 flops=2.1e+08
 sigma[gemm] counter=82 i=5 t=8.2e-05 per=1.4e+01 cost=1.3e+04 flops=1.6e+08
 sigma[gemm] counter=82 i=6 t=8.7e-05 per=1.5e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=82 i=7 t=8.7e-05 per=1.5e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=82 total t=3.3e-04 per=5.5e+01 cost=5.1e+04 flops=1.6e+08
 sigma[red] counter=82 t=2.0e-04 per=3.4e+01 cost=1.5e+04 flops=7.6e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.5e-02 t_reduction=4.6e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=82 t=1.1e-02 per=9.4e+00 cost=3.3e+07 flops=3.2e+09
 sigma_tot[gemm] counter=82 i=0 t=1.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=3 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=4 t=1.3e-02 per=1.1e+01 cost=7.6e+06 flops=6.0e+08
 sigma_tot[gemm] counter=82 i=5 t=1.5e-02 per=1.3e+01 cost=7.7e+06 flops=5.3e+08
 sigma_tot[gemm] counter=82 i=6 t=1.4e-02 per=1.2e+01 cost=7.3e+06 flops=5.3e+08
 sigma_tot[gemm] counter=82 i=7 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.4e+08
 sigma_tot[gemm] counter=82 total t=5.5e-02 per=4.9e+01 cost=3.0e+07 flops=5.4e+08
 sigma_tot[red] counter=82 t=4.6e-02 per=4.1e+01 cost=7.0e+06 flops=1.5e+08
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,9.7e-06,1.6e-06,1.1e-06,1.3e-07
    5   0 -    -116.298821082599 -4.990e-06  3.193e-04    3     5  4.300e-03 8.600e-04 8.185e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.986e-05,6.757e-05,3.276e-04,2.104e-04,6.685e-04
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.068e-05 speed=2.594e-02GB/S T(nccl)=3.918e-05 speed=1.369e-02GB/S
----- TIMING FOR sigma : t_inter=6.8e-05 t_gemm=3.3e-04 t_reduction=2.1e-04 tot=6.1e-04 -----
 sigma[inter] counter=83 t=6.8e-05 per=1.1e+01 cost=9.2e+04 flops=1.4e+09
 sigma[gemm] counter=83 i=0 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=3 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=4 t=6.2e-05 per=1.0e+01 cost=1.3e+04 flops=2.1e+08
 sigma[gemm] counter=83 i=5 t=8.2e-05 per=1.4e+01 cost=1.3e+04 flops=1.6e+08
 sigma[gemm] counter=83 i=6 t=8.7e-05 per=1.4e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=83 i=7 t=8.9e-05 per=1.5e+01 cost=1.2e+04 flops=1.4e+08
 sigma[gemm] counter=83 total t=3.3e-04 per=5.4e+01 cost=5.1e+04 flops=1.6e+08
 sigma[red] counter=83 t=2.1e-04 per=3.5e+01 cost=1.5e+04 flops=7.3e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.6e-02 t_reduction=4.6e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=83 t=1.1e-02 per=9.4e+00 cost=3.3e+07 flops=3.2e+09
 sigma_tot[gemm] counter=83 i=0 t=1.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=3 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=4 t=1.3e-02 per=1.1e+01 cost=7.6e+06 flops=6.0e+08
 sigma_tot[gemm] counter=83 i=5 t=1.5e-02 per=1.3e+01 cost=7.7e+06 flops=5.2e+08
 sigma_tot[gemm] counter=83 i=6 t=1.4e-02 per=1.2e+01 cost=7.3e+06 flops=5.3e+08
 sigma_tot[gemm] counter=83 i=7 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.4e+08
 sigma_tot[gemm] counter=83 total t=5.6e-02 per=4.9e+01 cost=3.0e+07 flops=5.4e+08
 sigma_tot[red] counter=83 t=4.6e-02 per=4.1e+01 cost=7.0e+06 flops=1.5e+08
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,9.3e-06,1.6e-06,1.1e-06,1.4e-07
    6   0 +    -116.298821391660 -3.091e-07  6.914e-05    3     6  5.135e-03 8.558e-04 8.155e-04
TIMING FOR Davidson : 5.144e-03  T(cal/comm/rest)=4.893e-03,1.496e-06,2.500e-04
decomposed t_rest=2.500e-04
 T(sub)    =8.514e-05 per=3.406e+01
 T(precond)=1.525e-05 per=6.100e+00
 T(ortho)  =7.036e-06 per=2.815e+00
 T(xcopy)  =8.670e-07 per=3.468e-01
 T(xnrm2)  =7.720e-07 per=3.088e-01
 T(other)  =1.409e-04 per=5.637e+01
optimized energies: isweep=0 ibond=12 dots=2 e[0]=-116.298821391660 nmvp=6
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=6.676e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=9 dimAll=36
 (20,2):5 (22,2):4 (21,1):3 (21,3):9 (20,4):5 (22,4):4 (21,5):3 (19,3):2 (23,3):1
timing for divide=3.1e-06
timing for compute=2.5e-05
timing for collect=3.3e-06
----- TMING FOR decimation_genbasis(su2): 3.1e-05 S T(divide/compute[cpu/gpu/rest]/collect)=3.1e-06,2.3e-05,0.0e+00,2.1e-06,3.3e-06 -----
decimation summary: 36->7 dwt=-2.220e-16 SvN=3.298e-01
 qbond: qkept nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
----- TIMING for decimation_row(nkr): 8.358e-04 S T(decim/select/formRot)=5.011e-05,7.727e-04,1.305e-05 -----
----- TIMING FOR twodot_decimation: 8.679e-04 S T(wf/decim)=2.639e-05,8.415e-04 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:14 S:3 H:1 P:17 Q:22 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=625:4.768e-03MB:4.657e-06GB
        per(mem): C:26.9 S:5.76 H:2.08 P:5.44 Q:59.8 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=8.550e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=54 : 2.334e-04 S -----
rank=0 GPUmem(GB): used=4.106e-05 (oper)=2.156e-05
rank=0 GPUmem(GB): used=4.132e-05 (oper,site)=2.156e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=54
 no. of rintermediate operators=61
 no. of coefficients=793:6.050e-03MB:5.908e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.385e-05 S -----
rank=0 GPUmem(GB): used=4.723e-05 (oper,site,rinter)=2.156e-05,2.608e-07,5.908e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.155e-03 S size(rtasks)=54 size(Rlst2)=16 T(Rmu/Rlist)=7.484e-05,1.080e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.232e-03 S size(rtasks)=54 size(Rlst)=1017 -----
rank=0 GPUmem(GB): used=4.723e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.440e-04 blksize=6 blksize0=6 batchsize=1017
rank=0 GPUmem(GB): used=1.912e-04 (oper,site,rinter,batch)=2.156e-05,2.608e-07,5.908e-06,1.440e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.676e-05,3.211e-04,1.297e-04
----- TIMING FOR renorm : t_inter=8.7e-05 t_gemm=3.2e-04 t_reduction=1.3e-04 tot=5.4e-04 -----
 renorm[inter] counter=159 t=8.7e-05 per=1.6e+01 cost=3.4e+04 flops=3.9e+08
 renorm[gemm] counter=159 i=0 t=2.1e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=159 i=1 t=1.8e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=159 i=2 t=1.9e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=159 i=3 t=1.8e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=159 i=4 t=1.2e-04 per=2.2e+01 cost=3.4e+03 flops=3.0e+07
 renorm[gemm] counter=159 i=5 t=1.0e-04 per=1.9e+01 cost=1.0e+04 flops=1.0e+08
 renorm[gemm] counter=159 i=6 t=9.3e-05 per=1.7e+01 cost=1.6e+04 flops=1.7e+08
 renorm[gemm] counter=159 total t=3.2e-04 per=6.0e+01 cost=2.9e+04 flops=9.2e+07
 renorm[red] counter=159 t=1.3e-04 per=2.4e+01 cost=7.6e+03 flops=5.8e+07
----- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=4.7e-03 t_reduction=1.9e-03 tot=7.8e-03 -----
 renorm_tot[inter] counter=159 t=1.2e-03 per=1.6e+01 cost=2.8e+05 flops=2.3e+08
 renorm_tot[gemm] counter=159 i=0 t=2.8e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=159 i=1 t=2.5e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=159 i=2 t=2.5e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=159 i=3 t=2.5e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=159 i=4 t=1.5e-03 per=1.9e+01 cost=4.1e+04 flops=2.7e+07
 renorm_tot[gemm] counter=159 i=5 t=1.6e-03 per=2.0e+01 cost=2.1e+05 flops=1.3e+08
 renorm_tot[gemm] counter=159 i=6 t=1.5e-03 per=1.9e+01 cost=3.8e+05 flops=2.6e+08
 renorm_tot[gemm] counter=159 total t=4.7e-03 per=6.0e+01 cost=6.4e+05 flops=1.4e+08
 renorm_tot[red] counter=159 t=1.9e-03 per=2.4e+01 cost=1.6e+05 flops=8.6e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.793e-05 (oper)=2.165e-05
rank=0 GPUmem(GB): used=4.819e-05 (oper,site,rinter)=2.165e-05,2.608e-07,8.717e-07
rank=0 GPUmem(GB): used=5.414e-05 (oper,site,rinter,batch)=2.165e-05,2.608e-07,8.717e-07,5.946e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.998e-03 S T(preprocess/alloc/comp/red/dealloc)=4.158e-04,4.518e-04,1.368e-03,1.222e-04,4.338e-05 -----
----- TIMING FOR oper_renorm_opS : 2.011e-03 S rank=0 -----
qops.to_cpu: size(tot)=625:4.768e-03MB:4.657e-06GB T(to_cpu)=2.836e-05S speed=1.642e-01GB/S
check ||H-H.dagger||=2.451e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.00499 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=3.314e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=6.409e-04 change=-1.253e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=6.409e-04 change=-2.652e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 2.182e-02 S #####
 T(local opt: fetch) = 2.295e-03 S  per = 10.5  per(accum) = 10.5
 T(local opt: hdiag) = 1.331e-03 S  per =  6.1  per(accum) = 16.6
 T(local opt: dvdsn) = 9.825e-03 S  per =   45  per(accum) = 61.6
 T(local opt: decim) = 8.926e-04 S  per = 4.09  per(accum) = 65.7
 T(local opt: guess) = 3.473e-05 S  per = 0.159  per(accum) = 65.9
 T(local opt: renrm) = 5.613e-03 S  per = 25.7  per(accum) = 91.6
 T(local opt: save ) = 1.833e-03 S  per =  8.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.825e-03 S  T(sum) = 9.620e-03 S  per = 9.791e+01
 T(local opt: preprocess                  ) = 7.268e-05 S  per = 0.755  per(accum) = 0.755
 T(local opt: symbolic_formulae           ) = 4.423e-04 S  per =  4.6  per(accum) = 5.35
 T(local opt: hintermediate init          ) = 6.673e-05 S  per = 0.694  per(accum) = 6.05
 T(local opt: preprocess_hformulae_Hxlist ) = 3.264e-03 S  per = 33.9  per(accum) = 40
 T(local opt: hmmtasks init               ) = 5.732e-04 S  per = 5.96  per(accum) = 45.9
 T(local opt: initial guess for dvdson    ) = 5.661e-05 S  per = 0.588  per(accum) = 46.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.522e-03 S  per =   47  per(accum) = 93.5
 T(local opt: dvdson [cpu-gpu]            ) = 1.262e-04 S  per = 1.31  per(accum) = 94.8
 T(local opt: dvdson [nccl]               ) = 2.444e-04 S  per = 2.54  per(accum) = 97.4
 T(local opt: dvdson [mpi]                ) = 1.496e-06 S  per = 0.0156  per(accum) = 97.4
 T(local opt: dvdson [rest part(linalg)]  ) = 2.500e-04 S  per =  2.6  per(accum) = 100
Detailed decomposition of T(renrm) = 5.613e-03 S  T(sum) = 5.613e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.972e-05 S  per = 0.708  per(accum) = 0.708
 T(local opt: qops init                    ) = 2.695e-04 S  per =  4.8  per(accum) = 5.51
 T(local opt: symbolic_formulae_renorm     ) = 2.379e-04 S  per = 4.24  per(accum) = 9.75
 T(local opt: allocate qops on gpu         ) = 4.877e-05 S  per = 0.869  per(accum) = 10.6
 T(local opt: site memcpy cpu2gpu          ) = 1.938e-05 S  per = 0.345  per(accum) = 11
 T(local opt: rintermediate init           ) = 4.038e-05 S  per = 0.719  per(accum) = 11.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.237e-03 S  per =   22  per(accum) = 33.7
 T(local opt: rmmtasks init                ) = 4.142e-04 S  per = 7.38  per(accum) = 41.1
 T(local opt: qops memset on cpu           ) = 4.500e-08 S  per = 0.000802  per(accum) = 41.1
 T(local opt: preprocess_renorm_batchGPU   ) = 6.240e-04 S  per = 11.1  per(accum) = 52.2
 T(local opt: deallocate cpu and gpu memory) = 2.794e-05 S  per = 0.498  per(accum) = 52.7
 T(local opt: construct opS [ifdists=true] ) = 2.017e-03 S  per = 35.9  per(accum) = 88.6
 T(local opt: reduction of opS & opH [nccl]) = 1.771e-05 S  per = 0.316  per(accum) = 89
 T(local opt: qops memcpy gpu2cpu          ) = 3.217e-05 S  per = 0.573  per(accum) = 89.5
 T(local opt: reduction of opS & opH [mpi] ) = 8.524e-06 S  per = 0.152  per(accum) = 89.7
 T(local opt: qops_pool join and erase     ) = 5.764e-04 S  per = 10.3  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.492e-06 S  per = 0.0444  per(accum) = 100
ctns::rcanon_save_site idx=6 scratch=./scratch/sweep size=35:2.6e-07GB T(load)=0.00057S speed=0.00046GB/S
##### sweep opt: 6.037e-01 S #####
 T(sweep opt: fetch) = 3.531e-02 S  per = 5.85  per(accum) = 5.85
 T(sweep opt: hdiag) = 3.424e-02 S  per = 5.67  per(accum) = 11.5
 T(sweep opt: dvdsn) = 3.772e-01 S  per = 62.5  per(accum) = 74
 T(sweep opt: decim) = 1.456e-02 S  per = 2.41  per(accum) = 76.4
 T(sweep opt: guess) = 1.155e-03 S  per = 0.191  per(accum) = 76.6
 T(sweep opt: renrm) = 1.173e-01 S  per = 19.4  per(accum) = 96.1
 T(sweep opt: save ) = 2.384e-02 S  per = 3.95  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.772e-01 S  T(sum) = 3.714e-01 S  per = 9.846e+01
 T(sweep opt: preprocess                  ) = 4.046e-03 S  per = 1.09  per(accum) = 1.09
 T(sweep opt: symbolic_formulae           ) = 7.091e-03 S  per = 1.91  per(accum) = 3
 T(sweep opt: hintermediate init          ) = 9.817e-04 S  per = 0.264  per(accum) = 3.26
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.793e-01 S  per = 48.3  per(accum) = 51.5
 T(sweep opt: hmmtasks init               ) = 3.586e-02 S  per = 9.66  per(accum) = 61.2
 T(sweep opt: initial guess for dvdson    ) = 1.846e-03 S  per = 0.497  per(accum) = 61.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.311e-01 S  per = 35.3  per(accum) = 97
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.871e-03 S  per = 0.504  per(accum) = 97.5
 T(sweep opt: dvdson [nccl]               ) = 4.502e-03 S  per = 1.21  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 3.396e-05 S  per = 0.00914  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.682e-03 S  per = 1.26  per(accum) = 100
Detailed decomposition of T(renrm) = 1.173e-01 S  T(sum) = 1.173e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.882e-04 S  per = 0.586  per(accum) = 0.586
 T(sweep opt: qops init                    ) = 4.572e-03 S  per =  3.9  per(accum) = 4.48
 T(sweep opt: symbolic_formulae_renorm     ) = 2.531e-03 S  per = 2.16  per(accum) = 6.64
 T(sweep opt: allocate qops on gpu         ) = 7.422e-04 S  per = 0.632  per(accum) = 7.27
 T(sweep opt: site memcpy cpu2gpu          ) = 3.211e-04 S  per = 0.274  per(accum) = 7.54
 T(sweep opt: rintermediate init           ) = 6.214e-04 S  per = 0.53  per(accum) = 8.07
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.677e-02 S  per = 14.3  per(accum) = 22.4
 T(sweep opt: rmmtasks init                ) = 5.329e-03 S  per = 4.54  per(accum) = 26.9
 T(sweep opt: qops memset on cpu           ) = 6.480e-07 S  per = 0.000552  per(accum) = 26.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.527e-03 S  per = 8.12  per(accum) = 35
 T(sweep opt: deallocate cpu and gpu memory) = 3.867e-04 S  per = 0.33  per(accum) = 35.4
 T(sweep opt: construct opS [ifdists=true] ) = 6.222e-02 S  per =   53  per(accum) = 88.4
 T(sweep opt: reduction of opS & opH [nccl]) = 2.410e-04 S  per = 0.205  per(accum) = 88.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.616e-04 S  per = 0.393  per(accum) = 89
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.237e-04 S  per = 0.105  per(accum) = 89.1
 T(sweep opt: qops_pool join and erase     ) = 1.004e-02 S  per = 8.56  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 2.773e-03 S  per = 2.36  per(accum) = 100
##### global opt: 6.037e-01 S #####
 T(global opt: fetch) = 3.531e-02 S  per = 5.85  per(accum) = 5.85
 T(global opt: hdiag) = 3.424e-02 S  per = 5.67  per(accum) = 11.5
 T(global opt: dvdsn) = 3.772e-01 S  per = 62.5  per(accum) = 74
 T(global opt: decim) = 1.456e-02 S  per = 2.41  per(accum) = 76.4
 T(global opt: guess) = 1.155e-03 S  per = 0.191  per(accum) = 76.6
 T(global opt: renrm) = 1.173e-01 S  per = 19.4  per(accum) = 96.1
 T(global opt: save ) = 2.384e-02 S  per = 3.95  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.772e-01 S  T(sum) = 3.714e-01 S  per = 9.846e+01
 T(global opt: preprocess                  ) = 4.046e-03 S  per = 1.09  per(accum) = 1.09
 T(global opt: symbolic_formulae           ) = 7.091e-03 S  per = 1.91  per(accum) = 3
 T(global opt: hintermediate init          ) = 9.817e-04 S  per = 0.264  per(accum) = 3.26
 T(global opt: preprocess_hformulae_Hxlist ) = 1.793e-01 S  per = 48.3  per(accum) = 51.5
 T(global opt: hmmtasks init               ) = 3.586e-02 S  per = 9.66  per(accum) = 61.2
 T(global opt: initial guess for dvdson    ) = 1.846e-03 S  per = 0.497  per(accum) = 61.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.311e-01 S  per = 35.3  per(accum) = 97
 T(global opt: dvdson [cpu-gpu]            ) = 1.871e-03 S  per = 0.504  per(accum) = 97.5
 T(global opt: dvdson [nccl]               ) = 4.502e-03 S  per = 1.21  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 3.396e-05 S  per = 0.00914  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 4.682e-03 S  per = 1.26  per(accum) = 100
Detailed decomposition of T(renrm) = 1.173e-01 S  T(sum) = 1.173e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.882e-04 S  per = 0.586  per(accum) = 0.586
 T(global opt: qops init                    ) = 4.572e-03 S  per =  3.9  per(accum) = 4.48
 T(global opt: symbolic_formulae_renorm     ) = 2.531e-03 S  per = 2.16  per(accum) = 6.64
 T(global opt: allocate qops on gpu         ) = 7.422e-04 S  per = 0.632  per(accum) = 7.27
 T(global opt: site memcpy cpu2gpu          ) = 3.211e-04 S  per = 0.274  per(accum) = 7.54
 T(global opt: rintermediate init           ) = 6.214e-04 S  per = 0.53  per(accum) = 8.07
 T(global opt: preprocess_formulae_Rlist2   ) = 1.677e-02 S  per = 14.3  per(accum) = 22.4
 T(global opt: rmmtasks init                ) = 5.329e-03 S  per = 4.54  per(accum) = 26.9
 T(global opt: qops memset on cpu           ) = 6.480e-07 S  per = 0.000552  per(accum) = 26.9
 T(global opt: preprocess_renorm_batchGPU   ) = 9.527e-03 S  per = 8.12  per(accum) = 35
 T(global opt: deallocate cpu and gpu memory) = 3.867e-04 S  per = 0.33  per(accum) = 35.4
 T(global opt: construct opS [ifdists=true] ) = 6.222e-02 S  per =   53  per(accum) = 88.4
 T(global opt: reduction of opS & opH [nccl]) = 2.410e-04 S  per = 0.205  per(accum) = 88.6
 T(global opt: qops memcpy gpu2cpu          ) = 4.616e-04 S  per = 0.393  per(accum) = 89
 T(global opt: reduction of opS & opH [mpi] ) = 1.237e-04 S  per = 0.105  per(accum) = 89.1
 T(global opt: qops_pool join and erase     ) = 1.004e-02 S  per = 8.56  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 2.773e-03 S  per = 2.36  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-6.735e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=13/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=4 scratch=./scratch/sweep size=6:4.47e-08GB T(load)=3.16e-04S speed=1.42e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=14:1.07e-04MB:1.04e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=14:1.07e-04MB:1.04e-07GB
total mem of comb=29:2.21e-04MB:2.16e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=7.004e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:14 S:3 H:1 P:17 Q:22 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=625:4.768e-03MB:4.657e-06GB
        per(mem): C:26.9 S:5.76 H:2.08 P:5.44 Q:59.8 
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=79:0.000603MB:5.89e-07GB
        per(mem): C:10.1 S:20.3 H:6.33 A:0 B:63.3 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2700:0.0206MB:2.01e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.192e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.788e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,3,3,3) nnz=44:3.357e-04MB
qtensor4: wf4 own=1 _data=0x5585ef0f8160
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
 qbond: qcol nsym=2 dimAll=3
 (5,3):2 (6,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=18 nblocks=128 size=44:3.357e-04MB
### DIAG TIMING: total=1.220e-03 t1=1.577e-05, t2=1.738e-05, t3=1.593e-05, t4=1.123e-03, t5=6.222e-06, t6=3.564e-05, t7=6.625e-06
duration_diagGPU:1.229e-03
duration_diagreduce:3.600e-08
duration_diagtransform:1.560e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 3.125e-04 S -----
rank=0 GPUmem(GB): used=2.012e-05 (oper)=2.012e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=195
 no. of hintermediate operators=94
 no. of coefficients=1215:9.270e-03MB:9.052e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.964e-05 S -----
rank=0 GPUmem(GB): used=2.917e-05 (oper,hinter)=2.012e-05,9.052e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.232e-03 S size(H_formulae)=195 size(Hxlst2)=18 T(Hmu/Hxlist)=7.941e-05,6.152e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.589e-03 S size(H_formulae)=195 size(Hxlst)=3722 -----
rank=0 GPUmem(GB): used=2.917e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=6.557e-07 batch[need]=3.605e-04 blksize=4 blksize0=4 batchsize=3722
rank=0 GPUmem(GB): used=3.903e-04 (oper,hinter,dvdson,batch)=2.012e-05,9.052e-06,6.557e-07,3.605e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=44 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.055e-05,9.907e-05,3.503e-04,5.126e-04,1.040e-03
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.244e-05 speed=2.921e-02GB/S T(nccl)=4.811e-05 speed=1.363e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-05 t_gemm=3.5e-04 t_reduction=5.1e-04 tot=9.6e-04 -----
 sigma[inter] counter=84 t=9.9e-05 per=1.0e+01 cost=1.2e+05 flops=1.2e+09
 sigma[gemm] counter=84 i=0 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=1.6e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=1.6e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=3 t=1.7e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=4 t=9.6e-05 per=1.0e+01 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=84 i=5 t=8.7e-05 per=9.1e+00 cost=1.1e+04 flops=1.3e+08
 sigma[gemm] counter=84 i=6 t=8.0e-05 per=8.3e+00 cost=1.2e+04 flops=1.5e+08
 sigma[gemm] counter=84 i=7 t=7.9e-05 per=8.3e+00 cost=1.3e+04 flops=1.6e+08
 sigma[gemm] counter=84 total t=3.5e-04 per=3.6e+01 cost=4.7e+04 flops=1.3e+08
 sigma[red] counter=84 t=5.1e-04 per=5.3e+01 cost=1.8e+04 flops=3.6e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.6e-02 t_reduction=4.7e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=84 t=1.1e-02 per=9.4e+00 cost=3.4e+07 flops=3.1e+09
 sigma_tot[gemm] counter=84 i=0 t=2.0e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=1.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=3 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=4 t=1.3e-02 per=1.1e+01 cost=7.7e+06 flops=5.9e+08
 sigma_tot[gemm] counter=84 i=5 t=1.5e-02 per=1.3e+01 cost=7.7e+06 flops=5.2e+08
 sigma_tot[gemm] counter=84 i=6 t=1.4e-02 per=1.2e+01 cost=7.3e+06 flops=5.3e+08
 sigma_tot[gemm] counter=84 i=7 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.4e+08
 sigma_tot[gemm] counter=84 total t=5.6e-02 per=4.9e+01 cost=3.0e+07 flops=5.4e+08
 sigma_tot[red] counter=84 t=4.7e-02 per=4.1e+01 cost=7.0e+06 flops=1.5e+08
T(sub)=7.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,2.6e-06,9.3e-07,9.1e-07,2.3e-07
settings: ndim=44 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.298821391660 -1.116e+03  2.683e-02    1     1  1.292e-03 1.292e-03 1.264e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.488e-05,8.639e-05,3.885e-04,5.386e-04,1.082e-03
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.201e-05 speed=2.979e-02GB/S T(nccl)=4.287e-05 speed=1.529e-02GB/S
----- TIMING FOR sigma : t_inter=8.6e-05 t_gemm=3.9e-04 t_reduction=5.4e-04 tot=1.0e-03 -----
 sigma[inter] counter=85 t=8.6e-05 per=8.5e+00 cost=1.2e+05 flops=1.4e+09
 sigma[gemm] counter=85 i=0 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=4 t=9.5e-05 per=9.4e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=85 i=5 t=1.0e-04 per=9.9e+00 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=85 i=6 t=9.4e-05 per=9.2e+00 cost=1.2e+04 flops=1.3e+08
 sigma[gemm] counter=85 i=7 t=9.1e-05 per=9.0e+00 cost=1.3e+04 flops=1.4e+08
 sigma[gemm] counter=85 total t=3.9e-04 per=3.8e+01 cost=4.7e+04 flops=1.2e+08
 sigma[red] counter=85 t=5.4e-04 per=5.3e+01 cost=1.8e+04 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.7e-02 t_reduction=4.8e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=85 t=1.1e-02 per=9.4e+00 cost=3.4e+07 flops=3.1e+09
 sigma_tot[gemm] counter=85 i=0 t=2.0e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=1.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=3 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=4 t=1.3e-02 per=1.1e+01 cost=7.7e+06 flops=5.9e+08
 sigma_tot[gemm] counter=85 i=5 t=1.5e-02 per=1.3e+01 cost=7.7e+06 flops=5.2e+08
 sigma_tot[gemm] counter=85 i=6 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.3e+08
 sigma_tot[gemm] counter=85 i=7 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.3e+08
 sigma_tot[gemm] counter=85 total t=5.7e-02 per=4.9e+01 cost=3.0e+07 flops=5.3e+08
 sigma_tot[red] counter=85 t=4.8e-02 per=4.1e+01 cost=7.0e+06 flops=1.5e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,9.7e-06,2.7e-06,1.1e-06,2.7e-07
    2   0 -    -116.301168729010 -2.347e-03  9.570e-03    2     2  2.656e-03 1.328e-03 1.280e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.327e-05,8.219e-05,3.846e-04,5.349e-04,1.071e-03
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.149e-05 speed=3.051e-02GB/S T(nccl)=4.178e-05 speed=1.569e-02GB/S
----- TIMING FOR sigma : t_inter=8.2e-05 t_gemm=3.8e-04 t_reduction=5.3e-04 tot=1.0e-03 -----
 sigma[inter] counter=86 t=8.2e-05 per=8.2e+00 cost=1.2e+05 flops=1.5e+09
 sigma[gemm] counter=86 i=0 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=4 t=9.4e-05 per=9.4e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=86 i=5 t=9.8e-05 per=9.8e+00 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=86 i=6 t=9.2e-05 per=9.2e+00 cost=1.2e+04 flops=1.3e+08
 sigma[gemm] counter=86 i=7 t=9.2e-05 per=9.2e+00 cost=1.3e+04 flops=1.4e+08
 sigma[gemm] counter=86 total t=3.8e-04 per=3.8e+01 cost=4.7e+04 flops=1.2e+08
 sigma[red] counter=86 t=5.3e-04 per=5.3e+01 cost=1.8e+04 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.7e-02 t_reduction=4.8e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=86 t=1.1e-02 per=9.4e+00 cost=3.4e+07 flops=3.1e+09
 sigma_tot[gemm] counter=86 i=0 t=2.0e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=1.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=3 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=4 t=1.3e-02 per=1.1e+01 cost=7.7e+06 flops=5.9e+08
 sigma_tot[gemm] counter=86 i=5 t=1.5e-02 per=1.3e+01 cost=7.7e+06 flops=5.2e+08
 sigma_tot[gemm] counter=86 i=6 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.2e+08
 sigma_tot[gemm] counter=86 i=7 t=1.4e-02 per=1.2e+01 cost=7.5e+06 flops=5.3e+08
 sigma_tot[gemm] counter=86 total t=5.7e-02 per=4.9e+01 cost=3.0e+07 flops=5.3e+08
 sigma_tot[red] counter=86 t=4.8e-02 per=4.1e+01 cost=7.0e+06 flops=1.5e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,2.0e-06,1.2e-06,2.0e-07
    3   0 -    -116.301414230834 -2.455e-04  3.487e-03    3     3  3.972e-03 1.324e-03 1.275e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.290e-05,8.263e-05,3.853e-04,5.342e-04,1.068e-03
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.102e-05 speed=3.119e-02GB/S T(nccl)=4.188e-05 speed=1.566e-02GB/S
----- TIMING FOR sigma : t_inter=8.3e-05 t_gemm=3.8e-04 t_reduction=5.3e-04 tot=1.0e-03 -----
 sigma[inter] counter=87 t=8.3e-05 per=8.2e+00 cost=1.2e+05 flops=1.5e+09
 sigma[gemm] counter=87 i=0 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=4 t=9.9e-05 per=9.8e+00 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=87 i=5 t=9.6e-05 per=9.6e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=87 i=6 t=9.1e-05 per=9.1e+00 cost=1.2e+04 flops=1.3e+08
 sigma[gemm] counter=87 i=7 t=9.2e-05 per=9.2e+00 cost=1.3e+04 flops=1.4e+08
 sigma[gemm] counter=87 total t=3.8e-04 per=3.8e+01 cost=4.7e+04 flops=1.2e+08
 sigma[red] counter=87 t=5.3e-04 per=5.3e+01 cost=1.8e+04 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.7e-02 t_reduction=4.9e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=87 t=1.1e-02 per=9.3e+00 cost=3.4e+07 flops=3.1e+09
 sigma_tot[gemm] counter=87 i=0 t=2.0e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=1.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=3 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=4 t=1.3e-02 per=1.1e+01 cost=7.7e+06 flops=5.8e+08
 sigma_tot[gemm] counter=87 i=5 t=1.5e-02 per=1.3e+01 cost=7.7e+06 flops=5.1e+08
 sigma_tot[gemm] counter=87 i=6 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.2e+08
 sigma_tot[gemm] counter=87 i=7 t=1.4e-02 per=1.2e+01 cost=7.5e+06 flops=5.3e+08
 sigma_tot[gemm] counter=87 total t=5.7e-02 per=4.9e+01 cost=3.0e+07 flops=5.3e+08
 sigma_tot[red] counter=87 t=4.9e-02 per=4.2e+01 cost=7.1e+06 flops=1.5e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.1e-05,2.0e-06,1.1e-06,1.4e-07
    4   0 -    -116.301450947453 -3.672e-05  1.343e-03    3     4  5.281e-03 1.320e-03 1.272e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.335e-05,8.418e-05,3.854e-04,5.411e-04,1.078e-03
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.189e-05 speed=2.996e-02GB/S T(nccl)=4.146e-05 speed=1.581e-02GB/S
----- TIMING FOR sigma : t_inter=8.4e-05 t_gemm=3.9e-04 t_reduction=5.4e-04 tot=1.0e-03 -----
 sigma[inter] counter=88 t=8.4e-05 per=8.3e+00 cost=1.2e+05 flops=1.4e+09
 sigma[gemm] counter=88 i=0 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=4 t=9.8e-05 per=9.7e+00 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=88 i=5 t=1.0e-04 per=9.9e+00 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=88 i=6 t=9.0e-05 per=8.9e+00 cost=1.2e+04 flops=1.3e+08
 sigma[gemm] counter=88 i=7 t=9.0e-05 per=8.9e+00 cost=1.3e+04 flops=1.4e+08
 sigma[gemm] counter=88 total t=3.9e-04 per=3.8e+01 cost=4.7e+04 flops=1.2e+08
 sigma[red] counter=88 t=5.4e-04 per=5.4e+01 cost=1.8e+04 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.8e-02 t_reduction=4.9e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=88 t=1.1e-02 per=9.3e+00 cost=3.4e+07 flops=3.1e+09
 sigma_tot[gemm] counter=88 i=0 t=2.0e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=1.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=1.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=3 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=4 t=1.3e-02 per=1.1e+01 cost=7.7e+06 flops=5.8e+08
 sigma_tot[gemm] counter=88 i=5 t=1.5e-02 per=1.3e+01 cost=7.8e+06 flops=5.1e+08
 sigma_tot[gemm] counter=88 i=6 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.2e+08
 sigma_tot[gemm] counter=88 i=7 t=1.4e-02 per=1.2e+01 cost=7.5e+06 flops=5.3e+08
 sigma_tot[gemm] counter=88 total t=5.8e-02 per=4.9e+01 cost=3.0e+07 flops=5.3e+08
 sigma_tot[red] counter=88 t=4.9e-02 per=4.2e+01 cost=7.1e+06 flops=1.4e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.1e-05,1.8e-06,1.1e-06,1.5e-07
    5   0 -    -116.301456187403 -5.240e-06  3.883e-04    3     5  6.600e-03 1.320e-03 1.273e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.119e-05,8.138e-05,3.814e-04,5.301e-04,1.057e-03
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.076e-05 speed=3.158e-02GB/S T(nccl)=4.043e-05 speed=1.622e-02GB/S
----- TIMING FOR sigma : t_inter=8.1e-05 t_gemm=3.8e-04 t_reduction=5.3e-04 tot=9.9e-04 -----
 sigma[inter] counter=89 t=8.1e-05 per=8.2e+00 cost=1.2e+05 flops=1.5e+09
 sigma[gemm] counter=89 i=0 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=4 t=9.6e-05 per=9.6e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=89 i=5 t=9.6e-05 per=9.7e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=89 i=6 t=9.0e-05 per=9.1e+00 cost=1.2e+04 flops=1.3e+08
 sigma[gemm] counter=89 i=7 t=9.1e-05 per=9.2e+00 cost=1.3e+04 flops=1.4e+08
 sigma[gemm] counter=89 total t=3.8e-04 per=3.8e+01 cost=4.7e+04 flops=1.2e+08
 sigma[red] counter=89 t=5.3e-04 per=5.3e+01 cost=1.8e+04 flops=3.5e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.8e-02 t_reduction=5.0e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=89 t=1.1e-02 per=9.3e+00 cost=3.4e+07 flops=3.1e+09
 sigma_tot[gemm] counter=89 i=0 t=2.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=1.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=3 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=4 t=1.3e-02 per=1.1e+01 cost=7.7e+06 flops=5.8e+08
 sigma_tot[gemm] counter=89 i=5 t=1.5e-02 per=1.3e+01 cost=7.8e+06 flops=5.1e+08
 sigma_tot[gemm] counter=89 i=6 t=1.4e-02 per=1.2e+01 cost=7.4e+06 flops=5.2e+08
 sigma_tot[gemm] counter=89 i=7 t=1.4e-02 per=1.2e+01 cost=7.5e+06 flops=5.2e+08
 sigma_tot[gemm] counter=89 total t=5.8e-02 per=4.9e+01 cost=3.0e+07 flops=5.2e+08
 sigma_tot[red] counter=89 t=5.0e-02 per=4.2e+01 cost=7.1e+06 flops=1.4e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.1e-05,1.7e-06,1.0e-06,1.5e-07
    6   0 +    -116.301456582763 -3.954e-07  7.438e-05    3     6  7.895e-03 1.316e-03 1.269e-03
TIMING FOR Davidson : 7.908e-03  T(cal/comm/rest)=7.616e-03,2.127e-06,2.902e-04
decomposed t_rest=2.902e-04
 T(sub)    =9.777e-05 per=3.369e+01
 T(precond)=1.547e-05 per=5.331e+00
 T(ortho)  =7.300e-06 per=2.516e+00
 T(xcopy)  =8.420e-07 per=2.902e-01
 T(xnrm2)  =6.920e-07 per=2.385e-01
 T(other)  =1.681e-04 per=5.793e+01
optimized energies: isweep=0 ibond=13 dots=2 e[0]=-116.301456582763 nmvp=6
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.054e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=9 dimAll=28
 (22,2):4 (24,2):3 (23,1):2 (23,3):7 (21,3):2 (22,4):4 (24,4):3 (23,5):2 (25,3):1
timing for divide=4.6e-06
timing for compute=4.9e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(su2): 6.4e-05 S T(divide/compute[cpu/gpu/rest]/collect)=4.6e-06,4.1e-05,0.0e+00,8.7e-06,1.0e-05 -----
decimation summary: 28->10 dwt=+7.605e-09 SvN=1.460e-01
 qbond: qkept nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
----- TIMING for decimation_row(nkr): 1.001e-03 S T(decim/select/formRot)=1.039e-04,8.656e-04,3.157e-05 -----
----- TIMING FOR twodot_decimation: 1.061e-03 S T(wf/decim)=5.038e-05,1.010e-03 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:15 S:3 H:1 P:12 Q:16 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=923:7.042e-03MB:6.877e-06GB
        per(mem): C:35.8 S:7.15 H:2.17 P:8.13 Q:46.8 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.385e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=44 : 1.690e-04 S -----
rank=0 GPUmem(GB): used=3.546e-05 (oper)=1.897e-05
rank=0 GPUmem(GB): used=3.576e-05 (oper,site)=1.897e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=44
 no. of rintermediate operators=44
 no. of coefficients=616:4.700e-03MB:4.590e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.149e-05 S -----
rank=0 GPUmem(GB): used=4.034e-05 (oper,site,rinter)=1.897e-05,2.980e-07,4.590e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.346e-03 S size(rtasks)=44 size(Rlst2)=36 T(Rmu/Rlist)=6.130e-05,1.284e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.491e-03 S size(rtasks)=44 size(Rlst)=1162 -----
rank=0 GPUmem(GB): used=4.034e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.991e-04 blksize=9 blksize0=4 batchsize=1162
rank=0 GPUmem(GB): used=2.395e-04 (oper,site,rinter,batch)=1.897e-05,2.980e-07,4.590e-06,1.991e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.258e-05,3.899e-04,1.692e-04
----- TIMING FOR renorm : t_inter=9.3e-05 t_gemm=3.9e-04 t_reduction=1.7e-04 tot=6.5e-04 -----
 renorm[inter] counter=166 t=9.3e-05 per=1.4e+01 cost=2.7e+04 flops=2.9e+08
 renorm[gemm] counter=166 i=0 t=2.0e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=1 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=2 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=3 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=4 t=1.3e-04 per=2.0e+01 cost=3.2e+03 flops=2.5e+07
 renorm[gemm] counter=166 i=5 t=1.2e-04 per=1.8e+01 cost=8.4e+03 flops=7.2e+07
 renorm[gemm] counter=166 i=6 t=1.4e-04 per=2.1e+01 cost=1.8e+04 flops=1.4e+08
 renorm[gemm] counter=166 total t=3.9e-04 per=6.0e+01 cost=3.0e+04 flops=7.7e+07
 renorm[red] counter=166 t=1.7e-04 per=2.6e+01 cost=1.1e+04 flops=6.5e+07
----- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=5.1e-03 t_reduction=2.0e-03 tot=8.5e-03 -----
 renorm_tot[inter] counter=166 t=1.3e-03 per=1.6e+01 cost=3.1e+05 flops=2.3e+08
 renorm_tot[gemm] counter=166 i=0 t=3.0e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=1 t=2.7e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=2 t=2.7e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=3 t=2.7e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=4 t=1.6e-03 per=1.9e+01 cost=4.4e+04 flops=2.7e+07
 renorm_tot[gemm] counter=166 i=5 t=1.7e-03 per=2.0e+01 cost=2.2e+05 flops=1.3e+08
 renorm_tot[gemm] counter=166 i=6 t=1.6e-03 per=1.9e+01 cost=4.0e+05 flops=2.5e+08
 renorm_tot[gemm] counter=166 total t=5.1e-03 per=6.0e+01 cost=6.7e+05 flops=1.3e+08
 renorm_tot[red] counter=166 t=2.0e-03 per=2.4e+01 cost=1.7e+05 flops=8.4e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.115e-05 (oper)=1.913e-05
rank=0 GPUmem(GB): used=4.145e-05 (oper,site,rinter)=1.913e-05,2.980e-07,9.388e-07
rank=0 GPUmem(GB): used=5.019e-05 (oper,site,rinter,batch)=1.913e-05,2.980e-07,9.388e-07,8.740e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.997e-03 S T(preprocess/alloc/comp/red/dealloc)=5.565e-04,6.076e-04,1.236e-03,1.004e-04,4.401e-05 -----
----- TIMING FOR oper_renorm_opS : 2.017e-03 S rank=0 -----
qops.to_cpu: size(tot)=923:7.042e-03MB:6.877e-06GB T(to_cpu)=2.614e-05S speed=2.631e-01GB/S
check ||H-H.dagger||=8.282e-15 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.00559 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=3.431e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=1.137e-03 change=-1.243e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=1.137e-03 change=-3.740e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 2.933e-02 S #####
 T(local opt: fetch) = 2.107e-03 S  per = 7.18  per(accum) = 7.18
 T(local opt: hdiag) = 1.277e-03 S  per = 4.35  per(accum) = 11.5
 T(local opt: dvdsn) = 1.670e-02 S  per = 56.9  per(accum) = 68.5
 T(local opt: decim) = 1.092e-03 S  per = 3.72  per(accum) = 72.2
 T(local opt: guess) = 5.410e-05 S  per = 0.184  per(accum) = 72.4
 T(local opt: renrm) = 6.257e-03 S  per = 21.3  per(accum) = 93.7
 T(local opt: save ) = 1.842e-03 S  per = 6.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.670e-02 S  T(sum) = 1.643e-02 S  per = 9.841e+01
 T(local opt: preprocess                  ) = 1.175e-04 S  per = 0.715  per(accum) = 0.715
 T(local opt: symbolic_formulae           ) = 3.168e-04 S  per = 1.93  per(accum) = 2.64
 T(local opt: hintermediate init          ) = 3.720e-05 S  per = 0.226  per(accum) = 2.87
 T(local opt: preprocess_hformulae_Hxlist ) = 6.612e-03 S  per = 40.2  per(accum) = 43.1
 T(local opt: hmmtasks init               ) = 1.377e-03 S  per = 8.38  per(accum) = 51.5
 T(local opt: initial guess for dvdson    ) = 6.615e-05 S  per = 0.402  per(accum) = 51.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 7.230e-03 S  per =   44  per(accum) = 95.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.296e-04 S  per = 0.789  per(accum) = 96.7
 T(local opt: dvdson [nccl]               ) = 2.565e-04 S  per = 1.56  per(accum) = 98.2
 T(local opt: dvdson [mpi]                ) = 2.127e-06 S  per = 0.0129  per(accum) = 98.2
 T(local opt: dvdson [rest part(linalg)]  ) = 2.902e-04 S  per = 1.77  per(accum) = 100
Detailed decomposition of T(renrm) = 6.257e-03 S  T(sum) = 6.257e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.991e-05 S  per = 0.798  per(accum) = 0.798
 T(local opt: qops init                    ) = 3.471e-04 S  per = 5.55  per(accum) = 6.35
 T(local opt: symbolic_formulae_renorm     ) = 1.796e-04 S  per = 2.87  per(accum) = 9.22
 T(local opt: allocate qops on gpu         ) = 5.802e-05 S  per = 0.927  per(accum) = 10.1
 T(local opt: site memcpy cpu2gpu          ) = 2.563e-05 S  per = 0.41  per(accum) = 10.6
 T(local opt: rintermediate init           ) = 5.268e-05 S  per = 0.842  per(accum) = 11.4
 T(local opt: preprocess_formulae_Rlist2   ) = 1.504e-03 S  per =   24  per(accum) = 35.4
 T(local opt: rmmtasks init                ) = 4.716e-04 S  per = 7.54  per(accum) = 43
 T(local opt: qops memset on cpu           ) = 5.200e-08 S  per = 0.000831  per(accum) = 43
 T(local opt: preprocess_renorm_batchGPU   ) = 8.219e-04 S  per = 13.1  per(accum) = 56.1
 T(local opt: deallocate cpu and gpu memory) = 3.049e-05 S  per = 0.487  per(accum) = 56.6
 T(local opt: construct opS [ifdists=true] ) = 2.030e-03 S  per = 32.4  per(accum) = 89
 T(local opt: reduction of opS & opH [nccl]) = 1.838e-05 S  per = 0.294  per(accum) = 89.3
 T(local opt: qops memcpy gpu2cpu          ) = 3.501e-05 S  per = 0.56  per(accum) = 89.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.778e-05 S  per = 0.284  per(accum) = 90.2
 T(local opt: qops_pool join and erase     ) = 6.127e-04 S  per = 9.79  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.200e-06 S  per = 0.0352  per(accum) = 100
ctns::rcanon_save_site idx=5 scratch=./scratch/sweep size=40:3e-07GB T(load)=0.00058S speed=0.00051GB/S
##### sweep opt: 6.330e-01 S #####
 T(sweep opt: fetch) = 3.742e-02 S  per = 5.91  per(accum) = 5.91
 T(sweep opt: hdiag) = 3.552e-02 S  per = 5.61  per(accum) = 11.5
 T(sweep opt: dvdsn) = 3.939e-01 S  per = 62.2  per(accum) = 73.8
 T(sweep opt: decim) = 1.565e-02 S  per = 2.47  per(accum) = 76.2
 T(sweep opt: guess) = 1.209e-03 S  per = 0.191  per(accum) = 76.4
 T(sweep opt: renrm) = 1.236e-01 S  per = 19.5  per(accum) = 95.9
 T(sweep opt: save ) = 2.568e-02 S  per = 4.06  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.939e-01 S  T(sum) = 3.878e-01 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 4.164e-03 S  per = 1.07  per(accum) = 1.07
 T(sweep opt: symbolic_formulae           ) = 7.408e-03 S  per = 1.91  per(accum) = 2.98
 T(sweep opt: hintermediate init          ) = 1.019e-03 S  per = 0.263  per(accum) = 3.25
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.859e-01 S  per = 47.9  per(accum) = 51.2
 T(sweep opt: hmmtasks init               ) = 3.724e-02 S  per =  9.6  per(accum) = 60.8
 T(sweep opt: initial guess for dvdson    ) = 1.912e-03 S  per = 0.493  per(accum) = 61.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.384e-01 S  per = 35.7  per(accum) = 97
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.001e-03 S  per = 0.516  per(accum) = 97.5
 T(sweep opt: dvdson [nccl]               ) = 4.759e-03 S  per = 1.23  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 3.608e-05 S  per = 0.0093  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.972e-03 S  per = 1.28  per(accum) = 100
Detailed decomposition of T(renrm) = 1.236e-01 S  T(sum) = 1.236e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.382e-04 S  per = 0.597  per(accum) = 0.597
 T(sweep opt: qops init                    ) = 4.919e-03 S  per = 3.98  per(accum) = 4.58
 T(sweep opt: symbolic_formulae_renorm     ) = 2.710e-03 S  per = 2.19  per(accum) = 6.77
 T(sweep opt: allocate qops on gpu         ) = 8.002e-04 S  per = 0.647  per(accum) = 7.42
 T(sweep opt: site memcpy cpu2gpu          ) = 3.467e-04 S  per = 0.28  per(accum) = 7.7
 T(sweep opt: rintermediate init           ) = 6.741e-04 S  per = 0.545  per(accum) = 8.24
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.827e-02 S  per = 14.8  per(accum) = 23
 T(sweep opt: rmmtasks init                ) = 5.800e-03 S  per = 4.69  per(accum) = 27.7
 T(sweep opt: qops memset on cpu           ) = 7.000e-07 S  per = 0.000566  per(accum) = 27.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.035e-02 S  per = 8.37  per(accum) = 36.1
 T(sweep opt: deallocate cpu and gpu memory) = 4.172e-04 S  per = 0.338  per(accum) = 36.4
 T(sweep opt: construct opS [ifdists=true] ) = 6.425e-02 S  per =   52  per(accum) = 88.4
 T(sweep opt: reduction of opS & opH [nccl]) = 2.594e-04 S  per = 0.21  per(accum) = 88.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.966e-04 S  per = 0.402  per(accum) = 89
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.415e-04 S  per = 0.114  per(accum) = 89.1
 T(sweep opt: qops_pool join and erase     ) = 1.065e-02 S  per = 8.62  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.775e-03 S  per = 2.24  per(accum) = 100
##### global opt: 6.330e-01 S #####
 T(global opt: fetch) = 3.742e-02 S  per = 5.91  per(accum) = 5.91
 T(global opt: hdiag) = 3.552e-02 S  per = 5.61  per(accum) = 11.5
 T(global opt: dvdsn) = 3.939e-01 S  per = 62.2  per(accum) = 73.8
 T(global opt: decim) = 1.565e-02 S  per = 2.47  per(accum) = 76.2
 T(global opt: guess) = 1.209e-03 S  per = 0.191  per(accum) = 76.4
 T(global opt: renrm) = 1.236e-01 S  per = 19.5  per(accum) = 95.9
 T(global opt: save ) = 2.568e-02 S  per = 4.06  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.939e-01 S  T(sum) = 3.878e-01 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 4.164e-03 S  per = 1.07  per(accum) = 1.07
 T(global opt: symbolic_formulae           ) = 7.408e-03 S  per = 1.91  per(accum) = 2.98
 T(global opt: hintermediate init          ) = 1.019e-03 S  per = 0.263  per(accum) = 3.25
 T(global opt: preprocess_hformulae_Hxlist ) = 1.859e-01 S  per = 47.9  per(accum) = 51.2
 T(global opt: hmmtasks init               ) = 3.724e-02 S  per =  9.6  per(accum) = 60.8
 T(global opt: initial guess for dvdson    ) = 1.912e-03 S  per = 0.493  per(accum) = 61.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.384e-01 S  per = 35.7  per(accum) = 97
 T(global opt: dvdson [cpu-gpu]            ) = 2.001e-03 S  per = 0.516  per(accum) = 97.5
 T(global opt: dvdson [nccl]               ) = 4.759e-03 S  per = 1.23  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 3.608e-05 S  per = 0.0093  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 4.972e-03 S  per = 1.28  per(accum) = 100
Detailed decomposition of T(renrm) = 1.236e-01 S  T(sum) = 1.236e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.382e-04 S  per = 0.597  per(accum) = 0.597
 T(global opt: qops init                    ) = 4.919e-03 S  per = 3.98  per(accum) = 4.58
 T(global opt: symbolic_formulae_renorm     ) = 2.710e-03 S  per = 2.19  per(accum) = 6.77
 T(global opt: allocate qops on gpu         ) = 8.002e-04 S  per = 0.647  per(accum) = 7.42
 T(global opt: site memcpy cpu2gpu          ) = 3.467e-04 S  per = 0.28  per(accum) = 7.7
 T(global opt: rintermediate init           ) = 6.741e-04 S  per = 0.545  per(accum) = 8.24
 T(global opt: preprocess_formulae_Rlist2   ) = 1.827e-02 S  per = 14.8  per(accum) = 23
 T(global opt: rmmtasks init                ) = 5.800e-03 S  per = 4.69  per(accum) = 27.7
 T(global opt: qops memset on cpu           ) = 7.000e-07 S  per = 0.000566  per(accum) = 27.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.035e-02 S  per = 8.37  per(accum) = 36.1
 T(global opt: deallocate cpu and gpu memory) = 4.172e-04 S  per = 0.338  per(accum) = 36.4
 T(global opt: construct opS [ifdists=true] ) = 6.425e-02 S  per =   52  per(accum) = 88.4
 T(global opt: reduction of opS & opH [nccl]) = 2.594e-04 S  per = 0.21  per(accum) = 88.6
 T(global opt: qops memcpy gpu2cpu          ) = 4.966e-04 S  per = 0.402  per(accum) = 89
 T(global opt: reduction of opS & opH [mpi] ) = 1.415e-04 S  per = 0.114  per(accum) = 89.1
 T(global opt: qops_pool join and erase     ) = 1.065e-02 S  per = 8.62  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 2.775e-03 S  per = 2.24  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.061e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=14/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=3 scratch=./scratch/sweep size=8:5.96e-08GB T(load)=3.12e-04S speed=1.91e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=14:1.07e-04MB:1.04e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=23:1.75e-04MB:1.71e-07GB
total mem of comb=38:2.90e-04MB:2.83e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.296e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:15 S:3 H:1 P:12 Q:16 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=923:7.042e-03MB:6.877e-06GB
        per(mem): C:35.8 S:7.15 H:2.17 P:8.13 Q:46.8 
 rqops: oplist=CSHAB nops=C:3 S:8 H:1 A:4 B:7 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=62:0.000473MB:4.62e-07GB
        per(mem): C:9.68 S:25.8 H:8.06 A:0 B:56.5 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2981:0.0227MB:2.22e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.142e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-5.960e-08 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=57:4.349e-04MB
qtensor4: wf4 own=1 _data=0x5585ee1065a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
 qbond: qcol nsym=2 dimAll=3
 (3,3):1 (4,2):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=57:4.349e-04MB
### DIAG TIMING: total=1.072e-03 t1=1.718e-05, t2=1.788e-05, t3=1.690e-05, t4=9.688e-04, t5=7.222e-06, t6=3.690e-05, t7=7.528e-06
duration_diagGPU:1.088e-03
duration_diagreduce:3.700e-08
duration_diagtransform:1.760e-07
----- TIMING FOR symbolic_formulae_twodot with size=149 : 2.725e-04 S -----
rank=0 GPUmem(GB): used=2.221e-05 (oper)=2.221e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=149
 no. of hintermediate operators=68
 no. of coefficients=868:6.622e-03MB:6.467e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.747e-05 S -----
rank=0 GPUmem(GB): used=2.868e-05 (oper,hinter)=2.221e-05,6.467e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.404e-03 S size(H_formulae)=149 size(Hxlst2)=21 T(Hmu/Hxlist)=6.338e-05,6.340e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.786e-03 S size(H_formulae)=149 size(Hxlst)=3602 -----
rank=0 GPUmem(GB): used=2.868e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=8.494e-07 batch[need]=5.099e-04 blksize=6 blksize0=6 batchsize=3602
rank=0 GPUmem(GB): used=5.394e-04 (oper,hinter,dvdson,batch)=2.221e-05,6.467e-06,8.494e-07,5.099e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.970e-05,1.454e-04,6.052e-04,5.510e-04,1.390e-03
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.422e-05 speed=3.506e-02GB/S T(nccl)=5.547e-05 speed=1.531e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=6.0e-04 t_reduction=5.5e-04 tot=1.3e-03 -----
 sigma[inter] counter=90 t=1.5e-04 per=1.1e+01 cost=1.3e+05 flops=8.9e+08
 sigma[gemm] counter=90 i=0 t=2.7e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=2.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=3 t=2.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=4 t=1.4e-04 per=1.1e+01 cost=1.2e+04 flops=9.0e+07
 sigma[gemm] counter=90 i=5 t=1.5e-04 per=1.2e+01 cost=1.2e+04 flops=8.1e+07
 sigma[gemm] counter=90 i=6 t=1.6e-04 per=1.2e+01 cost=1.5e+04 flops=9.7e+07
 sigma[gemm] counter=90 i=7 t=1.5e-04 per=1.1e+01 cost=1.4e+04 flops=9.5e+07
 sigma[gemm] counter=90 total t=6.0e-04 per=4.6e+01 cost=5.4e+04 flops=9.0e+07
 sigma[red] counter=90 t=5.5e-04 per=4.2e+01 cost=2.0e+04 flops=3.7e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.9e-02 t_reduction=5.0e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=90 t=1.1e-02 per=9.3e+00 cost=3.4e+07 flops=3.1e+09
 sigma_tot[gemm] counter=90 i=0 t=2.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=3 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=4 t=1.4e-02 per=1.1e+01 cost=7.7e+06 flops=5.7e+08
 sigma_tot[gemm] counter=90 i=5 t=1.5e-02 per=1.3e+01 cost=7.8e+06 flops=5.0e+08
 sigma_tot[gemm] counter=90 i=6 t=1.5e-02 per=1.2e+01 cost=7.4e+06 flops=5.1e+08
 sigma_tot[gemm] counter=90 i=7 t=1.4e-02 per=1.2e+01 cost=7.5e+06 flops=5.2e+08
 sigma_tot[gemm] counter=90 total t=5.9e-02 per=4.9e+01 cost=3.0e+07 flops=5.2e+08
 sigma_tot[red] counter=90 t=5.0e-02 per=4.2e+01 cost=7.1e+06 flops=1.4e+08
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.3e-06,1.3e-06,1.2e-06,3.2e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.301456576461 -1.116e+03  3.490e-02    1     1  1.681e-03 1.681e-03 1.653e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.153e-05,1.397e-04,7.084e-04,6.118e-04,1.537e-03
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.449e-05 speed=3.469e-02GB/S T(nccl)=4.704e-05 speed=1.806e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.1e-04 t_reduction=6.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=91 t=1.4e-04 per=9.6e+00 cost=1.3e+05 flops=9.3e+08
 sigma[gemm] counter=91 i=0 t=2.8e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=3 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=4 t=1.5e-04 per=1.0e+01 cost=1.2e+04 flops=8.1e+07
 sigma[gemm] counter=91 i=5 t=1.7e-04 per=1.2e+01 cost=1.2e+04 flops=7.2e+07
 sigma[gemm] counter=91 i=6 t=1.9e-04 per=1.3e+01 cost=1.5e+04 flops=8.1e+07
 sigma[gemm] counter=91 i=7 t=1.8e-04 per=1.3e+01 cost=1.4e+04 flops=7.7e+07
 sigma[gemm] counter=91 total t=7.1e-04 per=4.9e+01 cost=5.4e+04 flops=7.6e+07
 sigma[red] counter=91 t=6.1e-04 per=4.2e+01 cost=2.0e+04 flops=3.3e+07
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.9e-02 t_reduction=5.1e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=91 t=1.1e-02 per=9.4e+00 cost=3.4e+07 flops=3.0e+09
 sigma_tot[gemm] counter=91 i=0 t=2.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=3 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=4 t=1.4e-02 per=1.1e+01 cost=7.7e+06 flops=5.6e+08
 sigma_tot[gemm] counter=91 i=5 t=1.6e-02 per=1.3e+01 cost=7.8e+06 flops=5.0e+08
 sigma_tot[gemm] counter=91 i=6 t=1.5e-02 per=1.2e+01 cost=7.4e+06 flops=5.1e+08
 sigma_tot[gemm] counter=91 i=7 t=1.5e-02 per=1.2e+01 cost=7.5e+06 flops=5.1e+08
 sigma_tot[gemm] counter=91 total t=5.9e-02 per=4.9e+01 cost=3.0e+07 flops=5.1e+08
 sigma_tot[red] counter=91 t=5.1e-02 per=4.2e+01 cost=7.1e+06 flops=1.4e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.2e-05,3.3e-06,1.5e-06,3.4e-07
    2   0 -    -116.306474424740 -5.018e-03  1.734e-02    2     2  3.421e-03 1.711e-03 1.663e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.901e-05,1.363e-04,7.088e-04,5.909e-04,1.510e-03
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.323e-05 speed=3.657e-02GB/S T(nccl)=4.578e-05 speed=1.855e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.1e-04 t_reduction=5.9e-04 tot=1.4e-03 -----
 sigma[inter] counter=92 t=1.4e-04 per=9.5e+00 cost=1.3e+05 flops=9.5e+08
 sigma[gemm] counter=92 i=0 t=2.8e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=3 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=4 t=1.5e-04 per=1.0e+01 cost=1.2e+04 flops=8.2e+07
 sigma[gemm] counter=92 i=5 t=1.6e-04 per=1.1e+01 cost=1.2e+04 flops=7.6e+07
 sigma[gemm] counter=92 i=6 t=1.9e-04 per=1.3e+01 cost=1.5e+04 flops=8.1e+07
 sigma[gemm] counter=92 i=7 t=2.0e-04 per=1.4e+01 cost=1.4e+04 flops=7.2e+07
 sigma[gemm] counter=92 total t=7.1e-04 per=4.9e+01 cost=5.4e+04 flops=7.6e+07
 sigma[red] counter=92 t=5.9e-04 per=4.1e+01 cost=2.0e+04 flops=3.5e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.0e-02 t_reduction=5.1e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=92 t=1.2e-02 per=9.4e+00 cost=3.5e+07 flops=3.0e+09
 sigma_tot[gemm] counter=92 i=0 t=2.1e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=3 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=4 t=1.4e-02 per=1.1e+01 cost=7.8e+06 flops=5.6e+08
 sigma_tot[gemm] counter=92 i=5 t=1.6e-02 per=1.3e+01 cost=7.8e+06 flops=5.0e+08
 sigma_tot[gemm] counter=92 i=6 t=1.5e-02 per=1.2e+01 cost=7.5e+06 flops=5.0e+08
 sigma_tot[gemm] counter=92 i=7 t=1.5e-02 per=1.2e+01 cost=7.5e+06 flops=5.1e+08
 sigma_tot[gemm] counter=92 total t=6.0e-02 per=4.9e+01 cost=3.1e+07 flops=5.1e+08
 sigma_tot[red] counter=92 t=5.1e-02 per=4.2e+01 cost=7.2e+06 flops=1.4e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.6e-05,2.7e-06,1.6e-06,2.4e-07
    3   0 -    -116.307204522826 -7.301e-04  5.966e-03    3     3  5.117e-03 1.706e-03 1.657e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.802e-05,1.287e-04,6.952e-04,5.961e-04,1.493e-03
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.296e-05 speed=3.699e-02GB/S T(nccl)=4.505e-05 speed=1.885e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.9e-04 t_reduction=6.0e-04 tot=1.4e-03 -----
 sigma[inter] counter=93 t=1.3e-04 per=9.1e+00 cost=1.3e+05 flops=1.0e+09
 sigma[gemm] counter=93 i=0 t=2.8e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=3 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=4 t=1.5e-04 per=1.0e+01 cost=1.2e+04 flops=8.3e+07
 sigma[gemm] counter=93 i=5 t=1.6e-04 per=1.1e+01 cost=1.2e+04 flops=7.6e+07
 sigma[gemm] counter=93 i=6 t=1.9e-04 per=1.3e+01 cost=1.5e+04 flops=8.1e+07
 sigma[gemm] counter=93 i=7 t=1.8e-04 per=1.3e+01 cost=1.4e+04 flops=7.7e+07
 sigma[gemm] counter=93 total t=6.9e-04 per=4.9e+01 cost=5.4e+04 flops=7.8e+07
 sigma[red] counter=93 t=6.0e-04 per=4.2e+01 cost=2.0e+04 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.1e-02 t_reduction=5.2e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=93 t=1.2e-02 per=9.3e+00 cost=3.5e+07 flops=3.0e+09
 sigma_tot[gemm] counter=93 i=0 t=2.2e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=1.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=3 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=4 t=1.4e-02 per=1.1e+01 cost=7.8e+06 flops=5.5e+08
 sigma_tot[gemm] counter=93 i=5 t=1.6e-02 per=1.3e+01 cost=7.8e+06 flops=4.9e+08
 sigma_tot[gemm] counter=93 i=6 t=1.5e-02 per=1.2e+01 cost=7.5e+06 flops=5.0e+08
 sigma_tot[gemm] counter=93 i=7 t=1.5e-02 per=1.2e+01 cost=7.5e+06 flops=5.0e+08
 sigma_tot[gemm] counter=93 total t=6.1e-02 per=4.9e+01 cost=3.1e+07 flops=5.0e+08
 sigma_tot[red] counter=93 t=5.2e-02 per=4.2e+01 cost=7.2e+06 flops=1.4e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.5e-05,2.5e-06,1.4e-06,2.5e-07
    4   0 -    -116.307292153216 -8.763e-05  2.234e-03    3     4  6.942e-03 1.736e-03 1.685e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.671e-05,1.289e-04,6.949e-04,5.317e-04,1.427e-03
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.162e-05 speed=3.929e-02GB/S T(nccl)=4.509e-05 speed=1.884e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.9e-04 t_reduction=5.3e-04 tot=1.4e-03 -----
 sigma[inter] counter=94 t=1.3e-04 per=9.5e+00 cost=1.3e+05 flops=1.0e+09
 sigma[gemm] counter=94 i=0 t=2.8e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=2.4e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=2.4e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=3 t=2.4e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=4 t=1.5e-04 per=1.1e+01 cost=1.2e+04 flops=8.1e+07
 sigma[gemm] counter=94 i=5 t=1.6e-04 per=1.2e+01 cost=1.2e+04 flops=7.7e+07
 sigma[gemm] counter=94 i=6 t=1.9e-04 per=1.4e+01 cost=1.5e+04 flops=8.1e+07
 sigma[gemm] counter=94 i=7 t=1.8e-04 per=1.3e+01 cost=1.4e+04 flops=7.7e+07
 sigma[gemm] counter=94 total t=6.9e-04 per=5.1e+01 cost=5.4e+04 flops=7.8e+07
 sigma[red] counter=94 t=5.3e-04 per=3.9e+01 cost=2.0e+04 flops=3.8e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.1e-02 t_reduction=5.3e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=94 t=1.2e-02 per=9.4e+00 cost=3.5e+07 flops=3.0e+09
 sigma_tot[gemm] counter=94 i=0 t=2.2e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=3 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=4 t=1.4e-02 per=1.1e+01 cost=7.8e+06 flops=5.5e+08
 sigma_tot[gemm] counter=94 i=5 t=1.6e-02 per=1.3e+01 cost=7.8e+06 flops=4.9e+08
 sigma_tot[gemm] counter=94 i=6 t=1.5e-02 per=1.2e+01 cost=7.5e+06 flops=4.9e+08
 sigma_tot[gemm] counter=94 i=7 t=1.5e-02 per=1.2e+01 cost=7.6e+06 flops=5.0e+08
 sigma_tot[gemm] counter=94 total t=6.1e-02 per=4.9e+01 cost=3.1e+07 flops=5.0e+08
 sigma_tot[red] counter=94 t=5.3e-02 per=4.2e+01 cost=7.2e+06 flops=1.4e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.2e-05,2.2e-06,1.2e-06,1.7e-07
    5   0 -    -116.307302063452 -9.910e-06  5.918e-04    3     5  8.520e-03 1.704e-03 1.654e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.298e-05,1.079e-04,5.901e-04,5.257e-04,1.290e-03
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.098e-05 speed=4.048e-02GB/S T(nccl)=4.200e-05 speed=2.022e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=5.9e-04 t_reduction=5.3e-04 tot=1.2e-03 -----
 sigma[inter] counter=95 t=1.1e-04 per=8.8e+00 cost=1.3e+05 flops=1.2e+09
 sigma[gemm] counter=95 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=3 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=4 t=1.2e-04 per=1.0e+01 cost=1.2e+04 flops=9.9e+07
 sigma[gemm] counter=95 i=5 t=1.3e-04 per=1.1e+01 cost=1.2e+04 flops=9.1e+07
 sigma[gemm] counter=95 i=6 t=1.6e-04 per=1.3e+01 cost=1.5e+04 flops=9.8e+07
 sigma[gemm] counter=95 i=7 t=1.6e-04 per=1.3e+01 cost=1.4e+04 flops=8.6e+07
 sigma[gemm] counter=95 total t=5.9e-04 per=4.8e+01 cost=5.4e+04 flops=9.2e+07
 sigma[red] counter=95 t=5.3e-04 per=4.3e+01 cost=2.0e+04 flops=3.9e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.2e-02 t_reduction=5.3e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=95 t=1.2e-02 per=9.3e+00 cost=3.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=95 i=0 t=2.2e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=3 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=4 t=1.4e-02 per=1.1e+01 cost=7.8e+06 flops=5.5e+08
 sigma_tot[gemm] counter=95 i=5 t=1.6e-02 per=1.3e+01 cost=7.8e+06 flops=4.8e+08
 sigma_tot[gemm] counter=95 i=6 t=1.5e-02 per=1.2e+01 cost=7.5e+06 flops=4.9e+08
 sigma_tot[gemm] counter=95 i=7 t=1.5e-02 per=1.2e+01 cost=7.6e+06 flops=4.9e+08
 sigma_tot[gemm] counter=95 total t=6.2e-02 per=4.9e+01 cost=3.1e+07 flops=4.9e+08
 sigma_tot[red] counter=95 t=5.3e-02 per=4.2e+01 cost=7.2e+06 flops=1.4e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.2e-05,1.9e-06,1.2e-06,1.7e-07
    6   0 -    -116.307302748026 -6.846e-07  1.732e-04    3     6  9.952e-03 1.659e-03 1.611e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.399e-05,1.084e-04,5.966e-04,5.297e-04,1.302e-03
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.141e-05 speed=3.967e-02GB/S T(nccl)=4.257e-05 speed=1.995e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=6.0e-04 t_reduction=5.3e-04 tot=1.2e-03 -----
 sigma[inter] counter=96 t=1.1e-04 per=8.8e+00 cost=1.3e+05 flops=1.2e+09
 sigma[gemm] counter=96 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=3 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=4 t=1.3e-04 per=1.1e+01 cost=1.2e+04 flops=9.2e+07
 sigma[gemm] counter=96 i=5 t=1.3e-04 per=1.1e+01 cost=1.2e+04 flops=9.2e+07
 sigma[gemm] counter=96 i=6 t=1.6e-04 per=1.3e+01 cost=1.5e+04 flops=9.7e+07
 sigma[gemm] counter=96 i=7 t=1.6e-04 per=1.3e+01 cost=1.4e+04 flops=8.8e+07
 sigma[gemm] counter=96 total t=6.0e-04 per=4.8e+01 cost=5.4e+04 flops=9.1e+07
 sigma[red] counter=96 t=5.3e-04 per=4.3e+01 cost=2.0e+04 flops=3.9e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.3e-02 t_reduction=5.4e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=96 t=1.2e-02 per=9.3e+00 cost=3.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=96 i=0 t=2.2e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=3 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=4 t=1.4e-02 per=1.1e+01 cost=7.8e+06 flops=5.4e+08
 sigma_tot[gemm] counter=96 i=5 t=1.6e-02 per=1.3e+01 cost=7.9e+06 flops=4.8e+08
 sigma_tot[gemm] counter=96 i=6 t=1.6e-02 per=1.2e+01 cost=7.5e+06 flops=4.8e+08
 sigma_tot[gemm] counter=96 i=7 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.9e+08
 sigma_tot[gemm] counter=96 total t=6.3e-02 per=4.9e+01 cost=3.1e+07 flops=4.9e+08
 sigma_tot[red] counter=96 t=5.4e-02 per=4.2e+01 cost=7.2e+06 flops=1.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.1e-05,1.8e-06,1.1e-06,1.9e-07
    7   0 +    -116.307302820366 -7.234e-08  5.927e-05    3     7  1.140e-02 1.628e-03 1.582e-03
TIMING FOR Davidson : 1.141e-02  T(cal/comm/rest)=1.107e-02,1.640e-06,3.334e-04
decomposed t_rest=3.334e-04
 T(sub)    =1.359e-04 per=4.076e+01
 T(precond)=1.964e-05 per=5.890e+00
 T(ortho)  =1.142e-05 per=3.424e+00
 T(xcopy)  =1.047e-06 per=3.140e-01
 T(xnrm2)  =1.314e-06 per=3.941e-01
 T(other)  =1.641e-04 per=4.922e+01
optimized energies: isweep=0 ibond=14 dots=2 e[0]=-116.307302820366 nmvp=7
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.032e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=12 dimAll=40
 (23,3):4 (25,3):8 (24,2):7 (24,4):5 (26,2):3 (25,1):3 (26,4):3 (25,5):2 (22,2):1 (23,1):2 (24,0):1 (27,3):1
timing for divide=6.5e-06
timing for compute=4.7e-05
timing for collect=5.0e-06
----- TMING FOR decimation_genbasis(su2): 5.9e-05 S T(divide/compute[cpu/gpu/rest]/collect)=6.5e-06,4.4e-05,0.0e+00,3.1e-06,5.0e-06 -----
decimation summary: 40->10 dwt=+6.494e-06 SvN=7.273e-01
 qbond: qkept nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
----- TIMING for decimation_row(nkr): 9.880e-04 S T(decim/select/formRot)=1.198e-04,8.490e-04,1.911e-05 -----
----- TIMING FOR twodot_decimation: 1.080e-03 S T(wf/decim)=8.552e-05,9.945e-04 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=731:5.577e-03MB:5.446e-06GB
        per(mem): C:48.2 S:6.02 H:2.74 P:8.89 Q:34.2 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.145e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=35 : 1.477e-04 S -----
rank=0 GPUmem(GB): used=3.366e-05 (oper)=1.976e-05
rank=0 GPUmem(GB): used=3.404e-05 (oper,site)=1.976e-05,3.800e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=35
 no. of rintermediate operators=28
 no. of coefficients=420:3.204e-03MB:3.129e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.435e-05 S -----
rank=0 GPUmem(GB): used=3.717e-05 (oper,site,rinter)=1.976e-05,3.800e-07,3.129e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.574e-03 S size(rtasks)=35 size(Rlst2)=36 T(Rmu/Rlist)=4.693e-05,1.527e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.735e-03 S size(rtasks)=35 size(Rlst)=1269 -----
rank=0 GPUmem(GB): used=3.717e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.364e-04 blksize=9 blksize0=6 batchsize=1269
rank=0 GPUmem(GB): used=2.735e-04 (oper,site,rinter,batch)=1.976e-05,3.800e-07,3.129e-06,2.364e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.078e-04,5.872e-04,2.001e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=5.9e-04 t_reduction=2.0e-04 tot=8.9e-04 -----
 renorm[inter] counter=172 t=1.1e-04 per=1.2e+01 cost=2.9e+04 flops=2.7e+08
 renorm[gemm] counter=172 i=0 t=2.2e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=172 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=172 i=2 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=172 i=3 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=172 i=4 t=1.9e-04 per=2.1e+01 cost=4.1e+03 flops=2.2e+07
 renorm[gemm] counter=172 i=5 t=2.0e-04 per=2.2e+01 cost=1.1e+04 flops=5.4e+07
 renorm[gemm] counter=172 i=6 t=1.9e-04 per=2.1e+01 cost=2.0e+04 flops=1.0e+08
 renorm[gemm] counter=172 total t=5.9e-04 per=6.6e+01 cost=3.5e+04 flops=6.0e+07
 renorm[red] counter=172 t=2.0e-04 per=2.2e+01 cost=1.1e+04 flops=5.5e+07
----- TIMING FOR renorm_tot : t_inter=1.4e-03 t_gemm=5.7e-03 t_reduction=2.2e-03 tot=9.3e-03 -----
 renorm_tot[inter] counter=172 t=1.4e-03 per=1.5e+01 cost=3.4e+05 flops=2.4e+08
 renorm_tot[gemm] counter=172 i=0 t=3.2e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=172 i=1 t=2.9e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=172 i=2 t=2.9e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=172 i=3 t=2.9e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=172 i=4 t=1.8e-03 per=1.9e+01 cost=4.8e+04 flops=2.7e+07
 renorm_tot[gemm] counter=172 i=5 t=1.9e-03 per=2.0e+01 cost=2.3e+05 flops=1.2e+08
 renorm_tot[gemm] counter=172 i=6 t=1.8e-03 per=2.0e+01 cost=4.2e+05 flops=2.3e+08
 renorm_tot[gemm] counter=172 total t=5.7e-03 per=6.1e+01 cost=7.0e+05 flops=1.2e+08
 renorm_tot[red] counter=172 t=2.2e-03 per=2.4e+01 cost=1.8e+05 flops=8.1e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.763e-05 (oper)=1.992e-05
rank=0 GPUmem(GB): used=3.801e-05 (oper,site,rinter)=1.992e-05,3.800e-07,6.706e-07
rank=0 GPUmem(GB): used=5.421e-05 (oper,site,rinter,batch)=1.992e-05,3.800e-07,6.706e-07,1.621e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.118e-03 S T(preprocess/alloc/comp/red/dealloc)=5.702e-04,6.131e-04,1.372e-03,8.424e-05,3.922e-05 -----
----- TIMING FOR oper_renorm_opS : 2.130e-03 S rank=0 -----
qops.to_cpu: size(tot)=731:5.577e-03MB:5.446e-06GB T(to_cpu)=2.383e-05S speed=2.285e-01GB/S
check ||H-H.dagger||=1.843e-14 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.00606 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=3.464e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=8.621e-04 change=-1.288e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=8.621e-04 change=-4.843e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 3.381e-02 S #####
 T(local opt: fetch) = 2.264e-03 S  per =  6.7  per(accum) = 6.7
 T(local opt: hdiag) = 1.173e-03 S  per = 3.47  per(accum) = 10.2
 T(local opt: dvdsn) = 2.062e-02 S  per =   61  per(accum) = 71.1
 T(local opt: decim) = 1.107e-03 S  per = 3.27  per(accum) = 74.4
 T(local opt: guess) = 6.748e-05 S  per =  0.2  per(accum) = 74.6
 T(local opt: renrm) = 6.704e-03 S  per = 19.8  per(accum) = 94.4
 T(local opt: save ) = 1.879e-03 S  per = 5.56  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.062e-02 S  T(sum) = 2.025e-02 S  per = 9.823e+01
 T(local opt: preprocess                  ) = 1.861e-04 S  per = 0.919  per(accum) = 0.919
 T(local opt: symbolic_formulae           ) = 2.837e-04 S  per =  1.4  per(accum) = 2.32
 T(local opt: hintermediate init          ) = 5.730e-05 S  per = 0.283  per(accum) = 2.6
 T(local opt: preprocess_hformulae_Hxlist ) = 6.811e-03 S  per = 33.6  per(accum) = 36.2
 T(local opt: hmmtasks init               ) = 1.393e-03 S  per = 6.88  per(accum) = 43.1
 T(local opt: initial guess for dvdson    ) = 1.161e-04 S  per = 0.573  per(accum) = 43.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.059e-02 S  per = 52.3  per(accum) = 96
 T(local opt: dvdson [cpu-gpu]            ) = 1.589e-04 S  per = 0.785  per(accum) = 96.8
 T(local opt: dvdson [nccl]               ) = 3.230e-04 S  per = 1.59  per(accum) = 98.3
 T(local opt: dvdson [mpi]                ) = 1.640e-06 S  per = 0.0081  per(accum) = 98.4
 T(local opt: dvdson [rest part(linalg)]  ) = 3.334e-04 S  per = 1.65  per(accum) = 100
Detailed decomposition of T(renrm) = 6.704e-03 S  T(sum) = 6.704e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.490e-05 S  per = 0.819  per(accum) = 0.819
 T(local opt: qops init                    ) = 3.229e-04 S  per = 4.82  per(accum) = 5.64
 T(local opt: symbolic_formulae_renorm     ) = 1.526e-04 S  per = 2.28  per(accum) = 7.91
 T(local opt: allocate qops on gpu         ) = 5.508e-05 S  per = 0.822  per(accum) = 8.73
 T(local opt: site memcpy cpu2gpu          ) = 2.255e-05 S  per = 0.336  per(accum) = 9.07
 T(local opt: rintermediate init           ) = 3.137e-05 S  per = 0.468  per(accum) = 9.54
 T(local opt: preprocess_formulae_Rlist2   ) = 1.742e-03 S  per =   26  per(accum) = 35.5
 T(local opt: rmmtasks init                ) = 5.158e-04 S  per = 7.69  per(accum) = 43.2
 T(local opt: qops memset on cpu           ) = 5.100e-08 S  per = 0.000761  per(accum) = 43.2
 T(local opt: preprocess_renorm_batchGPU   ) = 9.912e-04 S  per = 14.8  per(accum) = 58
 T(local opt: deallocate cpu and gpu memory) = 3.461e-05 S  per = 0.516  per(accum) = 58.5
 T(local opt: construct opS [ifdists=true] ) = 2.136e-03 S  per = 31.9  per(accum) = 90.4
 T(local opt: reduction of opS & opH [nccl]) = 1.766e-05 S  per = 0.263  per(accum) = 90.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.758e-05 S  per = 0.411  per(accum) = 91.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.145e-05 S  per = 0.171  per(accum) = 91.2
 T(local opt: qops_pool join and erase     ) = 5.841e-04 S  per = 8.71  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 4.062e-06 S  per = 0.0606  per(accum) = 100
ctns::rcanon_save_site idx=4 scratch=./scratch/sweep size=51:3.8e-07GB T(load)=0.00055S speed=0.0007GB/S
##### sweep opt: 6.668e-01 S #####
 T(sweep opt: fetch) = 3.968e-02 S  per = 5.95  per(accum) = 5.95
 T(sweep opt: hdiag) = 3.669e-02 S  per =  5.5  per(accum) = 11.5
 T(sweep opt: dvdsn) = 4.145e-01 S  per = 62.2  per(accum) = 73.6
 T(sweep opt: decim) = 1.676e-02 S  per = 2.51  per(accum) = 76.1
 T(sweep opt: guess) = 1.277e-03 S  per = 0.191  per(accum) = 76.3
 T(sweep opt: renrm) = 1.303e-01 S  per = 19.5  per(accum) = 95.9
 T(sweep opt: save ) = 2.756e-02 S  per = 4.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.145e-01 S  T(sum) = 4.081e-01 S  per = 9.844e+01
 T(sweep opt: preprocess                  ) = 4.350e-03 S  per = 1.07  per(accum) = 1.07
 T(sweep opt: symbolic_formulae           ) = 7.692e-03 S  per = 1.88  per(accum) = 2.95
 T(sweep opt: hintermediate init          ) = 1.076e-03 S  per = 0.264  per(accum) = 3.21
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.927e-01 S  per = 47.2  per(accum) = 50.4
 T(sweep opt: hmmtasks init               ) = 3.863e-02 S  per = 9.47  per(accum) = 59.9
 T(sweep opt: initial guess for dvdson    ) = 2.028e-03 S  per = 0.497  per(accum) = 60.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.490e-01 S  per = 36.5  per(accum) = 96.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.160e-03 S  per = 0.529  per(accum) = 97.4
 T(sweep opt: dvdson [nccl]               ) = 5.082e-03 S  per = 1.25  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 3.772e-05 S  per = 0.00924  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.305e-03 S  per =  1.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.303e-01 S  T(sum) = 1.303e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.931e-04 S  per = 0.609  per(accum) = 0.609
 T(sweep opt: qops init                    ) = 5.242e-03 S  per = 4.02  per(accum) = 4.63
 T(sweep opt: symbolic_formulae_renorm     ) = 2.863e-03 S  per =  2.2  per(accum) = 6.83
 T(sweep opt: allocate qops on gpu         ) = 8.553e-04 S  per = 0.656  per(accum) = 7.48
 T(sweep opt: site memcpy cpu2gpu          ) = 3.692e-04 S  per = 0.283  per(accum) = 7.77
 T(sweep opt: rintermediate init           ) = 7.054e-04 S  per = 0.541  per(accum) = 8.31
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.002e-02 S  per = 15.4  per(accum) = 23.7
 T(sweep opt: rmmtasks init                ) = 6.316e-03 S  per = 4.85  per(accum) = 28.5
 T(sweep opt: qops memset on cpu           ) = 7.510e-07 S  per = 0.000576  per(accum) = 28.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.134e-02 S  per =  8.7  per(accum) = 37.2
 T(sweep opt: deallocate cpu and gpu memory) = 4.518e-04 S  per = 0.347  per(accum) = 37.6
 T(sweep opt: construct opS [ifdists=true] ) = 6.639e-02 S  per = 50.9  per(accum) = 88.5
 T(sweep opt: reduction of opS & opH [nccl]) = 2.771e-04 S  per = 0.213  per(accum) = 88.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.242e-04 S  per = 0.402  per(accum) = 89.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.530e-04 S  per = 0.117  per(accum) = 89.2
 T(sweep opt: qops_pool join and erase     ) = 1.124e-02 S  per = 8.62  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 2.779e-03 S  per = 2.13  per(accum) = 100
##### global opt: 6.668e-01 S #####
 T(global opt: fetch) = 3.968e-02 S  per = 5.95  per(accum) = 5.95
 T(global opt: hdiag) = 3.669e-02 S  per =  5.5  per(accum) = 11.5
 T(global opt: dvdsn) = 4.145e-01 S  per = 62.2  per(accum) = 73.6
 T(global opt: decim) = 1.676e-02 S  per = 2.51  per(accum) = 76.1
 T(global opt: guess) = 1.277e-03 S  per = 0.191  per(accum) = 76.3
 T(global opt: renrm) = 1.303e-01 S  per = 19.5  per(accum) = 95.9
 T(global opt: save ) = 2.756e-02 S  per = 4.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.145e-01 S  T(sum) = 4.081e-01 S  per = 9.844e+01
 T(global opt: preprocess                  ) = 4.350e-03 S  per = 1.07  per(accum) = 1.07
 T(global opt: symbolic_formulae           ) = 7.692e-03 S  per = 1.88  per(accum) = 2.95
 T(global opt: hintermediate init          ) = 1.076e-03 S  per = 0.264  per(accum) = 3.21
 T(global opt: preprocess_hformulae_Hxlist ) = 1.927e-01 S  per = 47.2  per(accum) = 50.4
 T(global opt: hmmtasks init               ) = 3.863e-02 S  per = 9.47  per(accum) = 59.9
 T(global opt: initial guess for dvdson    ) = 2.028e-03 S  per = 0.497  per(accum) = 60.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.490e-01 S  per = 36.5  per(accum) = 96.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.160e-03 S  per = 0.529  per(accum) = 97.4
 T(global opt: dvdson [nccl]               ) = 5.082e-03 S  per = 1.25  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 3.772e-05 S  per = 0.00924  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 5.305e-03 S  per =  1.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.303e-01 S  T(sum) = 1.303e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.931e-04 S  per = 0.609  per(accum) = 0.609
 T(global opt: qops init                    ) = 5.242e-03 S  per = 4.02  per(accum) = 4.63
 T(global opt: symbolic_formulae_renorm     ) = 2.863e-03 S  per =  2.2  per(accum) = 6.83
 T(global opt: allocate qops on gpu         ) = 8.553e-04 S  per = 0.656  per(accum) = 7.48
 T(global opt: site memcpy cpu2gpu          ) = 3.692e-04 S  per = 0.283  per(accum) = 7.77
 T(global opt: rintermediate init           ) = 7.054e-04 S  per = 0.541  per(accum) = 8.31
 T(global opt: preprocess_formulae_Rlist2   ) = 2.002e-02 S  per = 15.4  per(accum) = 23.7
 T(global opt: rmmtasks init                ) = 6.316e-03 S  per = 4.85  per(accum) = 28.5
 T(global opt: qops memset on cpu           ) = 7.510e-07 S  per = 0.000576  per(accum) = 28.5
 T(global opt: preprocess_renorm_batchGPU   ) = 1.134e-02 S  per =  8.7  per(accum) = 37.2
 T(global opt: deallocate cpu and gpu memory) = 4.518e-04 S  per = 0.347  per(accum) = 37.6
 T(global opt: construct opS [ifdists=true] ) = 6.639e-02 S  per = 50.9  per(accum) = 88.5
 T(global opt: reduction of opS & opH [nccl]) = 2.771e-04 S  per = 0.213  per(accum) = 88.7
 T(global opt: qops memcpy gpu2cpu          ) = 5.242e-04 S  per = 0.402  per(accum) = 89.1
 T(global opt: reduction of opS & opH [mpi] ) = 1.530e-04 S  per = 0.117  per(accum) = 89.2
 T(global opt: qops_pool join and erase     ) = 1.124e-02 S  per = 8.62  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 2.779e-03 S  per = 2.13  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.044e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=15/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=2 scratch=./scratch/sweep size=7:5.22e-08GB T(load)=3.16e-04S speed=1.65e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=15:1.14e-04MB:1.12e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=23:1.75e-04MB:1.71e-07GB
total mem of comb=39:2.98e-04MB:2.91e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.296e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=731:5.577e-03MB:5.446e-06GB
        per(mem): C:48.2 S:6.02 H:2.74 P:8.89 Q:34.2 
 rqops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=47:0.000359MB:3.5e-07GB
        per(mem): C:8.51 S:38.3 H:10.6 A:0 B:42.6 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2774:0.0212MB:2.07e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.097e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=5.960e-08 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=51:3.891e-04MB
qtensor4: wf4 own=1 _data=0x5585f430d860
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
 qbond: qcol nsym=2 dimAll=3
 (2,2):1 (3,1):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=6.627e-04 t1=1.566e-05, t2=1.678e-05, t3=1.674e-05, t4=5.630e-04, t5=6.599e-06, t6=3.739e-05, t7=6.553e-06
duration_diagGPU:6.706e-04
duration_diagreduce:4.400e-08
duration_diagtransform:1.670e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 1.752e-04 S -----
rank=0 GPUmem(GB): used=2.067e-05 (oper)=2.067e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=560:4.272e-03MB:4.172e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.479e-05 S -----
rank=0 GPUmem(GB): used=2.484e-05 (oper,hinter)=2.067e-05,4.172e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.581e-03 S size(H_formulae)=107 size(Hxlst2)=21 T(Hmu/Hxlist)=4.472e-05,4.536e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.784e-03 S size(H_formulae)=107 size(Hxlst)=2814 -----
rank=0 GPUmem(GB): used=2.484e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=7.600e-07 batch[need]=3.984e-04 blksize=6 blksize0=6 batchsize=2814
rank=0 GPUmem(GB): used=4.240e-04 (oper,hinter,dvdson,batch)=2.067e-05,4.172e-06,7.600e-07,3.984e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.141e-05,9.641e-05,4.980e-04,5.514e-04,1.225e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.178e-05 speed=3.489e-02GB/S T(nccl)=4.963e-05 speed=1.531e-02GB/S
----- TIMING FOR sigma : t_inter=9.6e-05 t_gemm=5.0e-04 t_reduction=5.5e-04 tot=1.1e-03 -----
 sigma[inter] counter=97 t=9.6e-05 per=8.4e+00 cost=9.1e+04 flops=9.4e+08
 sigma[gemm] counter=97 i=0 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=1.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=1.6e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=3 t=1.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=4 t=1.0e-04 per=9.0e+00 cost=6.6e+03 flops=6.4e+07
 sigma[gemm] counter=97 i=5 t=1.1e-04 per=9.4e+00 cost=6.6e+03 flops=6.2e+07
 sigma[gemm] counter=97 i=6 t=1.2e-04 per=1.1e+01 cost=1.1e+04 flops=8.6e+07
 sigma[gemm] counter=97 i=7 t=1.6e-04 per=1.4e+01 cost=9.6e+03 flops=6.1e+07
 sigma[gemm] counter=97 total t=5.0e-04 per=4.3e+01 cost=3.4e+04 flops=6.7e+07
 sigma[red] counter=97 t=5.5e-04 per=4.8e+01 cost=1.4e+04 flops=2.6e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.3e-02 t_reduction=5.4e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=97 t=1.2e-02 per=9.3e+00 cost=3.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=97 i=0 t=2.3e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=3 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=4 t=1.5e-02 per=1.1e+01 cost=7.8e+06 flops=5.4e+08
 sigma_tot[gemm] counter=97 i=5 t=1.6e-02 per=1.3e+01 cost=7.9e+06 flops=4.8e+08
 sigma_tot[gemm] counter=97 i=6 t=1.6e-02 per=1.2e+01 cost=7.5e+06 flops=4.8e+08
 sigma_tot[gemm] counter=97 i=7 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.8e+08
 sigma_tot[gemm] counter=97 total t=6.3e-02 per=4.9e+01 cost=3.1e+07 flops=4.9e+08
 sigma_tot[red] counter=97 t=5.4e-02 per=4.2e+01 cost=7.2e+06 flops=1.3e+08
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,2.5e-06,9.4e-07,6.3e-06,3.2e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.307298452327 -1.116e+03  3.154e-02    1     1  1.565e-03 1.565e-03 1.538e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.445e-05,8.723e-05,5.574e-04,5.811e-04,1.295e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.209e-05 speed=3.440e-02GB/S T(nccl)=4.236e-05 speed=1.794e-02GB/S
----- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=5.6e-04 t_reduction=5.8e-04 tot=1.2e-03 -----
 sigma[inter] counter=98 t=8.7e-05 per=7.1e+00 cost=9.1e+04 flops=1.0e+09
 sigma[gemm] counter=98 i=0 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=3 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=4 t=1.2e-04 per=9.8e+00 cost=6.6e+03 flops=5.5e+07
 sigma[gemm] counter=98 i=5 t=1.3e-04 per=1.0e+01 cost=6.6e+03 flops=5.3e+07
 sigma[gemm] counter=98 i=6 t=1.5e-04 per=1.3e+01 cost=1.1e+04 flops=6.9e+07
 sigma[gemm] counter=98 i=7 t=1.5e-04 per=1.2e+01 cost=9.6e+03 flops=6.5e+07
 sigma[gemm] counter=98 total t=5.6e-04 per=4.5e+01 cost=3.4e+04 flops=6.0e+07
 sigma[red] counter=98 t=5.8e-04 per=4.7e+01 cost=1.4e+04 flops=2.4e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.4e-02 t_reduction=5.5e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=98 t=1.2e-02 per=9.3e+00 cost=3.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=98 i=0 t=2.3e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=2.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=3 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=4 t=1.5e-02 per=1.1e+01 cost=7.8e+06 flops=5.3e+08
 sigma_tot[gemm] counter=98 i=5 t=1.7e-02 per=1.3e+01 cost=7.9e+06 flops=4.7e+08
 sigma_tot[gemm] counter=98 i=6 t=1.6e-02 per=1.2e+01 cost=7.5e+06 flops=4.8e+08
 sigma_tot[gemm] counter=98 i=7 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.8e+08
 sigma_tot[gemm] counter=98 total t=6.4e-02 per=4.9e+01 cost=3.1e+07 flops=4.8e+08
 sigma_tot[red] counter=98 t=5.5e-02 per=4.2e+01 cost=7.3e+06 flops=1.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,9.4e-06,2.5e-06,1.0e-06,2.0e-07
    2   0 -    -116.311083616854 -3.785e-03  1.515e-02    2     2  3.139e-03 1.570e-03 1.524e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.297e-05,8.505e-05,5.546e-04,5.793e-04,1.286e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.168e-05 speed=3.505e-02GB/S T(nccl)=4.128e-05 speed=1.841e-02GB/S
----- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=5.5e-04 t_reduction=5.8e-04 tot=1.2e-03 -----
 sigma[inter] counter=99 t=8.5e-05 per=7.0e+00 cost=9.1e+04 flops=1.1e+09
 sigma[gemm] counter=99 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=3 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=4 t=1.2e-04 per=9.6e+00 cost=6.6e+03 flops=5.7e+07
 sigma[gemm] counter=99 i=5 t=1.2e-04 per=1.0e+01 cost=6.6e+03 flops=5.3e+07
 sigma[gemm] counter=99 i=6 t=1.5e-04 per=1.3e+01 cost=1.1e+04 flops=6.9e+07
 sigma[gemm] counter=99 i=7 t=1.5e-04 per=1.2e+01 cost=9.6e+03 flops=6.4e+07
 sigma[gemm] counter=99 total t=5.5e-04 per=4.5e+01 cost=3.4e+04 flops=6.1e+07
 sigma[red] counter=99 t=5.8e-04 per=4.8e+01 cost=1.4e+04 flops=2.4e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.4e-02 t_reduction=5.5e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=99 t=1.2e-02 per=9.3e+00 cost=3.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=99 i=0 t=2.3e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=3 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=4 t=1.5e-02 per=1.1e+01 cost=7.8e+06 flops=5.3e+08
 sigma_tot[gemm] counter=99 i=5 t=1.7e-02 per=1.3e+01 cost=7.9e+06 flops=4.7e+08
 sigma_tot[gemm] counter=99 i=6 t=1.6e-02 per=1.2e+01 cost=7.5e+06 flops=4.7e+08
 sigma_tot[gemm] counter=99 i=7 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.8e+08
 sigma_tot[gemm] counter=99 total t=6.4e-02 per=4.9e+01 cost=3.1e+07 flops=4.8e+08
 sigma_tot[red] counter=99 t=5.5e-02 per=4.2e+01 cost=7.3e+06 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.3e-05,2.0e-06,1.3e-06,2.1e-07
    3   0 -    -116.311472269527 -3.887e-04  2.220e-03    3     3  4.675e-03 1.558e-03 1.510e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.312e-05,8.443e-05,5.417e-04,5.770e-04,1.270e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.185e-05 speed=3.478e-02GB/S T(nccl)=4.127e-05 speed=1.841e-02GB/S
----- TIMING FOR sigma : t_inter=8.4e-05 t_gemm=5.4e-04 t_reduction=5.8e-04 tot=1.2e-03 -----
 sigma[inter] counter=100 t=8.4e-05 per=7.0e+00 cost=9.1e+04 flops=1.1e+09
 sigma[gemm] counter=100 i=0 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=3 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=4 t=1.1e-04 per=9.6e+00 cost=6.6e+03 flops=5.7e+07
 sigma[gemm] counter=100 i=5 t=1.2e-04 per=1.0e+01 cost=6.6e+03 flops=5.4e+07
 sigma[gemm] counter=100 i=6 t=1.5e-04 per=1.2e+01 cost=1.1e+04 flops=7.3e+07
 sigma[gemm] counter=100 i=7 t=1.5e-04 per=1.2e+01 cost=9.6e+03 flops=6.5e+07
 sigma[gemm] counter=100 total t=5.4e-04 per=4.5e+01 cost=3.4e+04 flops=6.2e+07
 sigma[red] counter=100 t=5.8e-04 per=4.8e+01 cost=1.4e+04 flops=2.5e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.5e-02 t_reduction=5.6e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=100 t=1.2e-02 per=9.3e+00 cost=3.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=100 i=0 t=2.3e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=3 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=4 t=1.5e-02 per=1.1e+01 cost=7.8e+06 flops=5.3e+08
 sigma_tot[gemm] counter=100 i=5 t=1.7e-02 per=1.3e+01 cost=7.9e+06 flops=4.7e+08
 sigma_tot[gemm] counter=100 i=6 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.7e+08
 sigma_tot[gemm] counter=100 i=7 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.7e+08
 sigma_tot[gemm] counter=100 total t=6.5e-02 per=4.9e+01 cost=3.1e+07 flops=4.8e+08
 sigma_tot[red] counter=100 t=5.6e-02 per=4.2e+01 cost=7.3e+06 flops=1.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.1e-05,1.7e-06,1.1e-06,1.7e-07
    4   0 -    -116.311486264161 -1.399e-05  7.097e-04    3     4  6.176e-03 1.544e-03 1.497e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.810e-05,8.221e-05,5.758e-04,5.874e-04,1.317e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.137e-05 speed=3.557e-02GB/S T(nccl)=4.673e-05 speed=1.626e-02GB/S
----- TIMING FOR sigma : t_inter=8.2e-05 t_gemm=5.8e-04 t_reduction=5.9e-04 tot=1.2e-03 -----
 sigma[inter] counter=101 t=8.2e-05 per=6.6e+00 cost=9.1e+04 flops=1.1e+09
 sigma[gemm] counter=101 i=0 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=3 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=4 t=1.2e-04 per=9.3e+00 cost=6.6e+03 flops=5.7e+07
 sigma[gemm] counter=101 i=5 t=1.3e-04 per=1.0e+01 cost=6.6e+03 flops=5.1e+07
 sigma[gemm] counter=101 i=6 t=1.6e-04 per=1.3e+01 cost=1.1e+04 flops=6.6e+07
 sigma[gemm] counter=101 i=7 t=1.6e-04 per=1.3e+01 cost=9.6e+03 flops=6.0e+07
 sigma[gemm] counter=101 total t=5.8e-04 per=4.6e+01 cost=3.4e+04 flops=5.8e+07
 sigma[red] counter=101 t=5.9e-04 per=4.7e+01 cost=1.4e+04 flops=2.4e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.5e-02 t_reduction=5.6e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=101 t=1.2e-02 per=9.2e+00 cost=3.6e+07 flops=2.9e+09
 sigma_tot[gemm] counter=101 i=0 t=2.3e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=3 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=4 t=1.5e-02 per=1.1e+01 cost=7.8e+06 flops=5.2e+08
 sigma_tot[gemm] counter=101 i=5 t=1.7e-02 per=1.3e+01 cost=7.9e+06 flops=4.7e+08
 sigma_tot[gemm] counter=101 i=6 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.6e+08
 sigma_tot[gemm] counter=101 i=7 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.7e+08
 sigma_tot[gemm] counter=101 total t=6.5e-02 per=4.9e+01 cost=3.1e+07 flops=4.7e+08
 sigma_tot[red] counter=101 t=5.6e-02 per=4.2e+01 cost=7.3e+06 flops=1.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.1e-05,1.8e-06,1.0e-06,1.7e-07
    5   0 -    -116.311487642228 -1.378e-06  2.297e-04    3     5  7.736e-03 1.547e-03 1.500e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.267e-05,8.282e-05,5.454e-04,5.741e-04,1.269e-03
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.141e-05 speed=3.550e-02GB/S T(nccl)=4.126e-05 speed=1.842e-02GB/S
----- TIMING FOR sigma : t_inter=8.3e-05 t_gemm=5.4e-04 t_reduction=5.7e-04 tot=1.2e-03 -----
 sigma[inter] counter=102 t=8.3e-05 per=6.9e+00 cost=9.1e+04 flops=1.1e+09
 sigma[gemm] counter=102 i=0 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=3 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=4 t=1.2e-04 per=9.6e+00 cost=6.6e+03 flops=5.7e+07
 sigma[gemm] counter=102 i=5 t=1.2e-04 per=1.0e+01 cost=6.6e+03 flops=5.4e+07
 sigma[gemm] counter=102 i=6 t=1.5e-04 per=1.2e+01 cost=1.1e+04 flops=7.2e+07
 sigma[gemm] counter=102 i=7 t=1.5e-04 per=1.2e+01 cost=9.6e+03 flops=6.5e+07
 sigma[gemm] counter=102 total t=5.4e-04 per=4.5e+01 cost=3.4e+04 flops=6.2e+07
 sigma[red] counter=102 t=5.7e-04 per=4.8e+01 cost=1.4e+04 flops=2.5e+07
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.6e-02 t_reduction=5.7e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=102 t=1.2e-02 per=9.2e+00 cost=3.6e+07 flops=2.8e+09
 sigma_tot[gemm] counter=102 i=0 t=2.4e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=3 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=4 t=1.5e-02 per=1.1e+01 cost=7.8e+06 flops=5.2e+08
 sigma_tot[gemm] counter=102 i=5 t=1.7e-02 per=1.3e+01 cost=7.9e+06 flops=4.6e+08
 sigma_tot[gemm] counter=102 i=6 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.6e+08
 sigma_tot[gemm] counter=102 i=7 t=1.6e-02 per=1.2e+01 cost=7.6e+06 flops=4.7e+08
 sigma_tot[gemm] counter=102 total t=6.6e-02 per=4.9e+01 cost=3.1e+07 flops=4.7e+08
 sigma_tot[red] counter=102 t=5.7e-02 per=4.2e+01 cost=7.3e+06 flops=1.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.1e-05,1.9e-06,9.9e-07,1.8e-07
    6   0 +    -116.311487752566 -1.103e-07  5.271e-05    3     6  9.245e-03 1.541e-03 1.493e-03
TIMING FOR Davidson : 9.257e-03  T(cal/comm/rest)=8.961e-03,1.483e-06,2.947e-04
decomposed t_rest=2.947e-04
 T(sub)    =1.037e-04 per=3.519e+01
 T(precond)=1.327e-05 per=4.502e+00
 T(ortho)  =7.451e-06 per=2.528e+00
 T(xcopy)  =8.060e-07 per=2.735e-01
 T(xnrm2)  =9.130e-07 per=3.098e-01
 T(other)  =1.686e-04 per=5.720e+01
optimized energies: isweep=0 ibond=15 dots=2 e[0]=-116.311487752566 nmvp=6
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=8.115e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=12 dimAll=40
 (25,3):5 (27,3):7 (26,2):8 (26,4):4 (24,2):2 (25,1):3 (28,2):3 (27,1):3 (26,0):1 (28,4):2 (27,5):1 (29,3):1
timing for divide=5.9e-06
timing for compute=4.5e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(su2): 6.1e-05 S T(divide/compute[cpu/gpu/rest]/collect)=5.9e-06,3.6e-05,0.0e+00,8.8e-06,1.0e-05 -----
decimation summary: 40->10 dwt=+5.064e-08 SvN=8.797e-01
 qbond: qkept nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 9.337e-04 S T(decim/select/formRot)=1.050e-04,8.015e-04,2.721e-05 -----
----- TIMING FOR twodot_decimation: 1.000e-03 S T(wf/decim)=5.803e-05,9.425e-04 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:17 S:2 H:1 P:4 Q:7 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=636:4.852e-03MB:4.739e-06GB
        per(mem): C:58.8 S:6.92 H:3.14 P:4.87 Q:26.3 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=9.807e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=29 : 9.526e-05 S -----
rank=0 GPUmem(GB): used=2.923e-05 (oper)=1.762e-05
rank=0 GPUmem(GB): used=2.958e-05 (oper,site)=1.762e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=29
 no. of rintermediate operators=18
 no. of coefficients=288:2.197e-03MB:2.146e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.697e-05 S -----
rank=0 GPUmem(GB): used=3.172e-05 (oper,site,rinter)=1.762e-05,3.502e-07,2.146e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.144e-03 S size(rtasks)=29 size(Rlst2)=36 T(Rmu/Rlist)=3.497e-05,1.109e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.248e-03 S size(rtasks)=29 size(Rlst)=1008 -----
rank=0 GPUmem(GB): used=3.172e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.878e-04 blksize=9 blksize0=6 batchsize=1008
rank=0 GPUmem(GB): used=2.195e-04 (oper,site,rinter,batch)=1.762e-05,3.502e-07,2.146e-06,1.878e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.906e-05,5.545e-04,2.144e-04
----- TIMING FOR renorm : t_inter=9.9e-05 t_gemm=5.5e-04 t_reduction=2.1e-04 tot=8.7e-04 -----
 renorm[inter] counter=177 t=9.9e-05 per=1.1e+01 cost=2.0e+04 flops=2.0e+08
 renorm[gemm] counter=177 i=0 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=177 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=177 i=2 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=177 i=3 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=177 i=4 t=1.8e-04 per=2.1e+01 cost=2.7e+03 flops=1.5e+07
 renorm[gemm] counter=177 i=5 t=1.8e-04 per=2.1e+01 cost=8.6e+03 flops=4.7e+07
 renorm[gemm] counter=177 i=6 t=1.8e-04 per=2.1e+01 cost=1.4e+04 flops=7.7e+07
 renorm[gemm] counter=177 total t=5.5e-04 per=6.4e+01 cost=2.5e+04 flops=4.6e+07
 renorm[red] counter=177 t=2.1e-04 per=2.5e+01 cost=7.7e+03 flops=3.6e+07
----- TIMING FOR renorm_tot : t_inter=1.5e-03 t_gemm=6.2e-03 t_reduction=2.5e-03 tot=1.0e-02 -----
 renorm_tot[inter] counter=177 t=1.5e-03 per=1.5e+01 cost=3.6e+05 flops=2.3e+08
 renorm_tot[gemm] counter=177 i=0 t=3.4e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=177 i=1 t=3.1e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=177 i=2 t=3.1e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=177 i=3 t=3.1e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=177 i=4 t=2.0e-03 per=1.9e+01 cost=5.1e+04 flops=2.6e+07
 renorm_tot[gemm] counter=177 i=5 t=2.1e-03 per=2.0e+01 cost=2.4e+05 flops=1.1e+08
 renorm_tot[gemm] counter=177 i=6 t=2.0e-03 per=2.0e+01 cost=4.4e+05 flops=2.2e+08
 renorm_tot[gemm] counter=177 total t=6.2e-03 per=6.1e+01 cost=7.3e+05 flops=1.2e+08
 renorm_tot[red] counter=177 t=2.5e-03 per=2.4e+01 cost=1.9e+05 flops=7.7e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.225e-05 (oper)=1.778e-05
rank=0 GPUmem(GB): used=3.260e-05 (oper,site,rinter)=1.778e-05,3.502e-07,7.153e-07
rank=0 GPUmem(GB): used=4.639e-05 (oper,site,rinter,batch)=1.778e-05,3.502e-07,7.153e-07,1.378e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.778e-03 S T(preprocess/alloc/comp/red/dealloc)=4.487e-04,4.998e-04,1.168e-03,6.404e-05,3.909e-05 -----
----- TIMING FOR oper_renorm_opS : 1.798e-03 S rank=0 -----
qops.to_cpu: size(tot)=636:4.852e-03MB:4.739e-06GB T(to_cpu)=2.277e-05S speed=2.081e-01GB/S
check ||H-H.dagger||=9.895e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.00514 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=2.729e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=6.332e-04 change=-1.183e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=6.332e-04 change=-4.813e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 2.728e-02 S #####
 T(local opt: fetch) = 2.147e-03 S  per = 7.87  per(accum) = 7.87
 T(local opt: hdiag) = 7.178e-04 S  per = 2.63  per(accum) = 10.5
 T(local opt: dvdsn) = 1.568e-02 S  per = 57.5  per(accum) = 68
 T(local opt: decim) = 1.032e-03 S  per = 3.78  per(accum) = 71.8
 T(local opt: guess) = 6.726e-05 S  per = 0.247  per(accum) = 72
 T(local opt: renrm) = 5.790e-03 S  per = 21.2  per(accum) = 93.3
 T(local opt: save ) = 1.839e-03 S  per = 6.74  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.568e-02 S  T(sum) = 1.542e-02 S  per = 9.835e+01
 T(local opt: preprocess                  ) = 1.746e-04 S  per = 1.13  per(accum) = 1.13
 T(local opt: symbolic_formulae           ) = 1.794e-04 S  per = 1.16  per(accum) = 2.3
 T(local opt: hintermediate init          ) = 3.217e-05 S  per = 0.209  per(accum) = 2.5
 T(local opt: preprocess_hformulae_Hxlist ) = 4.793e-03 S  per = 31.1  per(accum) = 33.6
 T(local opt: hmmtasks init               ) = 9.104e-04 S  per =  5.9  per(accum) = 39.5
 T(local opt: initial guess for dvdson    ) = 7.835e-05 S  per = 0.508  per(accum) = 40
 T(local opt: dvdson [Hx_batchGPU]        ) = 8.568e-03 S  per = 55.5  per(accum) = 95.5
 T(local opt: dvdson [cpu-gpu]            ) = 1.302e-04 S  per = 0.844  per(accum) = 96.4
 T(local opt: dvdson [nccl]               ) = 2.625e-04 S  per =  1.7  per(accum) = 98.1
 T(local opt: dvdson [mpi]                ) = 1.483e-06 S  per = 0.00961  per(accum) = 98.1
 T(local opt: dvdson [rest part(linalg)]  ) = 2.947e-04 S  per = 1.91  per(accum) = 100
Detailed decomposition of T(renrm) = 5.790e-03 S  T(sum) = 5.790e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.696e-05 S  per = 0.984  per(accum) = 0.984
 T(local opt: qops init                    ) = 2.928e-04 S  per = 5.06  per(accum) = 6.04
 T(local opt: symbolic_formulae_renorm     ) = 1.079e-04 S  per = 1.86  per(accum) = 7.91
 T(local opt: allocate qops on gpu         ) = 5.776e-05 S  per = 0.998  per(accum) = 8.9
 T(local opt: site memcpy cpu2gpu          ) = 2.514e-05 S  per = 0.434  per(accum) = 9.34
 T(local opt: rintermediate init           ) = 5.559e-05 S  per = 0.96  per(accum) = 10.3
 T(local opt: preprocess_formulae_Rlist2   ) = 1.259e-03 S  per = 21.8  per(accum) = 32
 T(local opt: rmmtasks init                ) = 3.870e-04 S  per = 6.68  per(accum) = 38.7
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 0.000691  per(accum) = 38.7
 T(local opt: preprocess_renorm_batchGPU   ) = 1.046e-03 S  per = 18.1  per(accum) = 56.8
 T(local opt: deallocate cpu and gpu memory) = 2.882e-05 S  per = 0.498  per(accum) = 57.3
 T(local opt: construct opS [ifdists=true] ) = 1.812e-03 S  per = 31.3  per(accum) = 88.6
 T(local opt: reduction of opS & opH [nccl]) = 1.835e-05 S  per = 0.317  per(accum) = 88.9
 T(local opt: qops memcpy gpu2cpu          ) = 3.209e-05 S  per = 0.554  per(accum) = 89.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.574e-05 S  per = 0.272  per(accum) = 89.7
 T(local opt: qops_pool join and erase     ) = 5.903e-04 S  per = 10.2  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 4.267e-06 S  per = 0.0737  per(accum) = 100
ctns::rcanon_save_site idx=3 scratch=./scratch/sweep size=47:3.5e-07GB T(load)=0.00058S speed=0.0006GB/S
##### sweep opt: 6.941e-01 S #####
 T(sweep opt: fetch) = 4.183e-02 S  per = 6.03  per(accum) = 6.03
 T(sweep opt: hdiag) = 3.741e-02 S  per = 5.39  per(accum) = 11.4
 T(sweep opt: dvdsn) = 4.302e-01 S  per =   62  per(accum) = 73.4
 T(sweep opt: decim) = 1.779e-02 S  per = 2.56  per(accum) = 76
 T(sweep opt: guess) = 1.344e-03 S  per = 0.194  per(accum) = 76.2
 T(sweep opt: renrm) = 1.361e-01 S  per = 19.6  per(accum) = 95.8
 T(sweep opt: save ) = 2.940e-02 S  per = 4.24  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.302e-01 S  T(sum) = 4.235e-01 S  per = 9.844e+01
 T(sweep opt: preprocess                  ) = 4.524e-03 S  per = 1.07  per(accum) = 1.07
 T(sweep opt: symbolic_formulae           ) = 7.871e-03 S  per = 1.86  per(accum) = 2.93
 T(sweep opt: hintermediate init          ) = 1.108e-03 S  per = 0.262  per(accum) = 3.19
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.975e-01 S  per = 46.6  per(accum) = 49.8
 T(sweep opt: hmmtasks init               ) = 3.954e-02 S  per = 9.34  per(accum) = 59.2
 T(sweep opt: initial guess for dvdson    ) = 2.107e-03 S  per = 0.497  per(accum) = 59.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.575e-01 S  per = 37.2  per(accum) = 96.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.290e-03 S  per = 0.541  per(accum) = 97.4
 T(sweep opt: dvdson [nccl]               ) = 5.344e-03 S  per = 1.26  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 3.921e-05 S  per = 0.00926  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.600e-03 S  per = 1.32  per(accum) = 100
Detailed decomposition of T(renrm) = 1.361e-01 S  T(sum) = 1.361e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.500e-04 S  per = 0.625  per(accum) = 0.625
 T(sweep opt: qops init                    ) = 5.535e-03 S  per = 4.07  per(accum) = 4.69
 T(sweep opt: symbolic_formulae_renorm     ) = 2.971e-03 S  per = 2.18  per(accum) = 6.87
 T(sweep opt: allocate qops on gpu         ) = 9.131e-04 S  per = 0.671  per(accum) = 7.54
 T(sweep opt: site memcpy cpu2gpu          ) = 3.944e-04 S  per = 0.29  per(accum) = 7.83
 T(sweep opt: rintermediate init           ) = 7.610e-04 S  per = 0.559  per(accum) = 8.39
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.128e-02 S  per = 15.6  per(accum) = 24
 T(sweep opt: rmmtasks init                ) = 6.703e-03 S  per = 4.93  per(accum) = 29
 T(sweep opt: qops memset on cpu           ) = 7.910e-07 S  per = 0.000581  per(accum) = 29
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.239e-02 S  per =  9.1  per(accum) = 38.1
 T(sweep opt: deallocate cpu and gpu memory) = 4.807e-04 S  per = 0.353  per(accum) = 38.4
 T(sweep opt: construct opS [ifdists=true] ) = 6.820e-02 S  per = 50.1  per(accum) = 88.5
 T(sweep opt: reduction of opS & opH [nccl]) = 2.954e-04 S  per = 0.217  per(accum) = 88.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.563e-04 S  per = 0.409  per(accum) = 89.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.687e-04 S  per = 0.124  per(accum) = 89.3
 T(sweep opt: qops_pool join and erase     ) = 1.183e-02 S  per = 8.69  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 2.783e-03 S  per = 2.04  per(accum) = 100
##### global opt: 6.941e-01 S #####
 T(global opt: fetch) = 4.183e-02 S  per = 6.03  per(accum) = 6.03
 T(global opt: hdiag) = 3.741e-02 S  per = 5.39  per(accum) = 11.4
 T(global opt: dvdsn) = 4.302e-01 S  per =   62  per(accum) = 73.4
 T(global opt: decim) = 1.779e-02 S  per = 2.56  per(accum) = 76
 T(global opt: guess) = 1.344e-03 S  per = 0.194  per(accum) = 76.2
 T(global opt: renrm) = 1.361e-01 S  per = 19.6  per(accum) = 95.8
 T(global opt: save ) = 2.940e-02 S  per = 4.24  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.302e-01 S  T(sum) = 4.235e-01 S  per = 9.844e+01
 T(global opt: preprocess                  ) = 4.524e-03 S  per = 1.07  per(accum) = 1.07
 T(global opt: symbolic_formulae           ) = 7.871e-03 S  per = 1.86  per(accum) = 2.93
 T(global opt: hintermediate init          ) = 1.108e-03 S  per = 0.262  per(accum) = 3.19
 T(global opt: preprocess_hformulae_Hxlist ) = 1.975e-01 S  per = 46.6  per(accum) = 49.8
 T(global opt: hmmtasks init               ) = 3.954e-02 S  per = 9.34  per(accum) = 59.2
 T(global opt: initial guess for dvdson    ) = 2.107e-03 S  per = 0.497  per(accum) = 59.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.575e-01 S  per = 37.2  per(accum) = 96.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.290e-03 S  per = 0.541  per(accum) = 97.4
 T(global opt: dvdson [nccl]               ) = 5.344e-03 S  per = 1.26  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 3.921e-05 S  per = 0.00926  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 5.600e-03 S  per = 1.32  per(accum) = 100
Detailed decomposition of T(renrm) = 1.361e-01 S  T(sum) = 1.361e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.500e-04 S  per = 0.625  per(accum) = 0.625
 T(global opt: qops init                    ) = 5.535e-03 S  per = 4.07  per(accum) = 4.69
 T(global opt: symbolic_formulae_renorm     ) = 2.971e-03 S  per = 2.18  per(accum) = 6.87
 T(global opt: allocate qops on gpu         ) = 9.131e-04 S  per = 0.671  per(accum) = 7.54
 T(global opt: site memcpy cpu2gpu          ) = 3.944e-04 S  per = 0.29  per(accum) = 7.83
 T(global opt: rintermediate init           ) = 7.610e-04 S  per = 0.559  per(accum) = 8.39
 T(global opt: preprocess_formulae_Rlist2   ) = 2.128e-02 S  per = 15.6  per(accum) = 24
 T(global opt: rmmtasks init                ) = 6.703e-03 S  per = 4.93  per(accum) = 29
 T(global opt: qops memset on cpu           ) = 7.910e-07 S  per = 0.000581  per(accum) = 29
 T(global opt: preprocess_renorm_batchGPU   ) = 1.239e-02 S  per =  9.1  per(accum) = 38.1
 T(global opt: deallocate cpu and gpu memory) = 4.807e-04 S  per = 0.353  per(accum) = 38.4
 T(global opt: construct opS [ifdists=true] ) = 6.820e-02 S  per = 50.1  per(accum) = 88.5
 T(global opt: reduction of opS & opH [nccl]) = 2.954e-04 S  per = 0.217  per(accum) = 88.7
 T(global opt: qops memcpy gpu2cpu          ) = 5.563e-04 S  per = 0.409  per(accum) = 89.1
 T(global opt: reduction of opS & opH [mpi] ) = 1.687e-04 S  per = 0.124  per(accum) = 89.3
 T(global opt: qops_pool join and erase     ) = 1.183e-02 S  per = 8.69  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 2.783e-03 S  per = 2.04  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-8.217e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=16/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=1 scratch=./scratch/sweep size=5:3.73e-08GB T(load)=3.13e-04S speed=1.19e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=12:9.16e-05MB:8.94e-08GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=23:1.75e-04MB:1.71e-07GB
total mem of comb=36:2.75e-04MB:2.68e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.624e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:17 S:2 H:1 P:4 Q:7 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=636:4.852e-03MB:4.739e-06GB
        per(mem): C:58.8 S:6.92 H:3.14 P:4.87 Q:26.3 
 rqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3630:0.0277MB:2.7e-05GB
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.589e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=4.172e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=41:3.128e-04MB
qtensor4: wf4 own=1 _data=0x5585ef0f94a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=41:3.128e-04MB
### DIAG TIMING: total=3.197e-04 t1=1.699e-05, t2=1.806e-05, t3=1.706e-05, t4=2.178e-04, t5=6.524e-06, t6=3.652e-05, t7=6.701e-06
duration_diagGPU:3.332e-04
duration_diagreduce:3.600e-08
duration_diagtransform:1.830e-07
----- TIMING FOR symbolic_formulae_twodot with size=110 : 1.473e-04 S -----
rank=0 GPUmem(GB): used=2.705e-05 (oper)=2.705e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=110
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.242e-05 S -----
rank=0 GPUmem(GB): used=2.857e-05 (oper,hinter)=2.705e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.592e-03 S size(H_formulae)=110 size(Hxlst2)=24 T(Hmu/Hxlist)=5.619e-05,5.536e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.901e-03 S size(H_formulae)=110 size(Hxlst)=3238 -----
rank=0 GPUmem(GB): used=2.857e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=6.109e-07 batch[need]=3.136e-04 blksize=3 blksize0=6 batchsize=3238
rank=0 GPUmem(GB): used=3.428e-04 (oper,hinter,dvdson,batch)=2.705e-05,1.520e-06,6.109e-07,3.136e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=41 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.947e-04,9.288e-05,3.370e-04,5.896e-04,1.723e-03
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.377e-05 speed=2.571e-02GB/S T(nccl)=6.710e-04 speed=9.105e-04GB/S
----- TIMING FOR sigma : t_inter=9.3e-05 t_gemm=3.4e-04 t_reduction=5.9e-04 tot=1.0e-03 -----
 sigma[inter] counter=103 t=9.3e-05 per=9.1e+00 cost=2.9e+04 flops=3.1e+08
 sigma[gemm] counter=103 i=0 t=2.1e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=1.9e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=4 t=6.9e-05 per=6.8e+00 cost=4.2e+03 flops=6.0e+07
 sigma[gemm] counter=103 i=5 t=6.8e-05 per=6.6e+00 cost=4.1e+03 flops=6.1e+07
 sigma[gemm] counter=103 i=6 t=9.7e-05 per=9.5e+00 cost=9.2e+03 flops=9.5e+07
 sigma[gemm] counter=103 i=7 t=9.5e-05 per=9.3e+00 cost=9.2e+03 flops=9.7e+07
 sigma[gemm] counter=103 total t=3.4e-04 per=3.3e+01 cost=2.7e+04 flops=7.9e+07
 sigma[red] counter=103 t=5.9e-04 per=5.8e+01 cost=1.2e+04 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.6e-02 t_reduction=5.8e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=103 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.8e+09
 sigma_tot[gemm] counter=103 i=0 t=2.4e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=3 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=4 t=1.5e-02 per=1.1e+01 cost=7.8e+06 flops=5.2e+08
 sigma_tot[gemm] counter=103 i=5 t=1.7e-02 per=1.3e+01 cost=7.9e+06 flops=4.6e+08
 sigma_tot[gemm] counter=103 i=6 t=1.7e-02 per=1.2e+01 cost=7.6e+06 flops=4.6e+08
 sigma_tot[gemm] counter=103 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.6e+08
 sigma_tot[gemm] counter=103 total t=6.6e-02 per=4.9e+01 cost=3.1e+07 flops=4.7e+08
 sigma_tot[red] counter=103 t=5.8e-02 per=4.2e+01 cost=7.3e+06 flops=1.3e+08
T(sub)=8.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.0e-06,1.2e-06,9.7e-07,2.9e-07
settings: ndim=41 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.311487721542 -1.116e+03  4.799e-02    1     1  1.996e-03 1.996e-03 1.970e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.143e-05,8.527e-05,3.888e-04,6.358e-04,1.186e-03
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.333e-05 speed=2.619e-02GB/S T(nccl)=4.811e-05 speed=1.270e-02GB/S
----- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=3.9e-04 t_reduction=6.4e-04 tot=1.1e-03 -----
 sigma[inter] counter=104 t=8.5e-05 per=7.7e+00 cost=2.9e+04 flops=3.4e+08
 sigma[gemm] counter=104 i=0 t=2.7e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=3.0e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=3 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=4 t=7.4e-05 per=6.6e+00 cost=4.2e+03 flops=5.6e+07
 sigma[gemm] counter=104 i=5 t=7.5e-05 per=6.8e+00 cost=4.1e+03 flops=5.4e+07
 sigma[gemm] counter=104 i=6 t=1.2e-04 per=1.0e+01 cost=9.2e+03 flops=8.0e+07
 sigma[gemm] counter=104 i=7 t=1.1e-04 per=1.0e+01 cost=9.2e+03 flops=8.1e+07
 sigma[gemm] counter=104 total t=3.9e-04 per=3.5e+01 cost=2.7e+04 flops=6.9e+07
 sigma[red] counter=104 t=6.4e-04 per=5.7e+01 cost=1.2e+04 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.7e-02 t_reduction=5.8e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=104 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.8e+09
 sigma_tot[gemm] counter=104 i=0 t=2.4e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=3 t=2.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=4 t=1.5e-02 per=1.1e+01 cost=7.9e+06 flops=5.1e+08
 sigma_tot[gemm] counter=104 i=5 t=1.7e-02 per=1.3e+01 cost=7.9e+06 flops=4.6e+08
 sigma_tot[gemm] counter=104 i=6 t=1.7e-02 per=1.2e+01 cost=7.6e+06 flops=4.6e+08
 sigma_tot[gemm] counter=104 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.6e+08
 sigma_tot[gemm] counter=104 total t=6.7e-02 per=4.8e+01 cost=3.1e+07 flops=4.7e+08
 sigma_tot[red] counter=104 t=5.8e-02 per=4.2e+01 cost=7.3e+06 flops=1.3e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.1e-05,2.9e-06,1.6e-06,3.3e-07
    2   0 -    -116.316320812362 -4.833e-03  9.176e-03    2     2  3.372e-03 1.686e-03 1.643e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.627e-05,7.921e-05,3.950e-04,6.297e-04,1.174e-03
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.244e-05 speed=2.722e-02GB/S T(nccl)=4.383e-05 speed=1.394e-02GB/S
----- TIMING FOR sigma : t_inter=7.9e-05 t_gemm=3.9e-04 t_reduction=6.3e-04 tot=1.1e-03 -----
 sigma[inter] counter=105 t=7.9e-05 per=7.2e+00 cost=2.9e+04 flops=3.6e+08
 sigma[gemm] counter=105 i=0 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=3 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=4 t=7.5e-05 per=6.8e+00 cost=4.2e+03 flops=5.5e+07
 sigma[gemm] counter=105 i=5 t=7.3e-05 per=6.6e+00 cost=4.1e+03 flops=5.6e+07
 sigma[gemm] counter=105 i=6 t=1.2e-04 per=1.1e+01 cost=9.2e+03 flops=7.6e+07
 sigma[gemm] counter=105 i=7 t=1.2e-04 per=1.1e+01 cost=9.2e+03 flops=7.9e+07
 sigma[gemm] counter=105 total t=3.9e-04 per=3.6e+01 cost=2.7e+04 flops=6.8e+07
 sigma[red] counter=105 t=6.3e-04 per=5.7e+01 cost=1.2e+04 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.7e-02 t_reduction=5.9e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=105 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.8e+09
 sigma_tot[gemm] counter=105 i=0 t=2.4e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=3 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=4 t=1.5e-02 per=1.1e+01 cost=7.9e+06 flops=5.1e+08
 sigma_tot[gemm] counter=105 i=5 t=1.7e-02 per=1.2e+01 cost=7.9e+06 flops=4.6e+08
 sigma_tot[gemm] counter=105 i=6 t=1.7e-02 per=1.2e+01 cost=7.6e+06 flops=4.5e+08
 sigma_tot[gemm] counter=105 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.6e+08
 sigma_tot[gemm] counter=105 total t=6.7e-02 per=4.8e+01 cost=3.1e+07 flops=4.6e+08
 sigma_tot[red] counter=105 t=5.9e-02 per=4.2e+01 cost=7.4e+06 flops=1.2e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.5e-05,2.3e-06,1.4e-06,2.6e-07
    3   0 -    -116.316684783080 -3.640e-04  2.834e-03    3     3  4.718e-03 1.573e-03 1.528e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.140e-05,8.110e-05,3.837e-04,6.331e-04,1.173e-03
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.198e-05 speed=2.779e-02GB/S T(nccl)=4.942e-05 speed=1.236e-02GB/S
----- TIMING FOR sigma : t_inter=8.1e-05 t_gemm=3.8e-04 t_reduction=6.3e-04 tot=1.1e-03 -----
 sigma[inter] counter=106 t=8.1e-05 per=7.4e+00 cost=2.9e+04 flops=3.6e+08
 sigma[gemm] counter=106 i=0 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=3 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=4 t=7.3e-05 per=6.7e+00 cost=4.2e+03 flops=5.7e+07
 sigma[gemm] counter=106 i=5 t=7.4e-05 per=6.7e+00 cost=4.1e+03 flops=5.5e+07
 sigma[gemm] counter=106 i=6 t=1.1e-04 per=1.0e+01 cost=9.2e+03 flops=8.1e+07
 sigma[gemm] counter=106 i=7 t=1.1e-04 per=1.0e+01 cost=9.2e+03 flops=8.1e+07
 sigma[gemm] counter=106 total t=3.8e-04 per=3.5e+01 cost=2.7e+04 flops=7.0e+07
 sigma[red] counter=106 t=6.3e-04 per=5.8e+01 cost=1.2e+04 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.7e-02 t_reduction=6.0e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=106 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.8e+09
 sigma_tot[gemm] counter=106 i=0 t=2.4e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=3 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=4 t=1.5e-02 per=1.1e+01 cost=7.9e+06 flops=5.1e+08
 sigma_tot[gemm] counter=106 i=5 t=1.7e-02 per=1.2e+01 cost=7.9e+06 flops=4.6e+08
 sigma_tot[gemm] counter=106 i=6 t=1.7e-02 per=1.2e+01 cost=7.6e+06 flops=4.5e+08
 sigma_tot[gemm] counter=106 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.6e+08
 sigma_tot[gemm] counter=106 total t=6.7e-02 per=4.8e+01 cost=3.1e+07 flops=4.6e+08
 sigma_tot[red] counter=106 t=6.0e-02 per=4.3e+01 cost=7.4e+06 flops=1.2e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.3e-06,1.2e-06,2.1e-07
    4   0 -    -116.316727036912 -4.225e-05  7.229e-04    3     4  6.218e-03 1.554e-03 1.510e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.400e-05,8.116e-05,3.816e-04,5.959e-04,1.127e-03
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.117e-05 speed=2.886e-02GB/S T(nccl)=4.283e-05 speed=1.426e-02GB/S
----- TIMING FOR sigma : t_inter=8.1e-05 t_gemm=3.8e-04 t_reduction=6.0e-04 tot=1.1e-03 -----
 sigma[inter] counter=107 t=8.1e-05 per=7.7e+00 cost=2.9e+04 flops=3.6e+08
 sigma[gemm] counter=107 i=0 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=3 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=4 t=7.2e-05 per=6.8e+00 cost=4.2e+03 flops=5.8e+07
 sigma[gemm] counter=107 i=5 t=7.2e-05 per=6.8e+00 cost=4.1e+03 flops=5.7e+07
 sigma[gemm] counter=107 i=6 t=1.2e-04 per=1.1e+01 cost=9.2e+03 flops=7.9e+07
 sigma[gemm] counter=107 i=7 t=1.1e-04 per=1.1e+01 cost=9.2e+03 flops=8.2e+07
 sigma[gemm] counter=107 total t=3.8e-04 per=3.6e+01 cost=2.7e+04 flops=7.0e+07
 sigma[red] counter=107 t=6.0e-04 per=5.6e+01 cost=1.2e+04 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.8e-02 t_reduction=6.0e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=107 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.8e+09
 sigma_tot[gemm] counter=107 i=0 t=2.5e-04 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=3 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=4 t=1.5e-02 per=1.1e+01 cost=7.9e+06 flops=5.1e+08
 sigma_tot[gemm] counter=107 i=5 t=1.7e-02 per=1.2e+01 cost=7.9e+06 flops=4.5e+08
 sigma_tot[gemm] counter=107 i=6 t=1.7e-02 per=1.2e+01 cost=7.6e+06 flops=4.5e+08
 sigma_tot[gemm] counter=107 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.5e+08
 sigma_tot[gemm] counter=107 total t=6.8e-02 per=4.8e+01 cost=3.1e+07 flops=4.6e+08
 sigma_tot[red] counter=107 t=6.0e-02 per=4.3e+01 cost=7.4e+06 flops=1.2e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,1.0e-05,1.7e-06,9.7e-07,1.5e-07
    5   0 -    -116.316728559371 -1.522e-06  2.466e-04    3     5  7.483e-03 1.497e-03 1.453e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.051e-05,6.803e-05,3.405e-04,5.803e-04,1.053e-03
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.100e-05 speed=2.909e-02GB/S T(nccl)=3.951e-05 speed=1.546e-02GB/S
----- TIMING FOR sigma : t_inter=6.8e-05 t_gemm=3.4e-04 t_reduction=5.8e-04 tot=9.9e-04 -----
 sigma[inter] counter=108 t=6.8e-05 per=6.9e+00 cost=2.9e+04 flops=4.2e+08
 sigma[gemm] counter=108 i=0 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=3 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=4 t=6.5e-05 per=6.5e+00 cost=4.2e+03 flops=6.4e+07
 sigma[gemm] counter=108 i=5 t=6.4e-05 per=6.4e+00 cost=4.1e+03 flops=6.4e+07
 sigma[gemm] counter=108 i=6 t=1.1e-04 per=1.1e+01 cost=9.2e+03 flops=8.7e+07
 sigma[gemm] counter=108 i=7 t=9.8e-05 per=9.9e+00 cost=9.2e+03 flops=9.4e+07
 sigma[gemm] counter=108 total t=3.4e-04 per=3.4e+01 cost=2.7e+04 flops=7.8e+07
 sigma[red] counter=108 t=5.8e-04 per=5.9e+01 cost=1.2e+04 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.8e-02 t_reduction=6.1e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=108 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.8e+09
 sigma_tot[gemm] counter=108 i=0 t=2.5e-04 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=3 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=4 t=1.6e-02 per=1.1e+01 cost=7.9e+06 flops=5.1e+08
 sigma_tot[gemm] counter=108 i=5 t=1.7e-02 per=1.2e+01 cost=7.9e+06 flops=4.5e+08
 sigma_tot[gemm] counter=108 i=6 t=1.7e-02 per=1.2e+01 cost=7.6e+06 flops=4.5e+08
 sigma_tot[gemm] counter=108 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.5e+08
 sigma_tot[gemm] counter=108 total t=6.8e-02 per=4.8e+01 cost=3.1e+07 flops=4.6e+08
 sigma_tot[red] counter=108 t=6.1e-02 per=4.3e+01 cost=7.4e+06 flops=1.2e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,1.0e-05,1.7e-06,1.0e-06,1.5e-07
    6   0 +    -116.316728679445 -1.201e-07  3.658e-05    3     6  8.667e-03 1.444e-03 1.403e-03
TIMING FOR Davidson : 8.677e-03  T(cal/comm/rest)=8.416e-03,1.795e-06,2.590e-04
decomposed t_rest=2.590e-04
 T(sub)    =1.044e-04 per=4.030e+01
 T(precond)=1.561e-05 per=6.029e+00
 T(ortho)  =9.071e-06 per=3.503e+00
 T(xcopy)  =9.820e-07 per=3.792e-01
 T(xnrm2)  =9.580e-07 per=3.699e-01
 T(other)  =1.280e-04 per=4.942e+01
optimized energies: isweep=0 ibond=16 dots=2 e[0]=-116.316728679445 nmvp=6
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=9.063e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=11 dimAll=39
 (26,2):5 (28,2):7 (27,1):8 (27,3):4 (25,1):2 (26,0):3 (29,1):3 (28,0):3 (29,3):2 (28,4):1 (30,2):1
timing for divide=5.1e-06
timing for compute=3.4e-05
timing for collect=4.3e-06
----- TMING FOR decimation_genbasis(su2): 4.3e-05 S T(divide/compute[cpu/gpu/rest]/collect)=5.1e-06,3.2e-05,0.0e+00,2.1e-06,4.3e-06 -----
decimation summary: 39->9 dwt=+1.110e-16 SvN=9.103e-01
 qbond: qkept nsym=5 dimAll=9
 (28,0):3 (27,1):2 (29,1):2 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 9.009e-04 S T(decim/select/formRot)=6.459e-05,8.175e-04,1.878e-05 -----
----- TIMING FOR twodot_decimation: 9.591e-04 S T(wf/decim)=4.919e-05,9.099e-04 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:18 S:1 H:1 P:1 Q:4 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=436:3.326e-03MB:3.248e-06GB
        per(mem): C:74.3 S:4.13 H:4.36 P:1.61 Q:15.6 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=6.422e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 7.055e-05 S -----
rank=0 GPUmem(GB): used=3.181e-05 (oper)=1.542e-05
rank=0 GPUmem(GB): used=3.212e-05 (oper,site)=1.542e-05,3.055e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=24
 no. of rintermediate operators=9
 no. of coefficients=153:1.167e-03MB:1.140e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.085e-05 S -----
rank=0 GPUmem(GB): used=3.326e-05 (oper,site,rinter)=1.542e-05,3.055e-07,1.140e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.554e-04 S size(rtasks)=24 size(Rlst2)=25 T(Rmu/Rlist)=2.671e-05,8.286e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.518e-04 S size(rtasks)=24 size(Rlst)=759 -----
rank=0 GPUmem(GB): used=3.326e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.414e-04 blksize=9 blksize0=6 batchsize=759
rank=0 GPUmem(GB): used=1.746e-04 (oper,site,rinter,batch)=1.542e-05,3.055e-07,1.140e-06,1.414e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.001e-04,5.363e-04,1.720e-04
----- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=5.4e-04 t_reduction=1.7e-04 tot=8.1e-04 -----
 renorm[inter] counter=181 t=1.0e-04 per=1.2e+01 cost=1.1e+04 flops=1.1e+08
 renorm[gemm] counter=181 i=0 t=2.1e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=1 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=2 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=3 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=4 t=1.7e-04 per=2.1e+01 cost=1.9e+03 flops=1.1e+07
 renorm[gemm] counter=181 i=5 t=1.8e-04 per=2.2e+01 cost=5.7e+03 flops=3.2e+07
 renorm[gemm] counter=181 i=6 t=1.8e-04 per=2.2e+01 cost=8.4e+03 flops=4.8e+07
 renorm[gemm] counter=181 total t=5.4e-04 per=6.6e+01 cost=1.6e+04 flops=3.0e+07
 renorm[red] counter=181 t=1.7e-04 per=2.1e+01 cost=4.9e+03 flops=2.8e+07
----- TIMING FOR renorm_tot : t_inter=1.6e-03 t_gemm=6.7e-03 t_reduction=2.6e-03 tot=1.1e-02 -----
 renorm_tot[inter] counter=181 t=1.6e-03 per=1.5e+01 cost=3.7e+05 flops=2.3e+08
 renorm_tot[gemm] counter=181 i=0 t=3.7e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=1 t=3.2e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=2 t=3.2e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=3 t=3.2e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=4 t=2.2e-03 per=2.0e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=181 i=5 t=2.3e-03 per=2.1e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=181 i=6 t=2.2e-03 per=2.0e+01 cost=4.4e+05 flops=2.0e+08
 renorm_tot[gemm] counter=181 total t=6.7e-03 per=6.1e+01 cost=7.4e+05 flops=1.1e+08
 renorm_tot[red] counter=181 t=2.6e-03 per=2.4e+01 cost=2.0e+05 flops=7.4e+07
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.347e-05 (oper)=1.556e-05
rank=0 GPUmem(GB): used=3.377e-05 (oper,site,rinter)=1.556e-05,3.055e-07,3.800e-07
rank=0 GPUmem(GB): used=4.607e-05 (oper,site,rinter,batch)=1.556e-05,3.055e-07,3.800e-07,1.229e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.224e-03 S T(preprocess/alloc/comp/red/dealloc)=2.841e-04,3.236e-04,8.105e-04,4.781e-05,3.663e-05 -----
----- TIMING FOR oper_renorm_opS : 1.235e-03 S rank=0 -----
qops.to_cpu: size(tot)=436:3.326e-03MB:3.248e-06GB T(to_cpu)=2.134e-05S speed=1.522e-01GB/S
check ||H-H.dagger||=6.083e-15 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.00392 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=2.047e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=-1.994e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=-3.859e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 2.720e-02 S #####
 T(local opt: fetch) = 3.162e-03 S  per = 11.6  per(accum) = 11.6
 T(local opt: hdiag) = 4.216e-04 S  per = 1.55  per(accum) = 13.2
 T(local opt: dvdsn) = 1.653e-02 S  per = 60.8  per(accum) = 74
 T(local opt: decim) = 1.015e-03 S  per = 3.73  per(accum) = 77.7
 T(local opt: guess) = 6.262e-05 S  per = 0.23  per(accum) = 77.9
 T(local opt: renrm) = 4.236e-03 S  per = 15.6  per(accum) = 93.5
 T(local opt: save ) = 1.770e-03 S  per = 6.51  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.653e-02 S  T(sum) = 1.631e-02 S  per = 9.865e+01
 T(local opt: preprocess                  ) = 2.208e-04 S  per = 1.35  per(accum) = 1.35
 T(local opt: symbolic_formulae           ) = 1.573e-04 S  per = 0.965  per(accum) = 2.32
 T(local opt: hintermediate init          ) = 6.103e-05 S  per = 0.374  per(accum) = 2.69
 T(local opt: preprocess_hformulae_Hxlist ) = 5.923e-03 S  per = 36.3  per(accum) = 39
 T(local opt: hmmtasks init               ) = 1.152e-03 S  per = 7.06  per(accum) = 46.1
 T(local opt: initial guess for dvdson    ) = 1.176e-04 S  per = 0.721  per(accum) = 46.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 7.387e-03 S  per = 45.3  per(accum) = 92.1
 T(local opt: dvdson [cpu-gpu]            ) = 1.337e-04 S  per = 0.82  per(accum) = 92.9
 T(local opt: dvdson [nccl]               ) = 8.947e-04 S  per = 5.49  per(accum) = 98.4
 T(local opt: dvdson [mpi]                ) = 1.795e-06 S  per = 0.011  per(accum) = 98.4
 T(local opt: dvdson [rest part(linalg)]  ) = 2.590e-04 S  per = 1.59  per(accum) = 100
Detailed decomposition of T(renrm) = 4.236e-03 S  T(sum) = 4.236e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.756e-05 S  per = 0.651  per(accum) = 0.651
 T(local opt: qops init                    ) = 2.488e-04 S  per = 5.87  per(accum) = 6.52
 T(local opt: symbolic_formulae_renorm     ) = 7.482e-05 S  per = 1.77  per(accum) = 8.29
 T(local opt: allocate qops on gpu         ) = 4.904e-05 S  per = 1.16  per(accum) = 9.45
 T(local opt: site memcpy cpu2gpu          ) = 1.993e-05 S  per = 0.47  per(accum) = 9.92
 T(local opt: rintermediate init           ) = 2.732e-05 S  per = 0.645  per(accum) = 10.6
 T(local opt: preprocess_formulae_Rlist2   ) = 9.569e-04 S  per = 22.6  per(accum) = 33.2
 T(local opt: rmmtasks init                ) = 3.176e-04 S  per =  7.5  per(accum) = 40.7
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 0.000944  per(accum) = 40.7
 T(local opt: preprocess_renorm_batchGPU   ) = 8.962e-04 S  per = 21.2  per(accum) = 61.8
 T(local opt: deallocate cpu and gpu memory) = 2.826e-05 S  per = 0.667  per(accum) = 62.5
 T(local opt: construct opS [ifdists=true] ) = 1.242e-03 S  per = 29.3  per(accum) = 91.8
 T(local opt: reduction of opS & opH [nccl]) = 1.957e-05 S  per = 0.462  per(accum) = 92.2
 T(local opt: qops memcpy gpu2cpu          ) = 2.608e-05 S  per = 0.616  per(accum) = 92.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.076e-05 S  per = 0.254  per(accum) = 93.1
 T(local opt: qops_pool join and erase     ) = 2.895e-04 S  per = 6.83  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.061e-06 S  per = 0.0487  per(accum) = 100
ctns::rcanon_save_site idx=2 scratch=./scratch/sweep size=41:3.1e-07GB T(load)=0.00058S speed=0.00053GB/S
##### sweep opt: 7.213e-01 S #####
 T(sweep opt: fetch) = 4.499e-02 S  per = 6.24  per(accum) = 6.24
 T(sweep opt: hdiag) = 3.783e-02 S  per = 5.24  per(accum) = 11.5
 T(sweep opt: dvdsn) = 4.467e-01 S  per = 61.9  per(accum) = 73.4
 T(sweep opt: decim) = 1.881e-02 S  per = 2.61  per(accum) = 76
 T(sweep opt: guess) = 1.406e-03 S  per = 0.195  per(accum) = 76.2
 T(sweep opt: renrm) = 1.403e-01 S  per = 19.5  per(accum) = 95.7
 T(sweep opt: save ) = 3.117e-02 S  per = 4.32  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.467e-01 S  T(sum) = 4.398e-01 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 4.745e-03 S  per = 1.08  per(accum) = 1.08
 T(sweep opt: symbolic_formulae           ) = 8.028e-03 S  per = 1.83  per(accum) = 2.9
 T(sweep opt: hintermediate init          ) = 1.169e-03 S  per = 0.266  per(accum) = 3.17
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.035e-01 S  per = 46.3  per(accum) = 49.4
 T(sweep opt: hmmtasks init               ) = 4.069e-02 S  per = 9.25  per(accum) = 58.7
 T(sweep opt: initial guess for dvdson    ) = 2.224e-03 S  per = 0.506  per(accum) = 59.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.649e-01 S  per = 37.5  per(accum) = 96.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.423e-03 S  per = 0.551  per(accum) = 97.2
 T(sweep opt: dvdson [nccl]               ) = 6.239e-03 S  per = 1.42  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 4.100e-05 S  per = 0.00932  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.859e-03 S  per = 1.33  per(accum) = 100
Detailed decomposition of T(renrm) = 1.403e-01 S  T(sum) = 1.403e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.776e-04 S  per = 0.625  per(accum) = 0.625
 T(sweep opt: qops init                    ) = 5.783e-03 S  per = 4.12  per(accum) = 4.75
 T(sweep opt: symbolic_formulae_renorm     ) = 3.046e-03 S  per = 2.17  per(accum) = 6.92
 T(sweep opt: allocate qops on gpu         ) = 9.621e-04 S  per = 0.686  per(accum) = 7.6
 T(sweep opt: site memcpy cpu2gpu          ) = 4.143e-04 S  per = 0.295  per(accum) = 7.9
 T(sweep opt: rintermediate init           ) = 7.884e-04 S  per = 0.562  per(accum) = 8.46
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.223e-02 S  per = 15.8  per(accum) = 24.3
 T(sweep opt: rmmtasks init                ) = 7.021e-03 S  per =    5  per(accum) = 29.3
 T(sweep opt: qops memset on cpu           ) = 8.310e-07 S  per = 0.000592  per(accum) = 29.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.328e-02 S  per = 9.46  per(accum) = 38.8
 T(sweep opt: deallocate cpu and gpu memory) = 5.089e-04 S  per = 0.363  per(accum) = 39.1
 T(sweep opt: construct opS [ifdists=true] ) = 6.944e-02 S  per = 49.5  per(accum) = 88.6
 T(sweep opt: reduction of opS & opH [nccl]) = 3.150e-04 S  per = 0.224  per(accum) = 88.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.824e-04 S  per = 0.415  per(accum) = 89.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.795e-04 S  per = 0.128  per(accum) = 89.4
 T(sweep opt: qops_pool join and erase     ) = 1.212e-02 S  per = 8.63  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 2.785e-03 S  per = 1.98  per(accum) = 100
##### global opt: 7.213e-01 S #####
 T(global opt: fetch) = 4.499e-02 S  per = 6.24  per(accum) = 6.24
 T(global opt: hdiag) = 3.783e-02 S  per = 5.24  per(accum) = 11.5
 T(global opt: dvdsn) = 4.467e-01 S  per = 61.9  per(accum) = 73.4
 T(global opt: decim) = 1.881e-02 S  per = 2.61  per(accum) = 76
 T(global opt: guess) = 1.406e-03 S  per = 0.195  per(accum) = 76.2
 T(global opt: renrm) = 1.403e-01 S  per = 19.5  per(accum) = 95.7
 T(global opt: save ) = 3.117e-02 S  per = 4.32  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.467e-01 S  T(sum) = 4.398e-01 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 4.745e-03 S  per = 1.08  per(accum) = 1.08
 T(global opt: symbolic_formulae           ) = 8.028e-03 S  per = 1.83  per(accum) = 2.9
 T(global opt: hintermediate init          ) = 1.169e-03 S  per = 0.266  per(accum) = 3.17
 T(global opt: preprocess_hformulae_Hxlist ) = 2.035e-01 S  per = 46.3  per(accum) = 49.4
 T(global opt: hmmtasks init               ) = 4.069e-02 S  per = 9.25  per(accum) = 58.7
 T(global opt: initial guess for dvdson    ) = 2.224e-03 S  per = 0.506  per(accum) = 59.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.649e-01 S  per = 37.5  per(accum) = 96.7
 T(global opt: dvdson [cpu-gpu]            ) = 2.423e-03 S  per = 0.551  per(accum) = 97.2
 T(global opt: dvdson [nccl]               ) = 6.239e-03 S  per = 1.42  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 4.100e-05 S  per = 0.00932  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 5.859e-03 S  per = 1.33  per(accum) = 100
Detailed decomposition of T(renrm) = 1.403e-01 S  T(sum) = 1.403e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.776e-04 S  per = 0.625  per(accum) = 0.625
 T(global opt: qops init                    ) = 5.783e-03 S  per = 4.12  per(accum) = 4.75
 T(global opt: symbolic_formulae_renorm     ) = 3.046e-03 S  per = 2.17  per(accum) = 6.92
 T(global opt: allocate qops on gpu         ) = 9.621e-04 S  per = 0.686  per(accum) = 7.6
 T(global opt: site memcpy cpu2gpu          ) = 4.143e-04 S  per = 0.295  per(accum) = 7.9
 T(global opt: rintermediate init           ) = 7.884e-04 S  per = 0.562  per(accum) = 8.46
 T(global opt: preprocess_formulae_Rlist2   ) = 2.223e-02 S  per = 15.8  per(accum) = 24.3
 T(global opt: rmmtasks init                ) = 7.021e-03 S  per =    5  per(accum) = 29.3
 T(global opt: qops memset on cpu           ) = 8.310e-07 S  per = 0.000592  per(accum) = 29.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.328e-02 S  per = 9.46  per(accum) = 38.8
 T(global opt: deallocate cpu and gpu memory) = 5.089e-04 S  per = 0.363  per(accum) = 39.1
 T(global opt: construct opS [ifdists=true] ) = 6.944e-02 S  per = 49.5  per(accum) = 88.6
 T(global opt: reduction of opS & opH [nccl]) = 3.150e-04 S  per = 0.224  per(accum) = 88.8
 T(global opt: qops memcpy gpu2cpu          ) = 5.824e-04 S  per = 0.415  per(accum) = 89.3
 T(global opt: reduction of opS & opH [mpi] ) = 1.795e-04 S  per = 0.128  per(accum) = 89.4
 T(global opt: qops_pool join and erase     ) = 1.212e-02 S  per = 8.63  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 2.785e-03 S  per = 1.98  per(accum) = 100
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=-9.149e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=17/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=2 scratch=./scratch/sweep size=41:3.05e-07GB T(load)=2.99e-04S speed=1.02e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=46:3.51e-04MB:3.43e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=19:1.45e-04MB:1.42e-07GB
total mem of comb=66:5.04e-04MB:4.92e-07GB
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=8.792e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:17 S:2 H:1 P:4 Q:7 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=636:4.852e-03MB:4.739e-06GB
        per(mem): C:58.8 S:6.92 H:3.14 P:4.87 Q:26.3 
 rqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3630:0.0277MB:2.7e-05GB
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=5.364e-07 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=-1.198e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=41:3.128e-04MB
qtensor4: wf4 own=1 _data=0x5585ef0f94a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=41:3.128e-04MB
### DIAG TIMING: total=3.256e-04 t1=2.195e-05, t2=2.008e-05, t3=1.661e-05, t4=2.177e-04, t5=6.411e-06, t6=3.601e-05, t7=6.865e-06
duration_diagGPU:3.327e-04
duration_diagreduce:3.700e-08
duration_diagtransform:1.550e-07
----- TIMING FOR symbolic_formulae_twodot with size=110 : 1.751e-04 S -----
rank=0 GPUmem(GB): used=3.029e-05 (oper)=2.705e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=110
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.127e-05 S -----
rank=0 GPUmem(GB): used=3.181e-05 (oper,hinter)=2.705e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.226e-03 S size(H_formulae)=110 size(Hxlst2)=24 T(Hmu/Hxlist)=5.350e-05,5.172e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.550e-03 S size(H_formulae)=110 size(Hxlst)=3238 -----
rank=0 GPUmem(GB): used=3.181e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=6.109e-07 batch[need]=3.136e-04 blksize=3 blksize0=6 batchsize=3238
rank=0 GPUmem(GB): used=3.460e-04 (oper,hinter,dvdson,batch)=2.705e-05,1.520e-06,6.109e-07,3.136e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=41 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.968e-05,8.217e-05,3.030e-04,5.451e-04,1.007e-03
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.226e-05 speed=2.745e-02GB/S T(nccl)=4.743e-05 speed=1.288e-02GB/S
----- TIMING FOR sigma : t_inter=8.2e-05 t_gemm=3.0e-04 t_reduction=5.4e-04 tot=9.3e-04 -----
 sigma[inter] counter=109 t=8.2e-05 per=8.8e+00 cost=2.9e+04 flops=3.5e+08
 sigma[gemm] counter=109 i=0 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=1.7e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=1.6e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=3 t=1.7e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=4 t=6.4e-05 per=6.9e+00 cost=4.2e+03 flops=6.5e+07
 sigma[gemm] counter=109 i=5 t=5.7e-05 per=6.1e+00 cost=4.1e+03 flops=7.2e+07
 sigma[gemm] counter=109 i=6 t=9.0e-05 per=9.7e+00 cost=9.2e+03 flops=1.0e+08
 sigma[gemm] counter=109 i=7 t=8.4e-05 per=9.1e+00 cost=9.2e+03 flops=1.1e+08
 sigma[gemm] counter=109 total t=3.0e-04 per=3.3e+01 cost=2.7e+04 flops=8.8e+07
 sigma[red] counter=109 t=5.4e-04 per=5.9e+01 cost=1.2e+04 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.8e-02 t_reduction=6.1e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=109 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=109 i=0 t=2.5e-04 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=3 t=2.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=4 t=1.6e-02 per=1.1e+01 cost=7.9e+06 flops=5.0e+08
 sigma_tot[gemm] counter=109 i=5 t=1.8e-02 per=1.2e+01 cost=7.9e+06 flops=4.5e+08
 sigma_tot[gemm] counter=109 i=6 t=1.7e-02 per=1.2e+01 cost=7.6e+06 flops=4.4e+08
 sigma_tot[gemm] counter=109 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.5e+08
 sigma_tot[gemm] counter=109 total t=6.8e-02 per=4.8e+01 cost=3.1e+07 flops=4.5e+08
 sigma_tot[red] counter=109 t=6.1e-02 per=4.3e+01 cost=7.4e+06 flops=1.2e+08
T(sub)=6.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.2e-06,2.6e-06,9.5e-07,8.4e-07,1.9e-07
settings: ndim=41 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.316728679445 -1.116e+03  3.658e-05    1     1  1.244e-03 1.244e-03 1.219e-03
TIMING FOR Davidson : 1.270e-03  T(cal/comm/rest)=1.219e-03,1.374e-06,5.014e-05
decomposed t_rest=5.014e-05
 T(sub)    =6.771e-06 per=1.350e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.970e-07 per=5.924e-01
 T(xnrm2)  =1.110e-07 per=2.214e-01
 T(other)  =4.296e-05 per=8.568e+01
optimized energies: isweep=0 ibond=17 dots=2 e[0]=-116.316728679445 nmvp=1
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=9.055e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond17.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
timing for divide=4.8e-06
timing for compute=3.3e-05
timing for collect=9.9e-06
----- TMING FOR decimation_genbasis(su2): 4.8e-05 S T(divide/compute[cpu/gpu/rest]/collect)=4.8e-06,2.9e-05,0.0e+00,4.1e-06,9.9e-06 -----
decimation summary: 10->9 dwt=+1.110e-16 SvN=9.103e-01
 qbond: qkept nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 8.725e-04 S T(decim/select/formRot)=7.626e-05,7.761e-04,2.020e-05 -----
----- TIMING FOR twodot_decimation: 9.422e-04 S T(wf/decim)=5.680e-05,8.855e-04 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=292:2.228e-03MB:2.176e-06GB
        per(mem): C:12.3 S:55.5 H:6.51 A:2.4 B:23.3 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=4.429e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=8 : 1.622e-05 S -----
rank=0 GPUmem(GB): used=2.925e-05 (oper)=1.705e-05
rank=0 GPUmem(GB): used=2.939e-05 (oper,site)=1.705e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=8
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=2.939e-05 (oper,site,rinter)=1.705e-05,1.416e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 1.131e-04 S size(rtasks)=8 size(Rlst2)=25 T(Rmu/Rlist)=9.046e-06,1.040e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.253e-04 S size(rtasks)=8 size(Rlst)=80 -----
rank=0 GPUmem(GB): used=2.939e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.132e-05 blksize=9 blksize0=0 batchsize=80
rank=0 GPUmem(GB): used=4.072e-05 (oper,site,rinter,batch)=1.705e-05,1.416e-07,0.000e+00,1.132e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.186e-06,2.372e-04,1.091e-04
----- TIMING FOR renorm : t_inter=6.1e-06 t_gemm=2.4e-04 t_reduction=1.1e-04 tot=3.5e-04 -----
 renorm[inter] counter=184 t=6.1e-06 per=1.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=184 i=0 t=2.6e-06 per=7.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=184 i=1 t=1.9e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=184 i=2 t=7.6e-05 per=2.2e+01 cost=1.0e+02 flops=1.3e+06
 renorm[gemm] counter=184 i=3 t=5.7e-05 per=1.6e+01 cost=1.5e+02 flops=2.6e+06
 renorm[gemm] counter=184 i=4 t=1.9e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=184 i=5 t=1.9e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=184 i=6 t=9.6e-05 per=2.7e+01 cost=7.8e+02 flops=8.2e+06
 renorm[gemm] counter=184 total t=2.4e-04 per=6.7e+01 cost=1.0e+03 flops=4.4e+06
 renorm[red] counter=184 t=1.1e-04 per=3.1e+01 cost=7.8e+02 flops=7.2e+06
----- TIMING FOR renorm_tot : t_inter=1.7e-03 t_gemm=7.0e-03 t_reduction=2.7e-03 tot=1.1e-02 -----
 renorm_tot[inter] counter=184 t=1.7e-03 per=1.5e+01 cost=3.7e+05 flops=2.2e+08
 renorm_tot[gemm] counter=184 i=0 t=3.9e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=184 i=1 t=3.4e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=184 i=2 t=1.1e-04 per=9.5e-01 cost=1.0e+02 flops=9.2e+05
 renorm_tot[gemm] counter=184 i=3 t=8.9e-05 per=7.9e-01 cost=1.5e+02 flops=1.7e+06
 renorm_tot[gemm] counter=184 i=4 t=2.2e-03 per=1.9e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=184 i=5 t=2.3e-03 per=2.0e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=184 i=6 t=2.3e-03 per=2.0e+01 cost=4.4e+05 flops=1.9e+08
 renorm_tot[gemm] counter=184 total t=7.0e-03 per=6.1e+01 cost=7.4e+05 flops=1.1e+08
 renorm_tot[red] counter=184 t=2.7e-03 per=2.4e+01 cost=2.0e+05 flops=7.2e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.939e-05 (oper)=1.718e-05
rank=0 GPUmem(GB): used=2.953e-05 (oper,site,rinter)=1.718e-05,1.416e-07,0.000e+00
rank=0 GPUmem(GB): used=3.311e-05 (oper,site,rinter,batch)=1.718e-05,1.416e-07,0.000e+00,3.584e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.002e-03 S T(preprocess/alloc/comp/red/dealloc)=8.257e-04,8.876e-04,3.242e-03,8.131e-04,2.564e-05 -----
----- TIMING FOR oper_renorm_opS : 5.026e-03 S rank=0 -----
qops.to_cpu: size(tot)=292:2.228e-03MB:2.176e-06GB T(to_cpu)=1.924e-05S speed=1.131e-01GB/S
check ||H-H.dagger||=2.288e-15 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.00625 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=2.763e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=9.079e-04 change=-1.749e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=9.232e-04 change=-2.176e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 1.905e-02 S #####
 T(local opt: fetch) = 2.530e-04 S  per = 1.33  per(accum) = 1.33
 T(local opt: hdiag) = 3.841e-04 S  per = 2.02  per(accum) = 3.34
 T(local opt: dvdsn) = 8.377e-03 S  per =   44  per(accum) = 47.3
 T(local opt: decim) = 9.775e-04 S  per = 5.13  per(accum) = 52.5
 T(local opt: guess) = 7.539e-05 S  per = 0.396  per(accum) = 52.8
 T(local opt: renrm) = 7.224e-03 S  per = 37.9  per(accum) = 90.8
 T(local opt: save ) = 1.757e-03 S  per = 9.22  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.377e-03 S  T(sum) = 8.142e-03 S  per = 9.719e+01
 T(local opt: preprocess                  ) = 2.130e-04 S  per = 2.62  per(accum) = 2.62
 T(local opt: symbolic_formulae           ) = 1.797e-04 S  per = 2.21  per(accum) = 4.82
 T(local opt: hintermediate init          ) = 2.828e-05 S  per = 0.347  per(accum) = 5.17
 T(local opt: preprocess_hformulae_Hxlist ) = 5.569e-03 S  per = 68.4  per(accum) = 73.6
 T(local opt: hmmtasks init               ) = 7.777e-04 S  per = 9.55  per(accum) = 83.1
 T(local opt: initial guess for dvdson    ) = 1.040e-04 S  per = 1.28  per(accum) = 84.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.149e-03 S  per = 14.1  per(accum) = 98.5
 T(local opt: dvdson [cpu-gpu]            ) = 2.226e-05 S  per = 0.273  per(accum) = 98.8
 T(local opt: dvdson [nccl]               ) = 4.743e-05 S  per = 0.583  per(accum) = 99.4
 T(local opt: dvdson [mpi]                ) = 1.374e-06 S  per = 0.0169  per(accum) = 99.4
 T(local opt: dvdson [rest part(linalg)]  ) = 5.014e-05 S  per = 0.616  per(accum) = 100
Detailed decomposition of T(renrm) = 7.224e-03 S  T(sum) = 7.224e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.542e-05 S  per = 0.629  per(accum) = 0.629
 T(local opt: qops init                    ) = 2.447e-04 S  per = 3.39  per(accum) = 4.02
 T(local opt: symbolic_formulae_renorm     ) = 2.612e-05 S  per = 0.362  per(accum) = 4.38
 T(local opt: allocate qops on gpu         ) = 4.723e-05 S  per = 0.654  per(accum) = 5.03
 T(local opt: site memcpy cpu2gpu          ) = 2.685e-05 S  per = 0.372  per(accum) = 5.4
 T(local opt: rintermediate init           ) = 2.637e-05 S  per = 0.365  per(accum) = 5.77
 T(local opt: preprocess_formulae_Rlist2   ) = 1.313e-04 S  per = 1.82  per(accum) = 7.59
 T(local opt: rmmtasks init                ) = 7.569e-05 S  per = 1.05  per(accum) = 8.63
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 0.000526  per(accum) = 8.63
 T(local opt: preprocess_renorm_batchGPU   ) = 5.228e-04 S  per = 7.24  per(accum) = 15.9
 T(local opt: deallocate cpu and gpu memory) = 2.076e-05 S  per = 0.287  per(accum) = 16.2
 T(local opt: construct opS [ifdists=true] ) = 5.069e-03 S  per = 70.2  per(accum) = 86.3
 T(local opt: reduction of opS & opH [nccl]) = 1.841e-05 S  per = 0.255  per(accum) = 86.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.852e-05 S  per = 0.395  per(accum) = 87
 T(local opt: reduction of opS & opH [mpi] ) = 1.172e-05 S  per = 0.162  per(accum) = 87.1
 T(local opt: qops_pool join and erase     ) = 9.265e-04 S  per = 12.8  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.352e-06 S  per = 0.0326  per(accum) = 100
ctns::rcanon_save_site idx=1 scratch=./scratch/sweep size=19:1.4e-07GB T(load)=0.00056S speed=0.00025GB/S
##### sweep opt: 7.403e-01 S #####
 T(sweep opt: fetch) = 4.524e-02 S  per = 6.11  per(accum) = 6.11
 T(sweep opt: hdiag) = 3.821e-02 S  per = 5.16  per(accum) = 11.3
 T(sweep opt: dvdsn) = 4.551e-01 S  per = 61.5  per(accum) = 72.7
 T(sweep opt: decim) = 1.978e-02 S  per = 2.67  per(accum) = 75.4
 T(sweep opt: guess) = 1.482e-03 S  per =  0.2  per(accum) = 75.6
 T(sweep opt: renrm) = 1.476e-01 S  per = 19.9  per(accum) = 95.6
 T(sweep opt: save ) = 3.293e-02 S  per = 4.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.551e-01 S  T(sum) = 4.479e-01 S  per = 9.842e+01
 T(sweep opt: preprocess                  ) = 4.958e-03 S  per = 1.11  per(accum) = 1.11
 T(sweep opt: symbolic_formulae           ) = 8.208e-03 S  per = 1.83  per(accum) = 2.94
 T(sweep opt: hintermediate init          ) = 1.198e-03 S  per = 0.267  per(accum) = 3.21
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.090e-01 S  per = 46.7  per(accum) = 49.9
 T(sweep opt: hmmtasks init               ) = 4.147e-02 S  per = 9.26  per(accum) = 59.1
 T(sweep opt: initial guess for dvdson    ) = 2.328e-03 S  per = 0.52  per(accum) = 59.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.661e-01 S  per = 37.1  per(accum) = 96.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.446e-03 S  per = 0.546  per(accum) = 97.3
 T(sweep opt: dvdson [nccl]               ) = 6.286e-03 S  per =  1.4  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 4.238e-05 S  per = 0.00946  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.909e-03 S  per = 1.32  per(accum) = 100
Detailed decomposition of T(renrm) = 1.476e-01 S  T(sum) = 1.476e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.230e-04 S  per = 0.626  per(accum) = 0.626
 T(sweep opt: qops init                    ) = 6.028e-03 S  per = 4.09  per(accum) = 4.71
 T(sweep opt: symbolic_formulae_renorm     ) = 3.072e-03 S  per = 2.08  per(accum) = 6.79
 T(sweep opt: allocate qops on gpu         ) = 1.009e-03 S  per = 0.684  per(accum) = 7.48
 T(sweep opt: site memcpy cpu2gpu          ) = 4.411e-04 S  per = 0.299  per(accum) = 7.78
 T(sweep opt: rintermediate init           ) = 8.147e-04 S  per = 0.552  per(accum) = 8.33
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.236e-02 S  per = 15.2  per(accum) = 23.5
 T(sweep opt: rmmtasks init                ) = 7.096e-03 S  per = 4.81  per(accum) = 28.3
 T(sweep opt: qops memset on cpu           ) = 8.690e-07 S  per = 0.000589  per(accum) = 28.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.380e-02 S  per = 9.36  per(accum) = 37.6
 T(sweep opt: deallocate cpu and gpu memory) = 5.297e-04 S  per = 0.359  per(accum) = 38
 T(sweep opt: construct opS [ifdists=true] ) = 7.451e-02 S  per = 50.5  per(accum) = 88.5
 T(sweep opt: reduction of opS & opH [nccl]) = 3.334e-04 S  per = 0.226  per(accum) = 88.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.109e-04 S  per = 0.414  per(accum) = 89.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.912e-04 S  per = 0.13  per(accum) = 89.3
 T(sweep opt: qops_pool join and erase     ) = 1.304e-02 S  per = 8.84  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 2.788e-03 S  per = 1.89  per(accum) = 100
##### global opt: 7.403e-01 S #####
 T(global opt: fetch) = 4.524e-02 S  per = 6.11  per(accum) = 6.11
 T(global opt: hdiag) = 3.821e-02 S  per = 5.16  per(accum) = 11.3
 T(global opt: dvdsn) = 4.551e-01 S  per = 61.5  per(accum) = 72.7
 T(global opt: decim) = 1.978e-02 S  per = 2.67  per(accum) = 75.4
 T(global opt: guess) = 1.482e-03 S  per =  0.2  per(accum) = 75.6
 T(global opt: renrm) = 1.476e-01 S  per = 19.9  per(accum) = 95.6
 T(global opt: save ) = 3.293e-02 S  per = 4.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.551e-01 S  T(sum) = 4.479e-01 S  per = 9.842e+01
 T(global opt: preprocess                  ) = 4.958e-03 S  per = 1.11  per(accum) = 1.11
 T(global opt: symbolic_formulae           ) = 8.208e-03 S  per = 1.83  per(accum) = 2.94
 T(global opt: hintermediate init          ) = 1.198e-03 S  per = 0.267  per(accum) = 3.21
 T(global opt: preprocess_hformulae_Hxlist ) = 2.090e-01 S  per = 46.7  per(accum) = 49.9
 T(global opt: hmmtasks init               ) = 4.147e-02 S  per = 9.26  per(accum) = 59.1
 T(global opt: initial guess for dvdson    ) = 2.328e-03 S  per = 0.52  per(accum) = 59.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.661e-01 S  per = 37.1  per(accum) = 96.7
 T(global opt: dvdson [cpu-gpu]            ) = 2.446e-03 S  per = 0.546  per(accum) = 97.3
 T(global opt: dvdson [nccl]               ) = 6.286e-03 S  per =  1.4  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 4.238e-05 S  per = 0.00946  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 5.909e-03 S  per = 1.32  per(accum) = 100
Detailed decomposition of T(renrm) = 1.476e-01 S  T(sum) = 1.476e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.230e-04 S  per = 0.626  per(accum) = 0.626
 T(global opt: qops init                    ) = 6.028e-03 S  per = 4.09  per(accum) = 4.71
 T(global opt: symbolic_formulae_renorm     ) = 3.072e-03 S  per = 2.08  per(accum) = 6.79
 T(global opt: allocate qops on gpu         ) = 1.009e-03 S  per = 0.684  per(accum) = 7.48
 T(global opt: site memcpy cpu2gpu          ) = 4.411e-04 S  per = 0.299  per(accum) = 7.78
 T(global opt: rintermediate init           ) = 8.147e-04 S  per = 0.552  per(accum) = 8.33
 T(global opt: preprocess_formulae_Rlist2   ) = 2.236e-02 S  per = 15.2  per(accum) = 23.5
 T(global opt: rmmtasks init                ) = 7.096e-03 S  per = 4.81  per(accum) = 28.3
 T(global opt: qops memset on cpu           ) = 8.690e-07 S  per = 0.000589  per(accum) = 28.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.380e-02 S  per = 9.36  per(accum) = 37.6
 T(global opt: deallocate cpu and gpu memory) = 5.297e-04 S  per = 0.359  per(accum) = 38
 T(global opt: construct opS [ifdists=true] ) = 7.451e-02 S  per = 50.5  per(accum) = 88.5
 T(global opt: reduction of opS & opH [nccl]) = 3.334e-04 S  per = 0.226  per(accum) = 88.7
 T(global opt: qops memcpy gpu2cpu          ) = 6.109e-04 S  per = 0.414  per(accum) = 89.1
 T(global opt: reduction of opS & opH [mpi] ) = 1.912e-04 S  per = 0.13  per(accum) = 89.3
 T(global opt: qops_pool join and erase     ) = 1.304e-02 S  per = 8.84  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 2.788e-03 S  per = 1.89  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-9.096e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=18/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=3 scratch=./scratch/sweep size=47:3.50e-07GB T(load)=3.20e-04S speed=1.10e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=88:6.71e-04MB:6.56e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=41:3.13e-04MB:3.05e-07GB
total mem of comb=130:9.92e-04MB:9.69e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.080e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=731:5.577e-03MB:5.446e-06GB
        per(mem): C:48.2 S:6.02 H:2.74 P:8.89 Q:34.2 
 rqops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=9,9 size(op)=19:0.000145MB size(tot)=292:0.00223MB:2.18e-06GB
        per(mem): C:12.3 S:55.5 H:6.51 A:2.4 B:23.3 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3019:0.023MB:2.25e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.023e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-5.305e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,9,3,3) nnz=79:6.027e-04MB
qtensor4: wf4 own=1 _data=0x5585ee552280
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
 qbond: qcol nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=31 nblocks=432 size=79:6.027e-04MB
### DIAG TIMING: total=9.958e-04 t1=2.074e-05, t2=2.501e-05, t3=2.081e-05, t4=8.709e-04, t5=8.836e-06, t6=4.035e-05, t7=9.136e-06
duration_diagGPU:1.013e-03
duration_diagreduce:4.700e-08
duration_diagtransform:2.720e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 2.227e-04 S -----
rank=0 GPUmem(GB): used=2.249e-05 (oper)=2.249e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=560:4.272e-03MB:4.172e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.946e-05 S -----
rank=0 GPUmem(GB): used=2.667e-05 (oper,hinter)=2.249e-05,4.172e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.043e-02 S size(H_formulae)=107 size(Hxlst2)=31 T(Hmu/Hxlist)=5.856e-05,1.037e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.089e-02 S size(H_formulae)=107 size(Hxlst)=4526 -----
rank=0 GPUmem(GB): used=2.667e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.177e-06 batch[need]=9.442e-04 blksize=9 blksize0=9 batchsize=4526
rank=0 GPUmem(GB): used=9.720e-04 (oper,hinter,dvdson,batch)=2.249e-05,4.172e-06,1.177e-06,9.442e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=79 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.480e-05,1.558e-04,7.604e-04,7.872e-04,1.810e-03
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=2.849e-05 speed=4.132e-02GB/S T(nccl)=5.631e-05 speed=2.091e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=7.6e-04 t_reduction=7.9e-04 tot=1.7e-03 -----
 sigma[inter] counter=110 t=1.6e-04 per=9.1e+00 cost=1.3e+05 flops=8.3e+08
 sigma[gemm] counter=110 i=0 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=4 t=1.9e-04 per=1.1e+01 cost=1.5e+04 flops=7.8e+07
 sigma[gemm] counter=110 i=5 t=2.0e-04 per=1.2e+01 cost=1.5e+04 flops=7.3e+07
 sigma[gemm] counter=110 i=6 t=1.9e-04 per=1.1e+01 cost=1.6e+04 flops=8.9e+07
 sigma[gemm] counter=110 i=7 t=1.7e-04 per=1.0e+01 cost=1.6e+04 flops=9.4e+07
 sigma[gemm] counter=110 total t=7.6e-04 per=4.5e+01 cost=6.2e+04 flops=8.2e+07
 sigma[red] counter=110 t=7.9e-04 per=4.6e+01 cost=2.4e+04 flops=3.1e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.9e-02 t_reduction=6.2e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=110 t=1.3e-02 per=9.2e+00 cost=3.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=110 i=0 t=2.5e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=3 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=4 t=1.6e-02 per=1.1e+01 cost=7.9e+06 flops=5.0e+08
 sigma_tot[gemm] counter=110 i=5 t=1.8e-02 per=1.2e+01 cost=7.9e+06 flops=4.5e+08
 sigma_tot[gemm] counter=110 i=6 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.4e+08
 sigma_tot[gemm] counter=110 i=7 t=1.7e-02 per=1.2e+01 cost=7.7e+06 flops=4.5e+08
 sigma_tot[gemm] counter=110 total t=6.9e-02 per=4.8e+01 cost=3.1e+07 flops=4.5e+08
 sigma_tot[red] counter=110 t=6.2e-02 per=4.3e+01 cost=7.4e+06 flops=1.2e+08
T(sub)=8.6e-06 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,3.0e-06,1.2e-06,1.1e-06,3.2e-07
settings: ndim=79 neig=1 maxcycle=30 nbuff=4 memory=9e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316728679445 -1.116e+03  4.972e-03    1     1  2.190e-03 2.190e-03 2.152e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.721e-05,1.337e-04,9.051e-04,7.918e-04,1.903e-03
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=2.202e-05 speed=5.345e-02GB/S T(nccl)=4.519e-05 speed=2.605e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=9.0e-04 t_reduction=7.9e-04 tot=1.8e-03 -----
 sigma[inter] counter=111 t=1.3e-04 per=7.3e+00 cost=1.3e+05 flops=9.7e+08
 sigma[gemm] counter=111 i=0 t=2.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=4 t=2.3e-04 per=1.2e+01 cost=1.5e+04 flops=6.5e+07
 sigma[gemm] counter=111 i=5 t=2.5e-04 per=1.4e+01 cost=1.5e+04 flops=5.8e+07
 sigma[gemm] counter=111 i=6 t=2.2e-04 per=1.2e+01 cost=1.6e+04 flops=7.4e+07
 sigma[gemm] counter=111 i=7 t=1.9e-04 per=1.0e+01 cost=1.6e+04 flops=8.6e+07
 sigma[gemm] counter=111 total t=9.0e-04 per=4.9e+01 cost=6.2e+04 flops=6.9e+07
 sigma[red] counter=111 t=7.9e-04 per=4.3e+01 cost=2.4e+04 flops=3.1e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=7.0e-02 t_reduction=6.3e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=111 t=1.3e-02 per=9.1e+00 cost=3.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=111 i=0 t=2.6e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=3 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=4 t=1.6e-02 per=1.1e+01 cost=7.9e+06 flops=4.9e+08
 sigma_tot[gemm] counter=111 i=5 t=1.8e-02 per=1.2e+01 cost=7.9e+06 flops=4.4e+08
 sigma_tot[gemm] counter=111 i=6 t=1.8e-02 per=1.2e+01 cost=7.7e+06 flops=4.4e+08
 sigma_tot[gemm] counter=111 i=7 t=1.8e-02 per=1.2e+01 cost=7.7e+06 flops=4.4e+08
 sigma_tot[gemm] counter=111 total t=7.0e-02 per=4.8e+01 cost=3.1e+07 flops=4.5e+08
 sigma_tot[red] counter=111 t=6.3e-02 per=4.3e+01 cost=7.4e+06 flops=1.2e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,9.5e-06,3.0e-06,1.1e-06,2.4e-07
    2   0 -    -116.316764282601 -3.560e-05  8.028e-04    2     2  4.377e-03 2.188e-03 2.125e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.387e-05,1.124e-04,7.984e-04,7.863e-04,1.765e-03
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=2.138e-05 speed=5.505e-02GB/S T(nccl)=4.249e-05 speed=2.771e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.0e-04 t_reduction=7.9e-04 tot=1.7e-03 -----
 sigma[inter] counter=112 t=1.1e-04 per=6.6e+00 cost=1.3e+05 flops=1.1e+09
 sigma[gemm] counter=112 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=3 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=4 t=2.0e-04 per=1.2e+01 cost=1.5e+04 flops=7.4e+07
 sigma[gemm] counter=112 i=5 t=2.1e-04 per=1.2e+01 cost=1.5e+04 flops=7.0e+07
 sigma[gemm] counter=112 i=6 t=1.9e-04 per=1.1e+01 cost=1.6e+04 flops=8.7e+07
 sigma[gemm] counter=112 i=7 t=1.9e-04 per=1.1e+01 cost=1.6e+04 flops=8.7e+07
 sigma[gemm] counter=112 total t=8.0e-04 per=4.7e+01 cost=6.2e+04 flops=7.8e+07
 sigma[red] counter=112 t=7.9e-04 per=4.6e+01 cost=2.4e+04 flops=3.1e+07
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=7.1e-02 t_reduction=6.4e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=112 t=1.3e-02 per=9.1e+00 cost=3.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=112 i=0 t=2.6e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=3 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=4 t=1.6e-02 per=1.1e+01 cost=7.9e+06 flops=4.9e+08
 sigma_tot[gemm] counter=112 i=5 t=1.8e-02 per=1.2e+01 cost=8.0e+06 flops=4.4e+08
 sigma_tot[gemm] counter=112 i=6 t=1.8e-02 per=1.2e+01 cost=7.7e+06 flops=4.3e+08
 sigma_tot[gemm] counter=112 i=7 t=1.8e-02 per=1.2e+01 cost=7.8e+06 flops=4.4e+08
 sigma_tot[gemm] counter=112 total t=7.1e-02 per=4.8e+01 cost=3.1e+07 flops=4.4e+08
 sigma_tot[red] counter=112 t=6.4e-02 per=4.3e+01 cost=7.5e+06 flops=1.2e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.3e-05,2.2e-06,1.2e-06,1.8e-07
    3   0 -    -116.316765757078 -1.474e-06  3.027e-04    3     3  6.381e-03 2.127e-03 2.069e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.328e-05,1.114e-04,7.948e-04,7.846e-04,1.758e-03
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=2.098e-05 speed=5.612e-02GB/S T(nccl)=4.230e-05 speed=2.783e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=7.9e-04 t_reduction=7.8e-04 tot=1.7e-03 -----
 sigma[inter] counter=113 t=1.1e-04 per=6.6e+00 cost=1.3e+05 flops=1.2e+09
 sigma[gemm] counter=113 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=3 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=4 t=2.0e-04 per=1.2e+01 cost=1.5e+04 flops=7.4e+07
 sigma[gemm] counter=113 i=5 t=2.1e-04 per=1.3e+01 cost=1.5e+04 flops=6.9e+07
 sigma[gemm] counter=113 i=6 t=1.9e-04 per=1.1e+01 cost=1.6e+04 flops=8.8e+07
 sigma[gemm] counter=113 i=7 t=1.9e-04 per=1.1e+01 cost=1.6e+04 flops=8.8e+07
 sigma[gemm] counter=113 total t=7.9e-04 per=4.7e+01 cost=6.2e+04 flops=7.9e+07
 sigma[red] counter=113 t=7.8e-04 per=4.6e+01 cost=2.4e+04 flops=3.1e+07
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.2e-02 t_reduction=6.4e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=113 t=1.4e-02 per=9.1e+00 cost=3.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=113 i=0 t=2.6e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=3 t=2.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=4 t=1.6e-02 per=1.1e+01 cost=7.9e+06 flops=4.8e+08
 sigma_tot[gemm] counter=113 i=5 t=1.8e-02 per=1.2e+01 cost=8.0e+06 flops=4.3e+08
 sigma_tot[gemm] counter=113 i=6 t=1.8e-02 per=1.2e+01 cost=7.7e+06 flops=4.3e+08
 sigma_tot[gemm] counter=113 i=7 t=1.8e-02 per=1.2e+01 cost=7.8e+06 flops=4.3e+08
 sigma_tot[gemm] counter=113 total t=7.2e-02 per=4.8e+01 cost=3.1e+07 flops=4.4e+08
 sigma_tot[red] counter=113 t=6.4e-02 per=4.3e+01 cost=7.5e+06 flops=1.2e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.2e-05,2.0e-06,1.2e-06,1.5e-07
    4   0 -    -116.316765951898 -1.948e-07  1.027e-04    3     4  8.388e-03 2.097e-03 2.041e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.364e-05,1.101e-04,7.920e-04,7.831e-04,1.752e-03
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=2.127e-05 speed=5.535e-02GB/S T(nccl)=4.238e-05 speed=2.778e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=7.9e-04 t_reduction=7.8e-04 tot=1.7e-03 -----
 sigma[inter] counter=114 t=1.1e-04 per=6.5e+00 cost=1.3e+05 flops=1.2e+09
 sigma[gemm] counter=114 i=0 t=2.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=4 t=2.0e-04 per=1.2e+01 cost=1.5e+04 flops=7.5e+07
 sigma[gemm] counter=114 i=5 t=2.1e-04 per=1.3e+01 cost=1.5e+04 flops=6.9e+07
 sigma[gemm] counter=114 i=6 t=1.9e-04 per=1.1e+01 cost=1.6e+04 flops=8.8e+07
 sigma[gemm] counter=114 i=7 t=1.9e-04 per=1.1e+01 cost=1.6e+04 flops=8.8e+07
 sigma[gemm] counter=114 total t=7.9e-04 per=4.7e+01 cost=6.2e+04 flops=7.9e+07
 sigma[red] counter=114 t=7.8e-04 per=4.6e+01 cost=2.4e+04 flops=3.1e+07
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.3e-02 t_reduction=6.5e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=114 t=1.4e-02 per=9.0e+00 cost=3.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=114 i=0 t=2.6e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=3 t=2.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=4 t=1.7e-02 per=1.1e+01 cost=7.9e+06 flops=4.8e+08
 sigma_tot[gemm] counter=114 i=5 t=1.9e-02 per=1.2e+01 cost=8.0e+06 flops=4.3e+08
 sigma_tot[gemm] counter=114 i=6 t=1.8e-02 per=1.2e+01 cost=7.7e+06 flops=4.2e+08
 sigma_tot[gemm] counter=114 i=7 t=1.8e-02 per=1.2e+01 cost=7.8e+06 flops=4.3e+08
 sigma_tot[gemm] counter=114 total t=7.3e-02 per=4.8e+01 cost=3.1e+07 flops=4.3e+08
 sigma_tot[red] counter=114 t=6.5e-02 per=4.3e+01 cost=7.5e+06 flops=1.2e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.1e-05,2.0e-06,1.1e-06,1.6e-07
    5   0 +    -116.316765976237 -2.434e-08  3.292e-05    3     5  1.038e-02 2.076e-03 2.022e-03
TIMING FOR Davidson : 1.039e-02  T(cal/comm/rest)=1.011e-02,4.556e-06,2.799e-04
decomposed t_rest=2.799e-04
 T(sub)    =8.583e-05 per=3.066e+01
 T(precond)=1.730e-05 per=6.181e+00
 T(ortho)  =6.866e-06 per=2.453e+00
 T(xcopy)  =7.880e-07 per=2.815e-01
 T(xnrm2)  =8.000e-07 per=2.858e-01
 T(other)  =1.683e-04 per=6.014e+01
optimized energies: isweep=0 ibond=18 dots=2 e[0]=-116.316765976237 nmvp=5
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=6.790e-04 change=1.322e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond18.txt
 qbond: qsuper nsym=9 dimAll=32
 (2,0):5 (1,1):2 (3,1):8 (4,0):6 (2,2):3 (5,1):3 (6,0):1 (4,2):3 (3,3):1
timing for divide=6.8e-06
timing for compute=4.8e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(su2): 6.5e-05 S T(divide/compute[cpu/gpu/rest]/collect)=6.8e-06,3.9e-05,0.0e+00,8.8e-06,1.0e-05 -----
decimation summary: 32->10 dwt=+2.861e-05 SvN=9.576e-01
 qbond: qkept nsym=6 dimAll=10
 (4,2):3 (3,1):2 (2,2):2 (4,0):1 (5,1):1 (3,3):1
----- TIMING for decimation_row(nkr): 9.302e-04 S T(decim/select/formRot)=1.046e-04,8.013e-04,2.427e-05 -----
----- TIMING FOR twodot_decimation: 1.041e-03 S T(wf/decim)=9.185e-05,9.493e-04 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:3 S:8 H:1 A:4 B:7 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=453:3.456e-03MB:3.375e-06GB
        per(mem): C:13.9 S:37.1 H:4.42 A:7.73 B:36.9 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=6.790e-04 change=6.689e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=15 : 2.834e-05 S -----
rank=0 GPUmem(GB): used=2.459e-05 (oper)=1.299e-05
rank=0 GPUmem(GB): used=2.490e-05 (oper,site)=1.299e-05,3.055e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=15
 no. of rintermediate operators=4
 no. of coefficients=8:6.104e-05MB:5.960e-08GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.980e-05 S -----
rank=0 GPUmem(GB): used=2.496e-05 (oper,site,rinter)=1.299e-05,3.055e-07,5.960e-08
----- TIMING FOR preprocess_formulae_Rlist2 : 4.140e-04 S size(rtasks)=15 size(Rlst2)=36 T(Rmu/Rlist)=1.378e-05,4.002e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.297e-04 S size(rtasks)=15 size(Rlst)=321 -----
rank=0 GPUmem(GB): used=2.496e-05 avail=3.829e+01 total=3.829e+01 batch[need]=6.697e-05 blksize=9 blksize0=9 batchsize=321
rank=0 GPUmem(GB): used=9.193e-05 (oper,site,rinter,batch)=1.299e-05,3.055e-07,5.960e-08,6.697e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.892e-05,5.567e-04,2.020e-04
----- TIMING FOR renorm : t_inter=9.9e-05 t_gemm=5.6e-04 t_reduction=2.0e-04 tot=8.6e-04 -----
 renorm[inter] counter=201 t=9.9e-05 per=1.2e+01 cost=9.9e+02 flops=1.0e+07
 renorm[gemm] counter=201 i=0 t=2.0e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=201 i=1 t=1.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=201 i=2 t=1.8e-04 per=2.1e+01 cost=1.1e+03 flops=6.0e+06
 renorm[gemm] counter=201 i=3 t=2.0e-04 per=2.3e+01 cost=2.1e+03 flops=1.1e+07
 renorm[gemm] counter=201 i=4 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=201 i=5 t=1.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=201 i=6 t=1.7e-04 per=2.0e+01 cost=3.9e+03 flops=2.2e+07
 renorm[gemm] counter=201 total t=5.6e-04 per=6.5e+01 cost=7.1e+03 flops=1.3e+07
 renorm[red] counter=201 t=2.0e-04 per=2.4e+01 cost=2.2e+03 flops=1.1e+07
----- TIMING FOR renorm_tot : t_inter=1.8e-03 t_gemm=7.5e-03 t_reduction=2.9e-03 tot=1.2e-02 -----
 renorm_tot[inter] counter=201 t=1.8e-03 per=1.4e+01 cost=3.7e+05 flops=2.1e+08
 renorm_tot[gemm] counter=201 i=0 t=4.1e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=201 i=1 t=3.6e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=201 i=2 t=2.9e-04 per=2.3e+00 cost=1.2e+03 flops=4.1e+06
 renorm_tot[gemm] counter=201 i=3 t=2.8e-04 per=2.3e+00 cost=2.3e+03 flops=8.0e+06
 renorm_tot[gemm] counter=201 i=4 t=2.2e-03 per=1.8e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=201 i=5 t=2.3e-03 per=1.9e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=201 i=6 t=2.5e-03 per=2.0e+01 cost=4.5e+05 flops=1.8e+08
 renorm_tot[gemm] counter=201 total t=7.5e-03 per=6.2e+01 cost=7.5e+05 flops=1.0e+08
 renorm_tot[red] counter=201 t=2.9e-03 per=2.4e+01 cost=2.0e+05 flops=6.7e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.618e-05 (oper)=1.314e-05
rank=0 GPUmem(GB): used=2.649e-05 (oper,site,rinter)=1.314e-05,3.055e-07,1.371e-06
rank=0 GPUmem(GB): used=4.860e-05 (oper,site,rinter,batch)=1.314e-05,3.055e-07,1.371e-06,2.211e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.070e-02 S T(preprocess/alloc/comp/red/dealloc)=2.484e-03,2.520e-03,7.701e-03,3.219e-04,1.202e-04 -----
----- TIMING FOR oper_renorm_opS : 1.075e-02 S rank=0 -----
qops.to_cpu: size(tot)=453:3.456e-03MB:3.375e-06GB T(to_cpu)=2.260e-05S speed=1.494e-01GB/S
check ||H-H.dagger||=5.339e-16 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.0128 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=6.256e-04 change=9.407e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=6.256e-04 change=-1.025e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=6.256e-04 change=-3.770e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
##### local opt: 4.499e-02 S #####
 T(local opt: fetch) = 2.712e-03 S  per = 6.03  per(accum) = 6.03
 T(local opt: hdiag) = 1.153e-03 S  per = 2.56  per(accum) = 8.59
 T(local opt: dvdsn) = 2.465e-02 S  per = 54.8  per(accum) = 63.4
 T(local opt: decim) = 1.074e-03 S  per = 2.39  per(accum) = 65.8
 T(local opt: guess) = 1.110e-04 S  per = 0.247  per(accum) = 66
 T(local opt: renrm) = 1.347e-02 S  per = 29.9  per(accum) = 96
 T(local opt: save ) = 1.820e-03 S  per = 4.05  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.465e-02 S  T(sum) = 2.427e-02 S  per = 9.846e+01
 T(local opt: preprocess                  ) = 5.610e-04 S  per = 2.31  per(accum) = 2.31
 T(local opt: symbolic_formulae           ) = 2.361e-04 S  per = 0.973  per(accum) = 3.28
 T(local opt: hintermediate init          ) = 7.502e-05 S  per = 0.309  per(accum) = 3.59
 T(local opt: preprocess_hformulae_Hxlist ) = 1.092e-02 S  per =   45  per(accum) = 48.6
 T(local opt: hmmtasks init               ) = 1.870e-03 S  per =  7.7  per(accum) = 56.3
 T(local opt: initial guess for dvdson    ) = 2.165e-04 S  per = 0.892  per(accum) = 57.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 9.767e-03 S  per = 40.2  per(accum) = 97.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.141e-04 S  per = 0.47  per(accum) = 97.9
 T(local opt: dvdson [nccl]               ) = 2.287e-04 S  per = 0.942  per(accum) = 98.8
 T(local opt: dvdson [mpi]                ) = 4.556e-06 S  per = 0.0188  per(accum) = 98.8
 T(local opt: dvdson [rest part(linalg)]  ) = 2.799e-04 S  per = 1.15  per(accum) = 100
Detailed decomposition of T(renrm) = 1.347e-02 S  T(sum) = 1.347e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.775e-05 S  per = 0.429  per(accum) = 0.429
 T(local opt: qops init                    ) = 2.689e-04 S  per =    2  per(accum) = 2.43
 T(local opt: symbolic_formulae_renorm     ) = 3.363e-05 S  per = 0.25  per(accum) = 2.67
 T(local opt: allocate qops on gpu         ) = 4.561e-05 S  per = 0.339  per(accum) = 3.01
 T(local opt: site memcpy cpu2gpu          ) = 2.411e-05 S  per = 0.179  per(accum) = 3.19
 T(local opt: rintermediate init           ) = 2.609e-05 S  per = 0.194  per(accum) = 3.39
 T(local opt: preprocess_formulae_Rlist2   ) = 4.336e-04 S  per = 3.22  per(accum) = 6.61
 T(local opt: rmmtasks init                ) = 1.604e-04 S  per = 1.19  per(accum) = 7.8
 T(local opt: qops memset on cpu           ) = 5.400e-08 S  per = 0.000401  per(accum) = 7.8
 T(local opt: preprocess_renorm_batchGPU   ) = 9.430e-04 S  per =    7  per(accum) = 14.8
 T(local opt: deallocate cpu and gpu memory) = 2.309e-05 S  per = 0.171  per(accum) = 15
 T(local opt: construct opS [ifdists=true] ) = 1.078e-02 S  per =   80  per(accum) = 95
 T(local opt: reduction of opS & opH [nccl]) = 2.036e-05 S  per = 0.151  per(accum) = 95.1
 T(local opt: qops memcpy gpu2cpu          ) = 3.184e-05 S  per = 0.236  per(accum) = 95.4
 T(local opt: reduction of opS & opH [mpi] ) = 4.246e-05 S  per = 0.315  per(accum) = 95.7
 T(local opt: qops_pool join and erase     ) = 5.781e-04 S  per = 4.29  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.092e-06 S  per = 0.023  per(accum) = 100
ctns::rcanon_save_site idx=2 scratch=./scratch/sweep size=41:3.1e-07GB T(load)=0.00058S speed=0.00053GB/S
##### sweep opt: 7.853e-01 S #####
 T(sweep opt: fetch) = 4.796e-02 S  per = 6.11  per(accum) = 6.11
 T(sweep opt: hdiag) = 3.937e-02 S  per = 5.01  per(accum) = 11.1
 T(sweep opt: dvdsn) = 4.798e-01 S  per = 61.1  per(accum) = 72.2
 T(sweep opt: decim) = 2.086e-02 S  per = 2.66  per(accum) = 74.9
 T(sweep opt: guess) = 1.593e-03 S  per = 0.203  per(accum) = 75.1
 T(sweep opt: renrm) = 1.610e-01 S  per = 20.5  per(accum) = 95.6
 T(sweep opt: save ) = 3.475e-02 S  per = 4.42  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.798e-01 S  T(sum) = 4.722e-01 S  per = 9.843e+01
 T(sweep opt: preprocess                  ) = 5.519e-03 S  per = 1.17  per(accum) = 1.17
 T(sweep opt: symbolic_formulae           ) = 8.444e-03 S  per = 1.79  per(accum) = 2.96
 T(sweep opt: hintermediate init          ) = 1.273e-03 S  per = 0.27  per(accum) = 3.23
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.199e-01 S  per = 46.6  per(accum) = 49.8
 T(sweep opt: hmmtasks init               ) = 4.334e-02 S  per = 9.18  per(accum) = 59
 T(sweep opt: initial guess for dvdson    ) = 2.545e-03 S  per = 0.539  per(accum) = 59.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.758e-01 S  per = 37.2  per(accum) = 96.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.560e-03 S  per = 0.542  per(accum) = 97.3
 T(sweep opt: dvdson [nccl]               ) = 6.515e-03 S  per = 1.38  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 4.693e-05 S  per = 0.00994  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.189e-03 S  per = 1.31  per(accum) = 100
Detailed decomposition of T(renrm) = 1.610e-01 S  T(sum) = 1.610e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.808e-04 S  per = 0.609  per(accum) = 0.609
 T(sweep opt: qops init                    ) = 6.297e-03 S  per = 3.91  per(accum) = 4.52
 T(sweep opt: symbolic_formulae_renorm     ) = 3.105e-03 S  per = 1.93  per(accum) = 6.45
 T(sweep opt: allocate qops on gpu         ) = 1.055e-03 S  per = 0.655  per(accum) = 7.1
 T(sweep opt: site memcpy cpu2gpu          ) = 4.652e-04 S  per = 0.289  per(accum) = 7.39
 T(sweep opt: rintermediate init           ) = 8.408e-04 S  per = 0.522  per(accum) = 7.91
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.280e-02 S  per = 14.2  per(accum) = 22.1
 T(sweep opt: rmmtasks init                ) = 7.257e-03 S  per = 4.51  per(accum) = 26.6
 T(sweep opt: qops memset on cpu           ) = 9.230e-07 S  per = 0.000573  per(accum) = 26.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.475e-02 S  per = 9.16  per(accum) = 35.7
 T(sweep opt: deallocate cpu and gpu memory) = 5.528e-04 S  per = 0.343  per(accum) = 36.1
 T(sweep opt: construct opS [ifdists=true] ) = 8.529e-02 S  per =   53  per(accum) = 89
 T(sweep opt: reduction of opS & opH [nccl]) = 3.537e-04 S  per = 0.22  per(accum) = 89.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.427e-04 S  per = 0.399  per(accum) = 89.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.336e-04 S  per = 0.145  per(accum) = 89.8
 T(sweep opt: qops_pool join and erase     ) = 1.362e-02 S  per = 8.46  per(accum) = 98.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.791e-03 S  per = 1.73  per(accum) = 100
##### global opt: 7.853e-01 S #####
 T(global opt: fetch) = 4.796e-02 S  per = 6.11  per(accum) = 6.11
 T(global opt: hdiag) = 3.937e-02 S  per = 5.01  per(accum) = 11.1
 T(global opt: dvdsn) = 4.798e-01 S  per = 61.1  per(accum) = 72.2
 T(global opt: decim) = 2.086e-02 S  per = 2.66  per(accum) = 74.9
 T(global opt: guess) = 1.593e-03 S  per = 0.203  per(accum) = 75.1
 T(global opt: renrm) = 1.610e-01 S  per = 20.5  per(accum) = 95.6
 T(global opt: save ) = 3.475e-02 S  per = 4.42  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.798e-01 S  T(sum) = 4.722e-01 S  per = 9.843e+01
 T(global opt: preprocess                  ) = 5.519e-03 S  per = 1.17  per(accum) = 1.17
 T(global opt: symbolic_formulae           ) = 8.444e-03 S  per = 1.79  per(accum) = 2.96
 T(global opt: hintermediate init          ) = 1.273e-03 S  per = 0.27  per(accum) = 3.23
 T(global opt: preprocess_hformulae_Hxlist ) = 2.199e-01 S  per = 46.6  per(accum) = 49.8
 T(global opt: hmmtasks init               ) = 4.334e-02 S  per = 9.18  per(accum) = 59
 T(global opt: initial guess for dvdson    ) = 2.545e-03 S  per = 0.539  per(accum) = 59.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.758e-01 S  per = 37.2  per(accum) = 96.8
 T(global opt: dvdson [cpu-gpu]            ) = 2.560e-03 S  per = 0.542  per(accum) = 97.3
 T(global opt: dvdson [nccl]               ) = 6.515e-03 S  per = 1.38  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 4.693e-05 S  per = 0.00994  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 6.189e-03 S  per = 1.31  per(accum) = 100
Detailed decomposition of T(renrm) = 1.610e-01 S  T(sum) = 1.610e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.808e-04 S  per = 0.609  per(accum) = 0.609
 T(global opt: qops init                    ) = 6.297e-03 S  per = 3.91  per(accum) = 4.52
 T(global opt: symbolic_formulae_renorm     ) = 3.105e-03 S  per = 1.93  per(accum) = 6.45
 T(global opt: allocate qops on gpu         ) = 1.055e-03 S  per = 0.655  per(accum) = 7.1
 T(global opt: site memcpy cpu2gpu          ) = 4.652e-04 S  per = 0.289  per(accum) = 7.39
 T(global opt: rintermediate init           ) = 8.408e-04 S  per = 0.522  per(accum) = 7.91
 T(global opt: preprocess_formulae_Rlist2   ) = 2.280e-02 S  per = 14.2  per(accum) = 22.1
 T(global opt: rmmtasks init                ) = 7.257e-03 S  per = 4.51  per(accum) = 26.6
 T(global opt: qops memset on cpu           ) = 9.230e-07 S  per = 0.000573  per(accum) = 26.6
 T(global opt: preprocess_renorm_batchGPU   ) = 1.475e-02 S  per = 9.16  per(accum) = 35.7
 T(global opt: deallocate cpu and gpu memory) = 5.528e-04 S  per = 0.343  per(accum) = 36.1
 T(global opt: construct opS [ifdists=true] ) = 8.529e-02 S  per =   53  per(accum) = 89
 T(global opt: reduction of opS & opH [nccl]) = 3.537e-04 S  per = 0.22  per(accum) = 89.3
 T(global opt: qops memcpy gpu2cpu          ) = 6.427e-04 S  per = 0.399  per(accum) = 89.7
 T(global opt: reduction of opS & opH [mpi] ) = 2.336e-04 S  per = 0.145  per(accum) = 89.8
 T(global opt: qops_pool join and erase     ) = 1.362e-02 S  per = 8.46  per(accum) = 98.3
 T(global opt: conversion from opAB to opPQ ) = 2.791e-03 S  per = 1.73  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.330e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=19/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=4 scratch=./scratch/sweep size=51:3.80e-07GB T(load)=2.99e-04S speed=1.27e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=98:7.48e-04MB:7.30e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=47:3.59e-04MB:3.50e-07GB
total mem of comb=146:1.11e-03MB:1.09e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.083e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:15 S:3 H:1 P:12 Q:16 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=923:7.042e-03MB:6.877e-06GB
        per(mem): C:35.8 S:7.15 H:2.17 P:8.13 Q:46.8 
 rqops: oplist=CSHAB nops=C:3 S:8 H:1 A:4 B:7 
        dim(bra,ket)=10,10 size(op)=29:0.000221MB size(tot)=453:0.00346MB:3.38e-06GB
        per(mem): C:13.9 S:37.1 H:4.42 A:7.73 B:36.9 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3372:0.0257MB:2.51e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.310e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-7.212e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=115:8.774e-04MB
qtensor4: wf4 own=1 _data=0x5585f6591400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
 qbond: qcol nsym=6 dimAll=10
 (4,2):3 (3,1):2 (2,2):2 (4,0):1 (5,1):1 (3,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=40 nblocks=552 size=115:8.774e-04MB
### DIAG TIMING: total=1.769e-03 t1=1.818e-05, t2=2.384e-05, t3=2.607e-05, t4=1.641e-03, t5=9.197e-06, t6=4.176e-05, t7=9.477e-06
duration_diagGPU:1.789e-03
duration_diagreduce:3.500e-08
duration_diagtransform:3.030e-07
----- TIMING FOR symbolic_formulae_twodot with size=149 : 3.023e-04 S -----
rank=0 GPUmem(GB): used=2.512e-05 (oper)=2.512e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=149
 no. of hintermediate operators=68
 no. of coefficients=868:6.622e-03MB:6.467e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.867e-05 S -----
rank=0 GPUmem(GB): used=3.159e-05 (oper,hinter)=2.512e-05,6.467e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.965e-02 S size(H_formulae)=149 size(Hxlst2)=40 T(Hmu/Hxlist)=7.961e-05,1.957e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.049e-02 S size(H_formulae)=149 size(Hxlst)=8696 -----
rank=0 GPUmem(GB): used=3.159e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.714e-06 batch[need]=1.814e-03 blksize=9 blksize0=9 batchsize=8696
rank=0 GPUmem(GB): used=1.847e-03 (oper,hinter,dvdson,batch)=2.512e-05,6.467e-06,1.714e-06,1.814e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=115 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.348e-05,1.804e-04,7.382e-04,9.133e-04,1.914e-03
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=2.228e-05 speed=7.690e-02GB/S T(nccl)=5.120e-05 speed=3.347e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=7.4e-04 t_reduction=9.1e-04 tot=1.8e-03 -----
 sigma[inter] counter=115 t=1.8e-04 per=9.8e+00 cost=2.8e+05 flops=1.5e+09
 sigma[gemm] counter=115 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=1.7e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=1.7e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=3 t=1.7e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=4 t=1.8e-04 per=9.8e+00 cost=4.4e+04 flops=2.5e+08
 sigma[gemm] counter=115 i=5 t=1.9e-04 per=1.1e+01 cost=4.4e+04 flops=2.2e+08
 sigma[gemm] counter=115 i=6 t=1.7e-04 per=9.5e+00 cost=3.7e+04 flops=2.1e+08
 sigma[gemm] counter=115 i=7 t=1.8e-04 per=9.9e+00 cost=3.7e+04 flops=2.0e+08
 sigma[gemm] counter=115 total t=7.4e-04 per=4.0e+01 cost=1.6e+05 flops=2.2e+08
 sigma[red] counter=115 t=9.1e-04 per=5.0e+01 cost=5.5e+04 flops=6.0e+07
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.3e-02 t_reduction=6.6e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=115 t=1.4e-02 per=9.1e+00 cost=3.7e+07 flops=2.6e+09
 sigma_tot[gemm] counter=115 i=0 t=2.6e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=3 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=4 t=1.7e-02 per=1.1e+01 cost=8.0e+06 flops=4.8e+08
 sigma_tot[gemm] counter=115 i=5 t=1.9e-02 per=1.2e+01 cost=8.0e+06 flops=4.3e+08
 sigma_tot[gemm] counter=115 i=6 t=1.8e-02 per=1.2e+01 cost=7.8e+06 flops=4.2e+08
 sigma_tot[gemm] counter=115 i=7 t=1.8e-02 per=1.2e+01 cost=7.8e+06 flops=4.3e+08
 sigma_tot[gemm] counter=115 total t=7.3e-02 per=4.8e+01 cost=3.2e+07 flops=4.3e+08
 sigma_tot[red] counter=115 t=6.6e-02 per=4.3e+01 cost=7.6e+06 flops=1.1e+08
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,3.1e-06,9.4e-07,9.6e-07,2.7e-07
settings: ndim=115 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316747067343 -1.116e+03  1.828e-02    1     1  2.265e-03 2.265e-03 2.235e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.720e-05,1.880e-04,8.696e-04,9.727e-04,2.102e-03
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=2.143e-05 speed=7.997e-02GB/S T(nccl)=4.577e-05 speed=3.744e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=8.7e-04 t_reduction=9.7e-04 tot=2.0e-03 -----
 sigma[inter] counter=116 t=1.9e-04 per=9.3e+00 cost=2.8e+05 flops=1.5e+09
 sigma[gemm] counter=116 i=0 t=2.0e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=1.9e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=3 t=1.9e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=4 t=2.1e-04 per=1.0e+01 cost=4.4e+04 flops=2.1e+08
 sigma[gemm] counter=116 i=5 t=2.4e-04 per=1.2e+01 cost=4.4e+04 flops=1.8e+08
 sigma[gemm] counter=116 i=6 t=2.1e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=116 i=7 t=2.0e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=116 total t=8.7e-04 per=4.3e+01 cost=1.6e+05 flops=1.9e+08
 sigma[red] counter=116 t=9.7e-04 per=4.8e+01 cost=5.5e+04 flops=5.6e+07
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.4e-02 t_reduction=6.7e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=116 t=1.4e-02 per=9.1e+00 cost=3.7e+07 flops=2.6e+09
 sigma_tot[gemm] counter=116 i=0 t=2.7e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=3 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=4 t=1.7e-02 per=1.1e+01 cost=8.0e+06 flops=4.7e+08
 sigma_tot[gemm] counter=116 i=5 t=1.9e-02 per=1.2e+01 cost=8.1e+06 flops=4.2e+08
 sigma_tot[gemm] counter=116 i=6 t=1.9e-02 per=1.2e+01 cost=7.8e+06 flops=4.2e+08
 sigma_tot[gemm] counter=116 i=7 t=1.8e-02 per=1.2e+01 cost=7.9e+06 flops=4.3e+08
 sigma_tot[gemm] counter=116 total t=7.4e-02 per=4.8e+01 cost=3.2e+07 flops=4.3e+08
 sigma_tot[red] counter=116 t=6.7e-02 per=4.3e+01 cost=7.6e+06 flops=1.1e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.2e-05,2.8e-06,1.2e-06,2.1e-07
    2   0 -    -116.317173934304 -4.269e-04  3.616e-03    2     2  4.640e-03 2.320e-03 2.270e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.543e-05,1.834e-04,8.679e-04,9.665e-04,2.087e-03
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=2.139e-05 speed=8.013e-02GB/S T(nccl)=4.404e-05 speed=3.891e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=8.7e-04 t_reduction=9.7e-04 tot=2.0e-03 -----
 sigma[inter] counter=117 t=1.8e-04 per=9.1e+00 cost=2.8e+05 flops=1.5e+09
 sigma[gemm] counter=117 i=0 t=2.0e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=2.0e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=3 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=4 t=2.2e-04 per=1.1e+01 cost=4.4e+04 flops=2.0e+08
 sigma[gemm] counter=117 i=5 t=2.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.9e+08
 sigma[gemm] counter=117 i=6 t=2.0e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=117 i=7 t=2.0e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=117 total t=8.7e-04 per=4.3e+01 cost=1.6e+05 flops=1.9e+08
 sigma[red] counter=117 t=9.7e-04 per=4.8e+01 cost=5.5e+04 flops=5.7e+07
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.5e-02 t_reduction=6.8e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=117 t=1.4e-02 per=9.1e+00 cost=3.7e+07 flops=2.6e+09
 sigma_tot[gemm] counter=117 i=0 t=2.7e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=3 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=4 t=1.7e-02 per=1.1e+01 cost=8.1e+06 flops=4.7e+08
 sigma_tot[gemm] counter=117 i=5 t=1.9e-02 per=1.2e+01 cost=8.1e+06 flops=4.2e+08
 sigma_tot[gemm] counter=117 i=6 t=1.9e-02 per=1.2e+01 cost=7.8e+06 flops=4.2e+08
 sigma_tot[gemm] counter=117 i=7 t=1.9e-02 per=1.2e+01 cost=7.9e+06 flops=4.2e+08
 sigma_tot[gemm] counter=117 total t=7.5e-02 per=4.8e+01 cost=3.2e+07 flops=4.3e+08
 sigma_tot[red] counter=117 t=6.8e-02 per=4.3e+01 cost=7.7e+06 flops=1.1e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.4e-05,2.0e-06,1.3e-06,1.8e-07
    3   0 -    -116.317223655373 -4.972e-05  1.683e-03    3     3  7.015e-03 2.338e-03 2.288e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.546e-05,1.869e-04,8.650e-04,9.675e-04,2.089e-03
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=2.141e-05 speed=8.005e-02GB/S T(nccl)=4.406e-05 speed=3.890e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=8.6e-04 t_reduction=9.7e-04 tot=2.0e-03 -----
 sigma[inter] counter=118 t=1.9e-04 per=9.3e+00 cost=2.8e+05 flops=1.5e+09
 sigma[gemm] counter=118 i=0 t=2.0e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=2.0e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=2.0e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=3 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=4 t=2.1e-04 per=1.0e+01 cost=4.4e+04 flops=2.1e+08
 sigma[gemm] counter=118 i=5 t=2.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.9e+08
 sigma[gemm] counter=118 i=6 t=2.0e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=118 i=7 t=2.1e-04 per=1.1e+01 cost=3.7e+04 flops=1.7e+08
 sigma[gemm] counter=118 total t=8.6e-04 per=4.3e+01 cost=1.6e+05 flops=1.9e+08
 sigma[red] counter=118 t=9.7e-04 per=4.8e+01 cost=5.5e+04 flops=5.7e+07
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.6e-02 t_reduction=6.9e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=118 t=1.4e-02 per=9.1e+00 cost=3.8e+07 flops=2.6e+09
 sigma_tot[gemm] counter=118 i=0 t=2.7e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=3 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=4 t=1.7e-02 per=1.1e+01 cost=8.1e+06 flops=4.7e+08
 sigma_tot[gemm] counter=118 i=5 t=2.0e-02 per=1.2e+01 cost=8.2e+06 flops=4.2e+08
 sigma_tot[gemm] counter=118 i=6 t=1.9e-02 per=1.2e+01 cost=7.9e+06 flops=4.1e+08
 sigma_tot[gemm] counter=118 i=7 t=1.9e-02 per=1.2e+01 cost=7.9e+06 flops=4.2e+08
 sigma_tot[gemm] counter=118 total t=7.6e-02 per=4.8e+01 cost=3.2e+07 flops=4.2e+08
 sigma_tot[red] counter=118 t=6.9e-02 per=4.3e+01 cost=7.7e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,2.0e-06,1.2e-06,2.0e-07
    4   0 -    -116.317230451089 -6.796e-06  6.074e-04    3     4  9.337e-03 2.334e-03 2.284e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.468e-05,1.808e-04,8.626e-04,9.629e-04,2.075e-03
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=2.113e-05 speed=8.108e-02GB/S T(nccl)=4.355e-05 speed=3.935e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=8.6e-04 t_reduction=9.6e-04 tot=2.0e-03 -----
 sigma[inter] counter=119 t=1.8e-04 per=9.0e+00 cost=2.8e+05 flops=1.5e+09
 sigma[gemm] counter=119 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=3 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=4 t=2.1e-04 per=1.1e+01 cost=4.4e+04 flops=2.1e+08
 sigma[gemm] counter=119 i=5 t=2.4e-04 per=1.2e+01 cost=4.4e+04 flops=1.8e+08
 sigma[gemm] counter=119 i=6 t=2.0e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=119 i=7 t=2.0e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=119 total t=8.6e-04 per=4.3e+01 cost=1.6e+05 flops=1.9e+08
 sigma[red] counter=119 t=9.6e-04 per=4.8e+01 cost=5.5e+04 flops=5.7e+07
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.7e-02 t_reduction=7.0e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=119 t=1.5e-02 per=9.1e+00 cost=3.8e+07 flops=2.6e+09
 sigma_tot[gemm] counter=119 i=0 t=2.7e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=3 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=4 t=1.8e-02 per=1.1e+01 cost=8.2e+06 flops=4.6e+08
 sigma_tot[gemm] counter=119 i=5 t=2.0e-02 per=1.2e+01 cost=8.2e+06 flops=4.2e+08
 sigma_tot[gemm] counter=119 i=6 t=1.9e-02 per=1.2e+01 cost=7.9e+06 flops=4.1e+08
 sigma_tot[gemm] counter=119 i=7 t=1.9e-02 per=1.2e+01 cost=8.0e+06 flops=4.2e+08
 sigma_tot[gemm] counter=119 total t=7.7e-02 per=4.8e+01 cost=3.2e+07 flops=4.2e+08
 sigma_tot[red] counter=119 t=7.0e-02 per=4.3e+01 cost=7.8e+06 flops=1.1e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,1.9e-06,1.3e-06,1.6e-07
    5   0 -    -116.317231340389 -8.893e-07  2.148e-04    3     5  1.166e-02 2.331e-03 2.282e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.383e-05,1.807e-04,8.616e-04,9.595e-04,2.069e-03
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=2.091e-05 speed=8.196e-02GB/S T(nccl)=4.292e-05 speed=3.992e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=8.6e-04 t_reduction=9.6e-04 tot=2.0e-03 -----
 sigma[inter] counter=120 t=1.8e-04 per=9.0e+00 cost=2.8e+05 flops=1.5e+09
 sigma[gemm] counter=120 i=0 t=2.0e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=3 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=4 t=2.1e-04 per=1.1e+01 cost=4.4e+04 flops=2.1e+08
 sigma[gemm] counter=120 i=5 t=2.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.9e+08
 sigma[gemm] counter=120 i=6 t=2.0e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=120 i=7 t=2.1e-04 per=1.0e+01 cost=3.7e+04 flops=1.8e+08
 sigma[gemm] counter=120 total t=8.6e-04 per=4.3e+01 cost=1.6e+05 flops=1.9e+08
 sigma[red] counter=120 t=9.6e-04 per=4.8e+01 cost=5.5e+04 flops=5.7e+07
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.8e-02 t_reduction=7.1e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=120 t=1.5e-02 per=9.1e+00 cost=3.8e+07 flops=2.6e+09
 sigma_tot[gemm] counter=120 i=0 t=2.7e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=3 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=4 t=1.8e-02 per=1.1e+01 cost=8.2e+06 flops=4.6e+08
 sigma_tot[gemm] counter=120 i=5 t=2.0e-02 per=1.2e+01 cost=8.3e+06 flops=4.1e+08
 sigma_tot[gemm] counter=120 i=6 t=1.9e-02 per=1.2e+01 cost=7.9e+06 flops=4.1e+08
 sigma_tot[gemm] counter=120 i=7 t=1.9e-02 per=1.2e+01 cost=8.0e+06 flops=4.2e+08
 sigma_tot[gemm] counter=120 total t=7.8e-02 per=4.8e+01 cost=3.2e+07 flops=4.2e+08
 sigma_tot[red] counter=120 t=7.1e-02 per=4.3e+01 cost=7.9e+06 flops=1.1e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,1.8e-06,1.2e-06,1.7e-07
    6   0 +    -116.317231466819 -1.264e-07  8.444e-05    3     6  1.398e-02 2.330e-03 2.281e-03
TIMING FOR Davidson : 1.402e-02  T(cal/comm/rest)=1.369e-02,1.738e-05,3.116e-04
decomposed t_rest=3.116e-04
 T(sub)    =1.154e-04 per=3.704e+01
 T(precond)=1.624e-05 per=5.211e+00
 T(ortho)  =8.598e-06 per=2.759e+00
 T(xcopy)  =8.750e-07 per=2.808e-01
 T(xnrm2)  =1.026e-06 per=3.292e-01
 T(other)  =1.695e-04 per=5.438e+01
optimized energies: isweep=0 ibond=19 dots=2 e[0]=-116.317231466819 nmvp=6
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=2.357e-03 change=2.337e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=11 dimAll=39
 (4,2):8 (3,1):4 (2,2):2 (4,0):3 (5,1):7 (3,3):3 (6,2):4 (6,0):2 (7,1):1 (5,3):4 (4,4):1
timing for divide=8.3e-06
timing for compute=6.5e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(su2): 8.5e-05 S T(divide/compute[cpu/gpu/rest]/collect)=8.3e-06,5.7e-05,0.0e+00,7.3e-06,1.2e-05 -----
decimation summary: 39->10 dwt=+3.341e-04 SvN=7.724e-01
 qbond: qkept nsym=6 dimAll=10
 (5,3):3 (4,2):2 (6,2):2 (5,1):1 (7,1):1 (4,4):1
----- TIMING for decimation_row(nkr): 1.048e-03 S T(decim/select/formRot)=1.262e-04,9.000e-04,2.124e-05 -----
----- TIMING FOR twodot_decimation: 1.172e-03 S T(wf/decim)=1.074e-04,1.064e-03 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=577:4.402e-03MB:4.299e-06GB
        per(mem): C:14.6 S:29.1 H:3.47 A:9.53 B:43.3 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=2.357e-03 change=8.712e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=23 : 3.679e-05 S -----
rank=0 GPUmem(GB): used=2.901e-05 (oper)=1.511e-05
rank=0 GPUmem(GB): used=2.935e-05 (oper,site)=1.511e-05,3.353e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=23
 no. of rintermediate operators=5
 no. of coefficients=17:1.297e-04MB:1.267e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.166e-05 S -----
rank=0 GPUmem(GB): used=2.947e-05 (oper,site,rinter)=1.511e-05,3.353e-07,1.267e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.512e-04 S size(rtasks)=23 size(Rlst2)=36 T(Rmu/Rlist)=1.877e-05,5.324e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.986e-04 S size(rtasks)=23 size(Rlst)=450 -----
rank=0 GPUmem(GB): used=2.947e-05 avail=3.829e+01 total=3.829e+01 batch[need]=9.388e-05 blksize=9 blksize0=9 batchsize=450
rank=0 GPUmem(GB): used=1.234e-04 (oper,site,rinter,batch)=1.511e-05,3.353e-07,1.267e-07,9.388e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.210e-04,5.444e-04,2.190e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=5.4e-04 t_reduction=2.2e-04 tot=8.8e-04 -----
 renorm[inter] counter=219 t=1.2e-04 per=1.4e+01 cost=2.4e+03 flops=2.0e+07
 renorm[gemm] counter=219 i=0 t=2.1e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=1 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=2 t=1.6e-04 per=1.8e+01 cost=1.3e+03 flops=8.4e+06
 renorm[gemm] counter=219 i=3 t=1.8e-04 per=2.1e+01 cost=4.0e+03 flops=2.1e+07
 renorm[gemm] counter=219 i=4 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=5 t=1.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=6 t=1.9e-04 per=2.2e+01 cost=5.7e+03 flops=3.0e+07
 renorm[gemm] counter=219 total t=5.4e-04 per=6.2e+01 cost=1.1e+04 flops=2.0e+07
 renorm[red] counter=219 t=2.2e-04 per=2.5e+01 cost=3.0e+03 flops=1.3e+07
----- TIMING FOR renorm_tot : t_inter=1.9e-03 t_gemm=8.1e-03 t_reduction=3.2e-03 tot=1.3e-02 -----
 renorm_tot[inter] counter=219 t=1.9e-03 per=1.4e+01 cost=3.7e+05 flops=2.0e+08
 renorm_tot[gemm] counter=219 i=0 t=4.3e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=219 i=1 t=3.8e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=219 i=2 t=4.5e-04 per=3.4e+00 cost=2.5e+03 flops=5.6e+06
 renorm_tot[gemm] counter=219 i=3 t=4.7e-04 per=3.6e+00 cost=6.2e+03 flops=1.3e+07
 renorm_tot[gemm] counter=219 i=4 t=2.2e-03 per=1.6e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=219 i=5 t=2.3e-03 per=1.7e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=219 i=6 t=2.6e-03 per=2.0e+01 cost=4.5e+05 flops=1.7e+08
 renorm_tot[gemm] counter=219 total t=8.1e-03 per=6.2e+01 cost=7.6e+05 flops=9.4e+07
 renorm_tot[red] counter=219 t=3.2e-03 per=2.4e+01 cost=2.0e+05 flops=6.4e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.186e-05 (oper)=1.527e-05
rank=0 GPUmem(GB): used=3.219e-05 (oper,site,rinter)=1.527e-05,3.353e-07,2.563e-06
rank=0 GPUmem(GB): used=5.410e-05 (oper,site,rinter,batch)=1.527e-05,3.353e-07,2.563e-06,2.190e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.060e-02 S T(preprocess/alloc/comp/red/dealloc)=2.397e-03,2.450e-03,7.692e-03,3.100e-04,1.236e-04 -----
----- TIMING FOR oper_renorm_opS : 1.065e-02 S rank=0 -----
qops.to_cpu: size(tot)=577:4.402e-03MB:4.299e-06GB T(to_cpu)=2.527e-05S speed=1.701e-01GB/S
check ||H-H.dagger||=6.155e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0131 S rank=0 -----
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.098e-03 change=1.227e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=2.098e-03 change=-1.106e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=2.098e-03 change=-4.545e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.152e-02 S #####
 T(local opt: fetch) = 2.344e-03 S  per = 3.81  per(accum) = 3.81
 T(local opt: hdiag) = 1.914e-03 S  per = 3.11  per(accum) = 6.92
 T(local opt: dvdsn) = 4.021e-02 S  per = 65.4  per(accum) = 72.3
 T(local opt: decim) = 1.202e-03 S  per = 1.95  per(accum) = 74.2
 T(local opt: guess) = 1.169e-04 S  per = 0.19  per(accum) = 74.4
 T(local opt: renrm) = 1.390e-02 S  per = 22.6  per(accum) = 97
 T(local opt: save ) = 1.838e-03 S  per = 2.99  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.021e-02 S  T(sum) = 3.963e-02 S  per = 9.857e+01
 T(local opt: preprocess                  ) = 6.865e-04 S  per = 1.73  per(accum) = 1.73
 T(local opt: symbolic_formulae           ) = 3.167e-04 S  per = 0.799  per(accum) = 2.53
 T(local opt: hintermediate init          ) = 8.351e-05 S  per = 0.211  per(accum) = 2.74
 T(local opt: preprocess_hformulae_Hxlist ) = 2.060e-02 S  per =   52  per(accum) = 54.7
 T(local opt: hmmtasks init               ) = 3.697e-03 S  per = 9.33  per(accum) = 64.1
 T(local opt: initial guess for dvdson    ) = 2.294e-04 S  per = 0.579  per(accum) = 64.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.329e-02 S  per = 33.5  per(accum) = 98.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.285e-04 S  per = 0.324  per(accum) = 98.5
 T(local opt: dvdson [nccl]               ) = 2.715e-04 S  per = 0.685  per(accum) = 99.2
 T(local opt: dvdson [mpi]                ) = 1.738e-05 S  per = 0.0438  per(accum) = 99.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.116e-04 S  per = 0.786  per(accum) = 100
Detailed decomposition of T(renrm) = 1.390e-02 S  T(sum) = 1.390e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.553e-05 S  per = 0.472  per(accum) = 0.472
 T(local opt: qops init                    ) = 2.979e-04 S  per = 2.14  per(accum) = 2.62
 T(local opt: symbolic_formulae_renorm     ) = 4.681e-05 S  per = 0.337  per(accum) = 2.95
 T(local opt: allocate qops on gpu         ) = 5.951e-05 S  per = 0.428  per(accum) = 3.38
 T(local opt: site memcpy cpu2gpu          ) = 2.702e-05 S  per = 0.194  per(accum) = 3.57
 T(local opt: rintermediate init           ) = 5.046e-05 S  per = 0.363  per(accum) = 3.94
 T(local opt: preprocess_formulae_Rlist2   ) = 6.086e-04 S  per = 4.38  per(accum) = 8.32
 T(local opt: rmmtasks init                ) = 2.095e-04 S  per = 1.51  per(accum) = 9.83
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 0.000302  per(accum) = 9.83
 T(local opt: preprocess_renorm_batchGPU   ) = 1.039e-03 S  per = 7.47  per(accum) = 17.3
 T(local opt: deallocate cpu and gpu memory) = 2.568e-05 S  per = 0.185  per(accum) = 17.5
 T(local opt: construct opS [ifdists=true] ) = 1.068e-02 S  per = 76.9  per(accum) = 94.4
 T(local opt: reduction of opS & opH [nccl]) = 2.311e-05 S  per = 0.166  per(accum) = 94.5
 T(local opt: qops memcpy gpu2cpu          ) = 3.466e-05 S  per = 0.249  per(accum) = 94.8
 T(local opt: reduction of opS & opH [mpi] ) = 4.136e-05 S  per = 0.298  per(accum) = 95.1
 T(local opt: qops_pool join and erase     ) = 6.804e-04 S  per =  4.9  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.840e-06 S  per = 0.0276  per(accum) = 100
ctns::rcanon_save_site idx=3 scratch=./scratch/sweep size=45:3.4e-07GB T(load)=0.00055S speed=0.00061GB/S
##### sweep opt: 8.468e-01 S #####
 T(sweep opt: fetch) = 5.030e-02 S  per = 5.94  per(accum) = 5.94
 T(sweep opt: hdiag) = 4.128e-02 S  per = 4.87  per(accum) = 10.8
 T(sweep opt: dvdsn) = 5.200e-01 S  per = 61.4  per(accum) = 72.2
 T(sweep opt: decim) = 2.206e-02 S  per =  2.6  per(accum) = 74.8
 T(sweep opt: guess) = 1.710e-03 S  per = 0.202  per(accum) = 75
 T(sweep opt: renrm) = 1.749e-01 S  per = 20.7  per(accum) = 95.7
 T(sweep opt: save ) = 3.658e-02 S  per = 4.32  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.200e-01 S  T(sum) = 5.118e-01 S  per = 9.844e+01
 T(sweep opt: preprocess                  ) = 6.206e-03 S  per = 1.21  per(accum) = 1.21
 T(sweep opt: symbolic_formulae           ) = 8.761e-03 S  per = 1.71  per(accum) = 2.92
 T(sweep opt: hintermediate init          ) = 1.356e-03 S  per = 0.265  per(accum) = 3.19
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.405e-01 S  per =   47  per(accum) = 50.2
 T(sweep opt: hmmtasks init               ) = 4.704e-02 S  per = 9.19  per(accum) = 59.4
 T(sweep opt: initial guess for dvdson    ) = 2.774e-03 S  per = 0.542  per(accum) = 59.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.891e-01 S  per = 36.9  per(accum) = 96.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.688e-03 S  per = 0.525  per(accum) = 97.4
 T(sweep opt: dvdson [nccl]               ) = 6.786e-03 S  per = 1.33  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 6.431e-05 S  per = 0.0126  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.501e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm) = 1.749e-01 S  T(sum) = 1.749e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.046e-03 S  per = 0.598  per(accum) = 0.598
 T(sweep opt: qops init                    ) = 6.595e-03 S  per = 3.77  per(accum) = 4.37
 T(sweep opt: symbolic_formulae_renorm     ) = 3.152e-03 S  per =  1.8  per(accum) = 6.17
 T(sweep opt: allocate qops on gpu         ) = 1.114e-03 S  per = 0.637  per(accum) = 6.81
 T(sweep opt: site memcpy cpu2gpu          ) = 4.923e-04 S  per = 0.281  per(accum) = 7.09
 T(sweep opt: rintermediate init           ) = 8.913e-04 S  per = 0.51  per(accum) = 7.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.341e-02 S  per = 13.4  per(accum) = 21
 T(sweep opt: rmmtasks init                ) = 7.466e-03 S  per = 4.27  per(accum) = 25.2
 T(sweep opt: qops memset on cpu           ) = 9.650e-07 S  per = 0.000552  per(accum) = 25.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.579e-02 S  per = 9.02  per(accum) = 34.3
 T(sweep opt: deallocate cpu and gpu memory) = 5.784e-04 S  per = 0.331  per(accum) = 34.6
 T(sweep opt: construct opS [ifdists=true] ) = 9.597e-02 S  per = 54.9  per(accum) = 89.5
 T(sweep opt: reduction of opS & opH [nccl]) = 3.769e-04 S  per = 0.215  per(accum) = 89.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.774e-04 S  per = 0.387  per(accum) = 90.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.750e-04 S  per = 0.157  per(accum) = 90.2
 T(sweep opt: qops_pool join and erase     ) = 1.430e-02 S  per = 8.18  per(accum) = 98.4
 T(sweep opt: conversion from opAB to opPQ ) = 2.795e-03 S  per =  1.6  per(accum) = 100
##### global opt: 8.468e-01 S #####
 T(global opt: fetch) = 5.030e-02 S  per = 5.94  per(accum) = 5.94
 T(global opt: hdiag) = 4.128e-02 S  per = 4.87  per(accum) = 10.8
 T(global opt: dvdsn) = 5.200e-01 S  per = 61.4  per(accum) = 72.2
 T(global opt: decim) = 2.206e-02 S  per =  2.6  per(accum) = 74.8
 T(global opt: guess) = 1.710e-03 S  per = 0.202  per(accum) = 75
 T(global opt: renrm) = 1.749e-01 S  per = 20.7  per(accum) = 95.7
 T(global opt: save ) = 3.658e-02 S  per = 4.32  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.200e-01 S  T(sum) = 5.118e-01 S  per = 9.844e+01
 T(global opt: preprocess                  ) = 6.206e-03 S  per = 1.21  per(accum) = 1.21
 T(global opt: symbolic_formulae           ) = 8.761e-03 S  per = 1.71  per(accum) = 2.92
 T(global opt: hintermediate init          ) = 1.356e-03 S  per = 0.265  per(accum) = 3.19
 T(global opt: preprocess_hformulae_Hxlist ) = 2.405e-01 S  per =   47  per(accum) = 50.2
 T(global opt: hmmtasks init               ) = 4.704e-02 S  per = 9.19  per(accum) = 59.4
 T(global opt: initial guess for dvdson    ) = 2.774e-03 S  per = 0.542  per(accum) = 59.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.891e-01 S  per = 36.9  per(accum) = 96.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.688e-03 S  per = 0.525  per(accum) = 97.4
 T(global opt: dvdson [nccl]               ) = 6.786e-03 S  per = 1.33  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 6.431e-05 S  per = 0.0126  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 6.501e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm) = 1.749e-01 S  T(sum) = 1.749e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.046e-03 S  per = 0.598  per(accum) = 0.598
 T(global opt: qops init                    ) = 6.595e-03 S  per = 3.77  per(accum) = 4.37
 T(global opt: symbolic_formulae_renorm     ) = 3.152e-03 S  per =  1.8  per(accum) = 6.17
 T(global opt: allocate qops on gpu         ) = 1.114e-03 S  per = 0.637  per(accum) = 6.81
 T(global opt: site memcpy cpu2gpu          ) = 4.923e-04 S  per = 0.281  per(accum) = 7.09
 T(global opt: rintermediate init           ) = 8.913e-04 S  per = 0.51  per(accum) = 7.6
 T(global opt: preprocess_formulae_Rlist2   ) = 2.341e-02 S  per = 13.4  per(accum) = 21
 T(global opt: rmmtasks init                ) = 7.466e-03 S  per = 4.27  per(accum) = 25.2
 T(global opt: qops memset on cpu           ) = 9.650e-07 S  per = 0.000552  per(accum) = 25.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.579e-02 S  per = 9.02  per(accum) = 34.3
 T(global opt: deallocate cpu and gpu memory) = 5.784e-04 S  per = 0.331  per(accum) = 34.6
 T(global opt: construct opS [ifdists=true] ) = 9.597e-02 S  per = 54.9  per(accum) = 89.5
 T(global opt: reduction of opS & opH [nccl]) = 3.769e-04 S  per = 0.215  per(accum) = 89.7
 T(global opt: qops memcpy gpu2cpu          ) = 6.774e-04 S  per = 0.387  per(accum) = 90.1
 T(global opt: reduction of opS & opH [mpi] ) = 2.750e-04 S  per = 0.157  per(accum) = 90.2
 T(global opt: qops_pool join and erase     ) = 1.430e-02 S  per = 8.18  per(accum) = 98.4
 T(global opt: conversion from opAB to opPQ ) = 2.795e-03 S  per =  1.6  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-2.348e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=20/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=5 scratch=./scratch/sweep size=40:2.98e-07GB T(load)=3.02e-04S speed=9.87e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=91:6.94e-04MB:6.78e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=52:3.97e-04MB:3.87e-07GB
total mem of comb=144:1.10e-03MB:1.07e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=7.257e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:14 S:3 H:1 P:17 Q:22 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=625:4.768e-03MB:4.657e-06GB
        per(mem): C:26.9 S:5.76 H:2.08 P:5.44 Q:59.8 
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=10,10 size(op)=30:0.000229MB size(tot)=577:0.0044MB:4.3e-06GB
        per(mem): C:14.6 S:29.1 H:3.47 A:9.53 B:43.3 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3198:0.0244MB:2.38e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.853e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-4.351e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,10,3,3) nnz=97:7.401e-04MB
qtensor4: wf4 own=1 _data=0x5585ee043500
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
 qbond: qcol nsym=6 dimAll=10
 (5,3):3 (4,2):2 (6,2):2 (5,1):1 (7,1):1 (4,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=30 nblocks=384 size=97:7.401e-04MB
### DIAG TIMING: total=1.636e-03 t1=1.576e-05, t2=2.026e-05, t3=1.777e-05, t4=1.526e-03, t5=9.597e-06, t6=3.994e-05, t7=6.502e-06
duration_diagGPU:1.645e-03
duration_diagreduce:5.700e-08
duration_diagtransform:2.620e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 3.132e-04 S -----
rank=0 GPUmem(GB): used=2.383e-05 (oper)=2.383e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=195
 no. of hintermediate operators=94
 no. of coefficients=1215:9.270e-03MB:9.052e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.348e-05 S -----
rank=0 GPUmem(GB): used=3.288e-05 (oper,hinter)=2.383e-05,9.052e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.286e-02 S size(H_formulae)=195 size(Hxlst2)=30 T(Hmu/Hxlist)=8.416e-05,1.278e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.360e-02 S size(H_formulae)=195 size(Hxlst)=7412 -----
rank=0 GPUmem(GB): used=3.288e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.445e-06 batch[need]=1.215e-03 blksize=6 blksize0=9 batchsize=7412
rank=0 GPUmem(GB): used=1.249e-03 (oper,hinter,dvdson,batch)=2.383e-05,9.052e-06,1.445e-06,1.215e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=97 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.703e-05,1.827e-04,6.366e-04,8.746e-04,1.779e-03
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=2.358e-05 speed=6.129e-02GB/S T(nccl)=5.344e-05 speed=2.705e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=6.4e-04 t_reduction=8.7e-04 tot=1.7e-03 -----
 sigma[inter] counter=121 t=1.8e-04 per=1.1e+01 cost=2.3e+05 flops=1.3e+09
 sigma[gemm] counter=121 i=0 t=2.5e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=4 t=1.7e-04 per=1.0e+01 cost=4.5e+04 flops=2.6e+08
 sigma[gemm] counter=121 i=5 t=1.8e-04 per=1.1e+01 cost=4.4e+04 flops=2.4e+08
 sigma[gemm] counter=121 i=6 t=1.4e-04 per=8.3e+00 cost=3.3e+04 flops=2.3e+08
 sigma[gemm] counter=121 i=7 t=1.3e-04 per=7.8e+00 cost=3.3e+04 flops=2.5e+08
 sigma[gemm] counter=121 total t=6.4e-04 per=3.8e+01 cost=1.5e+05 flops=2.4e+08
 sigma[red] counter=121 t=8.7e-04 per=5.2e+01 cost=5.0e+04 flops=5.7e+07
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.8e-02 t_reduction=7.2e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=121 t=1.5e-02 per=9.1e+00 cost=3.8e+07 flops=2.6e+09
 sigma_tot[gemm] counter=121 i=0 t=2.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=3 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=4 t=1.8e-02 per=1.1e+01 cost=8.3e+06 flops=4.6e+08
 sigma_tot[gemm] counter=121 i=5 t=2.0e-02 per=1.2e+01 cost=8.3e+06 flops=4.1e+08
 sigma_tot[gemm] counter=121 i=6 t=2.0e-02 per=1.2e+01 cost=8.0e+06 flops=4.1e+08
 sigma_tot[gemm] counter=121 i=7 t=1.9e-02 per=1.2e+01 cost=8.1e+06 flops=4.1e+08
 sigma_tot[gemm] counter=121 total t=7.8e-02 per=4.7e+01 cost=3.3e+07 flops=4.2e+08
 sigma_tot[red] counter=121 t=7.2e-02 per=4.4e+01 cost=7.9e+06 flops=1.1e+08
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,3.6e-06,1.2e-06,1.1e-06,3.2e-07
settings: ndim=97 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316983833544 -1.116e+03  1.087e-02    1     1  2.116e-03 2.116e-03 2.086e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.106e-05,1.886e-04,7.453e-04,9.378e-04,1.948e-03
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=2.359e-05 speed=6.128e-02GB/S T(nccl)=4.747e-05 speed=3.045e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=7.4e-04 t_reduction=9.4e-04 tot=1.9e-03 -----
 sigma[inter] counter=122 t=1.9e-04 per=1.0e+01 cost=2.3e+05 flops=1.2e+09
 sigma[gemm] counter=122 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=3 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=4 t=2.0e-04 per=1.1e+01 cost=4.5e+04 flops=2.2e+08
 sigma[gemm] counter=122 i=5 t=2.2e-04 per=1.2e+01 cost=4.4e+04 flops=1.9e+08
 sigma[gemm] counter=122 i=6 t=1.5e-04 per=8.3e+00 cost=3.3e+04 flops=2.1e+08
 sigma[gemm] counter=122 i=7 t=1.5e-04 per=8.2e+00 cost=3.3e+04 flops=2.1e+08
 sigma[gemm] counter=122 total t=7.4e-04 per=4.0e+01 cost=1.5e+05 flops=2.1e+08
 sigma[red] counter=122 t=9.4e-04 per=5.0e+01 cost=5.0e+04 flops=5.3e+07
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.9e-02 t_reduction=7.3e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=122 t=1.5e-02 per=9.1e+00 cost=3.9e+07 flops=2.5e+09
 sigma_tot[gemm] counter=122 i=0 t=2.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=3 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=4 t=1.8e-02 per=1.1e+01 cost=8.3e+06 flops=4.6e+08
 sigma_tot[gemm] counter=122 i=5 t=2.0e-02 per=1.2e+01 cost=8.3e+06 flops=4.1e+08
 sigma_tot[gemm] counter=122 i=6 t=2.0e-02 per=1.2e+01 cost=8.0e+06 flops=4.1e+08
 sigma_tot[gemm] counter=122 i=7 t=2.0e-02 per=1.2e+01 cost=8.1e+06 flops=4.1e+08
 sigma_tot[gemm] counter=122 total t=7.9e-02 per=4.7e+01 cost=3.3e+07 flops=4.1e+08
 sigma_tot[red] counter=122 t=7.3e-02 per=4.4e+01 cost=8.0e+06 flops=1.1e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.3e-05,3.4e-06,1.3e-06,3.4e-07
    2   0 -    -116.317273851910 -2.900e-04  2.982e-03    2     2  4.392e-03 2.196e-03 2.141e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.049e-05,1.822e-04,7.614e-04,9.305e-04,1.949e-03
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=2.346e-05 speed=6.161e-02GB/S T(nccl)=4.703e-05 speed=3.074e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=7.6e-04 t_reduction=9.3e-04 tot=1.9e-03 -----
 sigma[inter] counter=123 t=1.8e-04 per=9.7e+00 cost=2.3e+05 flops=1.3e+09
 sigma[gemm] counter=123 i=0 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=4 t=2.1e-04 per=1.1e+01 cost=4.5e+04 flops=2.1e+08
 sigma[gemm] counter=123 i=5 t=2.3e-04 per=1.2e+01 cost=4.4e+04 flops=1.9e+08
 sigma[gemm] counter=123 i=6 t=1.6e-04 per=8.5e+00 cost=3.3e+04 flops=2.1e+08
 sigma[gemm] counter=123 i=7 t=1.5e-04 per=8.2e+00 cost=3.3e+04 flops=2.1e+08
 sigma[gemm] counter=123 total t=7.6e-04 per=4.1e+01 cost=1.5e+05 flops=2.0e+08
 sigma[red] counter=123 t=9.3e-04 per=5.0e+01 cost=5.0e+04 flops=5.4e+07
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=8.0e-02 t_reduction=7.4e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=123 t=1.5e-02 per=9.1e+00 cost=3.9e+07 flops=2.5e+09
 sigma_tot[gemm] counter=123 i=0 t=2.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=3 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=4 t=1.8e-02 per=1.1e+01 cost=8.3e+06 flops=4.5e+08
 sigma_tot[gemm] counter=123 i=5 t=2.1e-02 per=1.2e+01 cost=8.4e+06 flops=4.1e+08
 sigma_tot[gemm] counter=123 i=6 t=2.0e-02 per=1.2e+01 cost=8.0e+06 flops=4.1e+08
 sigma_tot[gemm] counter=123 i=7 t=2.0e-02 per=1.2e+01 cost=8.1e+06 flops=4.1e+08
 sigma_tot[gemm] counter=123 total t=8.0e-02 per=4.7e+01 cost=3.3e+07 flops=4.1e+08
 sigma_tot[red] counter=123 t=7.4e-02 per=4.4e+01 cost=8.0e+06 flops=1.1e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.5e-05,2.6e-06,1.6e-06,2.4e-07
    3   0 -    -116.317293224830 -1.937e-05  1.085e-03    3     3  6.630e-03 2.210e-03 2.152e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.063e-05,1.905e-04,7.269e-04,9.383e-04,1.931e-03
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=2.327e-05 speed=6.211e-02GB/S T(nccl)=4.736e-05 speed=3.052e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=7.3e-04 t_reduction=9.4e-04 tot=1.9e-03 -----
 sigma[inter] counter=124 t=1.9e-04 per=1.0e+01 cost=2.3e+05 flops=1.2e+09
 sigma[gemm] counter=124 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=2.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=4 t=2.0e-04 per=1.1e+01 cost=4.5e+04 flops=2.3e+08
 sigma[gemm] counter=124 i=5 t=2.2e-04 per=1.2e+01 cost=4.4e+04 flops=2.0e+08
 sigma[gemm] counter=124 i=6 t=1.5e-04 per=8.3e+00 cost=3.3e+04 flops=2.1e+08
 sigma[gemm] counter=124 i=7 t=1.5e-04 per=8.0e+00 cost=3.3e+04 flops=2.2e+08
 sigma[gemm] counter=124 total t=7.3e-04 per=3.9e+01 cost=1.5e+05 flops=2.1e+08
 sigma[red] counter=124 t=9.4e-04 per=5.1e+01 cost=5.0e+04 flops=5.3e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.0e-02 t_reduction=7.5e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=124 t=1.6e-02 per=9.1e+00 cost=3.9e+07 flops=2.5e+09
 sigma_tot[gemm] counter=124 i=0 t=2.8e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=3 t=2.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=4 t=1.9e-02 per=1.1e+01 cost=8.4e+06 flops=4.5e+08
 sigma_tot[gemm] counter=124 i=5 t=2.1e-02 per=1.2e+01 cost=8.4e+06 flops=4.0e+08
 sigma_tot[gemm] counter=124 i=6 t=2.0e-02 per=1.2e+01 cost=8.1e+06 flops=4.0e+08
 sigma_tot[gemm] counter=124 i=7 t=2.0e-02 per=1.2e+01 cost=8.1e+06 flops=4.1e+08
 sigma_tot[gemm] counter=124 total t=8.0e-02 per=4.7e+01 cost=3.3e+07 flops=4.1e+08
 sigma_tot[red] counter=124 t=7.5e-02 per=4.4e+01 cost=8.1e+06 flops=1.1e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.4e-05,2.2e-06,1.5e-06,1.9e-07
    4   0 -    -116.317295375904 -2.151e-06  3.934e-04    3     4  8.880e-03 2.220e-03 2.162e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.963e-05,1.857e-04,7.357e-04,9.357e-04,1.931e-03
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=2.285e-05 speed=6.325e-02GB/S T(nccl)=4.678e-05 speed=3.090e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=7.4e-04 t_reduction=9.4e-04 tot=1.9e-03 -----
 sigma[inter] counter=125 t=1.9e-04 per=1.0e+01 cost=2.3e+05 flops=1.2e+09
 sigma[gemm] counter=125 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=4 t=2.0e-04 per=1.1e+01 cost=4.5e+04 flops=2.2e+08
 sigma[gemm] counter=125 i=5 t=2.2e-04 per=1.2e+01 cost=4.4e+04 flops=2.0e+08
 sigma[gemm] counter=125 i=6 t=1.5e-04 per=8.0e+00 cost=3.3e+04 flops=2.2e+08
 sigma[gemm] counter=125 i=7 t=1.6e-04 per=8.6e+00 cost=3.3e+04 flops=2.0e+08
 sigma[gemm] counter=125 total t=7.4e-04 per=4.0e+01 cost=1.5e+05 flops=2.1e+08
 sigma[red] counter=125 t=9.4e-04 per=5.0e+01 cost=5.0e+04 flops=5.4e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.1e-02 t_reduction=7.6e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=125 t=1.6e-02 per=9.1e+00 cost=3.9e+07 flops=2.5e+09
 sigma_tot[gemm] counter=125 i=0 t=2.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=3 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=4 t=1.9e-02 per=1.1e+01 cost=8.4e+06 flops=4.5e+08
 sigma_tot[gemm] counter=125 i=5 t=2.1e-02 per=1.2e+01 cost=8.5e+06 flops=4.0e+08
 sigma_tot[gemm] counter=125 i=6 t=2.0e-02 per=1.2e+01 cost=8.1e+06 flops=4.0e+08
 sigma_tot[gemm] counter=125 i=7 t=2.0e-02 per=1.2e+01 cost=8.2e+06 flops=4.1e+08
 sigma_tot[gemm] counter=125 total t=8.1e-02 per=4.7e+01 cost=3.3e+07 flops=4.1e+08
 sigma_tot[red] counter=125 t=7.6e-02 per=4.4e+01 cost=8.1e+06 flops=1.1e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,2.5e-06,1.5e-06,1.7e-07
    5   0 -    -116.317295765957 -3.901e-07  1.661e-04    3     5  1.109e-02 2.219e-03 2.160e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.882e-05,1.829e-04,7.370e-04,9.364e-04,1.929e-03
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=2.307e-05 speed=6.266e-02GB/S T(nccl)=4.575e-05 speed=3.159e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=7.4e-04 t_reduction=9.4e-04 tot=1.9e-03 -----
 sigma[inter] counter=126 t=1.8e-04 per=9.9e+00 cost=2.3e+05 flops=1.3e+09
 sigma[gemm] counter=126 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=3 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=4 t=2.0e-04 per=1.1e+01 cost=4.5e+04 flops=2.3e+08
 sigma[gemm] counter=126 i=5 t=2.2e-04 per=1.2e+01 cost=4.4e+04 flops=1.9e+08
 sigma[gemm] counter=126 i=6 t=1.5e-04 per=8.1e+00 cost=3.3e+04 flops=2.2e+08
 sigma[gemm] counter=126 i=7 t=1.5e-04 per=8.3e+00 cost=3.3e+04 flops=2.1e+08
 sigma[gemm] counter=126 total t=7.4e-04 per=4.0e+01 cost=1.5e+05 flops=2.1e+08
 sigma[red] counter=126 t=9.4e-04 per=5.0e+01 cost=5.0e+04 flops=5.3e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.2e-02 t_reduction=7.6e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=126 t=1.6e-02 per=9.1e+00 cost=4.0e+07 flops=2.5e+09
 sigma_tot[gemm] counter=126 i=0 t=2.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=3 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=4 t=1.9e-02 per=1.1e+01 cost=8.5e+06 flops=4.5e+08
 sigma_tot[gemm] counter=126 i=5 t=2.1e-02 per=1.2e+01 cost=8.5e+06 flops=4.0e+08
 sigma_tot[gemm] counter=126 i=6 t=2.0e-02 per=1.2e+01 cost=8.1e+06 flops=4.0e+08
 sigma_tot[gemm] counter=126 i=7 t=2.0e-02 per=1.2e+01 cost=8.2e+06 flops=4.1e+08
 sigma_tot[gemm] counter=126 total t=8.2e-02 per=4.7e+01 cost=3.3e+07 flops=4.1e+08
 sigma_tot[red] counter=126 t=7.6e-02 per=4.4e+01 cost=8.2e+06 flops=1.1e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.3e-05,2.3e-06,1.4e-06,1.7e-07
    6   0 +    -116.317295830466 -6.451e-08  7.554e-05    3     6  1.333e-02 2.221e-03 2.163e-03
TIMING FOR Davidson : 1.335e-02  T(cal/comm/rest)=1.298e-02,1.930e-06,3.709e-04
decomposed t_rest=3.709e-04
 T(sub)    =1.250e-04 per=3.369e+01
 T(precond)=2.069e-05 per=5.578e+00
 T(ortho)  =9.520e-06 per=2.567e+00
 T(xcopy)  =8.550e-07 per=2.305e-01
 T(xnrm2)  =1.300e-06 per=3.505e-01
 T(other)  =2.136e-04 per=5.758e+01
optimized energies: isweep=0 ibond=20 dots=2 e[0]=-116.317295830466 nmvp=6
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.724e-03 change=1.995e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=13 dimAll=40
 (5,3):6 (4,2):2 (6,2):8 (5,1):3 (7,1):4 (4,4):1 (7,3):5 (8,2):3 (9,1):1 (6,4):4 (6,0):1 (8,0):1 (5,5):1
timing for divide=1.1e-05
timing for compute=7.6e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 1.0e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,6.7e-05,0.0e+00,9.0e-06,1.3e-05 -----
decimation summary: 40->10 dwt=+6.719e-05 SvN=2.693e-01
 qbond: qkept nsym=5 dimAll=10
 (6,2):3 (7,3):3 (6,4):2 (5,3):1 (8,2):1
----- TIMING for decimation_row(nkr): 1.081e-03 S T(decim/select/formRot)=1.483e-04,9.029e-04,2.925e-05 -----
----- TIMING FOR twodot_decimation: 1.218e-03 S T(wf/decim)=1.141e-04,1.104e-03 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:5 S:7 H:1 A:12 B:16 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=862:6.577e-03MB:6.422e-06GB
        per(mem): C:13.3 S:18.7 H:2.78 A:9.51 B:55.7 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.724e-03 change=8.173e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=34 : 5.657e-05 S -----
rank=0 GPUmem(GB): used=3.465e-05 (oper)=1.816e-05
rank=0 GPUmem(GB): used=3.506e-05 (oper,site)=1.816e-05,4.172e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=34
 no. of rintermediate operators=5
 no. of coefficients=25:1.907e-04MB:1.863e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.847e-05 S -----
rank=0 GPUmem(GB): used=3.525e-05 (oper,site,rinter)=1.816e-05,4.172e-07,1.863e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 8.711e-04 S size(rtasks)=34 size(Rlst2)=25 T(Rmu/Rlist)=2.963e-05,8.414e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.692e-04 S size(rtasks)=34 size(Rlst)=556 -----
rank=0 GPUmem(GB): used=3.525e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.160e-04 blksize=9 blksize0=9 batchsize=556
rank=0 GPUmem(GB): used=1.512e-04 (oper,site,rinter,batch)=1.816e-05,4.172e-07,1.863e-07,1.160e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.392e-04,7.430e-04,2.316e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=7.4e-04 t_reduction=2.3e-04 tot=1.1e-03 -----
 renorm[inter] counter=236 t=1.4e-04 per=1.2e+01 cost=3.5e+03 flops=2.5e+07
 renorm[gemm] counter=236 i=0 t=2.8e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=236 i=1 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=236 i=2 t=2.3e-04 per=2.0e+01 cost=2.4e+03 flops=1.1e+07
 renorm[gemm] counter=236 i=3 t=2.7e-04 per=2.4e+01 cost=6.9e+03 flops=2.5e+07
 renorm[gemm] counter=236 i=4 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=236 i=5 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=236 i=6 t=2.3e-04 per=2.1e+01 cost=1.2e+04 flops=5.0e+07
 renorm[gemm] counter=236 total t=7.4e-04 per=6.7e+01 cost=2.1e+04 flops=2.8e+07
 renorm[red] counter=236 t=2.3e-04 per=2.1e+01 cost=5.6e+03 flops=2.4e+07
----- TIMING FOR renorm_tot : t_inter=2.0e-03 t_gemm=8.8e-03 t_reduction=3.4e-03 tot=1.4e-02 -----
 renorm_tot[inter] counter=236 t=2.0e-03 per=1.4e+01 cost=3.8e+05 flops=1.9e+08
 renorm_tot[gemm] counter=236 i=0 t=4.6e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=236 i=1 t=4.0e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=236 i=2 t=6.7e-04 per=4.7e+00 cost=4.9e+03 flops=7.3e+06
 renorm_tot[gemm] counter=236 i=3 t=7.4e-04 per=5.2e+00 cost=1.3e+04 flops=1.8e+07
 renorm_tot[gemm] counter=236 i=4 t=2.2e-03 per=1.5e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=236 i=5 t=2.3e-03 per=1.6e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=236 i=6 t=2.9e-03 per=2.0e+01 cost=4.7e+05 flops=1.6e+08
 renorm_tot[gemm] counter=236 total t=8.8e-03 per=6.2e+01 cost=7.8e+05 flops=8.9e+07
 renorm_tot[red] counter=236 t=3.4e-03 per=2.4e+01 cost=2.1e+05 flops=6.1e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.876e-05 (oper)=1.833e-05
rank=0 GPUmem(GB): used=3.918e-05 (oper,site,rinter)=1.833e-05,4.172e-07,3.755e-06
rank=0 GPUmem(GB): used=5.837e-05 (oper,site,rinter,batch)=1.833e-05,4.172e-07,3.755e-06,1.919e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 9.869e-03 S T(preprocess/alloc/comp/red/dealloc)=2.687e-03,2.741e-03,6.670e-03,3.191e-04,1.144e-04 -----
----- TIMING FOR oper_renorm_opS : 9.900e-03 S rank=0 -----
qops.to_cpu: size(tot)=862:6.577e-03MB:6.422e-06GB T(to_cpu)=2.564e-05S speed=2.505e-01GB/S
check ||H-H.dagger||=1.196e-14 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0132 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.534e-03 change=1.532e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.534e-03 change=-1.115e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.534e-03 change=-4.560e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 5.221e-02 S #####
 T(local opt: fetch) = 2.282e-03 S  per = 4.37  per(accum) = 4.37
 T(local opt: hdiag) = 1.715e-03 S  per = 3.28  per(accum) = 7.65
 T(local opt: dvdsn) = 3.095e-02 S  per = 59.3  per(accum) = 66.9
 T(local opt: decim) = 1.256e-03 S  per = 2.41  per(accum) = 69.3
 T(local opt: guess) = 1.194e-04 S  per = 0.229  per(accum) = 69.6
 T(local opt: renrm) = 1.405e-02 S  per = 26.9  per(accum) = 96.5
 T(local opt: save ) = 1.842e-03 S  per = 3.53  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.095e-02 S  T(sum) = 3.056e-02 S  per = 9.874e+01
 T(local opt: preprocess                  ) = 3.610e-04 S  per = 1.18  per(accum) = 1.18
 T(local opt: symbolic_formulae           ) = 3.180e-04 S  per = 1.04  per(accum) = 2.22
 T(local opt: hintermediate init          ) = 4.094e-05 S  per = 0.134  per(accum) = 2.36
 T(local opt: preprocess_hformulae_Hxlist ) = 1.365e-02 S  per = 44.6  per(accum) = 47
 T(local opt: hmmtasks init               ) = 2.691e-03 S  per =  8.8  per(accum) = 55.8
 T(local opt: initial guess for dvdson    ) = 1.595e-04 S  per = 0.522  per(accum) = 56.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.255e-02 S  per = 41.1  per(accum) = 97.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.398e-04 S  per = 0.457  per(accum) = 97.8
 T(local opt: dvdson [nccl]               ) = 2.878e-04 S  per = 0.942  per(accum) = 98.8
 T(local opt: dvdson [mpi]                ) = 1.930e-06 S  per = 0.00631  per(accum) = 98.8
 T(local opt: dvdson [rest part(linalg)]  ) = 3.709e-04 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm) = 1.405e-02 S  T(sum) = 1.405e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.912e-05 S  per = 0.492  per(accum) = 0.492
 T(local opt: qops init                    ) = 3.739e-04 S  per = 2.66  per(accum) = 3.15
 T(local opt: symbolic_formulae_renorm     ) = 6.856e-05 S  per = 0.488  per(accum) = 3.64
 T(local opt: allocate qops on gpu         ) = 6.759e-05 S  per = 0.481  per(accum) = 4.12
 T(local opt: site memcpy cpu2gpu          ) = 4.001e-05 S  per = 0.285  per(accum) = 4.41
 T(local opt: rintermediate init           ) = 6.580e-05 S  per = 0.468  per(accum) = 4.88
 T(local opt: preprocess_formulae_Rlist2   ) = 9.813e-04 S  per = 6.99  per(accum) = 11.9
 T(local opt: rmmtasks init                ) = 3.082e-04 S  per = 2.19  per(accum) = 14.1
 T(local opt: qops memset on cpu           ) = 5.600e-08 S  per = 0.000399  per(accum) = 14.1
 T(local opt: preprocess_renorm_batchGPU   ) = 1.323e-03 S  per = 9.42  per(accum) = 23.5
 T(local opt: deallocate cpu and gpu memory) = 3.200e-05 S  per = 0.228  per(accum) = 23.7
 T(local opt: construct opS [ifdists=true] ) = 9.916e-03 S  per = 70.6  per(accum) = 94.3
 T(local opt: reduction of opS & opH [nccl]) = 1.887e-05 S  per = 0.134  per(accum) = 94.4
 T(local opt: qops memcpy gpu2cpu          ) = 3.445e-05 S  per = 0.245  per(accum) = 94.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.288e-05 S  per = 0.0917  per(accum) = 94.8
 T(local opt: qops_pool join and erase     ) = 7.301e-04 S  per =  5.2  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.255e-06 S  per = 0.0303  per(accum) = 100
ctns::rcanon_save_site idx=4 scratch=./scratch/sweep size=56:4.2e-07GB T(load)=0.00057S speed=0.00073GB/S
##### sweep opt: 8.990e-01 S #####
 T(sweep opt: fetch) = 5.258e-02 S  per = 5.85  per(accum) = 5.85
 T(sweep opt: hdiag) = 4.299e-02 S  per = 4.78  per(accum) = 10.6
 T(sweep opt: dvdsn) = 5.509e-01 S  per = 61.3  per(accum) = 71.9
 T(sweep opt: decim) = 2.331e-02 S  per = 2.59  per(accum) = 74.5
 T(sweep opt: guess) = 1.829e-03 S  per = 0.203  per(accum) = 74.7
 T(sweep opt: renrm) = 1.890e-01 S  per =   21  per(accum) = 95.7
 T(sweep opt: save ) = 3.843e-02 S  per = 4.27  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.509e-01 S  T(sum) = 5.424e-01 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 6.567e-03 S  per = 1.21  per(accum) = 1.21
 T(sweep opt: symbolic_formulae           ) = 9.079e-03 S  per = 1.67  per(accum) = 2.88
 T(sweep opt: hintermediate init          ) = 1.397e-03 S  per = 0.258  per(accum) = 3.14
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.542e-01 S  per = 46.9  per(accum) = 50
 T(sweep opt: hmmtasks init               ) = 4.973e-02 S  per = 9.17  per(accum) = 59.2
 T(sweep opt: initial guess for dvdson    ) = 2.934e-03 S  per = 0.541  per(accum) = 59.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.017e-01 S  per = 37.2  per(accum) = 96.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.828e-03 S  per = 0.521  per(accum) = 97.4
 T(sweep opt: dvdson [nccl]               ) = 7.074e-03 S  per =  1.3  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 6.624e-05 S  per = 0.0122  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.872e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm) = 1.890e-01 S  T(sum) = 1.890e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.115e-03 S  per = 0.59  per(accum) = 0.59
 T(sweep opt: qops init                    ) = 6.969e-03 S  per = 3.69  per(accum) = 4.28
 T(sweep opt: symbolic_formulae_renorm     ) = 3.221e-03 S  per =  1.7  per(accum) = 5.98
 T(sweep opt: allocate qops on gpu         ) = 1.182e-03 S  per = 0.626  per(accum) = 6.61
 T(sweep opt: site memcpy cpu2gpu          ) = 5.323e-04 S  per = 0.282  per(accum) = 6.89
 T(sweep opt: rintermediate init           ) = 9.571e-04 S  per = 0.506  per(accum) = 7.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.439e-02 S  per = 12.9  per(accum) = 20.3
 T(sweep opt: rmmtasks init                ) = 7.775e-03 S  per = 4.11  per(accum) = 24.4
 T(sweep opt: qops memset on cpu           ) = 1.021e-06 S  per = 0.00054  per(accum) = 24.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.711e-02 S  per = 9.05  per(accum) = 33.5
 T(sweep opt: deallocate cpu and gpu memory) = 6.104e-04 S  per = 0.323  per(accum) = 33.8
 T(sweep opt: construct opS [ifdists=true] ) = 1.059e-01 S  per =   56  per(accum) = 89.8
 T(sweep opt: reduction of opS & opH [nccl]) = 3.957e-04 S  per = 0.209  per(accum) = 90
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.118e-04 S  per = 0.377  per(accum) = 90.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.879e-04 S  per = 0.152  per(accum) = 90.6
 T(sweep opt: qops_pool join and erase     ) = 1.503e-02 S  per = 7.95  per(accum) = 98.5
 T(sweep opt: conversion from opAB to opPQ ) = 2.799e-03 S  per = 1.48  per(accum) = 100
##### global opt: 8.990e-01 S #####
 T(global opt: fetch) = 5.258e-02 S  per = 5.85  per(accum) = 5.85
 T(global opt: hdiag) = 4.299e-02 S  per = 4.78  per(accum) = 10.6
 T(global opt: dvdsn) = 5.509e-01 S  per = 61.3  per(accum) = 71.9
 T(global opt: decim) = 2.331e-02 S  per = 2.59  per(accum) = 74.5
 T(global opt: guess) = 1.829e-03 S  per = 0.203  per(accum) = 74.7
 T(global opt: renrm) = 1.890e-01 S  per =   21  per(accum) = 95.7
 T(global opt: save ) = 3.843e-02 S  per = 4.27  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.509e-01 S  T(sum) = 5.424e-01 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 6.567e-03 S  per = 1.21  per(accum) = 1.21
 T(global opt: symbolic_formulae           ) = 9.079e-03 S  per = 1.67  per(accum) = 2.88
 T(global opt: hintermediate init          ) = 1.397e-03 S  per = 0.258  per(accum) = 3.14
 T(global opt: preprocess_hformulae_Hxlist ) = 2.542e-01 S  per = 46.9  per(accum) = 50
 T(global opt: hmmtasks init               ) = 4.973e-02 S  per = 9.17  per(accum) = 59.2
 T(global opt: initial guess for dvdson    ) = 2.934e-03 S  per = 0.541  per(accum) = 59.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.017e-01 S  per = 37.2  per(accum) = 96.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.828e-03 S  per = 0.521  per(accum) = 97.4
 T(global opt: dvdson [nccl]               ) = 7.074e-03 S  per =  1.3  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 6.624e-05 S  per = 0.0122  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 6.872e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm) = 1.890e-01 S  T(sum) = 1.890e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.115e-03 S  per = 0.59  per(accum) = 0.59
 T(global opt: qops init                    ) = 6.969e-03 S  per = 3.69  per(accum) = 4.28
 T(global opt: symbolic_formulae_renorm     ) = 3.221e-03 S  per =  1.7  per(accum) = 5.98
 T(global opt: allocate qops on gpu         ) = 1.182e-03 S  per = 0.626  per(accum) = 6.61
 T(global opt: site memcpy cpu2gpu          ) = 5.323e-04 S  per = 0.282  per(accum) = 6.89
 T(global opt: rintermediate init           ) = 9.571e-04 S  per = 0.506  per(accum) = 7.4
 T(global opt: preprocess_formulae_Rlist2   ) = 2.439e-02 S  per = 12.9  per(accum) = 20.3
 T(global opt: rmmtasks init                ) = 7.775e-03 S  per = 4.11  per(accum) = 24.4
 T(global opt: qops memset on cpu           ) = 1.021e-06 S  per = 0.00054  per(accum) = 24.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.711e-02 S  per = 9.05  per(accum) = 33.5
 T(global opt: deallocate cpu and gpu memory) = 6.104e-04 S  per = 0.323  per(accum) = 33.8
 T(global opt: construct opS [ifdists=true] ) = 1.059e-01 S  per =   56  per(accum) = 89.8
 T(global opt: reduction of opS & opH [nccl]) = 3.957e-04 S  per = 0.209  per(accum) = 90
 T(global opt: qops memcpy gpu2cpu          ) = 7.118e-04 S  per = 0.377  per(accum) = 90.4
 T(global opt: reduction of opS & opH [mpi] ) = 2.879e-04 S  per = 0.152  per(accum) = 90.6
 T(global opt: qops_pool join and erase     ) = 1.503e-02 S  per = 7.95  per(accum) = 98.5
 T(global opt: conversion from opAB to opPQ ) = 2.799e-03 S  per = 1.48  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-2.003e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=21/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=6 scratch=./scratch/sweep size=35:2.61e-07GB T(load)=3.02e-04S speed=8.63e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=75:5.72e-04MB:5.59e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=41:3.13e-04MB:3.05e-07GB
total mem of comb=117:8.93e-04MB:8.72e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=4.932e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:13 S:4 H:1 P:23 Q:28 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=1271:9.697e-03MB:9.470e-06GB
        per(mem): C:18.4 S:5.66 H:1.81 P:3.62 Q:70.5 
 rqops: oplist=CSHAB nops=C:5 S:7 H:1 A:12 B:16 
        dim(bra,ket)=10,10 size(op)=36:0.000275MB size(tot)=862:0.00658MB:6.42e-06GB
        per(mem): C:13.3 S:18.7 H:2.78 A:9.51 B:55.7 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4129:0.0315MB:3.08e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.067e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-9.120e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(9,10,3,3) nnz=101:7.706e-04MB
qtensor4: wf4 own=1 _data=0x5585ee043500
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
 qbond: qcol nsym=5 dimAll=10
 (6,2):3 (7,3):3 (6,4):2 (5,3):1 (8,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=25 nblocks=320 size=101:7.706e-04MB
### DIAG TIMING: total=2.137e-03 t1=1.804e-05, t2=2.113e-05, t3=1.874e-05, t4=2.027e-03, t5=7.052e-06, t6=3.850e-05, t7=7.196e-06
duration_diagGPU:2.153e-03
duration_diagreduce:5.600e-08
duration_diagtransform:2.750e-07
----- TIMING FOR symbolic_formulae_twodot with size=255 : 4.444e-04 S -----
rank=0 GPUmem(GB): used=3.076e-05 (oper)=3.076e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=255
 no. of hintermediate operators=131
 no. of coefficients=1619:1.235e-02MB:1.206e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.696e-05 S -----
rank=0 GPUmem(GB): used=4.283e-05 (oper,hinter)=3.076e-05,1.206e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.259e-02 S size(H_formulae)=255 size(Hxlst2)=25 T(Hmu/Hxlist)=1.117e-04,1.248e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.332e-02 S size(H_formulae)=255 size(Hxlst)=7434 -----
rank=0 GPUmem(GB): used=4.283e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.505e-06 batch[need]=1.551e-03 blksize=9 blksize0=9 batchsize=7434
rank=0 GPUmem(GB): used=1.595e-03 (oper,hinter,dvdson,batch)=3.076e-05,1.206e-05,1.505e-06,1.551e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=101 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.176e-05,1.723e-04,6.825e-04,5.686e-04,1.503e-03
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=2.237e-05 speed=6.728e-02GB/S T(nccl)=4.940e-05 speed=3.047e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=6.8e-04 t_reduction=5.7e-04 tot=1.4e-03 -----
 sigma[inter] counter=127 t=1.7e-04 per=1.2e+01 cost=3.5e+05 flops=2.0e+09
 sigma[gemm] counter=127 i=0 t=1.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=1.6e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=1.6e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=3 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=4 t=1.8e-04 per=1.3e+01 cost=6.8e+04 flops=3.7e+08
 sigma[gemm] counter=127 i=5 t=1.8e-04 per=1.3e+01 cost=6.5e+04 flops=3.5e+08
 sigma[gemm] counter=127 i=6 t=1.6e-04 per=1.1e+01 cost=4.7e+04 flops=3.0e+08
 sigma[gemm] counter=127 i=7 t=1.5e-04 per=1.1e+01 cost=5.2e+04 flops=3.5e+08
 sigma[gemm] counter=127 total t=6.8e-04 per=4.8e+01 cost=2.3e+05 flops=3.4e+08
 sigma[red] counter=127 t=5.7e-04 per=4.0e+01 cost=6.3e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.3e-02 t_reduction=7.7e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=127 t=1.6e-02 per=9.1e+00 cost=4.0e+07 flops=2.5e+09
 sigma_tot[gemm] counter=127 i=0 t=2.9e-04 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=3 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=4 t=1.9e-02 per=1.1e+01 cost=8.5e+06 flops=4.4e+08
 sigma_tot[gemm] counter=127 i=5 t=2.1e-02 per=1.2e+01 cost=8.6e+06 flops=4.0e+08
 sigma_tot[gemm] counter=127 i=6 t=2.0e-02 per=1.2e+01 cost=8.2e+06 flops=4.0e+08
 sigma_tot[gemm] counter=127 i=7 t=2.0e-02 per=1.2e+01 cost=8.3e+06 flops=4.1e+08
 sigma_tot[gemm] counter=127 total t=8.3e-02 per=4.7e+01 cost=3.4e+07 flops=4.1e+08
 sigma_tot[red] counter=127 t=7.7e-02 per=4.4e+01 cost=8.2e+06 flops=1.1e+08
T(sub)=8.4e-06 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,2.8e-06,9.1e-07,1.4e-06,2.7e-07
settings: ndim=101 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.317262557765 -1.116e+03  4.006e-02    1     1  1.773e-03 1.773e-03 1.747e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.660e-05,1.651e-04,8.272e-04,6.109e-04,1.674e-03
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=2.250e-05 speed=6.689e-02GB/S T(nccl)=4.410e-05 speed=3.413e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.3e-04 t_reduction=6.1e-04 tot=1.6e-03 -----
 sigma[inter] counter=128 t=1.7e-04 per=1.0e+01 cost=3.5e+05 flops=2.1e+09
 sigma[gemm] counter=128 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=4 t=2.2e-04 per=1.4e+01 cost=6.8e+04 flops=3.1e+08
 sigma[gemm] counter=128 i=5 t=2.2e-04 per=1.4e+01 cost=6.5e+04 flops=2.9e+08
 sigma[gemm] counter=128 i=6 t=1.9e-04 per=1.2e+01 cost=4.7e+04 flops=2.5e+08
 sigma[gemm] counter=128 i=7 t=1.9e-04 per=1.2e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=128 total t=8.3e-04 per=5.2e+01 cost=2.3e+05 flops=2.8e+08
 sigma[red] counter=128 t=6.1e-04 per=3.8e+01 cost=6.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.3e-02 t_reduction=7.8e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=128 t=1.6e-02 per=9.2e+00 cost=4.0e+07 flops=2.5e+09
 sigma_tot[gemm] counter=128 i=0 t=2.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=3 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=4 t=1.9e-02 per=1.1e+01 cost=8.6e+06 flops=4.4e+08
 sigma_tot[gemm] counter=128 i=5 t=2.2e-02 per=1.2e+01 cost=8.6e+06 flops=4.0e+08
 sigma_tot[gemm] counter=128 i=6 t=2.1e-02 per=1.2e+01 cost=8.2e+06 flops=4.0e+08
 sigma_tot[gemm] counter=128 i=7 t=2.1e-02 per=1.2e+01 cost=8.3e+06 flops=4.0e+08
 sigma_tot[gemm] counter=128 total t=8.3e-02 per=4.7e+01 cost=3.4e+07 flops=4.1e+08
 sigma_tot[red] counter=128 t=7.8e-02 per=4.4e+01 cost=8.3e+06 flops=1.1e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.2e-05,2.9e-06,1.4e-06,2.7e-07
    2   0 -    -116.323091101205 -5.829e-03  1.019e-02    2     2  3.794e-03 1.897e-03 1.835e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.500e-05,1.624e-04,8.170e-04,6.093e-04,1.658e-03
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=2.177e-05 speed=6.914e-02GB/S T(nccl)=4.323e-05 speed=3.481e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.2e-04 t_reduction=6.1e-04 tot=1.6e-03 -----
 sigma[inter] counter=129 t=1.6e-04 per=1.0e+01 cost=3.5e+05 flops=2.2e+09
 sigma[gemm] counter=129 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=4 t=2.1e-04 per=1.3e+01 cost=6.8e+04 flops=3.2e+08
 sigma[gemm] counter=129 i=5 t=2.2e-04 per=1.4e+01 cost=6.5e+04 flops=2.9e+08
 sigma[gemm] counter=129 i=6 t=1.9e-04 per=1.2e+01 cost=4.7e+04 flops=2.5e+08
 sigma[gemm] counter=129 i=7 t=1.9e-04 per=1.2e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=129 total t=8.2e-04 per=5.1e+01 cost=2.3e+05 flops=2.8e+08
 sigma[red] counter=129 t=6.1e-04 per=3.8e+01 cost=6.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.4e-02 t_reduction=7.8e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=129 t=1.6e-02 per=9.2e+00 cost=4.1e+07 flops=2.5e+09
 sigma_tot[gemm] counter=129 i=0 t=2.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=3 t=2.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=4 t=2.0e-02 per=1.1e+01 cost=8.7e+06 flops=4.4e+08
 sigma_tot[gemm] counter=129 i=5 t=2.2e-02 per=1.2e+01 cost=8.7e+06 flops=4.0e+08
 sigma_tot[gemm] counter=129 i=6 t=2.1e-02 per=1.2e+01 cost=8.3e+06 flops=4.0e+08
 sigma_tot[gemm] counter=129 i=7 t=2.1e-02 per=1.2e+01 cost=8.4e+06 flops=4.0e+08
 sigma_tot[gemm] counter=129 total t=8.4e-02 per=4.7e+01 cost=3.4e+07 flops=4.0e+08
 sigma_tot[red] counter=129 t=7.8e-02 per=4.4e+01 cost=8.3e+06 flops=1.1e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.4e-05,2.0e-06,1.4e-06,2.6e-07
    3   0 -    -116.323357526302 -2.664e-04  3.036e-03    3     3  5.658e-03 1.886e-03 1.830e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.466e-05,1.617e-04,8.145e-04,6.153e-04,1.660e-03
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=2.175e-05 speed=6.919e-02GB/S T(nccl)=4.290e-05 speed=3.508e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.1e-04 t_reduction=6.2e-04 tot=1.6e-03 -----
 sigma[inter] counter=130 t=1.6e-04 per=1.0e+01 cost=3.5e+05 flops=2.2e+09
 sigma[gemm] counter=130 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=4 t=2.1e-04 per=1.3e+01 cost=6.8e+04 flops=3.2e+08
 sigma[gemm] counter=130 i=5 t=2.2e-04 per=1.4e+01 cost=6.5e+04 flops=2.9e+08
 sigma[gemm] counter=130 i=6 t=1.9e-04 per=1.2e+01 cost=4.7e+04 flops=2.5e+08
 sigma[gemm] counter=130 i=7 t=1.8e-04 per=1.2e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=130 total t=8.1e-04 per=5.1e+01 cost=2.3e+05 flops=2.8e+08
 sigma[red] counter=130 t=6.2e-04 per=3.9e+01 cost=6.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.5e-02 t_reduction=7.9e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=130 t=1.7e-02 per=9.2e+00 cost=4.1e+07 flops=2.5e+09
 sigma_tot[gemm] counter=130 i=0 t=3.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=3 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=4 t=2.0e-02 per=1.1e+01 cost=8.7e+06 flops=4.4e+08
 sigma_tot[gemm] counter=130 i=5 t=2.2e-02 per=1.2e+01 cost=8.8e+06 flops=4.0e+08
 sigma_tot[gemm] counter=130 i=6 t=2.1e-02 per=1.2e+01 cost=8.3e+06 flops=4.0e+08
 sigma_tot[gemm] counter=130 i=7 t=2.1e-02 per=1.2e+01 cost=8.4e+06 flops=4.0e+08
 sigma_tot[gemm] counter=130 total t=8.5e-02 per=4.7e+01 cost=3.4e+07 flops=4.0e+08
 sigma_tot[red] counter=130 t=7.9e-02 per=4.4e+01 cost=8.4e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,1.9e-06,1.4e-06,2.5e-07
    4   0 -    -116.323385101891 -2.758e-05  1.279e-03    3     4  7.457e-03 1.864e-03 1.812e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.419e-05,1.641e-04,8.125e-04,6.233e-04,1.668e-03
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=2.086e-05 speed=7.215e-02GB/S T(nccl)=4.333e-05 speed=3.473e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.1e-04 t_reduction=6.2e-04 tot=1.6e-03 -----
 sigma[inter] counter=131 t=1.6e-04 per=1.0e+01 cost=3.5e+05 flops=2.1e+09
 sigma[gemm] counter=131 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=4 t=2.1e-04 per=1.3e+01 cost=6.8e+04 flops=3.3e+08
 sigma[gemm] counter=131 i=5 t=2.2e-04 per=1.4e+01 cost=6.5e+04 flops=3.0e+08
 sigma[gemm] counter=131 i=6 t=1.9e-04 per=1.2e+01 cost=4.7e+04 flops=2.4e+08
 sigma[gemm] counter=131 i=7 t=1.9e-04 per=1.2e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=131 total t=8.1e-04 per=5.1e+01 cost=2.3e+05 flops=2.9e+08
 sigma[red] counter=131 t=6.2e-04 per=3.9e+01 cost=6.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.6e-02 t_reduction=8.0e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=131 t=1.7e-02 per=9.2e+00 cost=4.1e+07 flops=2.5e+09
 sigma_tot[gemm] counter=131 i=0 t=3.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=3 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=4 t=2.0e-02 per=1.1e+01 cost=8.8e+06 flops=4.4e+08
 sigma_tot[gemm] counter=131 i=5 t=2.2e-02 per=1.2e+01 cost=8.8e+06 flops=4.0e+08
 sigma_tot[gemm] counter=131 i=6 t=2.1e-02 per=1.2e+01 cost=8.4e+06 flops=3.9e+08
 sigma_tot[gemm] counter=131 i=7 t=2.1e-02 per=1.2e+01 cost=8.5e+06 flops=4.0e+08
 sigma_tot[gemm] counter=131 total t=8.6e-02 per=4.7e+01 cost=3.5e+07 flops=4.0e+08
 sigma_tot[red] counter=131 t=8.0e-02 per=4.4e+01 cost=8.5e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.1e-05,1.9e-06,1.5e-06,2.2e-07
    5   0 -    -116.323388886296 -3.784e-06  3.463e-04    3     5  9.273e-03 1.855e-03 1.804e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.528e-05,1.633e-04,8.500e-04,6.096e-04,1.692e-03
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=2.159e-05 speed=6.972e-02GB/S T(nccl)=4.369e-05 speed=3.445e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.5e-04 t_reduction=6.1e-04 tot=1.6e-03 -----
 sigma[inter] counter=132 t=1.6e-04 per=1.0e+01 cost=3.5e+05 flops=2.1e+09
 sigma[gemm] counter=132 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=4 t=2.2e-04 per=1.3e+01 cost=6.8e+04 flops=3.1e+08
 sigma[gemm] counter=132 i=5 t=2.3e-04 per=1.4e+01 cost=6.5e+04 flops=2.8e+08
 sigma[gemm] counter=132 i=6 t=2.0e-04 per=1.2e+01 cost=4.7e+04 flops=2.3e+08
 sigma[gemm] counter=132 i=7 t=1.9e-04 per=1.2e+01 cost=5.2e+04 flops=2.7e+08
 sigma[gemm] counter=132 total t=8.5e-04 per=5.2e+01 cost=2.3e+05 flops=2.7e+08
 sigma[red] counter=132 t=6.1e-04 per=3.8e+01 cost=6.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.7e-02 t_reduction=8.0e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=132 t=1.7e-02 per=9.2e+00 cost=4.2e+07 flops=2.5e+09
 sigma_tot[gemm] counter=132 i=0 t=3.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=3 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=4 t=2.0e-02 per=1.1e+01 cost=8.9e+06 flops=4.4e+08
 sigma_tot[gemm] counter=132 i=5 t=2.3e-02 per=1.2e+01 cost=8.9e+06 flops=3.9e+08
 sigma_tot[gemm] counter=132 i=6 t=2.1e-02 per=1.2e+01 cost=8.4e+06 flops=3.9e+08
 sigma_tot[gemm] counter=132 i=7 t=2.1e-02 per=1.2e+01 cost=8.5e+06 flops=4.0e+08
 sigma_tot[gemm] counter=132 total t=8.7e-02 per=4.7e+01 cost=3.5e+07 flops=4.0e+08
 sigma_tot[red] counter=132 t=8.0e-02 per=4.4e+01 cost=8.5e+06 flops=1.1e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.7e-05,2.0e-06,1.6e-06,2.1e-07
    6   0 -    -116.323389262986 -3.767e-07  1.551e-04    3     6  1.124e-02 1.874e-03 1.818e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.730e-05,1.647e-04,8.144e-04,6.087e-04,1.659e-03
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=2.294e-05 speed=6.561e-02GB/S T(nccl)=4.436e-05 speed=3.393e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.1e-04 t_reduction=6.1e-04 tot=1.6e-03 -----
 sigma[inter] counter=133 t=1.6e-04 per=1.0e+01 cost=3.5e+05 flops=2.1e+09
 sigma[gemm] counter=133 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=3 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=4 t=2.1e-04 per=1.3e+01 cost=6.8e+04 flops=3.2e+08
 sigma[gemm] counter=133 i=5 t=2.2e-04 per=1.4e+01 cost=6.5e+04 flops=3.0e+08
 sigma[gemm] counter=133 i=6 t=1.9e-04 per=1.2e+01 cost=4.7e+04 flops=2.5e+08
 sigma[gemm] counter=133 i=7 t=1.9e-04 per=1.2e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=133 total t=8.1e-04 per=5.1e+01 cost=2.3e+05 flops=2.8e+08
 sigma[red] counter=133 t=6.1e-04 per=3.8e+01 cost=6.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.8e-02 t_reduction=8.1e-02 tot=1.9e-01 -----
 sigma_tot[inter] counter=133 t=1.7e-02 per=9.2e+00 cost=4.2e+07 flops=2.5e+09
 sigma_tot[gemm] counter=133 i=0 t=3.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=3 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=4 t=2.1e-02 per=1.1e+01 cost=9.0e+06 flops=4.4e+08
 sigma_tot[gemm] counter=133 i=5 t=2.3e-02 per=1.2e+01 cost=9.0e+06 flops=3.9e+08
 sigma_tot[gemm] counter=133 i=6 t=2.2e-02 per=1.2e+01 cost=8.5e+06 flops=3.9e+08
 sigma_tot[gemm] counter=133 i=7 t=2.1e-02 per=1.2e+01 cost=8.6e+06 flops=4.0e+08
 sigma_tot[gemm] counter=133 total t=8.8e-02 per=4.7e+01 cost=3.5e+07 flops=4.0e+08
 sigma_tot[red] counter=133 t=8.1e-02 per=4.4e+01 cost=8.6e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.2e-05,2.0e-06,1.2e-06,2.3e-07
    7   0 +    -116.323389329774 -6.679e-08  5.925e-05    3     7  1.313e-02 1.876e-03 1.822e-03
TIMING FOR Davidson : 1.314e-02  T(cal/comm/rest)=1.275e-02,1.734e-06,3.880e-04
decomposed t_rest=3.880e-04
 T(sub)    =1.376e-04 per=3.546e+01
 T(precond)=1.843e-05 per=4.748e+00
 T(ortho)  =9.300e-06 per=2.397e+00
 T(xcopy)  =9.630e-07 per=2.482e-01
 T(xnrm2)  =1.320e-06 per=3.402e-01
 T(other)  =2.204e-04 per=5.681e+01
optimized energies: isweep=0 ibond=21 dots=2 e[0]=-116.323389329774 nmvp=7
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=7.095e-04 change=2.020e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=11 dimAll=40
 (6,2):4 (7,3):9 (6,4):3 (5,3):1 (8,2):7 (9,3):4 (8,4):5 (10,2):1 (7,1):3 (7,5):2 (9,1):1
timing for divide=7.0e-06
timing for compute=4.8e-05
timing for collect=4.1e-06
----- TMING FOR decimation_genbasis(su2): 5.9e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.0e-06,4.5e-05,0.0e+00,2.2e-06,4.1e-06 -----
decimation summary: 40->10 dwt=+4.290e-04 SvN=5.600e-01
 qbond: qkept nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (10,2):1 (9,1):1
----- TIMING for decimation_row(nkr): 9.450e-04 S T(decim/select/formRot)=7.982e-05,8.501e-04,1.507e-05 -----
----- TIMING FOR twodot_decimation: 1.037e-03 S T(wf/decim)=7.595e-05,9.606e-04 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:6 S:7 H:1 A:17 B:22 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1006:7.675e-03MB:7.495e-06GB
        per(mem): C:13.1 S:15.3 H:1.99 A:10.5 B:59 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=7.095e-04 change=1.489e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=46 : 6.029e-05 S -----
rank=0 GPUmem(GB): used=4.085e-05 (oper)=2.135e-05
rank=0 GPUmem(GB): used=4.120e-05 (oper,site)=2.135e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=46
 no. of rintermediate operators=5
 no. of coefficients=39:2.975e-04MB:2.906e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.105e-05 S -----
rank=0 GPUmem(GB): used=4.149e-05 (oper,site,rinter)=2.135e-05,3.502e-07,2.906e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 8.067e-04 S size(rtasks)=46 size(Rlst2)=36 T(Rmu/Rlist)=3.828e-05,7.683e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.884e-04 S size(rtasks)=46 size(Rlst)=661 -----
rank=0 GPUmem(GB): used=4.149e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.379e-04 blksize=9 blksize0=9 batchsize=661
rank=0 GPUmem(GB): used=1.794e-04 (oper,site,rinter,batch)=2.135e-05,3.502e-07,2.906e-07,1.379e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.162e-04,4.804e-04,1.930e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=4.8e-04 t_reduction=1.9e-04 tot=7.9e-04 -----
 renorm[inter] counter=252 t=1.2e-04 per=1.5e+01 cost=6.7e+03 flops=5.8e+07
 renorm[gemm] counter=252 i=0 t=2.1e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=252 i=1 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=252 i=2 t=1.4e-04 per=1.8e+01 cost=2.4e+03 flops=1.6e+07
 renorm[gemm] counter=252 i=3 t=1.8e-04 per=2.2e+01 cost=7.9e+03 flops=4.5e+07
 renorm[gemm] counter=252 i=4 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=252 i=5 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=252 i=6 t=1.5e-04 per=1.9e+01 cost=9.1e+03 flops=6.0e+07
 renorm[gemm] counter=252 total t=4.8e-04 per=6.1e+01 cost=1.9e+04 flops=4.0e+07
 renorm[red] counter=252 t=1.9e-04 per=2.4e+01 cost=4.2e+03 flops=2.2e+07
----- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=9.3e-03 t_reduction=3.6e-03 tot=1.5e-02 -----
 renorm_tot[inter] counter=252 t=2.1e-03 per=1.4e+01 cost=3.8e+05 flops=1.8e+08
 renorm_tot[gemm] counter=252 i=0 t=4.8e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=252 i=1 t=4.2e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=252 i=2 t=8.2e-04 per=5.4e+00 cost=7.3e+03 flops=8.9e+06
 renorm_tot[gemm] counter=252 i=3 t=9.2e-04 per=6.1e+00 cost=2.1e+04 flops=2.3e+07
 renorm_tot[gemm] counter=252 i=4 t=2.2e-03 per=1.4e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=252 i=5 t=2.3e-03 per=1.5e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=252 i=6 t=3.0e-03 per=2.0e+01 cost=4.8e+05 flops=1.6e+08
 renorm_tot[gemm] counter=252 total t=9.3e-03 per=6.2e+01 cost=8.0e+05 flops=8.6e+07
 renorm_tot[red] counter=252 t=3.6e-03 per=2.4e+01 cost=2.1e+05 flops=5.9e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.668e-05 (oper)=2.152e-05
rank=0 GPUmem(GB): used=4.703e-05 (oper,site,rinter)=2.152e-05,3.502e-07,5.372e-06
rank=0 GPUmem(GB): used=6.810e-05 (oper,site,rinter,batch)=2.152e-05,3.502e-07,5.372e-06,2.107e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 8.599e-03 S T(preprocess/alloc/comp/red/dealloc)=2.129e-03,2.162e-03,6.033e-03,2.687e-04,1.098e-04 -----
----- TIMING FOR oper_renorm_opS : 8.645e-03 S rank=0 -----
qops.to_cpu: size(tot)=1006:7.675e-03MB:7.495e-06GB T(to_cpu)=2.898e-05S speed=2.586e-01GB/S
check ||H-H.dagger||=1.443e-14 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0113 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=2.113e-03 change=1.814e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=2.113e-03 change=-1.163e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=2.113e-03 change=-4.545e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 5.027e-02 S #####
 T(local opt: fetch) = 2.530e-03 S  per = 5.03  per(accum) = 5.03
 T(local opt: hdiag) = 2.258e-03 S  per = 4.49  per(accum) = 9.52
 T(local opt: dvdsn) = 3.040e-02 S  per = 60.5  per(accum) = 70
 T(local opt: decim) = 1.065e-03 S  per = 2.12  per(accum) = 72.1
 T(local opt: guess) = 9.852e-05 S  per = 0.196  per(accum) = 72.3
 T(local opt: renrm) = 1.211e-02 S  per = 24.1  per(accum) = 96.4
 T(local opt: save ) = 1.813e-03 S  per = 3.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.040e-02 S  T(sum) = 3.011e-02 S  per = 9.902e+01
 T(local opt: preprocess                  ) = 3.381e-04 S  per = 1.12  per(accum) = 1.12
 T(local opt: symbolic_formulae           ) = 4.575e-04 S  per = 1.52  per(accum) = 2.64
 T(local opt: hintermediate init          ) = 7.460e-05 S  per = 0.248  per(accum) = 2.89
 T(local opt: preprocess_hformulae_Hxlist ) = 1.342e-02 S  per = 44.6  per(accum) = 47.5
 T(local opt: hmmtasks init               ) = 2.543e-03 S  per = 8.45  per(accum) = 55.9
 T(local opt: initial guess for dvdson    ) = 1.330e-04 S  per = 0.442  per(accum) = 56.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.229e-02 S  per = 40.8  per(accum) = 97.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.538e-04 S  per = 0.511  per(accum) = 97.7
 T(local opt: dvdson [nccl]               ) = 3.110e-04 S  per = 1.03  per(accum) = 98.7
 T(local opt: dvdson [mpi]                ) = 1.734e-06 S  per = 0.00576  per(accum) = 98.7
 T(local opt: dvdson [rest part(linalg)]  ) = 3.880e-04 S  per = 1.29  per(accum) = 100
Detailed decomposition of T(renrm) = 1.211e-02 S  T(sum) = 1.211e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.063e-05 S  per = 0.418  per(accum) = 0.418
 T(local opt: qops init                    ) = 3.530e-04 S  per = 2.92  per(accum) = 3.33
 T(local opt: symbolic_formulae_renorm     ) = 6.459e-05 S  per = 0.533  per(accum) = 3.87
 T(local opt: allocate qops on gpu         ) = 5.297e-05 S  per = 0.438  per(accum) = 4.31
 T(local opt: site memcpy cpu2gpu          ) = 1.976e-05 S  per = 0.163  per(accum) = 4.47
 T(local opt: rintermediate init           ) = 2.771e-05 S  per = 0.229  per(accum) = 4.7
 T(local opt: preprocess_formulae_Rlist2   ) = 8.934e-04 S  per = 7.38  per(accum) = 12.1
 T(local opt: rmmtasks init                ) = 2.673e-04 S  per = 2.21  per(accum) = 14.3
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 0.00024  per(accum) = 14.3
 T(local opt: preprocess_renorm_batchGPU   ) = 8.816e-04 S  per = 7.28  per(accum) = 21.6
 T(local opt: deallocate cpu and gpu memory) = 2.674e-05 S  per = 0.221  per(accum) = 21.8
 T(local opt: construct opS [ifdists=true] ) = 8.658e-03 S  per = 71.5  per(accum) = 93.3
 T(local opt: reduction of opS & opH [nccl]) = 2.009e-05 S  per = 0.166  per(accum) = 93.5
 T(local opt: qops memcpy gpu2cpu          ) = 3.851e-05 S  per = 0.318  per(accum) = 93.8
 T(local opt: reduction of opS & opH [mpi] ) = 4.394e-05 S  per = 0.363  per(accum) = 94.1
 T(local opt: qops_pool join and erase     ) = 7.052e-04 S  per = 5.83  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.271e-06 S  per = 0.027  per(accum) = 100
ctns::rcanon_save_site idx=5 scratch=./scratch/sweep size=47:3.5e-07GB T(load)=0.00059S speed=0.00059GB/S
##### sweep opt: 9.493e-01 S #####
 T(sweep opt: fetch) = 5.511e-02 S  per = 5.81  per(accum) = 5.81
 T(sweep opt: hdiag) = 4.525e-02 S  per = 4.77  per(accum) = 10.6
 T(sweep opt: dvdsn) = 5.813e-01 S  per = 61.2  per(accum) = 71.8
 T(sweep opt: decim) = 2.438e-02 S  per = 2.57  per(accum) = 74.4
 T(sweep opt: guess) = 1.928e-03 S  per = 0.203  per(accum) = 74.6
 T(sweep opt: renrm) = 2.011e-01 S  per = 21.2  per(accum) = 95.8
 T(sweep opt: save ) = 4.024e-02 S  per = 4.24  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.813e-01 S  T(sum) = 5.725e-01 S  per = 9.848e+01
 T(sweep opt: preprocess                  ) = 6.905e-03 S  per = 1.21  per(accum) = 1.21
 T(sweep opt: symbolic_formulae           ) = 9.536e-03 S  per = 1.67  per(accum) = 2.87
 T(sweep opt: hintermediate init          ) = 1.472e-03 S  per = 0.257  per(accum) = 3.13
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.676e-01 S  per = 46.7  per(accum) = 49.9
 T(sweep opt: hmmtasks init               ) = 5.227e-02 S  per = 9.13  per(accum) = 59
 T(sweep opt: initial guess for dvdson    ) = 3.067e-03 S  per = 0.536  per(accum) = 59.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.140e-01 S  per = 37.4  per(accum) = 96.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.982e-03 S  per = 0.521  per(accum) = 97.4
 T(sweep opt: dvdson [nccl]               ) = 7.385e-03 S  per = 1.29  per(accum) = 98.7
 T(sweep opt: dvdson [mpi]                ) = 6.797e-05 S  per = 0.0119  per(accum) = 98.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.260e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm) = 2.011e-01 S  T(sum) = 2.011e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.166e-03 S  per = 0.58  per(accum) = 0.58
 T(sweep opt: qops init                    ) = 7.322e-03 S  per = 3.64  per(accum) = 4.22
 T(sweep opt: symbolic_formulae_renorm     ) = 3.285e-03 S  per = 1.63  per(accum) = 5.85
 T(sweep opt: allocate qops on gpu         ) = 1.235e-03 S  per = 0.614  per(accum) = 6.47
 T(sweep opt: site memcpy cpu2gpu          ) = 5.520e-04 S  per = 0.275  per(accum) = 6.74
 T(sweep opt: rintermediate init           ) = 9.848e-04 S  per = 0.49  per(accum) = 7.23
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.528e-02 S  per = 12.6  per(accum) = 19.8
 T(sweep opt: rmmtasks init                ) = 8.042e-03 S  per =    4  per(accum) = 23.8
 T(sweep opt: qops memset on cpu           ) = 1.050e-06 S  per = 0.000522  per(accum) = 23.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.799e-02 S  per = 8.95  per(accum) = 32.8
 T(sweep opt: deallocate cpu and gpu memory) = 6.372e-04 S  per = 0.317  per(accum) = 33.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.145e-01 S  per =   57  per(accum) = 90
 T(sweep opt: reduction of opS & opH [nccl]) = 4.158e-04 S  per = 0.207  per(accum) = 90.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.504e-04 S  per = 0.373  per(accum) = 90.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.318e-04 S  per = 0.165  per(accum) = 90.8
 T(sweep opt: qops_pool join and erase     ) = 1.574e-02 S  per = 7.83  per(accum) = 98.6
 T(sweep opt: conversion from opAB to opPQ ) = 2.802e-03 S  per = 1.39  per(accum) = 100
##### global opt: 9.493e-01 S #####
 T(global opt: fetch) = 5.511e-02 S  per = 5.81  per(accum) = 5.81
 T(global opt: hdiag) = 4.525e-02 S  per = 4.77  per(accum) = 10.6
 T(global opt: dvdsn) = 5.813e-01 S  per = 61.2  per(accum) = 71.8
 T(global opt: decim) = 2.438e-02 S  per = 2.57  per(accum) = 74.4
 T(global opt: guess) = 1.928e-03 S  per = 0.203  per(accum) = 74.6
 T(global opt: renrm) = 2.011e-01 S  per = 21.2  per(accum) = 95.8
 T(global opt: save ) = 4.024e-02 S  per = 4.24  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.813e-01 S  T(sum) = 5.725e-01 S  per = 9.848e+01
 T(global opt: preprocess                  ) = 6.905e-03 S  per = 1.21  per(accum) = 1.21
 T(global opt: symbolic_formulae           ) = 9.536e-03 S  per = 1.67  per(accum) = 2.87
 T(global opt: hintermediate init          ) = 1.472e-03 S  per = 0.257  per(accum) = 3.13
 T(global opt: preprocess_hformulae_Hxlist ) = 2.676e-01 S  per = 46.7  per(accum) = 49.9
 T(global opt: hmmtasks init               ) = 5.227e-02 S  per = 9.13  per(accum) = 59
 T(global opt: initial guess for dvdson    ) = 3.067e-03 S  per = 0.536  per(accum) = 59.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.140e-01 S  per = 37.4  per(accum) = 96.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.982e-03 S  per = 0.521  per(accum) = 97.4
 T(global opt: dvdson [nccl]               ) = 7.385e-03 S  per = 1.29  per(accum) = 98.7
 T(global opt: dvdson [mpi]                ) = 6.797e-05 S  per = 0.0119  per(accum) = 98.7
 T(global opt: dvdson [rest part(linalg)]  ) = 7.260e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm) = 2.011e-01 S  T(sum) = 2.011e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.166e-03 S  per = 0.58  per(accum) = 0.58
 T(global opt: qops init                    ) = 7.322e-03 S  per = 3.64  per(accum) = 4.22
 T(global opt: symbolic_formulae_renorm     ) = 3.285e-03 S  per = 1.63  per(accum) = 5.85
 T(global opt: allocate qops on gpu         ) = 1.235e-03 S  per = 0.614  per(accum) = 6.47
 T(global opt: site memcpy cpu2gpu          ) = 5.520e-04 S  per = 0.275  per(accum) = 6.74
 T(global opt: rintermediate init           ) = 9.848e-04 S  per = 0.49  per(accum) = 7.23
 T(global opt: preprocess_formulae_Rlist2   ) = 2.528e-02 S  per = 12.6  per(accum) = 19.8
 T(global opt: rmmtasks init                ) = 8.042e-03 S  per =    4  per(accum) = 23.8
 T(global opt: qops memset on cpu           ) = 1.050e-06 S  per = 0.000522  per(accum) = 23.8
 T(global opt: preprocess_renorm_batchGPU   ) = 1.799e-02 S  per = 8.95  per(accum) = 32.8
 T(global opt: deallocate cpu and gpu memory) = 6.372e-04 S  per = 0.317  per(accum) = 33.1
 T(global opt: construct opS [ifdists=true] ) = 1.145e-01 S  per =   57  per(accum) = 90
 T(global opt: reduction of opS & opH [nccl]) = 4.158e-04 S  per = 0.207  per(accum) = 90.2
 T(global opt: qops memcpy gpu2cpu          ) = 7.504e-04 S  per = 0.373  per(accum) = 90.6
 T(global opt: reduction of opS & opH [mpi] ) = 3.318e-04 S  per = 0.165  per(accum) = 90.8
 T(global opt: qops_pool join and erase     ) = 1.574e-02 S  per = 7.83  per(accum) = 98.6
 T(global opt: conversion from opAB to opPQ ) = 2.802e-03 S  per = 1.39  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-2.029e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=22/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=7 scratch=./scratch/sweep size=48:3.58e-07GB T(load)=3.04e-04S speed=1.18e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=83:6.33e-04MB:6.18e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=52:3.97e-04MB:3.87e-07GB
total mem of comb=136:1.04e-03MB:1.01e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=5.022e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:12 S:4 H:1 P:28 Q:40 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=2102:1.604e-02MB:1.566e-05GB
        per(mem): C:12 S:4 H:1.43 P:2.66 Q:79.9 
 rqops: oplist=CSHAB nops=C:6 S:7 H:1 A:17 B:22 
        dim(bra,ket)=10,10 size(op)=34:0.000259MB size(tot)=1006:0.00768MB:7.5e-06GB
        per(mem): C:13.1 S:15.3 H:1.99 A:10.5 B:59 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5104:0.0389MB:3.8e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.395e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=117:8.926e-04MB
qtensor4: wf4 own=1 _data=0x5585eeeba400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
 qbond: qcol nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (10,2):1 (9,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=28 nblocks=384 size=117:8.926e-04MB
### DIAG TIMING: total=3.148e-03 t1=2.015e-05, t2=1.970e-05, t3=1.964e-05, t4=3.037e-03, t5=6.881e-06, t6=3.790e-05, t7=6.754e-06
duration_diagGPU:3.165e-03
duration_diagreduce:7.000e-08
duration_diagtransform:4.820e-07
----- TIMING FOR symbolic_formulae_twodot with size=319 : 5.210e-04 S -----
rank=0 GPUmem(GB): used=3.803e-05 (oper)=3.803e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=319
 no. of hintermediate operators=166
 no. of coefficients=1975:1.507e-02MB:1.471e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.869e-05 S -----
rank=0 GPUmem(GB): used=5.274e-05 (oper,hinter)=3.803e-05,1.471e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.543e-02 S size(H_formulae)=319 size(Hxlst2)=28 T(Hmu/Hxlist)=1.350e-04,2.530e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.625e-02 S size(H_formulae)=319 size(Hxlst)=11532 -----
rank=0 GPUmem(GB): used=5.274e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.743e-06 batch[need]=2.921e-03 blksize=12 blksize0=9 batchsize=11532
rank=0 GPUmem(GB): used=2.976e-03 (oper,hinter,dvdson,batch)=3.803e-05,1.471e-05,1.743e-06,2.921e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=117 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.482e-05,1.906e-04,1.080e-03,6.756e-04,2.030e-03
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.267e-05 speed=7.689e-02GB/S T(nccl)=5.214e-05 speed=3.344e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=6.8e-04 tot=1.9e-03 -----
 sigma[inter] counter=134 t=1.9e-04 per=9.8e+00 cost=6.1e+05 flops=3.2e+09
 sigma[gemm] counter=134 i=0 t=2.6e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=3 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=4 t=2.5e-04 per=1.3e+01 cost=9.7e+04 flops=3.9e+08
 sigma[gemm] counter=134 i=5 t=2.6e-04 per=1.3e+01 cost=9.3e+04 flops=3.6e+08
 sigma[gemm] counter=134 i=6 t=2.9e-04 per=1.5e+01 cost=9.1e+04 flops=3.2e+08
 sigma[gemm] counter=134 i=7 t=2.7e-04 per=1.4e+01 cost=9.6e+04 flops=3.6e+08
 sigma[gemm] counter=134 total t=1.1e-03 per=5.5e+01 cost=3.8e+05 flops=3.5e+08
 sigma[red] counter=134 t=6.8e-04 per=3.5e+01 cost=1.0e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.9e-02 t_reduction=8.1e-02 tot=1.9e-01 -----
 sigma_tot[inter] counter=134 t=1.7e-02 per=9.2e+00 cost=4.3e+07 flops=2.5e+09
 sigma_tot[gemm] counter=134 i=0 t=3.0e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=3 t=2.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=4 t=2.1e-02 per=1.1e+01 cost=9.0e+06 flops=4.4e+08
 sigma_tot[gemm] counter=134 i=5 t=2.3e-02 per=1.2e+01 cost=9.1e+06 flops=3.9e+08
 sigma_tot[gemm] counter=134 i=6 t=2.2e-02 per=1.2e+01 cost=8.6e+06 flops=3.9e+08
 sigma_tot[gemm] counter=134 i=7 t=2.2e-02 per=1.2e+01 cost=8.7e+06 flops=4.0e+08
 sigma_tot[gemm] counter=134 total t=8.9e-02 per=4.7e+01 cost=3.5e+07 flops=4.0e+08
 sigma_tot[red] counter=134 t=8.1e-02 per=4.3e+01 cost=8.7e+06 flops=1.1e+08
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,4.0e-06,9.3e-07,1.1e-06,2.3e-07
settings: ndim=117 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323178960724 -1.116e+03  3.577e-02    1     1  2.272e-03 2.272e-03 2.243e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.610e-05,1.882e-04,1.276e-03,7.052e-04,2.240e-03
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.169e-05 speed=8.039e-02GB/S T(nccl)=4.441e-05 speed=3.926e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.3e-03 t_reduction=7.0e-04 tot=2.2e-03 -----
 sigma[inter] counter=135 t=1.9e-04 per=8.7e+00 cost=6.1e+05 flops=3.3e+09
 sigma[gemm] counter=135 i=0 t=2.1e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=2.0e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=3 t=2.0e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=4 t=2.9e-04 per=1.3e+01 cost=9.7e+04 flops=3.4e+08
 sigma[gemm] counter=135 i=5 t=3.2e-04 per=1.5e+01 cost=9.3e+04 flops=2.9e+08
 sigma[gemm] counter=135 i=6 t=3.3e-04 per=1.5e+01 cost=9.1e+04 flops=2.7e+08
 sigma[gemm] counter=135 i=7 t=3.3e-04 per=1.5e+01 cost=9.6e+04 flops=2.9e+08
 sigma[gemm] counter=135 total t=1.3e-03 per=5.9e+01 cost=3.8e+05 flops=3.0e+08
 sigma[red] counter=135 t=7.0e-04 per=3.3e+01 cost=1.0e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=9.0e-02 t_reduction=8.2e-02 tot=1.9e-01 -----
 sigma_tot[inter] counter=135 t=1.7e-02 per=9.2e+00 cost=4.3e+07 flops=2.5e+09
 sigma_tot[gemm] counter=135 i=0 t=3.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=3 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=4 t=2.1e-02 per=1.1e+01 cost=9.1e+06 flops=4.3e+08
 sigma_tot[gemm] counter=135 i=5 t=2.3e-02 per=1.2e+01 cost=9.2e+06 flops=3.9e+08
 sigma_tot[gemm] counter=135 i=6 t=2.2e-02 per=1.2e+01 cost=8.7e+06 flops=3.9e+08
 sigma_tot[gemm] counter=135 i=7 t=2.2e-02 per=1.2e+01 cost=8.8e+06 flops=4.0e+08
 sigma_tot[gemm] counter=135 total t=9.0e-02 per=4.7e+01 cost=3.6e+07 flops=4.0e+08
 sigma_tot[red] counter=135 t=8.2e-02 per=4.3e+01 cost=8.8e+06 flops=1.1e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.7e-05,2.9e-06,1.4e-06,2.5e-07
    2   0 -    -116.327002472094 -3.824e-03  1.195e-02    2     2  4.891e-03 2.446e-03 2.392e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.539e-05,1.819e-04,1.281e-03,7.148e-04,2.248e-03
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.117e-05 speed=8.237e-02GB/S T(nccl)=4.422e-05 speed=3.942e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.3e-03 t_reduction=7.1e-04 tot=2.2e-03 -----
 sigma[inter] counter=136 t=1.8e-04 per=8.4e+00 cost=6.1e+05 flops=3.4e+09
 sigma[gemm] counter=136 i=0 t=2.1e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=3 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=4 t=2.8e-04 per=1.3e+01 cost=9.7e+04 flops=3.4e+08
 sigma[gemm] counter=136 i=5 t=3.0e-04 per=1.4e+01 cost=9.3e+04 flops=3.1e+08
 sigma[gemm] counter=136 i=6 t=3.3e-04 per=1.5e+01 cost=9.1e+04 flops=2.7e+08
 sigma[gemm] counter=136 i=7 t=3.5e-04 per=1.6e+01 cost=9.6e+04 flops=2.7e+08
 sigma[gemm] counter=136 total t=1.3e-03 per=5.9e+01 cost=3.8e+05 flops=2.9e+08
 sigma[red] counter=136 t=7.1e-04 per=3.3e+01 cost=1.0e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=9.1e-02 t_reduction=8.3e-02 tot=1.9e-01 -----
 sigma_tot[inter] counter=136 t=1.8e-02 per=9.2e+00 cost=4.4e+07 flops=2.5e+09
 sigma_tot[gemm] counter=136 i=0 t=3.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=3 t=2.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=4 t=2.1e-02 per=1.1e+01 cost=9.2e+06 flops=4.3e+08
 sigma_tot[gemm] counter=136 i=5 t=2.4e-02 per=1.2e+01 cost=9.2e+06 flops=3.9e+08
 sigma_tot[gemm] counter=136 i=6 t=2.3e-02 per=1.2e+01 cost=8.7e+06 flops=3.9e+08
 sigma_tot[gemm] counter=136 i=7 t=2.2e-02 per=1.2e+01 cost=8.9e+06 flops=4.0e+08
 sigma_tot[gemm] counter=136 total t=9.1e-02 per=4.8e+01 cost=3.6e+07 flops=4.0e+08
 sigma_tot[red] counter=136 t=8.3e-02 per=4.3e+01 cost=8.9e+06 flops=1.1e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.6e-05,2.2e-06,1.4e-06,1.9e-07
    3   0 -    -116.327419414968 -4.169e-04  4.801e-03    3     3  7.397e-03 2.466e-03 2.409e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.541e-05,1.748e-04,1.254e-03,6.970e-04,2.195e-03
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.082e-05 speed=8.375e-02GB/S T(nccl)=4.460e-05 speed=3.909e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.3e-03 t_reduction=7.0e-04 tot=2.1e-03 -----
 sigma[inter] counter=137 t=1.7e-04 per=8.2e+00 cost=6.1e+05 flops=3.5e+09
 sigma[gemm] counter=137 i=0 t=2.0e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=1.9e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=1.9e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=3 t=1.9e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=4 t=2.8e-04 per=1.3e+01 cost=9.7e+04 flops=3.4e+08
 sigma[gemm] counter=137 i=5 t=3.0e-04 per=1.4e+01 cost=9.3e+04 flops=3.1e+08
 sigma[gemm] counter=137 i=6 t=3.3e-04 per=1.6e+01 cost=9.1e+04 flops=2.7e+08
 sigma[gemm] counter=137 i=7 t=3.3e-04 per=1.5e+01 cost=9.6e+04 flops=2.9e+08
 sigma[gemm] counter=137 total t=1.3e-03 per=5.9e+01 cost=3.8e+05 flops=3.0e+08
 sigma[red] counter=137 t=7.0e-04 per=3.3e+01 cost=1.0e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=9.2e-02 t_reduction=8.4e-02 tot=1.9e-01 -----
 sigma_tot[inter] counter=137 t=1.8e-02 per=9.2e+00 cost=4.4e+07 flops=2.5e+09
 sigma_tot[gemm] counter=137 i=0 t=3.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=2.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=3 t=2.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=4 t=2.2e-02 per=1.1e+01 cost=9.3e+06 flops=4.3e+08
 sigma_tot[gemm] counter=137 i=5 t=2.4e-02 per=1.2e+01 cost=9.3e+06 flops=3.9e+08
 sigma_tot[gemm] counter=137 i=6 t=2.3e-02 per=1.2e+01 cost=8.8e+06 flops=3.9e+08
 sigma_tot[gemm] counter=137 i=7 t=2.3e-02 per=1.2e+01 cost=9.0e+06 flops=3.9e+08
 sigma_tot[gemm] counter=137 total t=9.2e-02 per=4.8e+01 cost=3.6e+07 flops=3.9e+08
 sigma_tot[red] counter=137 t=8.4e-02 per=4.3e+01 cost=9.0e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,2.0e-06,1.4e-06,1.7e-07
    4   0 -    -116.327507432792 -8.802e-05  2.485e-03    3     4  9.835e-03 2.459e-03 2.403e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.559e-05,1.784e-04,1.244e-03,7.028e-04,2.195e-03
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.142e-05 speed=8.139e-02GB/S T(nccl)=4.417e-05 speed=3.947e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.2e-03 t_reduction=7.0e-04 tot=2.1e-03 -----
 sigma[inter] counter=138 t=1.8e-04 per=8.4e+00 cost=6.1e+05 flops=3.4e+09
 sigma[gemm] counter=138 i=0 t=2.0e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=1.9e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=1.9e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=3 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=4 t=2.8e-04 per=1.3e+01 cost=9.7e+04 flops=3.5e+08
 sigma[gemm] counter=138 i=5 t=3.0e-04 per=1.4e+01 cost=9.3e+04 flops=3.1e+08
 sigma[gemm] counter=138 i=6 t=3.3e-04 per=1.6e+01 cost=9.1e+04 flops=2.7e+08
 sigma[gemm] counter=138 i=7 t=3.2e-04 per=1.5e+01 cost=9.6e+04 flops=3.0e+08
 sigma[gemm] counter=138 total t=1.2e-03 per=5.9e+01 cost=3.8e+05 flops=3.0e+08
 sigma[red] counter=138 t=7.0e-04 per=3.3e+01 cost=1.0e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=9.4e-02 t_reduction=8.4e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=138 t=1.8e-02 per=9.2e+00 cost=4.5e+07 flops=2.5e+09
 sigma_tot[gemm] counter=138 i=0 t=3.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=2.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=2.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=3 t=2.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=4 t=2.2e-02 per=1.1e+01 cost=9.4e+06 flops=4.3e+08
 sigma_tot[gemm] counter=138 i=5 t=2.4e-02 per=1.2e+01 cost=9.4e+06 flops=3.9e+08
 sigma_tot[gemm] counter=138 i=6 t=2.3e-02 per=1.2e+01 cost=8.9e+06 flops=3.8e+08
 sigma_tot[gemm] counter=138 i=7 t=2.3e-02 per=1.2e+01 cost=9.1e+06 flops=3.9e+08
 sigma_tot[gemm] counter=138 total t=9.4e-02 per=4.8e+01 cost=3.7e+07 flops=3.9e+08
 sigma_tot[red] counter=138 t=8.4e-02 per=4.3e+01 cost=9.1e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,2.0e-06,1.3e-06,1.5e-07
    5   0 -    -116.327523715919 -1.628e-05  7.352e-04    3     5  1.229e-02 2.457e-03 2.402e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.429e-05,1.805e-04,1.230e-03,6.977e-04,2.176e-03
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.118e-05 speed=8.232e-02GB/S T(nccl)=4.311e-05 speed=4.044e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.2e-03 t_reduction=7.0e-04 tot=2.1e-03 -----
 sigma[inter] counter=139 t=1.8e-04 per=8.6e+00 cost=6.1e+05 flops=3.4e+09
 sigma[gemm] counter=139 i=0 t=2.0e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=1 t=1.9e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=2 t=1.9e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=3 t=1.9e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=4 t=2.8e-04 per=1.3e+01 cost=9.7e+04 flops=3.5e+08
 sigma[gemm] counter=139 i=5 t=3.0e-04 per=1.4e+01 cost=9.3e+04 flops=3.1e+08
 sigma[gemm] counter=139 i=6 t=3.2e-04 per=1.5e+01 cost=9.1e+04 flops=2.8e+08
 sigma[gemm] counter=139 i=7 t=3.2e-04 per=1.5e+01 cost=9.6e+04 flops=3.0e+08
 sigma[gemm] counter=139 total t=1.2e-03 per=5.8e+01 cost=3.8e+05 flops=3.1e+08
 sigma[red] counter=139 t=7.0e-04 per=3.3e+01 cost=1.0e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=9.5e-02 t_reduction=8.5e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=139 t=1.8e-02 per=9.2e+00 cost=4.6e+07 flops=2.5e+09
 sigma_tot[gemm] counter=139 i=0 t=3.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=1 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=2 t=2.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=3 t=2.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=4 t=2.2e-02 per=1.1e+01 cost=9.5e+06 flops=4.3e+08
 sigma_tot[gemm] counter=139 i=5 t=2.5e-02 per=1.2e+01 cost=9.5e+06 flops=3.9e+08
 sigma_tot[gemm] counter=139 i=6 t=2.4e-02 per=1.2e+01 cost=9.0e+06 flops=3.8e+08
 sigma_tot[gemm] counter=139 i=7 t=2.3e-02 per=1.2e+01 cost=9.2e+06 flops=3.9e+08
 sigma_tot[gemm] counter=139 total t=9.5e-02 per=4.8e+01 cost=3.7e+07 flops=3.9e+08
 sigma_tot[red] counter=139 t=8.5e-02 per=4.3e+01 cost=9.2e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,2.0e-06,1.3e-06,1.5e-07
    6   0 -    -116.327525646041 -1.930e-06  2.496e-04    3     6  1.470e-02 2.449e-03 2.396e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.411e-05,1.802e-04,1.242e-03,7.026e-04,2.193e-03
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.107e-05 speed=8.276e-02GB/S T(nccl)=4.305e-05 speed=4.050e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.2e-03 t_reduction=7.0e-04 tot=2.1e-03 -----
 sigma[inter] counter=140 t=1.8e-04 per=8.5e+00 cost=6.1e+05 flops=3.4e+09
 sigma[gemm] counter=140 i=0 t=2.0e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=1 t=1.9e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=2 t=1.9e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=3 t=1.9e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=4 t=2.8e-04 per=1.3e+01 cost=9.7e+04 flops=3.5e+08
 sigma[gemm] counter=140 i=5 t=3.0e-04 per=1.4e+01 cost=9.3e+04 flops=3.1e+08
 sigma[gemm] counter=140 i=6 t=3.2e-04 per=1.5e+01 cost=9.1e+04 flops=2.8e+08
 sigma[gemm] counter=140 i=7 t=3.3e-04 per=1.6e+01 cost=9.6e+04 flops=2.9e+08
 sigma[gemm] counter=140 total t=1.2e-03 per=5.8e+01 cost=3.8e+05 flops=3.0e+08
 sigma[red] counter=140 t=7.0e-04 per=3.3e+01 cost=1.0e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=9.6e-02 t_reduction=8.6e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=140 t=1.8e-02 per=9.2e+00 cost=4.6e+07 flops=2.5e+09
 sigma_tot[gemm] counter=140 i=0 t=3.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=1 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=2 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=3 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=4 t=2.2e-02 per=1.1e+01 cost=9.6e+06 flops=4.3e+08
 sigma_tot[gemm] counter=140 i=5 t=2.5e-02 per=1.2e+01 cost=9.6e+06 flops=3.9e+08
 sigma_tot[gemm] counter=140 i=6 t=2.4e-02 per=1.2e+01 cost=9.1e+06 flops=3.8e+08
 sigma_tot[gemm] counter=140 i=7 t=2.4e-02 per=1.2e+01 cost=9.3e+06 flops=3.9e+08
 sigma_tot[gemm] counter=140 total t=9.6e-02 per=4.8e+01 cost=3.8e+07 flops=3.9e+08
 sigma_tot[red] counter=140 t=8.6e-02 per=4.3e+01 cost=9.3e+06 flops=1.1e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,1.9e-06,1.3e-06,1.4e-07
    7   0 +    -116.327525813352 -1.673e-07  7.757e-05    3     7  1.713e-02 2.448e-03 2.395e-03
TIMING FOR Davidson : 1.715e-02  T(cal/comm/rest)=1.677e-02,1.776e-06,3.799e-04
decomposed t_rest=3.799e-04
 T(sub)    =1.403e-04 per=3.693e+01
 T(precond)=2.032e-05 per=5.348e+00
 T(ortho)  =9.541e-06 per=2.511e+00
 T(xcopy)  =8.880e-07 per=2.337e-01
 T(xnrm2)  =1.167e-06 per=3.072e-01
 T(other)  =2.077e-04 per=5.467e+01
optimized energies: isweep=0 ibond=22 dots=2 e[0]=-116.327525813352 nmvp=7
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.548e-03 change=2.997e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=12 dimAll=40
 (9,3):8 (8,2):3 (8,4):3 (7,3):1 (10,2):7 (9,1):3 (11,3):4 (10,4):5 (12,2):1 (11,1):2 (9,5):2 (10,0):1
timing for divide=7.8e-06
timing for compute=5.0e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(su2): 6.8e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.8e-06,4.5e-05,0.0e+00,5.2e-06,1.0e-05 -----
decimation summary: 40->10 dwt=+7.384e-04 SvN=7.675e-01
 qbond: qkept nsym=5 dimAll=10
 (10,2):3 (11,3):3 (10,4):2 (9,3):1 (12,2):1
----- TIMING for decimation_row(nkr): 1.077e-03 S T(decim/select/formRot)=1.111e-04,9.424e-04,2.399e-05 -----
----- TIMING FOR twodot_decimation: 1.195e-03 S T(wf/decim)=9.566e-05,1.099e-03 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:7 S:6 H:1 A:23 B:28 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=1321:1.008e-02MB:9.842e-06GB
        per(mem): C:12.2 S:10.4 H:1.82 A:12 B:63.6 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.548e-03 change=1.390e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=59 : 7.771e-05 S -----
rank=0 GPUmem(GB): used=4.692e-05 (oper)=2.477e-05
rank=0 GPUmem(GB): used=4.731e-05 (oper,site)=2.477e-05,3.874e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=59
 no. of rintermediate operators=5
 no. of coefficients=54:4.120e-04MB:4.023e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.580e-05 S -----
rank=0 GPUmem(GB): used=4.771e-05 (oper,site,rinter)=2.477e-05,3.874e-07,4.023e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.048e-03 S size(rtasks)=59 size(Rlst2)=25 T(Rmu/Rlist)=4.279e-05,1.005e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.088e-03 S size(rtasks)=59 size(Rlst)=868 -----
rank=0 GPUmem(GB): used=4.771e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.811e-04 blksize=9 blksize0=9 batchsize=868
rank=0 GPUmem(GB): used=2.288e-04 (oper,site,rinter,batch)=2.477e-05,3.874e-07,4.023e-07,1.811e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.231e-04,6.076e-04,1.908e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=6.1e-04 t_reduction=1.9e-04 tot=9.2e-04 -----
 renorm[inter] counter=267 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 renorm[gemm] counter=267 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=267 i=1 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=267 i=2 t=1.9e-04 per=2.1e+01 cost=2.7e+03 flops=1.4e+07
 renorm[gemm] counter=267 i=3 t=2.1e-04 per=2.3e+01 cost=1.1e+04 flops=5.2e+07
 renorm[gemm] counter=267 i=4 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=267 i=5 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=267 i=6 t=1.9e-04 per=2.1e+01 cost=1.7e+04 flops=8.6e+07
 renorm[gemm] counter=267 total t=6.1e-04 per=6.6e+01 cost=3.1e+04 flops=5.0e+07
 renorm[red] counter=267 t=1.9e-04 per=2.1e+01 cost=8.6e+03 flops=4.5e+07
----- TIMING FOR renorm_tot : t_inter=2.2e-03 t_gemm=9.9e-03 t_reduction=3.8e-03 tot=1.6e-02 -----
 renorm_tot[inter] counter=267 t=2.2e-03 per=1.4e+01 cost=3.9e+05 flops=1.7e+08
 renorm_tot[gemm] counter=267 i=0 t=5.0e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=267 i=1 t=4.4e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=267 i=2 t=1.0e-03 per=6.3e+00 cost=1.0e+04 flops=9.9e+06
 renorm_tot[gemm] counter=267 i=3 t=1.1e-03 per=7.1e+00 cost=3.2e+04 flops=2.8e+07
 renorm_tot[gemm] counter=267 i=4 t=2.2e-03 per=1.4e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=267 i=5 t=2.3e-03 per=1.4e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=267 i=6 t=3.2e-03 per=2.0e+01 cost=4.9e+05 flops=1.5e+08
 renorm_tot[gemm] counter=267 total t=9.9e-03 per=6.2e+01 cost=8.3e+05 flops=8.4e+07
 renorm_tot[red] counter=267 t=3.8e-03 per=2.4e+01 cost=2.2e+05 flops=5.8e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.421e-05 (oper)=2.494e-05
rank=0 GPUmem(GB): used=5.460e-05 (oper,site,rinter)=2.494e-05,3.874e-07,6.713e-06
rank=0 GPUmem(GB): used=7.483e-05 (oper,site,rinter,batch)=2.494e-05,3.874e-07,6.713e-06,2.024e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 8.150e-03 S T(preprocess/alloc/comp/red/dealloc)=1.852e-03,1.910e-03,5.861e-03,2.510e-04,1.050e-04 -----
----- TIMING FOR oper_renorm_opS : 8.183e-03 S rank=0 -----
qops.to_cpu: size(tot)=1321:1.008e-02MB:9.842e-06GB T(to_cpu)=3.169e-05S speed=3.105e-01GB/S
check ||H-H.dagger||=9.342e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0115 S rank=0 -----
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=3.929e-03 change=2.373e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=3.929e-03 change=-1.294e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=3.929e-03 change=-4.172e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 7.149e-02 S #####
 T(local opt: fetch) = 2.540e-03 S  per = 3.55  per(accum) = 3.55
 T(local opt: hdiag) = 3.278e-03 S  per = 4.59  per(accum) = 8.14
 T(local opt: dvdsn) = 5.012e-02 S  per = 70.1  per(accum) = 78.3
 T(local opt: decim) = 1.234e-03 S  per = 1.73  per(accum) = 80
 T(local opt: guess) = 9.409e-05 S  per = 0.132  per(accum) = 80.1
 T(local opt: renrm) = 1.234e-02 S  per = 17.3  per(accum) = 97.4
 T(local opt: save ) = 1.876e-03 S  per = 2.62  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.012e-02 S  T(sum) = 4.949e-02 S  per = 9.874e+01
 T(local opt: preprocess                  ) = 3.954e-04 S  per = 0.799  per(accum) = 0.799
 T(local opt: symbolic_formulae           ) = 5.348e-04 S  per = 1.08  per(accum) = 1.88
 T(local opt: hintermediate init          ) = 7.540e-05 S  per = 0.152  per(accum) = 2.03
 T(local opt: preprocess_hformulae_Hxlist ) = 2.639e-02 S  per = 53.3  per(accum) = 55.4
 T(local opt: hmmtasks init               ) = 4.767e-03 S  per = 9.63  per(accum) = 65
 T(local opt: initial guess for dvdson    ) = 1.797e-04 S  per = 0.363  per(accum) = 65.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.630e-02 S  per = 32.9  per(accum) = 98.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.500e-04 S  per = 0.303  per(accum) = 98.6
 T(local opt: dvdson [nccl]               ) = 3.157e-04 S  per = 0.638  per(accum) = 99.2
 T(local opt: dvdson [mpi]                ) = 1.776e-06 S  per = 0.00359  per(accum) = 99.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.799e-04 S  per = 0.768  per(accum) = 100
Detailed decomposition of T(renrm) = 1.234e-02 S  T(sum) = 1.234e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.678e-05 S  per = 0.46  per(accum) = 0.46
 T(local opt: qops init                    ) = 3.817e-04 S  per = 3.09  per(accum) = 3.55
 T(local opt: symbolic_formulae_renorm     ) = 8.781e-05 S  per = 0.711  per(accum) = 4.26
 T(local opt: allocate qops on gpu         ) = 5.884e-05 S  per = 0.477  per(accum) = 4.74
 T(local opt: site memcpy cpu2gpu          ) = 2.668e-05 S  per = 0.216  per(accum) = 4.96
 T(local opt: rintermediate init           ) = 5.215e-05 S  per = 0.422  per(accum) = 5.38
 T(local opt: preprocess_formulae_Rlist2   ) = 1.100e-03 S  per = 8.91  per(accum) = 14.3
 T(local opt: rmmtasks init                ) = 3.497e-04 S  per = 2.83  per(accum) = 17.1
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 0.000324  per(accum) = 17.1
 T(local opt: preprocess_renorm_batchGPU   ) = 1.100e-03 S  per = 8.91  per(accum) = 26
 T(local opt: deallocate cpu and gpu memory) = 2.946e-05 S  per = 0.239  per(accum) = 26.3
 T(local opt: construct opS [ifdists=true] ) = 8.196e-03 S  per = 66.4  per(accum) = 92.7
 T(local opt: reduction of opS & opH [nccl]) = 1.906e-05 S  per = 0.154  per(accum) = 92.8
 T(local opt: qops memcpy gpu2cpu          ) = 4.123e-05 S  per = 0.334  per(accum) = 93.2
 T(local opt: reduction of opS & opH [mpi] ) = 4.340e-05 S  per = 0.352  per(accum) = 93.5
 T(local opt: qops_pool join and erase     ) = 7.993e-04 S  per = 6.48  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.533e-06 S  per = 0.0205  per(accum) = 100
ctns::rcanon_save_site idx=6 scratch=./scratch/sweep size=52:3.9e-07GB T(load)=0.00058S speed=0.00067GB/S
##### sweep opt: 1.021e+00 S #####
 T(sweep opt: fetch) = 5.765e-02 S  per = 5.65  per(accum) = 5.65
 T(sweep opt: hdiag) = 4.853e-02 S  per = 4.75  per(accum) = 10.4
 T(sweep opt: dvdsn) = 6.314e-01 S  per = 61.9  per(accum) = 72.3
 T(sweep opt: decim) = 2.561e-02 S  per = 2.51  per(accum) = 74.8
 T(sweep opt: guess) = 2.022e-03 S  per = 0.198  per(accum) = 75
 T(sweep opt: renrm) = 2.134e-01 S  per = 20.9  per(accum) = 95.9
 T(sweep opt: save ) = 4.212e-02 S  per = 4.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.314e-01 S  T(sum) = 6.220e-01 S  per = 9.850e+01
 T(sweep opt: preprocess                  ) = 7.300e-03 S  per = 1.17  per(accum) = 1.17
 T(sweep opt: symbolic_formulae           ) = 1.007e-02 S  per = 1.62  per(accum) = 2.79
 T(sweep opt: hintermediate init          ) = 1.547e-03 S  per = 0.249  per(accum) = 3.04
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.940e-01 S  per = 47.3  per(accum) = 50.3
 T(sweep opt: hmmtasks init               ) = 5.704e-02 S  per = 9.17  per(accum) = 59.5
 T(sweep opt: initial guess for dvdson    ) = 3.246e-03 S  per = 0.522  per(accum) = 60
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.303e-01 S  per =   37  per(accum) = 97
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.132e-03 S  per = 0.504  per(accum) = 97.5
 T(sweep opt: dvdson [nccl]               ) = 7.701e-03 S  per = 1.24  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 6.975e-05 S  per = 0.0112  per(accum) = 98.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.640e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm) = 2.134e-01 S  T(sum) = 2.134e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.223e-03 S  per = 0.573  per(accum) = 0.573
 T(sweep opt: qops init                    ) = 7.704e-03 S  per = 3.61  per(accum) = 4.18
 T(sweep opt: symbolic_formulae_renorm     ) = 3.373e-03 S  per = 1.58  per(accum) = 5.76
 T(sweep opt: allocate qops on gpu         ) = 1.294e-03 S  per = 0.606  per(accum) = 6.37
 T(sweep opt: site memcpy cpu2gpu          ) = 5.787e-04 S  per = 0.271  per(accum) = 6.64
 T(sweep opt: rintermediate init           ) = 1.037e-03 S  per = 0.486  per(accum) = 7.13
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.638e-02 S  per = 12.4  per(accum) = 19.5
 T(sweep opt: rmmtasks init                ) = 8.392e-03 S  per = 3.93  per(accum) = 23.4
 T(sweep opt: qops memset on cpu           ) = 1.090e-06 S  per = 0.000511  per(accum) = 23.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.909e-02 S  per = 8.95  per(accum) = 32.4
 T(sweep opt: deallocate cpu and gpu memory) = 6.666e-04 S  per = 0.312  per(accum) = 32.7
 T(sweep opt: construct opS [ifdists=true] ) = 1.227e-01 S  per = 57.5  per(accum) = 90.2
 T(sweep opt: reduction of opS & opH [nccl]) = 4.349e-04 S  per = 0.204  per(accum) = 90.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.916e-04 S  per = 0.371  per(accum) = 90.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.752e-04 S  per = 0.176  per(accum) = 90.9
 T(sweep opt: qops_pool join and erase     ) = 1.654e-02 S  per = 7.75  per(accum) = 98.7
 T(sweep opt: conversion from opAB to opPQ ) = 2.805e-03 S  per = 1.31  per(accum) = 100
##### global opt: 1.021e+00 S #####
 T(global opt: fetch) = 5.765e-02 S  per = 5.65  per(accum) = 5.65
 T(global opt: hdiag) = 4.853e-02 S  per = 4.75  per(accum) = 10.4
 T(global opt: dvdsn) = 6.314e-01 S  per = 61.9  per(accum) = 72.3
 T(global opt: decim) = 2.561e-02 S  per = 2.51  per(accum) = 74.8
 T(global opt: guess) = 2.022e-03 S  per = 0.198  per(accum) = 75
 T(global opt: renrm) = 2.134e-01 S  per = 20.9  per(accum) = 95.9
 T(global opt: save ) = 4.212e-02 S  per = 4.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.314e-01 S  T(sum) = 6.220e-01 S  per = 9.850e+01
 T(global opt: preprocess                  ) = 7.300e-03 S  per = 1.17  per(accum) = 1.17
 T(global opt: symbolic_formulae           ) = 1.007e-02 S  per = 1.62  per(accum) = 2.79
 T(global opt: hintermediate init          ) = 1.547e-03 S  per = 0.249  per(accum) = 3.04
 T(global opt: preprocess_hformulae_Hxlist ) = 2.940e-01 S  per = 47.3  per(accum) = 50.3
 T(global opt: hmmtasks init               ) = 5.704e-02 S  per = 9.17  per(accum) = 59.5
 T(global opt: initial guess for dvdson    ) = 3.246e-03 S  per = 0.522  per(accum) = 60
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.303e-01 S  per =   37  per(accum) = 97
 T(global opt: dvdson [cpu-gpu]            ) = 3.132e-03 S  per = 0.504  per(accum) = 97.5
 T(global opt: dvdson [nccl]               ) = 7.701e-03 S  per = 1.24  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 6.975e-05 S  per = 0.0112  per(accum) = 98.8
 T(global opt: dvdson [rest part(linalg)]  ) = 7.640e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm) = 2.134e-01 S  T(sum) = 2.134e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.223e-03 S  per = 0.573  per(accum) = 0.573
 T(global opt: qops init                    ) = 7.704e-03 S  per = 3.61  per(accum) = 4.18
 T(global opt: symbolic_formulae_renorm     ) = 3.373e-03 S  per = 1.58  per(accum) = 5.76
 T(global opt: allocate qops on gpu         ) = 1.294e-03 S  per = 0.606  per(accum) = 6.37
 T(global opt: site memcpy cpu2gpu          ) = 5.787e-04 S  per = 0.271  per(accum) = 6.64
 T(global opt: rintermediate init           ) = 1.037e-03 S  per = 0.486  per(accum) = 7.13
 T(global opt: preprocess_formulae_Rlist2   ) = 2.638e-02 S  per = 12.4  per(accum) = 19.5
 T(global opt: rmmtasks init                ) = 8.392e-03 S  per = 3.93  per(accum) = 23.4
 T(global opt: qops memset on cpu           ) = 1.090e-06 S  per = 0.000511  per(accum) = 23.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.909e-02 S  per = 8.95  per(accum) = 32.4
 T(global opt: deallocate cpu and gpu memory) = 6.666e-04 S  per = 0.312  per(accum) = 32.7
 T(global opt: construct opS [ifdists=true] ) = 1.227e-01 S  per = 57.5  per(accum) = 90.2
 T(global opt: reduction of opS & opH [nccl]) = 4.349e-04 S  per = 0.204  per(accum) = 90.4
 T(global opt: qops memcpy gpu2cpu          ) = 7.916e-04 S  per = 0.371  per(accum) = 90.8
 T(global opt: reduction of opS & opH [mpi] ) = 3.752e-04 S  per = 0.176  per(accum) = 90.9
 T(global opt: qops_pool join and erase     ) = 1.654e-02 S  per = 7.75  per(accum) = 98.7
 T(global opt: conversion from opAB to opPQ ) = 2.805e-03 S  per = 1.31  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-3.007e-03 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 

isweep=0 ibond=23/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=8 scratch=./scratch/sweep size=56:4.17e-07GB T(load)=3.14e-04S speed=1.33e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=104:7.93e-04MB:7.75e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=60:4.58e-04MB:4.47e-07GB
total mem of comb=165:1.26e-03MB:1.23e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=5.081e-06 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:11 S:5 H:1 P:40 Q:44 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=2530:1.930e-02MB:1.885e-05GB
        per(mem): C:6.96 S:3.16 H:1.34 P:1.58 Q:87 
 rqops: oplist=CSHAB nops=C:7 S:6 H:1 A:23 B:28 
        dim(bra,ket)=10,10 size(op)=36:0.000275MB size(tot)=1321:0.0101MB:9.84e-06GB
        per(mem): C:12.2 S:10.4 H:1.82 A:12 B:63.6 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5847:0.0446MB:4.36e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.618e-04 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.385e+00 avail=4.807e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=118:9.003e-04MB
qtensor4: wf4 own=1 _data=0x5585ee60b400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
 qbond: qcol nsym=5 dimAll=10
 (10,2):3 (11,3):3 (10,4):2 (9,3):1 (12,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=25 nblocks=320 size=118:9.003e-04MB
### DIAG TIMING: total=3.652e-03 t1=1.829e-05, t2=1.833e-05, t3=1.734e-05, t4=3.546e-03, t5=6.393e-06, t6=3.778e-05, t7=7.112e-06
duration_diagGPU:3.669e-03
duration_diagreduce:6.800e-08
duration_diagtransform:2.850e-07
----- TIMING FOR symbolic_formulae_twodot with size=398 : 6.461e-04 S -----
rank=0 GPUmem(GB): used=4.356e-05 (oper)=4.356e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=398
 no. of hintermediate operators=212
 no. of coefficients=2490:1.900e-02MB:1.855e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.038e-04 S -----
rank=0 GPUmem(GB): used=6.212e-05 (oper,hinter)=4.356e-05,1.855e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.946e-02 S size(H_formulae)=398 size(Hxlst2)=25 T(Hmu/Hxlist)=1.927e-04,1.926e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.059e-02 S size(H_formulae)=398 size(Hxlst)=11472 -----
rank=0 GPUmem(GB): used=6.212e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.758e-06 batch[need]=2.906e-03 blksize=12 blksize0=9 batchsize=11472
rank=0 GPUmem(GB): used=2.970e-03 (oper,hinter,dvdson,batch)=4.356e-05,1.855e-05,1.758e-06,2.906e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=118 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.428e-05,1.923e-04,6.234e-04,7.602e-04,1.659e-03
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.279e-05 speed=7.715e-02GB/S T(nccl)=5.148e-05 speed=3.415e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=6.2e-04 t_reduction=7.6e-04 tot=1.6e-03 -----
 sigma[inter] counter=141 t=1.9e-04 per=1.2e+01 cost=6.2e+05 flops=3.2e+09
 sigma[gemm] counter=141 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=2 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=3 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=4 t=1.8e-04 per=1.1e+01 cost=1.3e+05 flops=7.2e+08
 sigma[gemm] counter=141 i=5 t=1.8e-04 per=1.1e+01 cost=1.2e+05 flops=6.5e+08
 sigma[gemm] counter=141 i=6 t=1.3e-04 per=8.3e+00 cost=9.3e+04 flops=7.1e+08
 sigma[gemm] counter=141 i=7 t=1.3e-04 per=8.2e+00 cost=1.0e+05 flops=7.9e+08
 sigma[gemm] counter=141 total t=6.2e-04 per=4.0e+01 cost=4.4e+05 flops=7.0e+08
 sigma[red] counter=141 t=7.6e-04 per=4.8e+01 cost=1.1e+05 flops=1.5e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.7e-02 t_reduction=8.6e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=141 t=1.9e-02 per=9.2e+00 cost=4.7e+07 flops=2.5e+09
 sigma_tot[gemm] counter=141 i=0 t=3.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=1 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=2 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=3 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=4 t=2.3e-02 per=1.1e+01 cost=9.8e+06 flops=4.3e+08
 sigma_tot[gemm] counter=141 i=5 t=2.5e-02 per=1.2e+01 cost=9.7e+06 flops=3.9e+08
 sigma_tot[gemm] counter=141 i=6 t=2.4e-02 per=1.2e+01 cost=9.2e+06 flops=3.8e+08
 sigma_tot[gemm] counter=141 i=7 t=2.4e-02 per=1.2e+01 cost=9.4e+06 flops=3.9e+08
 sigma_tot[gemm] counter=141 total t=9.7e-02 per=4.8e+01 cost=3.8e+07 flops=3.9e+08
 sigma_tot[red] counter=141 t=8.6e-02 per=4.3e+01 cost=9.4e+06 flops=1.1e+08
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,3.3e-06,9.7e-07,1.0e-06,2.3e-07
settings: ndim=118 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.327207159735 -1.116e+03  3.081e-02    1     1  1.928e-03 1.928e-03 1.902e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.572e-05,1.892e-04,7.015e-04,8.092e-04,1.770e-03
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.140e-05 speed=8.215e-02GB/S T(nccl)=4.432e-05 speed=3.967e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=7.0e-04 t_reduction=8.1e-04 tot=1.7e-03 -----
 sigma[inter] counter=142 t=1.9e-04 per=1.1e+01 cost=6.2e+05 flops=3.3e+09
 sigma[gemm] counter=142 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=4 t=1.9e-04 per=1.1e+01 cost=1.3e+05 flops=6.5e+08
 sigma[gemm] counter=142 i=5 t=2.0e-04 per=1.2e+01 cost=1.2e+05 flops=5.8e+08
 sigma[gemm] counter=142 i=6 t=1.5e-04 per=8.7e+00 cost=9.3e+04 flops=6.3e+08
 sigma[gemm] counter=142 i=7 t=1.5e-04 per=8.8e+00 cost=1.0e+05 flops=6.8e+08
 sigma[gemm] counter=142 total t=7.0e-04 per=4.1e+01 cost=4.4e+05 flops=6.2e+08
 sigma[red] counter=142 t=8.1e-04 per=4.8e+01 cost=1.1e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.7e-02 t_reduction=8.7e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=142 t=1.9e-02 per=9.2e+00 cost=4.7e+07 flops=2.5e+09
 sigma_tot[gemm] counter=142 i=0 t=3.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=1 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=2 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=3 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=4 t=2.3e-02 per=1.1e+01 cost=9.9e+06 flops=4.3e+08
 sigma_tot[gemm] counter=142 i=5 t=2.5e-02 per=1.2e+01 cost=9.9e+06 flops=3.9e+08
 sigma_tot[gemm] counter=142 i=6 t=2.4e-02 per=1.2e+01 cost=9.3e+06 flops=3.8e+08
 sigma_tot[gemm] counter=142 i=7 t=2.4e-02 per=1.2e+01 cost=9.5e+06 flops=3.9e+08
 sigma_tot[gemm] counter=142 total t=9.7e-02 per=4.8e+01 cost=3.8e+07 flops=3.9e+08
 sigma_tot[red] counter=142 t=8.7e-02 per=4.3e+01 cost=9.5e+06 flops=1.1e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.5e-05,3.0e-06,1.4e-06,2.3e-07
    2   0 -    -116.329431037464 -2.224e-03  1.179e-02    2     2  4.075e-03 2.037e-03 1.968e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.503e-05,1.777e-04,7.033e-04,7.946e-04,1.745e-03
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.078e-05 speed=8.463e-02GB/S T(nccl)=4.425e-05 speed=3.974e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=7.0e-04 t_reduction=7.9e-04 tot=1.7e-03 -----
 sigma[inter] counter=143 t=1.8e-04 per=1.1e+01 cost=6.2e+05 flops=3.5e+09
 sigma[gemm] counter=143 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=4 t=1.9e-04 per=1.1e+01 cost=1.3e+05 flops=6.7e+08
 sigma[gemm] counter=143 i=5 t=2.0e-04 per=1.2e+01 cost=1.2e+05 flops=5.8e+08
 sigma[gemm] counter=143 i=6 t=1.5e-04 per=9.0e+00 cost=9.3e+04 flops=6.2e+08
 sigma[gemm] counter=143 i=7 t=1.5e-04 per=9.1e+00 cost=1.0e+05 flops=6.6e+08
 sigma[gemm] counter=143 total t=7.0e-04 per=4.2e+01 cost=4.4e+05 flops=6.2e+08
 sigma[red] counter=143 t=7.9e-04 per=4.7e+01 cost=1.1e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.8e-02 t_reduction=8.8e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=143 t=1.9e-02 per=9.2e+00 cost=4.8e+07 flops=2.5e+09
 sigma_tot[gemm] counter=143 i=0 t=3.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=1 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=2 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=3 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=4 t=2.3e-02 per=1.1e+01 cost=1.0e+07 flops=4.4e+08
 sigma_tot[gemm] counter=143 i=5 t=2.5e-02 per=1.2e+01 cost=1.0e+07 flops=3.9e+08
 sigma_tot[gemm] counter=143 i=6 t=2.4e-02 per=1.2e+01 cost=9.4e+06 flops=3.9e+08
 sigma_tot[gemm] counter=143 i=7 t=2.4e-02 per=1.2e+01 cost=9.6e+06 flops=4.0e+08
 sigma_tot[gemm] counter=143 total t=9.8e-02 per=4.8e+01 cost=3.9e+07 flops=4.0e+08
 sigma_tot[red] counter=143 t=8.8e-02 per=4.3e+01 cost=9.6e+06 flops=1.1e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.6e-05,2.2e-06,1.4e-06,2.4e-07
    3   0 -    -116.329868692264 -4.377e-04  5.326e-03    3     3  6.067e-03 2.022e-03 1.958e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.453e-05,1.794e-04,6.882e-04,7.940e-04,1.730e-03
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.107e-05 speed=8.344e-02GB/S T(nccl)=4.345e-05 speed=4.046e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=6.9e-04 t_reduction=7.9e-04 tot=1.7e-03 -----
 sigma[inter] counter=144 t=1.8e-04 per=1.1e+01 cost=6.2e+05 flops=3.4e+09
 sigma[gemm] counter=144 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=4 t=1.9e-04 per=1.2e+01 cost=1.3e+05 flops=6.6e+08
 sigma[gemm] counter=144 i=5 t=2.0e-04 per=1.2e+01 cost=1.2e+05 flops=6.0e+08
 sigma[gemm] counter=144 i=6 t=1.4e-04 per=8.4e+00 cost=9.3e+04 flops=6.7e+08
 sigma[gemm] counter=144 i=7 t=1.5e-04 per=9.3e+00 cost=1.0e+05 flops=6.6e+08
 sigma[gemm] counter=144 total t=6.9e-04 per=4.1e+01 cost=4.4e+05 flops=6.4e+08
 sigma[red] counter=144 t=7.9e-04 per=4.8e+01 cost=1.1e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.9e-02 t_reduction=8.9e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=144 t=1.9e-02 per=9.2e+00 cost=4.9e+07 flops=2.6e+09
 sigma_tot[gemm] counter=144 i=0 t=3.2e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=1 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=2 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=3 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=4 t=2.3e-02 per=1.1e+01 cost=1.0e+07 flops=4.4e+08
 sigma_tot[gemm] counter=144 i=5 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=3.9e+08
 sigma_tot[gemm] counter=144 i=6 t=2.4e-02 per=1.2e+01 cost=9.5e+06 flops=3.9e+08
 sigma_tot[gemm] counter=144 i=7 t=2.4e-02 per=1.2e+01 cost=9.7e+06 flops=4.0e+08
 sigma_tot[gemm] counter=144 total t=9.9e-02 per=4.8e+01 cost=3.9e+07 flops=4.0e+08
 sigma_tot[red] counter=144 t=8.9e-02 per=4.3e+01 cost=9.8e+06 flops=1.1e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,2.0e-06,1.3e-06,1.6e-07
    4   0 -    -116.329961643364 -9.295e-05  2.485e-03    3     4  8.053e-03 2.013e-03 1.953e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.561e-05,1.826e-04,6.910e-04,7.925e-04,1.736e-03
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.114e-05 speed=8.316e-02GB/S T(nccl)=4.446e-05 speed=3.955e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=6.9e-04 t_reduction=7.9e-04 tot=1.7e-03 -----
 sigma[inter] counter=145 t=1.8e-04 per=1.1e+01 cost=6.2e+05 flops=3.4e+09
 sigma[gemm] counter=145 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=2 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=4 t=1.9e-04 per=1.1e+01 cost=1.3e+05 flops=6.6e+08
 sigma[gemm] counter=145 i=5 t=2.0e-04 per=1.2e+01 cost=1.2e+05 flops=6.0e+08
 sigma[gemm] counter=145 i=6 t=1.4e-04 per=8.5e+00 cost=9.3e+04 flops=6.5e+08
 sigma[gemm] counter=145 i=7 t=1.5e-04 per=9.2e+00 cost=1.0e+05 flops=6.6e+08
 sigma[gemm] counter=145 total t=6.9e-04 per=4.1e+01 cost=4.4e+05 flops=6.3e+08
 sigma[red] counter=145 t=7.9e-04 per=4.8e+01 cost=1.1e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=1.0e-01 t_reduction=9.0e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=145 t=1.9e-02 per=9.2e+00 cost=4.9e+07 flops=2.6e+09
 sigma_tot[gemm] counter=145 i=0 t=3.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=1 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=2 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=3 t=2.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=4 t=2.3e-02 per=1.1e+01 cost=1.0e+07 flops=4.4e+08
 sigma_tot[gemm] counter=145 i=5 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=3.9e+08
 sigma_tot[gemm] counter=145 i=6 t=2.5e-02 per=1.2e+01 cost=9.6e+06 flops=3.9e+08
 sigma_tot[gemm] counter=145 i=7 t=2.4e-02 per=1.2e+01 cost=9.8e+06 flops=4.0e+08
 sigma_tot[gemm] counter=145 total t=1.0e-01 per=4.8e+01 cost=4.0e+07 flops=4.0e+08
 sigma_tot[red] counter=145 t=9.0e-02 per=4.3e+01 cost=9.9e+06 flops=1.1e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.4e-05,2.0e-06,1.3e-06,2.0e-07
    5   0 -    -116.329978641602 -1.700e-05  7.597e-04    3     5  1.005e-02 2.011e-03 1.952e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.565e-05,1.781e-04,6.939e-04,8.139e-04,1.756e-03
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.143e-05 speed=8.205e-02GB/S T(nccl)=4.422e-05 speed=3.976e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=6.9e-04 t_reduction=8.1e-04 tot=1.7e-03 -----
 sigma[inter] counter=146 t=1.8e-04 per=1.1e+01 cost=6.2e+05 flops=3.5e+09
 sigma[gemm] counter=146 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=4 t=1.9e-04 per=1.1e+01 cost=1.3e+05 flops=6.8e+08
 sigma[gemm] counter=146 i=5 t=2.0e-04 per=1.2e+01 cost=1.2e+05 flops=5.9e+08
 sigma[gemm] counter=146 i=6 t=1.5e-04 per=8.7e+00 cost=9.3e+04 flops=6.3e+08
 sigma[gemm] counter=146 i=7 t=1.5e-04 per=9.0e+00 cost=1.0e+05 flops=6.6e+08
 sigma[gemm] counter=146 total t=6.9e-04 per=4.1e+01 cost=4.4e+05 flops=6.3e+08
 sigma[red] counter=146 t=8.1e-04 per=4.8e+01 cost=1.1e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=1.0e-01 t_reduction=9.0e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=146 t=1.9e-02 per=9.2e+00 cost=5.0e+07 flops=2.6e+09
 sigma_tot[gemm] counter=146 i=0 t=3.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=1 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=2 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=3 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=4 t=2.4e-02 per=1.1e+01 cost=1.0e+07 flops=4.4e+08
 sigma_tot[gemm] counter=146 i=5 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=146 i=6 t=2.5e-02 per=1.2e+01 cost=9.7e+06 flops=3.9e+08
 sigma_tot[gemm] counter=146 i=7 t=2.5e-02 per=1.2e+01 cost=9.9e+06 flops=4.0e+08
 sigma_tot[gemm] counter=146 total t=1.0e-01 per=4.8e+01 cost=4.0e+07 flops=4.0e+08
 sigma_tot[red] counter=146 t=9.0e-02 per=4.3e+01 cost=1.0e+07 flops=1.1e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,1.8e-06,1.2e-06,1.6e-07
    6   0 -    -116.329980035776 -1.394e-06  2.286e-04    3     6  1.205e-02 2.008e-03 1.951e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.469e-05,1.890e-04,7.043e-04,7.914e-04,1.754e-03
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.128e-05 speed=8.265e-02GB/S T(nccl)=4.342e-05 speed=4.050e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=7.0e-04 t_reduction=7.9e-04 tot=1.7e-03 -----
 sigma[inter] counter=147 t=1.9e-04 per=1.1e+01 cost=6.2e+05 flops=3.3e+09
 sigma[gemm] counter=147 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=2 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=3 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=4 t=2.0e-04 per=1.2e+01 cost=1.3e+05 flops=6.2e+08
 sigma[gemm] counter=147 i=5 t=2.0e-04 per=1.2e+01 cost=1.2e+05 flops=5.9e+08
 sigma[gemm] counter=147 i=6 t=1.4e-04 per=8.6e+00 cost=9.3e+04 flops=6.5e+08
 sigma[gemm] counter=147 i=7 t=1.5e-04 per=9.0e+00 cost=1.0e+05 flops=6.7e+08
 sigma[gemm] counter=147 total t=7.0e-04 per=4.2e+01 cost=4.4e+05 flops=6.2e+08
 sigma[red] counter=147 t=7.9e-04 per=4.7e+01 cost=1.1e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=1.0e-01 t_reduction=9.1e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=147 t=2.0e-02 per=9.3e+00 cost=5.1e+07 flops=2.6e+09
 sigma_tot[gemm] counter=147 i=0 t=3.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=1 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=2 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=3 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=4 t=2.4e-02 per=1.1e+01 cost=1.1e+07 flops=4.4e+08
 sigma_tot[gemm] counter=147 i=5 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=147 i=6 t=2.5e-02 per=1.2e+01 cost=9.8e+06 flops=3.9e+08
 sigma_tot[gemm] counter=147 i=7 t=2.5e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=147 total t=1.0e-01 per=4.8e+01 cost=4.1e+07 flops=4.0e+08
 sigma_tot[red] counter=147 t=9.1e-02 per=4.3e+01 cost=1.0e+07 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,1.9e-06,1.2e-06,1.5e-07
    7   0 +    -116.329980164892 -1.291e-07  8.649e-05    3     7  1.405e-02 2.007e-03 1.951e-03
TIMING FOR Davidson : 1.407e-02  T(cal/comm/rest)=1.366e-02,8.292e-06,4.051e-04
decomposed t_rest=4.051e-04
 T(sub)    =1.419e-04 per=3.504e+01
 T(precond)=1.748e-05 per=4.315e+00
 T(ortho)  =1.021e-05 per=2.519e+00
 T(xcopy)  =1.011e-06 per=2.496e-01
 T(xnrm2)  =1.181e-06 per=2.915e-01
 T(other)  =2.333e-04 per=5.758e+01
optimized energies: isweep=0 ibond=23 dots=2 e[0]=-116.329980164892 nmvp=7
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.892e-03 change=3.008e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=11 dimAll=40
 (10,2):4 (11,3):9 (10,4):3 (9,3):1 (12,2):7 (13,3):4 (12,4):5 (14,2):1 (11,1):3 (11,5):2 (13,1):1
timing for divide=7.1e-06
timing for compute=5.1e-05
timing for collect=8.2e-06
----- TMING FOR decimation_genbasis(su2): 6.6e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.1e-06,4.0e-05,0.0e+00,1.0e-05,8.2e-06 -----
decimation summary: 40->10 dwt=+3.719e-03 SvN=1.041e+00
 qbond: qkept nsym=5 dimAll=10
 (12,2):4 (12,4):3 (11,3):1 (13,3):1 (14,2):1
----- TIMING for decimation_row(nkr): 1.065e-03 S T(decim/select/formRot)=1.183e-04,9.263e-04,2.026e-05 -----
----- TIMING FOR twodot_decimation: 1.164e-03 S T(wf/decim)=8.304e-05,1.081e-03 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:8 S:6 H:1 A:28 B:40 
        dim(bra,ket)=10,10 size(op)=52:3.967e-04MB size(tot)=2014:1.537e-02MB:1.501e-05GB
        per(mem): C:5.96 S:4.47 H:1.39 A:8.74 B:79.4 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.884e-03 change=1.746e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 9.516e-05 S -----
rank=0 GPUmem(GB): used=5.827e-05 (oper)=3.228e-05
rank=0 GPUmem(GB): used=5.870e-05 (oper,site)=3.228e-05,4.247e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=77
 no. of rintermediate operators=5
 no. of coefficients=69:5.264e-04MB:5.141e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.695e-05 S -----
rank=0 GPUmem(GB): used=5.921e-05 (oper,site,rinter)=3.228e-05,4.247e-07,5.141e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.096e-03 S size(rtasks)=77 size(Rlst2)=25 T(Rmu/Rlist)=4.770e-05,1.049e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.177e-03 S size(rtasks)=77 size(Rlst)=915 -----
rank=0 GPUmem(GB): used=5.921e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.863e-04 blksize=16 blksize0=9 batchsize=915
rank=0 GPUmem(GB): used=3.455e-04 (oper,site,rinter,batch)=3.228e-05,4.247e-07,5.141e-07,2.863e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.200e-04,4.958e-04,1.978e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=5.0e-04 t_reduction=2.0e-04 tot=8.1e-04 -----
 renorm[inter] counter=281 t=1.2e-04 per=1.5e+01 cost=1.2e+04 flops=9.6e+07
 renorm[gemm] counter=281 i=0 t=2.1e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=1 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=2 t=1.4e-04 per=1.7e+01 cost=4.4e+03 flops=3.1e+07
 renorm[gemm] counter=281 i=3 t=1.8e-04 per=2.2e+01 cost=1.7e+04 flops=9.4e+07
 renorm[gemm] counter=281 i=4 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=5 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=6 t=1.7e-04 per=2.1e+01 cost=2.5e+04 flops=1.4e+08
 renorm[gemm] counter=281 total t=5.0e-04 per=6.1e+01 cost=4.5e+04 flops=9.2e+07
 renorm[red] counter=281 t=2.0e-04 per=2.4e+01 cost=1.0e+04 flops=5.1e+07
----- TIMING FOR renorm_tot : t_inter=2.4e-03 t_gemm=1.0e-02 t_reduction=4.0e-03 tot=1.7e-02 -----
 renorm_tot[inter] counter=281 t=2.4e-03 per=1.4e+01 cost=4.0e+05 flops=1.7e+08
 renorm_tot[gemm] counter=281 i=0 t=5.2e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=281 i=1 t=4.6e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=281 i=2 t=1.1e-03 per=6.9e+00 cost=1.4e+04 flops=1.2e+07
 renorm_tot[gemm] counter=281 i=3 t=1.3e-03 per=7.8e+00 cost=4.9e+04 flops=3.7e+07
 renorm_tot[gemm] counter=281 i=4 t=2.2e-03 per=1.3e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=281 i=5 t=2.3e-03 per=1.4e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=281 i=6 t=3.4e-03 per=2.0e+01 cost=5.2e+05 flops=1.5e+08
 renorm_tot[gemm] counter=281 total t=1.0e-02 per=6.2e+01 cost=8.8e+05 flops=8.4e+07
 renorm_tot[red] counter=281 t=4.0e-03 per=2.4e+01 cost=2.3e+05 flops=5.8e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.690e-05 (oper)=3.240e-05
rank=0 GPUmem(GB): used=6.732e-05 (oper,site,rinter)=3.240e-05,4.247e-07,8.002e-06
rank=0 GPUmem(GB): used=8.911e-05 (oper,site,rinter,batch)=3.240e-05,4.247e-07,8.002e-06,2.179e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.326e-03 S T(preprocess/alloc/comp/red/dealloc)=1.649e-03,1.685e-03,5.278e-03,2.430e-04,9.644e-05 -----
----- TIMING FOR oper_renorm_opS : 7.362e-03 S rank=0 -----
qops.to_cpu: size(tot)=2014:1.537e-02MB:1.501e-05GB T(to_cpu)=3.693e-05S speed=4.063e-01GB/S
check ||H-H.dagger||=8.337e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0107 S rank=0 -----
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=3.792e-03 change=2.567e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=3.799e-03 change=-1.328e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=3.799e-03 change=-3.979e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.270e-02 S #####
 T(local opt: fetch) = 2.668e-03 S  per = 4.25  per(accum) = 4.25
 T(local opt: hdiag) = 3.770e-03 S  per = 6.01  per(accum) = 10.3
 T(local opt: dvdsn) = 4.081e-02 S  per = 65.1  per(accum) = 75.4
 T(local opt: decim) = 1.197e-03 S  per = 1.91  per(accum) = 77.3
 T(local opt: guess) = 9.458e-05 S  per = 0.151  per(accum) = 77.4
 T(local opt: renrm) = 1.160e-02 S  per = 18.5  per(accum) = 95.9
 T(local opt: save ) = 2.566e-03 S  per = 4.09  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.081e-02 S  T(sum) = 4.021e-02 S  per = 9.853e+01
 T(local opt: preprocess                  ) = 3.627e-04 S  per = 0.902  per(accum) = 0.902
 T(local opt: symbolic_formulae           ) = 6.599e-04 S  per = 1.64  per(accum) = 2.54
 T(local opt: hintermediate init          ) = 1.220e-04 S  per = 0.303  per(accum) = 2.85
 T(local opt: preprocess_hformulae_Hxlist ) = 2.074e-02 S  per = 51.6  per(accum) = 54.4
 T(local opt: hmmtasks init               ) = 4.106e-03 S  per = 10.2  per(accum) = 64.6
 T(local opt: initial guess for dvdson    ) = 1.446e-04 S  per = 0.36  per(accum) = 65
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.319e-02 S  per = 32.8  per(accum) = 97.8
 T(local opt: dvdson [cpu-gpu]            ) = 1.499e-04 S  per = 0.373  per(accum) = 98.2
 T(local opt: dvdson [nccl]               ) = 3.156e-04 S  per = 0.785  per(accum) = 99
 T(local opt: dvdson [mpi]                ) = 8.292e-06 S  per = 0.0206  per(accum) = 99
 T(local opt: dvdson [rest part(linalg)]  ) = 4.051e-04 S  per = 1.01  per(accum) = 100
Detailed decomposition of T(renrm) = 1.160e-02 S  T(sum) = 1.160e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.709e-05 S  per = 0.492  per(accum) = 0.492
 T(local opt: qops init                    ) = 4.197e-04 S  per = 3.62  per(accum) = 4.11
 T(local opt: symbolic_formulae_renorm     ) = 1.057e-04 S  per = 0.912  per(accum) = 5.02
 T(local opt: allocate qops on gpu         ) = 5.981e-05 S  per = 0.516  per(accum) = 5.54
 T(local opt: site memcpy cpu2gpu          ) = 2.683e-05 S  per = 0.231  per(accum) = 5.77
 T(local opt: rintermediate init           ) = 5.807e-05 S  per = 0.501  per(accum) = 6.27
 T(local opt: preprocess_formulae_Rlist2   ) = 1.189e-03 S  per = 10.3  per(accum) = 16.5
 T(local opt: rmmtasks init                ) = 3.658e-04 S  per = 3.15  per(accum) = 19.7
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.000336  per(accum) = 19.7
 T(local opt: preprocess_renorm_batchGPU   ) = 9.287e-04 S  per = 8.01  per(accum) = 27.7
 T(local opt: deallocate cpu and gpu memory) = 5.207e-05 S  per = 0.449  per(accum) = 28.1
 T(local opt: construct opS [ifdists=true] ) = 7.372e-03 S  per = 63.6  per(accum) = 91.7
 T(local opt: reduction of opS & opH [nccl]) = 1.931e-05 S  per = 0.167  per(accum) = 91.9
 T(local opt: qops memcpy gpu2cpu          ) = 4.605e-05 S  per = 0.397  per(accum) = 92.3
 T(local opt: reduction of opS & opH [mpi] ) = 1.285e-05 S  per = 0.111  per(accum) = 92.4
 T(local opt: qops_pool join and erase     ) = 8.791e-04 S  per = 7.58  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.429e-06 S  per = 0.0382  per(accum) = 100
ctns::rcanon_save_site idx=7 scratch=./scratch/sweep size=57:4.2e-07GB T(load)=0.00059S speed=0.00073GB/S
##### sweep opt: 1.084e+00 S #####
 T(sweep opt: fetch) = 6.032e-02 S  per = 5.57  per(accum) = 5.57
 T(sweep opt: hdiag) = 5.230e-02 S  per = 4.83  per(accum) = 10.4
 T(sweep opt: dvdsn) = 6.723e-01 S  per =   62  per(accum) = 72.4
 T(sweep opt: decim) = 2.681e-02 S  per = 2.47  per(accum) = 74.9
 T(sweep opt: guess) = 2.116e-03 S  per = 0.195  per(accum) = 75.1
 T(sweep opt: renrm) = 2.250e-01 S  per = 20.8  per(accum) = 95.9
 T(sweep opt: save ) = 4.468e-02 S  per = 4.12  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.723e-01 S  T(sum) = 6.622e-01 S  per = 9.851e+01
 T(sweep opt: preprocess                  ) = 7.663e-03 S  per = 1.16  per(accum) = 1.16
 T(sweep opt: symbolic_formulae           ) = 1.073e-02 S  per = 1.62  per(accum) = 2.78
 T(sweep opt: hintermediate init          ) = 1.669e-03 S  per = 0.252  per(accum) = 3.03
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.147e-01 S  per = 47.5  per(accum) = 50.6
 T(sweep opt: hmmtasks init               ) = 6.114e-02 S  per = 9.23  per(accum) = 59.8
 T(sweep opt: initial guess for dvdson    ) = 3.391e-03 S  per = 0.512  per(accum) = 60.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.434e-01 S  per = 36.8  per(accum) = 97.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.282e-03 S  per = 0.496  per(accum) = 97.6
 T(sweep opt: dvdson [nccl]               ) = 8.017e-03 S  per = 1.21  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 7.804e-05 S  per = 0.0118  per(accum) = 98.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.045e-03 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm) = 2.250e-01 S  T(sum) = 2.250e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.280e-03 S  per = 0.569  per(accum) = 0.569
 T(sweep opt: qops init                    ) = 8.123e-03 S  per = 3.61  per(accum) = 4.18
 T(sweep opt: symbolic_formulae_renorm     ) = 3.479e-03 S  per = 1.55  per(accum) = 5.72
 T(sweep opt: allocate qops on gpu         ) = 1.354e-03 S  per = 0.602  per(accum) = 6.33
 T(sweep opt: site memcpy cpu2gpu          ) = 6.056e-04 S  per = 0.269  per(accum) = 6.6
 T(sweep opt: rintermediate init           ) = 1.095e-03 S  per = 0.487  per(accum) = 7.08
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.757e-02 S  per = 12.3  per(accum) = 19.3
 T(sweep opt: rmmtasks init                ) = 8.758e-03 S  per = 3.89  per(accum) = 23.2
 T(sweep opt: qops memset on cpu           ) = 1.129e-06 S  per = 0.000502  per(accum) = 23.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.002e-02 S  per =  8.9  per(accum) = 32.1
 T(sweep opt: deallocate cpu and gpu memory) = 7.187e-04 S  per = 0.319  per(accum) = 32.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.301e-01 S  per = 57.8  per(accum) = 90.3
 T(sweep opt: reduction of opS & opH [nccl]) = 4.542e-04 S  per = 0.202  per(accum) = 90.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.376e-04 S  per = 0.372  per(accum) = 90.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.881e-04 S  per = 0.172  per(accum) = 91
 T(sweep opt: qops_pool join and erase     ) = 1.741e-02 S  per = 7.74  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.809e-03 S  per = 1.25  per(accum) = 100
##### global opt: 1.084e+00 S #####
 T(global opt: fetch) = 6.032e-02 S  per = 5.57  per(accum) = 5.57
 T(global opt: hdiag) = 5.230e-02 S  per = 4.83  per(accum) = 10.4
 T(global opt: dvdsn) = 6.723e-01 S  per =   62  per(accum) = 72.4
 T(global opt: decim) = 2.681e-02 S  per = 2.47  per(accum) = 74.9
 T(global opt: guess) = 2.116e-03 S  per = 0.195  per(accum) = 75.1
 T(global opt: renrm) = 2.250e-01 S  per = 20.8  per(accum) = 95.9
 T(global opt: save ) = 4.468e-02 S  per = 4.12  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.723e-01 S  T(sum) = 6.622e-01 S  per = 9.851e+01
 T(global opt: preprocess                  ) = 7.663e-03 S  per = 1.16  per(accum) = 1.16
 T(global opt: symbolic_formulae           ) = 1.073e-02 S  per = 1.62  per(accum) = 2.78
 T(global opt: hintermediate init          ) = 1.669e-03 S  per = 0.252  per(accum) = 3.03
 T(global opt: preprocess_hformulae_Hxlist ) = 3.147e-01 S  per = 47.5  per(accum) = 50.6
 T(global opt: hmmtasks init               ) = 6.114e-02 S  per = 9.23  per(accum) = 59.8
 T(global opt: initial guess for dvdson    ) = 3.391e-03 S  per = 0.512  per(accum) = 60.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.434e-01 S  per = 36.8  per(accum) = 97.1
 T(global opt: dvdson [cpu-gpu]            ) = 3.282e-03 S  per = 0.496  per(accum) = 97.6
 T(global opt: dvdson [nccl]               ) = 8.017e-03 S  per = 1.21  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 7.804e-05 S  per = 0.0118  per(accum) = 98.8
 T(global opt: dvdson [rest part(linalg)]  ) = 8.045e-03 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm) = 2.250e-01 S  T(sum) = 2.250e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.280e-03 S  per = 0.569  per(accum) = 0.569
 T(global opt: qops init                    ) = 8.123e-03 S  per = 3.61  per(accum) = 4.18
 T(global opt: symbolic_formulae_renorm     ) = 3.479e-03 S  per = 1.55  per(accum) = 5.72
 T(global opt: allocate qops on gpu         ) = 1.354e-03 S  per = 0.602  per(accum) = 6.33
 T(global opt: site memcpy cpu2gpu          ) = 6.056e-04 S  per = 0.269  per(accum) = 6.6
 T(global opt: rintermediate init           ) = 1.095e-03 S  per = 0.487  per(accum) = 7.08
 T(global opt: preprocess_formulae_Rlist2   ) = 2.757e-02 S  per = 12.3  per(accum) = 19.3
 T(global opt: rmmtasks init                ) = 8.758e-03 S  per = 3.89  per(accum) = 23.2
 T(global opt: qops memset on cpu           ) = 1.129e-06 S  per = 0.000502  per(accum) = 23.2
 T(global opt: preprocess_renorm_batchGPU   ) = 2.002e-02 S  per =  8.9  per(accum) = 32.1
 T(global opt: deallocate cpu and gpu memory) = 7.187e-04 S  per = 0.319  per(accum) = 32.4
 T(global opt: construct opS [ifdists=true] ) = 1.301e-01 S  per = 57.8  per(accum) = 90.3
 T(global opt: reduction of opS & opH [nccl]) = 4.542e-04 S  per = 0.202  per(accum) = 90.5
 T(global opt: qops memcpy gpu2cpu          ) = 8.376e-04 S  per = 0.372  per(accum) = 90.8
 T(global opt: reduction of opS & opH [mpi] ) = 3.881e-04 S  per = 0.172  per(accum) = 91
 T(global opt: qops_pool join and erase     ) = 1.741e-02 S  per = 7.74  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 2.809e-03 S  per = 1.25  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-3.015e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=24/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=9 scratch=./scratch/sweep size=60:4.47e-07GB T(load)=3.05e-04S speed=1.46e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=116:8.85e-04MB:8.64e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=51:3.89e-04MB:3.80e-07GB
total mem of comb=168:1.28e-03MB:1.25e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=6.318e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=2657:2.027e-02MB:1.980e-05GB
        per(mem): C:4.14 S:2.07 H:1.05 P:0 Q:92.7 
 rqops: oplist=CSHAB nops=C:8 S:6 H:1 A:28 B:40 
        dim(bra,ket)=10,10 size(op)=52:0.000397MB size(tot)=2014:0.0154MB:1.5e-05GB
        per(mem): C:5.96 S:4.47 H:1.39 A:8.74 B:79.4 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=6667:0.0509MB:4.97e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.063e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-2.247e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=130:9.918e-04MB
qtensor4: wf4 own=1 _data=0x5585f56c4880
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
 qbond: qcol nsym=5 dimAll=10
 (12,2):4 (12,4):3 (11,3):1 (13,3):1 (14,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=30 nblocks=400 size=130:9.918e-04MB
### DIAG TIMING: total=7.161e-03 t1=2.361e-05, t2=2.625e-05, t3=2.325e-05, t4=7.029e-03, t5=8.611e-06, t6=4.122e-05, t7=8.503e-06
duration_diagGPU:7.181e-03
duration_diagreduce:6.600e-08
duration_diagtransform:3.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=449 : 9.266e-04 S -----
rank=0 GPUmem(GB): used=4.967e-05 (oper)=4.967e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=449
 no. of hintermediate operators=226
 no. of coefficients=2834:2.162e-02MB:2.111e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.318e-04 S -----
rank=0 GPUmem(GB): used=7.079e-05 (oper,hinter)=4.967e-05,2.111e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.443e-02 S size(H_formulae)=449 size(Hxlst2)=30 T(Hmu/Hxlist)=2.783e-04,3.415e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.526e-02 S size(H_formulae)=449 size(Hxlst)=15702 -----
rank=0 GPUmem(GB): used=7.079e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.937e-06 batch[need]=5.732e-03 blksize=16 blksize0=16 batchsize=15702
rank=0 GPUmem(GB): used=5.805e-03 (oper,hinter,dvdson,batch)=4.967e-05,2.111e-05,1.937e-06,5.732e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=130 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.791e-05,2.352e-04,8.814e-04,7.763e-04,1.981e-03
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=2.548e-05 speed=7.602e-02GB/S T(nccl)=5.243e-05 speed=3.695e-02GB/S
----- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=8.8e-04 t_reduction=7.8e-04 tot=1.9e-03 -----
 sigma[inter] counter=148 t=2.4e-04 per=1.2e+01 cost=6.3e+05 flops=2.7e+09
 sigma[gemm] counter=148 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=1 t=1.7e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=2 t=1.7e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=3 t=1.7e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=4 t=2.3e-04 per=1.2e+01 cost=1.4e+05 flops=6.3e+08
 sigma[gemm] counter=148 i=5 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.4e+08
 sigma[gemm] counter=148 i=6 t=2.1e-04 per=1.1e+01 cost=1.0e+05 flops=5.0e+08
 sigma[gemm] counter=148 i=7 t=2.0e-04 per=1.1e+01 cost=1.2e+05 flops=5.9e+08
 sigma[gemm] counter=148 total t=8.8e-04 per=4.7e+01 cost=5.2e+05 flops=5.9e+08
 sigma[red] counter=148 t=7.8e-04 per=4.1e+01 cost=1.3e+05 flops=1.7e+08
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=1.0e-01 t_reduction=9.2e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=148 t=2.0e-02 per=9.3e+00 cost=5.1e+07 flops=2.6e+09
 sigma_tot[gemm] counter=148 i=0 t=3.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=1 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=2 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=3 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=4 t=2.4e-02 per=1.1e+01 cost=1.1e+07 flops=4.4e+08
 sigma_tot[gemm] counter=148 i=5 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.0e+08
 sigma_tot[gemm] counter=148 i=6 t=2.5e-02 per=1.2e+01 cost=9.9e+06 flops=3.9e+08
 sigma_tot[gemm] counter=148 i=7 t=2.5e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=148 total t=1.0e-01 per=4.8e+01 cost=4.1e+07 flops=4.0e+08
 sigma_tot[red] counter=148 t=9.2e-02 per=4.3e+01 cost=1.0e+07 flops=1.1e+08
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,4.0e-06,1.1e-06,1.1e-06,2.4e-07
settings: ndim=130 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328558693349 -1.116e+03  3.333e-02    1     1  2.324e-03 2.324e-03 2.293e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.685e-05,2.007e-04,9.928e-04,8.085e-04,2.074e-03
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=2.180e-05 speed=8.888e-02GB/S T(nccl)=4.506e-05 speed=4.300e-02GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.9e-04 t_reduction=8.1e-04 tot=2.0e-03 -----
 sigma[inter] counter=149 t=2.0e-04 per=1.0e+01 cost=6.3e+05 flops=3.1e+09
 sigma[gemm] counter=149 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=1 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=2 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=3 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=4 t=2.5e-04 per=1.3e+01 cost=1.4e+05 flops=5.7e+08
 sigma[gemm] counter=149 i=5 t=2.7e-04 per=1.4e+01 cost=1.5e+05 flops=5.7e+08
 sigma[gemm] counter=149 i=6 t=2.3e-04 per=1.2e+01 cost=1.0e+05 flops=4.4e+08
 sigma[gemm] counter=149 i=7 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.1e+08
 sigma[gemm] counter=149 total t=9.9e-04 per=5.0e+01 cost=5.2e+05 flops=5.2e+08
 sigma[red] counter=149 t=8.1e-04 per=4.0e+01 cost=1.3e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=1.0e-01 t_reduction=9.3e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=149 t=2.0e-02 per=9.3e+00 cost=5.2e+07 flops=2.6e+09
 sigma_tot[gemm] counter=149 i=0 t=3.3e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=1 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=2 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=3 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=4 t=2.4e-02 per=1.1e+01 cost=1.1e+07 flops=4.5e+08
 sigma_tot[gemm] counter=149 i=5 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.0e+08
 sigma_tot[gemm] counter=149 i=6 t=2.5e-02 per=1.2e+01 cost=1.0e+07 flops=3.9e+08
 sigma_tot[gemm] counter=149 i=7 t=2.5e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=149 total t=1.0e-01 per=4.8e+01 cost=4.2e+07 flops=4.1e+08
 sigma_tot[red] counter=149 t=9.3e-02 per=4.3e+01 cost=1.0e+07 flops=1.1e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.7e-05,3.0e-06,2.2e-06,2.5e-07
    2   0 -    -116.330776748166 -2.218e-03  8.955e-03    2     2  4.784e-03 2.392e-03 2.336e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.183e-05,1.911e-04,9.595e-04,8.289e-04,2.052e-03
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=1.784e-05 speed=1.086e-01GB/S T(nccl)=4.399e-05 speed=4.404e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.6e-04 t_reduction=8.3e-04 tot=2.0e-03 -----
 sigma[inter] counter=150 t=1.9e-04 per=9.7e+00 cost=6.3e+05 flops=3.3e+09
 sigma[gemm] counter=150 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=1 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=2 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=3 t=1.9e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=4 t=2.4e-04 per=1.2e+01 cost=1.4e+05 flops=5.9e+08
 sigma[gemm] counter=150 i=5 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=6.1e+08
 sigma[gemm] counter=150 i=6 t=2.2e-04 per=1.1e+01 cost=1.0e+05 flops=4.6e+08
 sigma[gemm] counter=150 i=7 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.1e+08
 sigma[gemm] counter=150 total t=9.6e-04 per=4.8e+01 cost=5.2e+05 flops=5.4e+08
 sigma[red] counter=150 t=8.3e-04 per=4.2e+01 cost=1.3e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=1.0e-01 t_reduction=9.4e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=150 t=2.0e-02 per=9.3e+00 cost=5.2e+07 flops=2.6e+09
 sigma_tot[gemm] counter=150 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=1 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=2 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=3 t=3.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=4 t=2.5e-02 per=1.1e+01 cost=1.1e+07 flops=4.5e+08
 sigma_tot[gemm] counter=150 i=5 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.0e+08
 sigma_tot[gemm] counter=150 i=6 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=3.9e+08
 sigma_tot[gemm] counter=150 i=7 t=2.5e-02 per=1.2e+01 cost=1.0e+07 flops=4.1e+08
 sigma_tot[gemm] counter=150 total t=1.0e-01 per=4.8e+01 cost=4.2e+07 flops=4.1e+08
 sigma_tot[red] counter=150 t=9.4e-02 per=4.3e+01 cost=1.1e+07 flops=1.1e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.8e-05,2.1e-06,1.4e-06,2.2e-07
    3   0 -    -116.330990410498 -2.137e-04  2.929e-03    3     3  7.076e-03 2.359e-03 2.302e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.522e-05,1.897e-04,9.789e-04,8.062e-04,2.044e-03
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=2.144e-05 speed=9.035e-02GB/S T(nccl)=4.378e-05 speed=4.424e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.8e-04 t_reduction=8.1e-04 tot=2.0e-03 -----
 sigma[inter] counter=151 t=1.9e-04 per=9.6e+00 cost=6.3e+05 flops=3.3e+09
 sigma[gemm] counter=151 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=1 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=2 t=2.4e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=3 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=4 t=2.6e-04 per=1.3e+01 cost=1.4e+05 flops=5.6e+08
 sigma[gemm] counter=151 i=5 t=2.8e-04 per=1.4e+01 cost=1.5e+05 flops=5.6e+08
 sigma[gemm] counter=151 i=6 t=2.1e-04 per=1.1e+01 cost=1.0e+05 flops=4.8e+08
 sigma[gemm] counter=151 i=7 t=2.2e-04 per=1.1e+01 cost=1.2e+05 flops=5.3e+08
 sigma[gemm] counter=151 total t=9.8e-04 per=5.0e+01 cost=5.2e+05 flops=5.3e+08
 sigma[red] counter=151 t=8.1e-04 per=4.1e+01 cost=1.3e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=1.0e-01 t_reduction=9.4e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=151 t=2.0e-02 per=9.3e+00 cost=5.3e+07 flops=2.6e+09
 sigma_tot[gemm] counter=151 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=1 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=2 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=3 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=4 t=2.5e-02 per=1.1e+01 cost=1.1e+07 flops=4.5e+08
 sigma_tot[gemm] counter=151 i=5 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.0e+08
 sigma_tot[gemm] counter=151 i=6 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=151 i=7 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=4.1e+08
 sigma_tot[gemm] counter=151 total t=1.0e-01 per=4.8e+01 cost=4.3e+07 flops=4.1e+08
 sigma_tot[red] counter=151 t=9.4e-02 per=4.3e+01 cost=1.1e+07 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,2.0e-06,1.2e-06,2.3e-07
    4   0 -    -116.331013186422 -2.278e-05  1.108e-03    3     4  9.391e-03 2.348e-03 2.294e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.297e-05,1.996e-04,9.771e-04,8.029e-04,2.046e-03
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=2.072e-05 speed=9.351e-02GB/S T(nccl)=4.225e-05 speed=4.585e-02GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.8e-04 t_reduction=8.0e-04 tot=2.0e-03 -----
 sigma[inter] counter=152 t=2.0e-04 per=1.0e+01 cost=6.3e+05 flops=3.1e+09
 sigma[gemm] counter=152 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=1 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=2 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=3 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=4 t=2.5e-04 per=1.3e+01 cost=1.4e+05 flops=5.7e+08
 sigma[gemm] counter=152 i=5 t=2.6e-04 per=1.3e+01 cost=1.5e+05 flops=6.0e+08
 sigma[gemm] counter=152 i=6 t=2.3e-04 per=1.1e+01 cost=1.0e+05 flops=4.5e+08
 sigma[gemm] counter=152 i=7 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.1e+08
 sigma[gemm] counter=152 total t=9.8e-04 per=4.9e+01 cost=5.2e+05 flops=5.3e+08
 sigma[red] counter=152 t=8.0e-04 per=4.1e+01 cost=1.3e+05 flops=1.7e+08
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=1.1e-01 t_reduction=9.5e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=152 t=2.1e-02 per=9.3e+00 cost=5.4e+07 flops=2.6e+09
 sigma_tot[gemm] counter=152 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=1 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=2 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=3 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=4 t=2.5e-02 per=1.1e+01 cost=1.1e+07 flops=4.5e+08
 sigma_tot[gemm] counter=152 i=5 t=2.8e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=152 i=6 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=152 i=7 t=2.6e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=152 total t=1.1e-01 per=4.8e+01 cost=4.3e+07 flops=4.1e+08
 sigma_tot[red] counter=152 t=9.5e-02 per=4.3e+01 cost=1.1e+07 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,1.9e-06,1.2e-06,2.1e-07
    5   0 -    -116.331016817102 -3.631e-06  4.098e-04    3     5  1.169e-02 2.338e-03 2.285e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.308e-05,1.873e-04,9.676e-04,7.966e-04,2.019e-03
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=2.088e-05 speed=9.277e-02GB/S T(nccl)=4.220e-05 speed=4.591e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.7e-04 t_reduction=8.0e-04 tot=2.0e-03 -----
 sigma[inter] counter=153 t=1.9e-04 per=9.6e+00 cost=6.3e+05 flops=3.4e+09
 sigma[gemm] counter=153 i=0 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=1 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=2 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=3 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=4 t=2.5e-04 per=1.3e+01 cost=1.4e+05 flops=5.9e+08
 sigma[gemm] counter=153 i=5 t=2.6e-04 per=1.4e+01 cost=1.5e+05 flops=5.8e+08
 sigma[gemm] counter=153 i=6 t=2.2e-04 per=1.1e+01 cost=1.0e+05 flops=4.6e+08
 sigma[gemm] counter=153 i=7 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.2e+08
 sigma[gemm] counter=153 total t=9.7e-04 per=5.0e+01 cost=5.2e+05 flops=5.4e+08
 sigma[red] counter=153 t=8.0e-04 per=4.1e+01 cost=1.3e+05 flops=1.7e+08
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=1.1e-01 t_reduction=9.6e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=153 t=2.1e-02 per=9.3e+00 cost=5.4e+07 flops=2.6e+09
 sigma_tot[gemm] counter=153 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=1 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=2 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=3 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=4 t=2.5e-02 per=1.1e+01 cost=1.1e+07 flops=4.5e+08
 sigma_tot[gemm] counter=153 i=5 t=2.8e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=153 i=6 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=153 i=7 t=2.6e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=153 total t=1.1e-01 per=4.8e+01 cost=4.4e+07 flops=4.1e+08
 sigma_tot[red] counter=153 t=9.6e-02 per=4.3e+01 cost=1.1e+07 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.2e-05,1.9e-06,1.2e-06,2.0e-07
    6   0 -    -116.331017275736 -4.586e-07  1.172e-04    3     6  1.396e-02 2.327e-03 2.275e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.427e-05,1.830e-04,9.537e-04,8.049e-04,2.010e-03
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=2.088e-05 speed=9.279e-02GB/S T(nccl)=4.339e-05 speed=4.465e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=9.5e-04 t_reduction=8.0e-04 tot=1.9e-03 -----
 sigma[inter] counter=154 t=1.8e-04 per=9.4e+00 cost=6.3e+05 flops=3.4e+09
 sigma[gemm] counter=154 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=1 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=2 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=3 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=4 t=2.4e-04 per=1.2e+01 cost=1.4e+05 flops=6.0e+08
 sigma[gemm] counter=154 i=5 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=6.1e+08
 sigma[gemm] counter=154 i=6 t=2.3e-04 per=1.2e+01 cost=1.0e+05 flops=4.5e+08
 sigma[gemm] counter=154 i=7 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.2e+08
 sigma[gemm] counter=154 total t=9.5e-04 per=4.9e+01 cost=5.2e+05 flops=5.4e+08
 sigma[red] counter=154 t=8.0e-04 per=4.1e+01 cost=1.3e+05 flops=1.7e+08
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=1.1e-01 t_reduction=9.7e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=154 t=2.1e-02 per=9.3e+00 cost=5.5e+07 flops=2.6e+09
 sigma_tot[gemm] counter=154 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=1 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=2 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=3 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=4 t=2.6e-02 per=1.1e+01 cost=1.2e+07 flops=4.5e+08
 sigma_tot[gemm] counter=154 i=5 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.1e+08
 sigma_tot[gemm] counter=154 i=6 t=2.6e-02 per=1.2e+01 cost=1.0e+07 flops=4.0e+08
 sigma_tot[gemm] counter=154 i=7 t=2.6e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=154 total t=1.1e-01 per=4.8e+01 cost=4.4e+07 flops=4.1e+08
 sigma_tot[red] counter=154 t=9.7e-02 per=4.3e+01 cost=1.1e+07 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.2e-05,2.0e-06,1.2e-06,2.1e-07
    7   0 +    -116.331017307255 -3.152e-08  2.668e-05    3     7  1.623e-02 2.318e-03 2.265e-03
TIMING FOR Davidson : 1.624e-02  T(cal/comm/rest)=1.585e-02,1.862e-06,3.822e-04
decomposed t_rest=3.822e-04
 T(sub)    =1.463e-04 per=3.827e+01
 T(precond)=2.366e-05 per=6.189e+00
 T(ortho)  =1.016e-05 per=2.657e+00
 T(xcopy)  =8.220e-07 per=2.150e-01
 T(xnrm2)  =1.386e-06 per=3.626e-01
 T(other)  =1.999e-04 per=5.231e+01
optimized energies: isweep=0 ibond=24 dots=2 e[0]=-116.331017307255 nmvp=7
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=5.409e-03 change=4.010e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=11 dimAll=40
 (12,2):5 (12,4):4 (11,3):1 (13,3):9 (14,2):6 (14,4):4 (15,3):2 (16,2):1 (13,1):4 (13,5):3 (15,1):1
timing for divide=8.6e-06
timing for compute=7.0e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(su2): 9.1e-05 S T(divide/compute[cpu/gpu/rest]/collect)=8.6e-06,6.5e-05,0.0e+00,5.2e-06,1.2e-05 -----
decimation summary: 40->10 dwt=+3.623e-03 SvN=1.286e+00
 qbond: qkept nsym=4 dimAll=10
 (14,2):5 (14,4):3 (13,3):1 (15,3):1
----- TIMING for decimation_row(nkr): 1.152e-03 S T(decim/select/formRot)=1.374e-04,9.933e-04,2.176e-05 -----
----- TIMING FOR twodot_decimation: 1.273e-03 S T(wf/decim)=1.060e-04,1.167e-03 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:9 S:5 H:1 A:40 B:44 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=2544:1.941e-02MB:1.895e-05GB
        per(mem): C:5.66 S:3.14 H:1.42 A:1.57 B:88.2 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=5.409e-03 change=1.462e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=94 : 1.219e-04 S -----
rank=0 GPUmem(GB): used=6.995e-05 (oper)=4.140e-05
rank=0 GPUmem(GB): used=7.034e-05 (oper,site)=4.140e-05,3.949e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=94
 no. of rintermediate operators=5
 no. of coefficients=96:7.324e-04MB:7.153e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.484e-05 S -----
rank=0 GPUmem(GB): used=7.106e-05 (oper,site,rinter)=4.140e-05,3.949e-07,7.153e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.193e-03 S size(rtasks)=94 size(Rlst2)=16 T(Rmu/Rlist)=6.445e-05,1.128e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.281e-03 S size(rtasks)=94 size(Rlst)=981 -----
rank=0 GPUmem(GB): used=7.106e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.897e-04 blksize=25 blksize0=16 batchsize=981
rank=0 GPUmem(GB): used=5.608e-04 (oper,site,rinter,batch)=4.140e-05,3.949e-07,7.153e-07,4.897e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.296e-04,4.985e-04,1.759e-04
----- TIMING FOR renorm : t_inter=1.3e-04 t_gemm=5.0e-04 t_reduction=1.8e-04 tot=8.0e-04 -----
 renorm[inter] counter=294 t=1.3e-04 per=1.6e+01 cost=1.7e+04 flops=1.3e+08
 renorm[gemm] counter=294 i=0 t=2.1e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=294 i=1 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=294 i=2 t=1.6e-04 per=2.0e+01 cost=2.0e+03 flops=1.3e+07
 renorm[gemm] counter=294 i=3 t=1.8e-04 per=2.2e+01 cost=2.0e+04 flops=1.1e+08
 renorm[gemm] counter=294 i=4 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=294 i=5 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=294 i=6 t=1.5e-04 per=1.9e+01 cost=3.0e+04 flops=1.9e+08
 renorm[gemm] counter=294 total t=5.0e-04 per=6.2e+01 cost=5.2e+04 flops=1.0e+08
 renorm[red] counter=294 t=1.8e-04 per=2.2e+01 cost=1.5e+04 flops=8.5e+07
----- TIMING FOR renorm_tot : t_inter=2.5e-03 t_gemm=1.1e-02 t_reduction=4.1e-03 tot=1.8e-02 -----
 renorm_tot[inter] counter=294 t=2.5e-03 per=1.4e+01 cost=4.2e+05 flops=1.7e+08
 renorm_tot[gemm] counter=294 i=0 t=5.4e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=294 i=1 t=4.8e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=294 i=2 t=1.3e-03 per=7.4e+00 cost=1.6e+04 flops=1.3e+07
 renorm_tot[gemm] counter=294 i=3 t=1.5e-03 per=8.5e+00 cost=6.9e+04 flops=4.6e+07
 renorm_tot[gemm] counter=294 i=4 t=2.2e-03 per=1.2e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=294 i=5 t=2.3e-03 per=1.3e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=294 i=6 t=3.6e-03 per=2.0e+01 cost=5.5e+05 flops=1.5e+08
 renorm_tot[gemm] counter=294 total t=1.1e-02 per=6.2e+01 cost=9.3e+05 flops=8.5e+07
 renorm_tot[red] counter=294 t=4.1e-03 per=2.4e+01 cost=2.4e+05 flops=5.9e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=8.053e-05 (oper)=4.151e-05
rank=0 GPUmem(GB): used=8.092e-05 (oper,site,rinter)=4.151e-05,3.949e-07,9.745e-06
rank=0 GPUmem(GB): used=1.145e-04 (oper,site,rinter,batch)=4.151e-05,3.949e-07,9.745e-06,3.355e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.222e-03 S T(preprocess/alloc/comp/red/dealloc)=1.395e-03,1.449e-03,4.438e-03,2.224e-04,9.267e-05 -----
----- TIMING FOR oper_renorm_opS : 6.251e-03 S rank=0 -----
qops.to_cpu: size(tot)=2544:1.941e-02MB:1.895e-05GB T(to_cpu)=4.172e-05S speed=4.543e-01GB/S
check ||H-H.dagger||=7.046e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.00992 S rank=0 -----
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=6.371e-03 change=2.817e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=6.371e-03 change=-1.486e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=6.371e-03 change=-3.308e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 8.413e-02 S #####
 T(local opt: fetch) = 2.778e-03 S  per =  3.3  per(accum) = 3.3
 T(local opt: hdiag) = 7.325e-03 S  per = 8.71  per(accum) = 12
 T(local opt: dvdsn) = 5.982e-02 S  per = 71.1  per(accum) = 83.1
 T(local opt: decim) = 1.308e-03 S  per = 1.55  per(accum) = 84.7
 T(local opt: guess) = 1.040e-04 S  per = 0.124  per(accum) = 84.8
 T(local opt: renrm) = 1.095e-02 S  per =   13  per(accum) = 97.8
 T(local opt: save ) = 1.844e-03 S  per = 2.19  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.982e-02 S  T(sum) = 5.912e-02 S  per = 9.883e+01
 T(local opt: preprocess                  ) = 5.593e-04 S  per = 0.946  per(accum) = 0.946
 T(local opt: symbolic_formulae           ) = 9.433e-04 S  per =  1.6  per(accum) = 2.54
 T(local opt: hintermediate init          ) = 1.519e-04 S  per = 0.257  per(accum) = 2.8
 T(local opt: preprocess_hformulae_Hxlist ) = 3.541e-02 S  per = 59.9  per(accum) = 62.7
 T(local opt: hmmtasks init               ) = 5.653e-03 S  per = 9.56  per(accum) = 72.3
 T(local opt: initial guess for dvdson    ) = 1.648e-04 S  per = 0.279  per(accum) = 72.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.539e-02 S  per =   26  per(accum) = 98.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.490e-04 S  per = 0.252  per(accum) = 98.8
 T(local opt: dvdson [nccl]               ) = 3.131e-04 S  per = 0.53  per(accum) = 99.4
 T(local opt: dvdson [mpi]                ) = 1.862e-06 S  per = 0.00315  per(accum) = 99.4
 T(local opt: dvdson [rest part(linalg)]  ) = 3.822e-04 S  per = 0.647  per(accum) = 100
Detailed decomposition of T(renrm) = 1.095e-02 S  T(sum) = 1.095e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.581e-05 S  per = 0.51  per(accum) = 0.51
 T(local opt: qops init                    ) = 4.050e-04 S  per =  3.7  per(accum) = 4.21
 T(local opt: symbolic_formulae_renorm     ) = 1.328e-04 S  per = 1.21  per(accum) = 5.42
 T(local opt: allocate qops on gpu         ) = 6.167e-05 S  per = 0.563  per(accum) = 5.98
 T(local opt: site memcpy cpu2gpu          ) = 2.810e-05 S  per = 0.257  per(accum) = 6.24
 T(local opt: rintermediate init           ) = 5.634e-05 S  per = 0.515  per(accum) = 6.75
 T(local opt: preprocess_formulae_Rlist2   ) = 1.308e-03 S  per = 11.9  per(accum) = 18.7
 T(local opt: rmmtasks init                ) = 5.155e-04 S  per = 4.71  per(accum) = 23.4
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 0.000347  per(accum) = 23.4
 T(local opt: preprocess_renorm_batchGPU   ) = 1.002e-03 S  per = 9.15  per(accum) = 32.6
 T(local opt: deallocate cpu and gpu memory) = 3.193e-05 S  per = 0.292  per(accum) = 32.9
 T(local opt: construct opS [ifdists=true] ) = 6.298e-03 S  per = 57.5  per(accum) = 90.4
 T(local opt: reduction of opS & opH [nccl]) = 1.882e-05 S  per = 0.172  per(accum) = 90.5
 T(local opt: qops memcpy gpu2cpu          ) = 5.155e-05 S  per = 0.471  per(accum) = 91
 T(local opt: reduction of opS & opH [mpi] ) = 1.181e-05 S  per = 0.108  per(accum) = 91.1
 T(local opt: qops_pool join and erase     ) = 9.691e-04 S  per = 8.85  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.555e-06 S  per = 0.0233  per(accum) = 100
ctns::rcanon_save_site idx=8 scratch=./scratch/sweep size=53:3.9e-07GB T(load)=0.00059S speed=0.00067GB/S
##### sweep opt: 1.168e+00 S #####
 T(sweep opt: fetch) = 6.310e-02 S  per =  5.4  per(accum) = 5.4
 T(sweep opt: hdiag) = 5.963e-02 S  per = 5.11  per(accum) = 10.5
 T(sweep opt: dvdsn) = 7.321e-01 S  per = 62.7  per(accum) = 73.2
 T(sweep opt: decim) = 2.812e-02 S  per = 2.41  per(accum) = 75.6
 T(sweep opt: guess) = 2.220e-03 S  per = 0.19  per(accum) = 75.8
 T(sweep opt: renrm) = 2.360e-01 S  per = 20.2  per(accum) = 96
 T(sweep opt: save ) = 4.653e-02 S  per = 3.98  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.321e-01 S  T(sum) = 7.213e-01 S  per = 9.853e+01
 T(sweep opt: preprocess                  ) = 8.222e-03 S  per = 1.14  per(accum) = 1.14
 T(sweep opt: symbolic_formulae           ) = 1.167e-02 S  per = 1.62  per(accum) = 2.76
 T(sweep opt: hintermediate init          ) = 1.821e-03 S  per = 0.252  per(accum) = 3.01
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.502e-01 S  per = 48.5  per(accum) = 51.6
 T(sweep opt: hmmtasks init               ) = 6.679e-02 S  per = 9.26  per(accum) = 60.8
 T(sweep opt: initial guess for dvdson    ) = 3.556e-03 S  per = 0.493  per(accum) = 61.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.588e-01 S  per = 35.9  per(accum) = 97.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.431e-03 S  per = 0.476  per(accum) = 97.7
 T(sweep opt: dvdson [nccl]               ) = 8.330e-03 S  per = 1.15  per(accum) = 98.8
 T(sweep opt: dvdson [mpi]                ) = 7.991e-05 S  per = 0.0111  per(accum) = 98.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.427e-03 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm) = 2.360e-01 S  T(sum) = 2.360e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.336e-03 S  per = 0.566  per(accum) = 0.566
 T(sweep opt: qops init                    ) = 8.528e-03 S  per = 3.61  per(accum) = 4.18
 T(sweep opt: symbolic_formulae_renorm     ) = 3.612e-03 S  per = 1.53  per(accum) = 5.71
 T(sweep opt: allocate qops on gpu         ) = 1.415e-03 S  per =  0.6  per(accum) = 6.31
 T(sweep opt: site memcpy cpu2gpu          ) = 6.336e-04 S  per = 0.269  per(accum) = 6.58
 T(sweep opt: rintermediate init           ) = 1.151e-03 S  per = 0.488  per(accum) = 7.07
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.888e-02 S  per = 12.2  per(accum) = 19.3
 T(sweep opt: rmmtasks init                ) = 9.273e-03 S  per = 3.93  per(accum) = 23.2
 T(sweep opt: qops memset on cpu           ) = 1.167e-06 S  per = 0.000495  per(accum) = 23.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.102e-02 S  per = 8.91  per(accum) = 32.1
 T(sweep opt: deallocate cpu and gpu memory) = 7.507e-04 S  per = 0.318  per(accum) = 32.5
 T(sweep opt: construct opS [ifdists=true] ) = 1.364e-01 S  per = 57.8  per(accum) = 90.3
 T(sweep opt: reduction of opS & opH [nccl]) = 4.730e-04 S  per =  0.2  per(accum) = 90.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.892e-04 S  per = 0.377  per(accum) = 90.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.999e-04 S  per = 0.169  per(accum) = 91
 T(sweep opt: qops_pool join and erase     ) = 1.838e-02 S  per = 7.79  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.812e-03 S  per = 1.19  per(accum) = 100
##### global opt: 1.168e+00 S #####
 T(global opt: fetch) = 6.310e-02 S  per =  5.4  per(accum) = 5.4
 T(global opt: hdiag) = 5.963e-02 S  per = 5.11  per(accum) = 10.5
 T(global opt: dvdsn) = 7.321e-01 S  per = 62.7  per(accum) = 73.2
 T(global opt: decim) = 2.812e-02 S  per = 2.41  per(accum) = 75.6
 T(global opt: guess) = 2.220e-03 S  per = 0.19  per(accum) = 75.8
 T(global opt: renrm) = 2.360e-01 S  per = 20.2  per(accum) = 96
 T(global opt: save ) = 4.653e-02 S  per = 3.98  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.321e-01 S  T(sum) = 7.213e-01 S  per = 9.853e+01
 T(global opt: preprocess                  ) = 8.222e-03 S  per = 1.14  per(accum) = 1.14
 T(global opt: symbolic_formulae           ) = 1.167e-02 S  per = 1.62  per(accum) = 2.76
 T(global opt: hintermediate init          ) = 1.821e-03 S  per = 0.252  per(accum) = 3.01
 T(global opt: preprocess_hformulae_Hxlist ) = 3.502e-01 S  per = 48.5  per(accum) = 51.6
 T(global opt: hmmtasks init               ) = 6.679e-02 S  per = 9.26  per(accum) = 60.8
 T(global opt: initial guess for dvdson    ) = 3.556e-03 S  per = 0.493  per(accum) = 61.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.588e-01 S  per = 35.9  per(accum) = 97.2
 T(global opt: dvdson [cpu-gpu]            ) = 3.431e-03 S  per = 0.476  per(accum) = 97.7
 T(global opt: dvdson [nccl]               ) = 8.330e-03 S  per = 1.15  per(accum) = 98.8
 T(global opt: dvdson [mpi]                ) = 7.991e-05 S  per = 0.0111  per(accum) = 98.8
 T(global opt: dvdson [rest part(linalg)]  ) = 8.427e-03 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm) = 2.360e-01 S  T(sum) = 2.360e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.336e-03 S  per = 0.566  per(accum) = 0.566
 T(global opt: qops init                    ) = 8.528e-03 S  per = 3.61  per(accum) = 4.18
 T(global opt: symbolic_formulae_renorm     ) = 3.612e-03 S  per = 1.53  per(accum) = 5.71
 T(global opt: allocate qops on gpu         ) = 1.415e-03 S  per =  0.6  per(accum) = 6.31
 T(global opt: site memcpy cpu2gpu          ) = 6.336e-04 S  per = 0.269  per(accum) = 6.58
 T(global opt: rintermediate init           ) = 1.151e-03 S  per = 0.488  per(accum) = 7.07
 T(global opt: preprocess_formulae_Rlist2   ) = 2.888e-02 S  per = 12.2  per(accum) = 19.3
 T(global opt: rmmtasks init                ) = 9.273e-03 S  per = 3.93  per(accum) = 23.2
 T(global opt: qops memset on cpu           ) = 1.167e-06 S  per = 0.000495  per(accum) = 23.2
 T(global opt: preprocess_renorm_batchGPU   ) = 2.102e-02 S  per = 8.91  per(accum) = 32.1
 T(global opt: deallocate cpu and gpu memory) = 7.507e-04 S  per = 0.318  per(accum) = 32.5
 T(global opt: construct opS [ifdists=true] ) = 1.364e-01 S  per = 57.8  per(accum) = 90.3
 T(global opt: reduction of opS & opH [nccl]) = 4.730e-04 S  per =  0.2  per(accum) = 90.5
 T(global opt: qops memcpy gpu2cpu          ) = 8.892e-04 S  per = 0.377  per(accum) = 90.8
 T(global opt: reduction of opS & opH [mpi] ) = 3.999e-04 S  per = 0.169  per(accum) = 91
 T(global opt: qops_pool join and erase     ) = 1.838e-02 S  per = 7.79  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 2.812e-03 S  per = 1.19  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-4.015e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=25/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=10 scratch=./scratch/sweep size=59:4.40e-07GB T(load)=3.02e-04S speed=1.46e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=119:9.08e-04MB:8.87e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=63:4.81e-04MB:4.69e-07GB
total mem of comb=183:1.40e-03MB:1.36e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=7.465e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:9 S:6 H:1 P:59 Q:66 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2881:2.198e-02MB:2.147e-05GB
        per(mem): C:3.75 S:2.5 H:0.972 P:0 Q:92.8 
 rqops: oplist=CSHAB nops=C:9 S:5 H:1 A:40 B:44 
        dim(bra,ket)=10,10 size(op)=66:0.000504MB size(tot)=2544:0.0194MB:1.9e-05GB
        per(mem): C:5.66 S:3.14 H:1.42 A:1.57 B:88.2 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=7421:0.0566MB:5.53e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=1.103e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-2.247e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=176:1.343e-03MB
qtensor4: wf4 own=1 _data=0x5585f64c4000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
 qbond: qcol nsym=4 dimAll=10
 (14,2):5 (14,4):3 (13,3):1 (15,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=31 nblocks=304 size=176:1.343e-03MB
### DIAG TIMING: total=6.328e-03 t1=1.627e-05, t2=1.828e-05, t3=1.845e-05, t4=6.226e-03, t5=6.625e-06, t6=3.675e-05, t7=6.258e-06
duration_diagGPU:6.346e-03
duration_diagreduce:3.700e-08
duration_diagtransform:4.280e-07
----- TIMING FOR symbolic_formulae_twodot with size=523 : 8.634e-04 S -----
rank=0 GPUmem(GB): used=5.529e-05 (oper)=5.529e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=523
 no. of hintermediate operators=259
 no. of coefficients=3136:2.393e-02MB:2.337e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.170e-04 S -----
rank=0 GPUmem(GB): used=7.866e-05 (oper,hinter)=5.529e-05,2.337e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.640e-02 S size(H_formulae)=523 size(Hxlst2)=31 T(Hmu/Hxlist)=2.643e-04,3.614e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.753e-02 S size(H_formulae)=523 size(Hxlst)=20720 -----
rank=0 GPUmem(GB): used=7.866e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.623e-06 batch[need]=1.019e-02 blksize=20 blksize0=25 batchsize=20720
rank=0 GPUmem(GB): used=1.027e-02 (oper,hinter,dvdson,batch)=5.529e-05,2.337e-05,2.623e-06,1.019e-02
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=176 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.632e-05,2.752e-04,8.607e-04,8.333e-04,2.066e-03
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.681e-05 speed=9.782e-02GB/S T(nccl)=5.950e-05 speed=4.407e-02GB/S
----- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=8.6e-04 t_reduction=8.3e-04 tot=2.0e-03 -----
 sigma[inter] counter=155 t=2.8e-04 per=1.4e+01 cost=1.5e+06 flops=5.3e+09
 sigma[gemm] counter=155 i=0 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=1 t=1.7e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=2 t=1.7e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=3 t=1.7e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=4 t=2.3e-04 per=1.2e+01 cost=4.1e+05 flops=1.8e+09
 sigma[gemm] counter=155 i=5 t=2.3e-04 per=1.2e+01 cost=4.2e+05 flops=1.8e+09
 sigma[gemm] counter=155 i=6 t=2.0e-04 per=1.0e+01 cost=1.9e+05 flops=9.6e+08
 sigma[gemm] counter=155 i=7 t=1.9e-04 per=9.7e+00 cost=2.0e+05 flops=1.0e+09
 sigma[gemm] counter=155 total t=8.6e-04 per=4.4e+01 cost=1.2e+06 flops=1.4e+09
 sigma[red] counter=155 t=8.3e-04 per=4.2e+01 cost=2.5e+05 flops=3.0e+08
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=1.1e-01 t_reduction=9.8e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=155 t=2.1e-02 per=9.4e+00 cost=5.6e+07 flops=2.7e+09
 sigma_tot[gemm] counter=155 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=1 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=2 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=3 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=4 t=2.6e-02 per=1.1e+01 cost=1.2e+07 flops=4.6e+08
 sigma_tot[gemm] counter=155 i=5 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.2e+08
 sigma_tot[gemm] counter=155 i=6 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.0e+08
 sigma_tot[gemm] counter=155 i=7 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=155 total t=1.1e-01 per=4.8e+01 cost=4.6e+07 flops=4.2e+08
 sigma_tot[red] counter=155 t=9.8e-02 per=4.3e+01 cost=1.1e+07 flops=1.2e+08
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,4.7e-06,1.2e-06,1.5e-06,2.5e-07
settings: ndim=176 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.329089711429 -1.116e+03  3.540e-02    1     1  2.373e-03 2.373e-03 2.340e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.743e-05,2.037e-04,9.757e-04,8.909e-04,2.143e-03
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.183e-05 speed=1.201e-01GB/S T(nccl)=4.560e-05 speed=5.751e-02GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.8e-04 t_reduction=8.9e-04 tot=2.1e-03 -----
 sigma[inter] counter=156 t=2.0e-04 per=9.8e+00 cost=1.5e+06 flops=7.2e+09
 sigma[gemm] counter=156 i=0 t=2.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=1 t=1.9e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=2 t=1.9e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=3 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=4 t=2.4e-04 per=1.2e+01 cost=4.1e+05 flops=1.7e+09
 sigma[gemm] counter=156 i=5 t=2.6e-04 per=1.2e+01 cost=4.2e+05 flops=1.6e+09
 sigma[gemm] counter=156 i=6 t=2.4e-04 per=1.1e+01 cost=1.9e+05 flops=8.2e+08
 sigma[gemm] counter=156 i=7 t=2.4e-04 per=1.1e+01 cost=2.0e+05 flops=8.3e+08
 sigma[gemm] counter=156 total t=9.8e-04 per=4.7e+01 cost=1.2e+06 flops=1.2e+09
 sigma[red] counter=156 t=8.9e-04 per=4.3e+01 cost=2.5e+05 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=1.1e-01 t_reduction=9.9e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=156 t=2.1e-02 per=9.4e+00 cost=5.8e+07 flops=2.7e+09
 sigma_tot[gemm] counter=156 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=1 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=2 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=3 t=3.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=4 t=2.6e-02 per=1.1e+01 cost=1.2e+07 flops=4.8e+08
 sigma_tot[gemm] counter=156 i=5 t=2.9e-02 per=1.2e+01 cost=1.2e+07 flops=4.3e+08
 sigma_tot[gemm] counter=156 i=6 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.0e+08
 sigma_tot[gemm] counter=156 i=7 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.2e+08
 sigma_tot[gemm] counter=156 total t=1.1e-01 per=4.8e+01 cost=4.7e+07 flops=4.3e+08
 sigma_tot[red] counter=156 t=9.9e-02 per=4.3e+01 cost=1.2e+07 flops=1.2e+08
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=8.0e-06,2.2e-05,3.0e-06,2.1e-06,2.6e-07
    2   0 -    -116.332238333927 -3.149e-03  9.601e-03    2     2  4.922e-03 2.461e-03 2.384e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.556e-05,1.899e-04,9.423e-04,8.851e-04,2.087e-03
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.122e-05 speed=1.236e-01GB/S T(nccl)=4.434e-05 speed=5.914e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.4e-04 t_reduction=8.8e-04 tot=2.0e-03 -----
 sigma[inter] counter=157 t=1.9e-04 per=9.4e+00 cost=1.5e+06 flops=7.7e+09
 sigma[gemm] counter=157 i=0 t=2.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=1 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=2 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=3 t=2.0e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=4 t=2.3e-04 per=1.2e+01 cost=4.1e+05 flops=1.8e+09
 sigma[gemm] counter=157 i=5 t=2.6e-04 per=1.3e+01 cost=4.2e+05 flops=1.6e+09
 sigma[gemm] counter=157 i=6 t=2.2e-04 per=1.1e+01 cost=1.9e+05 flops=8.9e+08
 sigma[gemm] counter=157 i=7 t=2.3e-04 per=1.1e+01 cost=2.0e+05 flops=8.7e+08
 sigma[gemm] counter=157 total t=9.4e-04 per=4.7e+01 cost=1.2e+06 flops=1.3e+09
 sigma[red] counter=157 t=8.8e-04 per=4.4e+01 cost=2.5e+05 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.1e-01 t_reduction=9.9e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=157 t=2.2e-02 per=9.4e+00 cost=5.9e+07 flops=2.7e+09
 sigma_tot[gemm] counter=157 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=1 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=2 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=3 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=4 t=2.6e-02 per=1.1e+01 cost=1.3e+07 flops=4.9e+08
 sigma_tot[gemm] counter=157 i=5 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.4e+08
 sigma_tot[gemm] counter=157 i=6 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=157 i=7 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.2e+08
 sigma_tot[gemm] counter=157 total t=1.1e-01 per=4.8e+01 cost=4.8e+07 flops=4.3e+08
 sigma_tot[red] counter=157 t=9.9e-02 per=4.3e+01 cost=1.2e+07 flops=1.2e+08
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,2.1e-05,2.2e-06,2.3e-06,2.4e-07
    3   0 -    -116.332525303671 -2.870e-04  3.692e-03    3     3  7.261e-03 2.420e-03 2.348e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.547e-05,1.874e-04,9.415e-04,8.803e-04,2.079e-03
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.113e-05 speed=1.241e-01GB/S T(nccl)=4.434e-05 speed=5.915e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.4e-04 t_reduction=8.8e-04 tot=2.0e-03 -----
 sigma[inter] counter=158 t=1.9e-04 per=9.3e+00 cost=1.5e+06 flops=7.8e+09
 sigma[gemm] counter=158 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=1 t=1.9e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=2 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=3 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=4 t=2.4e-04 per=1.2e+01 cost=4.1e+05 flops=1.7e+09
 sigma[gemm] counter=158 i=5 t=2.5e-04 per=1.3e+01 cost=4.2e+05 flops=1.7e+09
 sigma[gemm] counter=158 i=6 t=2.1e-04 per=1.1e+01 cost=1.9e+05 flops=9.0e+08
 sigma[gemm] counter=158 i=7 t=2.3e-04 per=1.1e+01 cost=2.0e+05 flops=8.7e+08
 sigma[gemm] counter=158 total t=9.4e-04 per=4.7e+01 cost=1.2e+06 flops=1.3e+09
 sigma[red] counter=158 t=8.8e-04 per=4.4e+01 cost=2.5e+05 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.3e-01 -----
 sigma_tot[inter] counter=158 t=2.2e-02 per=9.4e+00 cost=6.1e+07 flops=2.8e+09
 sigma_tot[gemm] counter=158 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=1 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=2 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=3 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=4 t=2.6e-02 per=1.1e+01 cost=1.3e+07 flops=5.0e+08
 sigma_tot[gemm] counter=158 i=5 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=158 i=6 t=2.7e-02 per=1.2e+01 cost=1.1e+07 flops=4.1e+08
 sigma_tot[gemm] counter=158 i=7 t=2.7e-02 per=1.2e+01 cost=1.2e+07 flops=4.2e+08
 sigma_tot[gemm] counter=158 total t=1.1e-01 per=4.8e+01 cost=4.9e+07 flops=4.4e+08
 sigma_tot[red] counter=158 t=1.0e-01 per=4.3e+01 cost=1.2e+07 flops=1.2e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.4e-05,1.9e-06,1.5e-06,1.9e-07
    4   0 -    -116.332566343534 -4.104e-05  1.347e-03    3     4  9.601e-03 2.400e-03 2.333e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.477e-05,1.877e-04,9.521e-04,8.846e-04,2.093e-03
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.093e-05 speed=1.253e-01GB/S T(nccl)=4.383e-05 speed=5.983e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.5e-04 t_reduction=8.8e-04 tot=2.0e-03 -----
 sigma[inter] counter=159 t=1.9e-04 per=9.3e+00 cost=1.5e+06 flops=7.8e+09
 sigma[gemm] counter=159 i=0 t=2.0e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=1 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=2 t=1.9e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=3 t=1.8e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=4 t=2.3e-04 per=1.1e+01 cost=4.1e+05 flops=1.8e+09
 sigma[gemm] counter=159 i=5 t=2.5e-04 per=1.3e+01 cost=4.2e+05 flops=1.7e+09
 sigma[gemm] counter=159 i=6 t=2.3e-04 per=1.1e+01 cost=1.9e+05 flops=8.3e+08
 sigma[gemm] counter=159 i=7 t=2.3e-04 per=1.1e+01 cost=2.0e+05 flops=8.6e+08
 sigma[gemm] counter=159 total t=9.5e-04 per=4.7e+01 cost=1.2e+06 flops=1.3e+09
 sigma[red] counter=159 t=8.8e-04 per=4.4e+01 cost=2.5e+05 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.4e-01 -----
 sigma_tot[inter] counter=159 t=2.2e-02 per=9.4e+00 cost=6.2e+07 flops=2.8e+09
 sigma_tot[gemm] counter=159 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=1 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=2 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=3 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=4 t=2.7e-02 per=1.1e+01 cost=1.4e+07 flops=5.1e+08
 sigma_tot[gemm] counter=159 i=5 t=2.9e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=159 i=6 t=2.8e-02 per=1.2e+01 cost=1.1e+07 flops=4.2e+08
 sigma_tot[gemm] counter=159 i=7 t=2.7e-02 per=1.2e+01 cost=1.2e+07 flops=4.3e+08
 sigma_tot[gemm] counter=159 total t=1.1e-01 per=4.8e+01 cost=5.0e+07 flops=4.5e+08
 sigma_tot[red] counter=159 t=1.0e-01 per=4.3e+01 cost=1.2e+07 flops=1.2e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.2e-05,1.9e-06,1.4e-06,1.7e-07
    5   0 -    -116.332571893963 -5.550e-06  4.656e-04    3     5  1.194e-02 2.388e-03 2.324e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.496e-05,1.857e-04,9.366e-04,8.823e-04,2.074e-03
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.098e-05 speed=1.250e-01GB/S T(nccl)=4.397e-05 speed=5.964e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.4e-04 t_reduction=8.8e-04 tot=2.0e-03 -----
 sigma[inter] counter=160 t=1.9e-04 per=9.3e+00 cost=1.5e+06 flops=7.9e+09
 sigma[gemm] counter=160 i=0 t=2.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=1 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=2 t=1.8e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=3 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=4 t=2.3e-04 per=1.2e+01 cost=4.1e+05 flops=1.8e+09
 sigma[gemm] counter=160 i=5 t=2.6e-04 per=1.3e+01 cost=4.2e+05 flops=1.6e+09
 sigma[gemm] counter=160 i=6 t=2.2e-04 per=1.1e+01 cost=1.9e+05 flops=8.9e+08
 sigma[gemm] counter=160 i=7 t=2.2e-04 per=1.1e+01 cost=2.0e+05 flops=8.9e+08
 sigma[gemm] counter=160 total t=9.4e-04 per=4.7e+01 cost=1.2e+06 flops=1.3e+09
 sigma[red] counter=160 t=8.8e-04 per=4.4e+01 cost=2.5e+05 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.4e-01 -----
 sigma_tot[inter] counter=160 t=2.2e-02 per=9.4e+00 cost=6.4e+07 flops=2.9e+09
 sigma_tot[gemm] counter=160 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=1 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=2 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=3 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=4 t=2.7e-02 per=1.1e+01 cost=1.4e+07 flops=5.2e+08
 sigma_tot[gemm] counter=160 i=5 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.7e+08
 sigma_tot[gemm] counter=160 i=6 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.2e+08
 sigma_tot[gemm] counter=160 i=7 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.3e+08
 sigma_tot[gemm] counter=160 total t=1.1e-01 per=4.8e+01 cost=5.2e+07 flops=4.6e+08
 sigma_tot[red] counter=160 t=1.0e-01 per=4.3e+01 cost=1.3e+07 flops=1.2e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.2e-05,2.1e-06,1.4e-06,2.1e-07
    6   0 -    -116.332572616535 -7.226e-07  1.438e-04    3     6  1.426e-02 2.377e-03 2.316e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.423e-05,1.935e-04,9.708e-04,8.785e-04,2.111e-03
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.081e-05 speed=1.260e-01GB/S T(nccl)=4.343e-05 speed=6.039e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.7e-04 t_reduction=8.8e-04 tot=2.0e-03 -----
 sigma[inter] counter=161 t=1.9e-04 per=9.5e+00 cost=1.5e+06 flops=7.6e+09
 sigma[gemm] counter=161 i=0 t=2.4e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=1 t=2.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=2 t=2.0e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=3 t=2.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=4 t=2.4e-04 per=1.2e+01 cost=4.1e+05 flops=1.7e+09
 sigma[gemm] counter=161 i=5 t=2.6e-04 per=1.3e+01 cost=4.2e+05 flops=1.6e+09
 sigma[gemm] counter=161 i=6 t=2.2e-04 per=1.1e+01 cost=1.9e+05 flops=8.7e+08
 sigma[gemm] counter=161 i=7 t=2.4e-04 per=1.2e+01 cost=2.0e+05 flops=8.3e+08
 sigma[gemm] counter=161 total t=9.7e-04 per=4.8e+01 cost=1.2e+06 flops=1.3e+09
 sigma[red] counter=161 t=8.8e-04 per=4.3e+01 cost=2.5e+05 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.4e-01 -----
 sigma_tot[inter] counter=161 t=2.2e-02 per=9.4e+00 cost=6.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=161 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=1 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=2 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=3 t=3.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=4 t=2.7e-02 per=1.1e+01 cost=1.4e+07 flops=5.3e+08
 sigma_tot[gemm] counter=161 i=5 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.8e+08
 sigma_tot[gemm] counter=161 i=6 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.2e+08
 sigma_tot[gemm] counter=161 i=7 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.4e+08
 sigma_tot[gemm] counter=161 total t=1.1e-01 per=4.8e+01 cost=5.3e+07 flops=4.6e+08
 sigma_tot[red] counter=161 t=1.0e-01 per=4.3e+01 cost=1.3e+07 flops=1.2e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.2e-05,2.0e-06,1.3e-06,1.8e-07
    7   0 +    -116.332572672318 -5.578e-08  3.729e-05    3     7  1.663e-02 2.375e-03 2.316e-03
TIMING FOR Davidson : 1.664e-02  T(cal/comm/rest)=1.621e-02,2.401e-06,4.242e-04
decomposed t_rest=4.242e-04
 T(sub)    =1.641e-04 per=3.868e+01
 T(precond)=2.247e-05 per=5.297e+00
 T(ortho)  =1.100e-05 per=2.593e+00
 T(xcopy)  =8.870e-07 per=2.091e-01
 T(xnrm2)  =1.500e-06 per=3.536e-01
 T(other)  =2.243e-04 per=5.287e+01
optimized energies: isweep=0 ibond=25 dots=2 e[0]=-116.332572672318 nmvp=7
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=8.995e-03 change=5.108e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=9 dimAll=40
 (14,2):6 (14,4):4 (13,3):1 (15,3):10 (16,2):6 (16,4):4 (17,3):1 (15,1):5 (15,5):3
timing for divide=7.3e-06
timing for compute=8.7e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=7.3e-06,8.1e-05,0.0e+00,6.3e-06,1.3e-05 -----
decimation summary: 40->10 dwt=+4.776e-03 SvN=1.463e+00
 qbond: qkept nsym=4 dimAll=10
 (15,3):4 (15,1):4 (16,2):1 (16,4):1
----- TIMING for decimation_row(nkr): 1.157e-03 S T(decim/select/formRot)=1.513e-04,9.885e-04,1.736e-05 -----
----- TIMING FOR twodot_decimation: 1.279e-03 S T(wf/decim)=1.019e-04,1.178e-03 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:10 S:5 H:1 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=3070:2.342e-02MB:2.287e-05GB
        per(mem): C:3.91 S:1.95 H:1.11 A:0 B:93 
rank=0 CPUmem(GB): used=1.344e+00 pageheap_free=8.995e-03 change=1.740e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=116 : 1.306e-04 S -----
rank=0 GPUmem(GB): used=8.006e-05 (oper)=4.926e-05
rank=0 GPUmem(GB): used=8.059e-05 (oper,site)=4.926e-05,5.215e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=116
 no. of rintermediate operators=5
 no. of coefficients=110:8.392e-04MB:8.196e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.037e-05 S -----
rank=0 GPUmem(GB): used=8.141e-05 (oper,site,rinter)=4.926e-05,5.215e-07,8.196e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.215e-03 S size(rtasks)=116 size(Rlst2)=16 T(Rmu/Rlist)=8.756e-05,1.127e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.293e-03 S size(rtasks)=116 size(Rlst)=938 -----
rank=0 GPUmem(GB): used=8.141e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.613e-04 blksize=20 blksize0=25 batchsize=938
rank=0 GPUmem(GB): used=5.427e-04 (oper,site,rinter,batch)=4.926e-05,5.215e-07,8.196e-07,4.613e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.283e-04,4.019e-04,1.175e-04
----- TIMING FOR renorm : t_inter=1.3e-04 t_gemm=4.0e-04 t_reduction=1.2e-04 tot=6.5e-04 -----
 renorm[inter] counter=306 t=1.3e-04 per=2.0e+01 cost=3.3e+04 flops=2.6e+08
 renorm[gemm] counter=306 i=0 t=2.4e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=306 i=1 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=306 i=2 t=1.3e-04 per=2.0e+01 cost=6.0e+03 flops=4.6e+07
 renorm[gemm] counter=306 i=3 t=1.6e-04 per=2.4e+01 cost=5.1e+04 flops=3.3e+08
 renorm[gemm] counter=306 i=4 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=306 i=5 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=306 i=6 t=1.1e-04 per=1.7e+01 cost=5.7e+04 flops=5.3e+08
 renorm[gemm] counter=306 total t=4.0e-04 per=6.2e+01 cost=1.1e+05 flops=2.9e+08
 renorm[red] counter=306 t=1.2e-04 per=1.8e+01 cost=1.8e+04 flops=1.5e+08
----- TIMING FOR renorm_tot : t_inter=2.6e-03 t_gemm=1.1e-02 t_reduction=4.3e-03 tot=1.8e-02 -----
 renorm_tot[inter] counter=306 t=2.6e-03 per=1.4e+01 cost=4.5e+05 flops=1.7e+08
 renorm_tot[gemm] counter=306 i=0 t=5.7e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=306 i=1 t=5.0e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=306 i=2 t=1.4e-03 per=7.9e+00 cost=2.2e+04 flops=1.6e+07
 renorm_tot[gemm] counter=306 i=3 t=1.6e-03 per=9.0e+00 cost=1.2e+05 flops=7.3e+07
 renorm_tot[gemm] counter=306 i=4 t=2.2e-03 per=1.2e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=306 i=5 t=2.3e-03 per=1.3e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=306 i=6 t=3.7e-03 per=2.0e+01 cost=6.0e+05 flops=1.6e+08
 renorm_tot[gemm] counter=306 total t=1.1e-02 per=6.2e+01 cost=1.0e+06 flops=9.2e+07
 renorm_tot[red] counter=306 t=4.3e-03 per=2.3e+01 cost=2.6e+05 flops=6.1e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.152e-05 (oper)=4.935e-05
rank=0 GPUmem(GB): used=9.204e-05 (oper,site,rinter)=4.935e-05,5.215e-07,1.054e-05
rank=0 GPUmem(GB): used=1.065e-04 (oper,site,rinter,batch)=4.935e-05,5.215e-07,1.054e-05,1.448e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.627e-03 S T(preprocess/alloc/comp/red/dealloc)=1.182e-03,1.236e-03,3.093e-03,1.978e-04,8.275e-05 -----
----- TIMING FOR oper_renorm_opS : 4.652e-03 S rank=0 -----
----- TIMING FOR oper_renorm : 8.109e-03 S rank=0 -----
rank=0 CPUmem(GB): used=1.344e+00 pageheap_free=8.575e-03 change=2.614e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.575e-03 change=-1.505e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=3070:2.342e-02MB:2.287e-05GB
        per(mem): C:3.91 S:1.95 H:1.11 P:0 Q:93 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.575e-03 change=1.740e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.575e-03 change=1.073e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=7.655e-05 avail=3.829e+01 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1ctns::oper_b2q ifab=0 ifkr=1 maxsize=2856:2.128e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:56 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=2856:2.179e-02MB:2.128e-05GB
        per(mem): B:100 
   init qops_tmp: dt=9.07e-05 tinit=9.07e-05
   copy opB to qops_tmps: dt=3.66e-06 tcopy=3.66e-06
   bcast: size(opB)=2856:2.13e-05GB dt=3.12e-05 speed=0.681GB/s tcomm=3.12e-05
   compute opQ from opB: dt=0.000129 tcomp=0.000129
iproc=0
 qops_tmp: oplist=N nops=N:56 
        dim(bra,ket)=10,10 size(op)=68:0.000519MB size(tot)=2856:0.0218MB:2.13e-05GB
        per(mem): N:100 
   init qops_tmp: dt=4.51e-05 tinit=0.000136
   from opB to opB.H(): dt=0.00013 tadjt=0.00013
   bcast: size(opN)=2856:2.13e-05GB dt=2.42e-05 speed=0.879GB/s tcomm=5.54e-05
   compute opQ from opB.H(): dt=9.6e-05 tcomp=0.000225
iproc=1
 qops_tmp: oplist=B nops=B:54 
        dim(bra,ket)=10,10 size(op)=68:0.000519MB size(tot)=2754:0.021MB:2.05e-05GB
        per(mem): B:100 
   init qops_tmp: dt=4.3e-05 tinit=0.000174
   copy opB to qops_tmps: dt=4.3e-06 tcopy=4.33e-06
   bcast: size(opB)=2754:2.05e-05GB dt=1.99e-05 speed=1.03GB/s tcomm=0.000324
   compute opQ from opB: dt=9.65e-05 tcomp=0.000304
iproc=1
 qops_tmp: oplist=N nops=N:54 
        dim(bra,ket)=10,10 size(op)=68:0.000519MB size(tot)=2754:0.021MB:2.05e-05GB
        per(mem): N:100 
   init qops_tmp: dt=4.23e-05 tinit=0.000216
   from opB to opB.H(): dt=0.000126 tadjt=0.000126
   bcast: size(opN)=2754:2.05e-05GB dt=2.11e-05 speed=0.971GB/s tcomm=0.000345
   compute opQ from opB.H(): dt=9.11e-05 tcomp=0.000395
----- TIMING FOR oper_b2qGPU : 0.00127 S T(init/copy/adjt+bcast/comp/rest)=0.000222,3.69e-06,0.000443,0.000416,0.00019 -----
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.575e-03 change=4.321e-07 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=7.655e-05 avail=3.829e+01 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=8.575e-03 change=2.289e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=7.655e-05 avail=3.829e+01 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=8.575e-03 change=-5.960e-08 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 before move
rank=0 GPUmem(GB): used=7.655e-05 avail=3.829e+01 before move
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.575e-03 change=-1.753e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after move
rank=0 GPUmem(GB): used=5.367e-05 avail=3.829e+01 after move
----- TIMING FOR oper_ab2pq : 2.446e-03 S T(init/copyCSH/opP/opQ/to_gpu/to_cpu/move)=4.732e-04,1.417e-05,8.694e-06,1.285e-03,0.000e+00,3.513e-04,3.131e-04 -----
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.575e-03 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=8.575e-03 change=-2.921e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 9.040e-02 S #####
 T(local opt: fetch) = 2.834e-03 S  per = 3.13  per(accum) = 3.13
 T(local opt: hdiag) = 6.454e-03 S  per = 7.14  per(accum) = 10.3
 T(local opt: dvdsn) = 6.614e-02 S  per = 73.2  per(accum) = 83.4
 T(local opt: decim) = 1.317e-03 S  per = 1.46  per(accum) = 84.9
 T(local opt: guess) = 9.153e-05 S  per = 0.101  per(accum) = 85
 T(local opt: renrm) = 1.177e-02 S  per =   13  per(accum) = 98
 T(local opt: save ) = 1.802e-03 S  per = 1.99  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.614e-02 S  T(sum) = 6.534e-02 S  per = 9.880e+01
 T(local opt: preprocess                  ) = 3.813e-04 S  per = 0.584  per(accum) = 0.584
 T(local opt: symbolic_formulae           ) = 8.827e-04 S  per = 1.35  per(accum) = 1.93
 T(local opt: hintermediate init          ) = 1.336e-04 S  per = 0.205  per(accum) = 2.14
 T(local opt: preprocess_hformulae_Hxlist ) = 3.778e-02 S  per = 57.8  per(accum) = 60
 T(local opt: hmmtasks init               ) = 9.367e-03 S  per = 14.3  per(accum) = 74.3
 T(local opt: initial guess for dvdson    ) = 1.550e-04 S  per = 0.237  per(accum) = 74.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.573e-02 S  per = 24.1  per(accum) = 98.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.537e-04 S  per = 0.235  per(accum) = 98.8
 T(local opt: dvdson [nccl]               ) = 3.250e-04 S  per = 0.497  per(accum) = 99.3
 T(local opt: dvdson [mpi]                ) = 2.401e-06 S  per = 0.00367  per(accum) = 99.4
 T(local opt: dvdson [rest part(linalg)]  ) = 4.242e-04 S  per = 0.649  per(accum) = 100
Detailed decomposition of T(renrm) = 1.177e-02 S  T(sum) = 1.177e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.680e-05 S  per = 0.483  per(accum) = 0.483
 T(local opt: qops init                    ) = 4.744e-04 S  per = 4.03  per(accum) = 4.52
 T(local opt: symbolic_formulae_renorm     ) = 1.416e-04 S  per =  1.2  per(accum) = 5.72
 T(local opt: allocate qops on gpu         ) = 6.698e-05 S  per = 0.569  per(accum) = 6.29
 T(local opt: site memcpy cpu2gpu          ) = 2.720e-05 S  per = 0.231  per(accum) = 6.52
 T(local opt: rintermediate init           ) = 6.217e-05 S  per = 0.528  per(accum) = 7.05
 T(local opt: preprocess_formulae_Rlist2   ) = 1.304e-03 S  per = 11.1  per(accum) = 18.1
 T(local opt: rmmtasks init                ) = 4.562e-04 S  per = 3.88  per(accum) = 22
 T(local opt: qops memset on cpu           ) = 4.500e-08 S  per = 0.000382  per(accum) = 22
 T(local opt: preprocess_renorm_batchGPU   ) = 8.298e-04 S  per = 7.05  per(accum) = 29.1
 T(local opt: deallocate cpu and gpu memory) = 3.117e-05 S  per = 0.265  per(accum) = 29.3
 T(local opt: construct opS [ifdists=true] ) = 4.697e-03 S  per = 39.9  per(accum) = 69.2
 T(local opt: reduction of opS & opH [nccl]) = 1.864e-05 S  per = 0.158  per(accum) = 69.4
 T(local opt: qops memcpy gpu2cpu          ) = 3.400e-08 S  per = 0.000289  per(accum) = 69.4
 T(local opt: reduction of opS & opH [mpi] ) = 4.900e-08 S  per = 0.000416  per(accum) = 69.4
 T(local opt: qops_pool join and erase     ) = 1.024e-03 S  per = 8.71  per(accum) = 78.1
 T(local opt: conversion from opAB to opPQ ) = 2.575e-03 S  per = 21.9  per(accum) = 100
ctns::rcanon_save_site idx=9 scratch=./scratch/sweep size=70:5.2e-07GB T(load)=0.00059S speed=0.00088GB/S
##### sweep opt: 1.258e+00 S #####
 T(sweep opt: fetch) = 6.593e-02 S  per = 5.24  per(accum) = 5.24
 T(sweep opt: hdiag) = 6.608e-02 S  per = 5.25  per(accum) = 10.5
 T(sweep opt: dvdsn) = 7.982e-01 S  per = 63.4  per(accum) = 73.9
 T(sweep opt: decim) = 2.944e-02 S  per = 2.34  per(accum) = 76.3
 T(sweep opt: guess) = 2.312e-03 S  per = 0.184  per(accum) = 76.5
 T(sweep opt: renrm) = 2.477e-01 S  per = 19.7  per(accum) = 96.2
 T(sweep opt: save ) = 4.833e-02 S  per = 3.84  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.982e-01 S  T(sum) = 7.867e-01 S  per = 9.855e+01
 T(sweep opt: preprocess                  ) = 8.604e-03 S  per = 1.09  per(accum) = 1.09
 T(sweep opt: symbolic_formulae           ) = 1.256e-02 S  per =  1.6  per(accum) = 2.69
 T(sweep opt: hintermediate init          ) = 1.955e-03 S  per = 0.248  per(accum) = 2.94
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.879e-01 S  per = 49.3  per(accum) = 52.3
 T(sweep opt: hmmtasks init               ) = 7.616e-02 S  per = 9.68  per(accum) = 61.9
 T(sweep opt: initial guess for dvdson    ) = 3.711e-03 S  per = 0.472  per(accum) = 62.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.746e-01 S  per = 34.9  per(accum) = 97.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.585e-03 S  per = 0.456  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 8.655e-03 S  per =  1.1  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 8.231e-05 S  per = 0.0105  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.851e-03 S  per = 1.13  per(accum) = 100
Detailed decomposition of T(renrm) = 2.477e-01 S  T(sum) = 2.477e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.393e-03 S  per = 0.562  per(accum) = 0.562
 T(sweep opt: qops init                    ) = 9.003e-03 S  per = 3.63  per(accum) = 4.2
 T(sweep opt: symbolic_formulae_renorm     ) = 3.753e-03 S  per = 1.51  per(accum) = 5.71
 T(sweep opt: allocate qops on gpu         ) = 1.482e-03 S  per = 0.598  per(accum) = 6.31
 T(sweep opt: site memcpy cpu2gpu          ) = 6.608e-04 S  per = 0.267  per(accum) = 6.58
 T(sweep opt: rintermediate init           ) = 1.214e-03 S  per = 0.49  per(accum) = 7.07
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.018e-02 S  per = 12.2  per(accum) = 19.2
 T(sweep opt: rmmtasks init                ) = 9.729e-03 S  per = 3.93  per(accum) = 23.2
 T(sweep opt: qops memset on cpu           ) = 1.212e-06 S  per = 0.000489  per(accum) = 23.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.185e-02 S  per = 8.82  per(accum) = 32
 T(sweep opt: deallocate cpu and gpu memory) = 7.818e-04 S  per = 0.316  per(accum) = 32.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.411e-01 S  per =   57  per(accum) = 89.3
 T(sweep opt: reduction of opS & opH [nccl]) = 4.916e-04 S  per = 0.198  per(accum) = 89.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.892e-04 S  per = 0.359  per(accum) = 89.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.999e-04 S  per = 0.161  per(accum) = 90
 T(sweep opt: qops_pool join and erase     ) = 1.941e-02 S  per = 7.83  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 5.387e-03 S  per = 2.17  per(accum) = 100
##### global opt: 1.258e+00 S #####
 T(global opt: fetch) = 6.593e-02 S  per = 5.24  per(accum) = 5.24
 T(global opt: hdiag) = 6.608e-02 S  per = 5.25  per(accum) = 10.5
 T(global opt: dvdsn) = 7.982e-01 S  per = 63.4  per(accum) = 73.9
 T(global opt: decim) = 2.944e-02 S  per = 2.34  per(accum) = 76.3
 T(global opt: guess) = 2.312e-03 S  per = 0.184  per(accum) = 76.5
 T(global opt: renrm) = 2.477e-01 S  per = 19.7  per(accum) = 96.2
 T(global opt: save ) = 4.833e-02 S  per = 3.84  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.982e-01 S  T(sum) = 7.867e-01 S  per = 9.855e+01
 T(global opt: preprocess                  ) = 8.604e-03 S  per = 1.09  per(accum) = 1.09
 T(global opt: symbolic_formulae           ) = 1.256e-02 S  per =  1.6  per(accum) = 2.69
 T(global opt: hintermediate init          ) = 1.955e-03 S  per = 0.248  per(accum) = 2.94
 T(global opt: preprocess_hformulae_Hxlist ) = 3.879e-01 S  per = 49.3  per(accum) = 52.3
 T(global opt: hmmtasks init               ) = 7.616e-02 S  per = 9.68  per(accum) = 61.9
 T(global opt: initial guess for dvdson    ) = 3.711e-03 S  per = 0.472  per(accum) = 62.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.746e-01 S  per = 34.9  per(accum) = 97.3
 T(global opt: dvdson [cpu-gpu]            ) = 3.585e-03 S  per = 0.456  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 8.655e-03 S  per =  1.1  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 8.231e-05 S  per = 0.0105  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 8.851e-03 S  per = 1.13  per(accum) = 100
Detailed decomposition of T(renrm) = 2.477e-01 S  T(sum) = 2.477e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.393e-03 S  per = 0.562  per(accum) = 0.562
 T(global opt: qops init                    ) = 9.003e-03 S  per = 3.63  per(accum) = 4.2
 T(global opt: symbolic_formulae_renorm     ) = 3.753e-03 S  per = 1.51  per(accum) = 5.71
 T(global opt: allocate qops on gpu         ) = 1.482e-03 S  per = 0.598  per(accum) = 6.31
 T(global opt: site memcpy cpu2gpu          ) = 6.608e-04 S  per = 0.267  per(accum) = 6.58
 T(global opt: rintermediate init           ) = 1.214e-03 S  per = 0.49  per(accum) = 7.07
 T(global opt: preprocess_formulae_Rlist2   ) = 3.018e-02 S  per = 12.2  per(accum) = 19.2
 T(global opt: rmmtasks init                ) = 9.729e-03 S  per = 3.93  per(accum) = 23.2
 T(global opt: qops memset on cpu           ) = 1.212e-06 S  per = 0.000489  per(accum) = 23.2
 T(global opt: preprocess_renorm_batchGPU   ) = 2.185e-02 S  per = 8.82  per(accum) = 32
 T(global opt: deallocate cpu and gpu memory) = 7.818e-04 S  per = 0.316  per(accum) = 32.3
 T(global opt: construct opS [ifdists=true] ) = 1.411e-01 S  per =   57  per(accum) = 89.3
 T(global opt: reduction of opS & opH [nccl]) = 4.916e-04 S  per = 0.198  per(accum) = 89.5
 T(global opt: qops memcpy gpu2cpu          ) = 8.892e-04 S  per = 0.359  per(accum) = 89.8
 T(global opt: reduction of opS & opH [mpi] ) = 3.999e-04 S  per = 0.161  per(accum) = 90
 T(global opt: qops_pool join and erase     ) = 1.941e-02 S  per = 7.83  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 5.387e-03 S  per = 2.17  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-5.114e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=26/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=11 scratch=./scratch/sweep size=40:2.98e-07GB T(load)=3.13e-04S speed=9.51e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=99:7.55e-04MB:7.38e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=64:4.88e-04MB:4.77e-07GB
total mem of comb=164:1.25e-03MB:1.22e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=7.316e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:7 H:1 A:31 B:36 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1666:1.271e-02MB:1.241e-05GB
        per(mem): C:5.76 S:5.04 H:1.68 A:0 B:87.5 
 rqops: oplist=CSHPQ nops=C:10 S:5 H:1 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=68:0.000519MB size(tot)=3070:0.0234MB:2.29e-05GB
        per(mem): C:3.91 S:1.95 H:1.11 P:0 Q:93 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=6732:0.0514MB:5.02e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.802e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.484e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=138:1.053e-03MB
qtensor4: wf4 own=1 _data=0x5585f6d35a80
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
 qbond: qcol nsym=4 dimAll=10
 (15,3):4 (15,1):4 (16,2):1 (16,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=27 nblocks=304 size=138:1.053e-03MB
### DIAG TIMING: total=4.641e-03 t1=1.595e-05, t2=2.014e-05, t3=1.744e-05, t4=4.536e-03, t5=7.039e-06, t6=3.821e-05, t7=6.667e-06
duration_diagGPU:4.650e-03
duration_diagreduce:3.000e-08
duration_diagtransform:3.050e-07
----- TIMING FOR symbolic_formulae_twodot with size=452 : 8.045e-04 S -----
rank=0 GPUmem(GB): used=5.016e-05 (oper)=5.016e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=452
 no. of hintermediate operators=227
 no. of coefficients=2776:2.118e-02MB:2.068e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.236e-04 S -----
rank=0 GPUmem(GB): used=7.084e-05 (oper,hinter)=5.016e-05,2.068e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.201e-02 S size(H_formulae)=452 size(Hxlst2)=27 T(Hmu/Hxlist)=2.081e-04,3.180e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.325e-02 S size(H_formulae)=452 size(Hxlst)=14668 -----
rank=0 GPUmem(GB): used=7.084e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.056e-06 batch[need]=5.355e-03 blksize=16 blksize0=16 batchsize=14668
rank=0 GPUmem(GB): used=5.428e-03 (oper,hinter,dvdson,batch)=5.016e-05,2.068e-05,2.056e-06,5.355e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=138 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.085e-05,2.268e-04,7.758e-04,9.733e-04,2.068e-03
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.451e-05 speed=8.392e-02GB/S T(nccl)=5.635e-05 speed=3.650e-02GB/S
----- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=7.8e-04 t_reduction=9.7e-04 tot=2.0e-03 -----
 sigma[inter] counter=162 t=2.3e-04 per=1.1e+01 cost=8.7e+05 flops=3.8e+09
 sigma[gemm] counter=162 i=0 t=2.5e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=1 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=3 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=4 t=1.9e-04 per=9.4e+00 cost=1.4e+05 flops=7.6e+08
 sigma[gemm] counter=162 i=5 t=1.8e-04 per=9.2e+00 cost=1.4e+05 flops=7.7e+08
 sigma[gemm] counter=162 i=6 t=2.1e-04 per=1.1e+01 cost=2.0e+05 flops=9.7e+08
 sigma[gemm] counter=162 i=7 t=1.9e-04 per=9.6e+00 cost=2.1e+05 flops=1.1e+09
 sigma[gemm] counter=162 total t=7.8e-04 per=3.9e+01 cost=6.9e+05 flops=8.9e+08
 sigma[red] counter=162 t=9.7e-04 per=4.9e+01 cost=1.6e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.2e-01 t_reduction=1.0e-01 tot=2.4e-01 -----
 sigma_tot[inter] counter=162 t=2.3e-02 per=9.4e+00 cost=6.6e+07 flops=2.9e+09
 sigma_tot[gemm] counter=162 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=1 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=2 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=3 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=4 t=2.7e-02 per=1.1e+01 cost=1.5e+07 flops=5.3e+08
 sigma_tot[gemm] counter=162 i=5 t=3.0e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=162 i=6 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.3e+08
 sigma_tot[gemm] counter=162 i=7 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.4e+08
 sigma_tot[gemm] counter=162 total t=1.2e-01 per=4.8e+01 cost=5.4e+07 flops=4.7e+08
 sigma_tot[red] counter=162 t=1.0e-01 per=4.3e+01 cost=1.3e+07 flops=1.2e+08
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,4.0e-06,1.0e-06,1.2e-06,2.4e-07
settings: ndim=138 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.330547046388 -1.116e+03  2.582e-02    1     1  2.468e-03 2.468e-03 2.436e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.763e-05,1.662e-04,7.726e-04,1.020e-03,2.031e-03
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.145e-05 speed=9.588e-02GB/S T(nccl)=4.618e-05 speed=4.453e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=7.7e-04 t_reduction=1.0e-03 tot=2.0e-03 -----
 sigma[inter] counter=163 t=1.7e-04 per=8.5e+00 cost=8.7e+05 flops=5.2e+09
 sigma[gemm] counter=163 i=0 t=2.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=1 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=2 t=1.9e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=3 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=4 t=1.6e-04 per=8.4e+00 cost=1.4e+05 flops=8.6e+08
 sigma[gemm] counter=163 i=5 t=1.7e-04 per=8.7e+00 cost=1.4e+05 flops=8.2e+08
 sigma[gemm] counter=163 i=6 t=2.2e-04 per=1.1e+01 cost=2.0e+05 flops=9.3e+08
 sigma[gemm] counter=163 i=7 t=2.1e-04 per=1.1e+01 cost=2.1e+05 flops=9.8e+08
 sigma[gemm] counter=163 total t=7.7e-04 per=3.9e+01 cost=6.9e+05 flops=9.0e+08
 sigma[red] counter=163 t=1.0e-03 per=5.2e+01 cost=1.6e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.2e-01 t_reduction=1.0e-01 tot=2.4e-01 -----
 sigma_tot[inter] counter=163 t=2.3e-02 per=9.4e+00 cost=6.7e+07 flops=2.9e+09
 sigma_tot[gemm] counter=163 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=1 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=2 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=3 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=4 t=2.7e-02 per=1.1e+01 cost=1.5e+07 flops=5.3e+08
 sigma_tot[gemm] counter=163 i=5 t=3.0e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=163 i=6 t=2.8e-02 per=1.2e+01 cost=1.2e+07 flops=4.3e+08
 sigma_tot[gemm] counter=163 i=7 t=2.8e-02 per=1.2e+01 cost=1.3e+07 flops=4.4e+08
 sigma_tot[gemm] counter=163 total t=1.2e-01 per=4.8e+01 cost=5.4e+07 flops=4.7e+08
 sigma_tot[red] counter=163 t=1.0e-01 per=4.3e+01 cost=1.3e+07 flops=1.2e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,1.8e-05,2.8e-06,1.5e-06,1.9e-07
    2   0 -    -116.332203099011 -1.656e-03  8.292e-03    2     2  4.845e-03 2.422e-03 2.362e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.574e-05,1.584e-04,7.400e-04,1.016e-03,1.985e-03
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.101e-05 speed=9.787e-02GB/S T(nccl)=4.473e-05 speed=4.597e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=7.4e-04 t_reduction=1.0e-03 tot=1.9e-03 -----
 sigma[inter] counter=164 t=1.6e-04 per=8.3e+00 cost=8.7e+05 flops=5.5e+09
 sigma[gemm] counter=164 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=2 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=3 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=4 t=1.7e-04 per=8.9e+00 cost=1.4e+05 flops=8.3e+08
 sigma[gemm] counter=164 i=5 t=1.6e-04 per=8.6e+00 cost=1.4e+05 flops=8.6e+08
 sigma[gemm] counter=164 i=6 t=2.0e-04 per=1.1e+01 cost=2.0e+05 flops=1.0e+09
 sigma[gemm] counter=164 i=7 t=2.0e-04 per=1.0e+01 cost=2.1e+05 flops=1.1e+09
 sigma[gemm] counter=164 total t=7.4e-04 per=3.9e+01 cost=6.9e+05 flops=9.4e+08
 sigma[red] counter=164 t=1.0e-03 per=5.3e+01 cost=1.6e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 -----
 sigma_tot[inter] counter=164 t=2.3e-02 per=9.4e+00 cost=6.8e+07 flops=3.0e+09
 sigma_tot[gemm] counter=164 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=1 t=3.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=2 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=3 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=4 t=2.8e-02 per=1.1e+01 cost=1.5e+07 flops=5.4e+08
 sigma_tot[gemm] counter=164 i=5 t=3.0e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=164 i=6 t=2.9e-02 per=1.2e+01 cost=1.2e+07 flops=4.4e+08
 sigma_tot[gemm] counter=164 i=7 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=164 total t=1.2e-01 per=4.7e+01 cost=5.5e+07 flops=4.7e+08
 sigma_tot[red] counter=164 t=1.1e-01 per=4.3e+01 cost=1.3e+07 flops=1.3e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.7e-05,2.0e-06,1.5e-06,2.1e-07
    3   0 -    -116.332367339197 -1.642e-04  2.832e-03    3     3  7.085e-03 2.362e-03 2.302e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.480e-05,1.670e-04,7.401e-04,1.014e-03,1.990e-03
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.114e-05 speed=9.726e-02GB/S T(nccl)=4.365e-05 speed=4.711e-02GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=7.4e-04 t_reduction=1.0e-03 tot=1.9e-03 -----
 sigma[inter] counter=165 t=1.7e-04 per=8.7e+00 cost=8.7e+05 flops=5.2e+09
 sigma[gemm] counter=165 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=1 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=3 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=4 t=1.8e-04 per=9.6e+00 cost=1.4e+05 flops=7.6e+08
 sigma[gemm] counter=165 i=5 t=1.6e-04 per=8.4e+00 cost=1.4e+05 flops=8.7e+08
 sigma[gemm] counter=165 i=6 t=1.9e-04 per=9.9e+00 cost=2.0e+05 flops=1.1e+09
 sigma[gemm] counter=165 i=7 t=2.0e-04 per=1.0e+01 cost=2.1e+05 flops=1.1e+09
 sigma[gemm] counter=165 total t=7.4e-04 per=3.9e+01 cost=6.9e+05 flops=9.4e+08
 sigma[red] counter=165 t=1.0e-03 per=5.3e+01 cost=1.6e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 -----
 sigma_tot[inter] counter=165 t=2.3e-02 per=9.4e+00 cost=6.9e+07 flops=3.0e+09
 sigma_tot[gemm] counter=165 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=1 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=2 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=3 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=4 t=2.8e-02 per=1.1e+01 cost=1.5e+07 flops=5.4e+08
 sigma_tot[gemm] counter=165 i=5 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=165 i=6 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.4e+08
 sigma_tot[gemm] counter=165 i=7 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=165 total t=1.2e-01 per=4.7e+01 cost=5.6e+07 flops=4.7e+08
 sigma_tot[red] counter=165 t=1.1e-01 per=4.3e+01 cost=1.3e+07 flops=1.3e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.3e-05,2.0e-06,1.4e-06,1.5e-07
    4   0 -    -116.332389606967 -2.227e-05  9.163e-04    3     4  9.328e-03 2.332e-03 2.274e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.525e-05,1.637e-04,7.668e-04,1.020e-03,2.020e-03
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.129e-05 speed=9.660e-02GB/S T(nccl)=4.397e-05 speed=4.677e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=7.7e-04 t_reduction=1.0e-03 tot=1.9e-03 -----
 sigma[inter] counter=166 t=1.6e-04 per=8.4e+00 cost=8.7e+05 flops=5.3e+09
 sigma[gemm] counter=166 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=1 t=1.9e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=2 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=3 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=4 t=1.7e-04 per=8.5e+00 cost=1.4e+05 flops=8.5e+08
 sigma[gemm] counter=166 i=5 t=1.7e-04 per=8.7e+00 cost=1.4e+05 flops=8.3e+08
 sigma[gemm] counter=166 i=6 t=2.1e-04 per=1.1e+01 cost=2.0e+05 flops=9.8e+08
 sigma[gemm] counter=166 i=7 t=2.1e-04 per=1.1e+01 cost=2.1e+05 flops=9.7e+08
 sigma[gemm] counter=166 total t=7.7e-04 per=3.9e+01 cost=6.9e+05 flops=9.0e+08
 sigma[red] counter=166 t=1.0e-03 per=5.2e+01 cost=1.6e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 -----
 sigma_tot[inter] counter=166 t=2.3e-02 per=9.3e+00 cost=7.0e+07 flops=3.0e+09
 sigma_tot[gemm] counter=166 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=1 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=2 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=3 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=4 t=2.8e-02 per=1.1e+01 cost=1.5e+07 flops=5.4e+08
 sigma_tot[gemm] counter=166 i=5 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=166 i=6 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.4e+08
 sigma_tot[gemm] counter=166 i=7 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.6e+08
 sigma_tot[gemm] counter=166 total t=1.2e-01 per=4.7e+01 cost=5.6e+07 flops=4.8e+08
 sigma_tot[red] counter=166 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,2.0e-06,1.3e-06,1.8e-07
    5   0 -    -116.332392482142 -2.875e-06  2.901e-04    3     5  1.157e-02 2.314e-03 2.258e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.535e-05,1.566e-04,7.289e-04,1.017e-03,1.972e-03
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.123e-05 speed=9.687e-02GB/S T(nccl)=4.412e-05 speed=4.660e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=7.3e-04 t_reduction=1.0e-03 tot=1.9e-03 -----
 sigma[inter] counter=167 t=1.6e-04 per=8.2e+00 cost=8.7e+05 flops=5.5e+09
 sigma[gemm] counter=167 i=0 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=1 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=3 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=4 t=1.6e-04 per=8.4e+00 cost=1.4e+05 flops=8.8e+08
 sigma[gemm] counter=167 i=5 t=1.6e-04 per=8.6e+00 cost=1.4e+05 flops=8.6e+08
 sigma[gemm] counter=167 i=6 t=2.0e-04 per=1.1e+01 cost=2.0e+05 flops=1.0e+09
 sigma[gemm] counter=167 i=7 t=1.9e-04 per=1.0e+01 cost=2.1e+05 flops=1.1e+09
 sigma[gemm] counter=167 total t=7.3e-04 per=3.8e+01 cost=6.9e+05 flops=9.5e+08
 sigma[red] counter=167 t=1.0e-03 per=5.3e+01 cost=1.6e+05 flops=1.6e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 -----
 sigma_tot[inter] counter=167 t=2.3e-02 per=9.3e+00 cost=7.0e+07 flops=3.0e+09
 sigma_tot[gemm] counter=167 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=1 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=2 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=3 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=4 t=2.8e-02 per=1.1e+01 cost=1.5e+07 flops=5.4e+08
 sigma_tot[gemm] counter=167 i=5 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=5.0e+08
 sigma_tot[gemm] counter=167 i=6 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=167 i=7 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.6e+08
 sigma_tot[gemm] counter=167 total t=1.2e-01 per=4.7e+01 cost=5.7e+07 flops=4.8e+08
 sigma_tot[red] counter=167 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.2e-05,1.9e-06,1.2e-06,2.0e-07
    6   0 +    -116.332392700332 -2.182e-07  7.807e-05    3     6  1.379e-02 2.298e-03 2.243e-03
TIMING FOR Davidson : 1.380e-02  T(cal/comm/rest)=1.346e-02,2.100e-06,3.396e-04
decomposed t_rest=3.396e-04
 T(sub)    =1.255e-04 per=3.695e+01
 T(precond)=1.779e-05 per=5.240e+00
 T(ortho)  =9.280e-06 per=2.733e+00
 T(xcopy)  =8.100e-07 per=2.385e-01
 T(xnrm2)  =1.113e-06 per=3.278e-01
 T(other)  =1.851e-04 per=5.451e+01
optimized energies: isweep=0 ibond=26 dots=2 e[0]=-116.332392700332 nmvp=6
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=5.424e-03 change=3.732e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=10 dimAll=40
 (15,3):4 (15,1):4 (16,2):9 (16,4):5 (17,3):6 (17,1):5 (18,2):1 (18,4):1 (16,0):4 (17,5):1
timing for divide=7.9e-06
timing for compute=7.7e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 9.8e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.9e-06,7.2e-05,0.0e+00,5.4e-06,1.3e-05 -----
decimation summary: 40->10 dwt=+1.635e-04 SvN=1.494e+00
 qbond: qkept nsym=5 dimAll=10
 (16,2):4 (16,0):3 (16,4):1 (17,3):1 (17,1):1
----- TIMING for decimation_row(nkr): 1.099e-03 S T(decim/select/formRot)=1.427e-04,9.308e-04,2.512e-05 -----
----- TIMING FOR twodot_decimation: 1.211e-03 S T(wf/decim)=9.145e-05,1.120e-03 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:11 S:4 H:1 P:40 Q:46 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2071:1.580e-02MB:1.543e-05GB
        per(mem): C:6.37 S:2.32 H:1.35 P:0 Q:90 
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=5.424e-03 change=2.089e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=98 : 4.586e-04 S -----
rank=0 GPUmem(GB): used=7.386e-05 (oper)=4.574e-05
rank=0 GPUmem(GB): used=7.433e-05 (oper,site)=4.574e-05,4.768e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=98
 no. of rintermediate operators=132
 no. of coefficients=1320:1.007e-02MB:9.835e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.551e-05 S -----
rank=0 GPUmem(GB): used=8.417e-05 (oper,site,rinter)=4.574e-05,4.768e-07,9.835e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.841e-03 S size(rtasks)=98 size(Rlst2)=25 T(Rmu/Rlist)=1.868e-04,2.654e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.957e-03 S size(rtasks)=98 size(Rlst)=2407 -----
rank=0 GPUmem(GB): used=8.417e-05 avail=3.829e+01 total=3.829e+01 batch[need]=6.635e-04 blksize=16 blksize0=4 batchsize=2407
rank=0 GPUmem(GB): used=7.477e-04 (oper,site,rinter,batch)=4.574e-05,4.768e-07,9.835e-06,6.635e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.516e-05,3.465e-04,1.601e-04
----- TIMING FOR renorm : t_inter=9.5e-05 t_gemm=3.5e-04 t_reduction=1.6e-04 tot=6.0e-04 -----
 renorm[inter] counter=317 t=9.5e-05 per=1.6e+01 cost=6.3e+04 flops=6.6e+08
 renorm[gemm] counter=317 i=0 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=317 i=1 t=1.6e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=317 i=2 t=9.1e-05 per=1.5e+01 cost=7.5e+03 flops=8.2e+07
 renorm[gemm] counter=317 i=3 t=1.0e-04 per=1.7e+01 cost=5.4e+04 flops=5.3e+08
 renorm[gemm] counter=317 i=4 t=1.7e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=317 i=5 t=1.6e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=317 i=6 t=1.5e-04 per=2.5e+01 cost=8.1e+04 flops=5.5e+08
 renorm[gemm] counter=317 total t=3.5e-04 per=5.8e+01 cost=1.4e+05 flops=4.1e+08
 renorm[red] counter=317 t=1.6e-04 per=2.7e+01 cost=2.7e+04 flops=1.7e+08
----- TIMING FOR renorm_tot : t_inter=2.7e-03 t_gemm=1.2e-02 t_reduction=4.4e-03 tot=1.9e-02 -----
 renorm_tot[inter] counter=317 t=2.7e-03 per=1.4e+01 cost=5.2e+05 flops=1.9e+08
 renorm_tot[gemm] counter=317 i=0 t=5.9e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=317 i=1 t=5.1e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=317 i=2 t=1.5e-03 per=8.1e+00 cost=3.0e+04 flops=2.0e+07
 renorm_tot[gemm] counter=317 i=3 t=1.7e-03 per=9.3e+00 cost=1.7e+05 flops=1.0e+08
 renorm_tot[gemm] counter=317 i=4 t=2.2e-03 per=1.2e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=317 i=5 t=2.3e-03 per=1.2e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=317 i=6 t=3.8e-03 per=2.0e+01 cost=6.9e+05 flops=1.8e+08
 renorm_tot[gemm] counter=317 total t=1.2e-02 per=6.2e+01 cost=1.2e+06 flops=1.0e+08
 renorm_tot[red] counter=317 t=4.4e-03 per=2.4e+01 cost=2.9e+05 flops=6.5e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=8.468e-05 (oper)=4.583e-05
rank=0 GPUmem(GB): used=8.515e-05 (oper,site,rinter)=4.583e-05,4.768e-07,8.941e-07
rank=0 GPUmem(GB): used=9.019e-05 (oper,site,rinter,batch)=4.583e-05,4.768e-07,8.941e-07,5.037e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.428e-03 S T(preprocess/alloc/comp/red/dealloc)=5.392e-04,5.897e-04,1.596e-03,1.723e-04,5.336e-05 -----
----- TIMING FOR oper_renorm_opS : 2.451e-03 S rank=0 -----
qops.to_cpu: size(tot)=2071:1.580e-02MB:1.543e-05GB T(to_cpu)=4.332e-05S speed=3.562e-01GB/S
check ||H-H.dagger||=1.314e-14 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.0081 S rank=0 -----
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=5.447e-03 change=7.326e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=5.989e-03 change=-1.874e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=5.989e-03 change=-3.695e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 7.640e-02 S #####
 T(local opt: fetch) = 2.660e-03 S  per = 3.48  per(accum) = 3.48
 T(local opt: hdiag) = 4.717e-03 S  per = 6.17  per(accum) = 9.66
 T(local opt: dvdsn) = 5.678e-02 S  per = 74.3  per(accum) = 84
 T(local opt: decim) = 1.247e-03 S  per = 1.63  per(accum) = 85.6
 T(local opt: guess) = 9.338e-05 S  per = 0.122  per(accum) = 85.7
 T(local opt: renrm) = 9.063e-03 S  per = 11.9  per(accum) = 97.6
 T(local opt: save ) = 1.844e-03 S  per = 2.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.678e-02 S  T(sum) = 5.606e-02 S  per = 9.873e+01
 T(local opt: preprocess                  ) = 3.615e-04 S  per = 0.645  per(accum) = 0.645
 T(local opt: symbolic_formulae           ) = 8.239e-04 S  per = 1.47  per(accum) = 2.11
 T(local opt: hintermediate init          ) = 1.407e-04 S  per = 0.251  per(accum) = 2.37
 T(local opt: preprocess_hformulae_Hxlist ) = 3.350e-02 S  per = 59.8  per(accum) = 62.1
 T(local opt: hmmtasks init               ) = 7.227e-03 S  per = 12.9  per(accum) = 75
 T(local opt: initial guess for dvdson    ) = 1.981e-04 S  per = 0.353  per(accum) = 75.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.305e-02 S  per = 23.3  per(accum) = 98.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.306e-04 S  per = 0.233  per(accum) = 98.9
 T(local opt: dvdson [nccl]               ) = 2.790e-04 S  per = 0.498  per(accum) = 99.4
 T(local opt: dvdson [mpi]                ) = 2.100e-06 S  per = 0.00375  per(accum) = 99.4
 T(local opt: dvdson [rest part(linalg)]  ) = 3.396e-04 S  per = 0.606  per(accum) = 100
Detailed decomposition of T(renrm) = 9.063e-03 S  T(sum) = 9.063e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.716e-05 S  per = 0.631  per(accum) = 0.631
 T(local opt: qops init                    ) = 4.894e-04 S  per =  5.4  per(accum) = 6.03
 T(local opt: symbolic_formulae_renorm     ) = 4.703e-04 S  per = 5.19  per(accum) = 11.2
 T(local opt: allocate qops on gpu         ) = 5.935e-05 S  per = 0.655  per(accum) = 11.9
 T(local opt: site memcpy cpu2gpu          ) = 2.623e-05 S  per = 0.289  per(accum) = 12.2
 T(local opt: rintermediate init           ) = 7.467e-05 S  per = 0.824  per(accum) = 13
 T(local opt: preprocess_formulae_Rlist2   ) = 2.972e-03 S  per = 32.8  per(accum) = 45.8
 T(local opt: rmmtasks init                ) = 6.611e-04 S  per = 7.29  per(accum) = 53.1
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000364  per(accum) = 53.1
 T(local opt: preprocess_renorm_batchGPU   ) = 7.511e-04 S  per = 8.29  per(accum) = 61.4
 T(local opt: deallocate cpu and gpu memory) = 4.388e-05 S  per = 0.484  per(accum) = 61.9
 T(local opt: construct opS [ifdists=true] ) = 2.465e-03 S  per = 27.2  per(accum) = 89.1
 T(local opt: reduction of opS & opH [nccl]) = 1.829e-05 S  per = 0.202  per(accum) = 89.3
 T(local opt: qops memcpy gpu2cpu          ) = 5.239e-05 S  per = 0.578  per(accum) = 89.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.752e-05 S  per = 0.193  per(accum) = 90
 T(local opt: qops_pool join and erase     ) = 8.988e-04 S  per = 9.92  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 4.739e-06 S  per = 0.0523  per(accum) = 100
ctns::rcanon_save_site idx=10 scratch=./scratch/sweep size=64:4.8e-07GB T(load)=0.00058S speed=0.00082GB/S
##### sweep opt: 1.334e+00 S #####
 T(sweep opt: fetch) = 6.859e-02 S  per = 5.14  per(accum) = 5.14
 T(sweep opt: hdiag) = 7.080e-02 S  per = 5.31  per(accum) = 10.4
 T(sweep opt: dvdsn) = 8.550e-01 S  per = 64.1  per(accum) = 74.5
 T(sweep opt: decim) = 3.068e-02 S  per =  2.3  per(accum) = 76.8
 T(sweep opt: guess) = 2.405e-03 S  per = 0.18  per(accum) = 77
 T(sweep opt: renrm) = 2.568e-01 S  per = 19.2  per(accum) = 96.2
 T(sweep opt: save ) = 5.017e-02 S  per = 3.76  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.550e-01 S  T(sum) = 8.427e-01 S  per = 9.857e+01
 T(sweep opt: preprocess                  ) = 8.965e-03 S  per = 1.06  per(accum) = 1.06
 T(sweep opt: symbolic_formulae           ) = 1.338e-02 S  per = 1.59  per(accum) = 2.65
 T(sweep opt: hintermediate init          ) = 2.095e-03 S  per = 0.249  per(accum) = 2.9
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.214e-01 S  per =   50  per(accum) = 52.9
 T(sweep opt: hmmtasks init               ) = 8.339e-02 S  per =  9.9  per(accum) = 62.8
 T(sweep opt: initial guess for dvdson    ) = 3.909e-03 S  per = 0.464  per(accum) = 63.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.876e-01 S  per = 34.1  per(accum) = 97.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.715e-03 S  per = 0.441  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 8.934e-03 S  per = 1.06  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 8.441e-05 S  per = 0.01  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.191e-03 S  per = 1.09  per(accum) = 100
Detailed decomposition of T(renrm) = 2.568e-01 S  T(sum) = 2.568e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.450e-03 S  per = 0.565  per(accum) = 0.565
 T(sweep opt: qops init                    ) = 9.492e-03 S  per =  3.7  per(accum) = 4.26
 T(sweep opt: symbolic_formulae_renorm     ) = 4.223e-03 S  per = 1.64  per(accum) = 5.91
 T(sweep opt: allocate qops on gpu         ) = 1.542e-03 S  per =  0.6  per(accum) = 6.51
 T(sweep opt: site memcpy cpu2gpu          ) = 6.871e-04 S  per = 0.268  per(accum) = 6.77
 T(sweep opt: rintermediate init           ) = 1.288e-03 S  per = 0.502  per(accum) = 7.27
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.315e-02 S  per = 12.9  per(accum) = 20.2
 T(sweep opt: rmmtasks init                ) = 1.039e-02 S  per = 4.05  per(accum) = 24.2
 T(sweep opt: qops memset on cpu           ) = 1.245e-06 S  per = 0.000485  per(accum) = 24.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.260e-02 S  per =  8.8  per(accum) = 33
 T(sweep opt: deallocate cpu and gpu memory) = 8.257e-04 S  per = 0.322  per(accum) = 33.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.436e-01 S  per = 55.9  per(accum) = 89.3
 T(sweep opt: reduction of opS & opH [nccl]) = 5.099e-04 S  per = 0.199  per(accum) = 89.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.416e-04 S  per = 0.367  per(accum) = 89.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.174e-04 S  per = 0.163  per(accum) = 90
 T(sweep opt: qops_pool join and erase     ) = 2.031e-02 S  per = 7.91  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 5.391e-03 S  per =  2.1  per(accum) = 100
##### global opt: 1.334e+00 S #####
 T(global opt: fetch) = 6.859e-02 S  per = 5.14  per(accum) = 5.14
 T(global opt: hdiag) = 7.080e-02 S  per = 5.31  per(accum) = 10.4
 T(global opt: dvdsn) = 8.550e-01 S  per = 64.1  per(accum) = 74.5
 T(global opt: decim) = 3.068e-02 S  per =  2.3  per(accum) = 76.8
 T(global opt: guess) = 2.405e-03 S  per = 0.18  per(accum) = 77
 T(global opt: renrm) = 2.568e-01 S  per = 19.2  per(accum) = 96.2
 T(global opt: save ) = 5.017e-02 S  per = 3.76  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.550e-01 S  T(sum) = 8.427e-01 S  per = 9.857e+01
 T(global opt: preprocess                  ) = 8.965e-03 S  per = 1.06  per(accum) = 1.06
 T(global opt: symbolic_formulae           ) = 1.338e-02 S  per = 1.59  per(accum) = 2.65
 T(global opt: hintermediate init          ) = 2.095e-03 S  per = 0.249  per(accum) = 2.9
 T(global opt: preprocess_hformulae_Hxlist ) = 4.214e-01 S  per =   50  per(accum) = 52.9
 T(global opt: hmmtasks init               ) = 8.339e-02 S  per =  9.9  per(accum) = 62.8
 T(global opt: initial guess for dvdson    ) = 3.909e-03 S  per = 0.464  per(accum) = 63.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.876e-01 S  per = 34.1  per(accum) = 97.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.715e-03 S  per = 0.441  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 8.934e-03 S  per = 1.06  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 8.441e-05 S  per = 0.01  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 9.191e-03 S  per = 1.09  per(accum) = 100
Detailed decomposition of T(renrm) = 2.568e-01 S  T(sum) = 2.568e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.450e-03 S  per = 0.565  per(accum) = 0.565
 T(global opt: qops init                    ) = 9.492e-03 S  per =  3.7  per(accum) = 4.26
 T(global opt: symbolic_formulae_renorm     ) = 4.223e-03 S  per = 1.64  per(accum) = 5.91
 T(global opt: allocate qops on gpu         ) = 1.542e-03 S  per =  0.6  per(accum) = 6.51
 T(global opt: site memcpy cpu2gpu          ) = 6.871e-04 S  per = 0.268  per(accum) = 6.77
 T(global opt: rintermediate init           ) = 1.288e-03 S  per = 0.502  per(accum) = 7.27
 T(global opt: preprocess_formulae_Rlist2   ) = 3.315e-02 S  per = 12.9  per(accum) = 20.2
 T(global opt: rmmtasks init                ) = 1.039e-02 S  per = 4.05  per(accum) = 24.2
 T(global opt: qops memset on cpu           ) = 1.245e-06 S  per = 0.000485  per(accum) = 24.2
 T(global opt: preprocess_renorm_batchGPU   ) = 2.260e-02 S  per =  8.8  per(accum) = 33
 T(global opt: deallocate cpu and gpu memory) = 8.257e-04 S  per = 0.322  per(accum) = 33.4
 T(global opt: construct opS [ifdists=true] ) = 1.436e-01 S  per = 55.9  per(accum) = 89.3
 T(global opt: reduction of opS & opH [nccl]) = 5.099e-04 S  per = 0.199  per(accum) = 89.5
 T(global opt: qops memcpy gpu2cpu          ) = 9.416e-04 S  per = 0.367  per(accum) = 89.8
 T(global opt: reduction of opS & opH [mpi] ) = 4.174e-04 S  per = 0.163  per(accum) = 90
 T(global opt: qops_pool join and erase     ) = 2.031e-02 S  per = 7.91  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 5.391e-03 S  per =  2.1  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-3.737e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=27/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=12 scratch=./scratch/sweep size=40:2.98e-07GB T(load)=3.14e-04S speed=9.50e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=80:6.10e-04MB:5.96e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=40:3.05e-04MB:2.98e-07GB
total mem of comb=121:9.23e-04MB:9.02e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=7.316e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:7 S:7 H:1 A:27 B:26 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1249:9.529e-03MB:9.306e-06GB
        per(mem): C:6.73 S:6.73 H:2.24 A:0 B:84.3 
 rqops: oplist=CSHPQ nops=C:11 S:4 H:1 P:40 Q:46 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=2071:0.0158MB:1.54e-05GB
        per(mem): C:6.37 S:2.32 H:1.35 P:0 Q:90 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5316:0.0406MB:3.96e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.442e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-9.120e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=52:3.967e-04MB
qtensor4: wf4 own=1 _data=0x5585ee6d1a00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
 qbond: qcol nsym=5 dimAll=10
 (16,2):4 (16,0):3 (16,4):1 (17,3):1 (17,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=13 nblocks=361 size=52:3.967e-04MB
### DIAG TIMING: total=2.189e-03 t1=1.666e-05, t2=1.766e-05, t3=1.766e-05, t4=2.086e-03, t5=7.086e-06, t6=3.674e-05, t7=7.021e-06
duration_diagGPU:2.206e-03
duration_diagreduce:3.300e-08
duration_diagtransform:1.780e-07
----- TIMING FOR symbolic_formulae_twodot with size=388 : 6.267e-04 S -----
rank=0 GPUmem(GB): used=3.961e-05 (oper)=3.961e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=388
 no. of hintermediate operators=201
 no. of coefficients=2367:1.806e-02MB:1.764e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.661e-05 S -----
rank=0 GPUmem(GB): used=5.724e-05 (oper,hinter)=3.961e-05,1.764e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.309e-03 S size(H_formulae)=388 size(Hxlst2)=13 T(Hmu/Hxlist)=1.764e-04,6.133e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.664e-03 S size(H_formulae)=388 size(Hxlst)=3632 -----
rank=0 GPUmem(GB): used=5.724e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=7.749e-07 batch[need]=1.326e-03 blksize=16 blksize0=16 batchsize=3632
rank=0 GPUmem(GB): used=1.384e-03 (oper,hinter,dvdson,batch)=3.961e-05,1.764e-05,7.749e-07,1.326e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=52 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.190e-05,1.355e-04,4.916e-04,2.827e-04,9.893e-04
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=2.354e-05 speed=3.292e-02GB/S T(nccl)=4.836e-05 speed=1.602e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=4.9e-04 t_reduction=2.8e-04 tot=9.1e-04 -----
 sigma[inter] counter=168 t=1.4e-04 per=1.5e+01 cost=1.9e+05 flops=1.4e+09
 sigma[gemm] counter=168 i=0 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=1 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=2 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=3 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=4 t=1.2e-04 per=1.4e+01 cost=2.3e+04 flops=1.8e+08
 sigma[gemm] counter=168 i=5 t=1.2e-04 per=1.4e+01 cost=2.4e+04 flops=1.9e+08
 sigma[gemm] counter=168 i=6 t=1.2e-04 per=1.3e+01 cost=4.9e+04 flops=4.1e+08
 sigma[gemm] counter=168 i=7 t=1.2e-04 per=1.3e+01 cost=4.9e+04 flops=4.2e+08
 sigma[gemm] counter=168 total t=4.9e-04 per=5.4e+01 cost=1.5e+05 flops=3.0e+08
 sigma[red] counter=168 t=2.8e-04 per=3.1e+01 cost=3.4e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 -----
 sigma_tot[inter] counter=168 t=2.4e-02 per=9.4e+00 cost=7.1e+07 flops=3.0e+09
 sigma_tot[gemm] counter=168 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=1 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=2 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=3 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=4 t=2.8e-02 per=1.1e+01 cost=1.5e+07 flops=5.4e+08
 sigma_tot[gemm] counter=168 i=5 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=168 i=6 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=168 i=7 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.6e+08
 sigma_tot[gemm] counter=168 total t=1.2e-01 per=4.7e+01 cost=5.7e+07 flops=4.8e+08
 sigma_tot[red] counter=168 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=7.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.0e-06,9.7e-07,9.5e-07,2.1e-07
settings: ndim=52 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.332314928371 -1.116e+03  3.331e-02    1     1  1.241e-03 1.241e-03 1.217e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.562e-05,1.354e-04,5.883e-04,3.036e-04,1.097e-03
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=2.155e-05 speed=3.596e-02GB/S T(nccl)=4.407e-05 speed=1.758e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=5.9e-04 t_reduction=3.0e-04 tot=1.0e-03 -----
 sigma[inter] counter=169 t=1.4e-04 per=1.3e+01 cost=1.9e+05 flops=1.4e+09
 sigma[gemm] counter=169 i=0 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=2 t=1.9e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=3 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=4 t=1.5e-04 per=1.4e+01 cost=2.3e+04 flops=1.6e+08
 sigma[gemm] counter=169 i=5 t=1.5e-04 per=1.4e+01 cost=2.4e+04 flops=1.6e+08
 sigma[gemm] counter=169 i=6 t=1.4e-04 per=1.4e+01 cost=4.9e+04 flops=3.5e+08
 sigma[gemm] counter=169 i=7 t=1.5e-04 per=1.4e+01 cost=4.9e+04 flops=3.4e+08
 sigma[gemm] counter=169 total t=5.9e-04 per=5.7e+01 cost=1.5e+05 flops=2.5e+08
 sigma[red] counter=169 t=3.0e-04 per=3.0e+01 cost=3.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 -----
 sigma_tot[inter] counter=169 t=2.4e-02 per=9.4e+00 cost=7.1e+07 flops=3.0e+09
 sigma_tot[gemm] counter=169 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=1 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=2 t=3.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=3 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=4 t=2.8e-02 per=1.1e+01 cost=1.5e+07 flops=5.4e+08
 sigma_tot[gemm] counter=169 i=5 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=169 i=6 t=2.9e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=169 i=7 t=2.9e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=169 total t=1.2e-01 per=4.7e+01 cost=5.7e+07 flops=4.8e+08
 sigma_tot[red] counter=169 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.1e-05,2.7e-06,1.1e-06,2.4e-07
    2   0 -    -116.335303794645 -2.989e-03  9.109e-03    2     2  2.608e-03 1.304e-03 1.257e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.337e-05,1.252e-04,5.800e-04,3.018e-04,1.074e-03
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=2.158e-05 speed=3.591e-02GB/S T(nccl)=4.179e-05 speed=1.854e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=5.8e-04 t_reduction=3.0e-04 tot=1.0e-03 -----
 sigma[inter] counter=170 t=1.3e-04 per=1.2e+01 cost=1.9e+05 flops=1.5e+09
 sigma[gemm] counter=170 i=0 t=2.1e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=2 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=4 t=1.4e-04 per=1.4e+01 cost=2.3e+04 flops=1.6e+08
 sigma[gemm] counter=170 i=5 t=1.5e-04 per=1.5e+01 cost=2.4e+04 flops=1.6e+08
 sigma[gemm] counter=170 i=6 t=1.4e-04 per=1.4e+01 cost=4.9e+04 flops=3.6e+08
 sigma[gemm] counter=170 i=7 t=1.4e-04 per=1.4e+01 cost=4.9e+04 flops=3.5e+08
 sigma[gemm] counter=170 total t=5.8e-04 per=5.8e+01 cost=1.5e+05 flops=2.5e+08
 sigma[red] counter=170 t=3.0e-04 per=3.0e+01 cost=3.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 -----
 sigma_tot[inter] counter=170 t=2.4e-02 per=9.4e+00 cost=7.1e+07 flops=3.0e+09
 sigma_tot[gemm] counter=170 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=1 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=2 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=3 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=4 t=2.9e-02 per=1.1e+01 cost=1.5e+07 flops=5.4e+08
 sigma_tot[gemm] counter=170 i=5 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=170 i=6 t=3.0e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=170 i=7 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=170 total t=1.2e-01 per=4.7e+01 cost=5.7e+07 flops=4.8e+08
 sigma_tot[red] counter=170 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,2.1e-06,1.3e-06,1.9e-07
    3   0 -    -116.335522245947 -2.185e-04  2.815e-03    3     3  3.930e-03 1.310e-03 1.261e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.295e-05,1.279e-04,5.661e-04,2.974e-04,1.068e-03
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=2.117e-05 speed=3.661e-02GB/S T(nccl)=5.178e-05 speed=1.496e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=5.7e-04 t_reduction=3.0e-04 tot=9.9e-04 -----
 sigma[inter] counter=171 t=1.3e-04 per=1.3e+01 cost=1.9e+05 flops=1.5e+09
 sigma[gemm] counter=171 i=0 t=2.0e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=1 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=2 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=4 t=1.4e-04 per=1.4e+01 cost=2.3e+04 flops=1.6e+08
 sigma[gemm] counter=171 i=5 t=1.4e-04 per=1.4e+01 cost=2.4e+04 flops=1.7e+08
 sigma[gemm] counter=171 i=6 t=1.4e-04 per=1.4e+01 cost=4.9e+04 flops=3.6e+08
 sigma[gemm] counter=171 i=7 t=1.4e-04 per=1.4e+01 cost=4.9e+04 flops=3.6e+08
 sigma[gemm] counter=171 total t=5.7e-04 per=5.7e+01 cost=1.5e+05 flops=2.6e+08
 sigma[red] counter=171 t=3.0e-04 per=3.0e+01 cost=3.4e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 -----
 sigma_tot[inter] counter=171 t=2.4e-02 per=9.4e+00 cost=7.1e+07 flops=3.0e+09
 sigma_tot[gemm] counter=171 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=1 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=2 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=3 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=4 t=2.9e-02 per=1.1e+01 cost=1.5e+07 flops=5.3e+08
 sigma_tot[gemm] counter=171 i=5 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=171 i=6 t=3.0e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=171 i=7 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=171 total t=1.2e-01 per=4.7e+01 cost=5.8e+07 flops=4.8e+08
 sigma_tot[red] counter=171 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.1e-05,2.1e-06,1.2e-06,1.7e-07
    4   0 -    -116.335546244339 -2.400e-05  9.969e-04    3     4  5.248e-03 1.312e-03 1.264e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.390e-05,1.264e-04,5.999e-04,2.983e-04,1.092e-03
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=2.176e-05 speed=3.562e-02GB/S T(nccl)=4.214e-05 speed=1.839e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.0e-04 t_reduction=3.0e-04 tot=1.0e-03 -----
 sigma[inter] counter=172 t=1.3e-04 per=1.2e+01 cost=1.9e+05 flops=1.5e+09
 sigma[gemm] counter=172 i=0 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=2 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=3 t=2.0e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=4 t=1.4e-04 per=1.4e+01 cost=2.3e+04 flops=1.6e+08
 sigma[gemm] counter=172 i=5 t=1.6e-04 per=1.5e+01 cost=2.4e+04 flops=1.5e+08
 sigma[gemm] counter=172 i=6 t=1.5e-04 per=1.4e+01 cost=4.9e+04 flops=3.3e+08
 sigma[gemm] counter=172 i=7 t=1.5e-04 per=1.4e+01 cost=4.9e+04 flops=3.4e+08
 sigma[gemm] counter=172 total t=6.0e-04 per=5.9e+01 cost=1.5e+05 flops=2.4e+08
 sigma[red] counter=172 t=3.0e-04 per=2.9e+01 cost=3.4e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 -----
 sigma_tot[inter] counter=172 t=2.4e-02 per=9.4e+00 cost=7.1e+07 flops=3.0e+09
 sigma_tot[gemm] counter=172 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=1 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=2 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=3 t=3.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=4 t=2.9e-02 per=1.1e+01 cost=1.5e+07 flops=5.3e+08
 sigma_tot[gemm] counter=172 i=5 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=172 i=6 t=3.0e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=172 i=7 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=172 total t=1.2e-01 per=4.7e+01 cost=5.8e+07 flops=4.7e+08
 sigma_tot[red] counter=172 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.2e-05,1.8e-06,1.1e-06,1.3e-07
    5   0 -    -116.335549638719 -3.394e-06  2.545e-04    3     5  6.588e-03 1.318e-03 1.270e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.288e-05,1.271e-04,5.725e-04,3.004e-04,1.066e-03
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=2.172e-05 speed=3.567e-02GB/S T(nccl)=4.116e-05 speed=1.883e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=5.7e-04 t_reduction=3.0e-04 tot=1.0e-03 -----
 sigma[inter] counter=173 t=1.3e-04 per=1.3e+01 cost=1.9e+05 flops=1.5e+09
 sigma[gemm] counter=173 i=0 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=2 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=3 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=4 t=1.4e-04 per=1.4e+01 cost=2.3e+04 flops=1.7e+08
 sigma[gemm] counter=173 i=5 t=1.5e-04 per=1.5e+01 cost=2.4e+04 flops=1.6e+08
 sigma[gemm] counter=173 i=6 t=1.4e-04 per=1.4e+01 cost=4.9e+04 flops=3.5e+08
 sigma[gemm] counter=173 i=7 t=1.4e-04 per=1.4e+01 cost=4.9e+04 flops=3.5e+08
 sigma[gemm] counter=173 total t=5.7e-04 per=5.7e+01 cost=1.5e+05 flops=2.5e+08
 sigma[red] counter=173 t=3.0e-04 per=3.0e+01 cost=3.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 -----
 sigma_tot[inter] counter=173 t=2.4e-02 per=9.4e+00 cost=7.2e+07 flops=3.0e+09
 sigma_tot[gemm] counter=173 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=1 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=2 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=3 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=4 t=2.9e-02 per=1.1e+01 cost=1.5e+07 flops=5.3e+08
 sigma_tot[gemm] counter=173 i=5 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.9e+08
 sigma_tot[gemm] counter=173 i=6 t=3.0e-02 per=1.2e+01 cost=1.3e+07 flops=4.4e+08
 sigma_tot[gemm] counter=173 i=7 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=173 total t=1.2e-01 per=4.7e+01 cost=5.8e+07 flops=4.7e+08
 sigma_tot[red] counter=173 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.1e-05,1.8e-06,1.1e-06,1.5e-07
    6   0 +    -116.335549867109 -2.284e-07  8.407e-05    3     6  7.893e-03 1.316e-03 1.268e-03
TIMING FOR Davidson : 7.912e-03  T(cal/comm/rest)=7.610e-03,2.245e-06,2.991e-04
decomposed t_rest=2.991e-04
 T(sub)    =1.028e-04 per=3.438e+01
 T(precond)=1.503e-05 per=5.026e+00
 T(ortho)  =7.673e-06 per=2.565e+00
 T(xcopy)  =8.380e-07 per=2.802e-01
 T(xnrm2)  =9.110e-07 per=3.046e-01
 T(other)  =1.718e-04 per=5.744e+01
optimized energies: isweep=0 ibond=27 dots=2 e[0]=-116.335549867109 nmvp=6
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.854e-03 change=1.326e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=11 dimAll=37
 (16,2):4 (16,0):3 (16,4):1 (17,3):6 (17,1):8 (18,2):6 (18,0):4 (18,4):2 (19,3):1 (19,1):1 (17,5):1
timing for divide=8.0e-06
timing for compute=4.9e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(su2): 6.7e-05 S T(divide/compute[cpu/gpu/rest]/collect)=8.0e-06,3.9e-05,0.0e+00,9.9e-06,1.0e-05 -----
decimation summary: 37->10 dwt=+0.000e+00 SvN=1.560e+00
 qbond: qkept nsym=5 dimAll=10
 (18,2):4 (18,0):3 (18,4):1 (19,3):1 (19,1):1
----- TIMING for decimation_row(nkr): 9.596e-04 S T(decim/select/formRot)=1.155e-04,8.192e-04,2.483e-05 -----
----- TIMING FOR twodot_decimation: 1.071e-03 S T(wf/decim)=9.141e-05,9.792e-04 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:12 S:3 H:1 P:31 Q:36 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1666:1.271e-02MB:1.241e-05GB
        per(mem): C:8.64 S:2.16 H:1.68 P:0 Q:87.5 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.854e-03 change=1.712e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=80 : 3.628e-04 S -----
rank=0 GPUmem(GB): used=6.035e-05 (oper)=3.528e-05
rank=0 GPUmem(GB): used=6.065e-05 (oper,site)=3.528e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=80
 no. of rintermediate operators=103
 no. of coefficients=1133:8.644e-03MB:8.442e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.365e-05 S -----
rank=0 GPUmem(GB): used=6.909e-05 (oper,site,rinter)=3.528e-05,2.980e-07,8.442e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.724e-03 S size(rtasks)=80 size(Rlst2)=25 T(Rmu/Rlist)=1.286e-04,1.595e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.897e-03 S size(rtasks)=80 size(Rlst)=1430 -----
rank=0 GPUmem(GB): used=6.909e-05 avail=3.829e+01 total=3.829e+01 batch[need]=3.942e-04 blksize=16 blksize0=4 batchsize=1430
rank=0 GPUmem(GB): used=4.633e-04 (oper,site,rinter,batch)=3.528e-05,2.980e-07,8.442e-06,3.942e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.763e-05,4.124e-04,1.343e-04
----- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=4.1e-04 t_reduction=1.3e-04 tot=6.4e-04 -----
 renorm[inter] counter=325 t=9.8e-05 per=1.5e+01 cost=2.6e+04 flops=2.7e+08
 renorm[gemm] counter=325 i=0 t=2.0e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=325 i=1 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=325 i=2 t=1.3e-04 per=2.0e+01 cost=4.9e+03 flops=3.8e+07
 renorm[gemm] counter=325 i=3 t=1.4e-04 per=2.2e+01 cost=1.8e+04 flops=1.3e+08
 renorm[gemm] counter=325 i=4 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=325 i=5 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=325 i=6 t=1.4e-04 per=2.1e+01 cost=4.6e+04 flops=3.4e+08
 renorm[gemm] counter=325 total t=4.1e-04 per=6.4e+01 cost=6.8e+04 flops=1.7e+08
 renorm[red] counter=325 t=1.3e-04 per=2.1e+01 cost=2.4e+04 flops=1.8e+08
----- TIMING FOR renorm_tot : t_inter=2.8e-03 t_gemm=1.2e-02 t_reduction=4.6e-03 tot=1.9e-02 -----
 renorm_tot[inter] counter=325 t=2.8e-03 per=1.4e+01 cost=5.4e+05 flops=1.9e+08
 renorm_tot[gemm] counter=325 i=0 t=6.1e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=325 i=1 t=5.3e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=325 i=2 t=1.7e-03 per=8.5e+00 cost=3.5e+04 flops=2.1e+07
 renorm_tot[gemm] counter=325 i=3 t=1.9e-03 per=9.7e+00 cost=1.9e+05 flops=1.0e+08
 renorm_tot[gemm] counter=325 i=4 t=2.2e-03 per=1.1e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=325 i=5 t=2.3e-03 per=1.2e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=325 i=6 t=3.9e-03 per=2.0e+01 cost=7.3e+05 flops=1.9e+08
 renorm_tot[gemm] counter=325 total t=1.2e-02 per=6.2e+01 cost=1.3e+06 flops=1.0e+08
 renorm_tot[red] counter=325 t=4.6e-03 per=2.3e+01 cost=3.1e+05 flops=6.9e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.962e-05 (oper)=3.537e-05
rank=0 GPUmem(GB): used=6.992e-05 (oper,site,rinter)=3.537e-05,2.980e-07,7.376e-07
rank=0 GPUmem(GB): used=7.205e-05 (oper,site,rinter,batch)=3.537e-05,2.980e-07,7.376e-07,2.131e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.048e-03 S T(preprocess/alloc/comp/red/dealloc)=3.126e-04,3.658e-04,1.361e-03,2.672e-04,3.810e-05 -----
----- TIMING FOR oper_renorm_opS : 2.070e-03 S rank=0 -----
qops.to_cpu: size(tot)=1666:1.271e-02MB:1.241e-05GB T(to_cpu)=3.675e-05S speed=3.378e-01GB/S
check ||H-H.dagger||=7.619e-15 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.00641 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=1.717e-03 change=4.805e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=2.068e-03 change=-1.625e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=2.068e-03 change=-3.830e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.282e-02 S #####
 T(local opt: fetch) = 2.717e-03 S  per = 8.28  per(accum) = 8.28
 T(local opt: hdiag) = 2.313e-03 S  per = 7.05  per(accum) = 15.3
 T(local opt: dvdsn) = 1.750e-02 S  per = 53.3  per(accum) = 68.7
 T(local opt: decim) = 1.110e-03 S  per = 3.38  per(accum) = 72
 T(local opt: guess) = 9.299e-05 S  per = 0.283  per(accum) = 72.3
 T(local opt: renrm) = 7.260e-03 S  per = 22.1  per(accum) = 94.4
 T(local opt: save ) = 1.826e-03 S  per = 5.56  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.750e-02 S  T(sum) = 1.721e-02 S  per = 9.835e+01
 T(local opt: preprocess                  ) = 4.399e-04 S  per = 2.56  per(accum) = 2.56
 T(local opt: symbolic_formulae           ) = 6.405e-04 S  per = 3.72  per(accum) = 6.28
 T(local opt: hintermediate init          ) = 8.324e-05 S  per = 0.484  per(accum) = 6.76
 T(local opt: preprocess_hformulae_Hxlist ) = 6.685e-03 S  per = 38.8  per(accum) = 45.6
 T(local opt: hmmtasks init               ) = 1.306e-03 S  per = 7.59  per(accum) = 53.2
 T(local opt: initial guess for dvdson    ) = 1.460e-04 S  per = 0.848  per(accum) = 54
 T(local opt: dvdson [Hx_batchGPU]        ) = 7.210e-03 S  per = 41.9  per(accum) = 95.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.313e-04 S  per = 0.763  per(accum) = 96.7
 T(local opt: dvdson [nccl]               ) = 2.693e-04 S  per = 1.56  per(accum) = 98.2
 T(local opt: dvdson [mpi]                ) = 2.245e-06 S  per = 0.013  per(accum) = 98.3
 T(local opt: dvdson [rest part(linalg)]  ) = 2.991e-04 S  per = 1.74  per(accum) = 100
Detailed decomposition of T(renrm) = 7.260e-03 S  T(sum) = 7.260e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.289e-05 S  per = 0.729  per(accum) = 0.729
 T(local opt: qops init                    ) = 4.063e-04 S  per =  5.6  per(accum) = 6.33
 T(local opt: symbolic_formulae_renorm     ) = 3.752e-04 S  per = 5.17  per(accum) = 11.5
 T(local opt: allocate qops on gpu         ) = 5.957e-05 S  per = 0.821  per(accum) = 12.3
 T(local opt: site memcpy cpu2gpu          ) = 2.543e-05 S  per = 0.35  per(accum) = 12.7
 T(local opt: rintermediate init           ) = 7.363e-05 S  per = 1.01  per(accum) = 13.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.910e-03 S  per = 26.3  per(accum) = 40
 T(local opt: rmmtasks init                ) = 4.857e-04 S  per = 6.69  per(accum) = 46.7
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 0.000523  per(accum) = 46.7
 T(local opt: preprocess_renorm_batchGPU   ) = 8.002e-04 S  per =   11  per(accum) = 57.7
 T(local opt: deallocate cpu and gpu memory) = 2.829e-05 S  per = 0.39  per(accum) = 58.1
 T(local opt: construct opS [ifdists=true] ) = 2.088e-03 S  per = 28.8  per(accum) = 86.9
 T(local opt: reduction of opS & opH [nccl]) = 9.421e-05 S  per =  1.3  per(accum) = 88.2
 T(local opt: qops memcpy gpu2cpu          ) = 4.580e-05 S  per = 0.631  per(accum) = 88.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.396e-05 S  per = 0.192  per(accum) = 89
 T(local opt: qops_pool join and erase     ) = 7.972e-04 S  per =   11  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.464e-06 S  per = 0.0339  per(accum) = 100
ctns::rcanon_save_site idx=11 scratch=./scratch/sweep size=40:3e-07GB T(load)=0.00062S speed=0.00048GB/S
##### sweep opt: 1.367e+00 S #####
 T(sweep opt: fetch) = 7.131e-02 S  per = 5.22  per(accum) = 5.22
 T(sweep opt: hdiag) = 7.311e-02 S  per = 5.35  per(accum) = 10.6
 T(sweep opt: dvdsn) = 8.725e-01 S  per = 63.8  per(accum) = 74.4
 T(sweep opt: decim) = 3.179e-02 S  per = 2.33  per(accum) = 76.7
 T(sweep opt: guess) = 2.498e-03 S  per = 0.183  per(accum) = 76.9
 T(sweep opt: renrm) = 2.641e-01 S  per = 19.3  per(accum) = 96.2
 T(sweep opt: save ) = 5.200e-02 S  per =  3.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.725e-01 S  T(sum) = 8.599e-01 S  per = 9.856e+01
 T(sweep opt: preprocess                  ) = 9.405e-03 S  per = 1.09  per(accum) = 1.09
 T(sweep opt: symbolic_formulae           ) = 1.402e-02 S  per = 1.63  per(accum) = 2.72
 T(sweep opt: hintermediate init          ) = 2.179e-03 S  per = 0.253  per(accum) = 2.98
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.281e-01 S  per = 49.8  per(accum) = 52.8
 T(sweep opt: hmmtasks init               ) = 8.469e-02 S  per = 9.85  per(accum) = 62.6
 T(sweep opt: initial guess for dvdson    ) = 4.055e-03 S  per = 0.472  per(accum) = 63.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.948e-01 S  per = 34.3  per(accum) = 97.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.847e-03 S  per = 0.447  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 9.203e-03 S  per = 1.07  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 8.665e-05 S  per = 0.0101  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.490e-03 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.641e-01 S  T(sum) = 2.641e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.503e-03 S  per = 0.569  per(accum) = 0.569
 T(sweep opt: qops init                    ) = 9.898e-03 S  per = 3.75  per(accum) = 4.32
 T(sweep opt: symbolic_formulae_renorm     ) = 4.599e-03 S  per = 1.74  per(accum) = 6.06
 T(sweep opt: allocate qops on gpu         ) = 1.601e-03 S  per = 0.606  per(accum) = 6.67
 T(sweep opt: site memcpy cpu2gpu          ) = 7.125e-04 S  per = 0.27  per(accum) = 6.94
 T(sweep opt: rintermediate init           ) = 1.362e-03 S  per = 0.516  per(accum) = 7.45
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.507e-02 S  per = 13.3  per(accum) = 20.7
 T(sweep opt: rmmtasks init                ) = 1.088e-02 S  per = 4.12  per(accum) = 24.8
 T(sweep opt: qops memset on cpu           ) = 1.283e-06 S  per = 0.000486  per(accum) = 24.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.340e-02 S  per = 8.86  per(accum) = 33.7
 T(sweep opt: deallocate cpu and gpu memory) = 8.540e-04 S  per = 0.323  per(accum) = 34
 T(sweep opt: construct opS [ifdists=true] ) = 1.457e-01 S  per = 55.2  per(accum) = 89.2
 T(sweep opt: reduction of opS & opH [nccl]) = 6.041e-04 S  per = 0.229  per(accum) = 89.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.874e-04 S  per = 0.374  per(accum) = 89.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.314e-04 S  per = 0.163  per(accum) = 90
 T(sweep opt: qops_pool join and erase     ) = 2.110e-02 S  per = 7.99  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 5.394e-03 S  per = 2.04  per(accum) = 100
##### global opt: 1.367e+00 S #####
 T(global opt: fetch) = 7.131e-02 S  per = 5.22  per(accum) = 5.22
 T(global opt: hdiag) = 7.311e-02 S  per = 5.35  per(accum) = 10.6
 T(global opt: dvdsn) = 8.725e-01 S  per = 63.8  per(accum) = 74.4
 T(global opt: decim) = 3.179e-02 S  per = 2.33  per(accum) = 76.7
 T(global opt: guess) = 2.498e-03 S  per = 0.183  per(accum) = 76.9
 T(global opt: renrm) = 2.641e-01 S  per = 19.3  per(accum) = 96.2
 T(global opt: save ) = 5.200e-02 S  per =  3.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.725e-01 S  T(sum) = 8.599e-01 S  per = 9.856e+01
 T(global opt: preprocess                  ) = 9.405e-03 S  per = 1.09  per(accum) = 1.09
 T(global opt: symbolic_formulae           ) = 1.402e-02 S  per = 1.63  per(accum) = 2.72
 T(global opt: hintermediate init          ) = 2.179e-03 S  per = 0.253  per(accum) = 2.98
 T(global opt: preprocess_hformulae_Hxlist ) = 4.281e-01 S  per = 49.8  per(accum) = 52.8
 T(global opt: hmmtasks init               ) = 8.469e-02 S  per = 9.85  per(accum) = 62.6
 T(global opt: initial guess for dvdson    ) = 4.055e-03 S  per = 0.472  per(accum) = 63.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.948e-01 S  per = 34.3  per(accum) = 97.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.847e-03 S  per = 0.447  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 9.203e-03 S  per = 1.07  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 8.665e-05 S  per = 0.0101  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 9.490e-03 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.641e-01 S  T(sum) = 2.641e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.503e-03 S  per = 0.569  per(accum) = 0.569
 T(global opt: qops init                    ) = 9.898e-03 S  per = 3.75  per(accum) = 4.32
 T(global opt: symbolic_formulae_renorm     ) = 4.599e-03 S  per = 1.74  per(accum) = 6.06
 T(global opt: allocate qops on gpu         ) = 1.601e-03 S  per = 0.606  per(accum) = 6.67
 T(global opt: site memcpy cpu2gpu          ) = 7.125e-04 S  per = 0.27  per(accum) = 6.94
 T(global opt: rintermediate init           ) = 1.362e-03 S  per = 0.516  per(accum) = 7.45
 T(global opt: preprocess_formulae_Rlist2   ) = 3.507e-02 S  per = 13.3  per(accum) = 20.7
 T(global opt: rmmtasks init                ) = 1.088e-02 S  per = 4.12  per(accum) = 24.8
 T(global opt: qops memset on cpu           ) = 1.283e-06 S  per = 0.000486  per(accum) = 24.8
 T(global opt: preprocess_renorm_batchGPU   ) = 2.340e-02 S  per = 8.86  per(accum) = 33.7
 T(global opt: deallocate cpu and gpu memory) = 8.540e-04 S  per = 0.323  per(accum) = 34
 T(global opt: construct opS [ifdists=true] ) = 1.457e-01 S  per = 55.2  per(accum) = 89.2
 T(global opt: reduction of opS & opH [nccl]) = 6.041e-04 S  per = 0.229  per(accum) = 89.4
 T(global opt: qops memcpy gpu2cpu          ) = 9.874e-04 S  per = 0.374  per(accum) = 89.8
 T(global opt: reduction of opS & opH [mpi] ) = 4.314e-04 S  per = 0.163  per(accum) = 90
 T(global opt: qops_pool join and erase     ) = 2.110e-02 S  per = 7.99  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 5.394e-03 S  per = 2.04  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.334e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=28/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=13 scratch=./scratch/sweep size=62:4.62e-07GB T(load)=3.01e-04S speed=1.54e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=102:7.78e-04MB:7.60e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=40:3.05e-04MB:2.98e-07GB
total mem of comb=143:1.09e-03MB:1.07e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=6.348e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:8 H:1 A:18 B:20 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=1162:8.865e-03MB:8.658e-06GB
        per(mem): C:9.29 S:12.4 H:2.58 A:0 B:75.7 
 rqops: oplist=CSHPQ nops=C:12 S:3 H:1 P:31 Q:36 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=1666:0.0127MB:1.24e-05GB
        per(mem): C:8.64 S:2.16 H:1.68 P:0 Q:87.5 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4824:0.0368MB:3.59e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.838e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-9.120e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=136:1.038e-03MB
qtensor4: wf4 own=1 _data=0x5585ee937f80
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
 qbond: qcol nsym=5 dimAll=10
 (18,2):4 (18,0):3 (18,4):1 (19,3):1 (19,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=26 nblocks=304 size=136:1.038e-03MB
### DIAG TIMING: total=2.643e-03 t1=1.534e-05, t2=1.799e-05, t3=1.725e-05, t4=2.541e-03, t5=7.269e-06, t6=3.837e-05, t7=6.131e-06
duration_diagGPU:2.661e-03
duration_diagreduce:3.200e-08
duration_diagtransform:2.910e-07
----- TIMING FOR symbolic_formulae_twodot with size=310 : 5.235e-04 S -----
rank=0 GPUmem(GB): used=3.594e-05 (oper)=3.594e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=310
 no. of hintermediate operators=156
 no. of coefficients=1848:1.410e-02MB:1.377e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.949e-05 S -----
rank=0 GPUmem(GB): used=4.971e-05 (oper,hinter)=3.594e-05,1.377e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.559e-02 S size(H_formulae)=310 size(Hxlst2)=26 T(Hmu/Hxlist)=1.367e-04,1.545e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.640e-02 S size(H_formulae)=310 size(Hxlst)=9228 -----
rank=0 GPUmem(GB): used=4.971e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.027e-06 batch[need]=3.369e-03 blksize=16 blksize0=16 batchsize=9228
rank=0 GPUmem(GB): used=3.421e-03 (oper,hinter,dvdson,batch)=3.594e-05,1.377e-05,2.027e-06,3.369e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=136 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.254e-05,1.614e-04,8.345e-04,7.615e-04,1.839e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.217e-05 speed=9.142e-02GB/S T(nccl)=5.037e-05 speed=4.023e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.3e-04 t_reduction=7.6e-04 tot=1.8e-03 -----
 sigma[inter] counter=174 t=1.6e-04 per=9.2e+00 cost=3.5e+05 flops=2.1e+09
 sigma[gemm] counter=174 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=1 t=1.7e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=2 t=1.6e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=3 t=1.7e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=4 t=1.9e-04 per=1.1e+01 cost=7.9e+04 flops=4.3e+08
 sigma[gemm] counter=174 i=5 t=2.1e-04 per=1.2e+01 cost=7.9e+04 flops=3.7e+08
 sigma[gemm] counter=174 i=6 t=2.2e-04 per=1.3e+01 cost=1.5e+05 flops=6.9e+08
 sigma[gemm] counter=174 i=7 t=2.1e-04 per=1.2e+01 cost=1.5e+05 flops=7.1e+08
 sigma[gemm] counter=174 total t=8.3e-04 per=4.7e+01 cost=4.6e+05 flops=5.5e+08
 sigma[red] counter=174 t=7.6e-04 per=4.3e+01 cost=1.1e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 -----
 sigma_tot[inter] counter=174 t=2.4e-02 per=9.4e+00 cost=7.2e+07 flops=2.9e+09
 sigma_tot[gemm] counter=174 i=0 t=3.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=1 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=2 t=3.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=3 t=3.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=4 t=2.9e-02 per=1.1e+01 cost=1.5e+07 flops=5.3e+08
 sigma_tot[gemm] counter=174 i=5 t=3.2e-02 per=1.2e+01 cost=1.6e+07 flops=4.9e+08
 sigma_tot[gemm] counter=174 i=6 t=3.0e-02 per=1.2e+01 cost=1.3e+07 flops=4.5e+08
 sigma_tot[gemm] counter=174 i=7 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=174 total t=1.2e-01 per=4.7e+01 cost=5.8e+07 flops=4.7e+08
 sigma_tot[red] counter=174 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=8.0e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,2.8e-06,1.1e-06,9.5e-07,2.3e-07
settings: ndim=136 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.335549867109 -1.116e+03  4.103e-02    1     1  2.125e-03 2.125e-03 2.098e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.576e-05,1.599e-04,9.569e-04,8.066e-04,1.994e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.187e-05 speed=9.266e-02GB/S T(nccl)=4.389e-05 speed=4.617e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=9.6e-04 t_reduction=8.1e-04 tot=1.9e-03 -----
 sigma[inter] counter=175 t=1.6e-04 per=8.3e+00 cost=3.5e+05 flops=2.2e+09
 sigma[gemm] counter=175 i=0 t=2.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=1 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=3 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=4 t=2.2e-04 per=1.1e+01 cost=7.9e+04 flops=3.7e+08
 sigma[gemm] counter=175 i=5 t=2.4e-04 per=1.2e+01 cost=7.9e+04 flops=3.3e+08
 sigma[gemm] counter=175 i=6 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=6.2e+08
 sigma[gemm] counter=175 i=7 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=5.9e+08
 sigma[gemm] counter=175 total t=9.6e-04 per=5.0e+01 cost=4.6e+05 flops=4.8e+08
 sigma[red] counter=175 t=8.1e-04 per=4.2e+01 cost=1.1e+05 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 -----
 sigma_tot[inter] counter=175 t=2.5e-02 per=9.4e+00 cost=7.2e+07 flops=2.9e+09
 sigma_tot[gemm] counter=175 i=0 t=3.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=1 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=2 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=3 t=3.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=4 t=2.9e-02 per=1.1e+01 cost=1.6e+07 flops=5.3e+08
 sigma_tot[gemm] counter=175 i=5 t=3.2e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=175 i=6 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.5e+08
 sigma_tot[gemm] counter=175 i=7 t=3.0e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=175 total t=1.2e-01 per=4.8e+01 cost=5.9e+07 flops=4.7e+08
 sigma_tot[red] counter=175 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.3e-05,2.8e-06,1.2e-06,2.3e-07
    2   0 -    -116.339286171806 -3.736e-03  1.160e-02    2     2  4.396e-03 2.198e-03 2.144e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.514e-05,1.628e-04,9.227e-04,8.039e-04,1.959e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.124e-05 speed=9.540e-02GB/S T(nccl)=4.390e-05 speed=4.617e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=9.2e-04 t_reduction=8.0e-04 tot=1.9e-03 -----
 sigma[inter] counter=176 t=1.6e-04 per=8.6e+00 cost=3.5e+05 flops=2.1e+09
 sigma[gemm] counter=176 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=1 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=2 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=3 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=4 t=2.1e-04 per=1.1e+01 cost=7.9e+04 flops=3.8e+08
 sigma[gemm] counter=176 i=5 t=2.3e-04 per=1.2e+01 cost=7.9e+04 flops=3.5e+08
 sigma[gemm] counter=176 i=6 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.5e+08
 sigma[gemm] counter=176 i=7 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.0e+08
 sigma[gemm] counter=176 total t=9.2e-04 per=4.9e+01 cost=4.6e+05 flops=5.0e+08
 sigma[red] counter=176 t=8.0e-04 per=4.3e+01 cost=1.1e+05 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 -----
 sigma_tot[inter] counter=176 t=2.5e-02 per=9.4e+00 cost=7.3e+07 flops=2.9e+09
 sigma_tot[gemm] counter=176 i=0 t=3.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=1 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=2 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=3 t=3.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=4 t=3.0e-02 per=1.1e+01 cost=1.6e+07 flops=5.3e+08
 sigma_tot[gemm] counter=176 i=5 t=3.2e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=176 i=6 t=3.1e-02 per=1.2e+01 cost=1.4e+07 flops=4.5e+08
 sigma_tot[gemm] counter=176 i=7 t=3.1e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=176 total t=1.2e-01 per=4.8e+01 cost=5.9e+07 flops=4.7e+08
 sigma_tot[red] counter=176 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,2.0e-05,2.1e-06,1.4e-06,1.7e-07
    3   0 -    -116.339632081739 -3.459e-04  3.859e-03    3     3  6.613e-03 2.204e-03 2.150e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.702e-05,1.527e-04,9.322e-04,8.043e-04,1.960e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.290e-05 speed=8.850e-02GB/S T(nccl)=4.412e-05 speed=4.593e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.3e-04 t_reduction=8.0e-04 tot=1.9e-03 -----
 sigma[inter] counter=177 t=1.5e-04 per=8.1e+00 cost=3.5e+05 flops=2.3e+09
 sigma[gemm] counter=177 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=1 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=2 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=3 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=4 t=2.0e-04 per=1.1e+01 cost=7.9e+04 flops=3.9e+08
 sigma[gemm] counter=177 i=5 t=2.3e-04 per=1.2e+01 cost=7.9e+04 flops=3.4e+08
 sigma[gemm] counter=177 i=6 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.4e+08
 sigma[gemm] counter=177 i=7 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=5.8e+08
 sigma[gemm] counter=177 total t=9.3e-04 per=4.9e+01 cost=4.6e+05 flops=4.9e+08
 sigma[red] counter=177 t=8.0e-04 per=4.3e+01 cost=1.1e+05 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.3e-01 t_reduction=1.1e-01 tot=2.6e-01 -----
 sigma_tot[inter] counter=177 t=2.5e-02 per=9.4e+00 cost=7.3e+07 flops=2.9e+09
 sigma_tot[gemm] counter=177 i=0 t=3.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=1 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=2 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=3 t=3.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=4 t=3.0e-02 per=1.1e+01 cost=1.6e+07 flops=5.3e+08
 sigma_tot[gemm] counter=177 i=5 t=3.3e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=177 i=6 t=3.1e-02 per=1.2e+01 cost=1.4e+07 flops=4.5e+08
 sigma_tot[gemm] counter=177 i=7 t=3.1e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=177 total t=1.3e-01 per=4.8e+01 cost=6.0e+07 flops=4.7e+08
 sigma_tot[red] counter=177 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.3e-05,2.0e-06,1.3e-06,1.9e-07
    4   0 -    -116.339667732622 -3.565e-05  1.253e-03    3     4  8.809e-03 2.202e-03 2.149e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.430e-05,1.492e-04,9.328e-04,8.071e-04,1.957e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.097e-05 speed=9.665e-02GB/S T(nccl)=4.333e-05 speed=4.677e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.3e-04 t_reduction=8.1e-04 tot=1.9e-03 -----
 sigma[inter] counter=178 t=1.5e-04 per=7.9e+00 cost=3.5e+05 flops=2.3e+09
 sigma[gemm] counter=178 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=2 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=3 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=4 t=2.0e-04 per=1.1e+01 cost=7.9e+04 flops=3.9e+08
 sigma[gemm] counter=178 i=5 t=2.4e-04 per=1.2e+01 cost=7.9e+04 flops=3.4e+08
 sigma[gemm] counter=178 i=6 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=6.2e+08
 sigma[gemm] counter=178 i=7 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.1e+08
 sigma[gemm] counter=178 total t=9.3e-04 per=4.9e+01 cost=4.6e+05 flops=4.9e+08
 sigma[red] counter=178 t=8.1e-04 per=4.3e+01 cost=1.1e+05 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.3e-01 t_reduction=1.1e-01 tot=2.7e-01 -----
 sigma_tot[inter] counter=178 t=2.5e-02 per=9.4e+00 cost=7.3e+07 flops=2.9e+09
 sigma_tot[gemm] counter=178 i=0 t=3.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=1 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=2 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=3 t=3.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=4 t=3.0e-02 per=1.1e+01 cost=1.6e+07 flops=5.3e+08
 sigma_tot[gemm] counter=178 i=5 t=3.3e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=178 i=6 t=3.1e-02 per=1.2e+01 cost=1.4e+07 flops=4.5e+08
 sigma_tot[gemm] counter=178 i=7 t=3.1e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=178 total t=1.3e-01 per=4.8e+01 cost=6.0e+07 flops=4.7e+08
 sigma_tot[red] counter=178 t=1.1e-01 per=4.3e+01 cost=1.4e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,2.0e-06,1.2e-06,1.9e-07
    5   0 -    -116.339671397293 -3.665e-06  3.962e-04    3     5  1.101e-02 2.202e-03 2.149e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.455e-05,1.468e-04,9.315e-04,8.002e-04,1.947e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.106e-05 speed=9.623e-02GB/S T(nccl)=4.349e-05 speed=4.660e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=9.3e-04 t_reduction=8.0e-04 tot=1.9e-03 -----
 sigma[inter] counter=179 t=1.5e-04 per=7.8e+00 cost=3.5e+05 flops=2.4e+09
 sigma[gemm] counter=179 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=2 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=3 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=4 t=2.0e-04 per=1.0e+01 cost=7.9e+04 flops=4.0e+08
 sigma[gemm] counter=179 i=5 t=2.4e-04 per=1.3e+01 cost=7.9e+04 flops=3.3e+08
 sigma[gemm] counter=179 i=6 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.3e+08
 sigma[gemm] counter=179 i=7 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.0e+08
 sigma[gemm] counter=179 total t=9.3e-04 per=5.0e+01 cost=4.6e+05 flops=4.9e+08
 sigma[red] counter=179 t=8.0e-04 per=4.3e+01 cost=1.1e+05 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.7e-01 -----
 sigma_tot[inter] counter=179 t=2.5e-02 per=9.4e+00 cost=7.4e+07 flops=2.9e+09
 sigma_tot[gemm] counter=179 i=0 t=4.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=1 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=2 t=3.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=3 t=3.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=4 t=3.0e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=179 i=5 t=3.3e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=179 i=6 t=3.1e-02 per=1.2e+01 cost=1.4e+07 flops=4.5e+08
 sigma_tot[gemm] counter=179 i=7 t=3.1e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=179 total t=1.3e-01 per=4.8e+01 cost=6.1e+07 flops=4.7e+08
 sigma_tot[red] counter=179 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.2e-05,2.1e-06,1.2e-06,1.6e-07
    6   0 -    -116.339671851543 -4.543e-07  1.380e-04    3     6  1.320e-02 2.200e-03 2.148e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.425e-05,1.442e-04,9.351e-04,8.012e-04,1.949e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.101e-05 speed=9.647e-02GB/S T(nccl)=4.324e-05 speed=4.687e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=9.3e-04 t_reduction=8.0e-04 tot=1.9e-03 -----
 sigma[inter] counter=180 t=1.4e-04 per=7.7e+00 cost=3.5e+05 flops=2.4e+09
 sigma[gemm] counter=180 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=1 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=2 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=3 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=4 t=2.0e-04 per=1.1e+01 cost=7.9e+04 flops=3.9e+08
 sigma[gemm] counter=180 i=5 t=2.3e-04 per=1.2e+01 cost=7.9e+04 flops=3.4e+08
 sigma[gemm] counter=180 i=6 t=2.4e-04 per=1.3e+01 cost=1.5e+05 flops=6.4e+08
 sigma[gemm] counter=180 i=7 t=2.5e-04 per=1.3e+01 cost=1.5e+05 flops=5.9e+08
 sigma[gemm] counter=180 total t=9.3e-04 per=5.0e+01 cost=4.6e+05 flops=4.9e+08
 sigma[red] counter=180 t=8.0e-04 per=4.3e+01 cost=1.1e+05 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.7e-01 -----
 sigma_tot[inter] counter=180 t=2.5e-02 per=9.4e+00 cost=7.4e+07 flops=2.9e+09
 sigma_tot[gemm] counter=180 i=0 t=4.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=1 t=3.7e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=2 t=3.7e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=3 t=3.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=4 t=3.0e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=180 i=5 t=3.3e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=180 i=6 t=3.2e-02 per=1.2e+01 cost=1.4e+07 flops=4.6e+08
 sigma_tot[gemm] counter=180 i=7 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=180 total t=1.3e-01 per=4.8e+01 cost=6.1e+07 flops=4.7e+08
 sigma_tot[red] counter=180 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,2.0e-06,1.3e-06,1.6e-07
    7   0 +    -116.339671899742 -4.820e-08  4.304e-05    3     7  1.539e-02 2.198e-03 2.147e-03
TIMING FOR Davidson : 1.540e-02  T(cal/comm/rest)=1.503e-02,1.980e-06,3.665e-04
decomposed t_rest=3.665e-04
 T(sub)    =1.383e-04 per=3.773e+01
 T(precond)=1.880e-05 per=5.129e+00
 T(ortho)  =9.767e-06 per=2.665e+00
 T(xcopy)  =8.210e-07 per=2.240e-01
 T(xnrm2)  =1.304e-06 per=3.558e-01
 T(other)  =1.975e-04 per=5.390e+01
optimized energies: isweep=0 ibond=28 dots=2 e[0]=-116.339671899742 nmvp=7
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.548e-03 change=2.444e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=11 dimAll=37
 (18,2):4 (18,0):3 (18,4):1 (19,3):6 (19,1):8 (20,2):6 (20,0):4 (20,4):2 (21,3):1 (21,1):1 (19,5):1
timing for divide=7.9e-06
timing for compute=6.5e-05
timing for collect=1.1e-05
----- TMING FOR decimation_genbasis(su2): 8.5e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.9e-06,5.6e-05,0.0e+00,9.2e-06,1.1e-05 -----
decimation summary: 37->10 dwt=+8.624e-03 SvN=1.626e+00
 qbond: qkept nsym=5 dimAll=10
 (20,2):4 (20,0):3 (20,4):1 (21,3):1 (21,1):1
----- TIMING for decimation_row(nkr): 1.005e-03 S T(decim/select/formRot)=1.300e-04,8.547e-04,1.985e-05 -----
----- TIMING FOR twodot_decimation: 1.110e-03 S T(wf/decim)=8.993e-05,1.020e-03 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:13 S:3 H:1 P:27 Q:26 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=1273:9.712e-03MB:9.485e-06GB
        per(mem): C:12.3 S:2.83 H:2.2 P:0 Q:82.7 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.548e-03 change=1.433e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=67 : 2.944e-04 S -----
rank=0 GPUmem(GB): used=5.054e-05 (oper)=2.933e-05
rank=0 GPUmem(GB): used=5.084e-05 (oper,site)=2.933e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=67
 no. of rintermediate operators=79
 no. of coefficients=948:7.233e-03MB:7.063e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.667e-05 S -----
rank=0 GPUmem(GB): used=5.790e-05 (oper,site,rinter)=2.933e-05,2.980e-07,7.063e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.312e-03 S size(rtasks)=67 size(Rlst2)=25 T(Rmu/Rlist)=1.045e-04,1.208e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.363e-03 S size(rtasks)=67 size(Rlst)=1054 -----
rank=0 GPUmem(GB): used=5.790e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.906e-04 blksize=16 blksize0=4 batchsize=1054
rank=0 GPUmem(GB): used=3.485e-04 (oper,site,rinter,batch)=2.933e-05,2.980e-07,7.063e-06,2.906e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.701e-05,3.748e-04,1.389e-04
----- TIMING FOR renorm : t_inter=9.7e-05 t_gemm=3.7e-04 t_reduction=1.4e-04 tot=6.1e-04 -----
 renorm[inter] counter=332 t=9.7e-05 per=1.6e+01 cost=2.1e+04 flops=2.1e+08
 renorm[gemm] counter=332 i=0 t=2.0e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=332 i=1 t=1.8e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=332 i=2 t=1.1e-04 per=1.8e+01 cost=3.6e+03 flops=3.4e+07
 renorm[gemm] counter=332 i=3 t=1.2e-04 per=2.0e+01 cost=1.3e+04 flops=1.1e+08
 renorm[gemm] counter=332 i=4 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=332 i=5 t=1.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=332 i=6 t=1.4e-04 per=2.3e+01 cost=3.4e+04 flops=2.4e+08
 renorm[gemm] counter=332 total t=3.7e-04 per=6.1e+01 cost=5.0e+04 flops=1.3e+08
 renorm[red] counter=332 t=1.4e-04 per=2.3e+01 cost=1.8e+04 flops=1.3e+08
----- TIMING FOR renorm_tot : t_inter=2.9e-03 t_gemm=1.2e-02 t_reduction=4.7e-03 tot=2.0e-02 -----
 renorm_tot[inter] counter=332 t=2.9e-03 per=1.5e+01 cost=5.6e+05 flops=1.9e+08
 renorm_tot[gemm] counter=332 i=0 t=6.3e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=332 i=1 t=5.5e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=332 i=2 t=1.8e-03 per=8.8e+00 cost=3.8e+04 flops=2.2e+07
 renorm_tot[gemm] counter=332 i=3 t=2.0e-03 per=1.0e+01 cost=2.0e+05 flops=1.0e+08
 renorm_tot[gemm] counter=332 i=4 t=2.2e-03 per=1.1e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=332 i=5 t=2.3e-03 per=1.1e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=332 i=6 t=4.1e-03 per=2.0e+01 cost=7.6e+05 flops=1.9e+08
 renorm_tot[gemm] counter=332 total t=1.2e-02 per=6.2e+01 cost=1.3e+06 flops=1.1e+08
 renorm_tot[red] counter=332 t=4.7e-03 per=2.3e+01 cost=3.3e+05 flops=7.0e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.849e-05 (oper)=2.942e-05
rank=0 GPUmem(GB): used=5.879e-05 (oper,site,rinter)=2.942e-05,2.980e-07,8.047e-07
rank=0 GPUmem(GB): used=6.092e-05 (oper,site,rinter,batch)=2.942e-05,2.980e-07,8.047e-07,2.131e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.565e-03 S T(preprocess/alloc/comp/red/dealloc)=3.798e-04,4.179e-04,1.944e-03,1.397e-04,4.824e-05 -----
----- TIMING FOR oper_renorm_opS : 2.581e-03 S rank=0 -----
qops.to_cpu: size(tot)=1273:9.712e-03MB:9.485e-06GB T(to_cpu)=3.147e-05S speed=3.014e-01GB/S
check ||H-H.dagger||=3.696e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.00602 S rank=0 -----
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=2.083e-03 change=3.641e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=4.051e-03 change=-1.411e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=4.051e-03 change=-3.830e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 5.283e-02 S #####
 T(local opt: fetch) = 2.454e-03 S  per = 4.64  per(accum) = 4.64
 T(local opt: hdiag) = 2.760e-03 S  per = 5.22  per(accum) = 9.87
 T(local opt: dvdsn) = 3.719e-02 S  per = 70.4  per(accum) = 80.3
 T(local opt: decim) = 1.141e-03 S  per = 2.16  per(accum) = 82.4
 T(local opt: guess) = 9.367e-05 S  per = 0.177  per(accum) = 82.6
 T(local opt: renrm) = 6.848e-03 S  per =   13  per(accum) = 95.6
 T(local opt: save ) = 2.342e-03 S  per = 4.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.719e-02 S  T(sum) = 3.653e-02 S  per = 9.823e+01
 T(local opt: preprocess                  ) = 3.039e-04 S  per = 0.832  per(accum) = 0.832
 T(local opt: symbolic_formulae           ) = 5.360e-04 S  per = 1.47  per(accum) = 2.3
 T(local opt: hintermediate init          ) = 6.888e-05 S  per = 0.189  per(accum) = 2.49
 T(local opt: preprocess_hformulae_Hxlist ) = 1.650e-02 S  per = 45.2  per(accum) = 47.6
 T(local opt: hmmtasks init               ) = 3.585e-03 S  per = 9.81  per(accum) = 57.5
 T(local opt: initial guess for dvdson    ) = 1.440e-04 S  per = 0.394  per(accum) = 57.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.457e-02 S  per = 39.9  per(accum) = 97.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.512e-04 S  per = 0.414  per(accum) = 98.1
 T(local opt: dvdson [nccl]               ) = 3.123e-04 S  per = 0.855  per(accum) = 99
 T(local opt: dvdson [mpi]                ) = 1.980e-06 S  per = 0.00542  per(accum) = 99
 T(local opt: dvdson [rest part(linalg)]  ) = 3.665e-04 S  per =    1  per(accum) = 100
Detailed decomposition of T(renrm) = 6.848e-03 S  T(sum) = 6.848e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.185e-05 S  per = 0.757  per(accum) = 0.757
 T(local opt: qops init                    ) = 3.797e-04 S  per = 5.54  per(accum) = 6.3
 T(local opt: symbolic_formulae_renorm     ) = 3.050e-04 S  per = 4.45  per(accum) = 10.8
 T(local opt: allocate qops on gpu         ) = 6.054e-05 S  per = 0.884  per(accum) = 11.6
 T(local opt: site memcpy cpu2gpu          ) = 2.727e-05 S  per = 0.398  per(accum) = 12
 T(local opt: rintermediate init           ) = 6.628e-05 S  per = 0.968  per(accum) = 13
 T(local opt: preprocess_formulae_Rlist2   ) = 1.374e-03 S  per = 20.1  per(accum) = 33.1
 T(local opt: rmmtasks init                ) = 3.726e-04 S  per = 5.44  per(accum) = 38.5
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.000569  per(accum) = 38.5
 T(local opt: preprocess_renorm_batchGPU   ) = 7.538e-04 S  per =   11  per(accum) = 49.5
 T(local opt: deallocate cpu and gpu memory) = 3.070e-05 S  per = 0.448  per(accum) = 50
 T(local opt: construct opS [ifdists=true] ) = 2.587e-03 S  per = 37.8  per(accum) = 87.7
 T(local opt: reduction of opS & opH [nccl]) = 1.794e-05 S  per = 0.262  per(accum) = 88
 T(local opt: qops memcpy gpu2cpu          ) = 3.552e-05 S  per = 0.519  per(accum) = 88.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.140e-05 S  per = 0.166  per(accum) = 88.7
 T(local opt: qops_pool join and erase     ) = 7.708e-04 S  per = 11.3  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 3.516e-06 S  per = 0.0513  per(accum) = 100
ctns::rcanon_save_site idx=12 scratch=./scratch/sweep size=40:3e-07GB T(load)=0.0006S speed=0.00049GB/S
##### sweep opt: 1.420e+00 S #####
 T(sweep opt: fetch) = 7.376e-02 S  per = 5.19  per(accum) = 5.19
 T(sweep opt: hdiag) = 7.587e-02 S  per = 5.34  per(accum) = 10.5
 T(sweep opt: dvdsn) = 9.097e-01 S  per = 64.1  per(accum) = 74.6
 T(sweep opt: decim) = 3.293e-02 S  per = 2.32  per(accum) = 76.9
 T(sweep opt: guess) = 2.592e-03 S  per = 0.183  per(accum) = 77.1
 T(sweep opt: renrm) = 2.709e-01 S  per = 19.1  per(accum) = 96.2
 T(sweep opt: save ) = 5.434e-02 S  per = 3.83  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.097e-01 S  T(sum) = 8.965e-01 S  per = 9.855e+01
 T(sweep opt: preprocess                  ) = 9.709e-03 S  per = 1.08  per(accum) = 1.08
 T(sweep opt: symbolic_formulae           ) = 1.456e-02 S  per = 1.62  per(accum) = 2.71
 T(sweep opt: hintermediate init          ) = 2.248e-03 S  per = 0.251  per(accum) = 2.96
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.446e-01 S  per = 49.6  per(accum) = 52.6
 T(sweep opt: hmmtasks init               ) = 8.828e-02 S  per = 9.85  per(accum) = 62.4
 T(sweep opt: initial guess for dvdson    ) = 4.199e-03 S  per = 0.468  per(accum) = 62.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.094e-01 S  per = 34.5  per(accum) = 97.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.998e-03 S  per = 0.446  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 9.515e-03 S  per = 1.06  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 8.863e-05 S  per = 0.00989  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.856e-03 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.709e-01 S  T(sum) = 2.709e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.554e-03 S  per = 0.574  per(accum) = 0.574
 T(sweep opt: qops init                    ) = 1.028e-02 S  per = 3.79  per(accum) = 4.37
 T(sweep opt: symbolic_formulae_renorm     ) = 4.904e-03 S  per = 1.81  per(accum) = 6.18
 T(sweep opt: allocate qops on gpu         ) = 1.662e-03 S  per = 0.613  per(accum) = 6.79
 T(sweep opt: site memcpy cpu2gpu          ) = 7.398e-04 S  per = 0.273  per(accum) = 7.06
 T(sweep opt: rintermediate init           ) = 1.428e-03 S  per = 0.527  per(accum) = 7.59
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.644e-02 S  per = 13.5  per(accum) = 21
 T(sweep opt: rmmtasks init                ) = 1.125e-02 S  per = 4.15  per(accum) = 25.2
 T(sweep opt: qops memset on cpu           ) = 1.322e-06 S  per = 0.000488  per(accum) = 25.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.416e-02 S  per = 8.92  per(accum) = 34.1
 T(sweep opt: deallocate cpu and gpu memory) = 8.847e-04 S  per = 0.327  per(accum) = 34.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.483e-01 S  per = 54.7  per(accum) = 89.2
 T(sweep opt: reduction of opS & opH [nccl]) = 6.221e-04 S  per = 0.23  per(accum) = 89.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.023e-03 S  per = 0.378  per(accum) = 89.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.428e-04 S  per = 0.163  per(accum) = 89.9
 T(sweep opt: qops_pool join and erase     ) = 2.188e-02 S  per = 8.07  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 5.397e-03 S  per = 1.99  per(accum) = 100
##### global opt: 1.420e+00 S #####
 T(global opt: fetch) = 7.376e-02 S  per = 5.19  per(accum) = 5.19
 T(global opt: hdiag) = 7.587e-02 S  per = 5.34  per(accum) = 10.5
 T(global opt: dvdsn) = 9.097e-01 S  per = 64.1  per(accum) = 74.6
 T(global opt: decim) = 3.293e-02 S  per = 2.32  per(accum) = 76.9
 T(global opt: guess) = 2.592e-03 S  per = 0.183  per(accum) = 77.1
 T(global opt: renrm) = 2.709e-01 S  per = 19.1  per(accum) = 96.2
 T(global opt: save ) = 5.434e-02 S  per = 3.83  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.097e-01 S  T(sum) = 8.965e-01 S  per = 9.855e+01
 T(global opt: preprocess                  ) = 9.709e-03 S  per = 1.08  per(accum) = 1.08
 T(global opt: symbolic_formulae           ) = 1.456e-02 S  per = 1.62  per(accum) = 2.71
 T(global opt: hintermediate init          ) = 2.248e-03 S  per = 0.251  per(accum) = 2.96
 T(global opt: preprocess_hformulae_Hxlist ) = 4.446e-01 S  per = 49.6  per(accum) = 52.6
 T(global opt: hmmtasks init               ) = 8.828e-02 S  per = 9.85  per(accum) = 62.4
 T(global opt: initial guess for dvdson    ) = 4.199e-03 S  per = 0.468  per(accum) = 62.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.094e-01 S  per = 34.5  per(accum) = 97.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.998e-03 S  per = 0.446  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 9.515e-03 S  per = 1.06  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 8.863e-05 S  per = 0.00989  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 9.856e-03 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.709e-01 S  T(sum) = 2.709e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.554e-03 S  per = 0.574  per(accum) = 0.574
 T(global opt: qops init                    ) = 1.028e-02 S  per = 3.79  per(accum) = 4.37
 T(global opt: symbolic_formulae_renorm     ) = 4.904e-03 S  per = 1.81  per(accum) = 6.18
 T(global opt: allocate qops on gpu         ) = 1.662e-03 S  per = 0.613  per(accum) = 6.79
 T(global opt: site memcpy cpu2gpu          ) = 7.398e-04 S  per = 0.273  per(accum) = 7.06
 T(global opt: rintermediate init           ) = 1.428e-03 S  per = 0.527  per(accum) = 7.59
 T(global opt: preprocess_formulae_Rlist2   ) = 3.644e-02 S  per = 13.5  per(accum) = 21
 T(global opt: rmmtasks init                ) = 1.125e-02 S  per = 4.15  per(accum) = 25.2
 T(global opt: qops memset on cpu           ) = 1.322e-06 S  per = 0.000488  per(accum) = 25.2
 T(global opt: preprocess_renorm_batchGPU   ) = 2.416e-02 S  per = 8.92  per(accum) = 34.1
 T(global opt: deallocate cpu and gpu memory) = 8.847e-04 S  per = 0.327  per(accum) = 34.4
 T(global opt: construct opS [ifdists=true] ) = 1.483e-01 S  per = 54.7  per(accum) = 89.2
 T(global opt: reduction of opS & opH [nccl]) = 6.221e-04 S  per = 0.23  per(accum) = 89.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.023e-03 S  per = 0.378  per(accum) = 89.8
 T(global opt: reduction of opS & opH [mpi] ) = 4.428e-04 S  per = 0.163  per(accum) = 89.9
 T(global opt: qops_pool join and erase     ) = 2.188e-02 S  per = 8.07  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 5.397e-03 S  per = 1.99  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-2.451e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=29/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=14 scratch=./scratch/sweep size=57:4.25e-07GB T(load)=3.33e-04S speed=1.28e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=119:9.08e-04MB:8.87e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=62:4.73e-04MB:4.62e-07GB
total mem of comb=182:1.39e-03MB:1.36e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=7.406e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:5 S:8 H:1 A:12 B:16 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=778:5.936e-03MB:5.797e-06GB
        per(mem): C:13.5 S:21.6 H:2.57 A:10.9 B:51.4 
 rqops: oplist=CSHPQ nops=C:13 S:3 H:1 P:27 Q:26 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=1273:0.00971MB:9.48e-06GB
        per(mem): C:12.3 S:2.83 H:2.2 P:0 Q:82.7 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4047:0.0309MB:3.02e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=9.158e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-5.782e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=166:1.266e-03MB
qtensor4: wf4 own=1 _data=0x5585f64c4000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
 qbond: qcol nsym=5 dimAll=10
 (20,2):4 (20,0):3 (20,4):1 (21,3):1 (21,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=41 nblocks=456 size=166:1.266e-03MB
### DIAG TIMING: total=3.058e-03 t1=1.693e-05, t2=2.429e-05, t3=2.060e-05, t4=2.938e-03, t5=9.362e-06, t6=4.062e-05, t7=8.159e-06
duration_diagGPU:3.077e-03
duration_diagreduce:4.800e-08
duration_diagtransform:7.590e-07
----- TIMING FOR symbolic_formulae_twodot with size=247 : 5.467e-04 S -----
rank=0 GPUmem(GB): used=3.015e-05 (oper)=3.015e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=247
 no. of hintermediate operators=122
 no. of coefficients=1502:1.146e-02MB:1.119e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.339e-05 S -----
rank=0 GPUmem(GB): used=4.134e-05 (oper,hinter)=3.015e-05,1.119e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.167e-02 S size(H_formulae)=247 size(Hxlst2)=41 T(Hmu/Hxlist)=1.301e-04,3.154e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.269e-02 S size(H_formulae)=247 size(Hxlst)=13172 -----
rank=0 GPUmem(GB): used=4.134e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.474e-06 batch[need]=3.337e-03 blksize=12 blksize0=9 batchsize=13172
rank=0 GPUmem(GB): used=3.381e-03 (oper,hinter,dvdson,batch)=3.015e-05,1.119e-05,2.474e-06,3.337e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=166 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.407e-05,2.039e-04,9.163e-04,9.097e-04,2.114e-03
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=2.279e-05 speed=1.085e-01GB/S T(nccl)=5.128e-05 speed=4.824e-02GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.2e-04 t_reduction=9.1e-04 tot=2.0e-03 -----
 sigma[inter] counter=181 t=2.0e-04 per=1.0e+01 cost=5.1e+05 flops=2.5e+09
 sigma[gemm] counter=181 i=0 t=1.9e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=1 t=1.7e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=2 t=1.6e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=3 t=1.7e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=4 t=2.3e-04 per=1.1e+01 cost=8.5e+04 flops=3.8e+08
 sigma[gemm] counter=181 i=5 t=2.4e-04 per=1.2e+01 cost=8.8e+04 flops=3.6e+08
 sigma[gemm] counter=181 i=6 t=2.2e-04 per=1.1e+01 cost=1.1e+05 flops=4.8e+08
 sigma[gemm] counter=181 i=7 t=2.2e-04 per=1.1e+01 cost=1.1e+05 flops=5.1e+08
 sigma[gemm] counter=181 total t=9.2e-04 per=4.5e+01 cost=3.9e+05 flops=4.3e+08
 sigma[red] counter=181 t=9.1e-04 per=4.5e+01 cost=1.1e+05 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.7e-01 -----
 sigma_tot[inter] counter=181 t=2.6e-02 per=9.4e+00 cost=7.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=181 i=0 t=4.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=1 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=2 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=3 t=3.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=4 t=3.1e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=181 i=5 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=181 i=6 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=181 i=7 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=181 total t=1.3e-01 per=4.8e+01 cost=6.1e+07 flops=4.7e+08
 sigma_tot[red] counter=181 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,3.4e-06,1.1e-06,1.1e-06,2.4e-07
settings: ndim=166 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336065256982 -1.116e+03  1.593e-02    1     1  2.462e-03 2.462e-03 2.434e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.723e-05,1.950e-04,1.035e-03,9.884e-04,2.290e-03
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=2.245e-05 speed=1.102e-01GB/S T(nccl)=4.478e-05 speed=5.524e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.0e-03 t_reduction=9.9e-04 tot=2.2e-03 -----
 sigma[inter] counter=182 t=1.9e-04 per=8.8e+00 cost=5.1e+05 flops=2.6e+09
 sigma[gemm] counter=182 i=0 t=2.0e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=1 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=2 t=1.9e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=3 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=4 t=2.5e-04 per=1.1e+01 cost=8.5e+04 flops=3.4e+08
 sigma[gemm] counter=182 i=5 t=2.8e-04 per=1.2e+01 cost=8.8e+04 flops=3.2e+08
 sigma[gemm] counter=182 i=6 t=2.4e-04 per=1.1e+01 cost=1.1e+05 flops=4.4e+08
 sigma[gemm] counter=182 i=7 t=2.5e-04 per=1.1e+01 cost=1.1e+05 flops=4.3e+08
 sigma[gemm] counter=182 total t=1.0e-03 per=4.7e+01 cost=3.9e+05 flops=3.8e+08
 sigma[red] counter=182 t=9.9e-04 per=4.5e+01 cost=1.1e+05 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.7e-01 -----
 sigma_tot[inter] counter=182 t=2.6e-02 per=9.4e+00 cost=7.5e+07 flops=2.9e+09
 sigma_tot[gemm] counter=182 i=0 t=4.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=1 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=2 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=3 t=3.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=4 t=3.1e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=182 i=5 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=182 i=6 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=182 i=7 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=182 total t=1.3e-01 per=4.8e+01 cost=6.2e+07 flops=4.7e+08
 sigma_tot[red] counter=182 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.8e-05,3.0e-06,1.6e-06,3.0e-07
    2   0 -    -116.336645214260 -5.800e-04  4.132e-03    2     2  5.094e-03 2.547e-03 2.491e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.578e-05,1.868e-04,1.007e-03,9.670e-04,2.231e-03
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=2.141e-05 speed=1.156e-01GB/S T(nccl)=4.437e-05 speed=5.575e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.0e-03 t_reduction=9.7e-04 tot=2.2e-03 -----
 sigma[inter] counter=183 t=1.9e-04 per=8.6e+00 cost=5.1e+05 flops=2.7e+09
 sigma[gemm] counter=183 i=0 t=2.1e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=1 t=2.0e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=2 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=3 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=4 t=2.4e-04 per=1.1e+01 cost=8.5e+04 flops=3.6e+08
 sigma[gemm] counter=183 i=5 t=2.7e-04 per=1.3e+01 cost=8.8e+04 flops=3.2e+08
 sigma[gemm] counter=183 i=6 t=2.4e-04 per=1.1e+01 cost=1.1e+05 flops=4.4e+08
 sigma[gemm] counter=183 i=7 t=2.5e-04 per=1.1e+01 cost=1.1e+05 flops=4.5e+08
 sigma[gemm] counter=183 total t=1.0e-03 per=4.7e+01 cost=3.9e+05 flops=3.9e+08
 sigma[red] counter=183 t=9.7e-04 per=4.5e+01 cost=1.1e+05 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 -----
 sigma_tot[inter] counter=183 t=2.6e-02 per=9.4e+00 cost=7.6e+07 flops=2.9e+09
 sigma_tot[gemm] counter=183 i=0 t=4.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=1 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=2 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=3 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=4 t=3.1e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=183 i=5 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.8e+08
 sigma_tot[gemm] counter=183 i=6 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=183 i=7 t=3.2e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=183 total t=1.3e-01 per=4.8e+01 cost=6.2e+07 flops=4.7e+08
 sigma_tot[red] counter=183 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.7e-05,2.1e-06,1.7e-06,2.8e-07
    3   0 -    -116.336688708784 -4.349e-05  1.614e-03    3     3  7.581e-03 2.527e-03 2.471e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.620e-05,1.824e-04,1.012e-03,9.651e-04,2.230e-03
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=2.199e-05 speed=1.125e-01GB/S T(nccl)=4.421e-05 speed=5.595e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.0e-03 t_reduction=9.6e-04 tot=2.2e-03 -----
 sigma[inter] counter=184 t=1.8e-04 per=8.4e+00 cost=5.1e+05 flops=2.8e+09
 sigma[gemm] counter=184 i=0 t=1.9e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=1 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=2 t=1.9e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=3 t=1.9e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=4 t=2.5e-04 per=1.2e+01 cost=8.5e+04 flops=3.4e+08
 sigma[gemm] counter=184 i=5 t=2.7e-04 per=1.3e+01 cost=8.8e+04 flops=3.2e+08
 sigma[gemm] counter=184 i=6 t=2.3e-04 per=1.1e+01 cost=1.1e+05 flops=4.6e+08
 sigma[gemm] counter=184 i=7 t=2.4e-04 per=1.1e+01 cost=1.1e+05 flops=4.5e+08
 sigma[gemm] counter=184 total t=1.0e-03 per=4.7e+01 cost=3.9e+05 flops=3.9e+08
 sigma[red] counter=184 t=9.6e-04 per=4.5e+01 cost=1.1e+05 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 -----
 sigma_tot[inter] counter=184 t=2.6e-02 per=9.4e+00 cost=7.6e+07 flops=2.9e+09
 sigma_tot[gemm] counter=184 i=0 t=4.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=1 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=2 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=3 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=4 t=3.1e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=184 i=5 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=184 i=6 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=184 i=7 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=184 total t=1.3e-01 per=4.8e+01 cost=6.3e+07 flops=4.7e+08
 sigma_tot[red] counter=184 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,1.9e-06,1.6e-06,1.8e-07
    4   0 -    -116.336696022089 -7.313e-06  6.245e-04    3     4  1.005e-02 2.513e-03 2.459e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.530e-05,1.901e-04,1.058e-03,9.627e-04,2.280e-03
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=2.084e-05 speed=1.187e-01GB/S T(nccl)=4.445e-05 speed=5.564e-02GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=9.6e-04 tot=2.2e-03 -----
 sigma[inter] counter=185 t=1.9e-04 per=8.6e+00 cost=5.1e+05 flops=2.7e+09
 sigma[gemm] counter=185 i=0 t=2.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=1 t=2.0e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=2 t=2.1e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=3 t=2.0e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=4 t=2.6e-04 per=1.2e+01 cost=8.5e+04 flops=3.3e+08
 sigma[gemm] counter=185 i=5 t=2.7e-04 per=1.2e+01 cost=8.8e+04 flops=3.2e+08
 sigma[gemm] counter=185 i=6 t=2.7e-04 per=1.2e+01 cost=1.1e+05 flops=4.0e+08
 sigma[gemm] counter=185 i=7 t=2.5e-04 per=1.1e+01 cost=1.1e+05 flops=4.4e+08
 sigma[gemm] counter=185 total t=1.1e-03 per=4.8e+01 cost=3.9e+05 flops=3.7e+08
 sigma[red] counter=185 t=9.6e-04 per=4.4e+01 cost=1.1e+05 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 -----
 sigma_tot[inter] counter=185 t=2.6e-02 per=9.3e+00 cost=7.7e+07 flops=2.9e+09
 sigma_tot[gemm] counter=185 i=0 t=4.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=1 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=2 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=3 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=4 t=3.2e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=185 i=5 t=3.5e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=185 i=6 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.5e+08
 sigma_tot[gemm] counter=185 i=7 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=185 total t=1.3e-01 per=4.8e+01 cost=6.3e+07 flops=4.7e+08
 sigma_tot[red] counter=185 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,2.0e-06,1.5e-06,2.0e-07
    5   0 -    -116.336696950672 -9.286e-07  1.592e-04    3     5  1.258e-02 2.515e-03 2.462e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.537e-05,1.779e-04,1.000e-03,9.567e-04,2.204e-03
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=2.132e-05 speed=1.160e-01GB/S T(nccl)=4.405e-05 speed=5.616e-02GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.0e-03 t_reduction=9.6e-04 tot=2.1e-03 -----
 sigma[inter] counter=186 t=1.8e-04 per=8.3e+00 cost=5.1e+05 flops=2.9e+09
 sigma[gemm] counter=186 i=0 t=2.0e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=1 t=1.9e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=2 t=2.0e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=3 t=1.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=4 t=2.5e-04 per=1.2e+01 cost=8.5e+04 flops=3.5e+08
 sigma[gemm] counter=186 i=5 t=2.7e-04 per=1.3e+01 cost=8.8e+04 flops=3.3e+08
 sigma[gemm] counter=186 i=6 t=2.3e-04 per=1.1e+01 cost=1.1e+05 flops=4.6e+08
 sigma[gemm] counter=186 i=7 t=2.4e-04 per=1.1e+01 cost=1.1e+05 flops=4.5e+08
 sigma[gemm] counter=186 total t=1.0e-03 per=4.7e+01 cost=3.9e+05 flops=3.9e+08
 sigma[red] counter=186 t=9.6e-04 per=4.5e+01 cost=1.1e+05 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 -----
 sigma_tot[inter] counter=186 t=2.6e-02 per=9.3e+00 cost=7.7e+07 flops=2.9e+09
 sigma_tot[gemm] counter=186 i=0 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=1 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=2 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=3 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=4 t=3.2e-02 per=1.1e+01 cost=1.6e+07 flops=5.2e+08
 sigma_tot[gemm] counter=186 i=5 t=3.5e-02 per=1.2e+01 cost=1.7e+07 flops=4.7e+08
 sigma_tot[gemm] counter=186 i=6 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.5e+08
 sigma_tot[gemm] counter=186 i=7 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=186 total t=1.3e-01 per=4.8e+01 cost=6.3e+07 flops=4.7e+08
 sigma_tot[red] counter=186 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,2.1e-06,1.7e-06,2.0e-07
    6   0 +    -116.336697017628 -6.696e-08  4.375e-05    3     6  1.503e-02 2.505e-03 2.452e-03
TIMING FOR Davidson : 1.504e-02  T(cal/comm/rest)=1.471e-02,2.307e-06,3.321e-04
decomposed t_rest=3.321e-04
 T(sub)    =1.262e-04 per=3.801e+01
 T(precond)=2.031e-05 per=6.113e+00
 T(ortho)  =9.329e-06 per=2.809e+00
 T(xcopy)  =8.240e-07 per=2.481e-01
 T(xnrm2)  =1.280e-06 per=3.854e-01
 T(other)  =1.742e-04 per=5.244e+01
optimized energies: isweep=0 ibond=29 dots=2 e[0]=-116.336697017628 nmvp=6
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=5.379e-03 change=3.332e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=11 dimAll=37
 (20,2):4 (20,0):3 (20,4):1 (21,3):6 (21,1):8 (22,2):6 (22,0):4 (22,4):2 (23,3):1 (23,1):1 (21,5):1
timing for divide=1.1e-05
timing for compute=8.2e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,7.2e-05,0.0e+00,1.0e-05,1.3e-05 -----
decimation summary: 37->10 dwt=+1.424e-04 SvN=1.184e+00
 qbond: qkept nsym=4 dimAll=10
 (21,3):4 (21,1):3 (22,2):2 (22,4):1
----- TIMING for decimation_row(nkr): 1.106e-03 S T(decim/select/formRot)=1.496e-04,9.306e-04,2.625e-05 -----
----- TIMING FOR twodot_decimation: 1.238e-03 S T(wf/decim)=1.172e-04,1.121e-03 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:14 S:2 H:1 P:18 Q:20 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=1198:9.140e-03MB:8.926e-06GB
        per(mem): C:21 S:3.01 H:2.5 P:0 Q:73.5 
rank=0 CPUmem(GB): used=1.341e+00 pageheap_free=5.379e-03 change=8.224e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=53 : 2.507e-04 S -----
rank=0 GPUmem(GB): used=4.447e-05 (oper)=2.585e-05
rank=0 GPUmem(GB): used=4.493e-05 (oper,site)=2.585e-05,4.619e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=53
 no. of rintermediate operators=58
 no. of coefficients=754:5.753e-03MB:5.618e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.486e-05 S -----
rank=0 GPUmem(GB): used=5.055e-05 (oper,site,rinter)=2.585e-05,4.619e-07,5.618e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.493e-03 S size(rtasks)=53 size(Rlst2)=16 T(Rmu/Rlist)=9.515e-05,1.398e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.643e-03 S size(rtasks)=53 size(Rlst)=1250 -----
rank=0 GPUmem(GB): used=5.055e-05 avail=3.829e+01 total=3.829e+01 batch[need]=3.446e-04 blksize=16 blksize0=4 batchsize=1250
rank=0 GPUmem(GB): used=3.951e-04 (oper,site,rinter,batch)=2.585e-05,4.619e-07,5.618e-06,3.446e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.845e-05,5.437e-04,1.592e-04
----- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=5.4e-04 t_reduction=1.6e-04 tot=8.0e-04 -----
 renorm[inter] counter=339 t=9.8e-05 per=1.2e+01 cost=2.9e+04 flops=2.9e+08
 renorm[gemm] counter=339 i=0 t=2.0e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=339 i=1 t=1.8e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=339 i=2 t=1.5e-04 per=1.9e+01 cost=4.7e+03 flops=3.1e+07
 renorm[gemm] counter=339 i=3 t=1.9e-04 per=2.4e+01 cost=2.1e+04 flops=1.1e+08
 renorm[gemm] counter=339 i=4 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=339 i=5 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=339 i=6 t=1.9e-04 per=2.4e+01 cost=4.4e+04 flops=2.3e+08
 renorm[gemm] counter=339 total t=5.4e-04 per=6.8e+01 cost=7.0e+04 flops=1.3e+08
 renorm[red] counter=339 t=1.6e-04 per=2.0e+01 cost=2.0e+04 flops=1.2e+08
----- TIMING FOR renorm_tot : t_inter=3.0e-03 t_gemm=1.3e-02 t_reduction=4.9e-03 tot=2.1e-02 -----
 renorm_tot[inter] counter=339 t=3.0e-03 per=1.4e+01 cost=5.9e+05 flops=2.0e+08
 renorm_tot[gemm] counter=339 i=0 t=6.5e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=339 i=1 t=5.7e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=339 i=2 t=1.9e-03 per=9.2e+00 cost=4.3e+04 flops=2.2e+07
 renorm_tot[gemm] counter=339 i=3 t=2.2e-03 per=1.1e+01 cost=2.3e+05 flops=1.0e+08
 renorm_tot[gemm] counter=339 i=4 t=2.2e-03 per=1.0e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=339 i=5 t=2.3e-03 per=1.1e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=339 i=6 t=4.3e-03 per=2.1e+01 cost=8.1e+05 flops=1.9e+08
 renorm_tot[gemm] counter=339 total t=1.3e-02 per=6.2e+01 cost=1.4e+06 flops=1.1e+08
 renorm_tot[red] counter=339 t=4.9e-03 per=2.3e+01 cost=3.5e+05 flops=7.2e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.081e-05 (oper)=2.598e-05
rank=0 GPUmem(GB): used=5.127e-05 (oper,site,rinter)=2.598e-05,4.619e-07,5.811e-07
rank=0 GPUmem(GB): used=5.909e-05 (oper,site,rinter,batch)=2.598e-05,4.619e-07,5.811e-07,7.823e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.558e-03 S T(preprocess/alloc/comp/red/dealloc)=3.183e-04,3.669e-04,1.022e-03,1.214e-04,3.625e-05 -----
----- TIMING FOR oper_renorm_opS : 1.577e-03 S rank=0 -----
qops.to_cpu: size(tot)=1198:9.140e-03MB:8.926e-06GB T(to_cpu)=3.313e-05S speed=2.694e-01GB/S
check ||H-H.dagger||=8.443e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.00581 S rank=0 -----
rank=0 CPUmem(GB): used=1.342e+00 pageheap_free=5.173e-03 change=3.885e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=5.455e-03 change=-1.440e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=5.455e-03 change=-3.368e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 7.084e-02 S #####
 T(local opt: fetch) = 2.527e-03 S  per = 3.57  per(accum) = 3.57
 T(local opt: hdiag) = 3.196e-03 S  per = 4.51  per(accum) = 8.08
 T(local opt: dvdsn) = 5.518e-02 S  per = 77.9  per(accum) = 86
 T(local opt: decim) = 1.278e-03 S  per =  1.8  per(accum) = 87.8
 T(local opt: guess) = 1.130e-04 S  per = 0.159  per(accum) = 87.9
 T(local opt: renrm) = 6.683e-03 S  per = 9.43  per(accum) = 97.4
 T(local opt: save ) = 1.868e-03 S  per = 2.64  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.518e-02 S  T(sum) = 5.452e-02 S  per = 9.880e+01
 T(local opt: preprocess                  ) = 5.965e-04 S  per = 1.09  per(accum) = 1.09
 T(local opt: symbolic_formulae           ) = 5.618e-04 S  per = 1.03  per(accum) = 2.12
 T(local opt: hintermediate init          ) = 8.821e-05 S  per = 0.162  per(accum) = 2.29
 T(local opt: preprocess_hformulae_Hxlist ) = 3.279e-02 S  per = 60.1  per(accum) = 62.4
 T(local opt: hmmtasks init               ) = 5.254e-03 S  per = 9.64  per(accum) = 72.1
 T(local opt: initial guess for dvdson    ) = 1.804e-04 S  per = 0.331  per(accum) = 72.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.431e-02 S  per = 26.2  per(accum) = 98.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.308e-04 S  per = 0.24  per(accum) = 98.9
 T(local opt: dvdson [nccl]               ) = 2.731e-04 S  per = 0.501  per(accum) = 99.4
 T(local opt: dvdson [mpi]                ) = 2.307e-06 S  per = 0.00423  per(accum) = 99.4
 T(local opt: dvdson [rest part(linalg)]  ) = 3.321e-04 S  per = 0.609  per(accum) = 100
Detailed decomposition of T(renrm) = 6.683e-03 S  T(sum) = 6.683e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.335e-05 S  per = 0.798  per(accum) = 0.798
 T(local opt: qops init                    ) = 3.163e-04 S  per = 4.73  per(accum) = 5.53
 T(local opt: symbolic_formulae_renorm     ) = 2.614e-04 S  per = 3.91  per(accum) = 9.44
 T(local opt: allocate qops on gpu         ) = 5.951e-05 S  per = 0.89  per(accum) = 10.3
 T(local opt: site memcpy cpu2gpu          ) = 2.530e-05 S  per = 0.379  per(accum) = 10.7
 T(local opt: rintermediate init           ) = 6.371e-05 S  per = 0.953  per(accum) = 11.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.656e-03 S  per = 24.8  per(accum) = 36.4
 T(local opt: rmmtasks init                ) = 4.402e-04 S  per = 6.59  per(accum) = 43
 T(local opt: qops memset on cpu           ) = 4.500e-08 S  per = 0.000673  per(accum) = 43
 T(local opt: preprocess_renorm_batchGPU   ) = 9.846e-04 S  per = 14.7  per(accum) = 57.8
 T(local opt: deallocate cpu and gpu memory) = 3.427e-05 S  per = 0.513  per(accum) = 58.3
 T(local opt: construct opS [ifdists=true] ) = 1.591e-03 S  per = 23.8  per(accum) = 82.1
 T(local opt: reduction of opS & opH [nccl]) = 3.231e-04 S  per = 4.84  per(accum) = 86.9
 T(local opt: qops memcpy gpu2cpu          ) = 4.261e-05 S  per = 0.638  per(accum) = 87.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.209e-05 S  per = 0.181  per(accum) = 87.7
 T(local opt: qops_pool join and erase     ) = 8.168e-04 S  per = 12.2  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.124e-06 S  per = 0.0467  per(accum) = 100
ctns::rcanon_save_site idx=13 scratch=./scratch/sweep size=62:4.6e-07GB T(load)=0.00055S speed=0.00084GB/S
##### sweep opt: 1.491e+00 S #####
 T(sweep opt: fetch) = 7.629e-02 S  per = 5.12  per(accum) = 5.12
 T(sweep opt: hdiag) = 7.907e-02 S  per =  5.3  per(accum) = 10.4
 T(sweep opt: dvdsn) = 9.649e-01 S  per = 64.7  per(accum) = 75.1
 T(sweep opt: decim) = 3.421e-02 S  per = 2.29  per(accum) = 77.4
 T(sweep opt: guess) = 2.705e-03 S  per = 0.181  per(accum) = 77.6
 T(sweep opt: renrm) = 2.776e-01 S  per = 18.6  per(accum) = 96.2
 T(sweep opt: save ) = 5.621e-02 S  per = 3.77  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.649e-01 S  T(sum) = 9.510e-01 S  per = 9.856e+01
 T(sweep opt: preprocess                  ) = 1.031e-02 S  per = 1.08  per(accum) = 1.08
 T(sweep opt: symbolic_formulae           ) = 1.512e-02 S  per = 1.59  per(accum) = 2.67
 T(sweep opt: hintermediate init          ) = 2.336e-03 S  per = 0.246  per(accum) = 2.92
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.774e-01 S  per = 50.2  per(accum) = 53.1
 T(sweep opt: hmmtasks init               ) = 9.353e-02 S  per = 9.84  per(accum) = 63
 T(sweep opt: initial guess for dvdson    ) = 4.379e-03 S  per = 0.461  per(accum) = 63.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.237e-01 S  per =   34  per(accum) = 97.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.129e-03 S  per = 0.434  per(accum) = 97.9
 T(sweep opt: dvdson [nccl]               ) = 9.788e-03 S  per = 1.03  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 9.094e-05 S  per = 0.00956  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.019e-02 S  per = 1.07  per(accum) = 100
Detailed decomposition of T(renrm) = 2.776e-01 S  T(sum) = 2.776e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.608e-03 S  per = 0.579  per(accum) = 0.579
 T(sweep opt: qops init                    ) = 1.059e-02 S  per = 3.82  per(accum) = 4.4
 T(sweep opt: symbolic_formulae_renorm     ) = 5.165e-03 S  per = 1.86  per(accum) = 6.26
 T(sweep opt: allocate qops on gpu         ) = 1.721e-03 S  per = 0.62  per(accum) = 6.88
 T(sweep opt: site memcpy cpu2gpu          ) = 7.651e-04 S  per = 0.276  per(accum) = 7.15
 T(sweep opt: rintermediate init           ) = 1.492e-03 S  per = 0.537  per(accum) = 7.69
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.810e-02 S  per = 13.7  per(accum) = 21.4
 T(sweep opt: rmmtasks init                ) = 1.169e-02 S  per = 4.21  per(accum) = 25.6
 T(sweep opt: qops memset on cpu           ) = 1.367e-06 S  per = 0.000492  per(accum) = 25.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.514e-02 S  per = 9.06  per(accum) = 34.7
 T(sweep opt: deallocate cpu and gpu memory) = 9.190e-04 S  per = 0.331  per(accum) = 35
 T(sweep opt: construct opS [ifdists=true] ) = 1.498e-01 S  per =   54  per(accum) = 89
 T(sweep opt: reduction of opS & opH [nccl]) = 9.452e-04 S  per = 0.341  per(accum) = 89.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.066e-03 S  per = 0.384  per(accum) = 89.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.549e-04 S  per = 0.164  per(accum) = 89.9
 T(sweep opt: qops_pool join and erase     ) = 2.269e-02 S  per = 8.17  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 5.400e-03 S  per = 1.95  per(accum) = 100
##### global opt: 1.491e+00 S #####
 T(global opt: fetch) = 7.629e-02 S  per = 5.12  per(accum) = 5.12
 T(global opt: hdiag) = 7.907e-02 S  per =  5.3  per(accum) = 10.4
 T(global opt: dvdsn) = 9.649e-01 S  per = 64.7  per(accum) = 75.1
 T(global opt: decim) = 3.421e-02 S  per = 2.29  per(accum) = 77.4
 T(global opt: guess) = 2.705e-03 S  per = 0.181  per(accum) = 77.6
 T(global opt: renrm) = 2.776e-01 S  per = 18.6  per(accum) = 96.2
 T(global opt: save ) = 5.621e-02 S  per = 3.77  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.649e-01 S  T(sum) = 9.510e-01 S  per = 9.856e+01
 T(global opt: preprocess                  ) = 1.031e-02 S  per = 1.08  per(accum) = 1.08
 T(global opt: symbolic_formulae           ) = 1.512e-02 S  per = 1.59  per(accum) = 2.67
 T(global opt: hintermediate init          ) = 2.336e-03 S  per = 0.246  per(accum) = 2.92
 T(global opt: preprocess_hformulae_Hxlist ) = 4.774e-01 S  per = 50.2  per(accum) = 53.1
 T(global opt: hmmtasks init               ) = 9.353e-02 S  per = 9.84  per(accum) = 63
 T(global opt: initial guess for dvdson    ) = 4.379e-03 S  per = 0.461  per(accum) = 63.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.237e-01 S  per =   34  per(accum) = 97.5
 T(global opt: dvdson [cpu-gpu]            ) = 4.129e-03 S  per = 0.434  per(accum) = 97.9
 T(global opt: dvdson [nccl]               ) = 9.788e-03 S  per = 1.03  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 9.094e-05 S  per = 0.00956  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.019e-02 S  per = 1.07  per(accum) = 100
Detailed decomposition of T(renrm) = 2.776e-01 S  T(sum) = 2.776e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.608e-03 S  per = 0.579  per(accum) = 0.579
 T(global opt: qops init                    ) = 1.059e-02 S  per = 3.82  per(accum) = 4.4
 T(global opt: symbolic_formulae_renorm     ) = 5.165e-03 S  per = 1.86  per(accum) = 6.26
 T(global opt: allocate qops on gpu         ) = 1.721e-03 S  per = 0.62  per(accum) = 6.88
 T(global opt: site memcpy cpu2gpu          ) = 7.651e-04 S  per = 0.276  per(accum) = 7.15
 T(global opt: rintermediate init           ) = 1.492e-03 S  per = 0.537  per(accum) = 7.69
 T(global opt: preprocess_formulae_Rlist2   ) = 3.810e-02 S  per = 13.7  per(accum) = 21.4
 T(global opt: rmmtasks init                ) = 1.169e-02 S  per = 4.21  per(accum) = 25.6
 T(global opt: qops memset on cpu           ) = 1.367e-06 S  per = 0.000492  per(accum) = 25.6
 T(global opt: preprocess_renorm_batchGPU   ) = 2.514e-02 S  per = 9.06  per(accum) = 34.7
 T(global opt: deallocate cpu and gpu memory) = 9.190e-04 S  per = 0.331  per(accum) = 35
 T(global opt: construct opS [ifdists=true] ) = 1.498e-01 S  per =   54  per(accum) = 89
 T(global opt: reduction of opS & opH [nccl]) = 9.452e-04 S  per = 0.341  per(accum) = 89.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.066e-03 S  per = 0.384  per(accum) = 89.7
 T(global opt: reduction of opS & opH [mpi] ) = 4.549e-04 S  per = 0.164  per(accum) = 89.9
 T(global opt: qops_pool join and erase     ) = 2.269e-02 S  per = 8.17  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 5.400e-03 S  per = 1.95  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-3.338e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=30/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=15 scratch=./scratch/sweep size=46:3.43e-07GB T(load)=2.94e-04S speed=1.17e-03GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=103:7.86e-04MB:7.67e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=57:4.35e-04MB:4.25e-07GB
total mem of comb=161:1.23e-03MB:1.20e-06GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=5.648e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:8 H:1 A:8 B:10 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=362:2.762e-03MB:2.697e-06GB
        per(mem): C:13.3 S:26.5 H:5.25 A:2.49 B:52.5 
 rqops: oplist=CSHPQ nops=C:14 S:2 H:1 P:18 Q:20 
        dim(bra,ket)=10,10 size(op)=58:0.000443MB size(tot)=1198:0.00914MB:8.93e-06GB
        per(mem): C:21 S:3.01 H:2.5 P:0 Q:73.5 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3556:0.0271MB:2.65e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.332e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-2.444e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,10,3,3) nnz=139:1.060e-03MB
qtensor4: wf4 own=1 _data=0x5585ee939a80
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
 qbond: qcol nsym=4 dimAll=10
 (21,3):4 (21,1):3 (22,2):2 (22,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=139:1.060e-03MB
### DIAG TIMING: total=1.331e-03 t1=1.710e-05, t2=1.826e-05, t3=1.695e-05, t4=1.227e-03, t5=6.954e-06, t6=3.756e-05, t7=6.220e-06
duration_diagGPU:1.346e-03
duration_diagreduce:3.700e-08
duration_diagtransform:6.180e-07
----- TIMING FOR symbolic_formulae_twodot with size=191 : 3.441e-04 S -----
rank=0 GPUmem(GB): used=2.649e-05 (oper)=2.649e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=191
 no. of hintermediate operators=91
 no. of coefficients=1173:8.949e-03MB:8.740e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.998e-05 S -----
rank=0 GPUmem(GB): used=3.523e-05 (oper,hinter)=2.649e-05,8.740e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.620e-03 S size(H_formulae)=191 size(Hxlst2)=21 T(Hmu/Hxlist)=8.326e-05,6.537e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.981e-03 S size(H_formulae)=191 size(Hxlst)=3856 -----
rank=0 GPUmem(GB): used=3.523e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.071e-06 batch[need]=9.768e-04 blksize=12 blksize0=9 batchsize=3856
rank=0 GPUmem(GB): used=1.014e-03 (oper,hinter,dvdson,batch)=2.649e-05,8.740e-06,2.071e-06,9.768e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=139 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.112e-05,1.015e-04,5.892e-04,4.941e-04,1.264e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=2.220e-05 speed=9.328e-02GB/S T(nccl)=4.891e-05 speed=4.235e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=5.9e-04 t_reduction=4.9e-04 tot=1.2e-03 -----
 sigma[inter] counter=187 t=1.0e-04 per=8.6e+00 cost=2.6e+05 flops=2.6e+09
 sigma[gemm] counter=187 i=0 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=1 t=1.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=2 t=1.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=3 t=1.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=4 t=1.8e-04 per=1.5e+01 cost=5.2e+04 flops=2.9e+08
 sigma[gemm] counter=187 i=5 t=1.9e-04 per=1.6e+01 cost=5.4e+04 flops=2.8e+08
 sigma[gemm] counter=187 i=6 t=1.0e-04 per=8.7e+00 cost=5.9e+04 flops=5.7e+08
 sigma[gemm] counter=187 i=7 t=1.1e-04 per=9.2e+00 cost=5.8e+04 flops=5.4e+08
 sigma[gemm] counter=187 total t=5.9e-04 per=5.0e+01 cost=2.2e+05 flops=3.8e+08
 sigma[red] counter=187 t=4.9e-04 per=4.2e+01 cost=5.3e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.2e-01 tot=2.8e-01 -----
 sigma_tot[inter] counter=187 t=2.7e-02 per=9.3e+00 cost=7.7e+07 flops=2.9e+09
 sigma_tot[gemm] counter=187 i=0 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=1 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=2 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=3 t=3.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=4 t=3.2e-02 per=1.1e+01 cost=1.6e+07 flops=5.1e+08
 sigma_tot[gemm] counter=187 i=5 t=3.5e-02 per=1.2e+01 cost=1.7e+07 flops=4.7e+08
 sigma_tot[gemm] counter=187 i=6 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=187 i=7 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.7e+08
 sigma_tot[gemm] counter=187 total t=1.4e-01 per=4.8e+01 cost=6.4e+07 flops=4.7e+08
 sigma_tot[red] counter=187 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=8.0e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,2.9e-06,9.4e-07,1.1e-06,2.4e-07
settings: ndim=139 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336635896538 -1.116e+03  1.000e-02    1     1  1.553e-03 1.553e-03 1.524e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.621e-05,9.467e-05,6.846e-04,5.442e-04,1.394e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=2.229e-05 speed=9.293e-02GB/S T(nccl)=4.392e-05 speed=4.716e-02GB/S
----- TIMING FOR sigma : t_inter=9.5e-05 t_gemm=6.8e-04 t_reduction=5.4e-04 tot=1.3e-03 -----
 sigma[inter] counter=188 t=9.5e-05 per=7.2e+00 cost=2.6e+05 flops=2.7e+09
 sigma[gemm] counter=188 i=0 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=2 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=3 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=4 t=1.9e-04 per=1.4e+01 cost=5.2e+04 flops=2.7e+08
 sigma[gemm] counter=188 i=5 t=2.4e-04 per=1.8e+01 cost=5.4e+04 flops=2.3e+08
 sigma[gemm] counter=188 i=6 t=1.2e-04 per=9.0e+00 cost=5.9e+04 flops=5.0e+08
 sigma[gemm] counter=188 i=7 t=1.3e-04 per=1.0e+01 cost=5.8e+04 flops=4.4e+08
 sigma[gemm] counter=188 total t=6.8e-04 per=5.2e+01 cost=2.2e+05 flops=3.3e+08
 sigma[red] counter=188 t=5.4e-04 per=4.1e+01 cost=5.3e+04 flops=9.8e+07
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.2e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=188 t=2.7e-02 per=9.3e+00 cost=7.8e+07 flops=2.9e+09
 sigma_tot[gemm] counter=188 i=0 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=1 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=2 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=3 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=4 t=3.2e-02 per=1.1e+01 cost=1.7e+07 flops=5.1e+08
 sigma_tot[gemm] counter=188 i=5 t=3.5e-02 per=1.2e+01 cost=1.7e+07 flops=4.7e+08
 sigma_tot[gemm] counter=188 i=6 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=188 i=7 t=3.3e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=188 total t=1.4e-01 per=4.8e+01 cost=6.4e+07 flops=4.7e+08
 sigma_tot[red] counter=188 t=1.2e-01 per=4.3e+01 cost=1.5e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.1e-05,2.7e-06,1.4e-06,2.7e-07
    2   0 -    -116.336823387383 -1.875e-04  2.655e-03    2     2  3.219e-03 1.610e-03 1.562e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.481e-05,9.493e-05,6.978e-04,5.238e-04,1.385e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=2.172e-05 speed=9.535e-02GB/S T(nccl)=4.309e-05 speed=4.807e-02GB/S
----- TIMING FOR sigma : t_inter=9.5e-05 t_gemm=7.0e-04 t_reduction=5.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=189 t=9.5e-05 per=7.2e+00 cost=2.6e+05 flops=2.7e+09
 sigma[gemm] counter=189 i=0 t=2.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=1 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=2 t=2.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=3 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=4 t=2.0e-04 per=1.5e+01 cost=5.2e+04 flops=2.6e+08
 sigma[gemm] counter=189 i=5 t=2.5e-04 per=1.9e+01 cost=5.4e+04 flops=2.2e+08
 sigma[gemm] counter=189 i=6 t=1.2e-04 per=9.0e+00 cost=5.9e+04 flops=5.0e+08
 sigma[gemm] counter=189 i=7 t=1.2e-04 per=9.3e+00 cost=5.8e+04 flops=4.8e+08
 sigma[gemm] counter=189 total t=7.0e-04 per=5.3e+01 cost=2.2e+05 flops=3.2e+08
 sigma[red] counter=189 t=5.2e-04 per=4.0e+01 cost=5.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.2e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=189 t=2.7e-02 per=9.3e+00 cost=7.8e+07 flops=2.9e+09
 sigma_tot[gemm] counter=189 i=0 t=4.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=1 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=2 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=3 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=4 t=3.2e-02 per=1.1e+01 cost=1.7e+07 flops=5.1e+08
 sigma_tot[gemm] counter=189 i=5 t=3.6e-02 per=1.2e+01 cost=1.7e+07 flops=4.7e+08
 sigma_tot[gemm] counter=189 i=6 t=3.3e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=189 i=7 t=3.3e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=189 total t=1.4e-01 per=4.8e+01 cost=6.4e+07 flops=4.7e+08
 sigma_tot[red] counter=189 t=1.2e-01 per=4.3e+01 cost=1.6e+07 flops=1.3e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,2.0e-06,1.6e-06,2.4e-07
    3   0 -    -116.336847409293 -2.402e-05  1.454e-03    3     3  4.844e-03 1.615e-03 1.567e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.283e-04,8.811e-05,6.714e-04,5.269e-04,1.718e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=2.191e-05 speed=9.454e-02GB/S T(nccl)=4.064e-04 speed=5.097e-03GB/S
----- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=6.7e-04 t_reduction=5.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=190 t=8.8e-05 per=6.8e+00 cost=2.6e+05 flops=2.9e+09
 sigma[gemm] counter=190 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=2 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=3 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=4 t=1.8e-04 per=1.4e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=190 i=5 t=2.4e-04 per=1.9e+01 cost=5.4e+04 flops=2.2e+08
 sigma[gemm] counter=190 i=6 t=1.2e-04 per=9.2e+00 cost=5.9e+04 flops=5.0e+08
 sigma[gemm] counter=190 i=7 t=1.2e-04 per=9.6e+00 cost=5.8e+04 flops=4.8e+08
 sigma[gemm] counter=190 total t=6.7e-04 per=5.2e+01 cost=2.2e+05 flops=3.3e+08
 sigma[red] counter=190 t=5.3e-04 per=4.1e+01 cost=5.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.2e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=190 t=2.7e-02 per=9.3e+00 cost=7.8e+07 flops=2.9e+09
 sigma_tot[gemm] counter=190 i=0 t=4.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=1 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=2 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=3 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=4 t=3.3e-02 per=1.1e+01 cost=1.7e+07 flops=5.1e+08
 sigma_tot[gemm] counter=190 i=5 t=3.6e-02 per=1.2e+01 cost=1.7e+07 flops=4.7e+08
 sigma_tot[gemm] counter=190 i=6 t=3.4e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=190 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=190 total t=1.4e-01 per=4.8e+01 cost=6.4e+07 flops=4.7e+08
 sigma_tot[red] counter=190 t=1.2e-01 per=4.3e+01 cost=1.6e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,1.9e-06,1.4e-06,1.7e-07
    4   0 -    -116.336854059180 -6.650e-06  6.153e-04    3     4  6.800e-03 1.700e-03 1.652e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.403e-05,8.683e-05,6.721e-04,5.205e-04,1.347e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=2.141e-05 speed=9.673e-02GB/S T(nccl)=4.262e-05 speed=4.860e-02GB/S
----- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=6.7e-04 t_reduction=5.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=191 t=8.7e-05 per=6.8e+00 cost=2.6e+05 flops=3.0e+09
 sigma[gemm] counter=191 i=0 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=2 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=3 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=4 t=1.8e-04 per=1.4e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=191 i=5 t=2.4e-04 per=1.9e+01 cost=5.4e+04 flops=2.3e+08
 sigma[gemm] counter=191 i=6 t=1.2e-04 per=9.2e+00 cost=5.9e+04 flops=5.0e+08
 sigma[gemm] counter=191 i=7 t=1.2e-04 per=9.7e+00 cost=5.8e+04 flops=4.7e+08
 sigma[gemm] counter=191 total t=6.7e-04 per=5.3e+01 cost=2.2e+05 flops=3.3e+08
 sigma[red] counter=191 t=5.2e-04 per=4.1e+01 cost=5.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.2e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=191 t=2.7e-02 per=9.3e+00 cost=7.8e+07 flops=2.9e+09
 sigma_tot[gemm] counter=191 i=0 t=4.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=1 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=2 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=3 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=4 t=3.3e-02 per=1.1e+01 cost=1.7e+07 flops=5.1e+08
 sigma_tot[gemm] counter=191 i=5 t=3.6e-02 per=1.2e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=191 i=6 t=3.4e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=191 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=191 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.7e+08
 sigma_tot[red] counter=191 t=1.2e-01 per=4.3e+01 cost=1.6e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.2e-05,2.0e-06,1.4e-06,1.3e-07
    5   0 -    -116.336854925618 -8.664e-07  2.552e-04    3     5  8.390e-03 1.678e-03 1.631e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.396e-05,8.834e-05,6.614e-04,5.238e-04,1.341e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=2.160e-05 speed=9.591e-02GB/S T(nccl)=4.236e-05 speed=4.890e-02GB/S
----- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=6.6e-04 t_reduction=5.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=192 t=8.8e-05 per=6.9e+00 cost=2.6e+05 flops=2.9e+09
 sigma[gemm] counter=192 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=2 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=3 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=4 t=1.8e-04 per=1.4e+01 cost=5.2e+04 flops=2.8e+08
 sigma[gemm] counter=192 i=5 t=2.3e-04 per=1.8e+01 cost=5.4e+04 flops=2.3e+08
 sigma[gemm] counter=192 i=6 t=1.2e-04 per=9.2e+00 cost=5.9e+04 flops=5.1e+08
 sigma[gemm] counter=192 i=7 t=1.2e-04 per=9.6e+00 cost=5.8e+04 flops=4.8e+08
 sigma[gemm] counter=192 total t=6.6e-04 per=5.2e+01 cost=2.2e+05 flops=3.4e+08
 sigma[red] counter=192 t=5.2e-04 per=4.1e+01 cost=5.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=192 t=2.7e-02 per=9.3e+00 cost=7.9e+07 flops=2.9e+09
 sigma_tot[gemm] counter=192 i=0 t=4.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=1 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=2 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=3 t=3.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=4 t=3.3e-02 per=1.1e+01 cost=1.7e+07 flops=5.1e+08
 sigma_tot[gemm] counter=192 i=5 t=3.6e-02 per=1.3e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=192 i=6 t=3.4e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=192 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=192 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.7e+08
 sigma_tot[red] counter=192 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,1.8e-06,1.4e-06,1.5e-07
    6   0 -    -116.336855100778 -1.752e-07  1.084e-04    3     6  9.979e-03 1.663e-03 1.616e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.302e-05,8.658e-05,6.709e-04,5.274e-04,1.351e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=2.166e-05 speed=9.562e-02GB/S T(nccl)=4.136e-05 speed=5.008e-02GB/S
----- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=6.7e-04 t_reduction=5.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=193 t=8.7e-05 per=6.7e+00 cost=2.6e+05 flops=3.0e+09
 sigma[gemm] counter=193 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=2 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=3 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=4 t=1.9e-04 per=1.5e+01 cost=5.2e+04 flops=2.7e+08
 sigma[gemm] counter=193 i=5 t=2.3e-04 per=1.8e+01 cost=5.4e+04 flops=2.3e+08
 sigma[gemm] counter=193 i=6 t=1.2e-04 per=9.2e+00 cost=5.9e+04 flops=5.0e+08
 sigma[gemm] counter=193 i=7 t=1.2e-04 per=9.6e+00 cost=5.8e+04 flops=4.8e+08
 sigma[gemm] counter=193 total t=6.7e-04 per=5.2e+01 cost=2.2e+05 flops=3.3e+08
 sigma[red] counter=193 t=5.3e-04 per=4.1e+01 cost=5.3e+04 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=193 t=2.7e-02 per=9.3e+00 cost=7.9e+07 flops=2.9e+09
 sigma_tot[gemm] counter=193 i=0 t=4.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=1 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=2 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=3 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=4 t=3.3e-02 per=1.1e+01 cost=1.7e+07 flops=5.1e+08
 sigma_tot[gemm] counter=193 i=5 t=3.7e-02 per=1.3e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=193 i=6 t=3.4e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=193 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.7e+08
 sigma_tot[gemm] counter=193 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.7e+08
 sigma_tot[red] counter=193 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,2.1e-06,1.4e-06,1.4e-07
    7   0 +    -116.336855132062 -3.128e-08  3.614e-05    3     7  1.156e-02 1.651e-03 1.604e-03
TIMING FOR Davidson : 1.157e-02  T(cal/comm/rest)=1.123e-02,2.499e-06,3.413e-04
decomposed t_rest=3.413e-04
 T(sub)    =1.293e-04 per=3.789e+01
 T(precond)=1.731e-05 per=5.071e+00
 T(ortho)  =1.019e-05 per=2.985e+00
 T(xcopy)  =8.620e-07 per=2.526e-01
 T(xnrm2)  =1.256e-06 per=3.680e-01
 T(other)  =1.824e-04 per=5.343e+01
optimized energies: isweep=0 ibond=30 dots=2 e[0]=-116.336855132062 nmvp=7
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.831e-03 change=1.119e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=10 dimAll=40
 (21,3):4 (21,1):3 (22,2):9 (22,4):5 (23,3):7 (23,1):5 (24,2):2 (24,4):1 (22,0):3 (23,5):1
timing for divide=5.8e-06
timing for compute=7.4e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(su2): 9.2e-05 S T(divide/compute[cpu/gpu/rest]/collect)=5.8e-06,6.5e-05,0.0e+00,9.8e-06,1.2e-05 -----
decimation summary: 40->10 dwt=+5.309e-06 SvN=6.954e-01
 qbond: qkept nsym=5 dimAll=10
 (22,2):3 (23,3):3 (23,1):2 (21,1):1 (24,2):1
----- TIMING for decimation_row(nkr): 1.013e-03 S T(decim/select/formRot)=1.312e-04,8.638e-04,1.822e-05 -----
----- TIMING FOR twodot_decimation: 1.101e-03 S T(wf/decim)=6.792e-05,1.033e-03 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:15 S:2 H:1 P:12 Q:16 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=970:7.401e-03MB:7.227e-06GB
        per(mem): C:35.6 S:4.74 H:2.47 P:7.73 Q:49.5 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.831e-03 change=9.649e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=44 : 1.921e-04 S -----
rank=0 GPUmem(GB): used=3.976e-05 (oper)=2.359e-05
rank=0 GPUmem(GB): used=4.023e-05 (oper,site)=2.359e-05,4.694e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=44
 no. of rintermediate operators=44
 no. of coefficients=616:4.700e-03MB:4.590e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.047e-05 S -----
rank=0 GPUmem(GB): used=4.482e-05 (oper,site,rinter)=2.359e-05,4.694e-07,4.590e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.023e-03 S size(rtasks)=44 size(Rlst2)=25 T(Rmu/Rlist)=6.155e-05,9.616e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.104e-03 S size(rtasks)=44 size(Rlst)=860 -----
rank=0 GPUmem(GB): used=4.482e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.114e-04 blksize=12 blksize0=8 batchsize=860
rank=0 GPUmem(GB): used=2.563e-04 (oper,site,rinter,batch)=2.359e-05,4.694e-07,4.590e-06,2.114e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.626e-05,5.717e-04,1.632e-04
----- TIMING FOR renorm : t_inter=9.6e-05 t_gemm=5.7e-04 t_reduction=1.6e-04 tot=8.3e-04 -----
 renorm[inter] counter=344 t=9.6e-05 per=1.2e+01 cost=4.3e+04 flops=4.4e+08
 renorm[gemm] counter=344 i=0 t=2.1e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=344 i=1 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=344 i=2 t=1.7e-04 per=2.1e+01 cost=6.4e+03 flops=3.7e+07
 renorm[gemm] counter=344 i=3 t=2.0e-04 per=2.4e+01 cost=1.8e+04 flops=9.2e+07
 renorm[gemm] counter=344 i=4 t=1.8e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=344 i=5 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=344 i=6 t=1.9e-04 per=2.3e+01 cost=3.0e+04 flops=1.5e+08
 renorm[gemm] counter=344 total t=5.7e-04 per=6.9e+01 cost=5.4e+04 flops=9.5e+07
 renorm[red] counter=344 t=1.6e-04 per=2.0e+01 cost=1.2e+04 flops=7.1e+07
----- TIMING FOR renorm_tot : t_inter=3.1e-03 t_gemm=1.4e-02 t_reduction=5.0e-03 tot=2.2e-02 -----
 renorm_tot[inter] counter=344 t=3.1e-03 per=1.4e+01 cost=6.3e+05 flops=2.0e+08
 renorm_tot[gemm] counter=344 i=0 t=6.7e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=344 i=1 t=5.9e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=344 i=2 t=2.1e-03 per=9.6e+00 cost=4.9e+04 flops=2.4e+07
 renorm_tot[gemm] counter=344 i=3 t=2.4e-03 per=1.1e+01 cost=2.4e+05 flops=1.0e+08
 renorm_tot[gemm] counter=344 i=4 t=2.2e-03 per=1.0e+01 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=344 i=5 t=2.3e-03 per=1.1e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=344 i=6 t=4.5e-03 per=2.1e+01 cost=8.4e+05 flops=1.9e+08
 renorm_tot[gemm] counter=344 total t=1.4e-02 per=6.3e+01 cost=1.4e+06 flops=1.1e+08
 renorm_tot[red] counter=344 t=5.0e-03 per=2.3e+01 cost=3.6e+05 flops=7.2e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.515e-05 (oper)=2.376e-05
rank=0 GPUmem(GB): used=4.562e-05 (oper,site,rinter)=2.376e-05,4.694e-07,6.258e-07
rank=0 GPUmem(GB): used=5.742e-05 (oper,site,rinter,batch)=2.376e-05,4.694e-07,6.258e-07,1.180e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.409e-03 S T(preprocess/alloc/comp/red/dealloc)=2.875e-04,3.353e-04,9.271e-04,1.048e-04,3.079e-05 -----
----- TIMING FOR oper_renorm_opS : 1.427e-03 S rank=0 -----
qops.to_cpu: size(tot)=970:7.401e-03MB:7.227e-06GB T(to_cpu)=2.619e-05S speed=2.760e-01GB/S
check ||H-H.dagger||=3.121e-15 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.00497 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=1.831e-03 change=2.803e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=1.831e-03 change=-1.191e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=1.831e-03 change=-3.695e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.342e-02 S #####
 T(local opt: fetch) = 2.478e-03 S  per = 7.41  per(accum) = 7.41
 T(local opt: hdiag) = 1.434e-03 S  per = 4.29  per(accum) = 11.7
 T(local opt: dvdsn) = 2.084e-02 S  per = 62.3  per(accum) = 74
 T(local opt: decim) = 1.135e-03 S  per =  3.4  per(accum) = 77.4
 T(local opt: guess) = 7.432e-05 S  per = 0.222  per(accum) = 77.7
 T(local opt: renrm) = 5.717e-03 S  per = 17.1  per(accum) = 94.8
 T(local opt: save ) = 1.749e-03 S  per = 5.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.084e-02 S  T(sum) = 2.057e-02 S  per = 9.873e+01
 T(local opt: preprocess                  ) = 2.057e-04 S  per =    1  per(accum) = 1
 T(local opt: symbolic_formulae           ) = 3.550e-04 S  per = 1.73  per(accum) = 2.73
 T(local opt: hintermediate init          ) = 6.039e-05 S  per = 0.294  per(accum) = 3.02
 T(local opt: preprocess_hformulae_Hxlist ) = 7.003e-03 S  per =   34  per(accum) = 37.1
 T(local opt: hmmtasks init               ) = 1.259e-03 S  per = 6.12  per(accum) = 43.2
 T(local opt: initial guess for dvdson    ) = 1.177e-04 S  per = 0.572  per(accum) = 43.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.040e-02 S  per = 50.6  per(accum) = 94.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.528e-04 S  per = 0.743  per(accum) = 95.1
 T(local opt: dvdson [nccl]               ) = 6.686e-04 S  per = 3.25  per(accum) = 98.3
 T(local opt: dvdson [mpi]                ) = 2.499e-06 S  per = 0.0121  per(accum) = 98.3
 T(local opt: dvdson [rest part(linalg)]  ) = 3.413e-04 S  per = 1.66  per(accum) = 100
Detailed decomposition of T(renrm) = 5.717e-03 S  T(sum) = 5.717e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.919e-05 S  per = 0.86  per(accum) = 0.86
 T(local opt: qops init                    ) = 3.278e-04 S  per = 5.73  per(accum) = 6.59
 T(local opt: symbolic_formulae_renorm     ) = 2.030e-04 S  per = 3.55  per(accum) = 10.1
 T(local opt: allocate qops on gpu         ) = 5.826e-05 S  per = 1.02  per(accum) = 11.2
 T(local opt: site memcpy cpu2gpu          ) = 2.447e-05 S  per = 0.428  per(accum) = 11.6
 T(local opt: rintermediate init           ) = 6.177e-05 S  per = 1.08  per(accum) = 12.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.115e-03 S  per = 19.5  per(accum) = 32.2
 T(local opt: rmmtasks init                ) = 3.417e-04 S  per = 5.98  per(accum) = 38.2
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 0.000735  per(accum) = 38.2
 T(local opt: preprocess_renorm_batchGPU   ) = 1.008e-03 S  per = 17.6  per(accum) = 55.8
 T(local opt: deallocate cpu and gpu memory) = 2.866e-05 S  per = 0.501  per(accum) = 56.3
 T(local opt: construct opS [ifdists=true] ) = 1.440e-03 S  per = 25.2  per(accum) = 81.5
 T(local opt: reduction of opS & opH [nccl]) = 3.103e-04 S  per = 5.43  per(accum) = 86.9
 T(local opt: qops memcpy gpu2cpu          ) = 3.570e-05 S  per = 0.625  per(accum) = 87.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.366e-05 S  per = 0.239  per(accum) = 87.8
 T(local opt: qops_pool join and erase     ) = 6.952e-04 S  per = 12.2  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 2.990e-06 S  per = 0.0523  per(accum) = 100
ctns::rcanon_save_site idx=14 scratch=./scratch/sweep size=63:4.7e-07GB T(load)=0.00056S speed=0.00084GB/S
##### sweep opt: 1.524e+00 S #####
 T(sweep opt: fetch) = 7.877e-02 S  per = 5.17  per(accum) = 5.17
 T(sweep opt: hdiag) = 8.050e-02 S  per = 5.28  per(accum) = 10.4
 T(sweep opt: dvdsn) = 9.857e-01 S  per = 64.7  per(accum) = 75.1
 T(sweep opt: decim) = 3.535e-02 S  per = 2.32  per(accum) = 77.4
 T(sweep opt: guess) = 2.779e-03 S  per = 0.182  per(accum) = 77.6
 T(sweep opt: renrm) = 2.833e-01 S  per = 18.6  per(accum) = 96.2
 T(sweep opt: save ) = 5.795e-02 S  per =  3.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.857e-01 S  T(sum) = 9.716e-01 S  per = 9.857e+01
 T(sweep opt: preprocess                  ) = 1.051e-02 S  per = 1.08  per(accum) = 1.08
 T(sweep opt: symbolic_formulae           ) = 1.547e-02 S  per = 1.59  per(accum) = 2.67
 T(sweep opt: hintermediate init          ) = 2.396e-03 S  per = 0.247  per(accum) = 2.92
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.844e-01 S  per = 49.9  per(accum) = 52.8
 T(sweep opt: hmmtasks init               ) = 9.479e-02 S  per = 9.76  per(accum) = 62.5
 T(sweep opt: initial guess for dvdson    ) = 4.497e-03 S  per = 0.463  per(accum) = 63
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.341e-01 S  per = 34.4  per(accum) = 97.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.281e-03 S  per = 0.441  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 1.046e-02 S  per = 1.08  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 9.344e-05 S  per = 0.00962  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.053e-02 S  per = 1.08  per(accum) = 100
Detailed decomposition of T(renrm) = 2.833e-01 S  T(sum) = 2.833e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.657e-03 S  per = 0.585  per(accum) = 0.585
 T(sweep opt: qops init                    ) = 1.092e-02 S  per = 3.86  per(accum) = 4.44
 T(sweep opt: symbolic_formulae_renorm     ) = 5.368e-03 S  per = 1.89  per(accum) = 6.33
 T(sweep opt: allocate qops on gpu         ) = 1.780e-03 S  per = 0.628  per(accum) = 6.96
 T(sweep opt: site memcpy cpu2gpu          ) = 7.895e-04 S  per = 0.279  per(accum) = 7.24
 T(sweep opt: rintermediate init           ) = 1.554e-03 S  per = 0.548  per(accum) = 7.79
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.921e-02 S  per = 13.8  per(accum) = 21.6
 T(sweep opt: rmmtasks init                ) = 1.203e-02 S  per = 4.25  per(accum) = 25.9
 T(sweep opt: qops memset on cpu           ) = 1.409e-06 S  per = 0.000497  per(accum) = 25.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.615e-02 S  per = 9.23  per(accum) = 35.1
 T(sweep opt: deallocate cpu and gpu memory) = 9.476e-04 S  per = 0.334  per(accum) = 35.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.513e-01 S  per = 53.4  per(accum) = 88.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.255e-03 S  per = 0.443  per(accum) = 89.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.101e-03 S  per = 0.389  per(accum) = 89.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.685e-04 S  per = 0.165  per(accum) = 89.8
 T(sweep opt: qops_pool join and erase     ) = 2.339e-02 S  per = 8.26  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 5.403e-03 S  per = 1.91  per(accum) = 100
##### global opt: 1.524e+00 S #####
 T(global opt: fetch) = 7.877e-02 S  per = 5.17  per(accum) = 5.17
 T(global opt: hdiag) = 8.050e-02 S  per = 5.28  per(accum) = 10.4
 T(global opt: dvdsn) = 9.857e-01 S  per = 64.7  per(accum) = 75.1
 T(global opt: decim) = 3.535e-02 S  per = 2.32  per(accum) = 77.4
 T(global opt: guess) = 2.779e-03 S  per = 0.182  per(accum) = 77.6
 T(global opt: renrm) = 2.833e-01 S  per = 18.6  per(accum) = 96.2
 T(global opt: save ) = 5.795e-02 S  per =  3.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.857e-01 S  T(sum) = 9.716e-01 S  per = 9.857e+01
 T(global opt: preprocess                  ) = 1.051e-02 S  per = 1.08  per(accum) = 1.08
 T(global opt: symbolic_formulae           ) = 1.547e-02 S  per = 1.59  per(accum) = 2.67
 T(global opt: hintermediate init          ) = 2.396e-03 S  per = 0.247  per(accum) = 2.92
 T(global opt: preprocess_hformulae_Hxlist ) = 4.844e-01 S  per = 49.9  per(accum) = 52.8
 T(global opt: hmmtasks init               ) = 9.479e-02 S  per = 9.76  per(accum) = 62.5
 T(global opt: initial guess for dvdson    ) = 4.497e-03 S  per = 0.463  per(accum) = 63
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.341e-01 S  per = 34.4  per(accum) = 97.4
 T(global opt: dvdson [cpu-gpu]            ) = 4.281e-03 S  per = 0.441  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 1.046e-02 S  per = 1.08  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 9.344e-05 S  per = 0.00962  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.053e-02 S  per = 1.08  per(accum) = 100
Detailed decomposition of T(renrm) = 2.833e-01 S  T(sum) = 2.833e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.657e-03 S  per = 0.585  per(accum) = 0.585
 T(global opt: qops init                    ) = 1.092e-02 S  per = 3.86  per(accum) = 4.44
 T(global opt: symbolic_formulae_renorm     ) = 5.368e-03 S  per = 1.89  per(accum) = 6.33
 T(global opt: allocate qops on gpu         ) = 1.780e-03 S  per = 0.628  per(accum) = 6.96
 T(global opt: site memcpy cpu2gpu          ) = 7.895e-04 S  per = 0.279  per(accum) = 7.24
 T(global opt: rintermediate init           ) = 1.554e-03 S  per = 0.548  per(accum) = 7.79
 T(global opt: preprocess_formulae_Rlist2   ) = 3.921e-02 S  per = 13.8  per(accum) = 21.6
 T(global opt: rmmtasks init                ) = 1.203e-02 S  per = 4.25  per(accum) = 25.9
 T(global opt: qops memset on cpu           ) = 1.409e-06 S  per = 0.000497  per(accum) = 25.9
 T(global opt: preprocess_renorm_batchGPU   ) = 2.615e-02 S  per = 9.23  per(accum) = 35.1
 T(global opt: deallocate cpu and gpu memory) = 9.476e-04 S  per = 0.334  per(accum) = 35.4
 T(global opt: construct opS [ifdists=true] ) = 1.513e-01 S  per = 53.4  per(accum) = 88.8
 T(global opt: reduction of opS & opH [nccl]) = 1.255e-03 S  per = 0.443  per(accum) = 89.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.101e-03 S  per = 0.389  per(accum) = 89.7
 T(global opt: reduction of opS & opH [mpi] ) = 4.685e-04 S  per = 0.165  per(accum) = 89.8
 T(global opt: qops_pool join and erase     ) = 2.339e-02 S  per = 8.26  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 5.403e-03 S  per = 1.91  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.125e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=31/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=16 scratch=./scratch/sweep size=19:1.42e-07GB T(load)=2.92e-04S speed=4.85e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=65:4.96e-04MB:4.84e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=49:3.74e-04MB:3.65e-07GB
total mem of comb=115:8.77e-04MB:8.57e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=2.667e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:3 S:9 H:1 A:4 B:7 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=94:7.172e-04MB:7.004e-07GB
        per(mem): C:12.8 S:38.3 H:6.38 A:1.06 B:41.5 
 rqops: oplist=CSHPQ nops=C:15 S:2 H:1 P:12 Q:16 
        dim(bra,ket)=10,10 size(op)=36:0.000275MB size(tot)=970:0.0074MB:7.23e-06GB
        per(mem): C:35.6 S:4.74 H:2.47 P:7.73 Q:49.5 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3060:0.0233MB:2.28e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.238e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-2.980e-07 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(4,10,3,3) nnz=66:5.035e-04MB
qtensor4: wf4 own=1 _data=0x5585ee814240
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
 qbond: qcol nsym=5 dimAll=10
 (22,2):3 (23,3):3 (23,1):2 (21,1):1 (24,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=220 size=66:5.035e-04MB
### DIAG TIMING: total=1.051e-03 t1=1.803e-05, t2=1.833e-05, t3=1.684e-05, t4=9.481e-04, t5=7.126e-06, t6=3.668e-05, t7=6.400e-06
duration_diagGPU:1.066e-03
duration_diagreduce:3.700e-08
duration_diagtransform:2.370e-07
----- TIMING FOR symbolic_formulae_twodot with size=143 : 2.554e-04 S -----
rank=0 GPUmem(GB): used=2.280e-05 (oper)=2.280e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=143
 no. of hintermediate operators=62
 no. of coefficients=814:6.210e-03MB:6.065e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.748e-05 S -----
rank=0 GPUmem(GB): used=2.886e-05 (oper,hinter)=2.280e-05,6.065e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.340e-03 S size(H_formulae)=143 size(Hxlst2)=24 T(Hmu/Hxlist)=6.367e-05,6.277e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.676e-03 S size(H_formulae)=143 size(Hxlst)=3758 -----
rank=0 GPUmem(GB): used=2.886e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=9.835e-07 batch[need]=6.160e-04 blksize=6 blksize0=9 batchsize=3758
rank=0 GPUmem(GB): used=6.458e-04 (oper,hinter,dvdson,batch)=2.280e-05,6.065e-06,9.835e-07,6.160e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=66 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.000e-05,1.061e-04,4.998e-04,5.786e-04,1.262e-03
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.214e-05 speed=4.442e-02GB/S T(nccl)=4.786e-05 speed=2.055e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=5.0e-04 t_reduction=5.8e-04 tot=1.2e-03 -----
 sigma[inter] counter=194 t=1.1e-04 per=9.0e+00 cost=1.6e+05 flops=1.5e+09
 sigma[gemm] counter=194 i=0 t=1.8e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=1 t=1.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=2 t=1.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=3 t=1.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=4 t=1.5e-04 per=1.3e+01 cost=1.9e+04 flops=1.2e+08
 sigma[gemm] counter=194 i=5 t=1.4e-04 per=1.2e+01 cost=1.9e+04 flops=1.3e+08
 sigma[gemm] counter=194 i=6 t=1.0e-04 per=8.4e+00 cost=1.3e+04 flops=1.3e+08
 sigma[gemm] counter=194 i=7 t=9.9e-05 per=8.4e+00 cost=1.2e+04 flops=1.3e+08
 sigma[gemm] counter=194 total t=5.0e-04 per=4.2e+01 cost=6.3e+04 flops=1.3e+08
 sigma[red] counter=194 t=5.8e-04 per=4.9e+01 cost=2.3e+04 flops=3.9e+07
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=194 t=2.7e-02 per=9.3e+00 cost=7.9e+07 flops=2.9e+09
 sigma_tot[gemm] counter=194 i=0 t=4.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=1 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=2 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=3 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=4 t=3.3e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=194 i=5 t=3.7e-02 per=1.3e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=194 i=6 t=3.4e-02 per=1.2e+01 cost=1.5e+07 flops=4.6e+08
 sigma_tot[gemm] counter=194 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=194 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.7e+08
 sigma_tot[red] counter=194 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=7.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,2.6e-06,9.9e-07,9.3e-07,2.0e-07
settings: ndim=66 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336851548809 -1.116e+03  2.723e-03    1     1  1.484e-03 1.484e-03 1.462e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.434e-05,1.019e-04,5.774e-04,6.194e-04,1.367e-03
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.157e-05 speed=4.559e-02GB/S T(nccl)=4.276e-05 speed=2.300e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=5.8e-04 t_reduction=6.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=195 t=1.0e-04 per=7.8e+00 cost=1.6e+05 flops=1.6e+09
 sigma[gemm] counter=195 i=0 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=2 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=3 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=4 t=1.6e-04 per=1.2e+01 cost=1.9e+04 flops=1.2e+08
 sigma[gemm] counter=195 i=5 t=1.7e-04 per=1.3e+01 cost=1.9e+04 flops=1.1e+08
 sigma[gemm] counter=195 i=6 t=1.2e-04 per=9.2e+00 cost=1.3e+04 flops=1.1e+08
 sigma[gemm] counter=195 i=7 t=1.2e-04 per=9.3e+00 cost=1.2e+04 flops=1.0e+08
 sigma[gemm] counter=195 total t=5.8e-04 per=4.4e+01 cost=6.3e+04 flops=1.1e+08
 sigma[red] counter=195 t=6.2e-04 per=4.8e+01 cost=2.3e+04 flops=3.7e+07
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=2.9e-01 -----
 sigma_tot[inter] counter=195 t=2.7e-02 per=9.3e+00 cost=7.9e+07 flops=2.9e+09
 sigma_tot[gemm] counter=195 i=0 t=4.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=1 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=2 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=3 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=195 i=5 t=3.7e-02 per=1.3e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=195 i=6 t=3.4e-02 per=1.2e+01 cost=1.5e+07 flops=4.5e+08
 sigma_tot[gemm] counter=195 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=195 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=195 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,9.5e-06,2.9e-06,1.2e-06,2.6e-07
    2   0 -    -116.336863539288 -1.199e-05  5.361e-04    2     2  3.004e-03 1.502e-03 1.464e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.284e-05,9.546e-05,5.733e-04,6.179e-04,1.353e-03
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.105e-05 speed=4.671e-02GB/S T(nccl)=4.179e-05 speed=2.354e-02GB/S
----- TIMING FOR sigma : t_inter=9.5e-05 t_gemm=5.7e-04 t_reduction=6.2e-04 tot=1.3e-03 -----
 sigma[inter] counter=196 t=9.5e-05 per=7.4e+00 cost=1.6e+05 flops=1.7e+09
 sigma[gemm] counter=196 i=0 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=2 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=3 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=4 t=1.7e-04 per=1.3e+01 cost=1.9e+04 flops=1.1e+08
 sigma[gemm] counter=196 i=5 t=1.7e-04 per=1.3e+01 cost=1.9e+04 flops=1.1e+08
 sigma[gemm] counter=196 i=6 t=1.2e-04 per=9.0e+00 cost=1.3e+04 flops=1.1e+08
 sigma[gemm] counter=196 i=7 t=1.1e-04 per=8.9e+00 cost=1.2e+04 flops=1.1e+08
 sigma[gemm] counter=196 total t=5.7e-04 per=4.5e+01 cost=6.3e+04 flops=1.1e+08
 sigma[red] counter=196 t=6.2e-04 per=4.8e+01 cost=2.3e+04 flops=3.7e+07
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=196 t=2.7e-02 per=9.3e+00 cost=7.9e+07 flops=2.9e+09
 sigma_tot[gemm] counter=196 i=0 t=4.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=1 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=2 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=3 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=196 i=5 t=3.7e-02 per=1.3e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=196 i=6 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=196 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=196 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=196 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.0e-06,1.2e-06,2.2e-07
    3   0 +    -116.336863937705 -3.984e-07  8.443e-05    3     3  4.502e-03 1.501e-03 1.460e-03
TIMING FOR Davidson : 4.513e-03  T(cal/comm/rest)=4.381e-03,1.550e-06,1.305e-04
decomposed t_rest=1.305e-04
 T(sub)    =4.596e-05 per=3.522e+01
 T(precond)=1.103e-05 per=8.454e+00
 T(ortho)  =3.589e-06 per=2.750e+00
 T(xcopy)  =5.420e-07 per=4.153e-01
 T(xnrm2)  =4.810e-07 per=3.686e-01
 T(other)  =6.890e-05 per=5.279e+01
optimized energies: isweep=0 ibond=31 dots=2 e[0]=-116.336863937705 nmvp=3
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.074e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=11 dimAll=40
 (22,2):4 (23,3):6 (23,1):6 (21,1):1 (24,2):9 (25,3):4 (25,1):3 (26,2):1 (24,4):3 (24,0):2 (22,0):1
timing for divide=6.1e-06
timing for compute=1.7e-04
timing for collect=2.8e-05
----- TMING FOR decimation_genbasis(su2): 2.0e-04 S T(divide/compute[cpu/gpu/rest]/collect)=6.1e-06,4.8e-05,0.0e+00,1.2e-04,2.8e-05 -----
decimation summary: 40->10 dwt=+2.094e-06 SvN=6.273e-01
 qbond: qkept nsym=6 dimAll=10
 (23,1):3 (24,2):3 (25,3):1 (25,1):1 (26,2):1 (24,0):1
----- TIMING for decimation_row(nkr): 1.106e-03 S T(decim/select/formRot)=2.305e-04,8.254e-04,5.019e-05 -----
----- TIMING FOR twodot_decimation: 1.187e-03 S T(wf/decim)=6.448e-05,1.123e-03 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=715:5.455e-03MB:5.327e-06GB
        per(mem): C:47 S:5.87 H:3.08 P:8.39 Q:35.7 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.078e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=35 : 1.383e-04 S -----
rank=0 GPUmem(GB): used=3.349e-05 (oper)=1.999e-05
rank=0 GPUmem(GB): used=3.390e-05 (oper,site)=1.999e-05,4.098e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=35
 no. of rintermediate operators=28
 no. of coefficients=420:3.204e-03MB:3.129e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.175e-05 S -----
rank=0 GPUmem(GB): used=3.703e-05 (oper,site,rinter)=1.999e-05,4.098e-07,3.129e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.154e-03 S size(rtasks)=35 size(Rlst2)=36 T(Rmu/Rlist)=4.463e-05,1.109e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.231e-03 S size(rtasks)=35 size(Rlst)=990 -----
rank=0 GPUmem(GB): used=3.703e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.065e-04 blksize=9 blksize0=9 batchsize=990
rank=0 GPUmem(GB): used=2.436e-04 (oper,site,rinter,batch)=1.999e-05,4.098e-07,3.129e-06,2.065e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.056e-04,4.291e-04,1.731e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=4.3e-04 t_reduction=1.7e-04 tot=7.1e-04 -----
 renorm[inter] counter=347 t=1.1e-04 per=1.5e+01 cost=2.9e+04 flops=2.7e+08
 renorm[gemm] counter=347 i=0 t=2.0e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=347 i=1 t=2.2e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=347 i=2 t=1.4e-04 per=1.9e+01 cost=4.5e+03 flops=3.3e+07
 renorm[gemm] counter=347 i=3 t=1.6e-04 per=2.3e+01 cost=1.3e+04 flops=7.8e+07
 renorm[gemm] counter=347 i=4 t=1.9e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=347 i=5 t=2.0e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=347 i=6 t=1.2e-04 per=1.7e+01 cost=2.2e+04 flops=1.8e+08
 renorm[gemm] counter=347 total t=4.3e-04 per=6.1e+01 cost=3.9e+04 flops=9.1e+07
 renorm[red] counter=347 t=1.7e-04 per=2.4e+01 cost=1.0e+04 flops=5.8e+07
----- TIMING FOR renorm_tot : t_inter=3.2e-03 t_gemm=1.4e-02 t_reduction=5.2e-03 tot=2.2e-02 -----
 renorm_tot[inter] counter=347 t=3.2e-03 per=1.4e+01 cost=6.6e+05 flops=2.1e+08
 renorm_tot[gemm] counter=347 i=0 t=6.9e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=347 i=1 t=6.1e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=347 i=2 t=2.2e-03 per=9.9e+00 cost=5.4e+04 flops=2.4e+07
 renorm_tot[gemm] counter=347 i=3 t=2.6e-03 per=1.1e+01 cost=2.6e+05 flops=1.0e+08
 renorm_tot[gemm] counter=347 i=4 t=2.2e-03 per=9.7e+00 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=347 i=5 t=2.3e-03 per=1.0e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=347 i=6 t=4.6e-03 per=2.1e+01 cost=8.6e+05 flops=1.9e+08
 renorm_tot[gemm] counter=347 total t=1.4e-02 per=6.2e+01 cost=1.5e+06 flops=1.1e+08
 renorm_tot[red] counter=347 t=5.2e-03 per=2.3e+01 cost=3.7e+05 flops=7.2e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.745e-05 (oper)=2.015e-05
rank=0 GPUmem(GB): used=3.786e-05 (oper,site,rinter)=2.015e-05,4.098e-07,6.706e-07
rank=0 GPUmem(GB): used=5.016e-05 (oper,site,rinter,batch)=2.015e-05,4.098e-07,6.706e-07,1.231e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.873e-03 S T(preprocess/alloc/comp/red/dealloc)=4.460e-04,4.847e-04,1.255e-03,8.423e-05,3.959e-05 -----
----- TIMING FOR oper_renorm_opS : 1.885e-03 S rank=0 -----
qops.to_cpu: size(tot)=715:5.455e-03MB:5.327e-06GB T(to_cpu)=2.323e-05S speed=2.293e-01GB/S
check ||H-H.dagger||=9.394e-15 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.00495 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=2.910e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=1.930e-03 change=-1.210e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=1.930e-03 change=-4.604e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 2.563e-02 S #####
 T(local opt: fetch) = 2.425e-03 S  per = 9.46  per(accum) = 9.46
 T(local opt: hdiag) = 1.156e-03 S  per = 4.51  per(accum) = 14
 T(local opt: dvdsn) = 1.329e-02 S  per = 51.9  per(accum) = 65.8
 T(local opt: decim) = 1.214e-03 S  per = 4.74  per(accum) = 70.6
 T(local opt: guess) = 7.697e-05 S  per =  0.3  per(accum) = 70.9
 T(local opt: renrm) = 5.674e-03 S  per = 22.1  per(accum) = 93
 T(local opt: save ) = 1.794e-03 S  per =    7  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.329e-02 S  T(sum) = 1.307e-02 S  per = 9.834e+01
 T(local opt: preprocess                  ) = 2.235e-04 S  per = 1.71  per(accum) = 1.71
 T(local opt: symbolic_formulae           ) = 2.665e-04 S  per = 2.04  per(accum) = 3.75
 T(local opt: hintermediate init          ) = 5.760e-05 S  per = 0.441  per(accum) = 4.19
 T(local opt: preprocess_hformulae_Hxlist ) = 6.697e-03 S  per = 51.2  per(accum) = 55.4
 T(local opt: hmmtasks init               ) = 1.214e-03 S  per = 9.28  per(accum) = 64.7
 T(local opt: initial guess for dvdson    ) = 1.009e-04 S  per = 0.772  per(accum) = 65.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.184e-03 S  per =   32  per(accum) = 97.5
 T(local opt: dvdson [cpu-gpu]            ) = 6.477e-05 S  per = 0.495  per(accum) = 98
 T(local opt: dvdson [nccl]               ) = 1.324e-04 S  per = 1.01  per(accum) = 99
 T(local opt: dvdson [mpi]                ) = 1.550e-06 S  per = 0.0119  per(accum) = 99
 T(local opt: dvdson [rest part(linalg)]  ) = 1.305e-04 S  per = 0.998  per(accum) = 100
Detailed decomposition of T(renrm) = 5.674e-03 S  T(sum) = 5.674e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.965e-05 S  per = 0.875  per(accum) = 0.875
 T(local opt: qops init                    ) = 3.004e-04 S  per = 5.29  per(accum) = 6.17
 T(local opt: symbolic_formulae_renorm     ) = 1.425e-04 S  per = 2.51  per(accum) = 8.68
 T(local opt: allocate qops on gpu         ) = 5.253e-05 S  per = 0.926  per(accum) = 9.61
 T(local opt: site memcpy cpu2gpu          ) = 2.184e-05 S  per = 0.385  per(accum) = 9.99
 T(local opt: rintermediate init           ) = 2.833e-05 S  per = 0.499  per(accum) = 10.5
 T(local opt: preprocess_formulae_Rlist2   ) = 1.237e-03 S  per = 21.8  per(accum) = 32.3
 T(local opt: rmmtasks init                ) = 3.897e-04 S  per = 6.87  per(accum) = 39.2
 T(local opt: qops memset on cpu           ) = 4.100e-08 S  per = 0.000723  per(accum) = 39.2
 T(local opt: preprocess_renorm_batchGPU   ) = 7.946e-04 S  per =   14  per(accum) = 53.2
 T(local opt: deallocate cpu and gpu memory) = 3.032e-05 S  per = 0.534  per(accum) = 53.7
 T(local opt: construct opS [ifdists=true] ) = 1.891e-03 S  per = 33.3  per(accum) = 87
 T(local opt: reduction of opS & opH [nccl]) = 1.798e-05 S  per = 0.317  per(accum) = 87.3
 T(local opt: qops memcpy gpu2cpu          ) = 2.713e-05 S  per = 0.478  per(accum) = 87.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.193e-05 S  per = 0.21  per(accum) = 88
 T(local opt: qops_pool join and erase     ) = 6.754e-04 S  per = 11.9  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 3.882e-06 S  per = 0.0684  per(accum) = 100
ctns::rcanon_save_site idx=15 scratch=./scratch/sweep size=55:4.1e-07GB T(load)=0.00057S speed=0.00072GB/S
##### sweep opt: 1.550e+00 S #####
 T(sweep opt: fetch) = 8.119e-02 S  per = 5.24  per(accum) = 5.24
 T(sweep opt: hdiag) = 8.166e-02 S  per = 5.27  per(accum) = 10.5
 T(sweep opt: dvdsn) = 9.990e-01 S  per = 64.5  per(accum) = 75
 T(sweep opt: decim) = 3.656e-02 S  per = 2.36  per(accum) = 77.3
 T(sweep opt: guess) = 2.856e-03 S  per = 0.184  per(accum) = 77.5
 T(sweep opt: renrm) = 2.890e-01 S  per = 18.6  per(accum) = 96.1
 T(sweep opt: save ) = 5.975e-02 S  per = 3.85  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.990e-01 S  T(sum) = 9.846e-01 S  per = 9.856e+01
 T(sweep opt: preprocess                  ) = 1.073e-02 S  per = 1.09  per(accum) = 1.09
 T(sweep opt: symbolic_formulae           ) = 1.574e-02 S  per =  1.6  per(accum) = 2.69
 T(sweep opt: hintermediate init          ) = 2.454e-03 S  per = 0.249  per(accum) = 2.94
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.911e-01 S  per = 49.9  per(accum) = 52.8
 T(sweep opt: hmmtasks init               ) = 9.601e-02 S  per = 9.75  per(accum) = 62.6
 T(sweep opt: initial guess for dvdson    ) = 4.598e-03 S  per = 0.467  per(accum) = 63
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.383e-01 S  per = 34.4  per(accum) = 97.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.346e-03 S  per = 0.441  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 1.059e-02 S  per = 1.08  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 9.499e-05 S  per = 0.00965  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.066e-02 S  per = 1.08  per(accum) = 100
Detailed decomposition of T(renrm) = 2.890e-01 S  T(sum) = 2.890e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.707e-03 S  per = 0.591  per(accum) = 0.591
 T(sweep opt: qops init                    ) = 1.122e-02 S  per = 3.88  per(accum) = 4.47
 T(sweep opt: symbolic_formulae_renorm     ) = 5.511e-03 S  per = 1.91  per(accum) = 6.38
 T(sweep opt: allocate qops on gpu         ) = 1.832e-03 S  per = 0.634  per(accum) = 7.01
 T(sweep opt: site memcpy cpu2gpu          ) = 8.114e-04 S  per = 0.281  per(accum) = 7.3
 T(sweep opt: rintermediate init           ) = 1.582e-03 S  per = 0.547  per(accum) = 7.84
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.045e-02 S  per =   14  per(accum) = 21.8
 T(sweep opt: rmmtasks init                ) = 1.242e-02 S  per =  4.3  per(accum) = 26.1
 T(sweep opt: qops memset on cpu           ) = 1.450e-06 S  per = 0.000502  per(accum) = 26.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.694e-02 S  per = 9.32  per(accum) = 35.5
 T(sweep opt: deallocate cpu and gpu memory) = 9.779e-04 S  per = 0.338  per(accum) = 35.8
 T(sweep opt: construct opS [ifdists=true] ) = 1.532e-01 S  per =   53  per(accum) = 88.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.273e-03 S  per = 0.441  per(accum) = 89.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.128e-03 S  per = 0.39  per(accum) = 89.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.805e-04 S  per = 0.166  per(accum) = 89.8
 T(sweep opt: qops_pool join and erase     ) = 2.406e-02 S  per = 8.33  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 5.407e-03 S  per = 1.87  per(accum) = 100
##### global opt: 1.550e+00 S #####
 T(global opt: fetch) = 8.119e-02 S  per = 5.24  per(accum) = 5.24
 T(global opt: hdiag) = 8.166e-02 S  per = 5.27  per(accum) = 10.5
 T(global opt: dvdsn) = 9.990e-01 S  per = 64.5  per(accum) = 75
 T(global opt: decim) = 3.656e-02 S  per = 2.36  per(accum) = 77.3
 T(global opt: guess) = 2.856e-03 S  per = 0.184  per(accum) = 77.5
 T(global opt: renrm) = 2.890e-01 S  per = 18.6  per(accum) = 96.1
 T(global opt: save ) = 5.975e-02 S  per = 3.85  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.990e-01 S  T(sum) = 9.846e-01 S  per = 9.856e+01
 T(global opt: preprocess                  ) = 1.073e-02 S  per = 1.09  per(accum) = 1.09
 T(global opt: symbolic_formulae           ) = 1.574e-02 S  per =  1.6  per(accum) = 2.69
 T(global opt: hintermediate init          ) = 2.454e-03 S  per = 0.249  per(accum) = 2.94
 T(global opt: preprocess_hformulae_Hxlist ) = 4.911e-01 S  per = 49.9  per(accum) = 52.8
 T(global opt: hmmtasks init               ) = 9.601e-02 S  per = 9.75  per(accum) = 62.6
 T(global opt: initial guess for dvdson    ) = 4.598e-03 S  per = 0.467  per(accum) = 63
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.383e-01 S  per = 34.4  per(accum) = 97.4
 T(global opt: dvdson [cpu-gpu]            ) = 4.346e-03 S  per = 0.441  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 1.059e-02 S  per = 1.08  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 9.499e-05 S  per = 0.00965  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.066e-02 S  per = 1.08  per(accum) = 100
Detailed decomposition of T(renrm) = 2.890e-01 S  T(sum) = 2.890e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.707e-03 S  per = 0.591  per(accum) = 0.591
 T(global opt: qops init                    ) = 1.122e-02 S  per = 3.88  per(accum) = 4.47
 T(global opt: symbolic_formulae_renorm     ) = 5.511e-03 S  per = 1.91  per(accum) = 6.38
 T(global opt: allocate qops on gpu         ) = 1.832e-03 S  per = 0.634  per(accum) = 7.01
 T(global opt: site memcpy cpu2gpu          ) = 8.114e-04 S  per = 0.281  per(accum) = 7.3
 T(global opt: rintermediate init           ) = 1.582e-03 S  per = 0.547  per(accum) = 7.84
 T(global opt: preprocess_formulae_Rlist2   ) = 4.045e-02 S  per =   14  per(accum) = 21.8
 T(global opt: rmmtasks init                ) = 1.242e-02 S  per =  4.3  per(accum) = 26.1
 T(global opt: qops memset on cpu           ) = 1.450e-06 S  per = 0.000502  per(accum) = 26.1
 T(global opt: preprocess_renorm_batchGPU   ) = 2.694e-02 S  per = 9.32  per(accum) = 35.5
 T(global opt: deallocate cpu and gpu memory) = 9.779e-04 S  per = 0.338  per(accum) = 35.8
 T(global opt: construct opS [ifdists=true] ) = 1.532e-01 S  per =   53  per(accum) = 88.8
 T(global opt: reduction of opS & opH [nccl]) = 1.273e-03 S  per = 0.441  per(accum) = 89.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.128e-03 S  per = 0.39  per(accum) = 89.6
 T(global opt: reduction of opS & opH [mpi] ) = 4.805e-04 S  per = 0.166  per(accum) = 89.8
 T(global opt: qops_pool join and erase     ) = 2.406e-02 S  per = 8.33  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 5.407e-03 S  per = 1.87  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.084e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=32/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=17 scratch=./scratch/sweep size=6:4.47e-08GB T(load)=2.96e-04S speed=1.51e-04GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=25:1.91e-04MB:1.86e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=26:1.98e-04MB:1.94e-07GB
total mem of comb=52:3.97e-04MB:3.87e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.684e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:2 S:9 H:1 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=19:1.450e-04MB:1.416e-07GB
        per(mem): C:10.5 S:47.4 H:10.5 A:0 B:31.6 
 rqops: oplist=CSHPQ nops=C:16 S:2 H:1 P:8 Q:10 
        dim(bra,ket)=10,10 size(op)=29:0.000221MB size(tot)=715:0.00546MB:5.33e-06GB
        per(mem): C:47 S:5.87 H:3.08 P:8.39 Q:35.7 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2730:0.0208MB:2.03e-05GB
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=8.100e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=2.682e-07 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,10,3,3) nnz=32:2.441e-04MB
qtensor4: wf4 own=1 _data=0x5585ee77c400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=6 dimAll=10
 (23,1):3 (24,2):3 (25,3):1 (25,1):1 (26,2):1 (24,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=20 nblocks=161 size=32:2.441e-04MB
### DIAG TIMING: total=6.079e-04 t1=1.886e-05, t2=1.513e-05, t3=1.579e-05, t4=5.096e-04, t5=6.378e-06, t6=3.661e-05, t7=5.576e-06
duration_diagGPU:6.159e-04
duration_diagreduce:3.100e-08
duration_diagtransform:1.310e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 1.736e-04 S -----
rank=0 GPUmem(GB): used=2.034e-05 (oper)=2.034e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=518:3.952e-03MB:3.859e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.383e-05 S -----
rank=0 GPUmem(GB): used=2.420e-05 (oper,hinter)=2.034e-05,3.859e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.865e-03 S size(H_formulae)=107 size(Hxlst2)=20 T(Hmu/Hxlist)=4.487e-05,3.821e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.068e-03 S size(H_formulae)=107 size(Hxlst)=2340 -----
rank=0 GPUmem(GB): used=2.420e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=4.768e-07 batch[need]=2.789e-04 blksize=3 blksize0=9 batchsize=2340
rank=0 GPUmem(GB): used=3.036e-04 (oper,hinter,dvdson,batch)=2.034e-05,3.859e-06,4.768e-07,2.789e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=32 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.040e-05,8.945e-05,2.355e-04,5.411e-04,9.432e-04
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.150e-05 speed=2.218e-02GB/S T(nccl)=4.889e-05 speed=9.753e-03GB/S
----- TIMING FOR sigma : t_inter=8.9e-05 t_gemm=2.4e-04 t_reduction=5.4e-04 tot=8.7e-04 -----
 sigma[inter] counter=197 t=8.9e-05 per=1.0e+01 cost=5.7e+04 flops=6.4e+08
 sigma[gemm] counter=197 i=0 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=1 t=1.6e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=2 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=3 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=4 t=6.4e-05 per=7.4e+00 cost=5.4e+03 flops=8.3e+07
 sigma[gemm] counter=197 i=5 t=6.1e-05 per=7.1e+00 cost=5.4e+03 flops=8.8e+07
 sigma[gemm] counter=197 i=6 t=5.2e-05 per=6.0e+00 cost=2.4e+03 flops=4.6e+07
 sigma[gemm] counter=197 i=7 t=5.1e-05 per=5.9e+00 cost=2.3e+03 flops=4.5e+07
 sigma[gemm] counter=197 total t=2.4e-04 per=2.7e+01 cost=1.5e+04 flops=6.5e+07
 sigma[red] counter=197 t=5.4e-04 per=6.2e+01 cost=7.7e+03 flops=1.4e+07
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=197 t=2.7e-02 per=9.3e+00 cost=7.9e+07 flops=2.9e+09
 sigma_tot[gemm] counter=197 i=0 t=4.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=1 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=2 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=3 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=197 i=5 t=3.7e-02 per=1.3e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=197 i=6 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=197 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=197 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=197 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=7.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,2.7e-06,8.5e-07,7.6e-07,1.7e-07
settings: ndim=32 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336862474661 -1.116e+03  1.798e-03    1     1  1.186e-03 1.186e-03 1.139e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.304e-05,8.064e-05,2.562e-04,5.559e-04,9.598e-04
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.104e-05 speed=2.267e-02GB/S T(nccl)=4.200e-05 speed=1.135e-02GB/S
----- TIMING FOR sigma : t_inter=8.1e-05 t_gemm=2.6e-04 t_reduction=5.6e-04 tot=8.9e-04 -----
 sigma[inter] counter=198 t=8.1e-05 per=9.0e+00 cost=5.7e+04 flops=7.1e+08
 sigma[gemm] counter=198 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=1 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=2 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=3 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=4 t=7.0e-05 per=7.8e+00 cost=5.4e+03 flops=7.7e+07
 sigma[gemm] counter=198 i=5 t=6.6e-05 per=7.4e+00 cost=5.4e+03 flops=8.1e+07
 sigma[gemm] counter=198 i=6 t=5.6e-05 per=6.3e+00 cost=2.4e+03 flops=4.2e+07
 sigma[gemm] counter=198 i=7 t=5.6e-05 per=6.3e+00 cost=2.3e+03 flops=4.1e+07
 sigma[gemm] counter=198 total t=2.6e-04 per=2.9e+01 cost=1.5e+04 flops=6.0e+07
 sigma[red] counter=198 t=5.6e-04 per=6.2e+01 cost=7.7e+03 flops=1.4e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=198 t=2.8e-02 per=9.3e+00 cost=8.0e+07 flops=2.9e+09
 sigma_tot[gemm] counter=198 i=0 t=4.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=1 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=2 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=3 t=3.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=198 i=5 t=3.7e-02 per=1.2e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=198 i=6 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=198 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=198 total t=1.4e-01 per=4.8e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=198 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,9.3e-06,2.3e-06,1.0e-06,1.9e-07
    2   0 -    -116.336865861083 -3.386e-06  1.724e-04    2     2  2.482e-03 1.241e-03 1.173e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.130e-05,8.189e-05,2.547e-04,5.501e-04,9.514e-04
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.107e-05 speed=2.263e-02GB/S T(nccl)=4.022e-05 speed=1.185e-02GB/S
----- TIMING FOR sigma : t_inter=8.2e-05 t_gemm=2.5e-04 t_reduction=5.5e-04 tot=8.9e-04 -----
 sigma[inter] counter=199 t=8.2e-05 per=9.2e+00 cost=5.7e+04 flops=7.0e+08
 sigma[gemm] counter=199 i=0 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=2 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=3 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=4 t=6.9e-05 per=7.8e+00 cost=5.4e+03 flops=7.8e+07
 sigma[gemm] counter=199 i=5 t=6.7e-05 per=7.6e+00 cost=5.4e+03 flops=8.0e+07
 sigma[gemm] counter=199 i=6 t=5.6e-05 per=6.3e+00 cost=2.4e+03 flops=4.3e+07
 sigma[gemm] counter=199 i=7 t=5.5e-05 per=6.2e+00 cost=2.3e+03 flops=4.2e+07
 sigma[gemm] counter=199 total t=2.5e-04 per=2.9e+01 cost=1.5e+04 flops=6.0e+07
 sigma[red] counter=199 t=5.5e-04 per=6.2e+01 cost=7.7e+03 flops=1.4e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=199 t=2.8e-02 per=9.3e+00 cost=8.0e+07 flops=2.9e+09
 sigma_tot[gemm] counter=199 i=0 t=4.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=1 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=2 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=3 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=199 i=5 t=3.7e-02 per=1.2e+01 cost=1.7e+07 flops=4.6e+08
 sigma_tot[gemm] counter=199 i=6 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=199 i=7 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=199 total t=1.4e-01 per=4.7e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=199 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.2e-05,1.8e-06,1.1e-06,1.8e-07
    3   0 +    -116.336865909158 -4.807e-08  1.931e-05    3     3  3.675e-03 1.225e-03 1.164e-03
TIMING FOR Davidson : 3.688e-03  T(cal/comm/rest)=3.493e-03,2.141e-06,1.932e-04
decomposed t_rest=1.932e-04
 T(sub)    =4.282e-05 per=2.217e+01
 T(precond)=9.289e-06 per=4.809e+00
 T(ortho)  =3.185e-06 per=1.649e+00
 T(xcopy)  =4.250e-07 per=2.200e-01
 T(xnrm2)  =4.290e-07 per=2.221e-01
 T(other)  =1.370e-04 per=7.093e+01
optimized energies: isweep=0 ibond=32 dots=2 e[0]=-116.336865909158 nmvp=3
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=6.921e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=11 dimAll=39
 (23,1):3 (24,2):6 (25,3):4 (25,1):8 (26,2):6 (24,0):4 (27,3):2 (27,1):2 (28,2):1 (26,0):2 (26,4):1
timing for divide=4.7e-06
timing for compute=3.9e-05
timing for collect=9.7e-06
----- TMING FOR decimation_genbasis(su2): 5.4e-05 S T(divide/compute[cpu/gpu/rest]/collect)=4.7e-06,3.1e-05,0.0e+00,8.5e-06,9.7e-06 -----
decimation summary: 39->7 dwt=-2.220e-16 SvN=6.828e-01
 qbond: qkept nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
----- TIMING for decimation_row(nkr): 9.289e-04 S T(decim/select/formRot)=1.009e-04,8.030e-04,2.504e-05 -----
----- TIMING FOR twodot_decimation: 1.013e-03 S T(wf/decim)=6.315e-05,9.501e-04 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:17 S:1 H:1 P:4 Q:7 
        dim(bra,ket)=7,7 size(op)=11:8.392e-05MB size(tot)=298:2.274e-03MB:2.220e-06GB
        per(mem): C:62.8 S:3.69 H:3.69 P:5.03 Q:24.8 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=6.939e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=29 : 9.765e-05 S -----
rank=0 GPUmem(GB): used=2.628e-05 (oper)=1.498e-05
rank=0 GPUmem(GB): used=2.652e-05 (oper,site)=1.498e-05,2.384e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=29
 no. of rintermediate operators=18
 no. of coefficients=288:2.197e-03MB:2.146e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.751e-05 S -----
rank=0 GPUmem(GB): used=2.866e-05 (oper,site,rinter)=1.498e-05,2.384e-07,2.146e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.026e-03 S size(rtasks)=29 size(Rlst2)=25 T(Rmu/Rlist)=3.323e-05,9.925e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.136e-03 S size(rtasks)=29 size(Rlst)=912 -----
rank=0 GPUmem(GB): used=2.866e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.495e-04 blksize=6 blksize0=9 batchsize=912
rank=0 GPUmem(GB): used=1.782e-04 (oper,site,rinter,batch)=1.498e-05,2.384e-07,2.146e-06,1.495e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.791e-05,2.958e-04,1.999e-04
----- TIMING FOR renorm : t_inter=8.8e-05 t_gemm=3.0e-04 t_reduction=2.0e-04 tot=5.8e-04 -----
 renorm[inter] counter=352 t=8.8e-05 per=1.5e+01 cost=1.5e+04 flops=1.7e+08
 renorm[gemm] counter=352 i=0 t=2.1e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=352 i=1 t=1.8e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=352 i=2 t=9.3e-05 per=1.6e+01 cost=1.8e+03 flops=2.0e+07
 renorm[gemm] counter=352 i=3 t=1.0e-04 per=1.7e+01 cost=5.1e+03 flops=5.0e+07
 renorm[gemm] counter=352 i=4 t=1.9e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=352 i=5 t=1.8e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=352 i=6 t=9.3e-05 per=1.6e+01 cost=6.5e+03 flops=7.0e+07
 renorm[gemm] counter=352 total t=3.0e-04 per=5.1e+01 cost=1.3e+04 flops=4.6e+07
 renorm[red] counter=352 t=2.0e-04 per=3.4e+01 cost=4.1e+03 flops=2.1e+07
----- TIMING FOR renorm_tot : t_inter=3.3e-03 t_gemm=1.4e-02 t_reduction=5.4e-03 tot=2.3e-02 -----
 renorm_tot[inter] counter=352 t=3.3e-03 per=1.4e+01 cost=6.8e+05 flops=2.1e+08
 renorm_tot[gemm] counter=352 i=0 t=7.1e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=352 i=1 t=6.3e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=352 i=2 t=2.3e-03 per=1.0e+01 cost=5.6e+04 flops=2.4e+07
 renorm_tot[gemm] counter=352 i=3 t=2.7e-03 per=1.2e+01 cost=2.6e+05 flops=9.9e+07
 renorm_tot[gemm] counter=352 i=4 t=2.2e-03 per=9.5e+00 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=352 i=5 t=2.3e-03 per=1.0e+01 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=352 i=6 t=4.7e-03 per=2.0e+01 cost=8.7e+05 flops=1.8e+08
 renorm_tot[gemm] counter=352 total t=1.4e-02 per=6.2e+01 cost=1.5e+06 flops=1.0e+08
 renorm_tot[red] counter=352 t=5.4e-03 per=2.3e+01 cost=3.8e+05 flops=7.0e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.886e-05 (oper)=1.507e-05
rank=0 GPUmem(GB): used=2.910e-05 (oper,site,rinter)=1.507e-05,2.384e-07,3.576e-07
rank=0 GPUmem(GB): used=4.123e-05 (oper,site,rinter,batch)=1.507e-05,2.384e-07,3.576e-07,1.213e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.276e-03 S T(preprocess/alloc/comp/red/dealloc)=2.911e-04,3.419e-04,8.298e-04,6.590e-05,3.113e-05 -----
----- TIMING FOR oper_renorm_opS : 1.296e-03 S rank=0 -----
qops.to_cpu: size(tot)=298:2.274e-03MB:2.220e-06GB T(to_cpu)=2.102e-05S speed=1.056e-01GB/S
check ||H-H.dagger||=2.517e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00416 S rank=0 -----
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=2.477e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-1.161e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.338e+00 pageheap_free=0.000e+00 change=-3.770e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.959e-02 S #####
 T(local opt: fetch) = 2.219e-03 S  per = 11.3  per(accum) = 11.3
 T(local opt: hdiag) = 6.599e-04 S  per = 3.37  per(accum) = 14.7
 T(local opt: dvdsn) = 9.039e-03 S  per = 46.1  per(accum) = 60.8
 T(local opt: decim) = 1.041e-03 S  per = 5.31  per(accum) = 66.2
 T(local opt: guess) = 5.998e-05 S  per = 0.306  per(accum) = 66.5
 T(local opt: renrm) = 4.802e-03 S  per = 24.5  per(accum) = 91
 T(local opt: save ) = 1.769e-03 S  per = 9.03  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.039e-03 S  T(sum) = 8.777e-03 S  per = 9.709e+01
 T(local opt: preprocess                  ) = 1.522e-04 S  per = 1.73  per(accum) = 1.73
 T(local opt: symbolic_formulae           ) = 1.779e-04 S  per = 2.03  per(accum) = 3.76
 T(local opt: hintermediate init          ) = 3.122e-05 S  per = 0.356  per(accum) = 4.12
 T(local opt: preprocess_hformulae_Hxlist ) = 4.076e-03 S  per = 46.4  per(accum) = 50.6
 T(local opt: hmmtasks init               ) = 5.715e-04 S  per = 6.51  per(accum) = 57.1
 T(local opt: initial guess for dvdson    ) = 7.980e-05 S  per = 0.909  per(accum) = 58
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.298e-03 S  per = 37.6  per(accum) = 95.6
 T(local opt: dvdson [cpu-gpu]            ) = 6.361e-05 S  per = 0.725  per(accum) = 96.3
 T(local opt: dvdson [nccl]               ) = 1.311e-04 S  per = 1.49  per(accum) = 97.8
 T(local opt: dvdson [mpi]                ) = 2.141e-06 S  per = 0.0244  per(accum) = 97.8
 T(local opt: dvdson [rest part(linalg)]  ) = 1.932e-04 S  per =  2.2  per(accum) = 100
Detailed decomposition of T(renrm) = 4.802e-03 S  T(sum) = 4.802e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.262e-05 S  per =  1.1  per(accum) = 1.1
 T(local opt: qops init                    ) = 2.699e-04 S  per = 5.62  per(accum) = 6.72
 T(local opt: symbolic_formulae_renorm     ) = 1.088e-04 S  per = 2.27  per(accum) = 8.98
 T(local opt: allocate qops on gpu         ) = 5.237e-05 S  per = 1.09  per(accum) = 10.1
 T(local opt: site memcpy cpu2gpu          ) = 2.549e-05 S  per = 0.531  per(accum) = 10.6
 T(local opt: rintermediate init           ) = 6.157e-05 S  per = 1.28  per(accum) = 11.9
 T(local opt: preprocess_formulae_Rlist2   ) = 1.147e-03 S  per = 23.9  per(accum) = 35.8
 T(local opt: rmmtasks init                ) = 3.285e-04 S  per = 6.84  per(accum) = 42.6
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.000896  per(accum) = 42.6
 T(local opt: preprocess_renorm_batchGPU   ) = 7.615e-04 S  per = 15.9  per(accum) = 58.5
 T(local opt: deallocate cpu and gpu memory) = 2.817e-05 S  per = 0.587  per(accum) = 59.1
 T(local opt: construct opS [ifdists=true] ) = 1.310e-03 S  per = 27.3  per(accum) = 86.4
 T(local opt: reduction of opS & opH [nccl]) = 1.889e-05 S  per = 0.393  per(accum) = 86.7
 T(local opt: qops memcpy gpu2cpu          ) = 3.037e-05 S  per = 0.633  per(accum) = 87.4
 T(local opt: reduction of opS & opH [mpi] ) = 1.334e-05 S  per = 0.278  per(accum) = 87.7
 T(local opt: qops_pool join and erase     ) = 5.897e-04 S  per = 12.3  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 2.978e-06 S  per = 0.062  per(accum) = 100
ctns::rcanon_save_site idx=16 scratch=./scratch/sweep size=32:2.4e-07GB T(load)=0.00054S speed=0.00044GB/S
##### sweep opt: 1.570e+00 S #####
 T(sweep opt: fetch) = 8.341e-02 S  per = 5.31  per(accum) = 5.31
 T(sweep opt: hdiag) = 8.232e-02 S  per = 5.24  per(accum) = 10.6
 T(sweep opt: dvdsn) = 1.008e+00 S  per = 64.2  per(accum) = 74.8
 T(sweep opt: decim) = 3.760e-02 S  per =  2.4  per(accum) = 77.2
 T(sweep opt: guess) = 2.916e-03 S  per = 0.186  per(accum) = 77.4
 T(sweep opt: renrm) = 2.938e-01 S  per = 18.7  per(accum) = 96.1
 T(sweep opt: save ) = 6.152e-02 S  per = 3.92  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.008e+00 S  T(sum) = 9.934e-01 S  per = 9.855e+01
 T(sweep opt: preprocess                  ) = 1.089e-02 S  per =  1.1  per(accum) = 1.1
 T(sweep opt: symbolic_formulae           ) = 1.592e-02 S  per =  1.6  per(accum) = 2.7
 T(sweep opt: hintermediate init          ) = 2.485e-03 S  per = 0.25  per(accum) = 2.95
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.952e-01 S  per = 49.8  per(accum) = 52.8
 T(sweep opt: hmmtasks init               ) = 9.658e-02 S  per = 9.72  per(accum) = 62.5
 T(sweep opt: initial guess for dvdson    ) = 4.678e-03 S  per = 0.471  per(accum) = 63
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.416e-01 S  per = 34.4  per(accum) = 97.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.410e-03 S  per = 0.444  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 1.072e-02 S  per = 1.08  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 9.713e-05 S  per = 0.00978  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.085e-02 S  per = 1.09  per(accum) = 100
Detailed decomposition of T(renrm) = 2.938e-01 S  T(sum) = 2.938e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.759e-03 S  per = 0.599  per(accum) = 0.599
 T(sweep opt: qops init                    ) = 1.149e-02 S  per = 3.91  per(accum) = 4.51
 T(sweep opt: symbolic_formulae_renorm     ) = 5.619e-03 S  per = 1.91  per(accum) = 6.42
 T(sweep opt: allocate qops on gpu         ) = 1.884e-03 S  per = 0.641  per(accum) = 7.06
 T(sweep opt: site memcpy cpu2gpu          ) = 8.369e-04 S  per = 0.285  per(accum) = 7.35
 T(sweep opt: rintermediate init           ) = 1.643e-03 S  per = 0.559  per(accum) = 7.91
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.159e-02 S  per = 14.2  per(accum) = 22.1
 T(sweep opt: rmmtasks init                ) = 1.275e-02 S  per = 4.34  per(accum) = 26.4
 T(sweep opt: qops memset on cpu           ) = 1.493e-06 S  per = 0.000508  per(accum) = 26.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.771e-02 S  per = 9.43  per(accum) = 35.8
 T(sweep opt: deallocate cpu and gpu memory) = 1.006e-03 S  per = 0.342  per(accum) = 36.2
 T(sweep opt: construct opS [ifdists=true] ) = 1.545e-01 S  per = 52.6  per(accum) = 88.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.292e-03 S  per = 0.44  per(accum) = 89.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.159e-03 S  per = 0.394  per(accum) = 89.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.938e-04 S  per = 0.168  per(accum) = 89.8
 T(sweep opt: qops_pool join and erase     ) = 2.465e-02 S  per = 8.39  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 5.410e-03 S  per = 1.84  per(accum) = 100
##### global opt: 1.570e+00 S #####
 T(global opt: fetch) = 8.341e-02 S  per = 5.31  per(accum) = 5.31
 T(global opt: hdiag) = 8.232e-02 S  per = 5.24  per(accum) = 10.6
 T(global opt: dvdsn) = 1.008e+00 S  per = 64.2  per(accum) = 74.8
 T(global opt: decim) = 3.760e-02 S  per =  2.4  per(accum) = 77.2
 T(global opt: guess) = 2.916e-03 S  per = 0.186  per(accum) = 77.4
 T(global opt: renrm) = 2.938e-01 S  per = 18.7  per(accum) = 96.1
 T(global opt: save ) = 6.152e-02 S  per = 3.92  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.008e+00 S  T(sum) = 9.934e-01 S  per = 9.855e+01
 T(global opt: preprocess                  ) = 1.089e-02 S  per =  1.1  per(accum) = 1.1
 T(global opt: symbolic_formulae           ) = 1.592e-02 S  per =  1.6  per(accum) = 2.7
 T(global opt: hintermediate init          ) = 2.485e-03 S  per = 0.25  per(accum) = 2.95
 T(global opt: preprocess_hformulae_Hxlist ) = 4.952e-01 S  per = 49.8  per(accum) = 52.8
 T(global opt: hmmtasks init               ) = 9.658e-02 S  per = 9.72  per(accum) = 62.5
 T(global opt: initial guess for dvdson    ) = 4.678e-03 S  per = 0.471  per(accum) = 63
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.416e-01 S  per = 34.4  per(accum) = 97.4
 T(global opt: dvdson [cpu-gpu]            ) = 4.410e-03 S  per = 0.444  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 1.072e-02 S  per = 1.08  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 9.713e-05 S  per = 0.00978  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.085e-02 S  per = 1.09  per(accum) = 100
Detailed decomposition of T(renrm) = 2.938e-01 S  T(sum) = 2.938e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.759e-03 S  per = 0.599  per(accum) = 0.599
 T(global opt: qops init                    ) = 1.149e-02 S  per = 3.91  per(accum) = 4.51
 T(global opt: symbolic_formulae_renorm     ) = 5.619e-03 S  per = 1.91  per(accum) = 6.42
 T(global opt: allocate qops on gpu         ) = 1.884e-03 S  per = 0.641  per(accum) = 7.06
 T(global opt: site memcpy cpu2gpu          ) = 8.369e-04 S  per = 0.285  per(accum) = 7.35
 T(global opt: rintermediate init           ) = 1.643e-03 S  per = 0.559  per(accum) = 7.91
 T(global opt: preprocess_formulae_Rlist2   ) = 4.159e-02 S  per = 14.2  per(accum) = 22.1
 T(global opt: rmmtasks init                ) = 1.275e-02 S  per = 4.34  per(accum) = 26.4
 T(global opt: qops memset on cpu           ) = 1.493e-06 S  per = 0.000508  per(accum) = 26.4
 T(global opt: preprocess_renorm_batchGPU   ) = 2.771e-02 S  per = 9.43  per(accum) = 35.8
 T(global opt: deallocate cpu and gpu memory) = 1.006e-03 S  per = 0.342  per(accum) = 36.2
 T(global opt: construct opS [ifdists=true] ) = 1.545e-01 S  per = 52.6  per(accum) = 88.8
 T(global opt: reduction of opS & opH [nccl]) = 1.292e-03 S  per = 0.44  per(accum) = 89.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.159e-03 S  per = 0.394  per(accum) = 89.6
 T(global opt: reduction of opS & opH [mpi] ) = 4.938e-04 S  per = 0.168  per(accum) = 89.8
 T(global opt: qops_pool join and erase     ) = 2.465e-02 S  per = 8.39  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 5.410e-03 S  per = 1.84  per(accum) = 100
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-7.004e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=33/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=18 scratch=./scratch/sweep size=3:2.24e-08GB T(load)=3.01e-04S speed=7.42e-05GB/S
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.00e+00MB:0.00e+00GB
 sites: len=20 mem=9:6.87e-05MB:6.71e-08GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=11:8.39e-05MB:8.20e-08GB
total mem of comb=21:1.60e-04MB:1.56e-07GB
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=1.609e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:17 S:1 H:1 P:4 Q:7 
        dim(bra,ket)=7,7 size(op)=11:8.39e-05MB size(tot)=298:0.00227MB:2.22e-06GB
        per(mem): C:62.8 S:3.69 H:3.69 P:5.03 Q:24.8 
 c1qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3292:0.0251MB:2.45e-05GB
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=1.589e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=-7.451e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(3,7,3,3) nnz=30:2.289e-04MB
qtensor4: wf4 own=1 _data=0x5585ee0352c0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=180 size=30:2.289e-04MB
### DIAG TIMING: total=3.872e-04 t1=2.197e-05, t2=1.897e-05, t3=1.751e-05, t4=2.750e-04, t5=7.314e-06, t6=3.767e-05, t7=8.766e-06
duration_diagGPU:4.091e-04
duration_diagreduce:6.200e-08
duration_diagtransform:2.490e-07
----- TIMING FOR symbolic_formulae_twodot with size=111 : 1.557e-04 S -----
rank=0 GPUmem(GB): used=2.453e-05 (oper)=2.453e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=111
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.385e-05 S -----
rank=0 GPUmem(GB): used=2.605e-05 (oper,hinter)=2.453e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.697e-03 S size(H_formulae)=111 size(Hxlst2)=21 T(Hmu/Hxlist)=6.569e-05,4.631e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.912e-03 S size(H_formulae)=111 size(Hxlst)=2536 -----
rank=0 GPUmem(GB): used=2.605e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=4.470e-07 batch[need]=1.701e-04 blksize=2 blksize0=4 batchsize=2536
rank=0 GPUmem(GB): used=1.965e-04 (oper,hinter,dvdson,batch)=2.453e-05,1.520e-06,4.470e-07,1.701e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.533e-05,8.392e-05,2.603e-04,5.468e-04,9.738e-04
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.385e-05 speed=1.874e-02GB/S T(nccl)=5.149e-05 speed=8.683e-03GB/S
----- TIMING FOR sigma : t_inter=8.4e-05 t_gemm=2.6e-04 t_reduction=5.5e-04 tot=8.9e-04 -----
 sigma[inter] counter=200 t=8.4e-05 per=9.4e+00 cost=1.4e+04 flops=1.6e+08
 sigma[gemm] counter=200 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=1 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=2 t=1.8e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=3 t=1.7e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=4 t=7.5e-05 per=8.5e+00 cost=4.7e+03 flops=6.2e+07
 sigma[gemm] counter=200 i=5 t=6.8e-05 per=7.7e+00 cost=4.7e+03 flops=6.8e+07
 sigma[gemm] counter=200 i=6 t=5.5e-05 per=6.2e+00 cost=2.3e+03 flops=4.1e+07
 sigma[gemm] counter=200 i=7 t=5.4e-05 per=6.0e+00 cost=2.5e+03 flops=4.7e+07
 sigma[gemm] counter=200 total t=2.6e-04 per=2.9e+01 cost=1.4e+04 flops=5.4e+07
 sigma[red] counter=200 t=5.5e-04 per=6.1e+01 cost=7.3e+03 flops=1.3e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=200 t=2.8e-02 per=9.3e+00 cost=8.0e+07 flops=2.9e+09
 sigma_tot[gemm] counter=200 i=0 t=4.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=1 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=2 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=3 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=200 i=5 t=3.7e-02 per=1.2e+01 cost=1.7e+07 flops=4.5e+08
 sigma_tot[gemm] counter=200 i=6 t=3.4e-02 per=1.2e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=200 i=7 t=3.5e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=200 total t=1.4e-01 per=4.7e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=200 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=7.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,2.7e-06,1.1e-06,8.7e-07,2.4e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336865909158 -1.116e+03  1.855e-02    1     1  1.208e-03 1.208e-03 1.183e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.449e-05,7.552e-05,2.924e-04,5.395e-04,9.765e-04
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.229e-05 speed=2.006e-02GB/S T(nccl)=4.220e-05 speed=1.059e-02GB/S
----- TIMING FOR sigma : t_inter=7.5e-05 t_gemm=2.9e-04 t_reduction=5.4e-04 tot=9.1e-04 -----
 sigma[inter] counter=201 t=7.5e-05 per=8.3e+00 cost=1.4e+04 flops=1.8e+08
 sigma[gemm] counter=201 i=0 t=2.8e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=1 t=2.1e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=2 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=3 t=2.1e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=4 t=8.2e-05 per=9.0e+00 cost=4.7e+03 flops=5.7e+07
 sigma[gemm] counter=201 i=5 t=7.9e-05 per=8.7e+00 cost=4.7e+03 flops=5.9e+07
 sigma[gemm] counter=201 i=6 t=6.2e-05 per=6.9e+00 cost=2.3e+03 flops=3.7e+07
 sigma[gemm] counter=201 i=7 t=6.0e-05 per=6.6e+00 cost=2.5e+03 flops=4.2e+07
 sigma[gemm] counter=201 total t=2.9e-04 per=3.2e+01 cost=1.4e+04 flops=4.8e+07
 sigma[red] counter=201 t=5.4e-04 per=5.9e+01 cost=7.3e+03 flops=1.4e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=201 t=2.8e-02 per=9.3e+00 cost=8.0e+07 flops=2.9e+09
 sigma_tot[gemm] counter=201 i=0 t=4.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=1 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=2 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=3 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=5.0e+08
 sigma_tot[gemm] counter=201 i=5 t=3.7e-02 per=1.2e+01 cost=1.7e+07 flops=4.5e+08
 sigma_tot[gemm] counter=201 i=6 t=3.5e-02 per=1.2e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=201 i=7 t=3.5e-02 per=1.2e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=201 total t=1.4e-01 per=4.7e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=201 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.0e-05,2.6e-06,1.1e-06,2.3e-07
    2   0 -    -116.338361861071 -1.496e-03  6.724e-03    2     2  2.481e-03 1.241e-03 1.195e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.728e-05,6.640e-05,2.907e-04,5.631e-04,9.916e-04
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.348e-05 speed=1.904e-02GB/S T(nccl)=4.380e-05 speed=1.021e-02GB/S
----- TIMING FOR sigma : t_inter=6.6e-05 t_gemm=2.9e-04 t_reduction=5.6e-04 tot=9.2e-04 -----
 sigma[inter] counter=202 t=6.6e-05 per=7.2e+00 cost=1.4e+04 flops=2.1e+08
 sigma[gemm] counter=202 i=0 t=2.1e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=1 t=2.1e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=2 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=3 t=2.1e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=4 t=7.8e-05 per=8.5e+00 cost=4.7e+03 flops=6.0e+07
 sigma[gemm] counter=202 i=5 t=7.5e-05 per=8.2e+00 cost=4.7e+03 flops=6.2e+07
 sigma[gemm] counter=202 i=6 t=6.2e-05 per=6.8e+00 cost=2.3e+03 flops=3.7e+07
 sigma[gemm] counter=202 i=7 t=6.7e-05 per=7.2e+00 cost=2.5e+03 flops=3.8e+07
 sigma[gemm] counter=202 total t=2.9e-04 per=3.2e+01 cost=1.4e+04 flops=4.9e+07
 sigma[red] counter=202 t=5.6e-04 per=6.1e+01 cost=7.3e+03 flops=1.3e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=202 t=2.8e-02 per=9.3e+00 cost=8.0e+07 flops=2.9e+09
 sigma_tot[gemm] counter=202 i=0 t=4.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=1 t=4.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=2 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=3 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=4.9e+08
 sigma_tot[gemm] counter=202 i=5 t=3.7e-02 per=1.2e+01 cost=1.7e+07 flops=4.5e+08
 sigma_tot[gemm] counter=202 i=6 t=3.5e-02 per=1.1e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=202 i=7 t=3.5e-02 per=1.1e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=202 total t=1.4e-01 per=4.7e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=202 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=3.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,1.6e-05,1.6e-06,2.9e-07
    3   0 -    -116.338434948552 -7.309e-05  7.110e-04    3     3  3.867e-03 1.289e-03 1.233e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.917e-05,8.564e-05,3.451e-04,6.064e-04,1.111e-03
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.388e-05 speed=1.872e-02GB/S T(nccl)=4.529e-05 speed=9.871e-03GB/S
----- TIMING FOR sigma : t_inter=8.6e-05 t_gemm=3.4e-04 t_reduction=6.1e-04 tot=1.0e-03 -----
 sigma[inter] counter=203 t=8.6e-05 per=8.3e+00 cost=1.4e+04 flops=1.6e+08
 sigma[gemm] counter=203 i=0 t=2.9e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=1 t=2.5e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=2 t=2.5e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=3 t=2.5e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=4 t=9.6e-05 per=9.3e+00 cost=4.7e+03 flops=4.9e+07
 sigma[gemm] counter=203 i=5 t=9.2e-05 per=8.8e+00 cost=4.7e+03 flops=5.1e+07
 sigma[gemm] counter=203 i=6 t=7.3e-05 per=7.0e+00 cost=2.3e+03 flops=3.1e+07
 sigma[gemm] counter=203 i=7 t=7.3e-05 per=7.1e+00 cost=2.5e+03 flops=3.4e+07
 sigma[gemm] counter=203 total t=3.4e-04 per=3.3e+01 cost=1.4e+04 flops=4.1e+07
 sigma[red] counter=203 t=6.1e-04 per=5.9e+01 cost=7.3e+03 flops=1.2e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=203 t=2.8e-02 per=9.2e+00 cost=8.0e+07 flops=2.8e+09
 sigma_tot[gemm] counter=203 i=0 t=4.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=1 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=2 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=3 t=4.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=4.9e+08
 sigma_tot[gemm] counter=203 i=5 t=3.8e-02 per=1.2e+01 cost=1.7e+07 flops=4.5e+08
 sigma_tot[gemm] counter=203 i=6 t=3.5e-02 per=1.1e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=203 i=7 t=3.5e-02 per=1.1e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=203 total t=1.4e-01 per=4.7e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=203 t=1.3e-01 per=4.3e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.4e-05,2.5e-06,1.4e-06,2.5e-07
    4   0 -    -116.338436814483 -1.866e-06  1.919e-04    3     4  5.334e-03 1.334e-03 1.275e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.744e-05,7.985e-05,3.366e-04,6.050e-04,1.094e-03
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.352e-05 speed=1.900e-02GB/S T(nccl)=4.392e-05 speed=1.018e-02GB/S
----- TIMING FOR sigma : t_inter=8.0e-05 t_gemm=3.4e-04 t_reduction=6.0e-04 tot=1.0e-03 -----
 sigma[inter] counter=204 t=8.0e-05 per=7.8e+00 cost=1.4e+04 flops=1.7e+08
 sigma[gemm] counter=204 i=0 t=2.8e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=1 t=2.6e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=2 t=2.5e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=3 t=2.5e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=4 t=9.3e-05 per=9.1e+00 cost=4.7e+03 flops=5.0e+07
 sigma[gemm] counter=204 i=5 t=9.0e-05 per=8.8e+00 cost=4.7e+03 flops=5.2e+07
 sigma[gemm] counter=204 i=6 t=7.2e-05 per=7.1e+00 cost=2.3e+03 flops=3.2e+07
 sigma[gemm] counter=204 i=7 t=7.0e-05 per=6.9e+00 cost=2.5e+03 flops=3.6e+07
 sigma[gemm] counter=204 total t=3.4e-04 per=3.3e+01 cost=1.4e+04 flops=4.2e+07
 sigma[red] counter=204 t=6.0e-04 per=5.9e+01 cost=7.3e+03 flops=1.2e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 -----
 sigma_tot[inter] counter=204 t=2.8e-02 per=9.2e+00 cost=8.0e+07 flops=2.8e+09
 sigma_tot[gemm] counter=204 i=0 t=4.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=1 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=2 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=3 t=4.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=4 t=3.4e-02 per=1.1e+01 cost=1.7e+07 flops=4.9e+08
 sigma_tot[gemm] counter=204 i=5 t=3.8e-02 per=1.2e+01 cost=1.7e+07 flops=4.5e+08
 sigma_tot[gemm] counter=204 i=6 t=3.5e-02 per=1.1e+01 cost=1.6e+07 flops=4.5e+08
 sigma_tot[gemm] counter=204 i=7 t=3.5e-02 per=1.1e+01 cost=1.6e+07 flops=4.6e+08
 sigma_tot[gemm] counter=204 total t=1.4e-01 per=4.7e+01 cost=6.5e+07 flops=4.6e+08
 sigma_tot[red] counter=204 t=1.3e-01 per=4.4e+01 cost=1.6e+07 flops=1.2e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.2e-05,2.3e-06,1.4e-06,1.8e-07
    5   0 +    -116.338436942700 -1.282e-07  3.305e-05    3     5  6.765e-03 1.353e-03 1.295e-03
TIMING FOR Davidson : 6.784e-03  T(cal/comm/rest)=6.474e-03,2.878e-06,3.076e-04
decomposed t_rest=3.076e-04
 T(sub)    =1.057e-04 per=3.437e+01
 T(precond)=1.411e-05 per=4.588e+00
 T(ortho)  =7.281e-06 per=2.367e+00
 T(xcopy)  =8.080e-07 per=2.627e-01
 T(xnrm2)  =9.190e-07 per=2.988e-01
 T(other)  =1.787e-04 per=5.811e+01
optimized energies: isweep=0 ibond=33 dots=2 e[0]=-116.338436942700 nmvp=5
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=7.249e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=9 dimAll=25
 (25,1):3 (26,0):5 (26,2):3 (24,0):1 (27,1):6 (28,0):3 (28,2):2 (29,1):1 (27,3):1
timing for divide=7.2e-06
timing for compute=4.8e-05
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 6.8e-05 S T(divide/compute[cpu/gpu/rest]/collect)=7.2e-06,4.1e-05,0.0e+00,6.9e-06,1.3e-05 -----
decimation summary: 25->8 dwt=-2.220e-16 SvN=6.290e-01
 qbond: qkept nsym=5 dimAll=8
 (28,0):3 (27,1):2 (26,0):1 (28,2):1 (29,1):1
----- TIMING for decimation_row(nkr): 1.059e-03 S T(decim/select/formRot)=1.227e-04,9.020e-04,3.390e-05 -----
----- TIMING FOR twodot_decimation: 1.177e-03 S T(wf/decim)=8.645e-05,1.091e-03 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:18 S:1 H:1 P:1 Q:4 
        dim(bra,ket)=8,8 size(op)=16:1.221e-04MB size(tot)=343:2.617e-03MB:2.556e-06GB
        per(mem): C:73.5 S:4.08 H:4.66 P:1.46 Q:16.3 
rank=0 CPUmem(GB): used=1.339e+00 pageheap_free=0.000e+00 change=5.190e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 1.041e-04 S -----
rank=0 GPUmem(GB): used=1.373e-05 (oper)=1.221e-05
rank=0 GPUmem(GB): used=1.395e-05 (oper,site)=1.221e-05,2.161e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=24
 no. of rintermediate operators=9
 no. of coefficients=153:1.167e-03MB:1.140e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.061e-05 S -----
rank=0 GPUmem(GB): used=1.509e-05 (oper,site,rinter)=1.221e-05,2.161e-07,1.140e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.004e-03 S size(rtasks)=24 size(Rlst2)=25 T(Rmu/Rlist)=3.762e-05,9.668e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.101e-03 S size(rtasks)=24 size(Rlst)=571 -----
rank=0 GPUmem(GB): used=1.509e-05 avail=3.829e+01 total=3.829e+01 batch[need]=9.785e-05 blksize=9 blksize0=4 batchsize=571
rank=0 GPUmem(GB): used=1.129e-04 (oper,site,rinter,batch)=1.221e-05,2.161e-07,1.140e-06,9.785e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.087e-04,5.343e-04,2.153e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=5.3e-04 t_reduction=2.2e-04 tot=8.6e-04 -----
 renorm[inter] counter=356 t=1.1e-04 per=1.3e+01 cost=4.5e+03 flops=4.2e+07
 renorm[gemm] counter=356 i=0 t=3.1e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=1 t=2.4e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=2 t=1.6e-04 per=1.8e+01 cost=1.0e+03 flops=6.4e+06
 renorm[gemm] counter=356 i=3 t=1.7e-04 per=2.0e+01 cost=2.7e+03 flops=1.6e+07
 renorm[gemm] counter=356 i=4 t=2.5e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=5 t=2.4e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=6 t=1.9e-04 per=2.3e+01 cost=5.2e+03 flops=2.7e+07
 renorm[gemm] counter=356 total t=5.3e-04 per=6.2e+01 cost=8.9e+03 flops=1.7e+07
 renorm[red] counter=356 t=2.2e-04 per=2.5e+01 cost=3.7e+03 flops=1.7e+07
----- TIMING FOR renorm_tot : t_inter=3.4e-03 t_gemm=1.5e-02 t_reduction=5.6e-03 tot=2.4e-02 -----
 renorm_tot[inter] counter=356 t=3.4e-03 per=1.4e+01 cost=6.8e+05 flops=2.0e+08
 renorm_tot[gemm] counter=356 i=0 t=7.4e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=356 i=1 t=6.5e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=356 i=2 t=2.5e-03 per=1.0e+01 cost=5.7e+04 flops=2.3e+07
 renorm_tot[gemm] counter=356 i=3 t=2.8e-03 per=1.2e+01 cost=2.6e+05 flops=9.3e+07
 renorm_tot[gemm] counter=356 i=4 t=2.2e-03 per=9.2e+00 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=356 i=5 t=2.3e-03 per=9.7e+00 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=356 i=6 t=4.9e-03 per=2.0e+01 cost=8.7e+05 flops=1.8e+08
 renorm_tot[gemm] counter=356 total t=1.5e-02 per=6.2e+01 cost=1.5e+06 flops=1.0e+08
 renorm_tot[red] counter=356 t=5.6e-03 per=2.4e+01 cost=3.8e+05 flops=6.8e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.536e-05 (oper)=1.232e-05
rank=0 GPUmem(GB): used=1.557e-05 (oper,site,rinter)=1.232e-05,2.161e-07,3.800e-07
rank=0 GPUmem(GB): used=2.279e-05 (oper,site,rinter,batch)=1.232e-05,2.161e-07,3.800e-07,7.220e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.226e-03 S T(preprocess/alloc/comp/red/dealloc)=3.049e-04,3.599e-04,7.669e-04,5.308e-05,3.948e-05 -----
----- TIMING FOR oper_renorm_opS : 1.238e-03 S rank=0 -----
qops.to_cpu: size(tot)=343:2.617e-03MB:2.556e-06GB T(to_cpu)=2.215e-05S speed=1.154e-01GB/S
check ||H-H.dagger||=2.059e-14 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00447 S rank=0 -----
rank=0 CPUmem(GB): used=1.340e+00 pageheap_free=0.000e+00 change=1.649e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=1.564e-03 change=-2.594e-03 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=1.564e-03 change=-3.159e-06 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 2.632e-02 S #####
 T(local opt: fetch) = 3.284e-03 S  per = 12.5  per(accum) = 12.5
 T(local opt: hdiag) = 5.050e-04 S  per = 1.92  per(accum) = 14.4
 T(local opt: dvdsn) = 1.328e-02 S  per = 50.4  per(accum) = 64.8
 T(local opt: decim) = 1.223e-03 S  per = 4.65  per(accum) = 69.5
 T(local opt: guess) = 9.106e-05 S  per = 0.346  per(accum) = 69.8
 T(local opt: renrm) = 6.169e-03 S  per = 23.4  per(accum) = 93.3
 T(local opt: save ) = 1.771e-03 S  per = 6.73  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.328e-02 S  T(sum) = 1.293e-02 S  per = 9.736e+01
 T(local opt: preprocess                  ) = 2.089e-04 S  per = 1.62  per(accum) = 1.62
 T(local opt: symbolic_formulae           ) = 1.663e-04 S  per = 1.29  per(accum) = 2.9
 T(local opt: hintermediate init          ) = 5.491e-05 S  per = 0.425  per(accum) = 3.33
 T(local opt: preprocess_hformulae_Hxlist ) = 4.929e-03 S  per = 38.1  per(accum) = 41.4
 T(local opt: hmmtasks init               ) = 6.979e-04 S  per =  5.4  per(accum) = 46.8
 T(local opt: initial guess for dvdson    ) = 8.805e-05 S  per = 0.681  per(accum) = 47.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 6.130e-03 S  per = 47.4  per(accum) = 94.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.170e-04 S  per = 0.905  per(accum) = 95.8
 T(local opt: dvdson [nccl]               ) = 2.267e-04 S  per = 1.75  per(accum) = 97.6
 T(local opt: dvdson [mpi]                ) = 2.878e-06 S  per = 0.0223  per(accum) = 97.6
 T(local opt: dvdson [rest part(linalg)]  ) = 3.076e-04 S  per = 2.38  per(accum) = 100
Detailed decomposition of T(renrm) = 6.169e-03 S  T(sum) = 6.169e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.030e-05 S  per =  1.3  per(accum) = 1.3
 T(local opt: qops init                    ) = 3.769e-04 S  per = 6.11  per(accum) = 7.41
 T(local opt: symbolic_formulae_renorm     ) = 1.175e-04 S  per =  1.9  per(accum) = 9.32
 T(local opt: allocate qops on gpu         ) = 6.745e-05 S  per = 1.09  per(accum) = 10.4
 T(local opt: site memcpy cpu2gpu          ) = 3.604e-05 S  per = 0.584  per(accum) = 11
 T(local opt: rintermediate init           ) = 5.081e-05 S  per = 0.824  per(accum) = 11.8
 T(local opt: preprocess_formulae_Rlist2   ) = 1.108e-03 S  per =   18  per(accum) = 29.8
 T(local opt: rmmtasks init                ) = 3.788e-04 S  per = 6.14  per(accum) = 35.9
 T(local opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000973  per(accum) = 35.9
 T(local opt: preprocess_renorm_batchGPU   ) = 9.906e-04 S  per = 16.1  per(accum) = 52
 T(local opt: deallocate cpu and gpu memory) = 3.656e-05 S  per = 0.593  per(accum) = 52.6
 T(local opt: construct opS [ifdists=true] ) = 1.246e-03 S  per = 20.2  per(accum) = 72.8
 T(local opt: reduction of opS & opH [nccl]) = 1.932e-05 S  per = 0.313  per(accum) = 73.1
 T(local opt: qops memcpy gpu2cpu          ) = 2.768e-05 S  per = 0.449  per(accum) = 73.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.232e-05 S  per =  0.2  per(accum) = 73.7
 T(local opt: qops_pool join and erase     ) = 1.617e-03 S  per = 26.2  per(accum) = 99.9
 T(local opt: conversion from opAB to opPQ ) = 3.811e-06 S  per = 0.0618  per(accum) = 100
ctns::rcanon_save_site idx=17 scratch=./scratch/sweep size=29:2.2e-07GB T(load)=0.00061S speed=0.00035GB/S
##### sweep opt: 1.596e+00 S #####
 T(sweep opt: fetch) = 8.670e-02 S  per = 5.43  per(accum) = 5.43
 T(sweep opt: hdiag) = 8.282e-02 S  per = 5.19  per(accum) = 10.6
 T(sweep opt: dvdsn) = 1.021e+00 S  per =   64  per(accum) = 74.6
 T(sweep opt: decim) = 3.883e-02 S  per = 2.43  per(accum) = 77.1
 T(sweep opt: guess) = 3.007e-03 S  per = 0.188  per(accum) = 77.2
 T(sweep opt: renrm) = 3.000e-01 S  per = 18.8  per(accum) = 96
 T(sweep opt: save ) = 6.329e-02 S  per = 3.97  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.021e+00 S  T(sum) = 1.006e+00 S  per = 9.853e+01
 T(sweep opt: preprocess                  ) = 1.110e-02 S  per =  1.1  per(accum) = 1.1
 T(sweep opt: symbolic_formulae           ) = 1.608e-02 S  per =  1.6  per(accum) = 2.7
 T(sweep opt: hintermediate init          ) = 2.540e-03 S  per = 0.252  per(accum) = 2.95
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.001e-01 S  per = 49.7  per(accum) = 52.6
 T(sweep opt: hmmtasks init               ) = 9.728e-02 S  per = 9.67  per(accum) = 62.3
 T(sweep opt: initial guess for dvdson    ) = 4.766e-03 S  per = 0.474  per(accum) = 62.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.477e-01 S  per = 34.6  per(accum) = 97.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.527e-03 S  per = 0.45  per(accum) = 97.8
 T(sweep opt: dvdson [nccl]               ) = 1.095e-02 S  per = 1.09  per(accum) = 98.9
 T(sweep opt: dvdson [mpi]                ) = 1.000e-04 S  per = 0.00994  per(accum) = 98.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.116e-02 S  per = 1.11  per(accum) = 100
Detailed decomposition of T(renrm) = 3.000e-01 S  T(sum) = 3.000e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.840e-03 S  per = 0.613  per(accum) = 0.613
 T(sweep opt: qops init                    ) = 1.187e-02 S  per = 3.96  per(accum) = 4.57
 T(sweep opt: symbolic_formulae_renorm     ) = 5.737e-03 S  per = 1.91  per(accum) = 6.48
 T(sweep opt: allocate qops on gpu         ) = 1.952e-03 S  per = 0.651  per(accum) = 7.13
 T(sweep opt: site memcpy cpu2gpu          ) = 8.729e-04 S  per = 0.291  per(accum) = 7.42
 T(sweep opt: rintermediate init           ) = 1.694e-03 S  per = 0.565  per(accum) = 7.99
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.270e-02 S  per = 14.2  per(accum) = 22.2
 T(sweep opt: rmmtasks init                ) = 1.313e-02 S  per = 4.38  per(accum) = 26.6
 T(sweep opt: qops memset on cpu           ) = 1.553e-06 S  per = 0.000518  per(accum) = 26.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.870e-02 S  per = 9.57  per(accum) = 36.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.043e-03 S  per = 0.348  per(accum) = 36.5
 T(sweep opt: construct opS [ifdists=true] ) = 1.557e-01 S  per = 51.9  per(accum) = 88.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.312e-03 S  per = 0.437  per(accum) = 88.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.186e-03 S  per = 0.396  per(accum) = 89.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.061e-04 S  per = 0.169  per(accum) = 89.4
 T(sweep opt: qops_pool join and erase     ) = 2.627e-02 S  per = 8.76  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 5.414e-03 S  per = 1.81  per(accum) = 100
##### global opt: 1.596e+00 S #####
 T(global opt: fetch) = 8.670e-02 S  per = 5.43  per(accum) = 5.43
 T(global opt: hdiag) = 8.282e-02 S  per = 5.19  per(accum) = 10.6
 T(global opt: dvdsn) = 1.021e+00 S  per =   64  per(accum) = 74.6
 T(global opt: decim) = 3.883e-02 S  per = 2.43  per(accum) = 77.1
 T(global opt: guess) = 3.007e-03 S  per = 0.188  per(accum) = 77.2
 T(global opt: renrm) = 3.000e-01 S  per = 18.8  per(accum) = 96
 T(global opt: save ) = 6.329e-02 S  per = 3.97  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.021e+00 S  T(sum) = 1.006e+00 S  per = 9.853e+01
 T(global opt: preprocess                  ) = 1.110e-02 S  per =  1.1  per(accum) = 1.1
 T(global opt: symbolic_formulae           ) = 1.608e-02 S  per =  1.6  per(accum) = 2.7
 T(global opt: hintermediate init          ) = 2.540e-03 S  per = 0.252  per(accum) = 2.95
 T(global opt: preprocess_hformulae_Hxlist ) = 5.001e-01 S  per = 49.7  per(accum) = 52.6
 T(global opt: hmmtasks init               ) = 9.728e-02 S  per = 9.67  per(accum) = 62.3
 T(global opt: initial guess for dvdson    ) = 4.766e-03 S  per = 0.474  per(accum) = 62.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.477e-01 S  per = 34.6  per(accum) = 97.3
 T(global opt: dvdson [cpu-gpu]            ) = 4.527e-03 S  per = 0.45  per(accum) = 97.8
 T(global opt: dvdson [nccl]               ) = 1.095e-02 S  per = 1.09  per(accum) = 98.9
 T(global opt: dvdson [mpi]                ) = 1.000e-04 S  per = 0.00994  per(accum) = 98.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.116e-02 S  per = 1.11  per(accum) = 100
Detailed decomposition of T(renrm) = 3.000e-01 S  T(sum) = 3.000e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.840e-03 S  per = 0.613  per(accum) = 0.613
 T(global opt: qops init                    ) = 1.187e-02 S  per = 3.96  per(accum) = 4.57
 T(global opt: symbolic_formulae_renorm     ) = 5.737e-03 S  per = 1.91  per(accum) = 6.48
 T(global opt: allocate qops on gpu         ) = 1.952e-03 S  per = 0.651  per(accum) = 7.13
 T(global opt: site memcpy cpu2gpu          ) = 8.729e-04 S  per = 0.291  per(accum) = 7.42
 T(global opt: rintermediate init           ) = 1.694e-03 S  per = 0.565  per(accum) = 7.99
 T(global opt: preprocess_formulae_Rlist2   ) = 4.270e-02 S  per = 14.2  per(accum) = 22.2
 T(global opt: rmmtasks init                ) = 1.313e-02 S  per = 4.38  per(accum) = 26.6
 T(global opt: qops memset on cpu           ) = 1.553e-06 S  per = 0.000518  per(accum) = 26.6
 T(global opt: preprocess_renorm_batchGPU   ) = 2.870e-02 S  per = 9.57  per(accum) = 36.2
 T(global opt: deallocate cpu and gpu memory) = 1.043e-03 S  per = 0.348  per(accum) = 36.5
 T(global opt: construct opS [ifdists=true] ) = 1.557e-01 S  per = 51.9  per(accum) = 88.4
 T(global opt: reduction of opS & opH [nccl]) = 1.312e-03 S  per = 0.437  per(accum) = 88.9
 T(global opt: qops memcpy gpu2cpu          ) = 1.186e-03 S  per = 0.396  per(accum) = 89.3
 T(global opt: reduction of opS & opH [mpi] ) = 5.061e-04 S  per = 0.169  per(accum) = 89.4
 T(global opt: qops_pool join and erase     ) = 2.627e-02 S  per = 8.76  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 5.414e-03 S  per = 1.81  per(accum) = 100
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-7.327e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

======================================================================
sweep_data::summary isweep=0 mpisize=2 maxthreads=2
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=1.000e-04 noise=0.000e+00
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=2 dwt=+1.110e-16 nmvp=3 e[0]=-116.177526452453 t=0.021
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=4 dwt=+1.110e-16 nmvp=6 e[0]=-116.200295182410 t=0.019
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=7 dwt=+0.000e+00 nmvp=7 e[0]=-116.215792300366 t=0.022
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=10 dwt=+1.070e-06 nmvp=6 e[0]=-116.216235822396 t=0.036
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=10 dwt=+1.978e-04 nmvp=7 e[0]=-116.217372098439 t=0.072
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=10 dwt=+5.145e-02 nmvp=8 e[0]=-116.234506198197 t=0.071
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=10 dwt=+2.363e-04 nmvp=7 e[0]=-116.238044195480 t=0.042
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=10 dwt=+5.960e-04 nmvp=7 e[0]=-116.248994471347 t=0.083
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=10 dwt=+4.871e-03 nmvp=6 e[0]=-116.250773542643 t=0.074
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=10 dwt=+1.232e-03 nmvp=7 e[0]=-116.266701220275 t=0.064
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=10 dwt=+7.393e-07 nmvp=7 e[0]=-116.284967260831 t=0.038
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=9 dwt=+0.000e+00 nmvp=6 e[0]=-116.291464685952 t=0.040
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=7 dwt=-2.220e-16 nmvp=6 e[0]=-116.298821391660 t=0.022
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=10 dwt=+7.605e-09 nmvp=6 e[0]=-116.301456582763 t=0.029
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=10 dwt=+6.494e-06 nmvp=7 e[0]=-116.307302820366 t=0.034
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=10 dwt=+5.064e-08 nmvp=6 e[0]=-116.311487752566 t=0.027
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=9 dwt=+1.110e-16 nmvp=6 e[0]=-116.316728679445 t=0.027
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=9 dwt=+1.110e-16 nmvp=1 e[0]=-116.316728679445 t=0.019
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=10 dwt=+2.861e-05 nmvp=5 e[0]=-116.316765976237 t=0.045
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=10 dwt=+3.341e-04 nmvp=6 e[0]=-116.317231466819 t=0.062
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=10 dwt=+6.719e-05 nmvp=6 e[0]=-116.317295830466 t=0.052
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=10 dwt=+4.290e-04 nmvp=7 e[0]=-116.323389329774 t=0.050
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=10 dwt=+7.384e-04 nmvp=7 e[0]=-116.327525813352 t=0.071
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=10 dwt=+3.719e-03 nmvp=7 e[0]=-116.329980164892 t=0.063
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=10 dwt=+3.623e-03 nmvp=7 e[0]=-116.331017307255 t=0.084
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=10 dwt=+4.776e-03 nmvp=7 e[0]=-116.332572672318 t=0.090
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=10 dwt=+1.635e-04 nmvp=6 e[0]=-116.332392700332 t=0.076
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=10 dwt=+0.000e+00 nmvp=6 e[0]=-116.335549867109 t=0.033
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=10 dwt=+8.624e-03 nmvp=7 e[0]=-116.339671899742 t=0.053
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=10 dwt=+1.424e-04 nmvp=6 e[0]=-116.336697017628 t=0.071
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=10 dwt=+5.309e-06 nmvp=7 e[0]=-116.336855132062 t=0.033
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=10 dwt=+2.094e-06 nmvp=3 e[0]=-116.336863937705 t=0.026
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=7 dwt=-2.220e-16 nmvp=3 e[0]=-116.336865909158 t=0.020
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=8 dwt=-2.220e-16 nmvp=5 e[0]=-116.338436942700 t=0.026
 eav_max=-116.177526452453 [ibond=0]  dwt_min=-2.220e-16 [ibond=12]
 eav_min=-116.339671899742 [ibond=28]  dwt_max=5.145e-02 [ibond=5]
 eav_diff=0.162145447289
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+8.624e-03 e[0]=-116.339671899742
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=2 maxthreads=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 204 | 1.684e+00 | 1.684e+00 | 3.145e-02 1.580e-01 1.377e-01 3.271e-01 19.4
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +8.624e-03 e[0]=-116.339671899742 (0.000e+00)
======================================================================
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=7.451e-09 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_sites scratch=./scratch/sweep T(load)=5.25e-03S

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0_su2
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=4 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=9 dimAll=28
 (28,0):6 (27,1):3 (26,0):1 (28,2):3 (29,1):7 (30,0):4 (30,2):2 (31,1):1 (29,3):1
timing for divide=4.28e-06
timing for compute=4.65e-05
timing for collect=5.45e-06
----- TMING FOR decimation_genbasis(su2): 5.62e-05 S T(divide/compute[cpu/gpu/rest]/collect)=4.28e-06,4.34e-05,0.00e+00,3.12e-06,5.45e-06 -----
decimation summary: 28->3 dwt=+0.000e+00 SvN=4.721e-01
 qbond: qkept nsym=3 dimAll=3
 (28,0):1 (29,1):1 (30,0):1
----- TIMING for decimation_row(nkr): 8.733e-04 S T(decim/select/formRot)=8.275e-05,7.765e-04,1.405e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=6 dimAll=10
 (28,0):1 (29,1):2 (30,0):3 (31,1):2 (32,0):1 (30,2):1
timing for divide=1.792e-06
timing for compute=1.913e-05
timing for collect=3.937e-06
----- TMING FOR decimation_genbasis(su2): 2.485e-05 S T(divide/compute[cpu/gpu/rest]/collect)=1.792e-06,1.596e-05,0.000e+00,3.167e-06,3.937e-06 -----
decimation summary: 10->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 8.555e-04 S T(decim/select/formRot)=5.046e-05,7.969e-04,8.200e-06 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0_su2 T(save)=7.65e-04S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=9 maxdiff=6.710e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=8.222e-16 deviate=0
 idx=3 node=(16,0) Drow=10 maxdiff=1.415e-15 deviate=0
 idx=4 node=(15,0) Drow=10 maxdiff=1.652e-15 deviate=0
 idx=5 node=(14,0) Drow=10 maxdiff=7.448e-16 deviate=0
 idx=6 node=(13,0) Drow=10 maxdiff=1.595e-15 deviate=0
 idx=7 node=(12,0) Drow=10 maxdiff=1.432e-15 deviate=0
 idx=8 node=(11,0) Drow=10 maxdiff=1.793e-15 deviate=0
 idx=9 node=(10,0) Drow=10 maxdiff=1.136e-15 deviate=0
 idx=10 node=(9,0) Drow=10 maxdiff=8.296e-16 deviate=0
 idx=11 node=(8,0) Drow=10 maxdiff=1.412e-15 deviate=0
 idx=12 node=(7,0) Drow=10 maxdiff=9.524e-16 deviate=0
 idx=13 node=(6,0) Drow=10 maxdiff=1.953e-15 deviate=0
 idx=14 node=(5,0) Drow=10 maxdiff=9.387e-16 deviate=0
 idx=15 node=(4,0) Drow=10 maxdiff=1.793e-15 deviate=0
 idx=16 node=(3,0) Drow=7 maxdiff=7.212e-16 deviate=0
 idx=17 node=(2,0) Drow=8 maxdiff=1.058e-15 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=1.110e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=2.220e-16 deviate=0
qtensor2: wf2 own=1 _data=0x5585ee8254a0
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x5585ee8254a0
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=4.4409e-16 deviate=0
----- TIMING FOR ctns::rcanon_check : 6.511e-04 S -----
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=848:0.00647MB:6.32e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=852:0.0065MB:6.35e-06GB
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=1.286e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:18 S:1 H:1 P:1 Q:4 
        dim(bra,ket)=8,8 size(op)=16:0.000122MB size(tot)=343:0.00262MB:2.56e-06GB
        per(mem): C:73.5 S:4.08 H:4.66 P:1.46 Q:16.3 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:19 S:0 H:1 P:0 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=45:0.000343MB:3.35e-07GB
        per(mem): C:84.4 H:6.67 Q:8.89 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=8.192e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=22 : 7.467e-05 S -----
rank=0 GPUmem(GB): used=1.033e-05 (oper)=1.033e-05
rank=0 GPUmem(GB): used=1.045e-05 (oper,site)=1.033e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=22
 no. of rintermediate operators=4
 no. of coefficients=72:5.493e-04MB:5.364e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.592e-05 S -----
rank=0 GPUmem(GB): used=1.099e-05 (oper,site,rinter)=1.033e-05,1.267e-07,5.364e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.986e-04 S size(rtasks)=22 size(Rlst2)=9 T(Rmu/Rlist)=2.932e-05,5.692e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.268e-04 S size(rtasks)=22 size(Rlst)=351 -----
rank=0 GPUmem(GB): used=1.099e-05 avail=3.829e+01 total=3.829e+01 batch[need]=3.400e-05 blksize=3 blksize0=6 batchsize=351
rank=0 GPUmem(GB): used=4.499e-05 (oper,site,rinter,batch)=1.033e-05,1.267e-07,5.364e-07,3.400e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.183e-04,3.314e-04,1.583e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=3.3e-04 t_reduction=1.6e-04 tot=6.1e-04 -----
 renorm[inter] counter=359 t=1.2e-04 per=1.9e+01 cost=2.5e+03 flops=2.1e+07
 renorm[gemm] counter=359 i=0 t=3.0e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=359 i=1 t=2.4e-06 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=359 i=2 t=1.3e-04 per=2.1e+01 cost=6.2e+02 flops=4.9e+06
 renorm[gemm] counter=359 i=3 t=1.2e-04 per=1.9e+01 cost=1.5e+03 flops=1.3e+07
 renorm[gemm] counter=359 i=4 t=2.8e-06 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=359 i=5 t=2.4e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=359 i=6 t=7.6e-05 per=1.3e+01 cost=1.3e+03 flops=1.7e+07
 renorm[gemm] counter=359 total t=3.3e-04 per=5.5e+01 cost=3.4e+03 flops=1.0e+07
 renorm[red] counter=359 t=1.6e-04 per=2.6e+01 cost=7.0e+02 flops=4.4e+06
----- TIMING FOR renorm_tot : t_inter=3.5e-03 t_gemm=1.5e-02 t_reduction=5.8e-03 tot=2.4e-02 -----
 renorm_tot[inter] counter=359 t=3.5e-03 per=1.4e+01 cost=6.9e+05 flops=1.9e+08
 renorm_tot[gemm] counter=359 i=0 t=7.7e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=359 i=1 t=6.8e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=359 i=2 t=2.6e-03 per=1.1e+01 cost=5.7e+04 flops=2.2e+07
 renorm_tot[gemm] counter=359 i=3 t=3.0e-03 per=1.2e+01 cost=2.7e+05 flops=9.0e+07
 renorm_tot[gemm] counter=359 i=4 t=2.2e-03 per=9.0e+00 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=359 i=5 t=2.3e-03 per=9.4e+00 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=359 i=6 t=5.0e-03 per=2.0e+01 cost=8.7e+05 flops=1.8e+08
 renorm_tot[gemm] counter=359 total t=1.5e-02 per=6.2e+01 cost=1.5e+06 flops=9.9e+07
 renorm_tot[red] counter=359 t=5.8e-03 per=2.4e+01 cost=3.8e+05 flops=6.6e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.088e-05 (oper)=1.034e-05
rank=0 GPUmem(GB): used=1.100e-05 (oper,site,rinter)=1.034e-05,1.267e-07,0.000e+00
rank=0 GPUmem(GB): used=1.142e-05 (oper,site,rinter,batch)=1.034e-05,1.267e-07,0.000e+00,4.172e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.438e-04 S T(preprocess/alloc/comp/red/dealloc)=7.095e-05,1.212e-04,2.601e-04,2.898e-05,2.948e-05 -----
----- TIMING FOR oper_renorm_opS : 4.566e-04 S rank=0 -----
qops.to_cpu: size(tot)=45:3.433e-04MB:3.353e-07GB T(to_cpu)=2.362e-05S speed=1.420e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00266 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=9.957e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

coord=(0,0)
 cqops: oplist=CSHABPQ nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): C:0.2 S:3.81 H:0.301 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=CSHPQ nops=C:19 S:0 H:1 P:0 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=45:0.000343MB:3.35e-07GB
        per(mem): C:84.4 H:6.67 Q:8.89 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:20 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): C:0 H:100 
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=-1.434e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=21 : 2.857e-05 S -----
rank=0 GPUmem(GB): used=7.778e-06 (oper)=7.778e-06
rank=0 GPUmem(GB): used=7.801e-06 (oper,site)=7.778e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=7.801e-06 (oper,site,rinter)=7.778e-06,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 1.139e-04 S size(rtasks)=21 size(Rlst2)=1 T(Rmu/Rlist)=1.869e-05,9.511e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.208e-04 S size(rtasks)=21 size(Rlst)=56 -----
rank=0 GPUmem(GB): used=7.801e-06 avail=3.829e+01 total=3.829e+01 batch[need]=1.252e-06 blksize=1 blksize0=0 batchsize=56
rank=0 GPUmem(GB): used=9.052e-06 (oper,site,rinter,batch)=7.778e-06,2.235e-08,0.000e+00,1.252e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.667e-06,1.742e-04,6.264e-05
----- TIMING FOR renorm : t_inter=6.6e-06 t_gemm=1.7e-04 t_reduction=6.2e-05 tot=2.4e-04 -----
 renorm[inter] counter=361 t=6.6e-06 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=0 t=2.8e-06 per=1.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=1 t=1.9e-06 per=8.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=2 t=7.0e-05 per=2.9e+01 cost=5.2e+01 flops=7.4e+05
 renorm[gemm] counter=361 i=3 t=4.8e-05 per=2.0e+01 cost=5.2e+01 flops=1.1e+06
 renorm[gemm] counter=361 i=4 t=2.0e-06 per=8.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=5 t=1.9e-06 per=7.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=6 t=4.7e-05 per=1.9e+01 cost=1.1e+02 flops=2.4e+06
 renorm[gemm] counter=361 total t=1.7e-04 per=7.2e+01 cost=2.2e+02 flops=1.2e+06
 renorm[red] counter=361 t=6.2e-05 per=2.6e+01 cost=1.1e+02 flops=1.8e+06
----- TIMING FOR renorm_tot : t_inter=3.5e-03 t_gemm=1.5e-02 t_reduction=5.8e-03 tot=2.5e-02 -----
 renorm_tot[inter] counter=361 t=3.5e-03 per=1.4e+01 cost=6.9e+05 flops=1.9e+08
 renorm_tot[gemm] counter=361 i=0 t=8.0e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=361 i=1 t=7.0e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=361 i=2 t=2.7e-03 per=1.1e+01 cost=5.7e+04 flops=2.2e+07
 renorm_tot[gemm] counter=361 i=3 t=3.0e-03 per=1.2e+01 cost=2.7e+05 flops=8.9e+07
 renorm_tot[gemm] counter=361 i=4 t=2.2e-03 per=8.9e+00 cost=5.3e+04 flops=2.4e+07
 renorm_tot[gemm] counter=361 i=5 t=2.3e-03 per=9.3e+00 cost=2.5e+05 flops=1.1e+08
 renorm_tot[gemm] counter=361 i=6 t=5.0e-03 per=2.0e+01 cost=8.7e+05 flops=1.7e+08
 renorm_tot[gemm] counter=361 total t=1.5e-02 per=6.2e+01 cost=1.5e+06 flops=9.8e+07
 renorm_tot[red] counter=361 t=5.8e-03 per=2.4e+01 cost=3.8e+05 flops=6.5e+07
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 2.5e-06 S rank=0 -----
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=1.9e-05S speed=4.0e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.000885 S rank=0 -----
rank=0 CPUmem(GB): used=1.337e+00 pageheap_free=0.000e+00 change=2.558e-05 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

matrix: Hmat_isweep0 size=(1,1)
     -1.163384369427e+02 

----- TIMING FOR sweep_opt: isweep=0 : 1.703e+00 S -----

----- TIMING FOR ctns::sweep_opt : 1.720e+00 S -----
rank=0 CPUmem(GB): used=1.336e+00 pageheap_free=0.000e+00 change=-8.580e-04 heap=1.385e+00 avail=4.806e+02 total=5.034e+02 

Congrats! SADMRG calculation finishes successfully. Wed Jan  1 12:11:30 2025

