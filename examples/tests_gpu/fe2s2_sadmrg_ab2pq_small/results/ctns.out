
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Sun Jan 12 11:10:00 2025

GIT_HASH = ab3ee787337c6f54282df185169c09ba74b96954

mpisize = 1 maxthreads = 112

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNS
tosu2
maxdets 10 #000 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  2 10 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
alg_a2p 3
alg_b2q 3
ifdist1
ifdistc
ifnccl
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNS
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
ciroots = 
maxdets = 10
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
svd_iop = 13
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
maxidx = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 0
alg_a2p = 3
alg_b2q = 3
notrunc = 0
ifoutcore = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
ifdists = 0
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 1
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0
mpisize_debug = 1
debug_gpumem = 0

io::create_scratch scratch=./scratch

gpu_init
rank=0 deviceCount=2
CUDA Runtime version: 11080
CUBLAS version: 111103
nccl init: rank=0 size=1

mem_check: ifgpu=1
rank=0 CPUmem(GB): avail=4.774e+02 total=5.033e+02
min=4.774e+02 max=4.774e+02 diff=0.000e+00
rank=0 GPUmem(GB): avail=6.424e+00 total=3.945e+01
min=6.424e+00 max=6.424e+00 diff=0.000e+00
rank=0 CPUmem(GB): used=1.001e+00 pageheap_free=6.169e-02 change=1.001e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=10 ifortho=1
 iroot=0 <CI[trunc]|CI>=6.112239740347e-01

ctns::init_rbases rdm_svd=1.500e+00 svd_iop=13 thresh_proj=1.000e-10

idx=
idx=4 node=(
idx=
idx=16 node=15(3,0)
idx=
idx=
idx=3 type=
idx=
idx=8 node=(11
idx=,0
idx=) type=01 rsupport= node=
idx=
idx=
idx=
idx=1314 node=(6,0) node= type=1517( node=5,0) type=1 rsupport= node= node=
idx=169  node=119
idx=172( 18 node=1810(17 node=,0) type=1 (,191
idx=,0
idx=0))7 type= node= type=11 rsupport=(12,0 rsupport=6)(134 type= 1 rsupport=8 9 10 node=( ((11 12 13 1421 node=16 node=  2 3 4 16 17 18  ,( rsupport=13,(05116 7 8 9 10 18,11 node= (,(, 0081419),6 7 8  ,0)0)9 type=0150   type=) type=1 rsupport=19)10 11)1 4 type= 00 rsupport=5 6 7 12,1) type= type= 81216 rsupport= rsupport=13 4 16 9  17 1 rsupport=121702 180  node=
  type=15( rsupport= 18 1 rsupport=13147193 4 16 17 18 1 0    21513,0) type=1 rsupport=19  18)
 5  rsupport=14
 type=1 rsupport=19 5 6 7 8 9 10 11 12 13 14 15  
6 7 8 9 10 11 12 13 14 15 
 15 
19 5 6 7 8 9 10 11 ctns::right_projection<Qm,Tm> thresh_proj= 123  ctns::right_projection<Qm,Tm> thresh_proj=4139   10 14 15  
19 5 6 7 8 9 10 11 12 13 14 1516 11 17 
18  ctns::right_projection<Qm,Tm> thresh_proj=10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=12 13 14 15 1.000e-10

15 
12 13 14 15 
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj= 5 6 7 8 9 10 11 12 13 14 15 ctns::right_projection<Qm,Tm> thresh_proj=14
 151.000e-10
 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10ctns::right_projection<Qm,Tm> thresh_proj=
1.000e-10ctns::right_projection<Qm,Tm> thresh_proj=
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10ctns::right_projection<Qm,Tm> thresh_proj=
1.000e-10
1.000e-10
1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

idx=5 node=(14,0) type=1 rsupport=10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
,0) type=1 rsupport=11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
7 8 9 10 11 12 13 14 15 
10 node=(9,0) type=1 rsupport=5 6 7 81 9 10  rsupport=11 12 17 18 1913  14 15 5 6 7 8
 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10 dim(space,lspace,rspace)=,7,4 dimBc=210 1-popBc= dim(space,lspace,rspace)=,10, dim(space,lspace,rspace)=91.110e-16,3 dimBc=3 1-popBc=10, SvN=92.912e-01,0.000e+0023,10 dimBc=
 dim(space,lspace,rspace)= dim(space,lspace,rspace)=10 dim(space,lspace,rspace)=,1010, dim(space,lspace,rspace)= dim(space,lspace,rspace)= SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> :  dim(space,lspace,rspace)=3 dimBc=3.475e-02 S -----
 dim(space,lspace,rspace)= dim(space,lspace,rspace)=10 1-popBc=,0.572101 dim(space,lspace,rspace)=010, dim(space,lspace,rspace)= dim(space,lspace,rspace)=28 dim(space,lspace,rspace)=
, SvN=103 1-popBc=10 dim(space,lspace,rspace)=,70.5726
,2.22e-16104 SvN= dimBc=3 1-popBc=----- TIMING FOR ctns::right_projection<Qm,Tm>, : 105,10,,3.884e-02,710,101010 dim(space,lspace,rspace)=1,106,, S ----- dimBc=3 1-popBc= dimBc= dimBc=0 dimBc=10, dimBc=10,51 1-popBc= SvN=1 1-popBc=106 1-popBc=1,0,0,----- TIMING FOR 2.370e-010.49510, 1-popBc= dimBc=4, SvN=10 dimBc=4 1-popBc=
ctns::right_projection<Qm,Tm>,
667,
00 1-popBc=0 SvN=1.11e-16----- TIMING FOR 60, SvN=10ctns::right_projection<Qm,Tm>0
 SvN= dim(space,lspace,rspace)=----- TIMING FOR  :  SvN= dimBc=----- TIMING FOR ctns::right_projection<Qm,Tm>,101 1-popBc=7 SvN=1.1483.894e-02 S -----10
100.000e+00 dimBc= dimBc=,7,09.257e-011.14 : 0.722 :  dimBc=,9
2.594e-02 dimBc=7
7
3.870e-0210 SvN= dimBc= S -----
 S ----- 1-popBc=4ctns::right_projection<Qm,Tm>06
 SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> :  1-popBc=0.454
3.854e-02 S -----
0 SvN=1.25----- TIMING FOR  1-popBc=
ctns::right_projection<Qm,Tm> : 0----- TIMING FOR ctns::right_projection<Qm,Tm> : ----- TIMING FOR ctns::right_projection<Qm,Tm> :  dimBc=2.695e-02 S -----

----- TIMING FOR ctns::right_projection<Qm,Tm> : ----- TIMING FOR ctns::right_projection<Qm,Tm> : 
3.883e-02 S -----
2.674e-02 S -----
2.220e-16 SvN=0.692
 1-popBc=----- TIMING FOR ctns::right_projection<Qm,Tm> : 73.824e-02 S -----
3.914e-02 S -----
 SvN=1.4
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.925e-022.731e-02 S -----
 : 03.865e-02 S -----
----- TIMING FOR ctns::right_projection<Qm,Tm> : 63.905e-02 S -----
 1-popBc= SvN=0 SvN=1.4
----- TIMING FOR ctns::right_projection<Qm,Tm> :  1-popBc=3.877e-02 S -----
 S -----1.11e-16 SvN=
1.141.06
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.904e-02
 S -----
----- TIMING FOR ctns::right_projection<Qm,Tm> : 
----- TIMING FOR ctns::right_projection<Qm,Tm>3.932e-02 :  S -----
3.952e-02 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=2 node=(17,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=3 node=(16,0) type=1 shape=4,3 1-popBc=0.000e+00
 idx=4 node=(15,0) type=1 shape=4,2 1-popBc=1.110e-16
 idx=5 node=(14,0) type=1 shape=6,4 1-popBc=2.220e-16
 idx=6 node=(13,0) type=1 shape=8,6 1-popBc=1.110e-16
 idx=7 node=(12,0) type=1 shape=9,7 1-popBc=0.000e+00
 idx=8 node=(11,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=9 node=(10,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=10 node=(9,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=11 node=(8,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=12 node=(7,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=13 node=(6,0) type=1 shape=10,5 1-popBc=0.000e+00
 idx=14 node=(5,0) type=1 shape=10,4 1-popBc=0.000e+00
 idx=15 node=(4,0) type=1 shape=10,3 1-popBc=1.110e-16
 idx=16 node=(3,0) type=1 shape=10,2 1-popBc=2.220e-16
 idx=17 node=(2,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=18 node=(1,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=19 node=(0,0) type=0 shape=10,1 1-popBc=0.000e+00
maximum bond dimension = 7
----- TIMING FOR ctns::init_rbases : 5.682e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=2.295e-05 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(3,4,4) maxdiff=1.570e-16 deviate=0 TIMING=1.992e-02 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(3,3,4) maxdiff=3.140e-16 deviate=0 TIMING=1.789e-02 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(3,3,4) maxdiff=5.565e-16 deviate=0 TIMING=1.672e-02 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(2,3,4) maxdiff=3.433e-16 deviate=0 TIMING=1.539e-02 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(4,2,4) maxdiff=1.129e-15 deviate=0 TIMING=2.146e-02 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(6,4,4) maxdiff=4.470e-16 deviate=0 TIMING=6.911e-03 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(7,6,4) maxdiff=5.648e-16 deviate=0 TIMING=1.263e-02 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(7,7,4) maxdiff=4.441e-16 deviate=0 TIMING=1.190e-02 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(7,7,4) maxdiff=0.000e+00 deviate=0 TIMING=1.143e-02 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(6,7,4) maxdiff=2.220e-16 deviate=0 TIMING=1.105e-02 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(6,6,4) maxdiff=4.441e-16 deviate=0 TIMING=1.062e-02 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(6,6,4) maxdiff=4.441e-16 deviate=0 TIMING=1.032e-02 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(5,6,4) maxdiff=2.220e-16 deviate=0 TIMING=1.004e-02 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(4,5,4) maxdiff=0.000e+00 deviate=0 TIMING=9.708e-03 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(3,4,4) maxdiff=6.661e-16 deviate=0 TIMING=9.413e-03 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(2,3,4) maxdiff=1.110e-16 deviate=0 TIMING=9.204e-03 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(1,2,4) maxdiff=2.220e-16 deviate=0 TIMING=9.134e-03 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=9.174e-03 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=9.165e-03 S
----- TIMING FOR ctns::init_rsites : 2.327e-01 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x41d3dfa8
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 0
----- TIMING FOR ctns::init_rwfuns : 2.132e-04 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=7
----- TIMING FOR ctns::rcanon_canonicalize : 3.611e-01 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.377e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=7.064e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=1.115e-15 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.140e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=4.711e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=1.570e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=1.110e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=1.110e-16 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=3.331e-16 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x41d3d9d8
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x41d3d9d8
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 3.035e-04 S -----
----- TIMING FOR ctns::rcanon_init : 6.688e-01 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci T(save)=0.00078S

ctns::rcanon_tosu2 twos=0 thresh_tosu2=1e-08
>>> idx=1
 qbond: ys nsym=2 dimAll=3
 (2,2):1 (3,1):2
 sigs2sum=1 diff(1-sigs2sum)=4.4e-16
>>> idx=2
 qbond: ys nsym=2 dimAll=3
 (3,3):1 (4,2):2
 sigs2sum=1 diff(1-sigs2sum)=4.4e-16
>>> idx=3
 qbond: ys nsym=2 dimAll=3
 (5,3):2 (6,2):1
 sigs2sum=1 diff(1-sigs2sum)=5.6e-16
>>> idx=4
 qbond: ys nsym=1 dimAll=2
 (7,3):2
 sigs2sum=1 diff(1-sigs2sum)=5.6e-16
>>> idx=5
 qbond: ys nsym=3 dimAll=4
 (8,2):1 (8,4):1 (9,3):2
 sigs2sum=1 diff(1-sigs2sum)=3.3e-16
>>> idx=6
 qbond: ys nsym=3 dimAll=6
 (10,2):2 (10,4):2 (11,3):2
 sigs2sum=1 diff(1-sigs2sum)=0
>>> idx=7
 qbond: ys nsym=3 dimAll=8
 (12,2):3 (12,4):3 (13,3):2
 sigs2sum=1 diff(1-sigs2sum)=1.1e-16
>>> idx=8
 qbond: ys nsym=3 dimAll=9
 (14,2):4 (14,4):4 (15,3):1
 sigs2sum=1 diff(1-sigs2sum)=4.4e-16
>>> idx=9
 qbond: ys nsym=5 dimAll=16
 (15,1):4 (15,3):6 (15,5):4 (16,2):1 (16,4):1
 sigs2sum=1 diff(1-sigs2sum)=6.7e-16
>>> idx=10
 qbond: ys nsym=7 dimAll=19
 (16,0):3 (16,2):5 (16,4):5 (16,6):3 (17,1):1 (17,3):1 (17,5):1
 sigs2sum=1 diff(1-sigs2sum)=6.7e-16
>>> idx=11
 qbond: ys nsym=7 dimAll=19
 (18,0):3 (18,2):5 (18,4):5 (18,6):3 (19,1):1 (19,3):1 (19,5):1
 sigs2sum=1 diff(1-sigs2sum)=8.9e-16
>>> idx=12
 qbond: ys nsym=7 dimAll=19
 (20,0):3 (20,2):5 (20,4):5 (20,6):3 (21,1):1 (21,3):1 (21,5):1
 sigs2sum=1 diff(1-sigs2sum)=7.8e-16
>>> idx=13
 qbond: ys nsym=7 dimAll=17
 (21,1):3 (21,3):4 (21,5):4 (21,7):3 (22,2):1 (22,4):1 (22,6):1
 sigs2sum=1 diff(1-sigs2sum)=1e-15
>>> idx=14
 qbond: ys nsym=7 dimAll=15
 (22,2):3 (22,4):3 (22,6):3 (22,8):3 (23,3):1 (23,5):1 (23,7):1
 sigs2sum=1 diff(1-sigs2sum)=1.2e-15
>>> idx=15
 qbond: ys nsym=9 dimAll=14
 (23,1):2 (23,3):2 (23,5):2 (23,7):2 (23,9):2 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 sigs2sum=1 diff(1-sigs2sum)=1.8e-15
>>> idx=16
 qbond: ys nsym=11 dimAll=11
 (24,0):1 (24,2):1 (24,4):1 (24,6):1 (24,8):1 (24,10):1 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 sigs2sum=1 diff(1-sigs2sum)=1.7e-15
>>> idx=17
 qbond: ys nsym=6 dimAll=6
 (26,0):1 (26,2):1 (26,4):1 (26,6):1 (26,8):1 (26,10):1
 sigs2sum=1 diff(1-sigs2sum)=1.8e-15
>>> idx=18
 qbond: ys nsym=6 dimAll=6
 (28,0):1 (28,2):1 (28,4):1 (28,6):1 (28,8):1 (28,10):1
 sigs2sum=1 diff(1-sigs2sum)=2.3e-15
>>> idx=19
 qbond: ys nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
 sigs2sum=1 diff(1-sigs2sum)=2.7e-15

ctns::updateRWFuns twos=0

### iroot=0 ###
> j=0 sym=(30,0,0) pop[j]=0.167 target sector!
matrix: rwfunW size=(1,1)
     -4.0825e-01 
> j=2 sym=(30,2,0) pop[j]=0.357
matrix: rwfunW size=(1,1)
     -5.9761e-01 
> j=6 sym=(30,4,0) pop[j]=0.298
matrix: rwfunW size=(1,1)
     -5.4554e-01 
> j=12 sym=(30,6,0) pop[j]=0.139
matrix: rwfunW size=(1,1)
     -3.7268e-01 
> j=20 sym=(30,8,0) pop[j]=0.0357
matrix: rwfunW size=(1,1)
     -1.8898e-01 
> j=30 sym=(30,10,0) pop[j]=0.00397
matrix: rwfunW size=(1,1)
      6.2994e-02 
total pop=1 diff(1-pop)=2.664535259e-15

comb::display_shape qkind=qNSz
 idx=0 node=(19,0) shape(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(3,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(3,3,4)
 idx=3 node=(16,0) shape(l,r,c)=(3,3,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,3,4)
 idx=5 node=(14,0) shape(l,r,c)=(4,2,4)
 idx=6 node=(13,0) shape(l,r,c)=(6,4,4)
 idx=7 node=(12,0) shape(l,r,c)=(7,6,4)
 idx=8 node=(11,0) shape(l,r,c)=(7,7,4)
 idx=9 node=(10,0) shape(l,r,c)=(7,7,4)
 idx=10 node=(9,0) shape(l,r,c)=(6,7,4)
 idx=11 node=(8,0) shape(l,r,c)=(6,6,4)
 idx=12 node=(7,0) shape(l,r,c)=(6,6,4)
 idx=13 node=(6,0) shape(l,r,c)=(5,6,4)
 idx=14 node=(5,0) shape(l,r,c)=(4,5,4)
 idx=15 node=(4,0) shape(l,r,c)=(3,4,4)
 idx=16 node=(3,0) shape(l,r,c)=(2,3,4)
 idx=17 node=(2,0) shape(l,r,c)=(1,2,4)
 idx=18 node=(1,0) shape(l,r,c)=(1,1,4)
 idx=19 node=(0,0) shape(l,r,c)=(1,1,4)
qtensor2: wf2 own=1 _data=0x41d3ac08
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629394531e-06MB

comb::display_shape qkind=qNS
 idx=0 node=(19,0) shape(l,r,c)=(3,1,3) shapeU1(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(7,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(10,7,4)
 idx=3 node=(16,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(11,10,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,3,3) shapeU1(l,r,c)=(8,11,4)
 idx=5 node=(14,0) shape(l,r,c)=(4,2,3) shapeU1(l,r,c)=(16,8,4)
 idx=6 node=(13,0) shape(l,r,c)=(6,4,3) shapeU1(l,r,c)=(24,16,4)
 idx=7 node=(12,0) shape(l,r,c)=(8,6,3) shapeU1(l,r,c)=(32,24,4)
 idx=8 node=(11,0) shape(l,r,c)=(9,8,3) shapeU1(l,r,c)=(36,32,4)
 idx=9 node=(10,0) shape(l,r,c)=(16,9,3) shapeU1(l,r,c)=(64,36,4)
 idx=10 node=(9,0) shape(l,r,c)=(19,16,3) shapeU1(l,r,c)=(76,64,4)
 idx=11 node=(8,0) shape(l,r,c)=(19,19,3) shapeU1(l,r,c)=(76,76,4)
 idx=12 node=(7,0) shape(l,r,c)=(19,19,3) shapeU1(l,r,c)=(76,76,4)
 idx=13 node=(6,0) shape(l,r,c)=(17,19,3) shapeU1(l,r,c)=(85,76,4)
 idx=14 node=(5,0) shape(l,r,c)=(15,17,3) shapeU1(l,r,c)=(90,85,4)
 idx=15 node=(4,0) shape(l,r,c)=(14,15,3) shapeU1(l,r,c)=(84,90,4)
 idx=16 node=(3,0) shape(l,r,c)=(11,14,3) shapeU1(l,r,c)=(66,84,4)
 idx=17 node=(2,0) shape(l,r,c)=(6,11,3) shapeU1(l,r,c)=(36,66,4)
 idx=18 node=(1,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
 idx=19 node=(0,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
qtensor2: wf2 own=1 _data=0x41d3ac00
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629394531e-06MB

Summary of sweep projection: nroot[nonsu2]=1 => nstate[su2]=1
----- TIMING FOR ctns::rcanon_tosu2 : 1.255e-01 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci_su2 T(save)=0.00065S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.377e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=3.354e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=2.336e-16 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.140e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=4.711e-16 deviate=0
 idx=7 node=(12,0) Drow=8 maxdiff=1.570e-16 deviate=0
 idx=8 node=(11,0) Drow=9 maxdiff=1.110e-16 deviate=0
 idx=9 node=(10,0) Drow=16 maxdiff=6.699e-16 deviate=0
 idx=10 node=(9,0) Drow=19 maxdiff=1.162e-15 deviate=0
 idx=11 node=(8,0) Drow=19 maxdiff=1.020e-15 deviate=0
 idx=12 node=(7,0) Drow=19 maxdiff=1.090e-15 deviate=0
 idx=13 node=(6,0) Drow=17 maxdiff=1.433e-15 deviate=0
 idx=14 node=(5,0) Drow=15 maxdiff=9.309e-16 deviate=0
 idx=15 node=(4,0) Drow=14 maxdiff=5.028e-16 deviate=0
 idx=16 node=(3,0) Drow=11 maxdiff=2.220e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=3.331e-16 deviate=0
 idx=18 node=(1,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=6 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x41d3e040
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x41d3e040
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 6.566e-03 S -----
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.002e+00 pageheap_free=6.044e-02 change=3.812e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:1.221e-02MB:1.192e-05GB
 size(int2e) = 305370:2.330e+00MB:2.275e-03GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 1.120e-01 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNS
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.813e-02 change=2.292e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=7.614e-03MB:7.436e-06GB
fname=./scratch/sweep/cop(19,0) size=7.44e-06GB T[save](info/data/tot)=0.000173,0.0001,0.000274 speed=0.0272GB/S disk[used]=7.7e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/rop(19,0) size=7.44e-06GB T[save](info/data/tot)=0.000147,9.61e-05,0.000243 speed=0.0306GB/S disk[used]=1.54e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(18,0) size=7.44e-06GB T[save](info/data/tot)=0.000143,9.58e-05,0.000239 speed=0.0311GB/S disk[used]=2.31e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(17,0) size=7.44e-06GB T[save](info/data/tot)=0.000147,9.32e-05,0.00024 speed=0.031GB/S disk[used]=3.08e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(16,0) size=7.44e-06GB T[save](info/data/tot)=0.000138,0.000103,0.00024 speed=0.0309GB/S disk[used]=3.85e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(15,0) size=7.44e-06GB T[save](info/data/tot)=0.000176,0.000103,0.000279 speed=0.0267GB/S disk[used]=4.62e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(14,0) size=7.44e-06GB T[save](info/data/tot)=0.00014,0.000103,0.000243 speed=0.0306GB/S disk[used]=5.39e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(13,0) size=7.44e-06GB T[save](info/data/tot)=0.000143,9.34e-05,0.000236 speed=0.0315GB/S disk[used]=6.16e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(12,0) size=7.44e-06GB T[save](info/data/tot)=0.000138,9.4e-05,0.000232 speed=0.032GB/S disk[used]=6.93e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(11,0) size=7.44e-06GB T[save](info/data/tot)=0.000142,9.49e-05,0.000237 speed=0.0313GB/S disk[used]=7.7e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(10,0) size=7.44e-06GB T[save](info/data/tot)=0.000137,9.33e-05,0.00023 speed=0.0323GB/S disk[used]=8.47e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(9,0) size=7.44e-06GB T[save](info/data/tot)=0.000143,9.48e-05,0.000238 speed=0.0313GB/S disk[used]=9.24e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(8,0) size=7.44e-06GB T[save](info/data/tot)=0.000142,9.29e-05,0.000234 speed=0.0317GB/S disk[used]=0.0001GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(7,0) size=7.44e-06GB T[save](info/data/tot)=0.000141,9.46e-05,0.000235 speed=0.0316GB/S disk[used]=0.000108GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(6,0) size=7.44e-06GB T[save](info/data/tot)=0.000141,9.34e-05,0.000234 speed=0.0318GB/S disk[used]=0.000115GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(5,0) size=7.44e-06GB T[save](info/data/tot)=0.000138,9.15e-05,0.000229 speed=0.0324GB/S disk[used]=0.000123GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(4,0) size=7.44e-06GB T[save](info/data/tot)=0.000139,9.09e-05,0.00023 speed=0.0323GB/S disk[used]=0.000131GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(3,0) size=7.44e-06GB T[save](info/data/tot)=0.000139,9.23e-05,0.000232 speed=0.0321GB/S disk[used]=0.000139GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(2,0) size=7.44e-06GB T[save](info/data/tot)=0.000144,9.16e-05,0.000235 speed=0.0316GB/S disk[used]=0.000146GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(1,0) size=7.44e-06GB T[save](info/data/tot)=0.000141,9.26e-05,0.000234 speed=0.0318GB/S disk[used]=0.000154GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(0,0) size=7.44e-06GB T[save](info/data/tot)=0.000142,9.4e-05,0.000236 speed=0.0315GB/S disk[used]=0.000162GB
----- TIMING FOR ctns::oper_init_dotCR : 2.094e-01 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.184,0.00673,0.19

idx=1 coord=(18,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.778e-02 change=1.192e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.704e-02 change=1.612e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=31 : 9.300e-04 S -----
rank=0 GPUmem(GB): used=1.543e-05 (oper)=1.543e-05
rank=0 GPUmem(GB): used=1.547e-05 (oper,site)=1.543e-05,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=31
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.547e-05 (oper,site,rinter)=1.543e-05,3.725e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.324e-03 S size(rtasks)=31 size(Rlst2)=4 T(Rmu/Rlist)=3.594e-04,1.965e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.349e-03 S size(rtasks)=31 size(Rlst)=146 -----
rank=0 GPUmem(GB): used=1.547e-05 avail=6.174e+00 total=6.174e+00 batch[need]=9.790e-06 blksize=4 blksize0=0 batchsize=146
rank=0 GPUmem(GB): used=2.526e-05 (oper,site,rinter,batch)=1.543e-05,3.725e-08,0.000e+00,9.790e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=4.440e-05,2.162e-02,1.012e-02
----- TIMING FOR renorm : t_inter=4.4e-05 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.2e-02 -----
 renorm[inter] counter=1 t=4.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.6e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.3e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=6.7e-03 per=2.1e+01 cost=2.1e+02 flops=3.2e+04
 renorm[gemm] counter=1 i=3 t=7.5e-03 per=2.3e+01 cost=2.3e+02 flops=3.1e+04
 renorm[gemm] counter=1 i=4 t=1.4e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=7.5e-03 per=2.4e+01 cost=6.6e+02 flops=8.8e+04
 renorm[gemm] counter=1 total t=2.2e-02 per=6.8e+01 cost=1.1e+03 flops=5.1e+04
 renorm[red] counter=1 t=1.0e-02 per=3.2e+01 cost=6.6e+02 flops=6.5e+04
----- TIMING FOR renorm_tot : t_inter=4.4e-05 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.2e-02 -----
 renorm_tot[inter] counter=1 t=4.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.6e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.3e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=6.7e-03 per=2.1e+01 cost=2.1e+02 flops=3.2e+04
 renorm_tot[gemm] counter=1 i=3 t=7.5e-03 per=2.3e+01 cost=2.3e+02 flops=3.1e+04
 renorm_tot[gemm] counter=1 i=4 t=1.4e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=7.5e-03 per=2.4e+01 cost=6.6e+02 flops=8.8e+04
 renorm_tot[gemm] counter=1 total t=2.2e-02 per=6.8e+01 cost=1.1e+03 flops=5.1e+04
 renorm_tot[red] counter=1 t=1.0e-02 per=3.2e+01 cost=6.6e+02 flops=6.5e+04
qops.to_cpu: size(tot)=75:5.7e-04MB:5.6e-07GB T(to_cpu)=8.3e-05S speed=6.8e-03GB/S
check ||H-H.dagger||=1.256e-15 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.0377 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=5.699e-02 change=9.149e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.724e-02 change=-1.670e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=2.980e-08 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 5.948e-02 S #####
 T(local oper_env: fetch) = 1.902e-02 S  per =   32  per(accum) = 32
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 32
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 32
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 32
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 32
 T(local oper_env: renrm) = 4.023e-02 S  per = 67.6  per(accum) = 99.6
 T(local oper_env: save ) = 2.298e-04 S  per = 0.386  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.023e-02 S  T(sum) = 4.023e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.265e-05 S  per = 0.0314  per(accum) = 0.0314
 T(local oper_env: qops init                    ) = 3.903e-04 S  per = 0.97  per(accum) = 1
 T(local oper_env: symbolic_formulae_renorm     ) = 9.392e-04 S  per = 2.33  per(accum) = 3.34
 T(local oper_env: allocate qops on gpu         ) = 8.545e-05 S  per = 0.212  per(accum) = 3.55
 T(local oper_env: site memcpy cpu2gpu          ) = 9.833e-04 S  per = 2.44  per(accum) = 5.99
 T(local oper_env: rintermediate init           ) = 3.037e-05 S  per = 0.0755  per(accum) = 6.07
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.358e-03 S  per = 5.86  per(accum) = 11.9
 T(local oper_env: rmmtasks init                ) = 8.715e-04 S  per = 2.17  per(accum) = 14.1
 T(local oper_env: qops memset on cpu           ) = 2.600e-08 S  per = 6.46e-05  per(accum) = 14.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.189e-02 S  per = 79.3  per(accum) = 93.4
 T(local oper_env: deallocate cpu and gpu memory) = 3.576e-05 S  per = 0.0889  per(accum) = 93.4
 T(local oper_env: construct opS [ifdists=true] ) = 6.100e-08 S  per = 0.000152  per(accum) = 93.4
 T(local oper_env: reduction of opS & opH [nccl]) = 4.400e-08 S  per = 0.000109  per(accum) = 93.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.007e-05 S  per = 0.224  per(accum) = 93.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.960e-05 S  per = 0.0736  per(accum) = 93.7
 T(local oper_env: qops_pool join and erase     ) = 2.515e-03 S  per = 6.25  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 8.310e-07 S  per = 0.00207  per(accum) = 100
##### sweep oper_env: 5.948e-02 S #####
 T(sweep oper_env: fetch) = 1.902e-02 S  per =   32  per(accum) = 32
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 32
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 32
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 32
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 32
 T(sweep oper_env: renrm) = 4.023e-02 S  per = 67.6  per(accum) = 99.6
 T(sweep oper_env: save ) = 2.298e-04 S  per = 0.386  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(sweep oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.023e-02 S  T(sum) = 4.023e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.265e-05 S  per = 0.0314  per(accum) = 0.0314
 T(sweep oper_env: qops init                    ) = 3.903e-04 S  per = 0.97  per(accum) = 1
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.392e-04 S  per = 2.33  per(accum) = 3.34
 T(sweep oper_env: allocate qops on gpu         ) = 8.545e-05 S  per = 0.212  per(accum) = 3.55
 T(sweep oper_env: site memcpy cpu2gpu          ) = 9.833e-04 S  per = 2.44  per(accum) = 5.99
 T(sweep oper_env: rintermediate init           ) = 3.037e-05 S  per = 0.0755  per(accum) = 6.07
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.358e-03 S  per = 5.86  per(accum) = 11.9
 T(sweep oper_env: rmmtasks init                ) = 8.715e-04 S  per = 2.17  per(accum) = 14.1
 T(sweep oper_env: qops memset on cpu           ) = 2.600e-08 S  per = 6.46e-05  per(accum) = 14.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.189e-02 S  per = 79.3  per(accum) = 93.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.576e-05 S  per = 0.0889  per(accum) = 93.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.100e-08 S  per = 0.000152  per(accum) = 93.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.400e-08 S  per = 0.000109  per(accum) = 93.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 9.007e-05 S  per = 0.224  per(accum) = 93.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.960e-05 S  per = 0.0736  per(accum) = 93.7
 T(sweep oper_env: qops_pool join and erase     ) = 2.515e-03 S  per = 6.25  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.310e-07 S  per = 0.00207  per(accum) = 100

idx=2 coord=(17,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.245e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=42 : 1.515e-03 S -----
rank=0 GPUmem(GB): used=8.777e-06 (oper)=8.777e-06
rank=0 GPUmem(GB): used=8.829e-06 (oper,site)=8.777e-06,5.215e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=42
 no. of rintermediate operators=141
 no. of coefficients=372:2.838e-03MB:2.772e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.522e-03 S -----
rank=0 GPUmem(GB): used=1.160e-05 (oper,site,rinter)=8.777e-06,5.215e-08,2.772e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.100e-03 S size(rtasks)=42 size(Rlst2)=4 T(Rmu/Rlist)=6.374e-04,2.463e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.524e-03 S size(rtasks)=42 size(Rlst)=204 -----
rank=0 GPUmem(GB): used=1.160e-05 avail=6.174e+00 total=6.174e+00 batch[need]=1.976e-05 blksize=4 blksize0=4 batchsize=204
rank=0 GPUmem(GB): used=3.136e-05 (oper,site,rinter,batch)=8.777e-06,5.215e-08,2.772e-06,1.976e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.374e-03,2.229e-02,9.982e-03
----- TIMING FOR renorm : t_inter=7.4e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=2 t=7.4e-03 per=1.9e+01 cost=9.4e+02 flops=1.3e+05
 renorm[gemm] counter=2 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=7.4e-03 per=1.9e+01 cost=5.7e+02 flops=7.6e+04
 renorm[gemm] counter=2 i=3 t=7.4e-03 per=1.9e+01 cost=5.4e+02 flops=7.2e+04
 renorm[gemm] counter=2 i=4 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=6 t=7.4e-03 per=1.9e+01 cost=1.1e+03 flops=1.5e+05
 renorm[gemm] counter=2 total t=2.2e-02 per=5.6e+01 cost=2.3e+03 flops=1.0e+05
 renorm[red] counter=2 t=1.0e-02 per=2.5e+01 cost=9.6e+02 flops=9.6e+04
----- TIMING FOR renorm_tot : t_inter=7.4e-03 t_gemm=4.4e-02 t_reduction=2.0e-02 tot=7.1e-02 -----
 renorm_tot[inter] counter=2 t=7.4e-03 per=1.0e+01 cost=9.4e+02 flops=1.3e+05
 renorm_tot[gemm] counter=2 i=0 t=5.0e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=2.7e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=1.4e-02 per=2.0e+01 cost=7.8e+02 flops=5.5e+04
 renorm_tot[gemm] counter=2 i=3 t=1.5e-02 per=2.1e+01 cost=7.7e+02 flops=5.2e+04
 renorm_tot[gemm] counter=2 i=4 t=2.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=5 t=2.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=6 t=1.5e-02 per=2.1e+01 cost=1.8e+03 flops=1.2e+05
 renorm_tot[gemm] counter=2 total t=4.4e-02 per=6.1e+01 cost=3.4e+03 flops=7.6e+04
 renorm_tot[red] counter=2 t=2.0e-02 per=2.8e+01 cost=1.6e+03 flops=8.0e+04
qops.to_cpu: size(tot)=105:8.0e-04MB:7.8e-07GB T(to_cpu)=8.1e-05S speed=9.6e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.05 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.412e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.144e-04 change=-9.490e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.068e-02 S #####
 T(local oper_env: fetch) = 9.050e-03 S  per = 14.9  per(accum) = 14.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.9
 T(local oper_env: renrm) = 5.140e-02 S  per = 84.7  per(accum) = 99.6
 T(local oper_env: save ) = 2.279e-04 S  per = 0.376  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.140e-02 S  T(sum) = 5.140e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.681e-06 S  per = 0.0188  per(accum) = 0.0188
 T(local oper_env: qops init                    ) = 4.202e-04 S  per = 0.818  per(accum) = 0.836
 T(local oper_env: symbolic_formulae_renorm     ) = 1.525e-03 S  per = 2.97  per(accum) = 3.8
 T(local oper_env: allocate qops on gpu         ) = 4.947e-05 S  per = 0.0962  per(accum) = 3.9
 T(local oper_env: site memcpy cpu2gpu          ) = 7.480e-04 S  per = 1.46  per(accum) = 5.35
 T(local oper_env: rintermediate init           ) = 2.533e-03 S  per = 4.93  per(accum) = 10.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.535e-03 S  per = 6.88  per(accum) = 17.2
 T(local oper_env: rmmtasks init                ) = 1.290e-03 S  per = 2.51  per(accum) = 19.7
 T(local oper_env: qops memset on cpu           ) = 3.200e-08 S  per = 6.23e-05  per(accum) = 19.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.975e-02 S  per = 77.3  per(accum) = 97
 T(local oper_env: deallocate cpu and gpu memory) = 3.510e-05 S  per = 0.0683  per(accum) = 97.1
 T(local oper_env: construct opS [ifdists=true] ) = 4.700e-08 S  per = 9.14e-05  per(accum) = 97.1
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 8.37e-05  per(accum) = 97.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.859e-05 S  per = 0.172  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.605e-05 S  per = 0.0507  per(accum) = 97.3
 T(local oper_env: qops_pool join and erase     ) = 1.397e-03 S  per = 2.72  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.220e-07 S  per = 0.0014  per(accum) = 100
##### sweep oper_env: 1.202e-01 S #####
 T(sweep oper_env: fetch) = 2.807e-02 S  per = 23.4  per(accum) = 23.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: renrm) = 9.163e-02 S  per = 76.3  per(accum) = 99.6
 T(sweep oper_env: save ) = 4.577e-04 S  per = 0.381  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.473e+09 S  per = -3.473e+31
 T(sweep oper_env: preprocess                  ) = -3.473e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.163e-02 S  T(sum) = 9.163e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.233e-05 S  per = 0.0244  per(accum) = 0.0244
 T(sweep oper_env: qops init                    ) = 8.106e-04 S  per = 0.885  per(accum) = 0.909
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.464e-03 S  per = 2.69  per(accum) = 3.6
 T(sweep oper_env: allocate qops on gpu         ) = 1.349e-04 S  per = 0.147  per(accum) = 3.75
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.731e-03 S  per = 1.89  per(accum) = 5.63
 T(sweep oper_env: rintermediate init           ) = 2.563e-03 S  per =  2.8  per(accum) = 8.43
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.894e-03 S  per = 6.43  per(accum) = 14.9
 T(sweep oper_env: rmmtasks init                ) = 2.162e-03 S  per = 2.36  per(accum) = 17.2
 T(sweep oper_env: qops memset on cpu           ) = 5.800e-08 S  per = 6.33e-05  per(accum) = 17.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.163e-02 S  per = 78.2  per(accum) = 95.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.086e-05 S  per = 0.0773  per(accum) = 95.5
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.080e-07 S  per = 0.000118  per(accum) = 95.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.700e-08 S  per = 9.49e-05  per(accum) = 95.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.787e-04 S  per = 0.195  per(accum) = 95.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 5.565e-05 S  per = 0.0607  per(accum) = 95.7
 T(sweep oper_env: qops_pool join and erase     ) = 3.912e-03 S  per = 4.27  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.553e-06 S  per = 0.00169  per(accum) = 100

idx=3 coord=(16,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.343e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.845e-03 S -----
rank=0 GPUmem(GB): used=9.298e-06 (oper)=9.298e-06
rank=0 GPUmem(GB): used=9.358e-06 (oper,site)=9.298e-06,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=149
 no. of coefficients=702:5.356e-03MB:5.230e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.479e-03 S -----
rank=0 GPUmem(GB): used=1.459e-05 (oper,site,rinter)=9.298e-06,5.960e-08,5.230e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.935e-03 S size(rtasks)=57 size(Rlst2)=4 T(Rmu/Rlist)=6.678e-04,2.267e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.964e-03 S size(rtasks)=57 size(Rlst)=198 -----
rank=0 GPUmem(GB): used=1.459e-05 avail=6.174e+00 total=6.174e+00 batch[need]=1.918e-05 blksize=4 blksize0=4 batchsize=198
rank=0 GPUmem(GB): used=3.377e-05 (oper,site,rinter,batch)=9.298e-06,5.960e-08,5.230e-06,1.918e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.903e-03,2.246e-02,9.895e-03
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=3 t=5.9e-03 per=1.5e+01 cost=3.9e+03 flops=6.6e+05
 renorm[gemm] counter=3 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=7.6e-03 per=2.0e+01 cost=5.2e+02 flops=6.8e+04
 renorm[gemm] counter=3 i=3 t=7.4e-03 per=1.9e+01 cost=8.3e+02 flops=1.1e+05
 renorm[gemm] counter=3 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=5 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=6 t=7.4e-03 per=1.9e+01 cost=1.6e+03 flops=2.2e+05
 renorm[gemm] counter=3 total t=2.2e-02 per=5.9e+01 cost=3.0e+03 flops=1.3e+05
 renorm[red] counter=3 t=9.9e-03 per=2.6e+01 cost=9.9e+02 flops=1.0e+05
----- TIMING FOR renorm_tot : t_inter=1.3e-02 t_gemm=6.6e-02 t_reduction=3.0e-02 tot=1.1e-01 -----
 renorm_tot[inter] counter=3 t=1.3e-02 per=1.2e+01 cost=4.8e+03 flops=3.6e+05
 renorm_tot[gemm] counter=3 i=0 t=6.5e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=4.0e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=2.2e-02 per=2.0e+01 cost=1.3e+03 flops=6.0e+04
 renorm_tot[gemm] counter=3 i=3 t=2.2e-02 per=2.0e+01 cost=1.6e+03 flops=7.2e+04
 renorm_tot[gemm] counter=3 i=4 t=4.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=5 t=3.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=6 t=2.2e-02 per=2.0e+01 cost=3.4e+03 flops=1.5e+05
 renorm_tot[gemm] counter=3 total t=6.6e-02 per=6.1e+01 cost=6.3e+03 flops=9.5e+04
 renorm_tot[red] counter=3 t=3.0e-02 per=2.7e+01 cost=2.6e+03 flops=8.7e+04
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=7.5e-05S speed=1.4e-02GB/S
check ||H-H.dagger||=1.256e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0495 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.620e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.772e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 5.997e-02 S #####
 T(local oper_env: fetch) = 8.975e-03 S  per =   15  per(accum) = 15
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15
 T(local oper_env: renrm) = 5.077e-02 S  per = 84.7  per(accum) = 99.6
 T(local oper_env: save ) = 2.213e-04 S  per = 0.369  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.077e-02 S  T(sum) = 5.077e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.044e-06 S  per = 0.0178  per(accum) = 0.0178
 T(local oper_env: qops init                    ) = 5.069e-04 S  per = 0.998  per(accum) = 1.02
 T(local oper_env: symbolic_formulae_renorm     ) = 1.855e-03 S  per = 3.65  per(accum) = 4.67
 T(local oper_env: allocate qops on gpu         ) = 4.872e-05 S  per = 0.096  per(accum) = 4.77
 T(local oper_env: site memcpy cpu2gpu          ) = 1.883e-03 S  per = 3.71  per(accum) = 8.47
 T(local oper_env: rintermediate init           ) = 2.489e-03 S  per =  4.9  per(accum) = 13.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.974e-03 S  per = 5.86  per(accum) = 19.2
 T(local oper_env: rmmtasks init                ) = 1.206e-03 S  per = 2.38  per(accum) = 21.6
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 6.7e-05  per(accum) = 21.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.835e-02 S  per = 75.5  per(accum) = 97.1
 T(local oper_env: deallocate cpu and gpu memory) = 3.009e-05 S  per = 0.0593  per(accum) = 97.2
 T(local oper_env: construct opS [ifdists=true] ) = 4.700e-08 S  per = 9.26e-05  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 6.89e-05  per(accum) = 97.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.233e-05 S  per = 0.162  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.531e-05 S  per = 0.0498  per(accum) = 97.4
 T(local oper_env: qops_pool join and erase     ) = 1.314e-03 S  per = 2.59  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.530e-07 S  per = 0.00148  per(accum) = 100
##### sweep oper_env: 1.801e-01 S #####
 T(sweep oper_env: fetch) = 3.705e-02 S  per = 20.6  per(accum) = 20.6
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.6
 T(sweep oper_env: renrm) = 1.424e-01 S  per = 79.1  per(accum) = 99.6
 T(sweep oper_env: save ) = 6.790e-04 S  per = 0.377  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.210e+09 S  per = -5.210e+31
 T(sweep oper_env: preprocess                  ) = -5.210e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.424e-01 S  T(sum) = 1.424e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.138e-05 S  per = 0.022  per(accum) = 0.022
 T(sweep oper_env: qops init                    ) = 1.317e-03 S  per = 0.925  per(accum) = 0.947
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.319e-03 S  per = 3.03  per(accum) = 3.98
 T(sweep oper_env: allocate qops on gpu         ) = 1.836e-04 S  per = 0.129  per(accum) = 4.11
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.614e-03 S  per = 2.54  per(accum) = 6.65
 T(sweep oper_env: rintermediate init           ) = 5.052e-03 S  per = 3.55  per(accum) = 10.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.868e-03 S  per = 6.23  per(accum) = 16.4
 T(sweep oper_env: rmmtasks init                ) = 3.367e-03 S  per = 2.36  per(accum) = 18.8
 T(sweep oper_env: qops memset on cpu           ) = 9.200e-08 S  per = 6.46e-05  per(accum) = 18.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.100e-01 S  per = 77.2  per(accum) = 96
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.009e-04 S  per = 0.0709  per(accum) = 96.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.550e-07 S  per = 0.000109  per(accum) = 96.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.220e-07 S  per = 8.57e-05  per(accum) = 96.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.610e-04 S  per = 0.183  per(accum) = 96.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 8.096e-05 S  per = 0.0569  per(accum) = 96.3
 T(sweep oper_env: qops_pool join and erase     ) = 5.226e-03 S  per = 3.67  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.306e-06 S  per = 0.00162  per(accum) = 100

idx=4 coord=(15,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.297e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 2.188e-03 S -----
rank=0 GPUmem(GB): used=9.440e-06 (oper)=9.440e-06
rank=0 GPUmem(GB): used=9.485e-06 (oper,site)=9.440e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=76
 no. of rintermediate operators=140
 no. of coefficients=1070:8.163e-03MB:7.972e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.478e-03 S -----
rank=0 GPUmem(GB): used=1.746e-05 (oper,site,rinter)=9.440e-06,4.470e-08,7.972e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.893e-03 S size(rtasks)=76 size(Rlst2)=1 T(Rmu/Rlist)=6.831e-04,1.210e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.923e-03 S size(rtasks)=76 size(Rlst)=81 -----
rank=0 GPUmem(GB): used=1.746e-05 avail=6.174e+00 total=6.174e+00 batch[need]=7.845e-06 blksize=4 blksize0=4 batchsize=81
rank=0 GPUmem(GB): used=2.530e-05 (oper,site,rinter,batch)=9.440e-06,4.470e-08,7.972e-06,7.845e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.647e-03,2.262e-02,1.013e-02
----- TIMING FOR renorm : t_inter=7.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=4 t=7.6e-03 per=1.9e+01 cost=4.8e+02 flops=6.3e+04
 renorm[gemm] counter=4 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=7.5e-03 per=1.9e+01 cost=1.7e+02 flops=2.3e+04
 renorm[gemm] counter=4 i=3 t=7.5e-03 per=1.9e+01 cost=5.1e+02 flops=6.7e+04
 renorm[gemm] counter=4 i=4 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=7.6e-03 per=1.9e+01 cost=9.8e+02 flops=1.3e+05
 renorm[gemm] counter=4 total t=2.3e-02 per=5.6e+01 cost=1.7e+03 flops=7.4e+04
 renorm[red] counter=4 t=1.0e-02 per=2.5e+01 cost=6.5e+02 flops=6.4e+04
----- TIMING FOR renorm_tot : t_inter=2.1e-02 t_gemm=8.9e-02 t_reduction=4.0e-02 tot=1.5e-01 -----
 renorm_tot[inter] counter=4 t=2.1e-02 per=1.4e+01 cost=5.3e+03 flops=2.5e+05
 renorm_tot[gemm] counter=4 i=0 t=8.0e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=5.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=2.9e-02 per=1.9e+01 cost=1.5e+03 flops=5.0e+04
 renorm_tot[gemm] counter=4 i=3 t=3.0e-02 per=2.0e+01 cost=2.1e+03 flops=7.1e+04
 renorm_tot[gemm] counter=4 i=4 t=5.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=5 t=4.9e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=6 t=3.0e-02 per=2.0e+01 cost=4.4e+03 flops=1.5e+05
 renorm_tot[gemm] counter=4 total t=8.9e-02 per=5.9e+01 cost=8.0e+03 flops=9.0e+04
 renorm_tot[red] counter=4 t=4.0e-02 per=2.7e+01 cost=3.3e+03 flops=8.1e+04
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB T(to_cpu)=1.0e-04S speed=9.1e-03GB/S
check ||H-H.dagger||=2.669e-15 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0499 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.568e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.867e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.044e-02 S #####
 T(local oper_env: fetch) = 8.936e-03 S  per = 14.8  per(accum) = 14.8
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: renrm) = 5.128e-02 S  per = 84.8  per(accum) = 99.6
 T(local oper_env: save ) = 2.228e-04 S  per = 0.369  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.128e-02 S  T(sum) = 5.128e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.834e-06 S  per = 0.0172  per(accum) = 0.0172
 T(local oper_env: qops init                    ) = 4.332e-04 S  per = 0.845  per(accum) = 0.862
 T(local oper_env: symbolic_formulae_renorm     ) = 2.197e-03 S  per = 4.29  per(accum) = 5.15
 T(local oper_env: allocate qops on gpu         ) = 4.727e-05 S  per = 0.0922  per(accum) = 5.24
 T(local oper_env: site memcpy cpu2gpu          ) = 1.750e-03 S  per = 3.41  per(accum) = 8.65
 T(local oper_env: rintermediate init           ) = 2.488e-03 S  per = 4.85  per(accum) = 13.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.929e-03 S  per = 3.76  per(accum) = 17.3
 T(local oper_env: rmmtasks init                ) = 4.586e-04 S  per = 0.894  per(accum) = 18.2
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 6.44e-05  per(accum) = 18.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.049e-02 S  per =   79  per(accum) = 97.1
 T(local oper_env: deallocate cpu and gpu memory) = 2.500e-05 S  per = 0.0487  per(accum) = 97.2
 T(local oper_env: construct opS [ifdists=true] ) = 4.700e-08 S  per = 9.17e-05  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [nccl]) = 3.400e-08 S  per = 6.63e-05  per(accum) = 97.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.086e-04 S  per = 0.212  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.421e-05 S  per = 0.0472  per(accum) = 97.4
 T(local oper_env: qops_pool join and erase     ) = 1.318e-03 S  per = 2.57  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.470e-07 S  per = 0.00126  per(accum) = 100
##### sweep oper_env: 2.406e-01 S #####
 T(sweep oper_env: fetch) = 4.598e-02 S  per = 19.1  per(accum) = 19.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.1
 T(sweep oper_env: renrm) = 1.937e-01 S  per = 80.5  per(accum) = 99.6
 T(sweep oper_env: save ) = 9.017e-04 S  per = 0.375  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.947e+09 S  per = -6.947e+31
 T(sweep oper_env: preprocess                  ) = -6.947e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.937e-01 S  T(sum) = 1.937e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.021e-05 S  per = 0.0208  per(accum) = 0.0208
 T(sweep oper_env: qops init                    ) = 1.751e-03 S  per = 0.904  per(accum) = 0.925
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.517e-03 S  per = 3.36  per(accum) = 4.29
 T(sweep oper_env: allocate qops on gpu         ) = 2.309e-04 S  per = 0.119  per(accum) = 4.41
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.364e-03 S  per = 2.77  per(accum) = 7.18
 T(sweep oper_env: rintermediate init           ) = 7.540e-03 S  per = 3.89  per(accum) = 11.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.080e-02 S  per = 5.57  per(accum) = 16.6
 T(sweep oper_env: rmmtasks init                ) = 3.826e-03 S  per = 1.98  per(accum) = 18.6
 T(sweep oper_env: qops memset on cpu           ) = 1.250e-07 S  per = 6.45e-05  per(accum) = 18.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.505e-01 S  per = 77.7  per(accum) = 96.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.259e-04 S  per = 0.065  per(accum) = 96.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.020e-07 S  per = 0.000104  per(accum) = 96.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.560e-07 S  per = 8.05e-05  per(accum) = 96.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.696e-04 S  per = 0.191  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.052e-04 S  per = 0.0543  per(accum) = 96.6
 T(sweep oper_env: qops_pool join and erase     ) = 6.544e-03 S  per = 3.38  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.953e-06 S  per = 0.00152  per(accum) = 100

idx=5 coord=(14,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=380:0.0029MB:2.83e-06GB
        per(mem): H:1.58 C:6.32 S:14.7 A:0 B:77.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.983e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=99 : 2.543e-03 S -----
rank=0 GPUmem(GB): used=1.119e-05 (oper)=1.119e-05
rank=0 GPUmem(GB): used=1.125e-05 (oper,site)=1.119e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=99
 no. of rintermediate operators=131
 no. of coefficients=1475:1.125e-02MB:1.099e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.467e-03 S -----
rank=0 GPUmem(GB): used=2.224e-05 (oper,site,rinter)=1.119e-05,5.960e-08,1.099e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.723e-03 S size(rtasks)=99 size(Rlst2)=9 T(Rmu/Rlist)=6.981e-04,3.025e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.769e-03 S size(rtasks)=99 size(Rlst)=301 -----
rank=0 GPUmem(GB): used=2.224e-05 avail=6.174e+00 total=6.174e+00 batch[need]=2.915e-05 blksize=4 blksize0=4 batchsize=301
rank=0 GPUmem(GB): used=5.139e-05 (oper,site,rinter,batch)=1.119e-05,5.960e-08,1.099e-05,2.915e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.401e-03,2.281e-02,1.015e-02
----- TIMING FOR renorm : t_inter=6.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=5 t=6.4e-03 per=1.6e+01 cost=1.6e+04 flops=2.5e+06
 renorm[gemm] counter=5 i=0 t=1.5e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=7.5e-03 per=1.9e+01 cost=1.0e+03 flops=1.4e+05
 renorm[gemm] counter=5 i=3 t=7.6e-03 per=1.9e+01 cost=2.2e+03 flops=2.9e+05
 renorm[gemm] counter=5 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=7.6e-03 per=1.9e+01 cost=2.2e+03 flops=2.9e+05
 renorm[gemm] counter=5 total t=2.3e-02 per=5.8e+01 cost=5.5e+03 flops=2.4e+05
 renorm[red] counter=5 t=1.0e-02 per=2.6e+01 cost=1.1e+03 flops=1.1e+05
----- TIMING FOR renorm_tot : t_inter=2.7e-02 t_gemm=1.1e-01 t_reduction=5.0e-02 tot=1.9e-01 -----
 renorm_tot[inter] counter=5 t=2.7e-02 per=1.4e+01 cost=2.1e+04 flops=7.7e+05
 renorm_tot[gemm] counter=5 i=0 t=9.5e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=6.6e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=3.7e-02 per=1.9e+01 cost=2.5e+03 flops=6.8e+04
 renorm_tot[gemm] counter=5 i=3 t=3.7e-02 per=2.0e+01 cost=4.3e+03 flops=1.2e+05
 renorm_tot[gemm] counter=5 i=4 t=6.6e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=5 t=6.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=6 t=3.8e-02 per=2.0e+01 cost=6.6e+03 flops=1.8e+05
 renorm_tot[gemm] counter=5 total t=1.1e-01 per=5.9e+01 cost=1.3e+04 flops=1.2e+05
 renorm_tot[red] counter=5 t=5.0e-02 per=2.7e+01 cost=4.4e+03 flops=8.7e+04
qops.to_cpu: size(tot)=380:2.9e-03MB:2.8e-06GB T(to_cpu)=1.1e-04S speed=2.5e-02GB/S
check ||H-H.dagger||=6.280e-16 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0523 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.052e-05 change=2.420e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.052e-05 change=-1.065e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.275e-02 S #####
 T(local oper_env: fetch) = 8.947e-03 S  per = 14.3  per(accum) = 14.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: renrm) = 5.358e-02 S  per = 85.4  per(accum) = 99.6
 T(local oper_env: save ) = 2.249e-04 S  per = 0.358  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.358e-02 S  T(sum) = 5.358e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.860e-06 S  per = 0.0165  per(accum) = 0.0165
 T(local oper_env: qops init                    ) = 1.208e-03 S  per = 2.25  per(accum) = 2.27
 T(local oper_env: symbolic_formulae_renorm     ) = 2.553e-03 S  per = 4.76  per(accum) = 7.04
 T(local oper_env: allocate qops on gpu         ) = 4.645e-05 S  per = 0.0867  per(accum) = 7.12
 T(local oper_env: site memcpy cpu2gpu          ) = 5.739e-04 S  per = 1.07  per(accum) = 8.19
 T(local oper_env: rintermediate init           ) = 2.477e-03 S  per = 4.62  per(accum) = 12.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.783e-03 S  per = 7.06  per(accum) = 19.9
 T(local oper_env: rmmtasks init                ) = 1.964e-03 S  per = 3.67  per(accum) = 23.5
 T(local oper_env: qops memset on cpu           ) = 3.900e-08 S  per = 7.28e-05  per(accum) = 23.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.945e-02 S  per = 73.6  per(accum) = 97.2
 T(local oper_env: deallocate cpu and gpu memory) = 4.008e-05 S  per = 0.0748  per(accum) = 97.3
 T(local oper_env: construct opS [ifdists=true] ) = 6.200e-08 S  per = 0.000116  per(accum) = 97.3
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 6.53e-05  per(accum) = 97.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.206e-04 S  per = 0.225  per(accum) = 97.5
 T(local oper_env: reduction of opS & opH [mpi] ) = 3.317e-05 S  per = 0.0619  per(accum) = 97.5
 T(local oper_env: qops_pool join and erase     ) = 1.314e-03 S  per = 2.45  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.960e-07 S  per = 0.00149  per(accum) = 100
##### sweep oper_env: 3.033e-01 S #####
 T(sweep oper_env: fetch) = 5.493e-02 S  per = 18.1  per(accum) = 18.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(sweep oper_env: renrm) = 2.473e-01 S  per = 81.5  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.127e-03 S  per = 0.371  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.683e+09 S  per = -8.683e+31
 T(sweep oper_env: preprocess                  ) = -8.683e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.473e-01 S  T(sum) = 2.473e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.907e-05 S  per = 0.0198  per(accum) = 0.0198
 T(sweep oper_env: qops init                    ) = 2.959e-03 S  per =  1.2  per(accum) = 1.22
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.069e-03 S  per = 3.67  per(accum) = 4.88
 T(sweep oper_env: allocate qops on gpu         ) = 2.774e-04 S  per = 0.112  per(accum) = 5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.938e-03 S  per =  2.4  per(accum) = 7.4
 T(sweep oper_env: rintermediate init           ) = 1.002e-02 S  per = 4.05  per(accum) = 11.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.458e-02 S  per =  5.9  per(accum) = 17.3
 T(sweep oper_env: rmmtasks init                ) = 5.790e-03 S  per = 2.34  per(accum) = 19.7
 T(sweep oper_env: qops memset on cpu           ) = 1.640e-07 S  per = 6.63e-05  per(accum) = 19.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.899e-01 S  per = 76.8  per(accum) = 96.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.660e-04 S  per = 0.0671  per(accum) = 96.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.640e-07 S  per = 0.000107  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.910e-07 S  per = 7.72e-05  per(accum) = 96.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.901e-04 S  per = 0.198  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.383e-04 S  per = 0.056  per(accum) = 96.8
 T(sweep oper_env: qops_pool join and erase     ) = 7.859e-03 S  per = 3.18  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.749e-06 S  per = 0.00152  per(accum) = 100

idx=6 coord=(13,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=380:0.0029MB:2.83e-06GB
        per(mem): H:1.58 C:6.32 S:14.7 A:0 B:77.4 
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=1068:0.00815MB:7.96e-06GB
        per(mem): H:1.12 C:5.24 S:9.74 A:0 B:83.9 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.260e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=126 : 2.913e-03 S -----
rank=0 GPUmem(GB): used=1.822e-05 (oper)=1.822e-05
rank=0 GPUmem(GB): used=1.834e-05 (oper,site)=1.822e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=126
 no. of rintermediate operators=122
 no. of coefficients=1899:1.449e-02MB:1.415e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.546e-03 S -----
rank=0 GPUmem(GB): used=3.249e-05 (oper,site,rinter)=1.822e-05,1.192e-07,1.415e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 9.392e-03 S size(rtasks)=126 size(Rlst2)=9 T(Rmu/Rlist)=7.330e-04,8.659e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.474e-03 S size(rtasks)=126 size(Rlst)=611 -----
rank=0 GPUmem(GB): used=3.249e-05 avail=6.174e+00 total=6.174e+00 batch[need]=5.918e-05 blksize=4 blksize0=4 batchsize=611
rank=0 GPUmem(GB): used=9.167e-05 (oper,site,rinter,batch)=1.822e-05,1.192e-07,1.415e-05,5.918e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.299e-03,1.907e-02,1.808e-03
----- TIMING FOR renorm : t_inter=7.3e-03 t_gemm=1.9e-02 t_reduction=1.8e-03 tot=2.8e-02 -----
 renorm[inter] counter=6 t=7.3e-03 per=2.6e+01 cost=2.2e+04 flops=3.0e+06
 renorm[gemm] counter=6 i=0 t=1.5e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.3e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=7.6e-03 per=2.7e+01 cost=1.7e+03 flops=2.2e+05
 renorm[gemm] counter=6 i=3 t=7.7e-03 per=2.7e+01 cost=4.7e+03 flops=6.1e+05
 renorm[gemm] counter=6 i=4 t=1.4e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.3e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=3.8e-03 per=1.4e+01 cost=7.8e+03 flops=2.0e+06
 renorm[gemm] counter=6 total t=1.9e-02 per=6.8e+01 cost=1.4e+04 flops=7.4e+05
 renorm[red] counter=6 t=1.8e-03 per=6.4e+00 cost=4.9e+03 flops=2.7e+06
----- TIMING FOR renorm_tot : t_inter=3.5e-02 t_gemm=1.3e-01 t_reduction=5.2e-02 tot=2.2e-01 -----
 renorm_tot[inter] counter=6 t=3.5e-02 per=1.6e+01 cost=4.3e+04 flops=1.2e+06
 renorm_tot[gemm] counter=6 i=0 t=1.1e-05 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=7.8e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=4.4e-02 per=2.0e+01 cost=4.2e+03 flops=9.4e+04
 renorm_tot[gemm] counter=6 i=3 t=4.5e-02 per=2.1e+01 cost=9.0e+03 flops=2.0e+05
 renorm_tot[gemm] counter=6 i=4 t=8.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=5 t=7.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=6 t=4.1e-02 per=1.9e+01 cost=1.4e+04 flops=3.5e+05
 renorm_tot[gemm] counter=6 total t=1.3e-01 per=6.0e+01 cost=2.8e+04 flops=2.1e+05
 renorm_tot[red] counter=6 t=5.2e-02 per=2.4e+01 cost=9.3e+03 flops=1.8e+05
qops.to_cpu: size(tot)=1068:8.1e-03MB:8.0e-06GB T(to_cpu)=1.4e-04S speed=5.8e-02GB/S
check ||H-H.dagger||=1.576e-16 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.053 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.513e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=9.155e-05 change=-1.237e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.372e-02 S #####
 T(local oper_env: fetch) = 8.952e-03 S  per =   14  per(accum) = 14
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14
 T(local oper_env: renrm) = 5.453e-02 S  per = 85.6  per(accum) = 99.6
 T(local oper_env: save ) = 2.364e-04 S  per = 0.371  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.453e-02 S  T(sum) = 5.453e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.911e-06 S  per = 0.0163  per(accum) = 0.0163
 T(local oper_env: qops init                    ) = 1.500e-03 S  per = 2.75  per(accum) = 2.77
 T(local oper_env: symbolic_formulae_renorm     ) = 2.924e-03 S  per = 5.36  per(accum) = 8.13
 T(local oper_env: allocate qops on gpu         ) = 5.750e-05 S  per = 0.105  per(accum) = 8.23
 T(local oper_env: site memcpy cpu2gpu          ) = 2.054e-03 S  per = 3.77  per(accum) = 12
 T(local oper_env: rintermediate init           ) = 2.556e-03 S  per = 4.69  per(accum) = 16.7
 T(local oper_env: preprocess_formulae_Rlist2   ) = 9.498e-03 S  per = 17.4  per(accum) = 34.1
 T(local oper_env: rmmtasks init                ) = 5.865e-03 S  per = 10.8  per(accum) = 44.9
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 6.05e-05  per(accum) = 44.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.828e-02 S  per = 51.9  per(accum) = 96.7
 T(local oper_env: deallocate cpu and gpu memory) = 9.488e-05 S  per = 0.174  per(accum) = 96.9
 T(local oper_env: construct opS [ifdists=true] ) = 6.300e-08 S  per = 0.000116  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 6.42e-05  per(accum) = 96.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.469e-04 S  per = 0.269  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 3.315e-05 S  per = 0.0608  per(accum) = 97.2
 T(local oper_env: qops_pool join and erase     ) = 1.516e-03 S  per = 2.78  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.140e-07 S  per = 0.00131  per(accum) = 100
##### sweep oper_env: 3.670e-01 S #####
 T(sweep oper_env: fetch) = 6.388e-02 S  per = 17.4  per(accum) = 17.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(sweep oper_env: renrm) = 3.018e-01 S  per = 82.2  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.363e-03 S  per = 0.371  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.042e+10 S  per = -1.042e+32
 T(sweep oper_env: preprocess                  ) = -1.042e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.018e-01 S  T(sum) = 3.018e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 5.798e-05 S  per = 0.0192  per(accum) = 0.0192
 T(sweep oper_env: qops init                    ) = 4.459e-03 S  per = 1.48  per(accum) = 1.5
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.199e-02 S  per = 3.97  per(accum) = 5.47
 T(sweep oper_env: allocate qops on gpu         ) = 3.349e-04 S  per = 0.111  per(accum) = 5.58
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.992e-03 S  per = 2.65  per(accum) = 8.23
 T(sweep oper_env: rintermediate init           ) = 1.257e-02 S  per = 4.17  per(accum) = 12.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.408e-02 S  per = 7.98  per(accum) = 20.4
 T(sweep oper_env: rmmtasks init                ) = 1.166e-02 S  per = 3.86  per(accum) = 24.2
 T(sweep oper_env: qops memset on cpu           ) = 1.970e-07 S  per = 6.53e-05  per(accum) = 24.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.182e-01 S  per = 72.3  per(accum) = 96.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.609e-04 S  per = 0.0864  per(accum) = 96.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.270e-07 S  per = 0.000108  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.260e-07 S  per = 7.49e-05  per(accum) = 96.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.371e-04 S  per = 0.211  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.715e-04 S  per = 0.0568  per(accum) = 96.9
 T(sweep oper_env: qops_pool join and erase     ) = 9.375e-03 S  per = 3.11  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 4.463e-06 S  per = 0.00148  per(accum) = 100

idx=7 coord=(12,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=1068:0.00815MB:7.96e-06GB
        per(mem): H:1.12 C:5.24 S:9.74 A:0 B:83.9 
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=2494:0.019MB:1.86e-05GB
        per(mem): H:0.882 C:3.85 S:5.77 A:0 B:89.5 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.580e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=157 : 3.324e-03 S -----
rank=0 GPUmem(GB): used=3.397e-05 (oper)=3.397e-05
rank=0 GPUmem(GB): used=3.418e-05 (oper,site)=3.397e-05,2.086e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=157
 no. of rintermediate operators=113
 no. of coefficients=2324:1.773e-02MB:1.732e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.475e-03 S -----
rank=0 GPUmem(GB): used=5.150e-05 (oper,site,rinter)=3.397e-05,2.086e-07,1.732e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 8.425e-03 S size(rtasks)=157 size(Rlst2)=9 T(Rmu/Rlist)=7.734e-04,7.652e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.518e-03 S size(rtasks)=157 size(Rlst)=707 -----
rank=0 GPUmem(GB): used=5.150e-05 avail=6.174e+00 total=6.174e+00 batch[need]=1.212e-04 blksize=9 blksize0=4 batchsize=707
rank=0 GPUmem(GB): used=1.727e-04 (oper,site,rinter,batch)=3.397e-05,2.086e-07,1.732e-05,1.212e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.326e-03,2.250e-02,9.963e-03
----- TIMING FOR renorm : t_inter=5.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=7 t=5.3e-03 per=1.4e+01 cost=2.9e+04 flops=5.5e+06
 renorm[gemm] counter=7 i=0 t=1.5e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=7.4e-03 per=2.0e+01 cost=3.0e+03 flops=4.0e+05
 renorm[gemm] counter=7 i=3 t=7.5e-03 per=2.0e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=7 i=4 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=7.6e-03 per=2.0e+01 cost=2.2e+04 flops=2.9e+06
 renorm[gemm] counter=7 total t=2.3e-02 per=6.0e+01 cost=3.6e+04 flops=1.6e+06
 renorm[red] counter=7 t=1.0e-02 per=2.6e+01 cost=1.1e+04 flops=1.1e+06
----- TIMING FOR renorm_tot : t_inter=4.0e-02 t_gemm=1.5e-01 t_reduction=6.2e-02 tot=2.6e-01 -----
 renorm_tot[inter] counter=7 t=4.0e-02 per=1.6e+01 cost=7.2e+04 flops=1.8e+06
 renorm_tot[gemm] counter=7 i=0 t=1.2e-05 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=9.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=5.2e-02 per=2.0e+01 cost=7.1e+03 flops=1.4e+05
 renorm_tot[gemm] counter=7 i=3 t=5.3e-02 per=2.1e+01 cost=2.0e+04 flops=3.8e+05
 renorm_tot[gemm] counter=7 i=4 t=9.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=5 t=8.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=6 t=4.9e-02 per=1.9e+01 cost=3.6e+04 flops=7.4e+05
 renorm_tot[gemm] counter=7 total t=1.5e-01 per=6.0e+01 cost=6.4e+04 flops=4.2e+05
 renorm_tot[red] counter=7 t=6.2e-02 per=2.4e+01 cost=2.0e+04 flops=3.3e+05
qops.to_cpu: size(tot)=2494:1.9e-02MB:1.9e-05GB T(to_cpu)=2.1e-04S speed=8.9e-02GB/S
check ||H-H.dagger||=1.099e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0608 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=4.165e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.670e-04 change=-1.326e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 7.274e-02 S #####
 T(local oper_env: fetch) = 8.998e-03 S  per = 12.4  per(accum) = 12.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: renrm) = 6.343e-02 S  per = 87.2  per(accum) = 99.6
 T(local oper_env: save ) = 3.107e-04 S  per = 0.427  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.343e-02 S  T(sum) = 6.343e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.990e-06 S  per = 0.0142  per(accum) = 0.0142
 T(local oper_env: qops init                    ) = 1.840e-03 S  per =  2.9  per(accum) = 2.91
 T(local oper_env: symbolic_formulae_renorm     ) = 3.336e-03 S  per = 5.26  per(accum) = 8.17
 T(local oper_env: allocate qops on gpu         ) = 5.331e-05 S  per = 0.084  per(accum) = 8.26
 T(local oper_env: site memcpy cpu2gpu          ) = 1.748e-03 S  per = 2.76  per(accum) = 11
 T(local oper_env: rintermediate init           ) = 2.486e-03 S  per = 3.92  per(accum) = 14.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 8.545e-03 S  per = 13.5  per(accum) = 28.4
 T(local oper_env: rmmtasks init                ) = 4.510e-03 S  per = 7.11  per(accum) = 35.5
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 5.36e-05  per(accum) = 35.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.790e-02 S  per = 59.7  per(accum) = 95.3
 T(local oper_env: deallocate cpu and gpu memory) = 9.586e-05 S  per = 0.151  per(accum) = 95.4
 T(local oper_env: construct opS [ifdists=true] ) = 1.390e-07 S  per = 0.000219  per(accum) = 95.4
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 6.78e-05  per(accum) = 95.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.176e-04 S  per = 0.343  per(accum) = 95.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 4.620e-05 S  per = 0.0728  per(accum) = 95.8
 T(local oper_env: qops_pool join and erase     ) = 2.652e-03 S  per = 4.18  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 1.028e-06 S  per = 0.00162  per(accum) = 100
##### sweep oper_env: 4.398e-01 S #####
 T(sweep oper_env: fetch) = 7.288e-02 S  per = 16.6  per(accum) = 16.6
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.6
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.6
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.6
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.6
 T(sweep oper_env: renrm) = 3.652e-01 S  per =   83  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.674e-03 S  per = 0.381  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.216e+10 S  per = -1.216e+32
 T(sweep oper_env: preprocess                  ) = -1.216e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.652e-01 S  T(sum) = 3.652e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.697e-05 S  per = 0.0183  per(accum) = 0.0183
 T(sweep oper_env: qops init                    ) = 6.299e-03 S  per = 1.72  per(accum) = 1.74
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.533e-02 S  per =  4.2  per(accum) = 5.94
 T(sweep oper_env: allocate qops on gpu         ) = 3.882e-04 S  per = 0.106  per(accum) = 6.05
 T(sweep oper_env: site memcpy cpu2gpu          ) = 9.739e-03 S  per = 2.67  per(accum) = 8.71
 T(sweep oper_env: rintermediate init           ) = 1.506e-02 S  per = 4.12  per(accum) = 12.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.262e-02 S  per = 8.93  per(accum) = 21.8
 T(sweep oper_env: rmmtasks init                ) = 1.617e-02 S  per = 4.43  per(accum) = 26.2
 T(sweep oper_env: qops memset on cpu           ) = 2.310e-07 S  per = 6.32e-05  per(accum) = 26.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.561e-01 S  per = 70.1  per(accum) = 96.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.568e-04 S  per = 0.0977  per(accum) = 96.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.660e-07 S  per = 0.000128  per(accum) = 96.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.690e-07 S  per = 7.37e-05  per(accum) = 96.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 8.547e-04 S  per = 0.234  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.177e-04 S  per = 0.0596  per(accum) = 96.7
 T(sweep oper_env: qops_pool join and erase     ) = 1.203e-02 S  per = 3.29  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.491e-06 S  per = 0.0015  per(accum) = 100

idx=8 coord=(11,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=2494:0.019MB:1.86e-05GB
        per(mem): H:0.882 C:3.85 S:5.77 A:0 B:89.5 
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:9 S:11 A:81 B:90 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=4603:0.0351MB:3.43e-05GB
        per(mem): H:0.717 C:1.56 S:1.91 A:0 B:95.8 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.940e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=192 : 4.042e-03 S -----
rank=0 GPUmem(GB): used=6.031e-05 (oper)=6.031e-05
rank=0 GPUmem(GB): used=6.063e-05 (oper,site)=6.031e-05,3.129e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=192
 no. of rintermediate operators=104
 no. of coefficients=2732:2.084e-02MB:2.035e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.456e-03 S -----
rank=0 GPUmem(GB): used=8.098e-05 (oper,site,rinter)=6.031e-05,3.129e-07,2.035e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 9.583e-03 S size(rtasks)=192 size(Rlst2)=9 T(Rmu/Rlist)=8.779e-04,8.705e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.695e-03 S size(rtasks)=192 size(Rlst)=817 -----
rank=0 GPUmem(GB): used=8.098e-05 avail=6.174e+00 total=6.174e+00 batch[need]=2.557e-04 blksize=16 blksize0=9 batchsize=817
rank=0 GPUmem(GB): used=3.366e-04 (oper,site,rinter,batch)=6.031e-05,3.129e-07,2.035e-05,2.557e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.811e-03,2.261e-02,9.978e-03
----- TIMING FOR renorm : t_inter=7.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=8 t=7.8e-03 per=1.9e+01 cost=3.8e+04 flops=4.9e+06
 renorm[gemm] counter=8 i=0 t=1.6e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=7.5e-03 per=1.9e+01 cost=4.6e+03 flops=6.1e+05
 renorm[gemm] counter=8 i=3 t=7.6e-03 per=1.9e+01 cost=2.6e+04 flops=3.4e+06
 renorm[gemm] counter=8 i=4 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=7.5e-03 per=1.9e+01 cost=4.9e+04 flops=6.5e+06
 renorm[gemm] counter=8 total t=2.3e-02 per=5.6e+01 cost=8.0e+04 flops=3.5e+06
 renorm[red] counter=8 t=1.0e-02 per=2.5e+01 cost=2.0e+04 flops=2.0e+06
----- TIMING FOR renorm_tot : t_inter=4.8e-02 t_gemm=1.8e-01 t_reduction=7.2e-02 tot=3.0e-01 -----
 renorm_tot[inter] counter=8 t=4.8e-02 per=1.6e+01 cost=1.1e+05 flops=2.3e+06
 renorm_tot[gemm] counter=8 i=0 t=1.4e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=1.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=5.9e-02 per=2.0e+01 cost=1.2e+04 flops=2.0e+05
 renorm_tot[gemm] counter=8 i=3 t=6.0e-02 per=2.0e+01 cost=4.6e+04 flops=7.7e+05
 renorm_tot[gemm] counter=8 i=4 t=1.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=5 t=1.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=6 t=5.6e-02 per=1.9e+01 cost=8.6e+04 flops=1.5e+06
 renorm_tot[gemm] counter=8 total t=1.8e-01 per=5.9e+01 cost=1.4e+05 flops=8.2e+05
 renorm_tot[red] counter=8 t=7.2e-02 per=2.4e+01 cost=4.0e+04 flops=5.5e+05
qops.to_cpu: size(tot)=4603:3.5e-02MB:3.4e-05GB T(to_cpu)=2.2e-04S speed=1.6e-01GB/S
check ||H-H.dagger||=7.854e-17 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0661 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.928e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.188e-04 change=-1.422e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 7.798e-02 S #####
 T(local oper_env: fetch) = 9.847e-03 S  per = 12.6  per(accum) = 12.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.6
 T(local oper_env: renrm) = 6.787e-02 S  per =   87  per(accum) = 99.7
 T(local oper_env: save ) = 2.615e-04 S  per = 0.335  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.787e-02 S  T(sum) = 6.787e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.028e-05 S  per = 0.0151  per(accum) = 0.0151
 T(local oper_env: qops init                    ) = 2.397e-03 S  per = 3.53  per(accum) = 3.55
 T(local oper_env: symbolic_formulae_renorm     ) = 4.055e-03 S  per = 5.97  per(accum) = 9.52
 T(local oper_env: allocate qops on gpu         ) = 6.271e-05 S  per = 0.0924  per(accum) = 9.61
 T(local oper_env: site memcpy cpu2gpu          ) = 1.577e-03 S  per = 2.32  per(accum) = 11.9
 T(local oper_env: rintermediate init           ) = 2.467e-03 S  per = 3.63  per(accum) = 15.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 9.726e-03 S  per = 14.3  per(accum) = 29.9
 T(local oper_env: rmmtasks init                ) = 4.988e-03 S  per = 7.35  per(accum) = 37.3
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 5.01e-05  per(accum) = 37.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.050e-02 S  per = 59.7  per(accum) = 96.9
 T(local oper_env: deallocate cpu and gpu memory) = 8.058e-05 S  per = 0.119  per(accum) = 97
 T(local oper_env: construct opS [ifdists=true] ) = 4.800e-08 S  per = 7.07e-05  per(accum) = 97
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 5.16e-05  per(accum) = 97
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.277e-04 S  per = 0.336  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 3.394e-05 S  per = 0.05  per(accum) = 97.4
 T(local oper_env: qops_pool join and erase     ) = 1.748e-03 S  per = 2.58  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.570e-07 S  per = 0.00112  per(accum) = 100
##### sweep oper_env: 5.178e-01 S #####
 T(sweep oper_env: fetch) = 8.273e-02 S  per =   16  per(accum) = 16
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16
 T(sweep oper_env: renrm) = 4.331e-01 S  per = 83.6  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.935e-03 S  per = 0.374  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.389e+10 S  per = -1.389e+32
 T(sweep oper_env: preprocess                  ) = -1.389e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.331e-01 S  T(sum) = 4.331e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.725e-05 S  per = 0.0178  per(accum) = 0.0178
 T(sweep oper_env: qops init                    ) = 8.696e-03 S  per = 2.01  per(accum) = 2.03
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.938e-02 S  per = 4.48  per(accum) = 6.5
 T(sweep oper_env: allocate qops on gpu         ) = 4.509e-04 S  per = 0.104  per(accum) = 6.61
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.132e-02 S  per = 2.61  per(accum) = 9.22
 T(sweep oper_env: rintermediate init           ) = 1.752e-02 S  per = 4.05  per(accum) = 13.3
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.235e-02 S  per = 9.78  per(accum) = 23
 T(sweep oper_env: rmmtasks init                ) = 2.115e-02 S  per = 4.88  per(accum) = 27.9
 T(sweep oper_env: qops memset on cpu           ) = 2.650e-07 S  per = 6.12e-05  per(accum) = 27.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.966e-01 S  per = 68.5  per(accum) = 96.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.373e-04 S  per = 0.101  per(accum) = 96.5
 T(sweep oper_env: construct opS [ifdists=true] ) = 5.140e-07 S  per = 0.000119  per(accum) = 96.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.040e-07 S  per = 7.02e-05  per(accum) = 96.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.082e-03 S  per = 0.25  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.516e-04 S  per = 0.0581  per(accum) = 96.8
 T(sweep oper_env: qops_pool join and erase     ) = 1.377e-02 S  per = 3.18  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 6.248e-06 S  per = 0.00144  per(accum) = 100

idx=9 coord=(10,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:9 S:11 A:81 B:90 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=4603:0.0351MB:3.43e-05GB
        per(mem): H:0.717 C:1.56 S:1.91 A:0 B:95.8 
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:10 A:100 B:110 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=13560:0.103MB:0.000101GB
        per(mem): H:0.516 C:1.47 S:1.47 A:0 B:96.5 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.259e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=231 : 4.458e-03 S -----
rank=0 GPUmem(GB): used=1.428e-04 (oper)=1.428e-04
rank=0 GPUmem(GB): used=1.435e-04 (oper,site)=1.428e-04,7.153e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=231
 no. of rintermediate operators=95
 no. of coefficients=3105:2.369e-02MB:2.313e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.489e-03 S -----
rank=0 GPUmem(GB): used=1.666e-04 (oper,site,rinter)=1.428e-04,7.153e-07,2.313e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.700e-02 S size(rtasks)=231 size(Rlst2)=25 T(Rmu/Rlist)=9.123e-04,2.609e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.770e-02 S size(rtasks)=231 size(Rlst)=2346 -----
rank=0 GPUmem(GB): used=1.666e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.556e-03 blksize=36 blksize0=16 batchsize=2346
rank=0 GPUmem(GB): used=1.722e-03 (oper,site,rinter,batch)=1.428e-04,7.153e-07,2.313e-05,1.556e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.250e-03,2.252e-02,9.817e-03
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.3e-02 t_reduction=9.8e-03 tot=4.0e-02 -----
 renorm[inter] counter=9 t=7.2e-03 per=1.8e+01 cost=3.8e+05 flops=5.2e+07
 renorm[gemm] counter=9 i=0 t=1.5e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=7.4e-03 per=1.9e+01 cost=1.3e+04 flops=1.7e+06
 renorm[gemm] counter=9 i=3 t=8.1e-03 per=2.1e+01 cost=1.5e+05 flops=1.9e+07
 renorm[gemm] counter=9 i=4 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=5 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=6 t=7.0e-03 per=1.8e+01 cost=2.4e+05 flops=3.4e+07
 renorm[gemm] counter=9 total t=2.3e-02 per=5.7e+01 cost=4.0e+05 flops=1.8e+07
 renorm[red] counter=9 t=9.8e-03 per=2.5e+01 cost=6.7e+04 flops=6.8e+06
----- TIMING FOR renorm_tot : t_inter=5.5e-02 t_gemm=2.0e-01 t_reduction=8.2e-02 tot=3.4e-01 -----
 renorm_tot[inter] counter=9 t=5.5e-02 per=1.6e+01 cost=4.9e+05 flops=8.8e+06
 renorm_tot[gemm] counter=9 i=0 t=1.6e-05 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=1.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=6.7e-02 per=2.0e+01 cost=2.4e+04 flops=3.6e+05
 renorm_tot[gemm] counter=9 i=3 t=6.8e-02 per=2.0e+01 cost=2.0e+05 flops=2.9e+06
 renorm_tot[gemm] counter=9 i=4 t=1.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=5 t=1.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=6 t=6.3e-02 per=1.9e+01 cost=3.2e+05 flops=5.1e+06
 renorm_tot[gemm] counter=9 total t=2.0e-01 per=5.9e+01 cost=5.5e+05 flops=2.8e+06
 renorm_tot[red] counter=9 t=8.2e-02 per=2.4e+01 cost=1.1e+05 flops=1.3e+06
----- TIMING FOR oper_renorm : 9.8e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=3.128e-04 change=8.449e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.564e-03 change=-1.858e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=16,16 size(op)=168:1.282e-03MB size(tot)=13560:1.035e-01MB:1.010e-04GB
        per(mem): H:0.516 C:1.47 S:1.47 P:0 Q:96.5 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.465e-03 change=4.638e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.465e-03 change=7.600e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=2.021e-04 avail=6.174e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=0 ifkr=1 maxsize=13090:9.753e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:110 
        dim(bra,ket)=16,16 size(op)=168:1.282e-03MB size(tot)=13090:9.987e-02MB:9.753e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.00308 tinit=0.00308
   copy opB to qops_tmps: dt=0.00181 tcopy=0.00181
   bcast: size(opB)=13090:9.75e-05GB dt=4.9e-08 speed=1.99e+03GB/s tcomm=4.9e-08
   compute opQ from opB: dt=0.00499 tcomp=0.00499
iproc=0
 qops_tmp: oplist=N nops=N:110 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=13090:0.0999MB:9.75e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.003 tinit=0.00607
   from opB to opB.H(): dt=0.00835 tadjt=0.00835
   bcast: size(opN)=13090:9.75e-05GB dt=4.9e-08 speed=1.99e+03GB/s tcomm=9.8e-08
   compute opQ from opB.H(): dt=0.00498 tcomp=0.00997
----- TIMING FOR oper_b2qGPU : 0.027 S T(init/copy/adjt+bcast/comp/rest)=0.00607,0.00181,0.00835,0.00997,0.000751 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.389e-03 change=1.088e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=2.021e-04 avail=6.174e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.282e-03 change=1.068e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=2.021e-04 avail=6.174e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.282e-03 change=-5.960e-08 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=2.021e-04 avail=6.174e+00 before move
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.282e-03 change=-4.649e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=1.010e-04 avail=6.174e+00 after move
check ||H-H.dagger||=5.617e-15 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0346 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00632,8.49e-05,1.02e-05,0.027,0,0.000471,0.00072 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.282e-03 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 1.433e-01 S #####
 T(local oper_env: fetch) = 9.073e-03 S  per = 6.33  per(accum) = 6.33
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 6.33
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 6.33
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 6.33
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 6.33
 T(local oper_env: renrm) = 1.339e-01 S  per = 93.4  per(accum) = 99.8
 T(local oper_env: save ) = 3.274e-04 S  per = 0.228  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.339e-01 S  T(sum) = 1.339e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.946e-06 S  per = 0.00668  per(accum) = 0.00668
 T(local oper_env: qops init                    ) = 6.380e-03 S  per = 4.77  per(accum) = 4.77
 T(local oper_env: symbolic_formulae_renorm     ) = 4.472e-03 S  per = 3.34  per(accum) = 8.11
 T(local oper_env: allocate qops on gpu         ) = 5.428e-05 S  per = 0.0405  per(accum) = 8.15
 T(local oper_env: site memcpy cpu2gpu          ) = 9.776e-04 S  per = 0.73  per(accum) = 8.88
 T(local oper_env: rintermediate init           ) = 2.501e-03 S  per = 1.87  per(accum) = 10.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.779e-02 S  per = 20.8  per(accum) = 31.5
 T(local oper_env: rmmtasks init                ) = 1.550e-02 S  per = 11.6  per(accum) = 43.1
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 2.46e-05  per(accum) = 43.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.969e-02 S  per = 29.6  per(accum) = 72.7
 T(local oper_env: deallocate cpu and gpu memory) = 1.572e-04 S  per = 0.117  per(accum) = 72.8
 T(local oper_env: construct opS [ifdists=true] ) = 5.000e-08 S  per = 3.73e-05  per(accum) = 72.8
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 2.61e-05  per(accum) = 72.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.000e-08 S  per = 2.24e-05  per(accum) = 72.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.430e-07 S  per = 0.000107  per(accum) = 72.8
 T(local oper_env: qops_pool join and erase     ) = 1.632e-03 S  per = 1.22  per(accum) = 74.1
 T(local oper_env: conversion from opAB to opPQ ) = 3.472e-02 S  per = 25.9  per(accum) = 100
##### sweep oper_env: 6.610e-01 S #####
 T(sweep oper_env: fetch) = 9.180e-02 S  per = 13.9  per(accum) = 13.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.9
 T(sweep oper_env: renrm) = 5.670e-01 S  per = 85.8  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.263e-03 S  per = 0.342  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.563e+10 S  per = -1.563e+32
 T(sweep oper_env: preprocess                  ) = -1.563e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.670e-01 S  T(sum) = 5.670e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 8.620e-05 S  per = 0.0152  per(accum) = 0.0152
 T(sweep oper_env: qops init                    ) = 1.508e-02 S  per = 2.66  per(accum) = 2.67
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.386e-02 S  per = 4.21  per(accum) = 6.88
 T(sweep oper_env: allocate qops on gpu         ) = 5.052e-04 S  per = 0.0891  per(accum) = 6.97
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.229e-02 S  per = 2.17  per(accum) = 9.14
 T(sweep oper_env: rintermediate init           ) = 2.003e-02 S  per = 3.53  per(accum) = 12.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 7.014e-02 S  per = 12.4  per(accum) = 25
 T(sweep oper_env: rmmtasks init                ) = 3.665e-02 S  per = 6.46  per(accum) = 31.5
 T(sweep oper_env: qops memset on cpu           ) = 2.980e-07 S  per = 5.26e-05  per(accum) = 31.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.363e-01 S  per = 59.3  per(accum) = 90.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.946e-04 S  per = 0.105  per(accum) = 90.9
 T(sweep oper_env: construct opS [ifdists=true] ) = 5.640e-07 S  per = 9.95e-05  per(accum) = 90.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.390e-07 S  per = 5.98e-05  per(accum) = 90.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.082e-03 S  per = 0.191  per(accum) = 91.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.518e-04 S  per = 0.0444  per(accum) = 91.2
 T(sweep oper_env: qops_pool join and erase     ) = 1.541e-02 S  per = 2.72  per(accum) = 93.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.472e-02 S  per = 6.12  per(accum) = 100

idx=10 coord=(9,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=13560:0.103MB:0.000101GB
        per(mem): H:0.516 C:1.47 S:1.47 P:0 Q:96.5 
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=11706:0.0893MB:8.72e-05GB
        per(mem): H:0.607 C:2.44 S:2 P:0 Q:95 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.457e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=192 : 6.907e-03 S -----
rank=0 GPUmem(GB): used=1.957e-04 (oper)=1.957e-04
rank=0 GPUmem(GB): used=1.968e-04 (oper,site)=1.957e-04,1.132e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=192
 no. of rintermediate operators=288
 no. of coefficients=2880:2.197e-02MB:2.146e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.530e-03 S -----
rank=0 GPUmem(GB): used=2.183e-04 (oper,site,rinter)=1.957e-04,1.132e-06,2.146e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.070e-01 S size(rtasks)=192 size(Rlst2)=49 T(Rmu/Rlist)=1.902e-03,1.051e-01 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.082e-01 S size(rtasks)=192 size(Rlst)=7539 -----
rank=0 GPUmem(GB): used=2.183e-04 avail=6.174e+00 total=6.174e+00 batch[need]=3.763e-03 blksize=30 blksize0=6 batchsize=7539
rank=0 GPUmem(GB): used=3.982e-03 (oper,site,rinter,batch)=1.957e-04,1.132e-06,2.146e-05,3.763e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.465e-03,2.299e-02,1.011e-02
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=10 t=6.5e-03 per=1.6e+01 cost=2.4e+05 flops=3.7e+07
 renorm[gemm] counter=10 i=0 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=7.6e-03 per=1.9e+01 cost=4.5e+04 flops=6.0e+06
 renorm[gemm] counter=10 i=3 t=7.6e-03 per=1.9e+01 cost=3.6e+05 flops=4.7e+07
 renorm[gemm] counter=10 i=4 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=5 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=6 t=7.8e-03 per=2.0e+01 cost=6.5e+05 flops=8.3e+07
 renorm[gemm] counter=10 total t=2.3e-02 per=5.8e+01 cost=1.0e+06 flops=4.6e+07
 renorm[red] counter=10 t=1.0e-02 per=2.6e+01 cost=1.7e+05 flops=1.7e+07
----- TIMING FOR renorm_tot : t_inter=6.2e-02 t_gemm=2.2e-01 t_reduction=9.2e-02 tot=3.7e-01 -----
 renorm_tot[inter] counter=10 t=6.2e-02 per=1.6e+01 cost=7.3e+05 flops=1.2e+07
 renorm_tot[gemm] counter=10 i=0 t=1.7e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=7.4e-02 per=2.0e+01 cost=6.9e+04 flops=9.4e+05
 renorm_tot[gemm] counter=10 i=3 t=7.6e-02 per=2.0e+01 cost=5.6e+05 flops=7.3e+06
 renorm_tot[gemm] counter=10 i=4 t=1.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=5 t=1.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=6 t=7.1e-02 per=1.9e+01 cost=9.7e+05 flops=1.4e+07
 renorm_tot[gemm] counter=10 total t=2.2e-01 per=5.9e+01 cost=1.6e+06 flops=7.2e+06
 renorm_tot[red] counter=10 t=9.2e-02 per=2.5e+01 cost=2.8e+05 flops=3.0e+06
qops.to_cpu: size(tot)=11706:8.9e-02MB:8.7e-05GB T(to_cpu)=2.3e-04S speed=3.8e-01GB/S
check ||H-H.dagger||=7.199e-15 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.225 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=3.113e-03 change=2.173e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.257e-03 change=-3.420e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 2.360e-01 S #####
 T(local oper_env: fetch) = 8.995e-03 S  per = 3.81  per(accum) = 3.81
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.81
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.81
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.81
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.81
 T(local oper_env: renrm) = 2.267e-01 S  per = 96.1  per(accum) = 99.9
 T(local oper_env: save ) = 2.826e-04 S  per = 0.12  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.267e-01 S  T(sum) = 2.267e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.453e-06 S  per = 0.00373  per(accum) = 0.00373
 T(local oper_env: qops init                    ) = 1.023e-02 S  per = 4.51  per(accum) = 4.52
 T(local oper_env: symbolic_formulae_renorm     ) = 6.920e-03 S  per = 3.05  per(accum) = 7.57
 T(local oper_env: allocate qops on gpu         ) = 5.384e-05 S  per = 0.0237  per(accum) = 7.59
 T(local oper_env: site memcpy cpu2gpu          ) = 1.470e-03 S  per = 0.649  per(accum) = 8.24
 T(local oper_env: rintermediate init           ) = 2.541e-03 S  per = 1.12  per(accum) = 9.36
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.085e-01 S  per = 47.9  per(accum) = 57.2
 T(local oper_env: rmmtasks init                ) = 5.450e-02 S  per =   24  per(accum) = 81.3
 T(local oper_env: qops memset on cpu           ) = 5.100e-08 S  per = 2.25e-05  per(accum) = 81.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.967e-02 S  per = 17.5  per(accum) = 98.8
 T(local oper_env: deallocate cpu and gpu memory) = 4.060e-04 S  per = 0.179  per(accum) = 98.9
 T(local oper_env: construct opS [ifdists=true] ) = 5.100e-08 S  per = 2.25e-05  per(accum) = 98.9
 T(local oper_env: reduction of opS & opH [nccl]) = 3.400e-08 S  per = 1.5e-05  per(accum) = 98.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.442e-04 S  per = 0.108  per(accum) = 99.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.039e-04 S  per = 0.0458  per(accum) = 99.1
 T(local oper_env: qops_pool join and erase     ) = 2.042e-03 S  per = 0.901  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.730e-07 S  per = 0.000341  per(accum) = 100
##### sweep oper_env: 8.970e-01 S #####
 T(sweep oper_env: fetch) = 1.008e-01 S  per = 11.2  per(accum) = 11.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: renrm) = 7.937e-01 S  per = 88.5  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.545e-03 S  per = 0.284  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+10 S  per = -1.737e+32
 T(sweep oper_env: preprocess                  ) = -1.737e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.937e-01 S  T(sum) = 7.937e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.465e-05 S  per = 0.0119  per(accum) = 0.0119
 T(sweep oper_env: qops init                    ) = 2.531e-02 S  per = 3.19  per(accum) = 3.2
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.078e-02 S  per = 3.88  per(accum) = 7.08
 T(sweep oper_env: allocate qops on gpu         ) = 5.590e-04 S  per = 0.0704  per(accum) = 7.15
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.376e-02 S  per = 1.73  per(accum) = 8.88
 T(sweep oper_env: rintermediate init           ) = 2.257e-02 S  per = 2.84  per(accum) = 11.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.787e-01 S  per = 22.5  per(accum) = 34.2
 T(sweep oper_env: rmmtasks init                ) = 9.115e-02 S  per = 11.5  per(accum) = 45.7
 T(sweep oper_env: qops memset on cpu           ) = 3.490e-07 S  per = 4.4e-05  per(accum) = 45.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.760e-01 S  per = 47.4  per(accum) = 93.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.001e-03 S  per = 0.126  per(accum) = 93.2
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.150e-07 S  per = 7.75e-05  per(accum) = 93.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.730e-07 S  per = 4.7e-05  per(accum) = 93.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.327e-03 S  per = 0.167  per(accum) = 93.4
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.557e-04 S  per = 0.0448  per(accum) = 93.4
 T(sweep oper_env: qops_pool join and erase     ) = 1.745e-02 S  per =  2.2  per(accum) = 95.6
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.472e-02 S  per = 4.37  per(accum) = 100

idx=11 coord=(8,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=11706:0.0893MB:8.72e-05GB
        per(mem): H:0.607 C:2.44 S:2 P:0 Q:95 
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=9483:0.0723MB:7.07e-05GB
        per(mem): H:0.749 C:3.29 S:2.19 P:0 Q:93.8 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.337e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=157 : 5.749e-03 S -----
rank=0 GPUmem(GB): used=1.653e-04 (oper)=1.653e-04
rank=0 GPUmem(GB): used=1.660e-04 (oper,site)=1.653e-04,7.227e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=157
 no. of rintermediate operators=232
 no. of coefficients=2552:1.947e-02MB:1.901e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.498e-03 S -----
rank=0 GPUmem(GB): used=1.850e-04 (oper,site,rinter)=1.653e-04,7.227e-07,1.901e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.364e-02 S size(rtasks)=157 size(Rlst2)=49 T(Rmu/Rlist)=1.498e-03,7.214e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.447e-02 S size(rtasks)=157 size(Rlst)=4546 -----
rank=0 GPUmem(GB): used=1.850e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.897e-03 blksize=25 blksize0=5 batchsize=4546
rank=0 GPUmem(GB): used=2.082e-03 (oper,site,rinter,batch)=1.653e-04,7.227e-07,1.901e-05,1.897e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.295e-03,2.576e-02,9.200e-03
----- TIMING FOR renorm : t_inter=6.3e-03 t_gemm=2.6e-02 t_reduction=9.2e-03 tot=4.1e-02 -----
 renorm[inter] counter=11 t=6.3e-03 per=1.5e+01 cost=1.2e+05 flops=2.0e+07
 renorm[gemm] counter=11 i=0 t=1.5e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=7.7e-03 per=1.9e+01 cost=2.9e+04 flops=3.8e+06
 renorm[gemm] counter=11 i=3 t=7.6e-03 per=1.8e+01 cost=1.2e+05 flops=1.6e+07
 renorm[gemm] counter=11 i=4 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=5 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=6 t=1.0e-02 per=2.5e+01 cost=3.3e+05 flops=3.2e+07
 renorm[gemm] counter=11 total t=2.6e-02 per=6.2e+01 cost=4.8e+05 flops=1.9e+07
 renorm[red] counter=11 t=9.2e-03 per=2.2e+01 cost=1.5e+05 flops=1.6e+07
----- TIMING FOR renorm_tot : t_inter=6.8e-02 t_gemm=2.5e-01 t_reduction=1.0e-01 tot=4.2e-01 -----
 renorm_tot[inter] counter=11 t=6.8e-02 per=1.6e+01 cost=8.5e+05 flops=1.3e+07
 renorm_tot[gemm] counter=11 i=0 t=1.9e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=8.2e-02 per=2.0e+01 cost=9.8e+04 flops=1.2e+06
 renorm_tot[gemm] counter=11 i=3 t=8.4e-02 per=2.0e+01 cost=6.8e+05 flops=8.1e+06
 renorm_tot[gemm] counter=11 i=4 t=1.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=5 t=1.4e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=6 t=8.2e-02 per=2.0e+01 cost=1.3e+06 flops=1.6e+07
 renorm_tot[gemm] counter=11 total t=2.5e-01 per=5.9e+01 cost=2.1e+06 flops=8.4e+06
 renorm_tot[red] counter=11 t=1.0e-01 per=2.4e+01 cost=4.3e+05 flops=4.2e+06
qops.to_cpu: size(tot)=9483:7.2e-02MB:7.1e-05GB T(to_cpu)=6.0e-04S speed=1.2e-01GB/S
check ||H-H.dagger||=1.265e-18 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.168 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=9.384e-04 change=1.427e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.212e-03 change=-2.880e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 1.811e-01 S #####
 T(local oper_env: fetch) = 8.981e-03 S  per = 4.96  per(accum) = 4.96
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 4.96
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 4.96
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 4.96
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 4.96
 T(local oper_env: renrm) = 1.718e-01 S  per = 94.9  per(accum) = 99.8
 T(local oper_env: save ) = 2.879e-04 S  per = 0.159  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.718e-01 S  T(sum) = 1.718e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.686e-06 S  per = 0.00506  per(accum) = 0.00506
 T(local oper_env: qops init                    ) = 8.342e-03 S  per = 4.86  per(accum) = 4.86
 T(local oper_env: symbolic_formulae_renorm     ) = 5.761e-03 S  per = 3.35  per(accum) = 8.21
 T(local oper_env: allocate qops on gpu         ) = 5.331e-05 S  per = 0.031  per(accum) = 8.25
 T(local oper_env: site memcpy cpu2gpu          ) = 1.098e-03 S  per = 0.639  per(accum) = 8.88
 T(local oper_env: rintermediate init           ) = 2.509e-03 S  per = 1.46  per(accum) = 10.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.463e-02 S  per = 43.4  per(accum) = 53.8
 T(local oper_env: rmmtasks init                ) = 3.208e-02 S  per = 18.7  per(accum) = 72.5
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 1.98e-05  per(accum) = 72.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.135e-02 S  per = 24.1  per(accum) = 96.5
 T(local oper_env: deallocate cpu and gpu memory) = 1.777e-03 S  per = 1.03  per(accum) = 97.6
 T(local oper_env: construct opS [ifdists=true] ) = 1.870e-07 S  per = 0.000109  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 1.86e-05  per(accum) = 97.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 6.116e-04 S  per = 0.356  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.124e-04 S  per = 0.0654  per(accum) = 98
 T(local oper_env: qops_pool join and erase     ) = 3.455e-03 S  per = 2.01  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.080e-07 S  per = 0.000412  per(accum) = 100
##### sweep oper_env: 1.078e+00 S #####
 T(sweep oper_env: fetch) = 1.098e-01 S  per = 10.2  per(accum) = 10.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: renrm) = 9.655e-01 S  per = 89.6  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.833e-03 S  per = 0.263  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.910e+10 S  per = -1.910e+32
 T(sweep oper_env: preprocess                  ) = -1.910e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.655e-01 S  T(sum) = 9.655e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.033e-04 S  per = 0.0107  per(accum) = 0.0107
 T(sweep oper_env: qops init                    ) = 3.365e-02 S  per = 3.49  per(accum) = 3.5
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.654e-02 S  per = 3.78  per(accum) = 7.28
 T(sweep oper_env: allocate qops on gpu         ) = 6.123e-04 S  per = 0.0634  per(accum) = 7.34
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.486e-02 S  per = 1.54  per(accum) = 8.88
 T(sweep oper_env: rintermediate init           ) = 2.508e-02 S  per =  2.6  per(accum) = 11.5
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.533e-01 S  per = 26.2  per(accum) = 37.7
 T(sweep oper_env: rmmtasks init                ) = 1.232e-01 S  per = 12.8  per(accum) = 50.5
 T(sweep oper_env: qops memset on cpu           ) = 3.830e-07 S  per = 3.97e-05  per(accum) = 50.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.173e-01 S  per = 43.2  per(accum) = 93.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.778e-03 S  per = 0.288  per(accum) = 94
 T(sweep oper_env: construct opS [ifdists=true] ) = 8.020e-07 S  per = 8.31e-05  per(accum) = 94
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.050e-07 S  per = 4.19e-05  per(accum) = 94
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.938e-03 S  per = 0.201  per(accum) = 94.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.681e-04 S  per = 0.0485  per(accum) = 94.2
 T(sweep oper_env: qops_pool join and erase     ) = 2.090e-02 S  per = 2.16  per(accum) = 96.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.472e-02 S  per =  3.6  per(accum) = 100

idx=12 coord=(7,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=9483:0.0723MB:7.07e-05GB
        per(mem): H:0.749 C:3.29 S:2.19 P:0 Q:93.8 
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=7507:0.0573MB:5.59e-05GB
        per(mem): H:0.946 C:4.5 S:2.42 P:0 Q:92.1 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.230e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=126 : 5.096e-03 S -----
rank=0 GPUmem(GB): used=1.340e-04 (oper)=1.340e-04
rank=0 GPUmem(GB): used=1.347e-04 (oper,site)=1.340e-04,7.227e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=126
 no. of rintermediate operators=182
 no. of coefficients=2184:1.666e-02MB:1.627e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.485e-03 S -----
rank=0 GPUmem(GB): used=1.510e-04 (oper,site,rinter)=1.340e-04,7.227e-07,1.627e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.016e-02 S size(rtasks)=126 size(Rlst2)=49 T(Rmu/Rlist)=1.210e-03,5.895e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.085e-02 S size(rtasks)=126 size(Rlst)=3650 -----
rank=0 GPUmem(GB): used=1.510e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.523e-03 blksize=25 blksize0=5 batchsize=3650
rank=0 GPUmem(GB): used=1.674e-03 (oper,site,rinter,batch)=1.340e-04,7.227e-07,1.627e-05,1.523e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.514e-03,2.264e-02,9.961e-03
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=12 t=5.5e-03 per=1.4e+01 cost=1.1e+05 flops=1.9e+07
 renorm[gemm] counter=12 i=0 t=1.5e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=7.6e-03 per=2.0e+01 cost=2.4e+04 flops=3.1e+06
 renorm[gemm] counter=12 i=3 t=7.5e-03 per=2.0e+01 cost=9.5e+04 flops=1.3e+07
 renorm[gemm] counter=12 i=4 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=5 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=6 t=7.6e-03 per=2.0e+01 cost=2.7e+05 flops=3.5e+07
 renorm[gemm] counter=12 total t=2.3e-02 per=5.9e+01 cost=3.8e+05 flops=1.7e+07
 renorm[red] counter=12 t=1.0e-02 per=2.6e+01 cost=1.2e+05 flops=1.2e+07
----- TIMING FOR renorm_tot : t_inter=7.3e-02 t_gemm=2.7e-01 t_reduction=1.1e-01 tot=4.5e-01 -----
 renorm_tot[inter] counter=12 t=7.3e-02 per=1.6e+01 cost=9.6e+05 flops=1.3e+07
 renorm_tot[gemm] counter=12 i=0 t=2.0e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=8.9e-02 per=2.0e+01 cost=1.2e+05 flops=1.4e+06
 renorm_tot[gemm] counter=12 i=3 t=9.1e-02 per=2.0e+01 cost=7.7e+05 flops=8.5e+06
 renorm_tot[gemm] counter=12 i=4 t=1.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=5 t=1.5e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=6 t=8.9e-02 per=2.0e+01 cost=1.6e+06 flops=1.8e+07
 renorm_tot[gemm] counter=12 total t=2.7e-01 per=5.9e+01 cost=2.5e+06 flops=9.1e+06
 renorm_tot[red] counter=12 t=1.1e-01 per=2.4e+01 cost=5.5e+05 flops=4.9e+06
qops.to_cpu: size(tot)=7507:5.7e-02MB:5.6e-05GB T(to_cpu)=1.6e-04S speed=3.4e-01GB/S
check ||H-H.dagger||=9.204e-19 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.141 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=6.561e-04 change=1.155e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.495e-03 change=-2.491e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 1.524e-01 S #####
 T(local oper_env: fetch) = 9.030e-03 S  per = 5.92  per(accum) = 5.92
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 5.92
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 5.92
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 5.92
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 5.92
 T(local oper_env: renrm) = 1.431e-01 S  per = 93.9  per(accum) = 99.8
 T(local oper_env: save ) = 2.615e-04 S  per = 0.172  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.431e-01 S  T(sum) = 1.431e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.972e-06 S  per = 0.00627  per(accum) = 0.00627
 T(local oper_env: qops init                    ) = 6.747e-03 S  per = 4.71  per(accum) = 4.72
 T(local oper_env: symbolic_formulae_renorm     ) = 5.111e-03 S  per = 3.57  per(accum) = 8.29
 T(local oper_env: allocate qops on gpu         ) = 5.441e-05 S  per = 0.038  per(accum) = 8.33
 T(local oper_env: site memcpy cpu2gpu          ) = 1.675e-03 S  per = 1.17  per(accum) = 9.5
 T(local oper_env: rintermediate init           ) = 2.496e-03 S  per = 1.74  per(accum) = 11.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.102e-02 S  per = 42.6  per(accum) = 53.9
 T(local oper_env: rmmtasks init                ) = 2.530e-02 S  per = 17.7  per(accum) = 71.6
 T(local oper_env: qops memset on cpu           ) = 4.000e-08 S  per = 2.79e-05  per(accum) = 71.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.822e-02 S  per = 26.7  per(accum) = 98.3
 T(local oper_env: deallocate cpu and gpu memory) = 1.873e-04 S  per = 0.131  per(accum) = 98.4
 T(local oper_env: construct opS [ifdists=true] ) = 4.800e-08 S  per = 3.35e-05  per(accum) = 98.4
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 2.45e-05  per(accum) = 98.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.739e-04 S  per = 0.121  per(accum) = 98.5
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.008e-04 S  per = 0.0704  per(accum) = 98.6
 T(local oper_env: qops_pool join and erase     ) = 2.031e-03 S  per = 1.42  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.550e-07 S  per = 0.000528  per(accum) = 100
##### sweep oper_env: 1.231e+00 S #####
 T(sweep oper_env: fetch) = 1.188e-01 S  per = 9.65  per(accum) = 9.65
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.65
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.65
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.65
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.65
 T(sweep oper_env: renrm) = 1.109e+00 S  per = 90.1  per(accum) = 99.7
 T(sweep oper_env: save ) = 3.094e-03 S  per = 0.251  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.084e+10 S  per = -2.084e+32
 T(sweep oper_env: preprocess                  ) = -2.084e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.109e+00 S  T(sum) = 1.109e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.123e-04 S  per = 0.0101  per(accum) = 0.0101
 T(sweep oper_env: qops init                    ) = 4.040e-02 S  per = 3.64  per(accum) = 3.65
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.165e-02 S  per = 3.76  per(accum) = 7.41
 T(sweep oper_env: allocate qops on gpu         ) = 6.667e-04 S  per = 0.0601  per(accum) = 7.47
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.654e-02 S  per = 1.49  per(accum) = 8.96
 T(sweep oper_env: rintermediate init           ) = 2.757e-02 S  per = 2.49  per(accum) = 11.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.143e-01 S  per = 28.4  per(accum) = 39.8
 T(sweep oper_env: rmmtasks init                ) = 1.485e-01 S  per = 13.4  per(accum) = 53.2
 T(sweep oper_env: qops memset on cpu           ) = 4.230e-07 S  per = 3.82e-05  per(accum) = 53.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.555e-01 S  per = 41.1  per(accum) = 94.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.965e-03 S  per = 0.267  per(accum) = 94.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 8.500e-07 S  per = 7.67e-05  per(accum) = 94.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.400e-07 S  per = 3.97e-05  per(accum) = 94.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.112e-03 S  per = 0.191  per(accum) = 94.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 5.688e-04 S  per = 0.0513  per(accum) = 94.8
 T(sweep oper_env: qops_pool join and erase     ) = 2.293e-02 S  per = 2.07  per(accum) = 96.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per = 3.13  per(accum) = 100

idx=13 coord=(6,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=7507:0.0573MB:5.59e-05GB
        per(mem): H:0.946 C:4.5 S:2.42 P:0 Q:92.1 
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=4483:0.0342MB:3.34e-05GB
        per(mem): H:1.18 C:6.87 S:2.94 P:0 Q:89 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.137e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=99 : 4.070e-03 S -----
rank=0 GPUmem(GB): used=9.677e-05 (oper)=9.677e-05
rank=0 GPUmem(GB): used=9.777e-05 (oper,site)=9.677e-05,9.984e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=99
 no. of rintermediate operators=138
 no. of coefficients=1794:1.369e-02MB:1.337e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.457e-03 S -----
rank=0 GPUmem(GB): used=1.111e-04 (oper,site,rinter)=9.677e-05,9.984e-07,1.337e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.168e-02 S size(rtasks)=99 size(Rlst2)=49 T(Rmu/Rlist)=9.265e-04,7.076e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.258e-02 S size(rtasks)=99 size(Rlst)=4942 -----
rank=0 GPUmem(GB): used=1.111e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.694e-03 blksize=20 blksize0=5 batchsize=4942
rank=0 GPUmem(GB): used=1.805e-03 (oper,site,rinter,batch)=9.677e-05,9.984e-07,1.337e-05,1.694e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.080e-03,2.276e-02,1.016e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=13 t=7.1e-03 per=1.8e+01 cost=1.8e+05 flops=2.5e+07
 renorm[gemm] counter=13 i=0 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=7.6e-03 per=1.9e+01 cost=2.3e+04 flops=3.1e+06
 renorm[gemm] counter=13 i=3 t=7.6e-03 per=1.9e+01 cost=1.5e+05 flops=1.9e+07
 renorm[gemm] counter=13 i=4 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=5 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=6 t=7.6e-03 per=1.9e+01 cost=2.4e+05 flops=3.1e+07
 renorm[gemm] counter=13 total t=2.3e-02 per=5.7e+01 cost=4.1e+05 flops=1.8e+07
 renorm[red] counter=13 t=1.0e-02 per=2.5e+01 cost=7.2e+04 flops=7.1e+06
----- TIMING FOR renorm_tot : t_inter=8.0e-02 t_gemm=2.9e-01 t_reduction=1.2e-01 tot=4.9e-01 -----
 renorm_tot[inter] counter=13 t=8.0e-02 per=1.6e+01 cost=1.1e+06 flops=1.4e+07
 renorm_tot[gemm] counter=13 i=0 t=2.2e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=9.7e-02 per=2.0e+01 cost=1.5e+05 flops=1.5e+06
 renorm_tot[gemm] counter=13 i=3 t=9.9e-02 per=2.0e+01 cost=9.2e+05 flops=9.3e+06
 renorm_tot[gemm] counter=13 i=4 t=1.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=5 t=1.7e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=6 t=9.7e-02 per=2.0e+01 cost=1.8e+06 flops=1.9e+07
 renorm_tot[gemm] counter=13 total t=2.9e-01 per=5.9e+01 cost=2.9e+06 flops=9.8e+06
 renorm_tot[red] counter=13 t=1.2e-01 per=2.5e+01 cost=6.2e+05 flops=5.1e+06
qops.to_cpu: size(tot)=4483:3.4e-02MB:3.3e-05GB T(to_cpu)=1.3e-04S speed=2.5e-01GB/S
check ||H-H.dagger||=6.281e-16 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.163 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.656e-03 change=1.397e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.441e-03 change=-2.610e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 1.740e-01 S #####
 T(local oper_env: fetch) = 9.001e-03 S  per = 5.17  per(accum) = 5.17
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 5.17
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 5.17
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 5.17
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 5.17
 T(local oper_env: renrm) = 1.648e-01 S  per = 94.7  per(accum) = 99.9
 T(local oper_env: save ) = 2.551e-04 S  per = 0.147  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.648e-01 S  T(sum) = 1.648e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.459e-06 S  per = 0.00513  per(accum) = 0.00513
 T(local oper_env: qops init                    ) = 5.283e-03 S  per = 3.21  per(accum) = 3.21
 T(local oper_env: symbolic_formulae_renorm     ) = 4.084e-03 S  per = 2.48  per(accum) = 5.69
 T(local oper_env: allocate qops on gpu         ) = 5.411e-05 S  per = 0.0328  per(accum) = 5.72
 T(local oper_env: site memcpy cpu2gpu          ) = 2.005e-03 S  per = 1.22  per(accum) = 6.94
 T(local oper_env: rintermediate init           ) = 2.468e-03 S  per =  1.5  per(accum) = 8.44
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.275e-02 S  per = 44.2  per(accum) = 52.6
 T(local oper_env: rmmtasks init                ) = 3.514e-02 S  per = 21.3  per(accum) = 73.9
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 2.06e-05  per(accum) = 73.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.010e-02 S  per = 24.3  per(accum) = 98.3
 T(local oper_env: deallocate cpu and gpu memory) = 7.941e-04 S  per = 0.482  per(accum) = 98.7
 T(local oper_env: construct opS [ifdists=true] ) = 1.040e-07 S  per = 6.31e-05  per(accum) = 98.7
 T(local oper_env: reduction of opS & opH [nccl]) = 4.200e-08 S  per = 2.55e-05  per(accum) = 98.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.461e-04 S  per = 0.0887  per(accum) = 98.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 9.443e-05 S  per = 0.0573  per(accum) = 98.9
 T(local oper_env: qops_pool join and erase     ) = 1.828e-03 S  per = 1.11  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.700e-07 S  per = 0.000467  per(accum) = 100
##### sweep oper_env: 1.405e+00 S #####
 T(sweep oper_env: fetch) = 1.278e-01 S  per =  9.1  per(accum) = 9.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.1
 T(sweep oper_env: renrm) = 1.273e+00 S  per = 90.7  per(accum) = 99.8
 T(sweep oper_env: save ) = 3.350e-03 S  per = 0.238  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.258e+10 S  per = -2.258e+32
 T(sweep oper_env: preprocess                  ) = -2.258e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.273e+00 S  T(sum) = 1.273e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.208e-04 S  per = 0.00948  per(accum) = 0.00948
 T(sweep oper_env: qops init                    ) = 4.568e-02 S  per = 3.59  per(accum) = 3.6
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.573e-02 S  per = 3.59  per(accum) = 7.19
 T(sweep oper_env: allocate qops on gpu         ) = 7.208e-04 S  per = 0.0566  per(accum) = 7.24
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.854e-02 S  per = 1.46  per(accum) = 8.7
 T(sweep oper_env: rintermediate init           ) = 3.004e-02 S  per = 2.36  per(accum) = 11.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.871e-01 S  per = 30.4  per(accum) = 41.5
 T(sweep oper_env: rmmtasks init                ) = 1.837e-01 S  per = 14.4  per(accum) = 55.9
 T(sweep oper_env: qops memset on cpu           ) = 4.570e-07 S  per = 3.59e-05  per(accum) = 55.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.956e-01 S  per = 38.9  per(accum) = 94.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.759e-03 S  per = 0.295  per(accum) = 95.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 9.540e-07 S  per = 7.49e-05  per(accum) = 95.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.820e-07 S  per = 3.79e-05  per(accum) = 95.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.258e-03 S  per = 0.177  per(accum) = 95.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 6.633e-04 S  per = 0.0521  per(accum) = 95.3
 T(sweep oper_env: qops_pool join and erase     ) = 2.476e-02 S  per = 1.94  per(accum) = 97.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per = 2.73  per(accum) = 100

idx=14 coord=(5,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=4483:0.0342MB:3.34e-05GB
        per(mem): H:1.18 C:6.87 S:2.94 P:0 Q:89 
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=2439:0.0186MB:1.82e-05GB
        per(mem): H:1.6 C:11.1 S:3.69 P:0 Q:83.6 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.058e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 3.070e-03 S -----
rank=0 GPUmem(GB): used=5.901e-05 (oper)=5.901e-05
rank=0 GPUmem(GB): used=5.975e-05 (oper,site)=5.901e-05,7.451e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=76
 no. of rintermediate operators=100
 no. of coefficients=1400:1.068e-02MB:1.043e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.477e-03 S -----
rank=0 GPUmem(GB): used=7.018e-05 (oper,site,rinter)=5.901e-05,7.451e-07,1.043e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 5.620e-02 S size(rtasks)=76 size(Rlst2)=49 T(Rmu/Rlist)=6.886e-04,5.551e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.683e-02 S size(rtasks)=76 size(Rlst)=3836 -----
rank=0 GPUmem(GB): used=7.018e-05 avail=6.174e+00 total=6.174e+00 batch[need]=8.288e-04 blksize=12 blksize0=4 batchsize=3836
rank=0 GPUmem(GB): used=8.990e-04 (oper,site,rinter,batch)=5.901e-05,7.451e-07,1.043e-05,8.288e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.478e-03,2.300e-02,1.014e-02
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=14 t=5.5e-03 per=1.4e+01 cost=1.2e+05 flops=2.1e+07
 renorm[gemm] counter=14 i=0 t=1.5e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=7.7e-03 per=2.0e+01 cost=1.3e+04 flops=1.7e+06
 renorm[gemm] counter=14 i=3 t=7.6e-03 per=2.0e+01 cost=6.9e+04 flops=9.0e+06
 renorm[gemm] counter=14 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=5 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=6 t=7.7e-03 per=2.0e+01 cost=1.1e+05 flops=1.4e+07
 renorm[gemm] counter=14 total t=2.3e-02 per=6.0e+01 cost=1.9e+05 flops=8.2e+06
 renorm[red] counter=14 t=1.0e-02 per=2.6e+01 cost=3.8e+04 flops=3.8e+06
----- TIMING FOR renorm_tot : t_inter=8.6e-02 t_gemm=3.2e-01 t_reduction=1.3e-01 tot=5.3e-01 -----
 renorm_tot[inter] counter=14 t=8.6e-02 per=1.6e+01 cost=1.2e+06 flops=1.5e+07
 renorm_tot[gemm] counter=14 i=0 t=2.3e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=1.0e-01 per=2.0e+01 cost=1.6e+05 flops=1.5e+06
 renorm_tot[gemm] counter=14 i=3 t=1.1e-01 per=2.0e+01 cost=9.9e+05 flops=9.3e+06
 renorm_tot[gemm] counter=14 i=4 t=1.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=5 t=1.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=6 t=1.0e-01 per=2.0e+01 cost=1.9e+06 flops=1.8e+07
 renorm_tot[gemm] counter=14 total t=3.2e-01 per=5.9e+01 cost=3.1e+06 flops=9.7e+06
 renorm_tot[red] counter=14 t=1.3e-01 per=2.5e+01 cost=6.6e+05 flops=5.0e+06
qops.to_cpu: size(tot)=2439:1.9e-02MB:1.8e-05GB T(to_cpu)=1.1e-04S speed=1.7e-01GB/S
check ||H-H.dagger||=1.151e-17 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.135 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.068e-04 change=1.062e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.854e-03 change=-2.198e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 1.457e-01 S #####
 T(local oper_env: fetch) = 9.060e-03 S  per = 6.22  per(accum) = 6.22
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 6.22
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 6.22
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 6.22
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 6.22
 T(local oper_env: renrm) = 1.363e-01 S  per = 93.6  per(accum) = 99.8
 T(local oper_env: save ) = 2.529e-04 S  per = 0.174  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.363e-01 S  T(sum) = 1.363e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.482e-06 S  per = 0.00622  per(accum) = 0.00622
 T(local oper_env: qops init                    ) = 4.146e-03 S  per = 3.04  per(accum) = 3.05
 T(local oper_env: symbolic_formulae_renorm     ) = 3.083e-03 S  per = 2.26  per(accum) = 5.31
 T(local oper_env: allocate qops on gpu         ) = 5.283e-05 S  per = 0.0387  per(accum) = 5.35
 T(local oper_env: site memcpy cpu2gpu          ) = 1.520e-03 S  per = 1.12  per(accum) = 6.46
 T(local oper_env: rintermediate init           ) = 2.488e-03 S  per = 1.82  per(accum) = 8.29
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.696e-02 S  per = 41.8  per(accum) = 50.1
 T(local oper_env: rmmtasks init                ) = 2.729e-02 S  per =   20  per(accum) = 70.1
 T(local oper_env: qops memset on cpu           ) = 2.600e-08 S  per = 1.91e-05  per(accum) = 70.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.871e-02 S  per = 28.4  per(accum) = 98.5
 T(local oper_env: deallocate cpu and gpu memory) = 1.759e-04 S  per = 0.129  per(accum) = 98.6
 T(local oper_env: construct opS [ifdists=true] ) = 4.900e-08 S  per = 3.59e-05  per(accum) = 98.6
 T(local oper_env: reduction of opS & opH [nccl]) = 3.400e-08 S  per = 2.49e-05  per(accum) = 98.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.212e-04 S  per = 0.0889  per(accum) = 98.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 9.378e-05 S  per = 0.0688  per(accum) = 98.8
 T(local oper_env: qops_pool join and erase     ) = 1.701e-03 S  per = 1.25  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.160e-07 S  per = 0.000525  per(accum) = 100
##### sweep oper_env: 1.550e+00 S #####
 T(sweep oper_env: fetch) = 1.369e-01 S  per = 8.83  per(accum) = 8.83
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.83
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.83
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.83
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.83
 T(sweep oper_env: renrm) = 1.410e+00 S  per = 90.9  per(accum) = 99.8
 T(sweep oper_env: save ) = 3.603e-03 S  per = 0.232  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.431e+10 S  per = -2.431e+32
 T(sweep oper_env: preprocess                  ) = -2.431e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.410e+00 S  T(sum) = 1.410e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.292e-04 S  per = 0.00917  per(accum) = 0.00917
 T(sweep oper_env: qops init                    ) = 4.983e-02 S  per = 3.53  per(accum) = 3.54
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.882e-02 S  per = 3.46  per(accum) = 7.01
 T(sweep oper_env: allocate qops on gpu         ) = 7.736e-04 S  per = 0.0549  per(accum) = 7.06
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.006e-02 S  per = 1.42  per(accum) = 8.48
 T(sweep oper_env: rintermediate init           ) = 3.253e-02 S  per = 2.31  per(accum) = 10.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.440e-01 S  per = 31.5  per(accum) = 42.3
 T(sweep oper_env: rmmtasks init                ) = 2.110e-01 S  per =   15  per(accum) = 57.3
 T(sweep oper_env: qops memset on cpu           ) = 4.830e-07 S  per = 3.43e-05  per(accum) = 57.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.343e-01 S  per = 37.9  per(accum) = 95.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.935e-03 S  per = 0.279  per(accum) = 95.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.003e-06 S  per = 7.11e-05  per(accum) = 95.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.160e-07 S  per = 3.66e-05  per(accum) = 95.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.379e-03 S  per = 0.169  per(accum) = 95.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 7.570e-04 S  per = 0.0537  per(accum) = 95.7
 T(sweep oper_env: qops_pool join and erase     ) = 2.646e-02 S  per = 1.88  per(accum) = 97.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per = 2.46  per(accum) = 100

idx=15 coord=(4,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=2439:0.0186MB:1.82e-05GB
        per(mem): H:1.6 C:11.1 S:3.69 P:0 Q:83.6 
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=1204:0.00919MB:8.97e-06GB
        per(mem): H:1.99 C:21.3 S:5.32 P:0 Q:71.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.097e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.476e-03 S -----
rank=0 GPUmem(GB): used=3.458e-05 (oper)=3.458e-05
rank=0 GPUmem(GB): used=3.511e-05 (oper,site)=3.458e-05,5.364e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=68
 no. of coefficients=1020:7.782e-03MB:7.600e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.498e-03 S -----
rank=0 GPUmem(GB): used=4.271e-05 (oper,site,rinter)=3.458e-05,5.364e-07,7.600e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.287e-01 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=5.014e-04,1.282e-01 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.298e-01 S size(rtasks)=57 size(Rlst)=3418 -----
rank=0 GPUmem(GB): used=4.271e-05 avail=6.174e+00 total=6.174e+00 batch[need]=4.075e-04 blksize=6 blksize0=3 batchsize=3418
rank=0 GPUmem(GB): used=4.502e-04 (oper,site,rinter,batch)=3.458e-05,5.364e-07,7.600e-06,4.075e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.271e-03,2.253e-02,9.865e-03
----- TIMING FOR renorm : t_inter=7.3e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=15 t=7.3e-03 per=1.8e+01 cost=8.0e+04 flops=1.1e+07
 renorm[gemm] counter=15 i=0 t=2.2e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.8e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=7.6e-03 per=1.9e+01 cost=7.1e+03 flops=9.4e+05
 renorm[gemm] counter=15 i=3 t=7.6e-03 per=1.9e+01 cost=3.0e+04 flops=4.0e+06
 renorm[gemm] counter=15 i=4 t=1.9e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=5 t=1.6e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=6 t=7.4e-03 per=1.9e+01 cost=3.8e+04 flops=5.1e+06
 renorm[gemm] counter=15 total t=2.3e-02 per=5.7e+01 cost=7.5e+04 flops=3.3e+06
 renorm[red] counter=15 t=9.9e-03 per=2.5e+01 cost=1.7e+04 flops=1.7e+06
----- TIMING FOR renorm_tot : t_inter=9.3e-02 t_gemm=3.4e-01 t_reduction=1.4e-01 tot=5.7e-01 -----
 renorm_tot[inter] counter=15 t=9.3e-02 per=1.6e+01 cost=1.3e+06 flops=1.4e+07
 renorm_tot[gemm] counter=15 i=0 t=2.5e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=2.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=1.1e-01 per=2.0e+01 cost=1.7e+05 flops=1.5e+06
 renorm_tot[gemm] counter=15 i=3 t=1.1e-01 per=2.0e+01 cost=1.0e+06 flops=9.0e+06
 renorm_tot[gemm] counter=15 i=4 t=2.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=5 t=2.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=6 t=1.1e-01 per=2.0e+01 cost=1.9e+06 flops=1.7e+07
 renorm_tot[gemm] counter=15 total t=3.4e-01 per=5.9e+01 cost=3.1e+06 flops=9.3e+06
 renorm_tot[red] counter=15 t=1.4e-01 per=2.5e+01 cost=6.7e+05 flops=4.8e+06
qops.to_cpu: size(tot)=1204:9.2e-03MB:9.0e-06GB T(to_cpu)=1.7e-04S speed=5.3e-02GB/S
check ||H-H.dagger||=1.097e-17 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.219 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=6.104e-05 change=9.156e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.663e-03 change=-1.968e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 2.318e-01 S #####
 T(local oper_env: fetch) = 9.001e-03 S  per = 3.88  per(accum) = 3.88
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.88
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.88
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.88
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.88
 T(local oper_env: renrm) = 2.224e-01 S  per =   96  per(accum) = 99.9
 T(local oper_env: save ) = 3.352e-04 S  per = 0.145  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.224e-01 S  T(sum) = 2.224e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.539e-06 S  per = 0.00384  per(accum) = 0.00384
 T(local oper_env: qops init                    ) = 5.211e-03 S  per = 2.34  per(accum) = 2.35
 T(local oper_env: symbolic_formulae_renorm     ) = 2.491e-03 S  per = 1.12  per(accum) = 3.47
 T(local oper_env: allocate qops on gpu         ) = 5.324e-05 S  per = 0.0239  per(accum) = 3.49
 T(local oper_env: site memcpy cpu2gpu          ) = 2.090e-03 S  per = 0.94  per(accum) = 4.43
 T(local oper_env: rintermediate init           ) = 2.508e-03 S  per = 1.13  per(accum) = 5.56
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.300e-01 S  per = 58.4  per(accum) = 64
 T(local oper_env: rmmtasks init                ) = 3.620e-02 S  per = 16.3  per(accum) = 80.3
 T(local oper_env: qops memset on cpu           ) = 6.400e-08 S  per = 2.88e-05  per(accum) = 80.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.980e-02 S  per = 17.9  per(accum) = 98.2
 T(local oper_env: deallocate cpu and gpu memory) = 3.688e-04 S  per = 0.166  per(accum) = 98.3
 T(local oper_env: construct opS [ifdists=true] ) = 1.000e-07 S  per = 4.5e-05  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [nccl]) = 5.300e-08 S  per = 2.38e-05  per(accum) = 98.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.873e-04 S  per = 0.0842  per(accum) = 98.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.301e-04 S  per = 0.103  per(accum) = 98.5
 T(local oper_env: qops_pool join and erase     ) = 3.268e-03 S  per = 1.47  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 1.364e-06 S  per = 0.000613  per(accum) = 100
##### sweep oper_env: 1.782e+00 S #####
 T(sweep oper_env: fetch) = 1.459e-01 S  per = 8.19  per(accum) = 8.19
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.19
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.19
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.19
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.19
 T(sweep oper_env: renrm) = 1.632e+00 S  per = 91.6  per(accum) = 99.8
 T(sweep oper_env: save ) = 3.938e-03 S  per = 0.221  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.605e+10 S  per = -2.605e+32
 T(sweep oper_env: preprocess                  ) = -2.605e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.632e+00 S  T(sum) = 1.632e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.378e-04 S  per = 0.00844  per(accum) = 0.00844
 T(sweep oper_env: qops init                    ) = 5.504e-02 S  per = 3.37  per(accum) = 3.38
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.131e-02 S  per = 3.14  per(accum) = 6.52
 T(sweep oper_env: allocate qops on gpu         ) = 8.269e-04 S  per = 0.0507  per(accum) = 6.57
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.215e-02 S  per = 1.36  per(accum) = 7.93
 T(sweep oper_env: rintermediate init           ) = 3.503e-02 S  per = 2.15  per(accum) = 10.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.740e-01 S  per = 35.2  per(accum) = 45.2
 T(sweep oper_env: rmmtasks init                ) = 2.472e-01 S  per = 15.1  per(accum) = 60.4
 T(sweep oper_env: qops memset on cpu           ) = 5.470e-07 S  per = 3.35e-05  per(accum) = 60.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.741e-01 S  per = 35.2  per(accum) = 95.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.304e-03 S  per = 0.264  per(accum) = 95.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.103e-06 S  per = 6.76e-05  per(accum) = 95.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.690e-07 S  per = 3.49e-05  per(accum) = 95.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.567e-03 S  per = 0.157  per(accum) = 96
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 9.872e-04 S  per = 0.0605  per(accum) = 96.1
 T(sweep oper_env: qops_pool join and erase     ) = 2.973e-02 S  per = 1.82  per(accum) = 97.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per = 2.13  per(accum) = 100

idx=16 coord=(3,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=1204:0.00919MB:8.97e-06GB
        per(mem): H:1.99 C:21.3 S:5.32 P:0 Q:71.4 
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=445:0.0034MB:3.32e-06GB
        per(mem): H:2.47 C:38.2 S:6.74 P:0 Q:52.6 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.114e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=42 : 1.736e-03 S -----
rank=0 GPUmem(GB): used=1.972e-05 (oper)=1.972e-05
rank=0 GPUmem(GB): used=2.003e-05 (oper,site)=1.972e-05,3.129e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=42
 no. of rintermediate operators=42
 no. of coefficients=672:5.127e-03MB:5.007e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.480e-03 S -----
rank=0 GPUmem(GB): used=2.504e-05 (oper,site,rinter)=1.972e-05,3.129e-07,5.007e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 6.562e-02 S size(rtasks)=42 size(Rlst2)=121 T(Rmu/Rlist)=3.727e-04,6.525e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.614e-02 S size(rtasks)=42 size(Rlst)=3286 -----
rank=0 GPUmem(GB): used=2.504e-05 avail=6.174e+00 total=6.174e+00 batch[need]=1.714e-04 blksize=2 blksize0=2 batchsize=3286
rank=0 GPUmem(GB): used=1.964e-04 (oper,site,rinter,batch)=1.972e-05,3.129e-07,5.007e-06,1.714e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.484e-03,2.253e-02,9.953e-03
----- TIMING FOR renorm : t_inter=7.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=16 t=7.5e-03 per=1.9e+01 cost=4.8e+04 flops=6.4e+06
 renorm[gemm] counter=16 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=7.6e-03 per=1.9e+01 cost=3.3e+03 flops=4.3e+05
 renorm[gemm] counter=16 i=3 t=7.5e-03 per=1.9e+01 cost=9.5e+03 flops=1.3e+06
 renorm[gemm] counter=16 i=4 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=6 t=7.5e-03 per=1.9e+01 cost=9.9e+03 flops=1.3e+06
 renorm[gemm] counter=16 total t=2.3e-02 per=5.6e+01 cost=2.3e+04 flops=1.0e+06
 renorm[red] counter=16 t=1.0e-02 per=2.5e+01 cost=6.6e+03 flops=6.6e+05
----- TIMING FOR renorm_tot : t_inter=1.0e-01 t_gemm=3.6e-01 t_reduction=1.5e-01 tot=6.1e-01 -----
 renorm_tot[inter] counter=16 t=1.0e-01 per=1.6e+01 cost=1.4e+06 flops=1.4e+07
 renorm_tot[gemm] counter=16 i=0 t=2.7e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=2.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=1.2e-01 per=2.0e+01 cost=1.7e+05 flops=1.4e+06
 renorm_tot[gemm] counter=16 i=3 t=1.2e-01 per=2.0e+01 cost=1.0e+06 flops=8.5e+06
 renorm_tot[gemm] counter=16 i=4 t=2.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=5 t=2.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=6 t=1.2e-01 per=1.9e+01 cost=2.0e+06 flops=1.6e+07
 renorm_tot[gemm] counter=16 total t=3.6e-01 per=5.9e+01 cost=3.2e+06 flops=8.7e+06
 renorm_tot[red] counter=16 t=1.5e-01 per=2.5e+01 cost=6.8e+05 flops=4.5e+06
qops.to_cpu: size(tot)=445:3.4e-03MB:3.3e-06GB T(to_cpu)=6.0e-05S speed=5.5e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.143 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.357e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.968e-03 change=-1.930e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 1.564e-01 S #####
 T(local oper_env: fetch) = 1.180e-02 S  per = 7.55  per(accum) = 7.55
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 7.55
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 7.55
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 7.55
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 7.55
 T(local oper_env: renrm) = 1.444e-01 S  per = 92.3  per(accum) = 99.8
 T(local oper_env: save ) = 2.472e-04 S  per = 0.158  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.444e-01 S  T(sum) = 1.444e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.713e-05 S  per = 0.0119  per(accum) = 0.0119
 T(local oper_env: qops init                    ) = 6.854e-03 S  per = 4.75  per(accum) = 4.76
 T(local oper_env: symbolic_formulae_renorm     ) = 1.747e-03 S  per = 1.21  per(accum) = 5.97
 T(local oper_env: allocate qops on gpu         ) = 6.134e-05 S  per = 0.0425  per(accum) = 6.01
 T(local oper_env: site memcpy cpu2gpu          ) = 2.319e-03 S  per = 1.61  per(accum) = 7.62
 T(local oper_env: rintermediate init           ) = 2.493e-03 S  per = 1.73  per(accum) = 9.35
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.626e-02 S  per = 45.9  per(accum) = 55.2
 T(local oper_env: rmmtasks init                ) = 2.241e-02 S  per = 15.5  per(accum) = 70.8
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 2.15e-05  per(accum) = 70.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.006e-02 S  per = 27.7  per(accum) = 98.5
 T(local oper_env: deallocate cpu and gpu memory) = 1.285e-04 S  per = 0.089  per(accum) = 98.6
 T(local oper_env: construct opS [ifdists=true] ) = 6.200e-08 S  per = 4.29e-05  per(accum) = 98.6
 T(local oper_env: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 2.7e-05  per(accum) = 98.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 7.048e-05 S  per = 0.0488  per(accum) = 98.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.905e-04 S  per = 0.132  per(accum) = 98.8
 T(local oper_env: qops_pool join and erase     ) = 1.753e-03 S  per = 1.21  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 8.020e-07 S  per = 0.000556  per(accum) = 100
##### sweep oper_env: 1.938e+00 S #####
 T(sweep oper_env: fetch) = 1.577e-01 S  per = 8.13  per(accum) = 8.13
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.13
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.13
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.13
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.13
 T(sweep oper_env: renrm) = 1.777e+00 S  per = 91.6  per(accum) = 99.8
 T(sweep oper_env: save ) = 4.185e-03 S  per = 0.216  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.779e+10 S  per = -2.779e+32
 T(sweep oper_env: preprocess                  ) = -2.779e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.777e+00 S  T(sum) = 1.777e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.549e-04 S  per = 0.00872  per(accum) = 0.00872
 T(sweep oper_env: qops init                    ) = 6.189e-02 S  per = 3.48  per(accum) = 3.49
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.305e-02 S  per = 2.99  per(accum) = 6.48
 T(sweep oper_env: allocate qops on gpu         ) = 8.882e-04 S  per = 0.05  per(accum) = 6.53
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.447e-02 S  per = 1.38  per(accum) = 7.91
 T(sweep oper_env: rintermediate init           ) = 3.753e-02 S  per = 2.11  per(accum) = 10
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.403e-01 S  per =   36  per(accum) = 46.1
 T(sweep oper_env: rmmtasks init                ) = 2.696e-01 S  per = 15.2  per(accum) = 61.2
 T(sweep oper_env: qops memset on cpu           ) = 5.780e-07 S  per = 3.25e-05  per(accum) = 61.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.142e-01 S  per = 34.6  per(accum) = 95.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.432e-03 S  per = 0.249  per(accum) = 96.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.165e-06 S  per = 6.56e-05  per(accum) = 96.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.080e-07 S  per = 3.42e-05  per(accum) = 96.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.637e-03 S  per = 0.148  per(accum) = 96.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.178e-03 S  per = 0.0663  per(accum) = 96.3
 T(sweep oper_env: qops_pool join and erase     ) = 3.148e-02 S  per = 1.77  per(accum) = 98
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per = 1.95  per(accum) = 100

idx=17 coord=(2,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=445:0.0034MB:3.32e-06GB
        per(mem): H:2.47 C:38.2 S:6.74 P:0 Q:52.6 
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:18 S:2 P:4 Q:6 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=69:0.000526MB:5.14e-07GB
        per(mem): H:8.7 C:0 S:0 P:0 Q:91.3 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.775e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=31 : 9.115e-04 S -----
rank=0 GPUmem(GB): used=1.127e-05 (oper)=1.127e-05
rank=0 GPUmem(GB): used=1.138e-05 (oper,site)=1.127e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=31
 no. of rintermediate operators=22
 no. of coefficients=374:2.853e-03MB:2.787e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.528e-03 S -----
rank=0 GPUmem(GB): used=1.417e-05 (oper,site,rinter)=1.127e-05,1.192e-07,2.787e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.573e-02 S size(rtasks)=31 size(Rlst2)=36 T(Rmu/Rlist)=2.075e-04,1.552e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.589e-02 S size(rtasks)=31 size(Rlst)=993 -----
rank=0 GPUmem(GB): used=1.417e-05 avail=6.174e+00 total=6.174e+00 batch[need]=2.959e-05 blksize=1 blksize0=1 batchsize=993
rank=0 GPUmem(GB): used=4.376e-05 (oper,site,rinter,batch)=1.127e-05,1.192e-07,2.787e-06,2.959e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.706e-03,2.247e-02,9.927e-03
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=17 t=6.7e-03 per=1.7e+01 cost=5.9e+03 flops=8.8e+05
 renorm[gemm] counter=17 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=7.6e-03 per=1.9e+01 cost=6.3e+02 flops=8.4e+04
 renorm[gemm] counter=17 i=3 t=7.4e-03 per=1.9e+01 cost=1.1e+03 flops=1.4e+05
 renorm[gemm] counter=17 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=6 t=7.4e-03 per=1.9e+01 cost=2.0e+03 flops=2.7e+05
 renorm[gemm] counter=17 total t=2.2e-02 per=5.7e+01 cost=3.7e+03 flops=1.6e+05
 renorm[red] counter=17 t=9.9e-03 per=2.5e+01 cost=2.0e+03 flops=2.0e+05
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=3.8e-01 t_reduction=1.6e-01 tot=6.5e-01 -----
 renorm_tot[inter] counter=17 t=1.1e-01 per=1.6e+01 cost=1.4e+06 flops=1.3e+07
 renorm_tot[gemm] counter=17 i=0 t=2.8e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=2.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=1.3e-01 per=2.0e+01 cost=1.7e+05 flops=1.3e+06
 renorm_tot[gemm] counter=17 i=3 t=1.3e-01 per=2.0e+01 cost=1.0e+06 flops=8.0e+06
 renorm_tot[gemm] counter=17 i=4 t=2.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=5 t=2.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=6 t=1.3e-01 per=1.9e+01 cost=2.0e+06 flops=1.5e+07
 renorm_tot[gemm] counter=17 total t=3.8e-01 per=5.9e+01 cost=3.2e+06 flops=8.2e+06
 renorm_tot[red] counter=17 t=1.6e-01 per=2.5e+01 cost=6.8e+05 flops=4.2e+06
qops.to_cpu: size(tot)=69:5.3e-04MB:5.1e-07GB T(to_cpu)=4.9e-05S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0677 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.855e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=7.629e-06 change=-1.399e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 7.831e-02 S #####
 T(local oper_env: fetch) = 8.858e-03 S  per = 11.3  per(accum) = 11.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.3
 T(local oper_env: renrm) = 6.922e-02 S  per = 88.4  per(accum) = 99.7
 T(local oper_env: save ) = 2.236e-04 S  per = 0.285  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.922e-02 S  T(sum) = 6.922e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.358e-05 S  per = 0.0196  per(accum) = 0.0196
 T(local oper_env: qops init                    ) = 1.211e-03 S  per = 1.75  per(accum) = 1.77
 T(local oper_env: symbolic_formulae_renorm     ) = 9.211e-04 S  per = 1.33  per(accum) = 3.1
 T(local oper_env: allocate qops on gpu         ) = 4.774e-05 S  per = 0.069  per(accum) = 3.17
 T(local oper_env: site memcpy cpu2gpu          ) = 1.324e-03 S  per = 1.91  per(accum) = 5.08
 T(local oper_env: rintermediate init           ) = 2.540e-03 S  per = 3.67  per(accum) = 8.75
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.593e-02 S  per =   23  per(accum) = 31.8
 T(local oper_env: rmmtasks init                ) = 6.333e-03 S  per = 9.15  per(accum) = 40.9
 T(local oper_env: qops memset on cpu           ) = 2.900e-08 S  per = 4.19e-05  per(accum) = 40.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.920e-02 S  per = 56.6  per(accum) = 97.5
 T(local oper_env: deallocate cpu and gpu memory) = 5.867e-05 S  per = 0.0848  per(accum) = 97.6
 T(local oper_env: construct opS [ifdists=true] ) = 8.500e-08 S  per = 0.000123  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 5.49e-05  per(accum) = 97.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.745e-05 S  per = 0.083  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 6.803e-05 S  per = 0.0983  per(accum) = 97.8
 T(local oper_env: qops_pool join and erase     ) = 1.518e-03 S  per = 2.19  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 9.920e-07 S  per = 0.00143  per(accum) = 100
##### sweep oper_env: 2.017e+00 S #####
 T(sweep oper_env: fetch) = 1.665e-01 S  per = 8.26  per(accum) = 8.26
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.26
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.26
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.26
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.26
 T(sweep oper_env: renrm) = 1.846e+00 S  per = 91.5  per(accum) = 99.8
 T(sweep oper_env: save ) = 4.408e-03 S  per = 0.219  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.952e+10 S  per = -2.952e+32
 T(sweep oper_env: preprocess                  ) = -2.952e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.846e+00 S  T(sum) = 1.846e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.685e-04 S  per = 0.00913  per(accum) = 0.00913
 T(sweep oper_env: qops init                    ) = 6.310e-02 S  per = 3.42  per(accum) = 3.43
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.397e-02 S  per = 2.92  per(accum) = 6.35
 T(sweep oper_env: allocate qops on gpu         ) = 9.360e-04 S  per = 0.0507  per(accum) = 6.4
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.580e-02 S  per =  1.4  per(accum) = 7.8
 T(sweep oper_env: rintermediate init           ) = 4.007e-02 S  per = 2.17  per(accum) = 9.97
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.562e-01 S  per = 35.6  per(accum) = 45.5
 T(sweep oper_env: rmmtasks init                ) = 2.759e-01 S  per = 14.9  per(accum) = 60.5
 T(sweep oper_env: qops memset on cpu           ) = 6.070e-07 S  per = 3.29e-05  per(accum) = 60.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.534e-01 S  per = 35.4  per(accum) = 95.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.491e-03 S  per = 0.243  per(accum) = 96.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.250e-06 S  per = 6.77e-05  per(accum) = 96.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.460e-07 S  per = 3.5e-05  per(accum) = 96.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.695e-03 S  per = 0.146  per(accum) = 96.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.246e-03 S  per = 0.0675  per(accum) = 96.3
 T(sweep oper_env: qops_pool join and erase     ) = 3.300e-02 S  per = 1.79  per(accum) = 98.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per = 1.88  per(accum) = 100

idx=18 coord=(1,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:18 S:2 P:4 Q:6 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=69:0.000526MB:5.14e-07GB
        per(mem): H:8.7 C:0 S:0 P:0 Q:91.3 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:19 S:1 P:1 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): H:22.2 C:0 S:0 P:0 Q:77.8 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.590e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 4.690e-04 S -----
rank=0 GPUmem(GB): used=8.151e-06 (oper)=8.151e-06
rank=0 GPUmem(GB): used=8.196e-06 (oper,site)=8.151e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=24
 no. of rintermediate operators=8
 no. of coefficients=144:1.099e-03MB:1.073e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.493e-03 S -----
rank=0 GPUmem(GB): used=9.269e-06 (oper,site,rinter)=8.151e-06,4.470e-08,1.073e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.305e-03 S size(rtasks)=24 size(Rlst2)=36 T(Rmu/Rlist)=1.308e-04,1.174e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.323e-03 S size(rtasks)=24 size(Rlst)=63 -----
rank=0 GPUmem(GB): used=9.269e-06 avail=6.174e+00 total=6.174e+00 batch[need]=1.408e-06 blksize=1 blksize0=0 batchsize=63
rank=0 GPUmem(GB): used=1.068e-05 (oper,site,rinter,batch)=8.151e-06,4.470e-08,1.073e-06,1.408e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.096e-04,2.268e-02,1.007e-02
----- TIMING FOR renorm : t_inter=8.1e-04 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.4e-02 -----
 renorm[inter] counter=18 t=8.1e-04 per=2.4e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=1.7e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=7.6e-03 per=2.3e+01 cost=2.4e+01 flops=3.2e+03
 renorm[gemm] counter=18 i=3 t=7.5e-03 per=2.2e+01 cost=6.6e+01 flops=8.8e+03
 renorm[gemm] counter=18 i=4 t=1.3e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=7.6e-03 per=2.3e+01 cost=1.3e+02 flops=1.7e+04
 renorm[gemm] counter=18 total t=2.3e-02 per=6.8e+01 cost=2.2e+02 flops=9.5e+03
 renorm[red] counter=18 t=1.0e-02 per=3.0e+01 cost=1.3e+02 flops=1.3e+04
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.1e-01 t_reduction=1.7e-01 tot=6.9e-01 -----
 renorm_tot[inter] counter=18 t=1.1e-01 per=1.6e+01 cost=1.4e+06 flops=1.3e+07
 renorm_tot[gemm] counter=18 i=0 t=3.0e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=1.3e-01 per=2.0e+01 cost=1.7e+05 flops=1.3e+06
 renorm_tot[gemm] counter=18 i=3 t=1.4e-01 per=2.0e+01 cost=1.0e+06 flops=7.6e+06
 renorm_tot[gemm] counter=18 i=4 t=2.4e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=5 t=2.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=6 t=1.3e-01 per=2.0e+01 cost=2.0e+06 flops=1.5e+07
 renorm_tot[gemm] counter=18 total t=4.1e-01 per=5.9e+01 cost=3.2e+06 flops=7.8e+06
 renorm_tot[red] counter=18 t=1.7e-01 per=2.5e+01 cost=6.8e+05 flops=4.0e+06
qops.to_cpu: size(tot)=27:2.1e-04MB:2.0e-07GB T(to_cpu)=3.8e-05S speed=5.4e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0398 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=4.783e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.237e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 5.015e-02 S #####
 T(local oper_env: fetch) = 8.751e-03 S  per = 17.5  per(accum) = 17.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.5
 T(local oper_env: renrm) = 4.116e-02 S  per = 82.1  per(accum) = 99.5
 T(local oper_env: save ) = 2.370e-04 S  per = 0.473  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.116e-02 S  T(sum) = 4.116e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.892e-06 S  per = 0.0216  per(accum) = 0.0216
 T(local oper_env: qops init                    ) = 9.364e-04 S  per = 2.28  per(accum) = 2.3
 T(local oper_env: symbolic_formulae_renorm     ) = 4.774e-04 S  per = 1.16  per(accum) = 3.46
 T(local oper_env: allocate qops on gpu         ) = 4.578e-05 S  per = 0.111  per(accum) = 3.57
 T(local oper_env: site memcpy cpu2gpu          ) = 4.008e-04 S  per = 0.974  per(accum) = 4.54
 T(local oper_env: rintermediate init           ) = 2.504e-03 S  per = 6.08  per(accum) = 10.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.330e-03 S  per = 3.23  per(accum) = 13.9
 T(local oper_env: rmmtasks init                ) = 3.443e-04 S  per = 0.837  per(accum) = 14.7
 T(local oper_env: qops memset on cpu           ) = 4.500e-08 S  per = 0.000109  per(accum) = 14.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.366e-02 S  per = 81.8  per(accum) = 96.5
 T(local oper_env: deallocate cpu and gpu memory) = 2.411e-05 S  per = 0.0586  per(accum) = 96.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.200e-08 S  per = 0.000102  per(accum) = 96.5
 T(local oper_env: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 7.77e-05  per(accum) = 96.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.556e-05 S  per = 0.111  per(accum) = 96.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 7.096e-05 S  per = 0.172  per(accum) = 96.8
 T(local oper_env: qops_pool join and erase     ) = 1.312e-03 S  per = 3.19  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 8.220e-07 S  per = 0.002  per(accum) = 100
##### sweep oper_env: 2.067e+00 S #####
 T(sweep oper_env: fetch) = 1.753e-01 S  per = 8.48  per(accum) = 8.48
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(sweep oper_env: renrm) = 1.887e+00 S  per = 91.3  per(accum) = 99.8
 T(sweep oper_env: save ) = 4.645e-03 S  per = 0.225  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.126e+10 S  per = -3.126e+32
 T(sweep oper_env: preprocess                  ) = -3.126e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.887e+00 S  T(sum) = 1.887e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.774e-04 S  per = 0.0094  per(accum) = 0.0094
 T(sweep oper_env: qops init                    ) = 6.404e-02 S  per = 3.39  per(accum) = 3.4
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.445e-02 S  per = 2.89  per(accum) = 6.29
 T(sweep oper_env: allocate qops on gpu         ) = 9.817e-04 S  per = 0.052  per(accum) = 6.34
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.620e-02 S  per = 1.39  per(accum) = 7.73
 T(sweep oper_env: rintermediate init           ) = 4.257e-02 S  per = 2.26  per(accum) = 9.99
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.575e-01 S  per = 34.8  per(accum) = 44.8
 T(sweep oper_env: rmmtasks init                ) = 2.762e-01 S  per = 14.6  per(accum) = 59.5
 T(sweep oper_env: qops memset on cpu           ) = 6.520e-07 S  per = 3.46e-05  per(accum) = 59.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.871e-01 S  per = 36.4  per(accum) = 95.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.515e-03 S  per = 0.239  per(accum) = 96.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.292e-06 S  per = 6.85e-05  per(accum) = 96.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.780e-07 S  per = 3.59e-05  per(accum) = 96.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.740e-03 S  per = 0.145  per(accum) = 96.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.317e-03 S  per = 0.0698  per(accum) = 96.3
 T(sweep oper_env: qops_pool join and erase     ) = 3.431e-02 S  per = 1.82  per(accum) = 98.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per = 1.84  per(accum) = 100

idx=19 coord=(0,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=941:0.00718MB:7.01e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=942:0.00719MB:7.02e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:19 S:1 P:1 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): H:22.2 C:0 S:0 P:0 Q:77.8 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:20 S:0 P:0 Q:0 
        dim(bra,ket)=6,6 size(op)=6:4.58e-05MB size(tot)=6:4.58e-05MB:4.47e-08GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.503e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=21 : 2.495e-04 S -----
rank=0 GPUmem(GB): used=7.682e-06 (oper)=7.682e-06
rank=0 GPUmem(GB): used=7.726e-06 (oper,site)=7.682e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=7.726e-06 (oper,site,rinter)=7.682e-06,4.470e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 7.333e-04 S size(rtasks)=21 size(Rlst2)=36 T(Rmu/Rlist)=8.566e-05,6.476e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.485e-04 S size(rtasks)=21 size(Rlst)=36 -----
rank=0 GPUmem(GB): used=7.726e-06 avail=6.174e+00 total=6.174e+00 batch[need]=8.047e-07 blksize=1 blksize0=0 batchsize=36
rank=0 GPUmem(GB): used=8.531e-06 (oper,site,rinter,batch)=7.682e-06,4.470e-08,0.000e+00,8.047e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.487e-03,2.239e-02,1.015e-02
----- TIMING FOR renorm : t_inter=1.5e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.4e-02 -----
 renorm[inter] counter=19 t=1.5e-03 per=4.4e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=0 t=1.6e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=1.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=7.5e-03 per=2.2e+01 cost=2.4e+01 flops=3.2e+03
 renorm[gemm] counter=19 i=3 t=7.4e-03 per=2.2e+01 cost=2.4e+01 flops=3.2e+03
 renorm[gemm] counter=19 i=4 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=1.1e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=7.5e-03 per=2.2e+01 cost=7.2e+01 flops=9.6e+03
 renorm[gemm] counter=19 total t=2.2e-02 per=6.6e+01 cost=1.2e+02 flops=5.4e+03
 renorm[red] counter=19 t=1.0e-02 per=3.0e+01 cost=7.2e+01 flops=7.1e+03
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.3e-01 t_reduction=1.8e-01 tot=7.2e-01 -----
 renorm_tot[inter] counter=19 t=1.1e-01 per=1.5e+01 cost=1.4e+06 flops=1.3e+07
 renorm_tot[gemm] counter=19 i=0 t=3.2e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=1.4e-01 per=2.0e+01 cost=1.7e+05 flops=1.2e+06
 renorm_tot[gemm] counter=19 i=3 t=1.4e-01 per=2.0e+01 cost=1.0e+06 flops=7.2e+06
 renorm_tot[gemm] counter=19 i=4 t=2.6e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=5 t=2.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=6 t=1.4e-01 per=2.0e+01 cost=2.0e+06 flops=1.4e+07
 renorm_tot[gemm] counter=19 total t=4.3e-01 per=6.0e+01 cost=3.2e+06 flops=7.4e+06
 renorm_tot[red] counter=19 t=1.8e-01 per=2.5e+01 cost=6.8e+05 flops=3.8e+06
qops.to_cpu: size(tot)=6:4.6e-05MB:4.5e-08GB T(to_cpu)=2.9e-05S speed=1.5e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0373 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.398e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.826e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 4.754e-02 S #####
 T(local oper_env: fetch) = 8.834e-03 S  per = 18.6  per(accum) = 18.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.6
 T(local oper_env: renrm) = 3.848e-02 S  per = 80.9  per(accum) = 99.5
 T(local oper_env: save ) = 2.257e-04 S  per = 0.475  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.848e-02 S  T(sum) = 3.848e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.129e-05 S  per = 0.0294  per(accum) = 0.0294
 T(local oper_env: qops init                    ) = 8.194e-04 S  per = 2.13  per(accum) = 2.16
 T(local oper_env: symbolic_formulae_renorm     ) = 2.574e-04 S  per = 0.669  per(accum) = 2.83
 T(local oper_env: allocate qops on gpu         ) = 4.460e-05 S  per = 0.116  per(accum) = 2.94
 T(local oper_env: site memcpy cpu2gpu          ) = 9.009e-04 S  per = 2.34  per(accum) = 5.28
 T(local oper_env: rintermediate init           ) = 1.622e-05 S  per = 0.0421  per(accum) = 5.33
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.551e-04 S  per = 1.96  per(accum) = 7.29
 T(local oper_env: rmmtasks init                ) = 2.165e-04 S  per = 0.563  per(accum) = 7.85
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 8.06e-05  per(accum) = 7.85
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.412e-02 S  per = 88.7  per(accum) = 96.5
 T(local oper_env: deallocate cpu and gpu memory) = 2.168e-05 S  per = 0.0563  per(accum) = 96.6
 T(local oper_env: construct opS [ifdists=true] ) = 4.200e-08 S  per = 0.000109  per(accum) = 96.6
 T(local oper_env: reduction of opS & opH [nccl]) = 3.300e-08 S  per = 8.58e-05  per(accum) = 96.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.596e-05 S  per = 0.0935  per(accum) = 96.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 6.898e-05 S  per = 0.179  per(accum) = 96.9
 T(local oper_env: qops_pool join and erase     ) = 1.209e-03 S  per = 3.14  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.920e-07 S  per = 0.0018  per(accum) = 100
##### sweep oper_env: 2.114e+00 S #####
 T(sweep oper_env: fetch) = 1.841e-01 S  per = 8.71  per(accum) = 8.71
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.71
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.71
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.71
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.71
 T(sweep oper_env: renrm) = 1.925e+00 S  per = 91.1  per(accum) = 99.8
 T(sweep oper_env: save ) = 4.871e-03 S  per = 0.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.300e+10 S  per = -3.300e+32
 T(sweep oper_env: preprocess                  ) = -3.300e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.925e+00 S  T(sum) = 1.925e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.887e-04 S  per = 0.0098  per(accum) = 0.0098
 T(sweep oper_env: qops init                    ) = 6.486e-02 S  per = 3.37  per(accum) = 3.38
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.471e-02 S  per = 2.84  per(accum) = 6.22
 T(sweep oper_env: allocate qops on gpu         ) = 1.026e-03 S  per = 0.0533  per(accum) = 6.27
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.710e-02 S  per = 1.41  per(accum) = 7.68
 T(sweep oper_env: rintermediate init           ) = 4.259e-02 S  per = 2.21  per(accum) = 9.89
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.583e-01 S  per = 34.2  per(accum) = 44.1
 T(sweep oper_env: rmmtasks init                ) = 2.765e-01 S  per = 14.4  per(accum) = 58.4
 T(sweep oper_env: qops memset on cpu           ) = 6.830e-07 S  per = 3.55e-05  per(accum) = 58.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.212e-01 S  per = 37.5  per(accum) = 95.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.537e-03 S  per = 0.236  per(accum) = 96.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.334e-06 S  per = 6.93e-05  per(accum) = 96.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.110e-07 S  per = 3.69e-05  per(accum) = 96.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.776e-03 S  per = 0.144  per(accum) = 96.3
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.386e-03 S  per = 0.072  per(accum) = 96.4
 T(sweep oper_env: qops_pool join and erase     ) = 3.552e-02 S  per = 1.84  per(accum) = 98.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.473e-02 S  per =  1.8  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 2.333e+00 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.209,0.184,1.86,0.0705,2.32
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-5.800e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=4.470e-08GB T[load](info/setup/data/tot)=3.965e-05,7.149e-04,9.382e-06,7.639e-04 speed=5.852e-05GB/S
matrix: Hij size=(1,1)
     -1.161471167558e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.980e-08 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

ctns::oper_init_dotL isym=3 ifkr=1 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=7.614e-03MB:7.436e-06GB
fname=./scratch/sweep/lop(0,0) size=7.44e-06GB T[save](info/data/tot)=0.000153,9.52e-05,0.000248 speed=0.0299GB/S disk[used]=0.000621GB
----- TIMING FOR ctns::oper_init_dotL : 9.278e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x45b9ad00
qinfo3su2: site0new sym=(0,0) dir=1,0,1 couple=0
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=9 size=3:2.29e-05MB
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=938:0.00716MB:6.99e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=940:0.00717MB:7e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=1.945e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=0/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.639e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=938:7.156e-03MB:6.989e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1:7.629e-06MB:7.451e-09GB
total mem of comb=940:7.172e-03MB:7.004e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=445:0.0034MB:3.32e-06GB
        per(mem): H:2.47 C:38.2 S:6.74 P:0 Q:52.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3439:0.0262MB:2.56e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=2.709e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.103e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(3,11,3,3) nnz=4:3.052e-05MB
qtensor4: wf4 own=1 _data=0x41c5cee0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=11 dimAll=11
 (24,0):1 (24,2):1 (24,4):1 (24,6):1 (24,8):1 (24,10):1 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=4 nblocks=430 size=4:3.052e-05MB
### DIAG TIMING: total=6.586e-02 t1=3.247e-05, t2=1.235e-03, t3=2.494e-03, t4=6.206e-02, t5=3.385e-06, t6=3.851e-05, t7=4.762e-06
duration_diagGPU:6.588e-02
duration_diagreduce:7.700e-08
duration_diagtransform:1.925e-06
----- TIMING FOR symbolic_formulae_twodot with size=228 : 2.326e-03 S -----
rank=0 GPUmem(GB): used=2.562e-05 (oper)=2.562e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:2.853e-03MB:2.787e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.637e-05 S -----
rank=0 GPUmem(GB): used=2.841e-05 (oper,hinter)=2.562e-05,2.787e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.821e-03 S size(H_formulae)=228 size(Hxlst2)=4 T(Hmu/Hxlist)=5.482e-04,9.273e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.896e-03 S size(H_formulae)=228 size(Hxlst)=304 -----
rank=0 GPUmem(GB): used=2.841e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=5.960e-08 batch[need]=9.060e-06 blksize=1 blksize0=1 batchsize=304
rank=0 GPUmem(GB): used=3.753e-05 (oper,hinter,dvdson,batch)=2.562e-05,2.787e-06,5.960e-08,9.060e-06
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=4 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.590e-03,1.004e-02,2.983e-02,1.242e-02,5.389e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=1.574e-03 speed=3.787e-05GB/S T(nccl)=1.570e-05 speed=3.796e-03GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=1 t=1.0e-02 per=1.9e+01 cost=4.1e+02 flops=4.1e+04
 sigma[gemm] counter=1 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=4 t=7.5e-03 per=1.4e+01 cost=2.4e+02 flops=3.2e+04
 sigma[gemm] counter=1 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+02 flops=3.2e+04
 sigma[gemm] counter=1 i=6 t=7.4e-03 per=1.4e+01 cost=1.7e+02 flops=2.3e+04
 sigma[gemm] counter=1 i=7 t=7.4e-03 per=1.4e+01 cost=1.7e+02 flops=2.2e+04
 sigma[gemm] counter=1 total t=3.0e-02 per=5.7e+01 cost=8.1e+02 flops=2.7e+04
 sigma[red] counter=1 t=1.2e-02 per=2.4e+01 cost=6.1e+02 flops=4.9e+04
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma_tot[inter] counter=1 t=1.0e-02 per=1.9e+01 cost=4.1e+02 flops=4.1e+04
 sigma_tot[gemm] counter=1 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=4 t=7.5e-03 per=1.4e+01 cost=2.4e+02 flops=3.2e+04
 sigma_tot[gemm] counter=1 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+02 flops=3.2e+04
 sigma_tot[gemm] counter=1 i=6 t=7.4e-03 per=1.4e+01 cost=1.7e+02 flops=2.3e+04
 sigma_tot[gemm] counter=1 i=7 t=7.4e-03 per=1.4e+01 cost=1.7e+02 flops=2.2e+04
 sigma_tot[gemm] counter=1 total t=3.0e-02 per=5.7e+01 cost=8.1e+02 flops=2.7e+04
 sigma_tot[red] counter=1 t=1.2e-02 per=2.4e+01 cost=6.1e+02 flops=4.9e+04
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,1.7e-05,2.4e-06,8.0e-07,2.2e-07
settings: ndim=4 neig=1 maxcycle=30 nbuff=4 memory=4e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.147116755810 -1.116e+03  5.974e-02    1     1  5.405e-02 5.405e-02 5.400e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.166e-03,9.925e-03,3.004e-02,1.271e-02,5.385e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=1.160e-03 speed=5.138e-05GB/S T(nccl)=5.891e-06 speed=1.012e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=2 t=9.9e-03 per=1.9e+01 cost=4.1e+02 flops=4.1e+04
 sigma[gemm] counter=2 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=3 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=4 t=7.5e-03 per=1.4e+01 cost=2.4e+02 flops=3.2e+04
 sigma[gemm] counter=2 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+02 flops=3.2e+04
 sigma[gemm] counter=2 i=6 t=7.5e-03 per=1.4e+01 cost=1.7e+02 flops=2.2e+04
 sigma[gemm] counter=2 i=7 t=7.4e-03 per=1.4e+01 cost=1.7e+02 flops=2.2e+04
 sigma[gemm] counter=2 total t=3.0e-02 per=5.7e+01 cost=8.1e+02 flops=2.7e+04
 sigma[red] counter=2 t=1.3e-02 per=2.4e+01 cost=6.1e+02 flops=4.8e+04
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=6.0e-02 t_reduction=2.5e-02 tot=1.0e-01 -----
 sigma_tot[inter] counter=2 t=2.0e-02 per=1.9e+01 cost=8.2e+02 flops=4.1e+04
 sigma_tot[gemm] counter=2 i=0 t=3.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=2.9e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=2.8e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=3 t=2.7e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=4 t=1.5e-02 per=1.4e+01 cost=4.8e+02 flops=3.2e+04
 sigma_tot[gemm] counter=2 i=5 t=1.5e-02 per=1.4e+01 cost=4.8e+02 flops=3.2e+04
 sigma_tot[gemm] counter=2 i=6 t=1.5e-02 per=1.4e+01 cost=3.3e+02 flops=2.2e+04
 sigma_tot[gemm] counter=2 i=7 t=1.5e-02 per=1.4e+01 cost=3.3e+02 flops=2.2e+04
 sigma_tot[gemm] counter=2 total t=6.0e-02 per=5.7e+01 cost=1.6e+03 flops=2.7e+04
 sigma_tot[red] counter=2 t=2.5e-02 per=2.4e+01 cost=1.2e+03 flops=4.8e+04
T(sub)=7.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,6.3e-05,4.0e-06,1.7e-06,2.0e-07
    2   0 -    -116.177424126215 -3.031e-02  3.883e-03    2     2  1.260e-01 6.302e-02 5.398e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.755e-04,1.356e-02,2.852e-02,1.272e-02,5.519e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=3.666e-04 speed=1.626e-04GB/S T(nccl)=8.934e-06 speed=6.672e-03GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=2.9e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=3 t=1.4e-02 per=2.5e+01 cost=4.1e+02 flops=3.0e+04
 sigma[gemm] counter=3 i=0 t=4.4e-06 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=2.2e-05 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=3.7e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=3 t=3.6e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=4 t=5.9e-03 per=1.1e+01 cost=2.4e+02 flops=4.0e+04
 sigma[gemm] counter=3 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+02 flops=3.2e+04
 sigma[gemm] counter=3 i=6 t=7.6e-03 per=1.4e+01 cost=1.7e+02 flops=2.2e+04
 sigma[gemm] counter=3 i=7 t=7.5e-03 per=1.4e+01 cost=1.7e+02 flops=2.2e+04
 sigma[gemm] counter=3 total t=2.9e-02 per=5.2e+01 cost=8.1e+02 flops=2.8e+04
 sigma[red] counter=3 t=1.3e-02 per=2.3e+01 cost=6.1e+02 flops=4.8e+04
----- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=8.8e-02 t_reduction=3.8e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=3 t=3.4e-02 per=2.1e+01 cost=1.2e+03 flops=3.7e+04
 sigma_tot[gemm] counter=3 i=0 t=7.6e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=2.5e-05 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=6.5e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=3 t=6.4e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=4 t=2.1e-02 per=1.3e+01 cost=7.1e+02 flops=3.4e+04
 sigma_tot[gemm] counter=3 i=5 t=2.3e-02 per=1.4e+01 cost=7.1e+02 flops=3.2e+04
 sigma_tot[gemm] counter=3 i=6 t=2.2e-02 per=1.4e+01 cost=5.0e+02 flops=2.2e+04
 sigma_tot[gemm] counter=3 i=7 t=2.2e-02 per=1.4e+01 cost=5.0e+02 flops=2.2e+04
 sigma_tot[gemm] counter=3 total t=8.8e-02 per=5.5e+01 cost=2.4e+03 flops=2.7e+04
 sigma_tot[red] counter=3 t=3.8e-02 per=2.4e+01 cost=1.8e+03 flops=4.8e+04
T(sub)=8.5e-05 T(gemm/eig/ortho/gemm/axpy)=9.0e-06,6.8e-05,6.6e-06,1.9e-06,4.3e-07
    3   0 +    -116.177526452453 -1.023e-04  2.607e-06    3     3  1.940e-01 6.466e-02 5.447e-02
TIMING FOR Davidson : 1.940e-01  T(cal/comm/rest)=1.634e-01,6.030e-07,3.059e-02
decomposed t_rest=3.059e-02
 T(sub)    =1.830e-04 per=5.983e-01
 T(precond)=3.028e-02 per=9.899e+01
 T(ortho)  =8.864e-06 per=2.898e-02
 T(xcopy)  =6.590e-07 per=2.154e-03
 T(xnrm2)  =1.939e-06 per=6.338e-03
 T(other)  =1.154e-04 per=3.771e-01
optimized energies: isweep=0 ibond=0 dots=2 e[0]=-116.177526452453 nmvp=3
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=4.492e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
timing for divide=2.6e-04
timing for compute=2.0e-02
timing for collect=2.2e-05
----- TMING FOR decimation_genbasis(su2): 2.0e-02 S T(divide/compute[cpu/gpu/rest]/collect)=2.6e-04,2.0e-02,0.0e+00,1.1e-05,2.2e-05 -----
decimation summary: 10->2 dwt=+0.000e+00 SvN=5.084e-01
 qbond: qkept nsym=2 dimAll=2
 (4,0):1 (3,1):1
----- TIMING for decimation_row(nkr): 2.075e-02 S T(decim/select/formRot)=2.040e-02,3.162e-04,3.881e-05 -----
----- TIMING FOR twodot_decimation: 2.233e-02 S T(wf/decim)=1.564e-03,2.077e-02 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=31:2.365e-04MB:2.310e-07GB
        per(mem): H:6.45 C:6.45 S:58.1 A:0 B:29 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.606e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=31 : 1.482e-03 S -----
rank=0 GPUmem(GB): used=2.532e-05 (oper)=1.510e-05
rank=0 GPUmem(GB): used=2.535e-05 (oper,site)=1.510e-05,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=31
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=2.535e-05 (oper,site,rinter)=1.510e-05,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.908e-03 S size(rtasks)=31 size(Rlst2)=4 T(Rmu/Rlist)=6.122e-04,2.296e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.940e-03 S size(rtasks)=31 size(Rlst)=106 -----
rank=0 GPUmem(GB): used=2.535e-05 avail=6.174e+00 total=6.174e+00 batch[need]=2.369e-06 blksize=1 blksize0=0 batchsize=106
rank=0 GPUmem(GB): used=2.772e-05 (oper,site,rinter,batch)=1.510e-05,2.235e-08,0.000e+00,2.369e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.061e-05,2.134e-02,1.016e-02
----- TIMING FOR renorm : t_inter=1.0e-05 t_gemm=2.1e-02 t_reduction=1.0e-02 tot=3.2e-02 -----
 renorm[inter] counter=1 t=1.0e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=2.4e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=2.0e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=1.8e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.8e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=6.2e-03 per=2.0e+01 cost=8.8e+01 flops=1.4e+04
 renorm[gemm] counter=1 i=5 t=7.6e-03 per=2.4e+01 cost=6.6e+01 flops=8.7e+03
 renorm[gemm] counter=1 i=6 t=7.6e-03 per=2.4e+01 cost=2.1e+02 flops=2.8e+04
 renorm[gemm] counter=1 total t=2.1e-02 per=6.8e+01 cost=3.7e+02 flops=1.7e+04
 renorm[red] counter=1 t=1.0e-02 per=3.2e+01 cost=2.1e+02 flops=2.1e+04
----- TIMING FOR renorm_tot : t_inter=1.0e-05 t_gemm=2.1e-02 t_reduction=1.0e-02 tot=3.2e-02 -----
 renorm_tot[inter] counter=1 t=1.0e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=2.4e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=2.0e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=1.8e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.8e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=6.2e-03 per=2.0e+01 cost=8.8e+01 flops=1.4e+04
 renorm_tot[gemm] counter=1 i=5 t=7.6e-03 per=2.4e+01 cost=6.6e+01 flops=8.7e+03
 renorm_tot[gemm] counter=1 i=6 t=7.6e-03 per=2.4e+01 cost=2.1e+02 flops=2.8e+04
 renorm_tot[gemm] counter=1 total t=2.1e-02 per=6.8e+01 cost=3.7e+02 flops=1.7e+04
 renorm_tot[red] counter=1 t=1.0e-02 per=3.2e+01 cost=2.1e+02 flops=2.1e+04
qops.to_cpu: size(tot)=31:2.4e-04MB:2.3e-07GB T(to_cpu)=6.7e-05S speed=3.5e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0386 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.221e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.907e-04 change=-1.969e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.907e-04 change=-9.388e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local opt: 3.876e-01 S #####
 T(local opt: fetch) = 3.785e-02 S  per = 9.76  per(accum) = 9.76
 T(local opt: hdiag) = 6.677e-02 S  per = 17.2  per(accum) = 27
 T(local opt: dvdsn) = 2.165e-01 S  per = 55.9  per(accum) = 82.8
 T(local opt: decim) = 2.236e-02 S  per = 5.77  per(accum) = 88.6
 T(local opt: guess) = 1.579e-03 S  per = 0.407  per(accum) = 89
 T(local opt: renrm) = 4.221e-02 S  per = 10.9  per(accum) = 99.9
 T(local opt: save ) = 3.387e-04 S  per = 0.0874  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.165e-01 S  T(sum) = 2.162e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 6.941e-03 S  per = 3.21  per(accum) = 3.21
 T(local opt: symbolic_formulae           ) = 2.341e-03 S  per = 1.08  per(accum) = 4.29
 T(local opt: hintermediate init          ) = 9.933e-05 S  per = 0.0459  per(accum) = 4.34
 T(local opt: preprocess_hformulae_Hxlist ) = 9.911e-03 S  per = 4.58  per(accum) = 8.92
 T(local opt: hmmtasks init               ) = 1.351e-03 S  per = 0.625  per(accum) = 9.55
 T(local opt: initial guess for dvdson    ) = 1.577e-03 S  per = 0.729  per(accum) = 10.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.603e-01 S  per = 74.1  per(accum) = 84.4
 T(local opt: dvdson [cpu-gpu]            ) = 3.101e-03 S  per = 1.43  per(accum) = 85.8
 T(local opt: dvdson [nccl]               ) = 3.053e-05 S  per = 0.0141  per(accum) = 85.9
 T(local opt: dvdson [mpi]                ) = 6.030e-07 S  per = 0.000279  per(accum) = 85.9
 T(local opt: dvdson [rest part(linalg)]  ) = 3.059e-02 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 4.221e-02 S  T(sum) = 4.221e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.362e-04 S  per = 0.323  per(accum) = 0.323
 T(local opt: qops init                    ) = 7.017e-04 S  per = 1.66  per(accum) = 1.99
 T(local opt: symbolic_formulae_renorm     ) = 1.495e-03 S  per = 3.54  per(accum) = 5.53
 T(local opt: allocate qops on gpu         ) = 7.842e-05 S  per = 0.186  per(accum) = 5.71
 T(local opt: site memcpy cpu2gpu          ) = 6.555e-04 S  per = 1.55  per(accum) = 7.27
 T(local opt: rintermediate init           ) = 3.586e-05 S  per = 0.0849  per(accum) = 7.35
 T(local opt: preprocess_formulae_Rlist2   ) = 2.951e-03 S  per = 6.99  per(accum) = 14.3
 T(local opt: rmmtasks init                ) = 8.997e-04 S  per = 2.13  per(accum) = 16.5
 T(local opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000142  per(accum) = 16.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.164e-02 S  per = 74.9  per(accum) = 91.4
 T(local opt: deallocate cpu and gpu memory) = 3.116e-05 S  per = 0.0738  per(accum) = 91.5
 T(local opt: construct opS [ifdists=true] ) = 7.000e-08 S  per = 0.000166  per(accum) = 91.5
 T(local opt: reduction of opS & opH [nccl]) = 5.700e-08 S  per = 0.000135  per(accum) = 91.5
 T(local opt: qops memcpy gpu2cpu          ) = 7.837e-05 S  per = 0.186  per(accum) = 91.7
 T(local opt: reduction of opS & opH [mpi] ) = 3.050e-05 S  per = 0.0722  per(accum) = 91.8
 T(local opt: qops_pool join and erase     ) = 3.477e-03 S  per = 8.24  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.874e-06 S  per = 0.00918  per(accum) = 100
##### sweep opt: 3.876e-01 S #####
 T(sweep opt: fetch) = 3.785e-02 S  per = 9.76  per(accum) = 9.76
 T(sweep opt: hdiag) = 6.677e-02 S  per = 17.2  per(accum) = 27
 T(sweep opt: dvdsn) = 2.165e-01 S  per = 55.9  per(accum) = 82.8
 T(sweep opt: decim) = 2.236e-02 S  per = 5.77  per(accum) = 88.6
 T(sweep opt: guess) = 1.579e-03 S  per = 0.407  per(accum) = 89
 T(sweep opt: renrm) = 4.221e-02 S  per = 10.9  per(accum) = 99.9
 T(sweep opt: save ) = 3.387e-04 S  per = 0.0874  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.165e-01 S  T(sum) = 2.162e-01 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 6.941e-03 S  per = 3.21  per(accum) = 3.21
 T(sweep opt: symbolic_formulae           ) = 2.341e-03 S  per = 1.08  per(accum) = 4.29
 T(sweep opt: hintermediate init          ) = 9.933e-05 S  per = 0.0459  per(accum) = 4.34
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.911e-03 S  per = 4.58  per(accum) = 8.92
 T(sweep opt: hmmtasks init               ) = 1.351e-03 S  per = 0.625  per(accum) = 9.55
 T(sweep opt: initial guess for dvdson    ) = 1.577e-03 S  per = 0.729  per(accum) = 10.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.603e-01 S  per = 74.1  per(accum) = 84.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.101e-03 S  per = 1.43  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 3.053e-05 S  per = 0.0141  per(accum) = 85.9
 T(sweep opt: dvdson [mpi]                ) = 6.030e-07 S  per = 0.000279  per(accum) = 85.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.059e-02 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 4.221e-02 S  T(sum) = 4.221e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.362e-04 S  per = 0.323  per(accum) = 0.323
 T(sweep opt: qops init                    ) = 7.017e-04 S  per = 1.66  per(accum) = 1.99
 T(sweep opt: symbolic_formulae_renorm     ) = 1.495e-03 S  per = 3.54  per(accum) = 5.53
 T(sweep opt: allocate qops on gpu         ) = 7.842e-05 S  per = 0.186  per(accum) = 5.71
 T(sweep opt: site memcpy cpu2gpu          ) = 6.555e-04 S  per = 1.55  per(accum) = 7.27
 T(sweep opt: rintermediate init           ) = 3.586e-05 S  per = 0.0849  per(accum) = 7.35
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.951e-03 S  per = 6.99  per(accum) = 14.3
 T(sweep opt: rmmtasks init                ) = 8.997e-04 S  per = 2.13  per(accum) = 16.5
 T(sweep opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000142  per(accum) = 16.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.164e-02 S  per = 74.9  per(accum) = 91.4
 T(sweep opt: deallocate cpu and gpu memory) = 3.116e-05 S  per = 0.0738  per(accum) = 91.5
 T(sweep opt: construct opS [ifdists=true] ) = 7.000e-08 S  per = 0.000166  per(accum) = 91.5
 T(sweep opt: reduction of opS & opH [nccl]) = 5.700e-08 S  per = 0.000135  per(accum) = 91.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.837e-05 S  per = 0.186  per(accum) = 91.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.050e-05 S  per = 0.0722  per(accum) = 91.8
 T(sweep opt: qops_pool join and erase     ) = 3.477e-03 S  per = 8.24  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 3.874e-06 S  per = 0.00918  per(accum) = 100
##### global opt: 3.876e-01 S #####
 T(global opt: fetch) = 3.785e-02 S  per = 9.76  per(accum) = 9.76
 T(global opt: hdiag) = 6.677e-02 S  per = 17.2  per(accum) = 27
 T(global opt: dvdsn) = 2.165e-01 S  per = 55.9  per(accum) = 82.8
 T(global opt: decim) = 2.236e-02 S  per = 5.77  per(accum) = 88.6
 T(global opt: guess) = 1.579e-03 S  per = 0.407  per(accum) = 89
 T(global opt: renrm) = 4.221e-02 S  per = 10.9  per(accum) = 99.9
 T(global opt: save ) = 3.387e-04 S  per = 0.0874  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.165e-01 S  T(sum) = 2.162e-01 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 6.941e-03 S  per = 3.21  per(accum) = 3.21
 T(global opt: symbolic_formulae           ) = 2.341e-03 S  per = 1.08  per(accum) = 4.29
 T(global opt: hintermediate init          ) = 9.933e-05 S  per = 0.0459  per(accum) = 4.34
 T(global opt: preprocess_hformulae_Hxlist ) = 9.911e-03 S  per = 4.58  per(accum) = 8.92
 T(global opt: hmmtasks init               ) = 1.351e-03 S  per = 0.625  per(accum) = 9.55
 T(global opt: initial guess for dvdson    ) = 1.577e-03 S  per = 0.729  per(accum) = 10.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.603e-01 S  per = 74.1  per(accum) = 84.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.101e-03 S  per = 1.43  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 3.053e-05 S  per = 0.0141  per(accum) = 85.9
 T(global opt: dvdson [mpi]                ) = 6.030e-07 S  per = 0.000279  per(accum) = 85.9
 T(global opt: dvdson [rest part(linalg)]  ) = 3.059e-02 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 4.221e-02 S  T(sum) = 4.221e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.362e-04 S  per = 0.323  per(accum) = 0.323
 T(global opt: qops init                    ) = 7.017e-04 S  per = 1.66  per(accum) = 1.99
 T(global opt: symbolic_formulae_renorm     ) = 1.495e-03 S  per = 3.54  per(accum) = 5.53
 T(global opt: allocate qops on gpu         ) = 7.842e-05 S  per = 0.186  per(accum) = 5.71
 T(global opt: site memcpy cpu2gpu          ) = 6.555e-04 S  per = 1.55  per(accum) = 7.27
 T(global opt: rintermediate init           ) = 3.586e-05 S  per = 0.0849  per(accum) = 7.35
 T(global opt: preprocess_formulae_Rlist2   ) = 2.951e-03 S  per = 6.99  per(accum) = 14.3
 T(global opt: rmmtasks init                ) = 8.997e-04 S  per = 2.13  per(accum) = 16.5
 T(global opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000142  per(accum) = 16.5
 T(global opt: preprocess_renorm_batchGPU   ) = 3.164e-02 S  per = 74.9  per(accum) = 91.4
 T(global opt: deallocate cpu and gpu memory) = 3.116e-05 S  per = 0.0738  per(accum) = 91.5
 T(global opt: construct opS [ifdists=true] ) = 7.000e-08 S  per = 0.000166  per(accum) = 91.5
 T(global opt: reduction of opS & opH [nccl]) = 5.700e-08 S  per = 0.000135  per(accum) = 91.5
 T(global opt: qops memcpy gpu2cpu          ) = 7.837e-05 S  per = 0.186  per(accum) = 91.7
 T(global opt: reduction of opS & opH [mpi] ) = 3.050e-05 S  per = 0.0722  per(accum) = 91.8
 T(global opt: qops_pool join and erase     ) = 3.477e-03 S  per = 8.24  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 3.874e-06 S  per = 0.00918  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.469e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=1/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=935:7.133e-03MB:6.966e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=3:2.289e-05MB:2.235e-08GB
total mem of comb=939:7.164e-03MB:6.996e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=31:2.365e-04MB:2.310e-07GB
        per(mem): H:6.45 C:6.45 S:58.1 A:0 B:29 
 rqops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=1204:0.00919MB:8.97e-06GB
        per(mem): H:1.99 C:21.3 S:5.32 P:0 Q:71.4 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3231:0.0247MB:2.41e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.108e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-9.120e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,14,3,3) nnz=9:6.866e-05MB
qtensor4: wf4 own=1 _data=0x3a052a50
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=9 dimAll=14
 (23,1):2 (23,3):2 (23,5):2 (23,7):2 (23,9):2 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=6 nblocks=252 size=9:6.866e-05MB
### DIAG TIMING: total=1.264e-01 t1=3.025e-05, t2=1.448e-03, t3=2.494e-03, t4=1.224e-01, t5=3.657e-06, t6=2.789e-05, t7=3.494e-06
duration_diagGPU:1.264e-01
duration_diagreduce:5.900e-08
duration_diagtransform:3.040e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 2.337e-03 S -----
rank=0 GPUmem(GB): used=2.407e-05 (oper)=2.407e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=195
 no. of hintermediate operators=73
 no. of coefficients=996:7.599e-03MB:7.421e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.553e-05 S -----
rank=0 GPUmem(GB): used=3.149e-05 (oper,hinter)=2.407e-05,7.421e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.439e-02 S size(H_formulae)=195 size(Hxlst2)=6 T(Hmu/Hxlist)=4.411e-04,1.395e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.450e-02 S size(H_formulae)=195 size(Hxlst)=654 -----
rank=0 GPUmem(GB): used=3.149e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.341e-07 batch[need]=3.411e-05 blksize=2 blksize0=2 batchsize=654
rank=0 GPUmem(GB): used=6.574e-05 (oper,hinter,dvdson,batch)=2.407e-05,7.421e-06,1.341e-07,3.411e-05
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=9 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.684e-04,1.003e-02,2.982e-02,1.252e-02,5.315e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=7.638e-04 speed=1.756e-04GB/S T(nccl)=4.660e-06 speed=2.878e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=4 t=1.0e-02 per=1.9e+01 cost=8.1e+03 flops=8.0e+05
 sigma[gemm] counter=4 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=4 i=5 t=7.5e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=4 i=6 t=7.4e-03 per=1.4e+01 cost=6.0e+02 flops=8.2e+04
 sigma[gemm] counter=4 i=7 t=7.5e-03 per=1.4e+01 cost=5.6e+02 flops=7.6e+04
 sigma[gemm] counter=4 total t=3.0e-02 per=5.7e+01 cost=3.2e+03 flops=1.1e+05
 sigma[red] counter=4 t=1.3e-02 per=2.4e+01 cost=1.9e+03 flops=1.5e+05
----- TIMING FOR sigma_tot : t_inter=4.4e-02 t_gemm=1.2e-01 t_reduction=5.0e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=4 t=4.4e-02 per=2.1e+01 cost=9.3e+03 flops=2.1e+05
 sigma_tot[gemm] counter=4 i=0 t=8.9e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=2.6e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=7.6e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=3 t=7.5e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=4 t=2.8e-02 per=1.3e+01 cost=1.7e+03 flops=6.0e+04
 sigma_tot[gemm] counter=4 i=5 t=3.0e-02 per=1.4e+01 cost=1.7e+03 flops=5.7e+04
 sigma_tot[gemm] counter=4 i=6 t=3.0e-02 per=1.4e+01 cost=1.1e+03 flops=3.7e+04
 sigma_tot[gemm] counter=4 i=7 t=3.0e-02 per=1.4e+01 cost=1.1e+03 flops=3.6e+04
 sigma_tot[gemm] counter=4 total t=1.2e-01 per=5.6e+01 cost=5.6e+03 flops=4.7e+04
 sigma_tot[red] counter=4 t=5.0e-02 per=2.4e+01 cost=3.8e+03 flops=7.5e+04
T(sub)=9.0e-06 T(gemm/eig/ortho/gemm/axpy)=2.2e-06,3.9e-06,1.9e-06,7.1e-07,2.1e-07
settings: ndim=9 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.177526452453 -1.116e+03  6.213e-02    1     1  5.327e-02 5.327e-02 5.325e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.011e-03,9.922e-03,2.962e-02,1.266e-02,5.423e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.006e-03 speed=6.685e-05GB/S T(nccl)=4.607e-06 speed=2.911e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=5 t=9.9e-03 per=1.9e+01 cost=8.1e+03 flops=8.1e+05
 sigma[gemm] counter=5 i=0 t=2.0e-05 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=4 t=7.3e-03 per=1.4e+01 cost=1.0e+03 flops=1.4e+05
 sigma[gemm] counter=5 i=5 t=7.4e-03 per=1.4e+01 cost=1.0e+03 flops=1.4e+05
 sigma[gemm] counter=5 i=6 t=7.4e-03 per=1.4e+01 cost=6.0e+02 flops=8.1e+04
 sigma[gemm] counter=5 i=7 t=7.5e-03 per=1.4e+01 cost=5.6e+02 flops=7.5e+04
 sigma[gemm] counter=5 total t=3.0e-02 per=5.7e+01 cost=3.2e+03 flops=1.1e+05
 sigma[red] counter=5 t=1.3e-02 per=2.4e+01 cost=1.9e+03 flops=1.5e+05
----- TIMING FOR sigma_tot : t_inter=5.3e-02 t_gemm=1.5e-01 t_reduction=6.3e-02 tot=2.6e-01 -----
 sigma_tot[inter] counter=5 t=5.3e-02 per=2.0e+01 cost=1.7e+04 flops=3.2e+05
 sigma_tot[gemm] counter=5 i=0 t=2.9e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=2.8e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=9.0e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=3 t=8.9e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=4 t=3.6e-02 per=1.4e+01 cost=2.7e+03 flops=7.6e+04
 sigma_tot[gemm] counter=5 i=5 t=3.7e-02 per=1.4e+01 cost=2.7e+03 flops=7.3e+04
 sigma_tot[gemm] counter=5 i=6 t=3.7e-02 per=1.4e+01 cost=1.7e+03 flops=4.6e+04
 sigma_tot[gemm] counter=5 i=7 t=3.7e-02 per=1.4e+01 cost=1.6e+03 flops=4.4e+04
 sigma_tot[gemm] counter=5 total t=1.5e-01 per=5.6e+01 cost=8.8e+03 flops=5.9e+04
 sigma_tot[red] counter=5 t=6.3e-02 per=2.4e+01 cost=5.7e+03 flops=9.0e+04
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.1e-05,3.4e-06,8.5e-07,2.1e-07
    2   0 -    -116.199122515660 -2.160e-02  1.974e-02    2     2  1.206e-01 6.029e-02 5.379e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.935e-03,1.007e-02,2.961e-02,1.251e-02,5.413e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=1.930e-03 speed=6.948e-05GB/S T(nccl)=4.388e-06 speed=3.056e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=6 t=1.0e-02 per=1.9e+01 cost=8.1e+03 flops=8.0e+05
 sigma[gemm] counter=6 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=3 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=6 i=5 t=7.4e-03 per=1.4e+01 cost=1.0e+03 flops=1.4e+05
 sigma[gemm] counter=6 i=6 t=7.4e-03 per=1.4e+01 cost=6.0e+02 flops=8.2e+04
 sigma[gemm] counter=6 i=7 t=7.4e-03 per=1.4e+01 cost=5.6e+02 flops=7.6e+04
 sigma[gemm] counter=6 total t=3.0e-02 per=5.7e+01 cost=3.2e+03 flops=1.1e+05
 sigma[red] counter=6 t=1.3e-02 per=2.4e+01 cost=1.9e+03 flops=1.5e+05
----- TIMING FOR sigma_tot : t_inter=6.4e-02 t_gemm=1.8e-01 t_reduction=7.6e-02 tot=3.2e-01 -----
 sigma_tot[inter] counter=6 t=6.4e-02 per=2.0e+01 cost=2.5e+04 flops=4.0e+05
 sigma_tot[gemm] counter=6 i=0 t=3.0e-05 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=2.9e-05 per=9.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=1.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=3 t=1.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=4 t=4.3e-02 per=1.4e+01 cost=3.7e+03 flops=8.6e+04
 sigma_tot[gemm] counter=6 i=5 t=4.5e-02 per=1.4e+01 cost=3.7e+03 flops=8.3e+04
 sigma_tot[gemm] counter=6 i=6 t=4.5e-02 per=1.4e+01 cost=2.3e+03 flops=5.2e+04
 sigma_tot[gemm] counter=6 i=7 t=4.5e-02 per=1.4e+01 cost=2.2e+03 flops=4.9e+04
 sigma_tot[gemm] counter=6 total t=1.8e-01 per=5.6e+01 cost=1.2e+04 flops=6.7e+04
 sigma_tot[red] counter=6 t=7.6e-02 per=2.4e+01 cost=7.6e+03 flops=1.0e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.5e-05,2.8e-06,9.8e-07,1.9e-07
    3   0 -    -116.200256352489 -1.134e-03  3.227e-03    3     3  1.921e-01 6.402e-02 5.394e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.774e-03,1.208e-02,3.001e-02,1.261e-02,5.649e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=1.769e-03 speed=7.582e-05GB/S T(nccl)=5.432e-06 speed=2.469e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=7 t=1.2e-02 per=2.2e+01 cost=8.1e+03 flops=6.7e+05
 sigma[gemm] counter=7 i=0 t=2.4e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=2.1e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=2.0e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=3 t=2.0e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=7 i=5 t=7.5e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=7 i=6 t=7.5e-03 per=1.4e+01 cost=6.0e+02 flops=8.1e+04
 sigma[gemm] counter=7 i=7 t=7.6e-03 per=1.4e+01 cost=5.6e+02 flops=7.5e+04
 sigma[gemm] counter=7 total t=3.0e-02 per=5.5e+01 cost=3.2e+03 flops=1.1e+05
 sigma[red] counter=7 t=1.3e-02 per=2.3e+01 cost=1.9e+03 flops=1.5e+05
----- TIMING FOR sigma_tot : t_inter=7.6e-02 t_gemm=2.1e-01 t_reduction=8.8e-02 tot=3.7e-01 -----
 sigma_tot[inter] counter=7 t=7.6e-02 per=2.0e+01 cost=3.4e+04 flops=4.4e+05
 sigma_tot[gemm] counter=7 i=0 t=3.3e-05 per=8.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=3.1e-05 per=8.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=1.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=3 t=1.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=4 t=5.1e-02 per=1.4e+01 cost=4.7e+03 flops=9.3e+04
 sigma_tot[gemm] counter=7 i=5 t=5.2e-02 per=1.4e+01 cost=4.7e+03 flops=9.0e+04
 sigma_tot[gemm] counter=7 i=6 t=5.2e-02 per=1.4e+01 cost=2.9e+03 flops=5.6e+04
 sigma_tot[gemm] counter=7 i=7 t=5.2e-02 per=1.4e+01 cost=2.8e+03 flops=5.3e+04
 sigma_tot[gemm] counter=7 total t=2.1e-01 per=5.6e+01 cost=1.5e+04 flops=7.3e+04
 sigma_tot[red] counter=7 t=8.8e-02 per=2.4e+01 cost=9.5e+03 flops=1.1e+05
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.8e-05,3.8e-06,1.2e-06,2.9e-07
    4   0 -    -116.200293375986 -3.702e-05  6.151e-04    3     4  2.619e-01 6.547e-02 5.461e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.218e-03,1.009e-02,3.031e-02,1.257e-02,5.419e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=1.213e-03 speed=1.105e-04GB/S T(nccl)=4.685e-06 speed=2.863e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=8 t=1.0e-02 per=1.9e+01 cost=8.1e+03 flops=8.0e+05
 sigma[gemm] counter=8 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=3 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=4 t=7.6e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=8 i=5 t=7.5e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=8 i=6 t=7.6e-03 per=1.4e+01 cost=6.0e+02 flops=8.0e+04
 sigma[gemm] counter=8 i=7 t=7.6e-03 per=1.4e+01 cost=5.6e+02 flops=7.4e+04
 sigma[gemm] counter=8 total t=3.0e-02 per=5.7e+01 cost=3.2e+03 flops=1.0e+05
 sigma[red] counter=8 t=1.3e-02 per=2.4e+01 cost=1.9e+03 flops=1.5e+05
----- TIMING FOR sigma_tot : t_inter=8.6e-02 t_gemm=2.4e-01 t_reduction=1.0e-01 tot=4.2e-01 -----
 sigma_tot[inter] counter=8 t=8.6e-02 per=2.0e+01 cost=4.2e+04 flops=4.9e+05
 sigma_tot[gemm] counter=8 i=0 t=3.4e-05 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=3.3e-05 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=1.4e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=3 t=1.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=4 t=5.8e-02 per=1.4e+01 cost=5.7e+03 flops=9.8e+04
 sigma_tot[gemm] counter=8 i=5 t=6.0e-02 per=1.4e+01 cost=5.7e+03 flops=9.6e+04
 sigma_tot[gemm] counter=8 i=6 t=6.0e-02 per=1.4e+01 cost=3.5e+03 flops=5.9e+04
 sigma_tot[gemm] counter=8 i=7 t=6.0e-02 per=1.4e+01 cost=3.3e+03 flops=5.6e+04
 sigma_tot[gemm] counter=8 total t=2.4e-01 per=5.6e+01 cost=1.8e+04 flops=7.7e+04
 sigma_tot[red] counter=8 t=1.0e-01 per=2.4e+01 cost=1.1e+04 flops=1.1e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.4e-05,3.0e-06,9.1e-07,1.8e-07
    5   0 -    -116.200295015218 -1.639e-06  1.722e-04    3     5  3.341e-01 6.681e-02 5.455e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.006e-03,1.003e-02,3.004e-02,1.264e-02,5.373e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=1.001e-03 speed=1.340e-04GB/S T(nccl)=5.437e-06 speed=2.467e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=9 t=1.0e-02 per=1.9e+01 cost=8.1e+03 flops=8.0e+05
 sigma[gemm] counter=9 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=9 i=5 t=7.6e-03 per=1.4e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=9 i=6 t=7.5e-03 per=1.4e+01 cost=6.0e+02 flops=8.1e+04
 sigma[gemm] counter=9 i=7 t=7.5e-03 per=1.4e+01 cost=5.6e+02 flops=7.5e+04
 sigma[gemm] counter=9 total t=3.0e-02 per=5.7e+01 cost=3.2e+03 flops=1.1e+05
 sigma[red] counter=9 t=1.3e-02 per=2.4e+01 cost=1.9e+03 flops=1.5e+05
----- TIMING FOR sigma_tot : t_inter=9.6e-02 t_gemm=2.7e-01 t_reduction=1.1e-01 tot=4.8e-01 -----
 sigma_tot[inter] counter=9 t=9.6e-02 per=2.0e+01 cost=5.0e+04 flops=5.2e+05
 sigma_tot[gemm] counter=9 i=0 t=3.6e-05 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=3.4e-05 per=7.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=1.5e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=3 t=1.5e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=4 t=6.6e-02 per=1.4e+01 cost=6.7e+03 flops=1.0e+05
 sigma_tot[gemm] counter=9 i=5 t=6.7e-02 per=1.4e+01 cost=6.7e+03 flops=1.0e+05
 sigma_tot[gemm] counter=9 i=6 t=6.7e-02 per=1.4e+01 cost=4.1e+03 flops=6.1e+04
 sigma_tot[gemm] counter=9 i=7 t=6.7e-02 per=1.4e+01 cost=3.9e+03 flops=5.8e+04
 sigma_tot[gemm] counter=9 total t=2.7e-01 per=5.6e+01 cost=2.1e+04 flops=8.0e+04
 sigma_tot[red] counter=9 t=1.1e-01 per=2.4e+01 cost=1.3e+04 flops=1.2e+05
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.2e-06,9.4e-07,1.8e-07
    6   0 +    -116.200295182409 -1.672e-07  4.298e-05    3     6  3.998e-01 6.663e-02 5.443e-02
TIMING FOR Davidson : 3.998e-01  T(cal/comm/rest)=3.266e-01,8.210e-07,7.319e-02
decomposed t_rest=7.319e-02
 T(sub)    =1.230e-04 per=1.680e-01
 T(precond)=7.293e-02 per=9.965e+01
 T(ortho)  =1.786e-05 per=2.440e-02
 T(xcopy)  =8.420e-07 per=1.150e-03
 T(xnrm2)  =2.362e-06 per=3.227e-03
 T(other)  =1.100e-04 per=1.504e-01
optimized energies: isweep=0 ibond=1 dots=2 e[0]=-116.200295182409 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.519e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=5 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=5 dimAll=7
 (4,0):2 (6,0):1 (5,1):2 (3,1):1 (4,2):1
timing for divide=8.3e-05
timing for compute=1.3e-02
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.3e-05,1.3e-02,0.0e+00,4.6e-06,1.3e-05 -----
decimation summary: 7->4 dwt=+0.000e+00 SvN=5.745e-01
 qbond: qkept nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
----- TIMING for decimation_row(nkr): 1.309e-02 S T(decim/select/formRot)=1.280e-02,2.519e-04,3.745e-05 -----
----- TIMING FOR twodot_decimation: 1.362e-02 S T(wf/decim)=5.160e-04,1.311e-02 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=155:1.183e-03MB:1.155e-06GB
        per(mem): H:3.87 C:7.74 S:43.9 A:1.94 B:42.6 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.014e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=42 : 1.814e-03 S -----
rank=0 GPUmem(GB): used=2.368e-05 (oper)=8.821e-06
rank=0 GPUmem(GB): used=2.372e-05 (oper,site)=8.821e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=42
 no. of rintermediate operators=141
 no. of coefficients=372:2.838e-03MB:2.772e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.482e-03 S -----
rank=0 GPUmem(GB): used=2.649e-05 (oper,site,rinter)=8.821e-06,4.470e-08,2.772e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 4.494e-03 S size(rtasks)=42 size(Rlst2)=9 T(Rmu/Rlist)=7.030e-04,3.791e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.541e-03 S size(rtasks)=42 size(Rlst)=299 -----
rank=0 GPUmem(GB): used=2.649e-05 avail=6.174e+00 total=6.174e+00 batch[need]=2.228e-05 blksize=4 blksize0=1 batchsize=299
rank=0 GPUmem(GB): used=4.877e-05 (oper,site,rinter,batch)=8.821e-06,4.470e-08,2.772e-06,2.228e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.410e-03,2.281e-02,1.009e-02
----- TIMING FOR renorm : t_inter=5.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=2 t=5.4e-03 per=1.4e+01 cost=9.4e+02 flops=1.7e+05
 renorm[gemm] counter=2 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=7.6e-03 per=2.0e+01 cost=3.9e+02 flops=5.2e+04
 renorm[gemm] counter=2 i=5 t=7.5e-03 per=2.0e+01 cost=4.1e+02 flops=5.4e+04
 renorm[gemm] counter=2 i=6 t=7.7e-03 per=2.0e+01 cost=1.3e+03 flops=1.7e+05
 renorm[gemm] counter=2 total t=2.3e-02 per=6.0e+01 cost=2.1e+03 flops=9.1e+04
 renorm[red] counter=2 t=1.0e-02 per=2.6e+01 cost=1.3e+03 flops=1.3e+05
----- TIMING FOR renorm_tot : t_inter=5.4e-03 t_gemm=4.4e-02 t_reduction=2.0e-02 tot=7.0e-02 -----
 renorm_tot[inter] counter=2 t=5.4e-03 per=7.8e+00 cost=9.4e+02 flops=1.7e+05
 renorm_tot[gemm] counter=2 i=0 t=3.8e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=3.2e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=3.0e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=3.0e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=1.4e-02 per=2.0e+01 cost=4.8e+02 flops=3.5e+04
 renorm_tot[gemm] counter=2 i=5 t=1.5e-02 per=2.2e+01 cost=4.8e+02 flops=3.2e+04
 renorm_tot[gemm] counter=2 i=6 t=1.5e-02 per=2.2e+01 cost=1.5e+03 flops=9.8e+04
 renorm_tot[gemm] counter=2 total t=4.4e-02 per=6.3e+01 cost=2.4e+03 flops=5.5e+04
 renorm_tot[red] counter=2 t=2.0e-02 per=2.9e+01 cost=1.5e+03 flops=7.4e+04
qops.to_cpu: size(tot)=155:1.2e-03MB:1.2e-06GB T(to_cpu)=6.6e-05S speed=1.7e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0519 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.613e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.526e-05 change=-1.275e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.341e-05 change=-1.177e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local opt: 6.388e-01 S #####
 T(local opt: fetch) = 1.841e-02 S  per = 2.88  per(accum) = 2.88
 T(local opt: hdiag) = 1.271e-01 S  per = 19.9  per(accum) = 22.8
 T(local opt: dvdsn) = 4.246e-01 S  per = 66.5  per(accum) = 89.2
 T(local opt: decim) = 1.364e-02 S  per = 2.14  per(accum) = 91.4
 T(local opt: guess) = 1.063e-03 S  per = 0.166  per(accum) = 91.5
 T(local opt: renrm) = 5.373e-02 S  per = 8.41  per(accum) = 100
 T(local opt: save ) = 2.567e-04 S  per = 0.0402  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.246e-01 S  T(sum) = 4.244e-01 S  per = 9.996e+01
 T(local opt: preprocess                  ) = 3.688e-03 S  per = 0.869  per(accum) = 0.869
 T(local opt: symbolic_formulae           ) = 2.347e-03 S  per = 0.553  per(accum) = 1.42
 T(local opt: hintermediate init          ) = 1.093e-04 S  per = 0.0257  per(accum) = 1.45
 T(local opt: preprocess_hformulae_Hxlist ) = 1.452e-02 S  per = 3.42  per(accum) = 4.87
 T(local opt: hmmtasks init               ) = 3.004e-03 S  per = 0.708  per(accum) = 5.58
 T(local opt: initial guess for dvdson    ) = 9.847e-04 S  per = 0.232  per(accum) = 5.81
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.179e-01 S  per = 74.9  per(accum) = 80.7
 T(local opt: dvdson [cpu-gpu]            ) = 8.683e-03 S  per = 2.05  per(accum) = 82.7
 T(local opt: dvdson [nccl]               ) = 2.921e-05 S  per = 0.00688  per(accum) = 82.8
 T(local opt: dvdson [mpi]                ) = 8.210e-07 S  per = 0.000193  per(accum) = 82.8
 T(local opt: dvdson [rest part(linalg)]  ) = 7.319e-02 S  per = 17.2  per(accum) = 100
Detailed decomposition of T(renrm) = 5.373e-02 S  T(sum) = 5.373e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.261e-04 S  per = 0.235  per(accum) = 0.235
 T(local opt: qops init                    ) = 8.350e-04 S  per = 1.55  per(accum) = 1.79
 T(local opt: symbolic_formulae_renorm     ) = 1.824e-03 S  per = 3.39  per(accum) = 5.18
 T(local opt: allocate qops on gpu         ) = 5.223e-05 S  per = 0.0972  per(accum) = 5.28
 T(local opt: site memcpy cpu2gpu          ) = 1.421e-03 S  per = 2.64  per(accum) = 7.92
 T(local opt: rintermediate init           ) = 2.494e-03 S  per = 4.64  per(accum) = 12.6
 T(local opt: preprocess_formulae_Rlist2   ) = 4.556e-03 S  per = 8.48  per(accum) = 21
 T(local opt: rmmtasks init                ) = 2.143e-03 S  per = 3.99  per(accum) = 25
 T(local opt: qops memset on cpu           ) = 3.600e-08 S  per = 6.7e-05  per(accum) = 25
 T(local opt: preprocess_renorm_batchGPU   ) = 3.841e-02 S  per = 71.5  per(accum) = 96.5
 T(local opt: deallocate cpu and gpu memory) = 3.321e-05 S  per = 0.0618  per(accum) = 96.6
 T(local opt: construct opS [ifdists=true] ) = 4.300e-08 S  per = 8e-05  per(accum) = 96.6
 T(local opt: reduction of opS & opH [nccl]) = 4.000e-08 S  per = 7.44e-05  per(accum) = 96.6
 T(local opt: qops memcpy gpu2cpu          ) = 7.320e-05 S  per = 0.136  per(accum) = 96.7
 T(local opt: reduction of opS & opH [mpi] ) = 3.034e-05 S  per = 0.0565  per(accum) = 96.8
 T(local opt: qops_pool join and erase     ) = 1.734e-03 S  per = 3.23  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.391e-06 S  per = 0.00817  per(accum) = 100
##### sweep opt: 1.026e+00 S #####
 T(sweep opt: fetch) = 5.625e-02 S  per = 5.48  per(accum) = 5.48
 T(sweep opt: hdiag) = 1.938e-01 S  per = 18.9  per(accum) = 24.4
 T(sweep opt: dvdsn) = 6.411e-01 S  per = 62.5  per(accum) = 86.8
 T(sweep opt: decim) = 3.600e-02 S  per = 3.51  per(accum) = 90.3
 T(sweep opt: guess) = 2.641e-03 S  per = 0.257  per(accum) = 90.6
 T(sweep opt: renrm) = 9.595e-02 S  per = 9.35  per(accum) = 99.9
 T(sweep opt: save ) = 5.955e-04 S  per = 0.058  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.411e-01 S  T(sum) = 6.406e-01 S  per = 9.993e+01
 T(sweep opt: preprocess                  ) = 1.063e-02 S  per = 1.66  per(accum) = 1.66
 T(sweep opt: symbolic_formulae           ) = 4.688e-03 S  per = 0.732  per(accum) = 2.39
 T(sweep opt: hintermediate init          ) = 2.086e-04 S  per = 0.0326  per(accum) = 2.42
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.443e-02 S  per = 3.81  per(accum) = 6.24
 T(sweep opt: hmmtasks init               ) = 4.355e-03 S  per = 0.68  per(accum) = 6.92
 T(sweep opt: initial guess for dvdson    ) = 2.561e-03 S  per =  0.4  per(accum) = 7.32
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.781e-01 S  per = 74.6  per(accum) = 82
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.178e-02 S  per = 1.84  per(accum) = 83.8
 T(sweep opt: dvdson [nccl]               ) = 5.974e-05 S  per = 0.00932  per(accum) = 83.8
 T(sweep opt: dvdson [mpi]                ) = 1.424e-06 S  per = 0.000222  per(accum) = 83.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.038e-01 S  per = 16.2  per(accum) = 100
Detailed decomposition of T(renrm) = 9.595e-02 S  T(sum) = 9.595e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.623e-04 S  per = 0.273  per(accum) = 0.273
 T(sweep opt: qops init                    ) = 1.537e-03 S  per =  1.6  per(accum) = 1.88
 T(sweep opt: symbolic_formulae_renorm     ) = 3.319e-03 S  per = 3.46  per(accum) = 5.33
 T(sweep opt: allocate qops on gpu         ) = 1.307e-04 S  per = 0.136  per(accum) = 5.47
 T(sweep opt: site memcpy cpu2gpu          ) = 2.076e-03 S  per = 2.16  per(accum) = 7.63
 T(sweep opt: rintermediate init           ) = 2.530e-03 S  per = 2.64  per(accum) = 10.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.508e-03 S  per = 7.82  per(accum) = 18.1
 T(sweep opt: rmmtasks init                ) = 3.043e-03 S  per = 3.17  per(accum) = 21.3
 T(sweep opt: qops memset on cpu           ) = 9.600e-08 S  per = 0.0001  per(accum) = 21.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.004e-02 S  per =   73  per(accum) = 94.3
 T(sweep opt: deallocate cpu and gpu memory) = 6.437e-05 S  per = 0.0671  per(accum) = 94.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.130e-07 S  per = 0.000118  per(accum) = 94.3
 T(sweep opt: reduction of opS & opH [nccl]) = 9.700e-08 S  per = 0.000101  per(accum) = 94.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.516e-04 S  per = 0.158  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.084e-05 S  per = 0.0634  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 5.211e-03 S  per = 5.43  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 8.265e-06 S  per = 0.00861  per(accum) = 100
##### global opt: 1.026e+00 S #####
 T(global opt: fetch) = 5.625e-02 S  per = 5.48  per(accum) = 5.48
 T(global opt: hdiag) = 1.938e-01 S  per = 18.9  per(accum) = 24.4
 T(global opt: dvdsn) = 6.411e-01 S  per = 62.5  per(accum) = 86.8
 T(global opt: decim) = 3.600e-02 S  per = 3.51  per(accum) = 90.3
 T(global opt: guess) = 2.641e-03 S  per = 0.257  per(accum) = 90.6
 T(global opt: renrm) = 9.595e-02 S  per = 9.35  per(accum) = 99.9
 T(global opt: save ) = 5.955e-04 S  per = 0.058  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.411e-01 S  T(sum) = 6.406e-01 S  per = 9.993e+01
 T(global opt: preprocess                  ) = 1.063e-02 S  per = 1.66  per(accum) = 1.66
 T(global opt: symbolic_formulae           ) = 4.688e-03 S  per = 0.732  per(accum) = 2.39
 T(global opt: hintermediate init          ) = 2.086e-04 S  per = 0.0326  per(accum) = 2.42
 T(global opt: preprocess_hformulae_Hxlist ) = 2.443e-02 S  per = 3.81  per(accum) = 6.24
 T(global opt: hmmtasks init               ) = 4.355e-03 S  per = 0.68  per(accum) = 6.92
 T(global opt: initial guess for dvdson    ) = 2.561e-03 S  per =  0.4  per(accum) = 7.32
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.781e-01 S  per = 74.6  per(accum) = 82
 T(global opt: dvdson [cpu-gpu]            ) = 1.178e-02 S  per = 1.84  per(accum) = 83.8
 T(global opt: dvdson [nccl]               ) = 5.974e-05 S  per = 0.00932  per(accum) = 83.8
 T(global opt: dvdson [mpi]                ) = 1.424e-06 S  per = 0.000222  per(accum) = 83.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.038e-01 S  per = 16.2  per(accum) = 100
Detailed decomposition of T(renrm) = 9.595e-02 S  T(sum) = 9.595e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.623e-04 S  per = 0.273  per(accum) = 0.273
 T(global opt: qops init                    ) = 1.537e-03 S  per =  1.6  per(accum) = 1.88
 T(global opt: symbolic_formulae_renorm     ) = 3.319e-03 S  per = 3.46  per(accum) = 5.33
 T(global opt: allocate qops on gpu         ) = 1.307e-04 S  per = 0.136  per(accum) = 5.47
 T(global opt: site memcpy cpu2gpu          ) = 2.076e-03 S  per = 2.16  per(accum) = 7.63
 T(global opt: rintermediate init           ) = 2.530e-03 S  per = 2.64  per(accum) = 10.3
 T(global opt: preprocess_formulae_Rlist2   ) = 7.508e-03 S  per = 7.82  per(accum) = 18.1
 T(global opt: rmmtasks init                ) = 3.043e-03 S  per = 3.17  per(accum) = 21.3
 T(global opt: qops memset on cpu           ) = 9.600e-08 S  per = 0.0001  per(accum) = 21.3
 T(global opt: preprocess_renorm_batchGPU   ) = 7.004e-02 S  per =   73  per(accum) = 94.3
 T(global opt: deallocate cpu and gpu memory) = 6.437e-05 S  per = 0.0671  per(accum) = 94.3
 T(global opt: construct opS [ifdists=true] ) = 1.130e-07 S  per = 0.000118  per(accum) = 94.3
 T(global opt: reduction of opS & opH [nccl]) = 9.700e-08 S  per = 0.000101  per(accum) = 94.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.516e-04 S  per = 0.158  per(accum) = 94.5
 T(global opt: reduction of opS & opH [mpi] ) = 6.084e-05 S  per = 0.0634  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 5.211e-03 S  per = 5.43  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 8.265e-06 S  per = 0.00861  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.457e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=2/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=925:7.057e-03MB:6.892e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=9:6.866e-05MB:6.706e-08GB
total mem of comb=935:7.133e-03MB:6.966e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=155:1.183e-03MB:1.155e-06GB
        per(mem): H:3.87 C:7.74 S:43.9 A:1.94 B:42.6 
 rqops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=2439:0.0186MB:1.82e-05GB
        per(mem): H:1.6 C:11.1 S:3.69 P:0 Q:83.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4590:0.035MB:3.42e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.079e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(4,15,3,3) nnz=22:1.678e-04MB
qtensor4: wf4 own=1 _data=0x44d27ad0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
 qbond: qcol nsym=7 dimAll=15
 (22,2):3 (22,4):3 (22,6):3 (22,8):3 (23,3):1 (23,5):1 (23,7):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=7 nblocks=308 size=22:1.678e-04MB
### DIAG TIMING: total=1.793e-01 t1=2.683e-05, t2=1.655e-03, t3=2.552e-03, t4=1.751e-01, t5=3.230e-06, t6=1.463e-05, t7=4.327e-06
duration_diagGPU:1.793e-01
duration_diagreduce:5.800e-08
duration_diagtransform:3.400e-07
----- TIMING FOR symbolic_formulae_twodot with size=273 : 3.426e-03 S -----
rank=0 GPUmem(GB): used=3.420e-05 (oper)=3.420e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=273
 no. of hintermediate operators=118
 no. of coefficients=1632:1.245e-02MB:1.216e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.286e-04 S -----
rank=0 GPUmem(GB): used=4.636e-05 (oper,hinter)=3.420e-05,1.216e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.762e-02 S size(H_formulae)=273 size(Hxlst2)=7 T(Hmu/Hxlist)=6.687e-04,2.695e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.785e-02 S size(H_formulae)=273 size(Hxlst)=1152 -----
rank=0 GPUmem(GB): used=4.636e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=3.278e-07 batch[need]=1.459e-04 blksize=6 blksize0=4 batchsize=1152
rank=0 GPUmem(GB): used=1.926e-04 (oper,hinter,dvdson,batch)=3.420e-05,1.216e-05,3.278e-07,1.459e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=22 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.924e-04,1.008e-02,2.965e-02,1.252e-02,5.255e-02
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=2.867e-04 speed=1.143e-03GB/S T(nccl)=5.647e-06 speed=5.805e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=10 t=1.0e-02 per=1.9e+01 cost=2.8e+04 flops=2.8e+06
 sigma[gemm] counter=10 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=1.1e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=4 t=7.4e-03 per=1.4e+01 cost=4.8e+03 flops=6.5e+05
 sigma[gemm] counter=10 i=5 t=7.4e-03 per=1.4e+01 cost=4.9e+03 flops=6.6e+05
 sigma[gemm] counter=10 i=6 t=7.4e-03 per=1.4e+01 cost=4.3e+03 flops=5.8e+05
 sigma[gemm] counter=10 i=7 t=7.4e-03 per=1.4e+01 cost=4.2e+03 flops=5.7e+05
 sigma[gemm] counter=10 total t=3.0e-02 per=5.7e+01 cost=1.8e+04 flops=6.1e+05
 sigma[red] counter=10 t=1.3e-02 per=2.4e+01 cost=7.2e+03 flops=5.8e+05
----- TIMING FOR sigma_tot : t_inter=1.1e-01 t_gemm=3.0e-01 t_reduction=1.3e-01 tot=5.3e-01 -----
 sigma_tot[inter] counter=10 t=1.1e-01 per=2.0e+01 cost=7.7e+04 flops=7.3e+05
 sigma_tot[gemm] counter=10 i=0 t=3.7e-05 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=3.5e-05 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=1.6e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=3 t=1.6e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=4 t=7.3e-02 per=1.4e+01 cost=1.2e+04 flops=1.6e+05
 sigma_tot[gemm] counter=10 i=5 t=7.5e-02 per=1.4e+01 cost=1.2e+04 flops=1.6e+05
 sigma_tot[gemm] counter=10 i=6 t=7.5e-02 per=1.4e+01 cost=8.4e+03 flops=1.1e+05
 sigma_tot[gemm] counter=10 i=7 t=7.5e-02 per=1.4e+01 cost=8.1e+03 flops=1.1e+05
 sigma_tot[gemm] counter=10 total t=3.0e-01 per=5.6e+01 cost=4.0e+04 flops=1.3e+05
 sigma_tot[red] counter=10 t=1.3e-01 per=2.4e+01 cost=2.1e+04 flops=1.6e+05
T(sub)=9.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.0e-06,2.0e-06,7.1e-07,1.8e-07
settings: ndim=22 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.200295182409 -1.116e+03  6.222e-02    1     1  5.268e-02 5.268e-02 5.266e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.644e-03,9.985e-03,3.025e-02,1.264e-02,5.452e-02
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=1.640e-03 speed=1.999e-04GB/S T(nccl)=4.532e-06 speed=7.234e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=11 t=1.0e-02 per=1.9e+01 cost=2.8e+04 flops=2.8e+06
 sigma[gemm] counter=11 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=4 t=7.6e-03 per=1.4e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=11 i=5 t=7.6e-03 per=1.4e+01 cost=4.9e+03 flops=6.4e+05
 sigma[gemm] counter=11 i=6 t=7.5e-03 per=1.4e+01 cost=4.3e+03 flops=5.8e+05
 sigma[gemm] counter=11 i=7 t=7.6e-03 per=1.4e+01 cost=4.2e+03 flops=5.5e+05
 sigma[gemm] counter=11 total t=3.0e-02 per=5.7e+01 cost=1.8e+04 flops=6.0e+05
 sigma[red] counter=11 t=1.3e-02 per=2.4e+01 cost=7.2e+03 flops=5.7e+05
----- TIMING FOR sigma_tot : t_inter=1.2e-01 t_gemm=3.3e-01 t_reduction=1.4e-01 tot=5.8e-01 -----
 sigma_tot[inter] counter=11 t=1.2e-01 per=2.0e+01 cost=1.1e+05 flops=9.1e+05
 sigma_tot[gemm] counter=11 i=0 t=3.9e-05 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=3.7e-05 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=1.8e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=3 t=1.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=4 t=8.1e-02 per=1.4e+01 cost=1.6e+04 flops=2.0e+05
 sigma_tot[gemm] counter=11 i=5 t=8.2e-02 per=1.4e+01 cost=1.7e+04 flops=2.0e+05
 sigma_tot[gemm] counter=11 i=6 t=8.2e-02 per=1.4e+01 cost=1.3e+04 flops=1.6e+05
 sigma_tot[gemm] counter=11 i=7 t=8.2e-02 per=1.4e+01 cost=1.2e+04 flops=1.5e+05
 sigma_tot[gemm] counter=11 total t=3.3e-01 per=5.6e+01 cost=5.8e+04 flops=1.8e+05
 sigma_tot[red] counter=11 t=1.4e-01 per=2.4e+01 cost=2.8e+04 flops=2.0e+05
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.0e-05,3.5e-06,8.7e-07,1.9e-07
    2   0 -    -116.214498322664 -1.420e-02  1.954e-02    2     2  1.206e-01 6.031e-02 5.364e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.489e-03,9.959e-03,3.034e-02,1.271e-02,5.451e-02
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=1.483e-03 speed=2.210e-04GB/S T(nccl)=5.759e-06 speed=5.692e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=12 t=1.0e-02 per=1.9e+01 cost=2.8e+04 flops=2.8e+06
 sigma[gemm] counter=12 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=3 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=4 t=7.6e-03 per=1.4e+01 cost=4.8e+03 flops=6.3e+05
 sigma[gemm] counter=12 i=5 t=7.7e-03 per=1.4e+01 cost=4.9e+03 flops=6.4e+05
 sigma[gemm] counter=12 i=6 t=7.5e-03 per=1.4e+01 cost=4.3e+03 flops=5.8e+05
 sigma[gemm] counter=12 i=7 t=7.6e-03 per=1.4e+01 cost=4.2e+03 flops=5.5e+05
 sigma[gemm] counter=12 total t=3.0e-02 per=5.7e+01 cost=1.8e+04 flops=6.0e+05
 sigma[red] counter=12 t=1.3e-02 per=2.4e+01 cost=7.2e+03 flops=5.7e+05
----- TIMING FOR sigma_tot : t_inter=1.3e-01 t_gemm=3.6e-01 t_reduction=1.5e-01 tot=6.4e-01 -----
 sigma_tot[inter] counter=12 t=1.3e-01 per=2.0e+01 cost=1.3e+05 flops=1.1e+06
 sigma_tot[gemm] counter=12 i=0 t=4.1e-05 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=3.8e-05 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=1.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=3 t=1.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=4 t=8.9e-02 per=1.4e+01 cost=2.1e+04 flops=2.4e+05
 sigma_tot[gemm] counter=12 i=5 t=9.0e-02 per=1.4e+01 cost=2.1e+04 flops=2.4e+05
 sigma_tot[gemm] counter=12 i=6 t=9.0e-02 per=1.4e+01 cost=1.7e+04 flops=1.9e+05
 sigma_tot[gemm] counter=12 i=7 t=9.0e-02 per=1.4e+01 cost=1.6e+04 flops=1.8e+05
 sigma_tot[gemm] counter=12 total t=3.6e-01 per=5.6e+01 cost=7.6e+04 flops=2.1e+05
 sigma_tot[red] counter=12 t=1.5e-01 per=2.4e+01 cost=3.5e+04 flops=2.3e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.4e-06,1.1e-06,2.2e-07
    3   0 -    -116.215692407463 -1.194e-03  6.197e-03    3     3  1.887e-01 6.290e-02 5.397e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.684e-04,1.261e-02,2.981e-02,1.265e-02,5.565e-02
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=5.614e-04 speed=5.839e-04GB/S T(nccl)=7.008e-06 speed=4.678e-02GB/S
----- TIMING FOR sigma : t_inter=1.3e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=13 t=1.3e-02 per=2.3e+01 cost=2.8e+04 flops=2.2e+06
 sigma[gemm] counter=13 i=0 t=5.1e-06 per=9.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=4.2e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=4.0e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=3 t=4.1e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=4 t=7.1e-03 per=1.3e+01 cost=4.8e+03 flops=6.8e+05
 sigma[gemm] counter=13 i=5 t=7.6e-03 per=1.4e+01 cost=4.9e+03 flops=6.5e+05
 sigma[gemm] counter=13 i=6 t=7.6e-03 per=1.4e+01 cost=4.3e+03 flops=5.7e+05
 sigma[gemm] counter=13 i=7 t=7.6e-03 per=1.4e+01 cost=4.2e+03 flops=5.5e+05
 sigma[gemm] counter=13 total t=3.0e-02 per=5.4e+01 cost=1.8e+04 flops=6.1e+05
 sigma[red] counter=13 t=1.3e-02 per=2.3e+01 cost=7.2e+03 flops=5.7e+05
----- TIMING FOR sigma_tot : t_inter=1.4e-01 t_gemm=3.9e-01 t_reduction=1.6e-01 tot=6.9e-01 -----
 sigma_tot[inter] counter=13 t=1.4e-01 per=2.0e+01 cost=1.6e+05 flops=1.2e+06
 sigma_tot[gemm] counter=13 i=0 t=4.6e-05 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=4.2e-05 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=2.3e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=3 t=2.3e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=4 t=9.6e-02 per=1.4e+01 cost=2.6e+04 flops=2.7e+05
 sigma_tot[gemm] counter=13 i=5 t=9.8e-02 per=1.4e+01 cost=2.6e+04 flops=2.7e+05
 sigma_tot[gemm] counter=13 i=6 t=9.7e-02 per=1.4e+01 cost=2.1e+04 flops=2.2e+05
 sigma_tot[gemm] counter=13 i=7 t=9.7e-02 per=1.4e+01 cost=2.1e+04 flops=2.1e+05
 sigma_tot[gemm] counter=13 total t=3.9e-01 per=5.6e+01 cost=9.4e+04 flops=2.4e+05
 sigma_tot[red] counter=13 t=1.6e-01 per=2.4e+01 cost=4.2e+04 flops=2.6e+05
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.9e-06,2.6e-05,5.9e-06,1.7e-06,4.2e-07
    4   0 -    -116.215785169807 -9.276e-05  1.460e-03    3     4  2.569e-01 6.422e-02 5.445e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.284e-03,1.004e-02,3.033e-02,1.273e-02,5.439e-02
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=1.276e-03 speed=2.569e-04GB/S T(nccl)=7.668e-06 speed=4.275e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=14 t=1.0e-02 per=1.9e+01 cost=2.8e+04 flops=2.8e+06
 sigma[gemm] counter=14 i=0 t=4.1e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=3.5e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=3.5e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=3 t=3.5e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=4 t=7.5e-03 per=1.4e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=14 i=5 t=7.5e-03 per=1.4e+01 cost=4.9e+03 flops=6.5e+05
 sigma[gemm] counter=14 i=6 t=7.6e-03 per=1.4e+01 cost=4.3e+03 flops=5.7e+05
 sigma[gemm] counter=14 i=7 t=7.7e-03 per=1.4e+01 cost=4.2e+03 flops=5.5e+05
 sigma[gemm] counter=14 total t=3.0e-02 per=5.7e+01 cost=1.8e+04 flops=6.0e+05
 sigma[red] counter=14 t=1.3e-02 per=2.4e+01 cost=7.2e+03 flops=5.7e+05
----- TIMING FOR sigma_tot : t_inter=1.5e-01 t_gemm=4.2e-01 t_reduction=1.8e-01 tot=7.4e-01 -----
 sigma_tot[inter] counter=14 t=1.5e-01 per=2.0e+01 cost=1.9e+05 flops=1.3e+06
 sigma_tot[gemm] counter=14 i=0 t=5.0e-05 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=4.6e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=2.7e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=3 t=2.7e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=4 t=1.0e-01 per=1.4e+01 cost=3.1e+04 flops=3.0e+05
 sigma_tot[gemm] counter=14 i=5 t=1.1e-01 per=1.4e+01 cost=3.1e+04 flops=3.0e+05
 sigma_tot[gemm] counter=14 i=6 t=1.0e-01 per=1.4e+01 cost=2.6e+04 flops=2.5e+05
 sigma_tot[gemm] counter=14 i=7 t=1.1e-01 per=1.4e+01 cost=2.5e+04 flops=2.4e+05
 sigma_tot[gemm] counter=14 total t=4.2e-01 per=5.6e+01 cost=1.1e+05 flops=2.7e+05
 sigma_tot[red] counter=14 t=1.8e-01 per=2.4e+01 cost=5.0e+04 flops=2.8e+05
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.9e-06,2.6e-05,5.9e-06,1.7e-06,4.5e-07
    5   0 -    -116.215791754882 -6.585e-06  4.041e-04    3     5  3.314e-01 6.627e-02 5.448e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.307e-04,1.003e-02,3.005e-02,5.185e-03,4.621e-02
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=9.251e-04 speed=3.544e-04GB/S T(nccl)=5.657e-06 speed=5.795e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=5.2e-03 tot=4.5e-02 -----
 sigma[inter] counter=15 t=1.0e-02 per=2.2e+01 cost=2.8e+04 flops=2.8e+06
 sigma[gemm] counter=15 i=0 t=2.0e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=1.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=1.7e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=3 t=1.7e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=4 t=7.5e-03 per=1.7e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=15 i=5 t=7.5e-03 per=1.7e+01 cost=4.9e+03 flops=6.6e+05
 sigma[gemm] counter=15 i=6 t=7.5e-03 per=1.7e+01 cost=4.3e+03 flops=5.7e+05
 sigma[gemm] counter=15 i=7 t=7.6e-03 per=1.7e+01 cost=4.2e+03 flops=5.5e+05
 sigma[gemm] counter=15 total t=3.0e-02 per=6.6e+01 cost=1.8e+04 flops=6.1e+05
 sigma[red] counter=15 t=5.2e-03 per=1.1e+01 cost=7.2e+03 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.6e-01 t_gemm=4.5e-01 t_reduction=1.8e-01 tot=7.9e-01 -----
 sigma_tot[inter] counter=15 t=1.6e-01 per=2.0e+01 cost=2.2e+05 flops=1.4e+06
 sigma_tot[gemm] counter=15 i=0 t=5.2e-05 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=4.7e-05 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=2.8e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=3 t=2.8e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=4 t=1.1e-01 per=1.4e+01 cost=3.6e+04 flops=3.2e+05
 sigma_tot[gemm] counter=15 i=5 t=1.1e-01 per=1.4e+01 cost=3.6e+04 flops=3.2e+05
 sigma_tot[gemm] counter=15 i=6 t=1.1e-01 per=1.4e+01 cost=3.0e+04 flops=2.7e+05
 sigma_tot[gemm] counter=15 i=7 t=1.1e-01 per=1.4e+01 cost=2.9e+04 flops=2.6e+05
 sigma_tot[gemm] counter=15 total t=4.5e-01 per=5.7e+01 cost=1.3e+05 flops=2.9e+05
 sigma_tot[red] counter=15 t=1.8e-01 per=2.3e+01 cost=5.7e+04 flops=3.1e+05
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.6e-05,3.6e-06,1.2e-06,2.8e-07
    6   0 -    -116.215792238422 -4.835e-07  1.486e-04    3     6  3.958e-01 6.597e-02 5.313e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.620e-03,1.211e-02,2.994e-02,1.250e-02,5.617e-02
 analyze_tgpu[Hx]: ndim=22:1.639e-07GB T(cpu-gpu)=1.615e-03 speed=2.030e-04GB/S T(nccl)=5.145e-06 speed=6.372e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.5e-02 -----
 sigma[inter] counter=16 t=1.2e-02 per=2.2e+01 cost=2.8e+04 flops=2.3e+06
 sigma[gemm] counter=16 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=3 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=4 t=7.5e-03 per=1.4e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=16 i=5 t=7.5e-03 per=1.4e+01 cost=4.9e+03 flops=6.5e+05
 sigma[gemm] counter=16 i=6 t=7.5e-03 per=1.4e+01 cost=4.3e+03 flops=5.7e+05
 sigma[gemm] counter=16 i=7 t=7.4e-03 per=1.4e+01 cost=4.2e+03 flops=5.6e+05
 sigma[gemm] counter=16 total t=3.0e-02 per=5.5e+01 cost=1.8e+04 flops=6.1e+05
 sigma[red] counter=16 t=1.2e-02 per=2.3e+01 cost=7.2e+03 flops=5.8e+05
----- TIMING FOR sigma_tot : t_inter=1.7e-01 t_gemm=4.8e-01 t_reduction=1.9e-01 tot=8.4e-01 -----
 sigma_tot[inter] counter=16 t=1.7e-01 per=2.0e+01 cost=2.4e+05 flops=1.4e+06
 sigma_tot[gemm] counter=16 i=0 t=5.4e-05 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=4.9e-05 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=3.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=3 t=3.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=4 t=1.2e-01 per=1.4e+01 cost=4.0e+04 flops=3.4e+05
 sigma_tot[gemm] counter=16 i=5 t=1.2e-01 per=1.4e+01 cost=4.1e+04 flops=3.4e+05
 sigma_tot[gemm] counter=16 i=6 t=1.2e-01 per=1.4e+01 cost=3.4e+04 flops=2.9e+05
 sigma_tot[gemm] counter=16 i=7 t=1.2e-01 per=1.4e+01 cost=3.3e+04 flops=2.8e+05
 sigma_tot[gemm] counter=16 total t=4.8e-01 per=5.7e+01 cost=1.5e+05 flops=3.1e+05
 sigma_tot[red] counter=16 t=1.9e-01 per=2.3e+01 cost=6.4e+04 flops=3.3e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.6e-05,3.3e-06,1.3e-06,2.2e-07
    7   0 +    -116.215792300366 -6.194e-08  5.489e-05    3     7  4.633e-01 6.619e-02 5.358e-02
TIMING FOR Davidson : 4.633e-01  T(cal/comm/rest)=3.751e-01,1.423e-06,8.827e-02
decomposed t_rest=8.827e-02
 T(sub)    =1.835e-04 per=2.079e-01
 T(precond)=8.787e-02 per=9.955e+01
 T(ortho)  =2.728e-05 per=3.091e-02
 T(xcopy)  =1.063e-06 per=1.204e-03
 T(xnrm2)  =3.696e-06 per=4.187e-03
 T(other)  =1.827e-04 per=2.070e-01
optimized energies: isweep=0 ibond=2 dots=2 e[0]=-116.215792300366 nmvp=7
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=6.876e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=7 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=7 dimAll=15
 (5,1):3 (7,1):3 (6,0):3 (6,2):3 (8,0):1 (4,2):1 (5,3):1
timing for divide=9.4e-05
timing for compute=9.5e-03
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(su2): 9.7e-03 S T(divide/compute[cpu/gpu/rest]/collect)=9.4e-05,9.5e-03,0.0e+00,4.3e-06,1.3e-05 -----
decimation summary: 15->7 dwt=+0.000e+00 SvN=6.051e-01
 qbond: qkept nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
----- TIMING for decimation_row(nkr): 1.002e-02 S T(decim/select/formRot)=9.694e-03,2.852e-04,4.453e-05 -----
----- TIMING FOR twodot_decimation: 1.057e-02 S T(wf/decim)=5.371e-04,1.004e-02 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=657:5.013e-03MB:4.895e-06GB
        per(mem): H:2.89 C:7.31 S:29.2 A:2.74 B:57.8 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=3.415e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.095e-03 S -----
rank=0 GPUmem(GB): used=3.308e-05 (oper)=1.349e-05
rank=0 GPUmem(GB): used=3.322e-05 (oper,site)=1.349e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=149
 no. of coefficients=702:5.356e-03MB:5.230e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.652e-03 S -----
rank=0 GPUmem(GB): used=3.845e-05 (oper,site,rinter)=1.349e-05,1.416e-07,5.230e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 9.288e-03 S size(rtasks)=57 size(Rlst2)=9 T(Rmu/Rlist)=1.243e-03,8.045e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.437e-03 S size(rtasks)=57 size(Rlst)=459 -----
rank=0 GPUmem(GB): used=3.845e-05 avail=6.174e+00 total=6.174e+00 batch[need]=7.866e-05 blksize=9 blksize0=4 batchsize=459
rank=0 GPUmem(GB): used=1.171e-04 (oper,site,rinter,batch)=1.349e-05,1.416e-07,5.230e-06,7.866e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.256e-03,2.225e-02,1.008e-02
----- TIMING FOR renorm : t_inter=5.3e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=3 t=5.3e-03 per=1.4e+01 cost=5.7e+03 flops=1.1e+06
 renorm[gemm] counter=3 i=0 t=2.2e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.9e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=1.9e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.8e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=7.4e-03 per=2.0e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=3 i=5 t=7.4e-03 per=2.0e+01 cost=2.8e+03 flops=3.8e+05
 renorm[gemm] counter=3 i=6 t=7.4e-03 per=2.0e+01 cost=9.7e+03 flops=1.3e+06
 renorm[gemm] counter=3 total t=2.2e-02 per=5.9e+01 cost=1.5e+04 flops=6.7e+05
 renorm[red] counter=3 t=1.0e-02 per=2.7e+01 cost=6.2e+03 flops=6.1e+05
----- TIMING FOR renorm_tot : t_inter=1.1e-02 t_gemm=6.6e-02 t_reduction=3.0e-02 tot=1.1e-01 -----
 renorm_tot[inter] counter=3 t=1.1e-02 per=9.9e+00 cost=6.6e+03 flops=6.2e+05
 renorm_tot[gemm] counter=3 i=0 t=6.0e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=5.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=4.9e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=4.9e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=2.1e-02 per=2.0e+01 cost=2.8e+03 flops=1.3e+05
 renorm_tot[gemm] counter=3 i=5 t=2.3e-02 per=2.1e+01 cost=3.3e+03 flops=1.5e+05
 renorm_tot[gemm] counter=3 i=6 t=2.3e-02 per=2.1e+01 cost=1.1e+04 flops=4.9e+05
 renorm_tot[gemm] counter=3 total t=6.6e-02 per=6.2e+01 cost=1.7e+04 flops=2.6e+05
 renorm_tot[red] counter=3 t=3.0e-02 per=2.8e+01 cost=7.7e+03 flops=2.5e+05
qops.to_cpu: size(tot)=657:5.0e-03MB:4.9e-06GB T(to_cpu)=1.1e-04S speed=4.5e-02GB/S
check ||H-H.dagger||=6.910e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0626 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=2.231e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.289e-04 change=-1.312e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.289e-04 change=-1.669e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local opt: 7.774e-01 S #####
 T(local opt: fetch) = 1.440e-02 S  per = 1.85  per(accum) = 1.85
 T(local opt: hdiag) = 1.800e-01 S  per = 23.1  per(accum) = 25
 T(local opt: dvdsn) = 5.059e-01 S  per = 65.1  per(accum) = 90.1
 T(local opt: decim) = 1.059e-02 S  per = 1.36  per(accum) = 91.4
 T(local opt: guess) = 1.129e-03 S  per = 0.145  per(accum) = 91.6
 T(local opt: renrm) = 6.508e-02 S  per = 8.37  per(accum) = 100
 T(local opt: save ) = 3.467e-04 S  per = 0.0446  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.059e-01 S  T(sum) = 5.057e-01 S  per = 9.996e+01
 T(local opt: preprocess                  ) = 4.429e-03 S  per = 0.876  per(accum) = 0.876
 T(local opt: symbolic_formulae           ) = 3.438e-03 S  per = 0.68  per(accum) = 1.56
 T(local opt: hintermediate init          ) = 1.422e-04 S  per = 0.0281  per(accum) = 1.58
 T(local opt: preprocess_hformulae_Hxlist ) = 2.788e-02 S  per = 5.51  per(accum) = 7.1
 T(local opt: hmmtasks init               ) = 5.329e-03 S  per = 1.05  per(accum) = 8.15
 T(local opt: initial guess for dvdson    ) = 1.190e-03 S  per = 0.235  per(accum) = 8.39
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.672e-01 S  per = 72.6  per(accum) = 81
 T(local opt: dvdson [cpu-gpu]            ) = 7.788e-03 S  per = 1.54  per(accum) = 82.5
 T(local opt: dvdson [nccl]               ) = 4.142e-05 S  per = 0.00819  per(accum) = 82.5
 T(local opt: dvdson [mpi]                ) = 1.423e-06 S  per = 0.000281  per(accum) = 82.5
 T(local opt: dvdson [rest part(linalg)]  ) = 8.827e-02 S  per = 17.5  per(accum) = 100
Detailed decomposition of T(renrm) = 6.508e-02 S  T(sum) = 6.508e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.646e-04 S  per = 0.253  per(accum) = 0.253
 T(local opt: qops init                    ) = 1.013e-03 S  per = 1.56  per(accum) = 1.81
 T(local opt: symbolic_formulae_renorm     ) = 2.105e-03 S  per = 3.23  per(accum) = 5.04
 T(local opt: allocate qops on gpu         ) = 5.760e-05 S  per = 0.0885  per(accum) = 5.13
 T(local opt: site memcpy cpu2gpu          ) = 1.783e-03 S  per = 2.74  per(accum) = 7.87
 T(local opt: rintermediate init           ) = 5.689e-03 S  per = 8.74  per(accum) = 16.6
 T(local opt: preprocess_formulae_Rlist2   ) = 9.466e-03 S  per = 14.5  per(accum) = 31.2
 T(local opt: rmmtasks init                ) = 4.583e-03 S  per = 7.04  per(accum) = 38.2
 T(local opt: qops memset on cpu           ) = 7.400e-08 S  per = 0.000114  per(accum) = 38.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.771e-02 S  per =   58  per(accum) = 96.2
 T(local opt: deallocate cpu and gpu memory) = 4.844e-05 S  per = 0.0744  per(accum) = 96.2
 T(local opt: construct opS [ifdists=true] ) = 1.050e-07 S  per = 0.000161  per(accum) = 96.2
 T(local opt: reduction of opS & opH [nccl]) = 5.600e-08 S  per = 8.61e-05  per(accum) = 96.2
 T(local opt: qops memcpy gpu2cpu          ) = 1.177e-04 S  per = 0.181  per(accum) = 96.4
 T(local opt: reduction of opS & opH [mpi] ) = 4.462e-05 S  per = 0.0686  per(accum) = 96.5
 T(local opt: qops_pool join and erase     ) = 2.287e-03 S  per = 3.51  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 5.123e-06 S  per = 0.00787  per(accum) = 100
##### sweep opt: 1.804e+00 S #####
 T(sweep opt: fetch) = 7.065e-02 S  per = 3.92  per(accum) = 3.92
 T(sweep opt: hdiag) = 3.738e-01 S  per = 20.7  per(accum) = 24.6
 T(sweep opt: dvdsn) = 1.147e+00 S  per = 63.6  per(accum) = 88.2
 T(sweep opt: decim) = 4.659e-02 S  per = 2.58  per(accum) = 90.8
 T(sweep opt: guess) = 3.770e-03 S  per = 0.209  per(accum) = 91
 T(sweep opt: renrm) = 1.610e-01 S  per = 8.93  per(accum) = 99.9
 T(sweep opt: save ) = 9.421e-04 S  per = 0.0522  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.147e+00 S  T(sum) = 1.146e+00 S  per = 9.994e+01
 T(sweep opt: preprocess                  ) = 1.506e-02 S  per = 1.31  per(accum) = 1.31
 T(sweep opt: symbolic_formulae           ) = 8.126e-03 S  per = 0.709  per(accum) = 2.02
 T(sweep opt: hintermediate init          ) = 3.508e-04 S  per = 0.0306  per(accum) = 2.05
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.231e-02 S  per = 4.56  per(accum) = 6.62
 T(sweep opt: hmmtasks init               ) = 9.683e-03 S  per = 0.845  per(accum) = 7.46
 T(sweep opt: initial guess for dvdson    ) = 3.751e-03 S  per = 0.327  per(accum) = 7.79
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 8.454e-01 S  per = 73.7  per(accum) = 81.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.957e-02 S  per = 1.71  per(accum) = 83.2
 T(sweep opt: dvdson [nccl]               ) = 1.012e-04 S  per = 0.00882  per(accum) = 83.2
 T(sweep opt: dvdson [mpi]                ) = 2.847e-06 S  per = 0.000248  per(accum) = 83.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.920e-01 S  per = 16.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.610e-01 S  T(sum) = 1.610e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.269e-04 S  per = 0.265  per(accum) = 0.265
 T(sweep opt: qops init                    ) = 2.549e-03 S  per = 1.58  per(accum) = 1.85
 T(sweep opt: symbolic_formulae_renorm     ) = 5.424e-03 S  per = 3.37  per(accum) = 5.22
 T(sweep opt: allocate qops on gpu         ) = 1.883e-04 S  per = 0.117  per(accum) = 5.33
 T(sweep opt: site memcpy cpu2gpu          ) = 3.859e-03 S  per =  2.4  per(accum) = 7.73
 T(sweep opt: rintermediate init           ) = 8.220e-03 S  per =  5.1  per(accum) = 12.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.697e-02 S  per = 10.5  per(accum) = 23.4
 T(sweep opt: rmmtasks init                ) = 7.626e-03 S  per = 4.74  per(accum) = 28.1
 T(sweep opt: qops memset on cpu           ) = 1.700e-07 S  per = 0.000106  per(accum) = 28.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.078e-01 S  per = 66.9  per(accum) = 95
 T(sweep opt: deallocate cpu and gpu memory) = 1.128e-04 S  per = 0.0701  per(accum) = 95.1
 T(sweep opt: construct opS [ifdists=true] ) = 2.180e-07 S  per = 0.000135  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.530e-07 S  per = 9.5e-05  per(accum) = 95.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.692e-04 S  per = 0.167  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.055e-04 S  per = 0.0655  per(accum) = 95.3
 T(sweep opt: qops_pool join and erase     ) = 7.498e-03 S  per = 4.66  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.339e-05 S  per = 0.00831  per(accum) = 100
##### global opt: 1.804e+00 S #####
 T(global opt: fetch) = 7.065e-02 S  per = 3.92  per(accum) = 3.92
 T(global opt: hdiag) = 3.738e-01 S  per = 20.7  per(accum) = 24.6
 T(global opt: dvdsn) = 1.147e+00 S  per = 63.6  per(accum) = 88.2
 T(global opt: decim) = 4.659e-02 S  per = 2.58  per(accum) = 90.8
 T(global opt: guess) = 3.770e-03 S  per = 0.209  per(accum) = 91
 T(global opt: renrm) = 1.610e-01 S  per = 8.93  per(accum) = 99.9
 T(global opt: save ) = 9.421e-04 S  per = 0.0522  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.147e+00 S  T(sum) = 1.146e+00 S  per = 9.994e+01
 T(global opt: preprocess                  ) = 1.506e-02 S  per = 1.31  per(accum) = 1.31
 T(global opt: symbolic_formulae           ) = 8.126e-03 S  per = 0.709  per(accum) = 2.02
 T(global opt: hintermediate init          ) = 3.508e-04 S  per = 0.0306  per(accum) = 2.05
 T(global opt: preprocess_hformulae_Hxlist ) = 5.231e-02 S  per = 4.56  per(accum) = 6.62
 T(global opt: hmmtasks init               ) = 9.683e-03 S  per = 0.845  per(accum) = 7.46
 T(global opt: initial guess for dvdson    ) = 3.751e-03 S  per = 0.327  per(accum) = 7.79
 T(global opt: dvdson [Hx_batchGPU]        ) = 8.454e-01 S  per = 73.7  per(accum) = 81.5
 T(global opt: dvdson [cpu-gpu]            ) = 1.957e-02 S  per = 1.71  per(accum) = 83.2
 T(global opt: dvdson [nccl]               ) = 1.012e-04 S  per = 0.00882  per(accum) = 83.2
 T(global opt: dvdson [mpi]                ) = 2.847e-06 S  per = 0.000248  per(accum) = 83.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.920e-01 S  per = 16.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.610e-01 S  T(sum) = 1.610e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.269e-04 S  per = 0.265  per(accum) = 0.265
 T(global opt: qops init                    ) = 2.549e-03 S  per = 1.58  per(accum) = 1.85
 T(global opt: symbolic_formulae_renorm     ) = 5.424e-03 S  per = 3.37  per(accum) = 5.22
 T(global opt: allocate qops on gpu         ) = 1.883e-04 S  per = 0.117  per(accum) = 5.33
 T(global opt: site memcpy cpu2gpu          ) = 3.859e-03 S  per =  2.4  per(accum) = 7.73
 T(global opt: rintermediate init           ) = 8.220e-03 S  per =  5.1  per(accum) = 12.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.697e-02 S  per = 10.5  per(accum) = 23.4
 T(global opt: rmmtasks init                ) = 7.626e-03 S  per = 4.74  per(accum) = 28.1
 T(global opt: qops memset on cpu           ) = 1.700e-07 S  per = 0.000106  per(accum) = 28.1
 T(global opt: preprocess_renorm_batchGPU   ) = 1.078e-01 S  per = 66.9  per(accum) = 95
 T(global opt: deallocate cpu and gpu memory) = 1.128e-04 S  per = 0.0701  per(accum) = 95.1
 T(global opt: construct opS [ifdists=true] ) = 2.180e-07 S  per = 0.000135  per(accum) = 95.1
 T(global opt: reduction of opS & opH [nccl]) = 1.530e-07 S  per = 9.5e-05  per(accum) = 95.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.692e-04 S  per = 0.167  per(accum) = 95.3
 T(global opt: reduction of opS & opH [mpi] ) = 1.055e-04 S  per = 0.0655  per(accum) = 95.3
 T(global opt: qops_pool join and erase     ) = 7.498e-03 S  per = 4.66  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.339e-05 S  per = 0.00831  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-6.732e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=3/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=902:6.882e-03MB:6.720e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=22:1.678e-04MB:1.639e-07GB
total mem of comb=925:7.057e-03MB:6.892e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=657:5.013e-03MB:4.895e-06GB
        per(mem): H:2.89 C:7.31 S:29.2 A:2.74 B:57.8 
 rqops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=4483:0.0342MB:3.34e-05GB
        per(mem): H:1.18 C:6.87 S:2.94 P:0 Q:89 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=7136:0.0544MB:5.32e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.176e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.773e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,17,3,3) nnz=119:9.079e-04MB
qtensor4: wf4 own=1 _data=0x3a8ab000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
 qbond: qcol nsym=7 dimAll=17
 (21,1):3 (21,3):4 (21,5):4 (21,7):3 (22,2):1 (22,4):1 (22,6):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=336 size=119:9.079e-04MB
### DIAG TIMING: total=3.359e-01 t1=3.200e-05, t2=1.182e-03, t3=2.515e-03, t4=3.322e-01, t5=4.097e-06, t6=1.429e-05, t7=5.020e-06
duration_diagGPU:3.359e-01
duration_diagreduce:5.500e-08
duration_diagtransform:8.640e-07
----- TIMING FOR symbolic_formulae_twodot with size=371 : 4.881e-03 S -----
rank=0 GPUmem(GB): used=5.317e-05 (oper)=5.317e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=371
 no. of hintermediate operators=174
 no. of coefficients=2358:1.799e-02MB:1.757e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.760e-04 S -----
rank=0 GPUmem(GB): used=7.074e-05 (oper,hinter)=5.317e-05,1.757e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.348e-01 S size(H_formulae)=371 size(Hxlst2)=21 T(Hmu/Hxlist)=9.140e-04,1.339e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.363e-01 S size(H_formulae)=371 size(Hxlst)=7364 -----
rank=0 GPUmem(GB): used=7.074e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.773e-06 batch[need]=1.865e-03 blksize=12 blksize0=9 batchsize=7364
rank=0 GPUmem(GB): used=1.938e-03 (oper,hinter,dvdson,batch)=5.317e-05,1.757e-05,1.773e-06,1.865e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=119 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.166e-03,5.286e-03,9.467e-03,2.723e-03,1.865e-02
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=1.160e-03 speed=1.529e-03GB/S T(nccl)=6.147e-06 speed=2.885e-01GB/S
----- TIMING FOR sigma : t_inter=5.3e-03 t_gemm=9.5e-03 t_reduction=2.7e-03 tot=1.7e-02 -----
 sigma[inter] counter=17 t=5.3e-03 per=3.0e+01 cost=3.0e+05 flops=5.7e+07
 sigma[gemm] counter=17 i=0 t=1.3e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=1.1e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=1.2e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=3 t=1.1e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=4 t=1.4e-03 per=7.9e+00 cost=6.8e+04 flops=5.0e+07
 sigma[gemm] counter=17 i=5 t=4.5e-03 per=2.6e+01 cost=6.9e+04 flops=1.5e+07
 sigma[gemm] counter=17 i=6 t=1.1e-03 per=6.2e+00 cost=9.8e+04 flops=9.0e+07
 sigma[gemm] counter=17 i=7 t=2.5e-03 per=1.4e+01 cost=9.6e+04 flops=3.9e+07
 sigma[gemm] counter=17 total t=9.5e-03 per=5.4e+01 cost=3.3e+05 flops=3.5e+07
 sigma[red] counter=17 t=2.7e-03 per=1.6e+01 cost=8.7e+04 flops=3.2e+07
----- TIMING FOR sigma_tot : t_inter=1.8e-01 t_gemm=4.9e-01 t_reduction=2.0e-01 tot=8.6e-01 -----
 sigma_tot[inter] counter=17 t=1.8e-01 per=2.0e+01 cost=5.5e+05 flops=3.1e+06
 sigma_tot[gemm] counter=17 i=0 t=5.5e-05 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=5.0e-05 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=3.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=3 t=3.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=4 t=1.2e-01 per=1.4e+01 cost=1.1e+05 flops=9.1e+05
 sigma_tot[gemm] counter=17 i=5 t=1.2e-01 per=1.5e+01 cost=1.1e+05 flops=8.9e+05
 sigma_tot[gemm] counter=17 i=6 t=1.2e-01 per=1.4e+01 cost=1.3e+05 flops=1.1e+06
 sigma_tot[gemm] counter=17 i=7 t=1.2e-01 per=1.4e+01 cost=1.3e+05 flops=1.1e+06
 sigma_tot[gemm] counter=17 total t=4.9e-01 per=5.7e+01 cost=4.8e+05 flops=9.9e+05
 sigma_tot[red] counter=17 t=2.0e-01 per=2.3e+01 cost=1.5e+05 flops=7.7e+05
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,5.2e-06,2.2e-06,7.6e-07,2.0e-07
settings: ndim=119 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.215792300366 -1.116e+03  9.651e-03    1     1  1.879e-02 1.879e-02 1.876e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.752e-03,9.965e-03,2.964e-02,1.282e-02,5.423e-02
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=1.744e-03 speed=1.017e-03GB/S T(nccl)=7.974e-06 speed=2.224e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=18 t=1.0e-02 per=1.9e+01 cost=3.0e+05 flops=3.0e+07
 sigma[gemm] counter=18 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=4 t=7.4e-03 per=1.4e+01 cost=6.8e+04 flops=9.2e+06
 sigma[gemm] counter=18 i=5 t=7.4e-03 per=1.4e+01 cost=6.9e+04 flops=9.4e+06
 sigma[gemm] counter=18 i=6 t=7.4e-03 per=1.4e+01 cost=9.8e+04 flops=1.3e+07
 sigma[gemm] counter=18 i=7 t=7.4e-03 per=1.4e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=18 total t=3.0e-02 per=5.7e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=18 t=1.3e-02 per=2.4e+01 cost=8.7e+04 flops=6.8e+06
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=5.2e-01 t_reduction=2.1e-01 tot=9.1e-01 -----
 sigma_tot[inter] counter=18 t=1.9e-01 per=2.0e+01 cost=8.5e+05 flops=4.6e+06
 sigma_tot[gemm] counter=18 i=0 t=5.7e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=5.1e-05 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=3.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=3 t=3.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=4 t=1.3e-01 per=1.4e+01 cost=1.8e+05 flops=1.4e+06
 sigma_tot[gemm] counter=18 i=5 t=1.3e-01 per=1.4e+01 cost=1.8e+05 flops=1.4e+06
 sigma_tot[gemm] counter=18 i=6 t=1.3e-01 per=1.4e+01 cost=2.3e+05 flops=1.8e+06
 sigma_tot[gemm] counter=18 i=7 t=1.3e-01 per=1.4e+01 cost=2.3e+05 flops=1.7e+06
 sigma_tot[gemm] counter=18 total t=5.2e-01 per=5.7e+01 cost=8.1e+05 flops=1.6e+06
 sigma_tot[red] counter=18 t=2.1e-01 per=2.3e+01 cost=2.4e+05 flops=1.1e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.7e-05,3.5e-06,1.1e-06,2.0e-07
    2   0 -    -116.216193153147 -4.009e-04  2.956e-03    2     2  8.298e-02 4.149e-02 3.655e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.434e-04,9.913e-03,2.967e-02,1.294e-02,5.287e-02
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=3.386e-04 speed=5.238e-03GB/S T(nccl)=4.882e-06 speed=3.632e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=19 t=9.9e-03 per=1.9e+01 cost=3.0e+05 flops=3.0e+07
 sigma[gemm] counter=19 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=4 t=7.5e-03 per=1.4e+01 cost=6.8e+04 flops=9.1e+06
 sigma[gemm] counter=19 i=5 t=7.4e-03 per=1.4e+01 cost=6.9e+04 flops=9.4e+06
 sigma[gemm] counter=19 i=6 t=7.4e-03 per=1.4e+01 cost=9.8e+04 flops=1.3e+07
 sigma[gemm] counter=19 i=7 t=7.4e-03 per=1.4e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=19 total t=3.0e-02 per=5.6e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=19 t=1.3e-02 per=2.5e+01 cost=8.7e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.0e-01 t_gemm=5.5e-01 t_reduction=2.2e-01 tot=9.7e-01 -----
 sigma_tot[inter] counter=19 t=2.0e-01 per=2.0e+01 cost=1.1e+06 flops=5.9e+06
 sigma_tot[gemm] counter=19 i=0 t=5.8e-05 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=5.3e-05 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=3.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=3 t=3.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=4 t=1.3e-01 per=1.4e+01 cost=2.5e+05 flops=1.8e+06
 sigma_tot[gemm] counter=19 i=5 t=1.4e-01 per=1.4e+01 cost=2.5e+05 flops=1.8e+06
 sigma_tot[gemm] counter=19 i=6 t=1.4e-01 per=1.4e+01 cost=3.3e+05 flops=2.4e+06
 sigma_tot[gemm] counter=19 i=7 t=1.4e-01 per=1.4e+01 cost=3.2e+05 flops=2.3e+06
 sigma_tot[gemm] counter=19 total t=5.5e-01 per=5.7e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[red] counter=19 t=2.2e-01 per=2.3e+01 cost=3.2e+05 flops=1.5e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.7e-05,3.1e-06,1.5e-06,2.0e-07
    3   0 -    -116.216231819044 -3.867e-05  1.098e-03    3     3  1.484e-01 4.947e-02 4.202e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.289e-03,9.917e-03,3.021e-02,1.273e-02,5.415e-02
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=1.284e-03 speed=1.381e-03GB/S T(nccl)=4.887e-06 speed=3.628e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=20 t=9.9e-03 per=1.9e+01 cost=3.0e+05 flops=3.0e+07
 sigma[gemm] counter=20 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=4 t=7.6e-03 per=1.4e+01 cost=6.8e+04 flops=9.0e+06
 sigma[gemm] counter=20 i=5 t=7.6e-03 per=1.4e+01 cost=6.9e+04 flops=9.2e+06
 sigma[gemm] counter=20 i=6 t=7.5e-03 per=1.4e+01 cost=9.8e+04 flops=1.3e+07
 sigma[gemm] counter=20 i=7 t=7.5e-03 per=1.4e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=20 total t=3.0e-02 per=5.7e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=20 t=1.3e-02 per=2.4e+01 cost=8.7e+04 flops=6.8e+06
----- TIMING FOR sigma_tot : t_inter=2.1e-01 t_gemm=5.8e-01 t_reduction=2.4e-01 tot=1.0e+00 -----
 sigma_tot[inter] counter=20 t=2.1e-01 per=2.0e+01 cost=1.4e+06 flops=7.0e+06
 sigma_tot[gemm] counter=20 i=0 t=6.0e-05 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=5.4e-05 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=3.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=3 t=3.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=4 t=1.4e-01 per=1.4e+01 cost=3.1e+05 flops=2.2e+06
 sigma_tot[gemm] counter=20 i=5 t=1.5e-01 per=1.4e+01 cost=3.2e+05 flops=2.2e+06
 sigma_tot[gemm] counter=20 i=6 t=1.4e-01 per=1.4e+01 cost=4.2e+05 flops=3.0e+06
 sigma_tot[gemm] counter=20 i=7 t=1.4e-01 per=1.4e+01 cost=4.2e+05 flops=2.9e+06
 sigma_tot[gemm] counter=20 total t=5.8e-01 per=5.7e+01 cost=1.5e+06 flops=2.6e+06
 sigma_tot[red] counter=20 t=2.4e-01 per=2.3e+01 cost=4.1e+05 flops=1.7e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.4e-05,3.2e-06,1.5e-06,2.3e-07
    4   0 -    -116.216235377586 -3.559e-06  3.848e-04    3     4  2.121e-01 5.303e-02 4.508e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.401e-03,9.941e-03,2.985e-02,1.293e-02,5.413e-02
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=1.396e-03 speed=1.270e-03GB/S T(nccl)=5.134e-06 speed=3.454e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=21 t=9.9e-03 per=1.9e+01 cost=3.0e+05 flops=3.0e+07
 sigma[gemm] counter=21 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=2.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=3 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=4 t=7.4e-03 per=1.4e+01 cost=6.8e+04 flops=9.2e+06
 sigma[gemm] counter=21 i=5 t=7.5e-03 per=1.4e+01 cost=6.9e+04 flops=9.3e+06
 sigma[gemm] counter=21 i=6 t=7.4e-03 per=1.4e+01 cost=9.8e+04 flops=1.3e+07
 sigma[gemm] counter=21 i=7 t=7.5e-03 per=1.4e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=21 total t=3.0e-02 per=5.7e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=21 t=1.3e-02 per=2.5e+01 cost=8.7e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.2e-01 t_gemm=6.1e-01 t_reduction=2.5e-01 tot=1.1e+00 -----
 sigma_tot[inter] counter=21 t=2.2e-01 per=2.0e+01 cost=1.8e+06 flops=8.1e+06
 sigma_tot[gemm] counter=21 i=0 t=6.2e-05 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=5.6e-05 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=3.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=3 t=3.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=4 t=1.5e-01 per=1.4e+01 cost=3.8e+05 flops=2.6e+06
 sigma_tot[gemm] counter=21 i=5 t=1.5e-01 per=1.4e+01 cost=3.9e+05 flops=2.5e+06
 sigma_tot[gemm] counter=21 i=6 t=1.5e-01 per=1.4e+01 cost=5.2e+05 flops=3.5e+06
 sigma_tot[gemm] counter=21 i=7 t=1.5e-01 per=1.4e+01 cost=5.1e+05 flops=3.4e+06
 sigma_tot[gemm] counter=21 total t=6.1e-01 per=5.7e+01 cost=1.8e+06 flops=3.0e+06
 sigma_tot[red] counter=21 t=2.5e-01 per=2.3e+01 cost=5.0e+05 flops=2.0e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.5e-05,3.1e-06,1.3e-06,2.1e-07
    5   0 -    -116.216235753288 -3.757e-07  1.510e-04    3     5  2.757e-01 5.513e-02 4.691e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.465e-03,1.010e-02,2.975e-02,1.305e-02,5.438e-02
 analyze_tgpu[Hx]: ndim=119:8.866e-07GB T(cpu-gpu)=1.460e-03 speed=1.214e-03GB/S T(nccl)=4.778e-06 speed=3.711e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=22 t=1.0e-02 per=1.9e+01 cost=3.0e+05 flops=3.0e+07
 sigma[gemm] counter=22 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=3 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=4 t=7.5e-03 per=1.4e+01 cost=6.8e+04 flops=9.1e+06
 sigma[gemm] counter=22 i=5 t=7.4e-03 per=1.4e+01 cost=6.9e+04 flops=9.4e+06
 sigma[gemm] counter=22 i=6 t=7.4e-03 per=1.4e+01 cost=9.8e+04 flops=1.3e+07
 sigma[gemm] counter=22 i=7 t=7.4e-03 per=1.4e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=22 total t=3.0e-02 per=5.6e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=22 t=1.3e-02 per=2.5e+01 cost=8.7e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.3e-01 t_gemm=6.4e-01 t_reduction=2.6e-01 tot=1.1e+00 -----
 sigma_tot[inter] counter=22 t=2.3e-01 per=2.0e+01 cost=2.1e+06 flops=9.1e+06
 sigma_tot[gemm] counter=22 i=0 t=6.4e-05 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=5.8e-05 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=3.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=3 t=3.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=4 t=1.6e-01 per=1.4e+01 cost=4.5e+05 flops=2.9e+06
 sigma_tot[gemm] counter=22 i=5 t=1.6e-01 per=1.4e+01 cost=4.6e+05 flops=2.8e+06
 sigma_tot[gemm] counter=22 i=6 t=1.6e-01 per=1.4e+01 cost=6.2e+05 flops=3.9e+06
 sigma_tot[gemm] counter=22 i=7 t=1.6e-01 per=1.4e+01 cost=6.1e+05 flops=3.8e+06
 sigma_tot[gemm] counter=22 total t=6.4e-01 per=5.7e+01 cost=2.1e+06 flops=3.4e+06
 sigma_tot[red] counter=22 t=2.6e-01 per=2.3e+01 cost=5.9e+05 flops=2.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.3e-05,3.0e-06,1.2e-06,2.0e-07
    6   0 +    -116.216235822396 -6.911e-08  5.084e-05    3     6  3.395e-01 5.658e-02 4.818e-02
TIMING FOR Davidson : 3.395e-01  T(cal/comm/rest)=2.891e-01,7.700e-07,5.043e-02
decomposed t_rest=5.043e-02
 T(sub)    =1.340e-04 per=2.658e-01
 T(precond)=5.014e-02 per=9.942e+01
 T(ortho)  =2.238e-05 per=4.438e-02
 T(xcopy)  =1.164e-06 per=2.308e-03
 T(xnrm2)  =2.697e-06 per=5.348e-03
 T(other)  =1.334e-04 per=2.645e-01
optimized energies: isweep=0 ibond=3 dots=2 e[0]=-116.216235822396 nmvp=6
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.235e-03 change=2.144e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=8 dimAll=28
 (7,1):6 (9,1):3 (8,0):3 (8,2):6 (6,2):4 (7,3):4 (5,3):1 (6,4):1
timing for divide=1.1e-04
timing for compute=1.1e-02
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(su2): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-04,1.1e-02,0.0e+00,5.6e-06,2.1e-05 -----
decimation summary: 28->10 dwt=+1.070e-06 SvN=4.910e-01
 qbond: qkept nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
----- TIMING for decimation_row(nkr): 1.198e-02 S T(decim/select/formRot)=1.147e-02,4.174e-04,8.930e-05 -----
----- TIMING FOR twodot_decimation: 1.267e-02 S T(wf/decim)=6.786e-04,1.200e-02 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1365:1.041e-02MB:1.017e-05GB
        per(mem): H:1.47 C:7.69 S:23.1 A:12.8 B:54.9 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.235e-03 change=1.988e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 2.756e-03 S -----
rank=0 GPUmem(GB): used=4.750e-05 (oper)=2.250e-05
rank=0 GPUmem(GB): used=4.785e-05 (oper,site)=2.250e-05,3.427e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=76
 no. of rintermediate operators=140
 no. of coefficients=1070:8.163e-03MB:7.972e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.527e-03 S -----
rank=0 GPUmem(GB): used=5.582e-05 (oper,site,rinter)=2.250e-05,3.427e-07,7.972e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.810e-02 S size(rtasks)=76 size(Rlst2)=36 T(Rmu/Rlist)=6.948e-04,1.741e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.826e-02 S size(rtasks)=76 size(Rlst)=1481 -----
rank=0 GPUmem(GB): used=5.582e-05 avail=6.174e+00 total=6.174e+00 batch[need]=3.090e-04 blksize=9 blksize0=9 batchsize=1481
rank=0 GPUmem(GB): used=3.648e-04 (oper,site,rinter,batch)=2.250e-05,3.427e-07,7.972e-06,3.090e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.358e-03,2.272e-02,1.007e-02
----- TIMING FOR renorm : t_inter=7.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=4 t=7.4e-03 per=1.8e+01 cost=8.4e+04 flops=1.1e+07
 renorm[gemm] counter=4 i=0 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=4 t=7.6e-03 per=1.9e+01 cost=1.5e+04 flops=1.9e+06
 renorm[gemm] counter=4 i=5 t=7.6e-03 per=1.9e+01 cost=2.2e+04 flops=2.9e+06
 renorm[gemm] counter=4 i=6 t=7.6e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=4 total t=2.3e-02 per=5.7e+01 cost=6.5e+04 flops=2.9e+06
 renorm[red] counter=4 t=1.0e-02 per=2.5e+01 cost=1.1e+04 flops=1.1e+06
----- TIMING FOR renorm_tot : t_inter=1.8e-02 t_gemm=8.9e-02 t_reduction=4.0e-02 tot=1.5e-01 -----
 renorm_tot[inter] counter=4 t=1.8e-02 per=1.2e+01 cost=9.0e+04 flops=5.0e+06
 renorm_tot[gemm] counter=4 i=0 t=7.4e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=6.3e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=6.0e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=3 t=6.0e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=4 t=2.9e-02 per=1.9e+01 cost=1.7e+04 flops=6.1e+05
 renorm_tot[gemm] counter=4 i=5 t=3.0e-02 per=2.0e+01 cost=2.5e+04 flops=8.4e+05
 renorm_tot[gemm] counter=4 i=6 t=3.0e-02 per=2.1e+01 cost=3.9e+04 flops=1.3e+06
 renorm_tot[gemm] counter=4 total t=8.9e-02 per=6.0e+01 cost=8.2e+04 flops=9.2e+05
 renorm_tot[red] counter=4 t=4.0e-02 per=2.7e+01 cost=1.9e+04 flops=4.6e+05
qops.to_cpu: size(tot)=1365:1.0e-02MB:1.0e-05GB T(to_cpu)=8.4e-05S speed=1.2e-01GB/S
check ||H-H.dagger||=2.453e-15 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0779 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.732e-03 change=4.941e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.922e-03 change=-1.668e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.930e-03 change=-3.427e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 9.881e-01 S #####
 T(local opt: fetch) = 1.902e-02 S  per = 1.93  per(accum) = 1.93
 T(local opt: hdiag) = 3.369e-01 S  per = 34.1  per(accum) = 36
 T(local opt: dvdsn) = 5.368e-01 S  per = 54.3  per(accum) = 90.3
 T(local opt: decim) = 1.270e-02 S  per = 1.29  per(accum) = 91.6
 T(local opt: guess) = 1.532e-03 S  per = 0.155  per(accum) = 91.8
 T(local opt: renrm) = 8.088e-02 S  per = 8.18  per(accum) = 100
 T(local opt: save ) = 3.071e-04 S  per = 0.0311  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.368e-01 S  T(sum) = 5.350e-01 S  per = 9.966e+01
 T(local opt: preprocess                  ) = 4.969e-03 S  per = 0.929  per(accum) = 0.929
 T(local opt: symbolic_formulae           ) = 4.894e-03 S  per = 0.915  per(accum) = 1.84
 T(local opt: hintermediate init          ) = 1.916e-04 S  per = 0.0358  per(accum) = 1.88
 T(local opt: preprocess_hformulae_Hxlist ) = 1.367e-01 S  per = 25.6  per(accum) = 27.4
 T(local opt: hmmtasks init               ) = 4.732e-02 S  per = 8.85  per(accum) = 36.3
 T(local opt: initial guess for dvdson    ) = 1.380e-03 S  per = 0.258  per(accum) = 36.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.816e-01 S  per = 52.6  per(accum) = 89.2
 T(local opt: dvdson [cpu-gpu]            ) = 7.383e-03 S  per = 1.38  per(accum) = 90.6
 T(local opt: dvdson [nccl]               ) = 3.380e-05 S  per = 0.00632  per(accum) = 90.6
 T(local opt: dvdson [mpi]                ) = 7.700e-07 S  per = 0.000144  per(accum) = 90.6
 T(local opt: dvdson [rest part(linalg)]  ) = 5.043e-02 S  per = 9.43  per(accum) = 100
Detailed decomposition of T(renrm) = 8.088e-02 S  T(sum) = 8.088e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.612e-04 S  per = 0.323  per(accum) = 0.323
 T(local opt: qops init                    ) = 3.579e-03 S  per = 4.43  per(accum) = 4.75
 T(local opt: symbolic_formulae_renorm     ) = 2.767e-03 S  per = 3.42  per(accum) = 8.17
 T(local opt: allocate qops on gpu         ) = 6.456e-05 S  per = 0.0798  per(accum) = 8.25
 T(local opt: site memcpy cpu2gpu          ) = 6.614e-04 S  per = 0.818  per(accum) = 9.07
 T(local opt: rintermediate init           ) = 2.537e-03 S  per = 3.14  per(accum) = 12.2
 T(local opt: preprocess_formulae_Rlist2   ) = 1.831e-02 S  per = 22.6  per(accum) = 34.8
 T(local opt: rmmtasks init                ) = 9.561e-03 S  per = 11.8  per(accum) = 46.7
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 4.2e-05  per(accum) = 46.7
 T(local opt: preprocess_renorm_batchGPU   ) = 4.023e-02 S  per = 49.7  per(accum) = 96.4
 T(local opt: deallocate cpu and gpu memory) = 7.219e-05 S  per = 0.0893  per(accum) = 96.5
 T(local opt: construct opS [ifdists=true] ) = 4.000e-08 S  per = 4.95e-05  per(accum) = 96.5
 T(local opt: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 4.33e-05  per(accum) = 96.5
 T(local opt: qops memcpy gpu2cpu          ) = 9.097e-05 S  per = 0.112  per(accum) = 96.6
 T(local opt: reduction of opS & opH [mpi] ) = 7.050e-05 S  per = 0.0872  per(accum) = 96.7
 T(local opt: qops_pool join and erase     ) = 2.660e-03 S  per = 3.29  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.240e-06 S  per = 0.00895  per(accum) = 100
##### sweep opt: 2.792e+00 S #####
 T(sweep opt: fetch) = 8.967e-02 S  per = 3.21  per(accum) = 3.21
 T(sweep opt: hdiag) = 7.107e-01 S  per = 25.5  per(accum) = 28.7
 T(sweep opt: dvdsn) = 1.684e+00 S  per = 60.3  per(accum) = 89
 T(sweep opt: decim) = 5.929e-02 S  per = 2.12  per(accum) = 91.1
 T(sweep opt: guess) = 5.302e-03 S  per = 0.19  per(accum) = 91.3
 T(sweep opt: renrm) = 2.419e-01 S  per = 8.66  per(accum) = 100
 T(sweep opt: save ) = 1.249e-03 S  per = 0.0447  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.684e+00 S  T(sum) = 1.681e+00 S  per = 9.985e+01
 T(sweep opt: preprocess                  ) = 2.003e-02 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: symbolic_formulae           ) = 1.302e-02 S  per = 0.774  per(accum) = 1.97
 T(sweep opt: hintermediate init          ) = 5.424e-04 S  per = 0.0323  per(accum) = 2
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.890e-01 S  per = 11.2  per(accum) = 13.2
 T(sweep opt: hmmtasks init               ) = 5.701e-02 S  per = 3.39  per(accum) = 16.6
 T(sweep opt: initial guess for dvdson    ) = 5.131e-03 S  per = 0.305  per(accum) = 16.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.127e+00 S  per =   67  per(accum) = 84
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.695e-02 S  per =  1.6  per(accum) = 85.6
 T(sweep opt: dvdson [nccl]               ) = 1.350e-04 S  per = 0.00803  per(accum) = 85.6
 T(sweep opt: dvdson [mpi]                ) = 3.617e-06 S  per = 0.000215  per(accum) = 85.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.425e-01 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.419e-01 S  T(sum) = 2.419e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.881e-04 S  per = 0.284  per(accum) = 0.284
 T(sweep opt: qops init                    ) = 6.129e-03 S  per = 2.53  per(accum) = 2.82
 T(sweep opt: symbolic_formulae_renorm     ) = 8.192e-03 S  per = 3.39  per(accum) = 6.2
 T(sweep opt: allocate qops on gpu         ) = 2.528e-04 S  per = 0.105  per(accum) = 6.31
 T(sweep opt: site memcpy cpu2gpu          ) = 4.521e-03 S  per = 1.87  per(accum) = 8.18
 T(sweep opt: rintermediate init           ) = 1.076e-02 S  per = 4.45  per(accum) = 12.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.528e-02 S  per = 14.6  per(accum) = 27.2
 T(sweep opt: rmmtasks init                ) = 1.719e-02 S  per =  7.1  per(accum) = 34.3
 T(sweep opt: qops memset on cpu           ) = 2.040e-07 S  per = 8.43e-05  per(accum) = 34.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.480e-01 S  per = 61.2  per(accum) = 95.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.850e-04 S  per = 0.0765  per(accum) = 95.6
 T(sweep opt: construct opS [ifdists=true] ) = 2.580e-07 S  per = 0.000107  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.880e-07 S  per = 7.77e-05  per(accum) = 95.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.602e-04 S  per = 0.149  per(accum) = 95.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.760e-04 S  per = 0.0727  per(accum) = 95.8
 T(sweep opt: qops_pool join and erase     ) = 1.016e-02 S  per =  4.2  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 2.063e-05 S  per = 0.00853  per(accum) = 100
##### global opt: 2.792e+00 S #####
 T(global opt: fetch) = 8.967e-02 S  per = 3.21  per(accum) = 3.21
 T(global opt: hdiag) = 7.107e-01 S  per = 25.5  per(accum) = 28.7
 T(global opt: dvdsn) = 1.684e+00 S  per = 60.3  per(accum) = 89
 T(global opt: decim) = 5.929e-02 S  per = 2.12  per(accum) = 91.1
 T(global opt: guess) = 5.302e-03 S  per = 0.19  per(accum) = 91.3
 T(global opt: renrm) = 2.419e-01 S  per = 8.66  per(accum) = 100
 T(global opt: save ) = 1.249e-03 S  per = 0.0447  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.684e+00 S  T(sum) = 1.681e+00 S  per = 9.985e+01
 T(global opt: preprocess                  ) = 2.003e-02 S  per = 1.19  per(accum) = 1.19
 T(global opt: symbolic_formulae           ) = 1.302e-02 S  per = 0.774  per(accum) = 1.97
 T(global opt: hintermediate init          ) = 5.424e-04 S  per = 0.0323  per(accum) = 2
 T(global opt: preprocess_hformulae_Hxlist ) = 1.890e-01 S  per = 11.2  per(accum) = 13.2
 T(global opt: hmmtasks init               ) = 5.701e-02 S  per = 3.39  per(accum) = 16.6
 T(global opt: initial guess for dvdson    ) = 5.131e-03 S  per = 0.305  per(accum) = 16.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.127e+00 S  per =   67  per(accum) = 84
 T(global opt: dvdson [cpu-gpu]            ) = 2.695e-02 S  per =  1.6  per(accum) = 85.6
 T(global opt: dvdson [nccl]               ) = 1.350e-04 S  per = 0.00803  per(accum) = 85.6
 T(global opt: dvdson [mpi]                ) = 3.617e-06 S  per = 0.000215  per(accum) = 85.6
 T(global opt: dvdson [rest part(linalg)]  ) = 2.425e-01 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.419e-01 S  T(sum) = 2.419e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.881e-04 S  per = 0.284  per(accum) = 0.284
 T(global opt: qops init                    ) = 6.129e-03 S  per = 2.53  per(accum) = 2.82
 T(global opt: symbolic_formulae_renorm     ) = 8.192e-03 S  per = 3.39  per(accum) = 6.2
 T(global opt: allocate qops on gpu         ) = 2.528e-04 S  per = 0.105  per(accum) = 6.31
 T(global opt: site memcpy cpu2gpu          ) = 4.521e-03 S  per = 1.87  per(accum) = 8.18
 T(global opt: rintermediate init           ) = 1.076e-02 S  per = 4.45  per(accum) = 12.6
 T(global opt: preprocess_formulae_Rlist2   ) = 3.528e-02 S  per = 14.6  per(accum) = 27.2
 T(global opt: rmmtasks init                ) = 1.719e-02 S  per =  7.1  per(accum) = 34.3
 T(global opt: qops memset on cpu           ) = 2.040e-07 S  per = 8.43e-05  per(accum) = 34.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.480e-01 S  per = 61.2  per(accum) = 95.5
 T(global opt: deallocate cpu and gpu memory) = 1.850e-04 S  per = 0.0765  per(accum) = 95.6
 T(global opt: construct opS [ifdists=true] ) = 2.580e-07 S  per = 0.000107  per(accum) = 95.6
 T(global opt: reduction of opS & opH [nccl]) = 1.880e-07 S  per = 7.77e-05  per(accum) = 95.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.602e-04 S  per = 0.149  per(accum) = 95.7
 T(global opt: reduction of opS & opH [mpi] ) = 1.760e-04 S  per = 0.0727  per(accum) = 95.8
 T(global opt: qops_pool join and erase     ) = 1.016e-02 S  per =  4.2  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 2.063e-05 S  per = 0.00853  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.111e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=4/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=876:6.683e-03MB:6.527e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=926:7.065e-03MB:6.899e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1365:1.041e-02MB:1.017e-05GB
        per(mem): H:1.47 C:7.69 S:23.1 A:12.8 B:54.9 
 rqops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=7507:0.0573MB:5.59e-05GB
        per(mem): H:0.946 C:4.5 S:2.42 P:0 Q:92.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=10868:0.0829MB:8.1e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.293e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-6.062e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=225:1.717e-03MB
qtensor4: wf4 own=1 _data=0x306b0000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
 qbond: qcol nsym=7 dimAll=19
 (20,0):3 (20,2):5 (20,4):5 (20,6):3 (21,1):1 (21,3):1 (21,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=44 nblocks=648 size=225:1.717e-03MB
### DIAG TIMING: total=4.380e-01 t1=2.915e-05, t2=1.217e-03, t3=2.150e-03, t4=4.346e-01, t5=2.133e-05, t6=1.730e-05, t7=1.408e-05
duration_diagGPU:4.381e-01
duration_diagreduce:1.260e-07
duration_diagtransform:1.231e-06
----- TIMING FOR symbolic_formulae_twodot with size=491 : 6.395e-03 S -----
rank=0 GPUmem(GB): used=8.097e-05 (oper)=8.097e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=491
 no. of hintermediate operators=244
 no. of coefficients=3269:2.494e-02MB:2.436e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.592e-04 S -----
rank=0 GPUmem(GB): used=1.053e-04 (oper,hinter)=8.097e-05,2.436e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.767e-01 S size(H_formulae)=491 size(Hxlst2)=44 T(Hmu/Hxlist)=1.345e-03,4.753e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.801e-01 S size(H_formulae)=491 size(Hxlst)=28090 -----
rank=0 GPUmem(GB): used=1.053e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=3.353e-06 batch[need]=8.371e-03 blksize=15 blksize0=9 batchsize=28090
rank=0 GPUmem(GB): used=8.480e-03 (oper,hinter,dvdson,batch)=8.097e-05,2.436e-05,3.353e-06,8.371e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=225 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.233e-03,3.967e-03,4.190e-03,4.360e-03,1.477e-02
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=2.223e-03 speed=1.508e-03GB/S T(nccl)=9.240e-06 speed=3.629e-01GB/S
----- TIMING FOR sigma : t_inter=4.0e-03 t_gemm=4.2e-03 t_reduction=4.4e-03 tot=1.3e-02 -----
 sigma[inter] counter=23 t=4.0e-03 per=3.2e+01 cost=1.6e+06 flops=4.0e+08
 sigma[gemm] counter=23 i=0 t=1.5e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=1.3e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=1.1e-06 per=8.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=3 t=1.1e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=4 t=7.8e-04 per=6.3e+00 cost=3.0e+05 flops=3.8e+08
 sigma[gemm] counter=23 i=5 t=1.8e-03 per=1.4e+01 cost=3.0e+05 flops=1.7e+08
 sigma[gemm] counter=23 i=6 t=9.6e-04 per=7.7e+00 cost=2.8e+05 flops=2.9e+08
 sigma[gemm] counter=23 i=7 t=6.5e-04 per=5.2e+00 cost=3.0e+05 flops=4.7e+08
 sigma[gemm] counter=23 total t=4.2e-03 per=3.3e+01 cost=1.2e+06 flops=2.8e+08
 sigma[red] counter=23 t=4.4e-03 per=3.5e+01 cost=3.1e+05 flops=7.1e+07
----- TIMING FOR sigma_tot : t_inter=2.3e-01 t_gemm=6.4e-01 t_reduction=2.7e-01 tot=1.1e+00 -----
 sigma_tot[inter] counter=23 t=2.3e-01 per=2.0e+01 cost=3.6e+06 flops=1.6e+07
 sigma_tot[gemm] counter=23 i=0 t=6.5e-05 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=5.9e-05 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=3.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=3 t=3.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=4 t=1.6e-01 per=1.4e+01 cost=7.5e+05 flops=4.7e+06
 sigma_tot[gemm] counter=23 i=5 t=1.6e-01 per=1.4e+01 cost=7.6e+05 flops=4.6e+06
 sigma_tot[gemm] counter=23 i=6 t=1.6e-01 per=1.4e+01 cost=9.0e+05 flops=5.6e+06
 sigma_tot[gemm] counter=23 i=7 t=1.6e-01 per=1.4e+01 cost=9.2e+05 flops=5.7e+06
 sigma_tot[gemm] counter=23 total t=6.4e-01 per=5.6e+01 cost=3.3e+06 flops=5.2e+06
 sigma_tot[red] counter=23 t=2.7e-01 per=2.3e+01 cost=9.0e+05 flops=3.4e+06
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,7.1e-06,2.3e-06,1.2e-06,2.4e-07
settings: ndim=225 neig=1 maxcycle=30 nbuff=4 memory=3e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.216235107147 -1.116e+03  1.315e-02    1     1  1.491e-02 1.491e-02 1.488e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.602e-03,5.096e-03,1.450e-02,1.096e-02,3.217e-02
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=1.594e-03 speed=2.103e-03GB/S T(nccl)=8.117e-06 speed=4.131e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.4e-02 t_reduction=1.1e-02 tot=3.1e-02 -----
 sigma[inter] counter=24 t=5.1e-03 per=1.7e+01 cost=1.6e+06 flops=3.1e+08
 sigma[gemm] counter=24 i=0 t=1.7e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=1.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=1.5e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=3 t=1.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=4 t=6.6e-03 per=2.1e+01 cost=3.0e+05 flops=4.5e+07
 sigma[gemm] counter=24 i=5 t=2.8e-03 per=9.2e+00 cost=3.0e+05 flops=1.1e+08
 sigma[gemm] counter=24 i=6 t=2.5e-03 per=8.3e+00 cost=2.8e+05 flops=1.1e+08
 sigma[gemm] counter=24 i=7 t=2.6e-03 per=8.4e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=24 total t=1.4e-02 per=4.7e+01 cost=1.2e+06 flops=8.1e+07
 sigma[red] counter=24 t=1.1e-02 per=3.6e+01 cost=3.1e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=2.3e-01 t_gemm=6.6e-01 t_reduction=2.8e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=24 t=2.3e-01 per=2.0e+01 cost=5.2e+06 flops=2.2e+07
 sigma_tot[gemm] counter=24 i=0 t=6.7e-05 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=6.1e-05 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=4.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=3 t=4.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=4 t=1.6e-01 per=1.4e+01 cost=1.0e+06 flops=6.4e+06
 sigma_tot[gemm] counter=24 i=5 t=1.7e-01 per=1.4e+01 cost=1.1e+06 flops=6.4e+06
 sigma_tot[gemm] counter=24 i=6 t=1.6e-01 per=1.4e+01 cost=1.2e+06 flops=7.3e+06
 sigma_tot[gemm] counter=24 i=7 t=1.6e-01 per=1.4e+01 cost=1.2e+06 flops=7.5e+06
 sigma_tot[gemm] counter=24 total t=6.6e-01 per=5.6e+01 cost=4.5e+06 flops=6.9e+06
 sigma_tot[red] counter=24 t=2.8e-01 per=2.4e+01 cost=1.2e+06 flops=4.4e+06
T(sub)=7.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,4.7e-05,7.8e-06,2.9e-06,5.5e-07
    2   0 -    -116.217230900952 -9.958e-04  5.902e-03    2     2  5.783e-02 2.891e-02 2.365e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.116e-03,5.066e-03,1.005e-02,1.084e-02,2.709e-02
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=1.108e-03 speed=3.026e-03GB/S T(nccl)=8.107e-06 speed=4.136e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=25 t=5.1e-03 per=2.0e+01 cost=1.6e+06 flops=3.1e+08
 sigma[gemm] counter=25 i=0 t=3.6e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=3.1e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=3.1e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=3 t=3.1e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=4 t=2.5e-03 per=9.6e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=25 i=5 t=2.5e-03 per=9.8e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=25 i=6 t=2.5e-03 per=9.6e+00 cost=2.8e+05 flops=1.1e+08
 sigma[gemm] counter=25 i=7 t=2.5e-03 per=9.8e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=25 total t=1.0e-02 per=3.9e+01 cost=1.2e+06 flops=1.2e+08
 sigma[red] counter=25 t=1.1e-02 per=4.2e+01 cost=3.1e+05 flops=2.9e+07
----- TIMING FOR sigma_tot : t_inter=2.4e-01 t_gemm=6.7e-01 t_reduction=2.9e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=25 t=2.4e-01 per=2.0e+01 cost=6.8e+06 flops=2.8e+07
 sigma_tot[gemm] counter=25 i=0 t=7.0e-05 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=6.4e-05 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=4.4e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=3 t=4.4e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=4 t=1.7e-01 per=1.4e+01 cost=1.3e+06 flops=8.0e+06
 sigma_tot[gemm] counter=25 i=5 t=1.7e-01 per=1.4e+01 cost=1.4e+06 flops=8.1e+06
 sigma_tot[gemm] counter=25 i=6 t=1.6e-01 per=1.4e+01 cost=1.4e+06 flops=8.8e+06
 sigma_tot[gemm] counter=25 i=7 t=1.7e-01 per=1.4e+01 cost=1.5e+06 flops=9.2e+06
 sigma_tot[gemm] counter=25 total t=6.7e-01 per=5.6e+01 cost=5.7e+06 flops=8.5e+06
 sigma_tot[red] counter=25 t=2.9e-01 per=2.4e+01 cost=1.5e+06 flops=5.3e+06
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=9.4e-06,3.0e-05,5.1e-06,3.0e-06,3.7e-07
    3   0 -    -116.217352341306 -1.214e-04  2.403e-03    3     3  9.447e-02 3.149e-02 2.487e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.307e-04,4.976e-03,1.001e-02,1.090e-02,2.674e-02
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=8.220e-04 speed=4.079e-03GB/S T(nccl)=8.674e-06 speed=3.865e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=26 t=5.0e-03 per=1.9e+01 cost=1.6e+06 flops=3.2e+08
 sigma[gemm] counter=26 i=0 t=4.4e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=2.5e-06 per=9.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=2.5e-06 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=3 t=2.6e-06 per=9.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=4 t=2.5e-03 per=9.6e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=26 i=5 t=2.5e-03 per=9.7e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=26 i=6 t=2.5e-03 per=9.7e+00 cost=2.8e+05 flops=1.1e+08
 sigma[gemm] counter=26 i=7 t=2.5e-03 per=9.7e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=26 total t=1.0e-02 per=3.9e+01 cost=1.2e+06 flops=1.2e+08
 sigma[red] counter=26 t=1.1e-02 per=4.2e+01 cost=3.1e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=2.4e-01 t_gemm=6.8e-01 t_reduction=3.0e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=26 t=2.4e-01 per=2.0e+01 cost=8.4e+06 flops=3.4e+07
 sigma_tot[gemm] counter=26 i=0 t=7.5e-05 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=6.7e-05 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=4.7e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=3 t=4.7e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=4 t=1.7e-01 per=1.4e+01 cost=1.6e+06 flops=9.7e+06
 sigma_tot[gemm] counter=26 i=5 t=1.7e-01 per=1.4e+01 cost=1.7e+06 flops=9.7e+06
 sigma_tot[gemm] counter=26 i=6 t=1.7e-01 per=1.4e+01 cost=1.7e+06 flops=1.0e+07
 sigma_tot[gemm] counter=26 i=7 t=1.7e-01 per=1.4e+01 cost=1.8e+06 flops=1.1e+07
 sigma_tot[gemm] counter=26 total t=6.8e-01 per=5.5e+01 cost=6.9e+06 flops=1.0e+07
 sigma_tot[red] counter=26 t=3.0e-01 per=2.4e+01 cost=1.8e+06 flops=6.1e+06
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=8.7e-06,3.5e-05,4.3e-06,2.1e-06,3.1e-07
    4   0 -    -116.217369818296 -1.748e-05  8.241e-04    3     4  1.395e-01 3.488e-02 2.538e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.212e-03,5.026e-03,1.023e-02,1.104e-02,2.751e-02
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=1.206e-03 speed=2.781e-03GB/S T(nccl)=5.969e-06 speed=5.617e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=27 t=5.0e-03 per=1.9e+01 cost=1.6e+06 flops=3.2e+08
 sigma[gemm] counter=27 i=0 t=2.4e-06 per=9.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=2.1e-06 per=7.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=2.1e-06 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=3 t=2.1e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=4 t=2.5e-03 per=9.7e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=27 i=5 t=2.6e-03 per=9.8e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=27 i=6 t=2.5e-03 per=9.6e+00 cost=2.8e+05 flops=1.1e+08
 sigma[gemm] counter=27 i=7 t=2.6e-03 per=9.7e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=27 total t=1.0e-02 per=3.9e+01 cost=1.2e+06 flops=1.2e+08
 sigma[red] counter=27 t=1.1e-02 per=4.2e+01 cost=3.1e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=2.5e-01 t_gemm=6.9e-01 t_reduction=3.1e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=27 t=2.5e-01 per=2.0e+01 cost=1.0e+07 flops=4.0e+07
 sigma_tot[gemm] counter=27 i=0 t=7.7e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=6.9e-05 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=4.9e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=3 t=4.9e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=4 t=1.7e-01 per=1.4e+01 cost=1.9e+06 flops=1.1e+07
 sigma_tot[gemm] counter=27 i=5 t=1.7e-01 per=1.4e+01 cost=2.0e+06 flops=1.1e+07
 sigma_tot[gemm] counter=27 i=6 t=1.7e-01 per=1.4e+01 cost=2.0e+06 flops=1.2e+07
 sigma_tot[gemm] counter=27 i=7 t=1.7e-01 per=1.4e+01 cost=2.1e+06 flops=1.3e+07
 sigma_tot[gemm] counter=27 total t=6.9e-01 per=5.5e+01 cost=8.0e+06 flops=1.2e+07
 sigma_tot[red] counter=27 t=3.1e-01 per=2.5e+01 cost=2.1e+06 flops=6.9e+06
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.6e-06,1.7e-05,4.0e-06,1.2e-05,2.6e-07
    5   0 -    -116.217371742201 -1.924e-06  2.959e-04    3     5  1.829e-01 3.657e-02 2.584e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.444e-03,4.961e-03,1.005e-02,1.088e-02,2.734e-02
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=1.438e-03 speed=2.332e-03GB/S T(nccl)=5.857e-06 speed=5.724e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=28 t=5.0e-03 per=1.9e+01 cost=1.6e+06 flops=3.2e+08
 sigma[gemm] counter=28 i=0 t=1.8e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=1.5e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=1.5e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=3 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=4 t=2.5e-03 per=9.6e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=28 i=5 t=2.5e-03 per=9.8e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=28 i=6 t=2.5e-03 per=9.7e+00 cost=2.8e+05 flops=1.1e+08
 sigma[gemm] counter=28 i=7 t=2.5e-03 per=9.7e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=28 total t=1.0e-02 per=3.9e+01 cost=1.2e+06 flops=1.2e+08
 sigma[red] counter=28 t=1.1e-02 per=4.2e+01 cost=3.1e+05 flops=2.9e+07
----- TIMING FOR sigma_tot : t_inter=2.5e-01 t_gemm=7.0e-01 t_reduction=3.2e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=28 t=2.5e-01 per=2.0e+01 cost=1.2e+07 flops=4.6e+07
 sigma_tot[gemm] counter=28 i=0 t=7.9e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=7.0e-05 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=5.0e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=3 t=5.0e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=4 t=1.7e-01 per=1.4e+01 cost=2.2e+06 flops=1.3e+07
 sigma_tot[gemm] counter=28 i=5 t=1.8e-01 per=1.4e+01 cost=2.3e+06 flops=1.3e+07
 sigma_tot[gemm] counter=28 i=6 t=1.7e-01 per=1.3e+01 cost=2.3e+06 flops=1.3e+07
 sigma_tot[gemm] counter=28 i=7 t=1.7e-01 per=1.4e+01 cost=2.4e+06 flops=1.4e+07
 sigma_tot[gemm] counter=28 total t=7.0e-01 per=5.5e+01 cost=9.2e+06 flops=1.3e+07
 sigma_tot[red] counter=28 t=3.2e-01 per=2.5e+01 cost=2.4e+06 flops=7.6e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.5e-05,3.1e-06,1.9e-06,3.0e-07
    6   0 -    -116.217372032857 -2.907e-07  1.396e-04    3     6  2.216e-01 3.693e-02 2.611e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.887e-04,5.012e-03,1.013e-02,1.112e-02,2.675e-02
 analyze_tgpu[Hx]: ndim=225:1.676e-06GB T(cpu-gpu)=4.834e-04 speed=6.936e-03GB/S T(nccl)=5.283e-06 speed=6.346e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=29 t=5.0e-03 per=1.9e+01 cost=1.6e+06 flops=3.2e+08
 sigma[gemm] counter=29 i=0 t=1.7e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=3 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=4 t=2.5e-03 per=9.5e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=29 i=5 t=2.6e-03 per=9.7e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=29 i=6 t=2.5e-03 per=9.6e+00 cost=2.8e+05 flops=1.1e+08
 sigma[gemm] counter=29 i=7 t=2.5e-03 per=9.7e+00 cost=3.0e+05 flops=1.2e+08
 sigma[gemm] counter=29 total t=1.0e-02 per=3.9e+01 cost=1.2e+06 flops=1.2e+08
 sigma[red] counter=29 t=1.1e-02 per=4.2e+01 cost=3.1e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=2.6e-01 t_gemm=7.1e-01 t_reduction=3.3e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=29 t=2.6e-01 per=2.0e+01 cost=1.3e+07 flops=5.1e+07
 sigma_tot[gemm] counter=29 i=0 t=8.1e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=7.2e-05 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=5.2e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=3 t=5.2e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=4 t=1.8e-01 per=1.4e+01 cost=2.5e+06 flops=1.4e+07
 sigma_tot[gemm] counter=29 i=5 t=1.8e-01 per=1.4e+01 cost=2.6e+06 flops=1.4e+07
 sigma_tot[gemm] counter=29 i=6 t=1.7e-01 per=1.3e+01 cost=2.6e+06 flops=1.5e+07
 sigma_tot[gemm] counter=29 i=7 t=1.8e-01 per=1.4e+01 cost=2.7e+06 flops=1.6e+07
 sigma_tot[gemm] counter=29 total t=7.1e-01 per=5.4e+01 cost=1.0e+07 flops=1.5e+07
 sigma_tot[red] counter=29 t=3.3e-01 per=2.6e+01 cost=2.8e+06 flops=8.3e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.5e-05,3.2e-06,1.7e-06,2.4e-07
    7   0 +    -116.217372098439 -6.558e-08  5.394e-05    3     7  2.608e-01 3.725e-02 2.621e-02
TIMING FOR Davidson : 2.608e-01  T(cal/comm/rest)=1.835e-01,1.432e-06,7.728e-02
decomposed t_rest=7.728e-02
 T(sub)    =2.763e-04 per=3.575e-01
 T(precond)=7.675e-02 per=9.932e+01
 T(ortho)  =4.566e-05 per=5.909e-02
 T(xcopy)  =3.194e-06 per=4.133e-03
 T(xnrm2)  =5.921e-06 per=7.662e-03
 T(other)  =1.939e-04 per=2.509e-01
optimized energies: isweep=0 ibond=4 dots=2 e[0]=-116.217372098439 nmvp=7
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.409e-02 change=6.940e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=13 dimAll=40
 (8,2):8 (10,2):4 (9,1):6 (9,3):5 (7,1):3 (8,0):2 (7,3):4 (8,4):3 (11,1):1 (10,0):1 (6,2):1 (6,4):1 (7,5):1
timing for divide=1.7e-04
timing for compute=1.2e-02
timing for collect=3.8e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.7e-04,1.2e-02,0.0e+00,7.3e-06,3.8e-05 -----
decimation summary: 40->10 dwt=+1.978e-04 SvN=1.078e+00
 qbond: qkept nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
----- TIMING for decimation_row(nkr): 1.226e-02 S T(decim/select/formRot)=1.179e-02,3.840e-04,8.675e-05 -----
----- TIMING FOR twodot_decimation: 1.342e-02 S T(wf/decim)=1.141e-03,1.228e-02 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
        per(mem): H:1.34 C:4.83 S:11.3 A:0 B:82.6 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.401e-02 change=1.330e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=99 : 3.259e-03 S -----
rank=0 GPUmem(GB): used=6.607e-05 (oper)=3.428e-05
rank=0 GPUmem(GB): used=6.650e-05 (oper,site)=3.428e-05,4.247e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=99
 no. of rintermediate operators=131
 no. of coefficients=1475:1.125e-02MB:1.099e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.520e-03 S -----
rank=0 GPUmem(GB): used=7.749e-05 (oper,site,rinter)=3.428e-05,4.247e-07,1.099e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.199e-02 S size(rtasks)=99 size(Rlst2)=16 T(Rmu/Rlist)=8.083e-04,2.118e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.223e-02 S size(rtasks)=99 size(Rlst)=1746 -----
rank=0 GPUmem(GB): used=7.749e-05 avail=6.174e+00 total=6.174e+00 batch[need]=5.464e-04 blksize=16 blksize0=9 batchsize=1746
rank=0 GPUmem(GB): used=6.239e-04 (oper,site,rinter,batch)=3.428e-05,4.247e-07,1.099e-05,5.464e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.986e-03,2.269e-02,1.002e-02
----- TIMING FOR renorm : t_inter=6.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=5 t=6.0e-03 per=1.5e+01 cost=8.5e+04 flops=1.4e+07
 renorm[gemm] counter=5 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=3 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=4 t=7.5e-03 per=1.9e+01 cost=1.8e+04 flops=2.4e+06
 renorm[gemm] counter=5 i=5 t=7.5e-03 per=2.0e+01 cost=2.9e+04 flops=3.9e+06
 renorm[gemm] counter=5 i=6 t=7.6e-03 per=2.0e+01 cost=4.9e+04 flops=6.4e+06
 renorm[gemm] counter=5 total t=2.3e-02 per=5.9e+01 cost=9.6e+04 flops=4.2e+06
 renorm[red] counter=5 t=1.0e-02 per=2.6e+01 cost=2.3e+04 flops=2.3e+06
----- TIMING FOR renorm_tot : t_inter=2.4e-02 t_gemm=1.1e-01 t_reduction=5.0e-02 tot=1.9e-01 -----
 renorm_tot[inter] counter=5 t=2.4e-02 per=1.3e+01 cost=1.8e+05 flops=7.3e+06
 renorm_tot[gemm] counter=5 i=0 t=8.7e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=7.5e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=7.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=3 t=7.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=4 t=3.6e-02 per=1.9e+01 cost=3.5e+04 flops=9.7e+05
 renorm_tot[gemm] counter=5 i=5 t=3.8e-02 per=2.0e+01 cost=5.5e+04 flops=1.4e+06
 renorm_tot[gemm] counter=5 i=6 t=3.8e-02 per=2.0e+01 cost=8.9e+04 flops=2.3e+06
 renorm_tot[gemm] counter=5 total t=1.1e-01 per=6.0e+01 cost=1.8e+05 flops=1.6e+06
 renorm_tot[red] counter=5 t=5.0e-02 per=2.7e+01 cost=4.1e+04 flops=8.2e+05
qops.to_cpu: size(tot)=2238:1.7e-02MB:1.7e-05GB T(to_cpu)=1.1e-04S speed=1.6e-01GB/S
check ||H-H.dagger||=7.625e-15 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.081 S rank=0 -----
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.498e-02 change=6.211e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.714e-02 change=-2.005e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.714e-02 change=-3.800e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.525e+00 S #####
 T(local opt: fetch) = 1.671e-02 S  per =  1.1  per(accum) = 1.1
 T(local opt: hdiag) = 4.394e-01 S  per = 28.8  per(accum) = 29.9
 T(local opt: dvdsn) = 9.678e-01 S  per = 63.5  per(accum) = 93.4
 T(local opt: decim) = 1.345e-02 S  per = 0.882  per(accum) = 94.3
 T(local opt: guess) = 1.871e-03 S  per = 0.123  per(accum) = 94.4
 T(local opt: renrm) = 8.517e-02 S  per = 5.59  per(accum) = 100
 T(local opt: save ) = 3.488e-04 S  per = 0.0229  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.678e-01 S  T(sum) = 9.661e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 1.011e-02 S  per = 1.05  per(accum) = 1.05
 T(local opt: symbolic_formulae           ) = 6.409e-03 S  per = 0.663  per(accum) = 1.71
 T(local opt: hintermediate init          ) = 2.751e-04 S  per = 0.0285  per(accum) = 1.74
 T(local opt: preprocess_hformulae_Hxlist ) = 4.809e-01 S  per = 49.8  per(accum) = 51.5
 T(local opt: hmmtasks init               ) = 2.051e-01 S  per = 21.2  per(accum) = 72.7
 T(local opt: initial guess for dvdson    ) = 2.572e-03 S  per = 0.266  per(accum) = 73
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.746e-01 S  per = 18.1  per(accum) = 91.1
 T(local opt: dvdson [cpu-gpu]            ) = 8.874e-03 S  per = 0.919  per(accum) = 92
 T(local opt: dvdson [nccl]               ) = 5.125e-05 S  per = 0.0053  per(accum) = 92
 T(local opt: dvdson [mpi]                ) = 1.432e-06 S  per = 0.000148  per(accum) = 92
 T(local opt: dvdson [rest part(linalg)]  ) = 7.728e-02 S  per =    8  per(accum) = 100
Detailed decomposition of T(renrm) = 8.517e-02 S  T(sum) = 8.517e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.215e-04 S  per = 0.378  per(accum) = 0.378
 T(local opt: qops init                    ) = 2.399e-03 S  per = 2.82  per(accum) = 3.19
 T(local opt: symbolic_formulae_renorm     ) = 3.271e-03 S  per = 3.84  per(accum) = 7.04
 T(local opt: allocate qops on gpu         ) = 5.413e-05 S  per = 0.0636  per(accum) = 7.1
 T(local opt: site memcpy cpu2gpu          ) = 3.402e-04 S  per = 0.399  per(accum) = 7.5
 T(local opt: rintermediate init           ) = 2.531e-03 S  per = 2.97  per(accum) = 10.5
 T(local opt: preprocess_formulae_Rlist2   ) = 2.229e-02 S  per = 26.2  per(accum) = 36.6
 T(local opt: rmmtasks init                ) = 1.113e-02 S  per = 13.1  per(accum) = 49.7
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 4.11e-05  per(accum) = 49.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.878e-02 S  per = 45.5  per(accum) = 95.3
 T(local opt: deallocate cpu and gpu memory) = 8.100e-05 S  per = 0.0951  per(accum) = 95.3
 T(local opt: construct opS [ifdists=true] ) = 5.900e-08 S  per = 6.93e-05  per(accum) = 95.3
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 4.23e-05  per(accum) = 95.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.126e-04 S  per = 0.132  per(accum) = 95.5
 T(local opt: reduction of opS & opH [mpi] ) = 4.126e-05 S  per = 0.0484  per(accum) = 95.5
 T(local opt: qops_pool join and erase     ) = 3.802e-03 S  per = 4.46  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 6.945e-06 S  per = 0.00815  per(accum) = 100
##### sweep opt: 4.317e+00 S #####
 T(sweep opt: fetch) = 1.064e-01 S  per = 2.46  per(accum) = 2.46
 T(sweep opt: hdiag) = 1.150e+00 S  per = 26.6  per(accum) = 29.1
 T(sweep opt: dvdsn) = 2.652e+00 S  per = 61.4  per(accum) = 90.5
 T(sweep opt: decim) = 7.274e-02 S  per = 1.69  per(accum) = 92.2
 T(sweep opt: guess) = 7.173e-03 S  per = 0.166  per(accum) = 92.4
 T(sweep opt: renrm) = 3.271e-01 S  per = 7.58  per(accum) = 100
 T(sweep opt: save ) = 1.598e-03 S  per = 0.037  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.652e+00 S  T(sum) = 2.647e+00 S  per = 9.984e+01
 T(sweep opt: preprocess                  ) = 3.013e-02 S  per = 1.14  per(accum) = 1.14
 T(sweep opt: symbolic_formulae           ) = 1.943e-02 S  per = 0.734  per(accum) = 1.87
 T(sweep opt: hintermediate init          ) = 8.175e-04 S  per = 0.0309  per(accum) = 1.9
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.699e-01 S  per = 25.3  per(accum) = 27.2
 T(sweep opt: hmmtasks init               ) = 2.621e-01 S  per =  9.9  per(accum) = 37.1
 T(sweep opt: initial guess for dvdson    ) = 7.704e-03 S  per = 0.291  per(accum) = 37.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.302e+00 S  per = 49.2  per(accum) = 86.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.583e-02 S  per = 1.35  per(accum) = 87.9
 T(sweep opt: dvdson [nccl]               ) = 1.862e-04 S  per = 0.00703  per(accum) = 87.9
 T(sweep opt: dvdson [mpi]                ) = 5.049e-06 S  per = 0.000191  per(accum) = 87.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.198e-01 S  per = 12.1  per(accum) = 100
Detailed decomposition of T(renrm) = 3.271e-01 S  T(sum) = 3.271e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.010e-03 S  per = 0.309  per(accum) = 0.309
 T(sweep opt: qops init                    ) = 8.528e-03 S  per = 2.61  per(accum) = 2.92
 T(sweep opt: symbolic_formulae_renorm     ) = 1.146e-02 S  per =  3.5  per(accum) = 6.42
 T(sweep opt: allocate qops on gpu         ) = 3.069e-04 S  per = 0.0938  per(accum) = 6.51
 T(sweep opt: site memcpy cpu2gpu          ) = 4.861e-03 S  per = 1.49  per(accum) = 8
 T(sweep opt: rintermediate init           ) = 1.329e-02 S  per = 4.06  per(accum) = 12.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.758e-02 S  per = 17.6  per(accum) = 29.7
 T(sweep opt: rmmtasks init                ) = 2.832e-02 S  per = 8.66  per(accum) = 38.3
 T(sweep opt: qops memset on cpu           ) = 2.390e-07 S  per = 7.31e-05  per(accum) = 38.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.868e-01 S  per = 57.1  per(accum) = 95.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.660e-04 S  per = 0.0813  per(accum) = 95.5
 T(sweep opt: construct opS [ifdists=true] ) = 3.170e-07 S  per = 9.69e-05  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [nccl]) = 2.240e-07 S  per = 6.85e-05  per(accum) = 95.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.728e-04 S  per = 0.145  per(accum) = 95.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.172e-04 S  per = 0.0664  per(accum) = 95.7
 T(sweep opt: qops_pool join and erase     ) = 1.396e-02 S  per = 4.27  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 2.757e-05 S  per = 0.00843  per(accum) = 100
##### global opt: 4.317e+00 S #####
 T(global opt: fetch) = 1.064e-01 S  per = 2.46  per(accum) = 2.46
 T(global opt: hdiag) = 1.150e+00 S  per = 26.6  per(accum) = 29.1
 T(global opt: dvdsn) = 2.652e+00 S  per = 61.4  per(accum) = 90.5
 T(global opt: decim) = 7.274e-02 S  per = 1.69  per(accum) = 92.2
 T(global opt: guess) = 7.173e-03 S  per = 0.166  per(accum) = 92.4
 T(global opt: renrm) = 3.271e-01 S  per = 7.58  per(accum) = 100
 T(global opt: save ) = 1.598e-03 S  per = 0.037  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.652e+00 S  T(sum) = 2.647e+00 S  per = 9.984e+01
 T(global opt: preprocess                  ) = 3.013e-02 S  per = 1.14  per(accum) = 1.14
 T(global opt: symbolic_formulae           ) = 1.943e-02 S  per = 0.734  per(accum) = 1.87
 T(global opt: hintermediate init          ) = 8.175e-04 S  per = 0.0309  per(accum) = 1.9
 T(global opt: preprocess_hformulae_Hxlist ) = 6.699e-01 S  per = 25.3  per(accum) = 27.2
 T(global opt: hmmtasks init               ) = 2.621e-01 S  per =  9.9  per(accum) = 37.1
 T(global opt: initial guess for dvdson    ) = 7.704e-03 S  per = 0.291  per(accum) = 37.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.302e+00 S  per = 49.2  per(accum) = 86.6
 T(global opt: dvdson [cpu-gpu]            ) = 3.583e-02 S  per = 1.35  per(accum) = 87.9
 T(global opt: dvdson [nccl]               ) = 1.862e-04 S  per = 0.00703  per(accum) = 87.9
 T(global opt: dvdson [mpi]                ) = 5.049e-06 S  per = 0.000191  per(accum) = 87.9
 T(global opt: dvdson [rest part(linalg)]  ) = 3.198e-01 S  per = 12.1  per(accum) = 100
Detailed decomposition of T(renrm) = 3.271e-01 S  T(sum) = 3.271e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.010e-03 S  per = 0.309  per(accum) = 0.309
 T(global opt: qops init                    ) = 8.528e-03 S  per = 2.61  per(accum) = 2.92
 T(global opt: symbolic_formulae_renorm     ) = 1.146e-02 S  per =  3.5  per(accum) = 6.42
 T(global opt: allocate qops on gpu         ) = 3.069e-04 S  per = 0.0938  per(accum) = 6.51
 T(global opt: site memcpy cpu2gpu          ) = 4.861e-03 S  per = 1.49  per(accum) = 8
 T(global opt: rintermediate init           ) = 1.329e-02 S  per = 4.06  per(accum) = 12.1
 T(global opt: preprocess_formulae_Rlist2   ) = 5.758e-02 S  per = 17.6  per(accum) = 29.7
 T(global opt: rmmtasks init                ) = 2.832e-02 S  per = 8.66  per(accum) = 38.3
 T(global opt: qops memset on cpu           ) = 2.390e-07 S  per = 7.31e-05  per(accum) = 38.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.868e-01 S  per = 57.1  per(accum) = 95.4
 T(global opt: deallocate cpu and gpu memory) = 2.660e-04 S  per = 0.0813  per(accum) = 95.5
 T(global opt: construct opS [ifdists=true] ) = 3.170e-07 S  per = 9.69e-05  per(accum) = 95.5
 T(global opt: reduction of opS & opH [nccl]) = 2.240e-07 S  per = 6.85e-05  per(accum) = 95.5
 T(global opt: qops memcpy gpu2cpu          ) = 4.728e-04 S  per = 0.145  per(accum) = 95.7
 T(global opt: reduction of opS & opH [mpi] ) = 2.172e-04 S  per = 0.0664  per(accum) = 95.7
 T(global opt: qops_pool join and erase     ) = 1.396e-02 S  per = 4.27  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 2.757e-05 S  per = 0.00843  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-6.883e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=5/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=833:6.355e-03MB:6.206e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=92:7.019e-04MB:6.855e-07GB
total mem of comb=926:7.065e-03MB:6.899e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
        per(mem): H:1.34 C:4.83 S:11.3 A:0 B:82.6 
 rqops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=9483:0.0723MB:7.07e-05GB
        per(mem): H:0.749 C:3.29 S:2.19 P:0 Q:93.8 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=13717:0.105MB:0.000102GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.414e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-7.588e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=194:1.480e-03MB
qtensor4: wf4 own=1 _data=0x35eeb800
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
 qbond: qcol nsym=7 dimAll=19
 (18,0):3 (18,2):5 (18,4):5 (18,6):3 (19,1):1 (19,3):1 (19,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=432 size=194:1.480e-03MB
### DIAG TIMING: total=6.259e-01 t1=2.579e-05, t2=1.119e-03, t3=2.489e-03, t4=6.222e-01, t5=4.197e-06, t6=3.255e-05, t7=5.020e-06
duration_diagGPU:6.259e-01
duration_diagreduce:1.120e-07
duration_diagtransform:1.180e-06
----- TIMING FOR symbolic_formulae_twodot with size=591 : 9.272e-03 S -----
rank=0 GPUmem(GB): used=1.022e-04 (oper)=1.022e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=591
 no. of hintermediate operators=286
 no. of coefficients=4083:3.115e-02MB:3.042e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.483e-04 S -----
rank=0 GPUmem(GB): used=1.326e-04 (oper,hinter)=1.022e-04,3.042e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.574e-01 S size(H_formulae)=591 size(Hxlst2)=29 T(Hmu/Hxlist)=1.724e-03,4.557e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.607e-01 S size(H_formulae)=591 size(Hxlst)=19942 -----
rank=0 GPUmem(GB): used=1.326e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=2.891e-06 batch[need]=8.469e-03 blksize=20 blksize0=16 batchsize=19942
rank=0 GPUmem(GB): used=8.605e-03 (oper,hinter,dvdson,batch)=1.022e-04,3.042e-05,2.891e-06,8.469e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=194 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.002e-03,1.019e-02,2.029e-02,1.071e-02,4.321e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=1.985e-03 speed=1.456e-03GB/S T(nccl)=1.710e-05 speed=1.690e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=4.1e-02 -----
 sigma[inter] counter=30 t=1.0e-02 per=2.5e+01 cost=1.8e+06 flops=1.7e+08
 sigma[gemm] counter=30 i=0 t=1.5e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=3 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=4 t=7.6e-03 per=1.8e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=30 i=5 t=7.5e-03 per=1.8e+01 cost=2.8e+05 flops=3.8e+07
 sigma[gemm] counter=30 i=6 t=2.6e-03 per=6.2e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=30 i=7 t=2.6e-03 per=6.2e+00 cost=4.2e+05 flops=1.6e+08
 sigma[gemm] counter=30 total t=2.0e-02 per=4.9e+01 cost=1.4e+06 flops=6.9e+07
 sigma[red] counter=30 t=1.1e-02 per=2.6e+01 cost=3.0e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=2.7e-01 t_gemm=7.3e-01 t_reduction=3.4e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=30 t=2.7e-01 per=2.0e+01 cost=1.5e+07 flops=5.5e+07
 sigma_tot[gemm] counter=30 i=0 t=8.2e-05 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=7.3e-05 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=5.3e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=3 t=5.3e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=4 t=1.8e-01 per=1.4e+01 cost=2.8e+06 flops=1.5e+07
 sigma_tot[gemm] counter=30 i=5 t=1.9e-01 per=1.4e+01 cost=2.9e+06 flops=1.5e+07
 sigma_tot[gemm] counter=30 i=6 t=1.8e-01 per=1.3e+01 cost=3.0e+06 flops=1.7e+07
 sigma_tot[gemm] counter=30 i=7 t=1.8e-01 per=1.3e+01 cost=3.2e+06 flops=1.8e+07
 sigma_tot[gemm] counter=30 total t=7.3e-01 per=5.4e+01 cost=1.2e+07 flops=1.6e+07
 sigma_tot[red] counter=30 t=3.4e-01 per=2.6e+01 cost=3.1e+06 flops=8.9e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,9.9e-06,2.2e-06,3.2e-06,2.6e-07
settings: ndim=194 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.217292960069 -1.116e+03  5.493e-02    1     1  4.335e-02 4.335e-02 4.331e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.085e-04,1.007e-02,2.005e-02,1.060e-02,4.144e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=7.032e-04 speed=4.111e-03GB/S T(nccl)=5.372e-06 speed=5.381e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=4.1e-02 -----
 sigma[inter] counter=31 t=1.0e-02 per=2.5e+01 cost=1.8e+06 flops=1.7e+08
 sigma[gemm] counter=31 i=0 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=3 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=4 t=7.6e-03 per=1.9e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=31 i=5 t=7.4e-03 per=1.8e+01 cost=2.8e+05 flops=3.8e+07
 sigma[gemm] counter=31 i=6 t=2.5e-03 per=6.1e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=31 i=7 t=2.5e-03 per=6.1e+00 cost=4.2e+05 flops=1.7e+08
 sigma[gemm] counter=31 total t=2.0e-02 per=4.9e+01 cost=1.4e+06 flops=7.0e+07
 sigma[red] counter=31 t=1.1e-02 per=2.6e+01 cost=3.0e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=2.8e-01 t_gemm=7.5e-01 t_reduction=3.5e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=31 t=2.8e-01 per=2.0e+01 cost=1.7e+07 flops=6.0e+07
 sigma_tot[gemm] counter=31 i=0 t=8.3e-05 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=7.4e-05 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=5.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=3 t=5.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=4 t=1.9e-01 per=1.4e+01 cost=3.1e+06 flops=1.6e+07
 sigma_tot[gemm] counter=31 i=5 t=1.9e-01 per=1.4e+01 cost=3.1e+06 flops=1.6e+07
 sigma_tot[gemm] counter=31 i=6 t=1.8e-01 per=1.3e+01 cost=3.4e+06 flops=1.9e+07
 sigma_tot[gemm] counter=31 i=7 t=1.8e-01 per=1.3e+01 cost=3.6e+06 flops=2.0e+07
 sigma_tot[gemm] counter=31 total t=7.5e-01 per=5.4e+01 cost=1.3e+07 flops=1.8e+07
 sigma_tot[red] counter=31 t=3.5e-01 per=2.6e+01 cost=3.3e+06 flops=9.5e+06
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,4.7e-05,3.6e-06,1.8e-06,2.3e-07
    2   0 -    -116.232659895834 -1.537e-02  2.305e-02    2     2  1.033e-01 5.167e-02 4.243e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.282e-03,1.006e-02,2.015e-02,1.078e-02,4.228e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=1.277e-03 speed=2.265e-03GB/S T(nccl)=4.993e-06 speed=5.790e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=4.1e-02 -----
 sigma[inter] counter=32 t=1.0e-02 per=2.5e+01 cost=1.8e+06 flops=1.7e+08
 sigma[gemm] counter=32 i=0 t=1.5e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=3 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=4 t=7.5e-03 per=1.8e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=32 i=5 t=7.5e-03 per=1.8e+01 cost=2.8e+05 flops=3.8e+07
 sigma[gemm] counter=32 i=6 t=2.6e-03 per=6.3e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=32 i=7 t=2.6e-03 per=6.3e+00 cost=4.2e+05 flops=1.6e+08
 sigma[gemm] counter=32 total t=2.0e-02 per=4.9e+01 cost=1.4e+06 flops=7.0e+07
 sigma[red] counter=32 t=1.1e-02 per=2.6e+01 cost=3.0e+05 flops=2.7e+07
----- TIMING FOR sigma_tot : t_inter=2.9e-01 t_gemm=7.7e-01 t_reduction=3.6e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=32 t=2.9e-01 per=2.0e+01 cost=1.8e+07 flops=6.4e+07
 sigma_tot[gemm] counter=32 i=0 t=8.5e-05 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=7.5e-05 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=5.5e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=3 t=5.5e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=4 t=2.0e-01 per=1.4e+01 cost=3.4e+06 flops=1.7e+07
 sigma_tot[gemm] counter=32 i=5 t=2.0e-01 per=1.4e+01 cost=3.4e+06 flops=1.7e+07
 sigma_tot[gemm] counter=32 i=6 t=1.8e-01 per=1.3e+01 cost=3.8e+06 flops=2.1e+07
 sigma_tot[gemm] counter=32 i=7 t=1.8e-01 per=1.3e+01 cost=4.0e+06 flops=2.2e+07
 sigma_tot[gemm] counter=32 total t=7.7e-01 per=5.4e+01 cost=1.5e+07 flops=1.9e+07
 sigma_tot[red] counter=32 t=3.6e-01 per=2.6e+01 cost=3.6e+06 flops=1.0e+07
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,2.5e-05,2.9e-06,1.7e-06,2.2e-07
    3   0 -    -116.234226590508 -1.567e-03  9.046e-03    3     3  1.573e-01 5.243e-02 4.241e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.335e-04,1.007e-02,2.030e-02,1.067e-02,4.199e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=9.265e-04 speed=3.120e-03GB/S T(nccl)=6.958e-06 speed=4.155e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=4.1e-02 -----
 sigma[inter] counter=33 t=1.0e-02 per=2.5e+01 cost=1.8e+06 flops=1.7e+08
 sigma[gemm] counter=33 i=0 t=1.7e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=1.5e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=3 t=1.5e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=4 t=7.6e-03 per=1.8e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=33 i=5 t=7.6e-03 per=1.9e+01 cost=2.8e+05 flops=3.7e+07
 sigma[gemm] counter=33 i=6 t=2.6e-03 per=6.3e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=33 i=7 t=2.6e-03 per=6.3e+00 cost=4.2e+05 flops=1.6e+08
 sigma[gemm] counter=33 total t=2.0e-02 per=4.9e+01 cost=1.4e+06 flops=6.9e+07
 sigma[red] counter=33 t=1.1e-02 per=2.6e+01 cost=3.0e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=3.0e-01 t_gemm=7.9e-01 t_reduction=3.7e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=33 t=3.0e-01 per=2.1e+01 cost=2.0e+07 flops=6.7e+07
 sigma_tot[gemm] counter=33 i=0 t=8.7e-05 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=7.7e-05 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=5.7e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=3 t=5.7e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=4 t=2.1e-01 per=1.4e+01 cost=3.7e+06 flops=1.8e+07
 sigma_tot[gemm] counter=33 i=5 t=2.1e-01 per=1.4e+01 cost=3.7e+06 flops=1.8e+07
 sigma_tot[gemm] counter=33 i=6 t=1.8e-01 per=1.3e+01 cost=4.2e+06 flops=2.3e+07
 sigma_tot[gemm] counter=33 i=7 t=1.9e-01 per=1.3e+01 cost=4.4e+06 flops=2.4e+07
 sigma_tot[gemm] counter=33 total t=7.9e-01 per=5.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[red] counter=33 t=3.7e-01 per=2.6e+01 cost=3.9e+06 flops=1.1e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.5e-05,3.2e-06,1.9e-06,3.2e-07
    4   0 -    -116.234459483751 -2.329e-04  3.726e-03    3     4  2.092e-01 5.230e-02 4.234e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.345e-04,1.013e-02,2.026e-02,1.087e-02,4.211e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=8.288e-04 speed=3.488e-03GB/S T(nccl)=5.681e-06 speed=5.089e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=4.1e-02 -----
 sigma[inter] counter=34 t=1.0e-02 per=2.5e+01 cost=1.8e+06 flops=1.7e+08
 sigma[gemm] counter=34 i=0 t=6.0e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=3 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=4 t=7.6e-03 per=1.8e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=34 i=5 t=7.5e-03 per=1.8e+01 cost=2.8e+05 flops=3.8e+07
 sigma[gemm] counter=34 i=6 t=2.5e-03 per=6.1e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=34 i=7 t=2.6e-03 per=6.2e+00 cost=4.2e+05 flops=1.7e+08
 sigma[gemm] counter=34 total t=2.0e-02 per=4.9e+01 cost=1.4e+06 flops=6.9e+07
 sigma[red] counter=34 t=1.1e-02 per=2.6e+01 cost=3.0e+05 flops=2.7e+07
----- TIMING FOR sigma_tot : t_inter=3.1e-01 t_gemm=8.1e-01 t_reduction=3.9e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=34 t=3.1e-01 per=2.1e+01 cost=2.2e+07 flops=7.1e+07
 sigma_tot[gemm] counter=34 i=0 t=9.3e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=7.8e-05 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=5.8e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=3 t=5.8e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=4 t=2.1e-01 per=1.4e+01 cost=4.0e+06 flops=1.8e+07
 sigma_tot[gemm] counter=34 i=5 t=2.2e-01 per=1.4e+01 cost=4.0e+06 flops=1.8e+07
 sigma_tot[gemm] counter=34 i=6 t=1.9e-01 per=1.2e+01 cost=4.6e+06 flops=2.5e+07
 sigma_tot[gemm] counter=34 i=7 t=1.9e-01 per=1.3e+01 cost=4.9e+06 flops=2.6e+07
 sigma_tot[gemm] counter=34 total t=8.1e-01 per=5.4e+01 cost=1.7e+07 flops=2.2e+07
 sigma_tot[red] counter=34 t=3.9e-01 per=2.6e+01 cost=4.2e+06 flops=1.1e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.4e-05,3.1e-06,1.7e-06,3.0e-07
    5   0 -    -116.234499291415 -3.981e-05  1.449e-03    3     5  2.634e-01 5.268e-02 4.231e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.301e-04,2.155e-03,7.892e-03,3.260e-03,1.415e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=8.242e-04 speed=3.507e-03GB/S T(nccl)=5.878e-06 speed=4.918e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-03 t_gemm=7.9e-03 t_reduction=3.3e-03 tot=1.3e-02 -----
 sigma[inter] counter=35 t=2.2e-03 per=1.6e+01 cost=1.8e+06 flops=8.2e+08
 sigma[gemm] counter=35 i=0 t=1.7e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=1.5e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=1.5e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=3 t=1.5e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=4 t=4.1e-03 per=3.1e+01 cost=2.9e+05 flops=6.9e+07
 sigma[gemm] counter=35 i=5 t=2.5e-03 per=1.9e+01 cost=2.8e+05 flops=1.1e+08
 sigma[gemm] counter=35 i=6 t=6.6e-04 per=5.0e+00 cost=4.1e+05 flops=6.2e+08
 sigma[gemm] counter=35 i=7 t=6.1e-04 per=4.5e+00 cost=4.2e+05 flops=7.0e+08
 sigma[gemm] counter=35 total t=7.9e-03 per=5.9e+01 cost=1.4e+06 flops=1.8e+08
 sigma[red] counter=35 t=3.3e-03 per=2.5e+01 cost=3.0e+05 flops=9.1e+07
----- TIMING FOR sigma_tot : t_inter=3.1e-01 t_gemm=8.1e-01 t_reduction=3.9e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=35 t=3.1e-01 per=2.1e+01 cost=2.4e+07 flops=7.6e+07
 sigma_tot[gemm] counter=35 i=0 t=9.4e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=7.9e-05 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=5.9e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=3 t=5.9e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=4 t=2.2e-01 per=1.4e+01 cost=4.3e+06 flops=1.9e+07
 sigma_tot[gemm] counter=35 i=5 t=2.2e-01 per=1.4e+01 cost=4.3e+06 flops=2.0e+07
 sigma_tot[gemm] counter=35 i=6 t=1.9e-01 per=1.2e+01 cost=5.0e+06 flops=2.7e+07
 sigma_tot[gemm] counter=35 i=7 t=1.9e-01 per=1.2e+01 cost=5.3e+06 flops=2.8e+07
 sigma_tot[gemm] counter=35 total t=8.1e-01 per=5.4e+01 cost=1.9e+07 flops=2.3e+07
 sigma_tot[red] counter=35 t=3.9e-01 per=2.6e+01 cost=4.5e+06 flops=1.2e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.5e-05,3.3e-06,1.8e-06,3.0e-07
    6   0 -    -116.234505308352 -6.017e-06  4.517e-04    3     6  2.905e-01 4.842e-02 3.764e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.269e-03,1.007e-02,2.002e-02,1.062e-02,4.199e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=1.264e-03 speed=2.287e-03GB/S T(nccl)=4.869e-06 speed=5.937e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=4.1e-02 -----
 sigma[inter] counter=36 t=1.0e-02 per=2.5e+01 cost=1.8e+06 flops=1.7e+08
 sigma[gemm] counter=36 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=3 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=4 t=7.5e-03 per=1.8e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=36 i=5 t=7.5e-03 per=1.8e+01 cost=2.8e+05 flops=3.8e+07
 sigma[gemm] counter=36 i=6 t=2.5e-03 per=6.2e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=36 i=7 t=2.5e-03 per=6.2e+00 cost=4.2e+05 flops=1.7e+08
 sigma[gemm] counter=36 total t=2.0e-02 per=4.9e+01 cost=1.4e+06 flops=7.0e+07
 sigma[red] counter=36 t=1.1e-02 per=2.6e+01 cost=3.0e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=3.2e-01 t_gemm=8.3e-01 t_reduction=4.0e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=36 t=3.2e-01 per=2.1e+01 cost=2.6e+07 flops=7.9e+07
 sigma_tot[gemm] counter=36 i=0 t=9.6e-05 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=8.1e-05 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=6.1e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=3 t=6.1e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=4 t=2.3e-01 per=1.5e+01 cost=4.5e+06 flops=2.0e+07
 sigma_tot[gemm] counter=36 i=5 t=2.3e-01 per=1.5e+01 cost=4.6e+06 flops=2.0e+07
 sigma_tot[gemm] counter=36 i=6 t=1.9e-01 per=1.2e+01 cost=5.4e+06 flops=2.9e+07
 sigma_tot[gemm] counter=36 i=7 t=1.9e-01 per=1.2e+01 cost=5.7e+06 flops=3.0e+07
 sigma_tot[gemm] counter=36 total t=8.3e-01 per=5.4e+01 cost=2.0e+07 flops=2.4e+07
 sigma_tot[red] counter=36 t=4.0e-01 per=2.6e+01 cost=4.8e+06 flops=1.2e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.4e-05,3.1e-06,1.5e-06,2.4e-07
    7   0 -    -116.234506073987 -7.656e-07  2.023e-04    3     7  3.376e-01 4.824e-02 3.827e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.068e-03,9.922e-03,2.001e-02,1.071e-02,4.174e-02
 analyze_tgpu[Hx]: ndim=194:1.445e-06GB T(cpu-gpu)=1.062e-03 speed=2.723e-03GB/S T(nccl)=5.950e-06 speed=4.859e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=4.1e-02 -----
 sigma[inter] counter=37 t=9.9e-03 per=2.4e+01 cost=1.8e+06 flops=1.8e+08
 sigma[gemm] counter=37 i=0 t=1.5e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=3 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=4 t=7.5e-03 per=1.8e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=37 i=5 t=7.4e-03 per=1.8e+01 cost=2.8e+05 flops=3.8e+07
 sigma[gemm] counter=37 i=6 t=2.5e-03 per=6.2e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=37 i=7 t=2.5e-03 per=6.3e+00 cost=4.2e+05 flops=1.7e+08
 sigma[gemm] counter=37 total t=2.0e-02 per=4.9e+01 cost=1.4e+06 flops=7.0e+07
 sigma[red] counter=37 t=1.1e-02 per=2.6e+01 cost=3.0e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=3.3e-01 t_gemm=8.5e-01 t_reduction=4.1e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=37 t=3.3e-01 per=2.1e+01 cost=2.7e+07 flops=8.2e+07
 sigma_tot[gemm] counter=37 i=0 t=9.7e-05 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=8.2e-05 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=6.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=3 t=6.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=4 t=2.3e-01 per=1.5e+01 cost=4.8e+06 flops=2.1e+07
 sigma_tot[gemm] counter=37 i=5 t=2.3e-01 per=1.5e+01 cost=4.9e+06 flops=2.1e+07
 sigma_tot[gemm] counter=37 i=6 t=1.9e-01 per=1.2e+01 cost=5.8e+06 flops=3.0e+07
 sigma_tot[gemm] counter=37 i=7 t=1.9e-01 per=1.2e+01 cost=6.1e+06 flops=3.2e+07
 sigma_tot[gemm] counter=37 total t=8.5e-01 per=5.4e+01 cost=2.2e+07 flops=2.5e+07
 sigma_tot[red] counter=37 t=4.1e-01 per=2.6e+01 cost=5.1e+06 flops=1.3e+07
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.5e-05,3.3e-06,2.0e-06,2.9e-07
    8   0 +    -116.234506198197 -1.242e-07  6.082e-05    3     8  3.871e-01 4.839e-02 3.872e-02
TIMING FOR Davidson : 3.871e-01  T(cal/comm/rest)=3.098e-01,1.287e-06,7.732e-02
decomposed t_rest=7.732e-02
 T(sub)    =2.436e-04 per=3.151e-01
 T(precond)=7.682e-02 per=9.936e+01
 T(ortho)  =6.137e-05 per=7.937e-02
 T(xcopy)  =1.373e-06 per=1.776e-03
 T(xnrm2)  =3.867e-06 per=5.001e-03
 T(other)  =1.866e-04 per=2.414e-01
optimized energies: isweep=0 ibond=5 dots=2 e[0]=-116.234506198197 nmvp=8
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=9.033e-03 change=5.151e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=10 dimAll=40
 (9,3):7 (11,3):4 (10,2):9 (10,4):5 (9,1):5 (11,1):3 (10,0):3 (8,2):2 (8,4):1 (9,5):1
timing for divide=1.3e-04
timing for compute=1.3e-02
timing for collect=3.0e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.3e-04,1.3e-02,0.0e+00,1.4e-05,3.0e-05 -----
decimation summary: 40->10 dwt=+5.145e-02 SvN=1.503e+00
 qbond: qkept nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
----- TIMING for decimation_row(nkr): 1.359e-02 S T(decim/select/formRot)=1.310e-02,3.862e-04,1.035e-04 -----
----- TIMING FOR twodot_decimation: 1.455e-02 S T(wf/decim)=9.393e-04,1.361e-02 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
        per(mem): H:1.1 C:3.31 S:6.15 A:0 B:89.4 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=8.942e-03 change=2.524e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=126 : 3.318e-03 S -----
rank=0 GPUmem(GB): used=8.086e-05 (oper)=4.300e-05
rank=0 GPUmem(GB): used=8.132e-05 (oper,site)=4.300e-05,4.619e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=126
 no. of rintermediate operators=122
 no. of coefficients=1899:1.449e-02MB:1.415e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.499e-03 S -----
rank=0 GPUmem(GB): used=9.547e-05 (oper,site,rinter)=4.300e-05,4.619e-07,1.415e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.571e-02 S size(rtasks)=126 size(Rlst2)=25 T(Rmu/Rlist)=8.376e-04,2.487e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.594e-02 S size(rtasks)=126 size(Rlst)=2153 -----
rank=0 GPUmem(GB): used=9.547e-05 avail=6.174e+00 total=6.174e+00 batch[need]=7.860e-04 blksize=16 blksize0=16 batchsize=2153
rank=0 GPUmem(GB): used=8.815e-04 (oper,site,rinter,batch)=4.300e-05,4.619e-07,1.415e-05,7.860e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.531e-03,2.224e-02,9.913e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=6 t=6.5e-03 per=1.7e+01 cost=2.0e+05 flops=3.1e+07
 renorm[gemm] counter=6 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=4 t=7.4e-03 per=1.9e+01 cost=2.3e+04 flops=3.1e+06
 renorm[gemm] counter=6 i=5 t=7.4e-03 per=1.9e+01 cost=5.7e+04 flops=7.7e+06
 renorm[gemm] counter=6 i=6 t=7.4e-03 per=1.9e+01 cost=5.7e+04 flops=7.7e+06
 renorm[gemm] counter=6 total t=2.2e-02 per=5.7e+01 cost=1.4e+05 flops=6.2e+06
 renorm[red] counter=6 t=9.9e-03 per=2.6e+01 cost=2.0e+04 flops=2.0e+06
----- TIMING FOR renorm_tot : t_inter=3.1e-02 t_gemm=1.3e-01 t_reduction=6.0e-02 tot=2.2e-01 -----
 renorm_tot[inter] counter=6 t=3.1e-02 per=1.4e+01 cost=3.8e+05 flops=1.2e+07
 renorm_tot[gemm] counter=6 i=0 t=1.0e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=8.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=8.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=3 t=8.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=4 t=4.4e-02 per=1.9e+01 cost=5.8e+04 flops=1.3e+06
 renorm_tot[gemm] counter=6 i=5 t=4.5e-02 per=2.0e+01 cost=1.1e+05 flops=2.5e+06
 renorm_tot[gemm] counter=6 i=6 t=4.5e-02 per=2.0e+01 cost=1.5e+05 flops=3.2e+06
 renorm_tot[gemm] counter=6 total t=1.3e-01 per=6.0e+01 cost=3.2e+05 flops=2.4e+06
 renorm_tot[red] counter=6 t=6.0e-02 per=2.7e+01 cost=6.1e+04 flops=1.0e+06
qops.to_cpu: size(tot)=2536:1.9e-02MB:1.9e-05GB T(to_cpu)=1.5e-04S speed=1.3e-01GB/S
check ||H-H.dagger||=7.949e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0906 S rank=0 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=9.262e-03 change=7.319e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=9.766e-03 change=-2.177e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=9.766e-03 change=-3.695e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.763e+00 S #####
 T(local opt: fetch) = 1.626e-02 S  per = 0.922  per(accum) = 0.922
 T(local opt: hdiag) = 6.268e-01 S  per = 35.6  per(accum) = 36.5
 T(local opt: dvdsn) = 1.008e+00 S  per = 57.2  per(accum) = 93.7
 T(local opt: decim) = 1.458e-02 S  per = 0.827  per(accum) = 94.5
 T(local opt: guess) = 1.661e-03 S  per = 0.0942  per(accum) = 94.6
 T(local opt: renrm) = 9.503e-02 S  per = 5.39  per(accum) = 100
 T(local opt: save ) = 3.850e-04 S  per = 0.0218  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.008e+00 S  T(sum) = 1.007e+00 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 6.680e-03 S  per = 0.663  per(accum) = 0.663
 T(local opt: symbolic_formulae           ) = 9.310e-03 S  per = 0.924  per(accum) = 1.59
 T(local opt: hintermediate init          ) = 3.690e-04 S  per = 0.0366  per(accum) = 1.62
 T(local opt: preprocess_hformulae_Hxlist ) = 4.616e-01 S  per = 45.8  per(accum) = 47.5
 T(local opt: hmmtasks init               ) = 1.401e-01 S  per = 13.9  per(accum) = 61.4
 T(local opt: initial guess for dvdson    ) = 1.944e-03 S  per = 0.193  per(accum) = 61.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.008e-01 S  per = 29.9  per(accum) = 91.4
 T(local opt: dvdson [cpu-gpu]            ) = 8.870e-03 S  per = 0.881  per(accum) = 92.3
 T(local opt: dvdson [nccl]               ) = 5.681e-05 S  per = 0.00564  per(accum) = 92.3
 T(local opt: dvdson [mpi]                ) = 1.287e-06 S  per = 0.000128  per(accum) = 92.3
 T(local opt: dvdson [rest part(linalg)]  ) = 7.732e-02 S  per = 7.68  per(accum) = 100
Detailed decomposition of T(renrm) = 9.503e-02 S  T(sum) = 9.503e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.885e-04 S  per = 0.304  per(accum) = 0.304
 T(local opt: qops init                    ) = 5.294e-03 S  per = 5.57  per(accum) = 5.87
 T(local opt: symbolic_formulae_renorm     ) = 3.331e-03 S  per =  3.5  per(accum) = 9.38
 T(local opt: allocate qops on gpu         ) = 6.308e-05 S  per = 0.0664  per(accum) = 9.45
 T(local opt: site memcpy cpu2gpu          ) = 1.183e-03 S  per = 1.24  per(accum) = 10.7
 T(local opt: rintermediate init           ) = 2.511e-03 S  per = 2.64  per(accum) = 13.3
 T(local opt: preprocess_formulae_Rlist2   ) = 2.601e-02 S  per = 27.4  per(accum) = 40.7
 T(local opt: rmmtasks init                ) = 1.311e-02 S  per = 13.8  per(accum) = 54.5
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 4e-05  per(accum) = 54.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.877e-02 S  per = 40.8  per(accum) = 95.3
 T(local opt: deallocate cpu and gpu memory) = 1.034e-04 S  per = 0.109  per(accum) = 95.4
 T(local opt: construct opS [ifdists=true] ) = 4.300e-08 S  per = 4.52e-05  per(accum) = 95.4
 T(local opt: reduction of opS & opH [nccl]) = 4.000e-08 S  per = 4.21e-05  per(accum) = 95.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.553e-04 S  per = 0.163  per(accum) = 95.6
 T(local opt: reduction of opS & opH [mpi] ) = 5.974e-05 S  per = 0.0629  per(accum) = 95.6
 T(local opt: qops_pool join and erase     ) = 4.145e-03 S  per = 4.36  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.444e-06 S  per = 0.00994  per(accum) = 100
##### sweep opt: 6.080e+00 S #####
 T(sweep opt: fetch) = 1.226e-01 S  per = 2.02  per(accum) = 2.02
 T(sweep opt: hdiag) = 1.777e+00 S  per = 29.2  per(accum) = 31.2
 T(sweep opt: dvdsn) = 3.660e+00 S  per = 60.2  per(accum) = 91.4
 T(sweep opt: decim) = 8.731e-02 S  per = 1.44  per(accum) = 92.9
 T(sweep opt: guess) = 8.834e-03 S  per = 0.145  per(accum) = 93
 T(sweep opt: renrm) = 4.221e-01 S  per = 6.94  per(accum) = 100
 T(sweep opt: save ) = 1.983e-03 S  per = 0.0326  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.660e+00 S  T(sum) = 3.655e+00 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 3.681e-02 S  per = 1.01  per(accum) = 1.01
 T(sweep opt: symbolic_formulae           ) = 2.874e-02 S  per = 0.786  per(accum) = 1.79
 T(sweep opt: hintermediate init          ) = 1.186e-03 S  per = 0.0325  per(accum) = 1.83
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.132e+00 S  per =   31  per(accum) = 32.8
 T(sweep opt: hmmtasks init               ) = 4.022e-01 S  per =   11  per(accum) = 43.8
 T(sweep opt: initial guess for dvdson    ) = 9.648e-03 S  per = 0.264  per(accum) = 44.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.602e+00 S  per = 43.8  per(accum) = 87.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.470e-02 S  per = 1.22  per(accum) = 89.1
 T(sweep opt: dvdson [nccl]               ) = 2.430e-04 S  per = 0.00665  per(accum) = 89.1
 T(sweep opt: dvdson [mpi]                ) = 6.336e-06 S  per = 0.000173  per(accum) = 89.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.971e-01 S  per = 10.9  per(accum) = 100
Detailed decomposition of T(renrm) = 4.221e-01 S  T(sum) = 4.221e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.298e-03 S  per = 0.308  per(accum) = 0.308
 T(sweep opt: qops init                    ) = 1.382e-02 S  per = 3.27  per(accum) = 3.58
 T(sweep opt: symbolic_formulae_renorm     ) = 1.479e-02 S  per =  3.5  per(accum) = 7.09
 T(sweep opt: allocate qops on gpu         ) = 3.700e-04 S  per = 0.0877  per(accum) = 7.17
 T(sweep opt: site memcpy cpu2gpu          ) = 6.044e-03 S  per = 1.43  per(accum) = 8.61
 T(sweep opt: rintermediate init           ) = 1.580e-02 S  per = 3.74  per(accum) = 12.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.359e-02 S  per = 19.8  per(accum) = 32.2
 T(sweep opt: rmmtasks init                ) = 4.143e-02 S  per = 9.81  per(accum) = 42
 T(sweep opt: qops memset on cpu           ) = 2.770e-07 S  per = 6.56e-05  per(accum) = 42
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.255e-01 S  per = 53.4  per(accum) = 95.4
 T(sweep opt: deallocate cpu and gpu memory) = 3.694e-04 S  per = 0.0875  per(accum) = 95.5
 T(sweep opt: construct opS [ifdists=true] ) = 3.600e-07 S  per = 8.53e-05  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [nccl]) = 2.640e-07 S  per = 6.25e-05  per(accum) = 95.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.281e-04 S  per = 0.149  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.770e-04 S  per = 0.0656  per(accum) = 95.7
 T(sweep opt: qops_pool join and erase     ) = 1.810e-02 S  per = 4.29  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 3.702e-05 S  per = 0.00877  per(accum) = 100
##### global opt: 6.080e+00 S #####
 T(global opt: fetch) = 1.226e-01 S  per = 2.02  per(accum) = 2.02
 T(global opt: hdiag) = 1.777e+00 S  per = 29.2  per(accum) = 31.2
 T(global opt: dvdsn) = 3.660e+00 S  per = 60.2  per(accum) = 91.4
 T(global opt: decim) = 8.731e-02 S  per = 1.44  per(accum) = 92.9
 T(global opt: guess) = 8.834e-03 S  per = 0.145  per(accum) = 93
 T(global opt: renrm) = 4.221e-01 S  per = 6.94  per(accum) = 100
 T(global opt: save ) = 1.983e-03 S  per = 0.0326  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.660e+00 S  T(sum) = 3.655e+00 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 3.681e-02 S  per = 1.01  per(accum) = 1.01
 T(global opt: symbolic_formulae           ) = 2.874e-02 S  per = 0.786  per(accum) = 1.79
 T(global opt: hintermediate init          ) = 1.186e-03 S  per = 0.0325  per(accum) = 1.83
 T(global opt: preprocess_hformulae_Hxlist ) = 1.132e+00 S  per =   31  per(accum) = 32.8
 T(global opt: hmmtasks init               ) = 4.022e-01 S  per =   11  per(accum) = 43.8
 T(global opt: initial guess for dvdson    ) = 9.648e-03 S  per = 0.264  per(accum) = 44.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.602e+00 S  per = 43.8  per(accum) = 87.9
 T(global opt: dvdson [cpu-gpu]            ) = 4.470e-02 S  per = 1.22  per(accum) = 89.1
 T(global opt: dvdson [nccl]               ) = 2.430e-04 S  per = 0.00665  per(accum) = 89.1
 T(global opt: dvdson [mpi]                ) = 6.336e-06 S  per = 0.000173  per(accum) = 89.1
 T(global opt: dvdson [rest part(linalg)]  ) = 3.971e-01 S  per = 10.9  per(accum) = 100
Detailed decomposition of T(renrm) = 4.221e-01 S  T(sum) = 4.221e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.298e-03 S  per = 0.308  per(accum) = 0.308
 T(global opt: qops init                    ) = 1.382e-02 S  per = 3.27  per(accum) = 3.58
 T(global opt: symbolic_formulae_renorm     ) = 1.479e-02 S  per =  3.5  per(accum) = 7.09
 T(global opt: allocate qops on gpu         ) = 3.700e-04 S  per = 0.0877  per(accum) = 7.17
 T(global opt: site memcpy cpu2gpu          ) = 6.044e-03 S  per = 1.43  per(accum) = 8.61
 T(global opt: rintermediate init           ) = 1.580e-02 S  per = 3.74  per(accum) = 12.3
 T(global opt: preprocess_formulae_Rlist2   ) = 8.359e-02 S  per = 19.8  per(accum) = 32.2
 T(global opt: rmmtasks init                ) = 4.143e-02 S  per = 9.81  per(accum) = 42
 T(global opt: qops memset on cpu           ) = 2.770e-07 S  per = 6.56e-05  per(accum) = 42
 T(global opt: preprocess_renorm_batchGPU   ) = 2.255e-01 S  per = 53.4  per(accum) = 95.4
 T(global opt: deallocate cpu and gpu memory) = 3.694e-04 S  per = 0.0875  per(accum) = 95.5
 T(global opt: construct opS [ifdists=true] ) = 3.600e-07 S  per = 8.53e-05  per(accum) = 95.5
 T(global opt: reduction of opS & opH [nccl]) = 2.640e-07 S  per = 6.25e-05  per(accum) = 95.5
 T(global opt: qops memcpy gpu2cpu          ) = 6.281e-04 S  per = 0.149  per(accum) = 95.6
 T(global opt: reduction of opS & opH [mpi] ) = 2.770e-04 S  per = 0.0656  per(accum) = 95.7
 T(global opt: qops_pool join and erase     ) = 1.810e-02 S  per = 4.29  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 3.702e-05 S  per = 0.00877  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.100e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=6/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=761:5.806e-03MB:5.670e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=811:6.187e-03MB:6.042e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
        per(mem): H:1.1 C:3.31 S:6.15 A:0 B:89.4 
 rqops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=11706:0.0893MB:8.72e-05GB
        per(mem): H:0.607 C:2.44 S:2 P:0 Q:95 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=16238:0.124MB:0.000121GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.550e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-9.114e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=62:4.730e-04MB
qtensor4: wf4 own=1 _data=0x452ac600
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
 qbond: qcol nsym=7 dimAll=19
 (16,0):3 (16,2):5 (16,4):5 (16,6):3 (17,1):1 (17,3):1 (17,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=513 size=62:4.730e-04MB
### DIAG TIMING: total=8.203e-01 t1=2.583e-05, t2=1.136e-04, t3=2.469e-03, t4=8.177e-01, t5=1.130e-05, t6=2.689e-05, t7=1.021e-05
duration_diagGPU:8.204e-01
duration_diagreduce:2.690e-07
duration_diagtransform:8.360e-07
----- TIMING FOR symbolic_formulae_twodot with size=704 : 1.666e-02 S -----
rank=0 GPUmem(GB): used=1.210e-04 (oper)=1.210e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=704
 no. of hintermediate operators=333
 no. of coefficients=4876:3.720e-02MB:3.633e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.430e-04 S -----
rank=0 GPUmem(GB): used=1.573e-04 (oper,hinter)=1.210e-04,3.633e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.941e-01 S size(H_formulae)=704 size(Hxlst2)=15 T(Hmu/Hxlist)=3.255e-03,1.908e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.955e-01 S size(H_formulae)=704 size(Hxlst)=8196 -----
rank=0 GPUmem(GB): used=1.573e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=9.239e-07 batch[need]=3.481e-03 blksize=20 blksize0=16 batchsize=8196
rank=0 GPUmem(GB): used=3.639e-03 (oper,hinter,dvdson,batch)=1.210e-04,3.633e-05,9.239e-07,3.481e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=62 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.218e-03,1.004e-02,3.024e-02,1.040e-02,5.191e-02
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=1.209e-03 speed=7.643e-04GB/S T(nccl)=9.199e-06 speed=1.004e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=38 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=5.0e+07
 sigma[gemm] counter=38 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=4 t=7.6e-03 per=1.5e+01 cost=6.8e+04 flops=8.9e+06
 sigma[gemm] counter=38 i=5 t=7.6e-03 per=1.5e+01 cost=6.9e+04 flops=9.1e+06
 sigma[gemm] counter=38 i=6 t=7.5e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=38 i=7 t=7.6e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=38 total t=3.0e-02 per=6.0e+01 cost=3.5e+05 flops=1.2e+07
 sigma[red] counter=38 t=1.0e-02 per=2.1e+01 cost=8.0e+04 flops=7.7e+06
----- TIMING FOR sigma_tot : t_inter=3.4e-01 t_gemm=8.9e-01 t_reduction=4.2e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=38 t=3.4e-01 per=2.1e+01 cost=2.8e+07 flops=8.1e+07
 sigma_tot[gemm] counter=38 i=0 t=9.9e-05 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=8.3e-05 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=6.3e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=3 t=6.3e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=4 t=2.4e-01 per=1.5e+01 cost=4.9e+06 flops=2.0e+07
 sigma_tot[gemm] counter=38 i=5 t=2.4e-01 per=1.5e+01 cost=4.9e+06 flops=2.0e+07
 sigma_tot[gemm] counter=38 i=6 t=2.0e-01 per=1.2e+01 cost=6.0e+06 flops=3.0e+07
 sigma_tot[gemm] counter=38 i=7 t=2.0e-01 per=1.2e+01 cost=6.2e+06 flops=3.1e+07
 sigma_tot[gemm] counter=38 total t=8.9e-01 per=5.4e+01 cost=2.2e+07 flops=2.5e+07
 sigma_tot[red] counter=38 t=4.2e-01 per=2.6e+01 cost=5.2e+06 flops=1.2e+07
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,5.5e-06,2.3e-06,1.1e-06,2.2e-07
settings: ndim=62 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.218052701478 -1.116e+03  6.554e-02    1     1  5.206e-02 5.206e-02 5.203e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.906e-03,9.903e-03,3.004e-02,1.041e-02,5.227e-02
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=1.899e-03 speed=4.865e-04GB/S T(nccl)=6.879e-06 speed=1.343e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=39 t=9.9e-03 per=2.0e+01 cost=5.0e+05 flops=5.0e+07
 sigma[gemm] counter=39 i=0 t=1.9e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=3 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=4 t=7.5e-03 per=1.5e+01 cost=6.8e+04 flops=9.0e+06
 sigma[gemm] counter=39 i=5 t=7.5e-03 per=1.5e+01 cost=6.9e+04 flops=9.2e+06
 sigma[gemm] counter=39 i=6 t=7.5e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=39 i=7 t=7.5e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=39 total t=3.0e-02 per=6.0e+01 cost=3.5e+05 flops=1.2e+07
 sigma[red] counter=39 t=1.0e-02 per=2.1e+01 cost=8.0e+04 flops=7.7e+06
----- TIMING FOR sigma_tot : t_inter=3.5e-01 t_gemm=9.2e-01 t_reduction=4.3e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=39 t=3.5e-01 per=2.1e+01 cost=2.8e+07 flops=8.0e+07
 sigma_tot[gemm] counter=39 i=0 t=1.0e-04 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=8.5e-05 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=6.5e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=3 t=6.5e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=4 t=2.5e-01 per=1.5e+01 cost=5.0e+06 flops=2.0e+07
 sigma_tot[gemm] counter=39 i=5 t=2.5e-01 per=1.5e+01 cost=5.0e+06 flops=2.0e+07
 sigma_tot[gemm] counter=39 i=6 t=2.1e-01 per=1.2e+01 cost=6.1e+06 flops=2.9e+07
 sigma_tot[gemm] counter=39 i=7 t=2.1e-01 per=1.2e+01 cost=6.3e+06 flops=3.0e+07
 sigma_tot[gemm] counter=39 total t=9.2e-01 per=5.4e+01 cost=2.2e+07 flops=2.4e+07
 sigma_tot[red] counter=39 t=4.3e-01 per=2.5e+01 cost=5.3e+06 flops=1.2e+07
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.9e-05,3.9e-06,1.1e-05,2.2e-07
    2   0 -    -116.236358060038 -1.831e-02  2.245e-02    2     2  1.175e-01 5.874e-02 5.220e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.067e-03,9.999e-03,3.035e-02,1.031e-02,5.273e-02
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.061e-03 speed=4.483e-04GB/S T(nccl)=6.456e-06 speed=1.431e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=40 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=5.0e+07
 sigma[gemm] counter=40 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=3 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=4 t=7.6e-03 per=1.5e+01 cost=6.8e+04 flops=9.0e+06
 sigma[gemm] counter=40 i=5 t=7.6e-03 per=1.5e+01 cost=6.9e+04 flops=9.1e+06
 sigma[gemm] counter=40 i=6 t=7.6e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=40 i=7 t=7.6e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=40 total t=3.0e-02 per=6.0e+01 cost=3.5e+05 flops=1.2e+07
 sigma[red] counter=40 t=1.0e-02 per=2.0e+01 cost=8.0e+04 flops=7.8e+06
----- TIMING FOR sigma_tot : t_inter=3.6e-01 t_gemm=9.5e-01 t_reduction=4.4e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=40 t=3.6e-01 per=2.1e+01 cost=2.9e+07 flops=7.9e+07
 sigma_tot[gemm] counter=40 i=0 t=1.0e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=8.6e-05 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=6.6e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=3 t=6.6e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=4 t=2.6e-01 per=1.5e+01 cost=5.0e+06 flops=2.0e+07
 sigma_tot[gemm] counter=40 i=5 t=2.6e-01 per=1.5e+01 cost=5.1e+06 flops=2.0e+07
 sigma_tot[gemm] counter=40 i=6 t=2.2e-01 per=1.2e+01 cost=6.2e+06 flops=2.9e+07
 sigma_tot[gemm] counter=40 i=7 t=2.2e-01 per=1.2e+01 cost=6.5e+06 flops=3.0e+07
 sigma_tot[gemm] counter=40 total t=9.5e-01 per=5.4e+01 cost=2.3e+07 flops=2.4e+07
 sigma_tot[red] counter=40 t=4.4e-01 per=2.5e+01 cost=5.4e+06 flops=1.2e+07
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,2.0e-05,3.4e-06,1.3e-06,2.1e-07
    3   0 -    -116.237815456215 -1.457e-03  8.140e-03    3     3  1.874e-01 6.246e-02 5.242e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.817e-04,1.002e-02,3.013e-02,1.036e-02,5.092e-02
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=3.741e-04 speed=2.470e-03GB/S T(nccl)=7.636e-06 speed=1.210e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=41 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=5.0e+07
 sigma[gemm] counter=41 i=0 t=1.9e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=3 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=4 t=7.4e-03 per=1.5e+01 cost=6.8e+04 flops=9.1e+06
 sigma[gemm] counter=41 i=5 t=7.5e-03 per=1.5e+01 cost=6.9e+04 flops=9.2e+06
 sigma[gemm] counter=41 i=6 t=7.5e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=41 i=7 t=7.7e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=41 total t=3.0e-02 per=6.0e+01 cost=3.5e+05 flops=1.2e+07
 sigma[red] counter=41 t=1.0e-02 per=2.1e+01 cost=8.0e+04 flops=7.7e+06
----- TIMING FOR sigma_tot : t_inter=3.7e-01 t_gemm=9.8e-01 t_reduction=4.5e-01 tot=1.8e+00 -----
 sigma_tot[inter] counter=41 t=3.7e-01 per=2.1e+01 cost=2.9e+07 flops=7.9e+07
 sigma_tot[gemm] counter=41 i=0 t=1.0e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=8.8e-05 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=6.8e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=3 t=6.8e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=4 t=2.6e-01 per=1.5e+01 cost=5.1e+06 flops=1.9e+07
 sigma_tot[gemm] counter=41 i=5 t=2.6e-01 per=1.5e+01 cost=5.1e+06 flops=1.9e+07
 sigma_tot[gemm] counter=41 i=6 t=2.2e-01 per=1.2e+01 cost=6.3e+06 flops=2.8e+07
 sigma_tot[gemm] counter=41 i=7 t=2.2e-01 per=1.2e+01 cost=6.6e+06 flops=2.9e+07
 sigma_tot[gemm] counter=41 total t=9.8e-01 per=5.4e+01 cost=2.3e+07 flops=2.4e+07
 sigma_tot[red] counter=41 t=4.5e-01 per=2.5e+01 cost=5.4e+06 flops=1.2e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.6e-05,3.5e-06,1.3e-06,2.7e-07
    4   0 -    -116.238019717468 -2.043e-04  2.814e-03    3     4  2.509e-01 6.272e-02 5.207e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.488e-04,1.012e-02,3.040e-02,1.032e-02,5.140e-02
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=5.415e-04 speed=1.706e-03GB/S T(nccl)=7.332e-06 speed=1.260e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=42 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=4.9e+07
 sigma[gemm] counter=42 i=0 t=1.9e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=1.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=3 t=1.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=4 t=7.7e-03 per=1.5e+01 cost=6.8e+04 flops=8.8e+06
 sigma[gemm] counter=42 i=5 t=7.7e-03 per=1.5e+01 cost=6.9e+04 flops=9.0e+06
 sigma[gemm] counter=42 i=6 t=7.5e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=42 i=7 t=7.5e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=42 total t=3.0e-02 per=6.0e+01 cost=3.5e+05 flops=1.2e+07
 sigma[red] counter=42 t=1.0e-02 per=2.0e+01 cost=8.0e+04 flops=7.8e+06
----- TIMING FOR sigma_tot : t_inter=3.8e-01 t_gemm=1.0e+00 t_reduction=4.6e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=42 t=3.8e-01 per=2.1e+01 cost=3.0e+07 flops=7.8e+07
 sigma_tot[gemm] counter=42 i=0 t=1.1e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=9.0e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=6.9e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=3 t=6.9e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=4 t=2.7e-01 per=1.5e+01 cost=5.2e+06 flops=1.9e+07
 sigma_tot[gemm] counter=42 i=5 t=2.7e-01 per=1.5e+01 cost=5.2e+06 flops=1.9e+07
 sigma_tot[gemm] counter=42 i=6 t=2.3e-01 per=1.2e+01 cost=6.4e+06 flops=2.8e+07
 sigma_tot[gemm] counter=42 i=7 t=2.3e-01 per=1.3e+01 cost=6.7e+06 flops=2.9e+07
 sigma_tot[gemm] counter=42 total t=1.0e+00 per=5.4e+01 cost=2.3e+07 flops=2.3e+07
 sigma_tot[red] counter=42 t=4.6e-01 per=2.5e+01 cost=5.5e+06 flops=1.2e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.7e-05,3.4e-06,1.3e-06,2.5e-07
    5   0 -    -116.238042505393 -2.279e-05  7.202e-04    3     5  3.147e-01 6.295e-02 5.196e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.215e-04,2.666e-03,6.509e-03,1.037e-02,1.978e-02
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=2.146e-04 speed=4.304e-03GB/S T(nccl)=6.821e-06 speed=1.354e-01GB/S
----- TIMING FOR sigma : t_inter=2.7e-03 t_gemm=6.5e-03 t_reduction=1.0e-02 tot=2.0e-02 -----
 sigma[inter] counter=43 t=2.7e-03 per=1.4e+01 cost=5.0e+05 flops=1.9e+08
 sigma[gemm] counter=43 i=0 t=1.5e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=1.3e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=1.3e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=3 t=1.3e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=4 t=1.6e-03 per=8.0e+00 cost=6.8e+04 flops=4.3e+07
 sigma[gemm] counter=43 i=5 t=2.3e-03 per=1.2e+01 cost=6.9e+04 flops=3.0e+07
 sigma[gemm] counter=43 i=6 t=1.2e-03 per=6.0e+00 cost=1.1e+05 flops=9.2e+07
 sigma[gemm] counter=43 i=7 t=1.4e-03 per=7.4e+00 cost=1.1e+05 flops=7.5e+07
 sigma[gemm] counter=43 total t=6.5e-03 per=3.3e+01 cost=3.5e+05 flops=5.4e+07
 sigma[red] counter=43 t=1.0e-02 per=5.3e+01 cost=8.0e+04 flops=7.7e+06
----- TIMING FOR sigma_tot : t_inter=3.9e-01 t_gemm=1.0e+00 t_reduction=4.7e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=43 t=3.9e-01 per=2.1e+01 cost=3.0e+07 flops=7.9e+07
 sigma_tot[gemm] counter=43 i=0 t=1.1e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=9.1e-05 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=7.0e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=3 t=7.1e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=4 t=2.7e-01 per=1.5e+01 cost=5.2e+06 flops=1.9e+07
 sigma_tot[gemm] counter=43 i=5 t=2.7e-01 per=1.5e+01 cost=5.3e+06 flops=1.9e+07
 sigma_tot[gemm] counter=43 i=6 t=2.3e-01 per=1.2e+01 cost=6.5e+06 flops=2.8e+07
 sigma_tot[gemm] counter=43 i=7 t=2.3e-01 per=1.2e+01 cost=6.8e+06 flops=2.9e+07
 sigma_tot[gemm] counter=43 total t=1.0e+00 per=5.4e+01 cost=2.4e+07 flops=2.3e+07
 sigma_tot[red] counter=43 t=4.7e-01 per=2.5e+01 cost=5.6e+06 flops=1.2e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.7e-05,3.5e-06,1.2e-06,2.5e-07
    6   0 -    -116.238044081056 -1.576e-06  1.845e-04    3     6  3.503e-01 5.839e-02 4.662e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.605e-03,9.985e-03,2.981e-02,1.020e-02,5.160e-02
 analyze_tgpu[Hx]: ndim=62:4.619e-07GB T(cpu-gpu)=1.599e-03 speed=5.778e-04GB/S T(nccl)=6.390e-06 speed=1.446e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=44 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=5.0e+07
 sigma[gemm] counter=44 i=0 t=1.9e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=1.7e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=3 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=4 t=7.5e-03 per=1.5e+01 cost=6.8e+04 flops=9.1e+06
 sigma[gemm] counter=44 i=5 t=7.5e-03 per=1.5e+01 cost=6.9e+04 flops=9.2e+06
 sigma[gemm] counter=44 i=6 t=7.4e-03 per=1.5e+01 cost=1.1e+05 flops=1.5e+07
 sigma[gemm] counter=44 i=7 t=7.5e-03 per=1.5e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=44 total t=3.0e-02 per=6.0e+01 cost=3.5e+05 flops=1.2e+07
 sigma[red] counter=44 t=1.0e-02 per=2.0e+01 cost=8.0e+04 flops=7.9e+06
----- TIMING FOR sigma_tot : t_inter=4.0e-01 t_gemm=1.0e+00 t_reduction=4.8e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=44 t=4.0e-01 per=2.1e+01 cost=3.1e+07 flops=7.8e+07
 sigma_tot[gemm] counter=44 i=0 t=1.1e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=9.3e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=7.2e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=3 t=7.2e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=4 t=2.8e-01 per=1.5e+01 cost=5.3e+06 flops=1.9e+07
 sigma_tot[gemm] counter=44 i=5 t=2.8e-01 per=1.5e+01 cost=5.3e+06 flops=1.9e+07
 sigma_tot[gemm] counter=44 i=6 t=2.4e-01 per=1.2e+01 cost=6.6e+06 flops=2.8e+07
 sigma_tot[gemm] counter=44 i=7 t=2.4e-01 per=1.3e+01 cost=6.9e+06 flops=2.9e+07
 sigma_tot[gemm] counter=44 total t=1.0e+00 per=5.4e+01 cost=2.4e+07 flops=2.3e+07
 sigma_tot[red] counter=44 t=4.8e-01 per=2.5e+01 cost=5.7e+06 flops=1.2e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.6e-05,3.3e-06,1.2e-06,2.6e-07
    7   0 +    -116.238044195480 -1.144e-07  5.542e-05    3     7  4.112e-01 5.874e-02 4.734e-02
TIMING FOR Davidson : 4.112e-01  T(cal/comm/rest)=3.314e-01,1.152e-06,7.977e-02
decomposed t_rest=7.977e-02
 T(sub)    =1.857e-04 per=2.328e-01
 T(precond)=7.940e-02 per=9.953e+01
 T(ortho)  =4.473e-05 per=5.607e-02
 T(xcopy)  =9.280e-07 per=1.163e-03
 T(xnrm2)  =3.696e-06 per=4.633e-03
 T(other)  =1.402e-04 per=1.757e-01
optimized energies: isweep=0 ibond=6 dots=2 e[0]=-116.238044195480 nmvp=7
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=1.801e-03 change=2.728e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=11 dimAll=37
 (10,2):6 (12,2):4 (11,1):8 (11,3):6 (10,0):4 (12,0):3 (9,3):1 (10,4):2 (12,4):1 (11,5):1 (9,1):1
timing for divide=1.4e-04
timing for compute=1.4e-02
timing for collect=2.2e-05
----- TMING FOR decimation_genbasis(su2): 1.5e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-04,1.4e-02,0.0e+00,6.3e-06,2.2e-05 -----
decimation summary: 37->10 dwt=+2.363e-04 SvN=1.336e+00
 qbond: qkept nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
----- TIMING for decimation_row(nkr): 1.517e-02 S T(decim/select/formRot)=1.467e-02,3.969e-04,1.012e-04 -----
----- TIMING FOR twodot_decimation: 1.603e-02 S T(wf/decim)=8.428e-04,1.518e-02 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
        per(mem): H:0.879 C:3.02 S:4.52 A:0 B:91.6 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=1.755e-03 change=3.114e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=157 : 3.640e-03 S -----
rank=0 GPUmem(GB): used=9.382e-05 (oper)=5.005e-05
rank=0 GPUmem(GB): used=9.412e-05 (oper,site)=5.005e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=157
 no. of rintermediate operators=113
 no. of coefficients=2324:1.773e-02MB:1.732e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.452e-03 S -----
rank=0 GPUmem(GB): used=1.114e-04 (oper,site,rinter)=5.005e-05,2.980e-07,1.732e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.131e-02 S size(rtasks)=157 size(Rlst2)=25 T(Rmu/Rlist)=8.181e-04,2.049e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.163e-02 S size(rtasks)=157 size(Rlst)=1585 -----
rank=0 GPUmem(GB): used=1.114e-04 avail=6.174e+00 total=6.174e+00 batch[need]=5.786e-04 blksize=16 blksize0=16 batchsize=1585
rank=0 GPUmem(GB): used=6.901e-04 (oper,site,rinter,batch)=5.005e-05,2.980e-07,1.732e-05,5.786e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.210e-03,2.263e-02,1.000e-02
----- TIMING FOR renorm : t_inter=6.2e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=7 t=6.2e-03 per=1.6e+01 cost=1.8e+05 flops=2.8e+07
 renorm[gemm] counter=7 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=4 t=7.5e-03 per=1.9e+01 cost=1.2e+04 flops=1.6e+06
 renorm[gemm] counter=7 i=5 t=7.6e-03 per=2.0e+01 cost=3.7e+04 flops=4.9e+06
 renorm[gemm] counter=7 i=6 t=7.6e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=7 total t=2.3e-02 per=5.8e+01 cost=7.6e+04 flops=3.4e+06
 renorm[red] counter=7 t=1.0e-02 per=2.6e+01 cost=9.0e+03 flops=9.0e+05
----- TIMING FOR renorm_tot : t_inter=3.7e-02 t_gemm=1.6e-01 t_reduction=7.0e-02 tot=2.6e-01 -----
 renorm_tot[inter] counter=7 t=3.7e-02 per=1.4e+01 cost=5.5e+05 flops=1.5e+07
 renorm_tot[gemm] counter=7 i=0 t=1.1e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=9.8e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=9.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=3 t=9.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=4 t=5.1e-02 per=1.9e+01 cost=7.0e+04 flops=1.4e+06
 renorm_tot[gemm] counter=7 i=5 t=5.3e-02 per=2.0e+01 cost=1.5e+05 flops=2.8e+06
 renorm_tot[gemm] counter=7 i=6 t=5.3e-02 per=2.0e+01 cost=1.7e+05 flops=3.3e+06
 renorm_tot[gemm] counter=7 total t=1.6e-01 per=5.9e+01 cost=3.9e+05 flops=2.5e+06
 renorm_tot[red] counter=7 t=7.0e-02 per=2.7e+01 cost=7.0e+04 flops=9.9e+05
qops.to_cpu: size(tot)=3184:2.4e-02MB:2.4e-05GB T(to_cpu)=1.5e-04S speed=1.6e-01GB/S
check ||H-H.dagger||=3.127e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0835 S rank=0 -----
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=2.274e-03 change=6.287e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.716e-03 change=-2.312e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.716e-03 change=-3.830e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.635e+00 S #####
 T(local opt: fetch) = 1.856e-02 S  per = 1.13  per(accum) = 1.13
 T(local opt: hdiag) = 8.214e-01 S  per = 50.2  per(accum) = 51.4
 T(local opt: dvdsn) = 6.891e-01 S  per = 42.1  per(accum) = 93.5
 T(local opt: decim) = 1.605e-02 S  per = 0.982  per(accum) = 94.5
 T(local opt: guess) = 1.710e-03 S  per = 0.105  per(accum) = 94.6
 T(local opt: renrm) = 8.800e-02 S  per = 5.38  per(accum) = 100
 T(local opt: save ) = 3.787e-04 S  per = 0.0232  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.891e-01 S  T(sum) = 6.884e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 1.486e-02 S  per = 2.16  per(accum) = 2.16
 T(local opt: symbolic_formulae           ) = 1.668e-02 S  per = 2.42  per(accum) = 4.58
 T(local opt: hintermediate init          ) = 5.766e-04 S  per = 0.0838  per(accum) = 4.67
 T(local opt: preprocess_hformulae_Hxlist ) = 1.958e-01 S  per = 28.4  per(accum) = 33.1
 T(local opt: hmmtasks init               ) = 4.726e-02 S  per = 6.86  per(accum) = 40
 T(local opt: initial guess for dvdson    ) = 2.039e-03 S  per = 0.296  per(accum) = 40.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.235e-01 S  per =   47  per(accum) = 87.3
 T(local opt: dvdson [cpu-gpu]            ) = 7.898e-03 S  per = 1.15  per(accum) = 88.4
 T(local opt: dvdson [nccl]               ) = 5.071e-05 S  per = 0.00737  per(accum) = 88.4
 T(local opt: dvdson [mpi]                ) = 1.152e-06 S  per = 0.000167  per(accum) = 88.4
 T(local opt: dvdson [rest part(linalg)]  ) = 7.977e-02 S  per = 11.6  per(accum) = 100
Detailed decomposition of T(renrm) = 8.800e-02 S  T(sum) = 8.800e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.278e-04 S  per = 0.373  per(accum) = 0.373
 T(local opt: qops init                    ) = 5.248e-03 S  per = 5.96  per(accum) = 6.34
 T(local opt: symbolic_formulae_renorm     ) = 3.653e-03 S  per = 4.15  per(accum) = 10.5
 T(local opt: allocate qops on gpu         ) = 5.839e-05 S  per = 0.0664  per(accum) = 10.6
 T(local opt: site memcpy cpu2gpu          ) = 1.825e-03 S  per = 2.07  per(accum) = 12.6
 T(local opt: rintermediate init           ) = 2.463e-03 S  per =  2.8  per(accum) = 15.4
 T(local opt: preprocess_formulae_Rlist2   ) = 2.169e-02 S  per = 24.6  per(accum) = 40.1
 T(local opt: rmmtasks init                ) = 9.326e-03 S  per = 10.6  per(accum) = 50.7
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 3.52e-05  per(accum) = 50.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.893e-02 S  per = 44.2  per(accum) = 94.9
 T(local opt: deallocate cpu and gpu memory) = 9.932e-05 S  per = 0.113  per(accum) = 95
 T(local opt: construct opS [ifdists=true] ) = 4.000e-08 S  per = 4.55e-05  per(accum) = 95
 T(local opt: reduction of opS & opH [nccl]) = 4.200e-08 S  per = 4.77e-05  per(accum) = 95
 T(local opt: qops memcpy gpu2cpu          ) = 1.597e-04 S  per = 0.181  per(accum) = 95.2
 T(local opt: reduction of opS & opH [mpi] ) = 5.502e-05 S  per = 0.0625  per(accum) = 95.3
 T(local opt: qops_pool join and erase     ) = 4.162e-03 S  per = 4.73  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.170e-06 S  per = 0.00815  per(accum) = 100
##### sweep opt: 7.715e+00 S #####
 T(sweep opt: fetch) = 1.412e-01 S  per = 1.83  per(accum) = 1.83
 T(sweep opt: hdiag) = 2.598e+00 S  per = 33.7  per(accum) = 35.5
 T(sweep opt: dvdsn) = 4.349e+00 S  per = 56.4  per(accum) = 91.9
 T(sweep opt: decim) = 1.034e-01 S  per = 1.34  per(accum) = 93.2
 T(sweep opt: guess) = 1.054e-02 S  per = 0.137  per(accum) = 93.4
 T(sweep opt: renrm) = 5.101e-01 S  per = 6.61  per(accum) = 100
 T(sweep opt: save ) = 2.362e-03 S  per = 0.0306  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.349e+00 S  T(sum) = 4.343e+00 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 5.167e-02 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: symbolic_formulae           ) = 4.542e-02 S  per = 1.05  per(accum) = 2.24
 T(sweep opt: hintermediate init          ) = 1.763e-03 S  per = 0.0406  per(accum) = 2.28
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.327e+00 S  per = 30.6  per(accum) = 32.8
 T(sweep opt: hmmtasks init               ) = 4.495e-01 S  per = 10.3  per(accum) = 43.2
 T(sweep opt: initial guess for dvdson    ) = 1.169e-02 S  per = 0.269  per(accum) = 43.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.926e+00 S  per = 44.3  per(accum) = 87.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.260e-02 S  per = 1.21  per(accum) = 89
 T(sweep opt: dvdson [nccl]               ) = 2.937e-04 S  per = 0.00676  per(accum) = 89
 T(sweep opt: dvdson [mpi]                ) = 7.488e-06 S  per = 0.000172  per(accum) = 89
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.768e-01 S  per =   11  per(accum) = 100
Detailed decomposition of T(renrm) = 5.101e-01 S  T(sum) = 5.101e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.626e-03 S  per = 0.319  per(accum) = 0.319
 T(sweep opt: qops init                    ) = 1.907e-02 S  per = 3.74  per(accum) = 4.06
 T(sweep opt: symbolic_formulae_renorm     ) = 1.845e-02 S  per = 3.62  per(accum) = 7.67
 T(sweep opt: allocate qops on gpu         ) = 4.284e-04 S  per = 0.084  per(accum) = 7.76
 T(sweep opt: site memcpy cpu2gpu          ) = 7.869e-03 S  per = 1.54  per(accum) = 9.3
 T(sweep opt: rintermediate init           ) = 1.826e-02 S  per = 3.58  per(accum) = 12.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.053e-01 S  per = 20.6  per(accum) = 33.5
 T(sweep opt: rmmtasks init                ) = 5.075e-02 S  per = 9.95  per(accum) = 43.5
 T(sweep opt: qops memset on cpu           ) = 3.080e-07 S  per = 6.04e-05  per(accum) = 43.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.645e-01 S  per = 51.8  per(accum) = 95.3
 T(sweep opt: deallocate cpu and gpu memory) = 4.687e-04 S  per = 0.0919  per(accum) = 95.4
 T(sweep opt: construct opS [ifdists=true] ) = 4.000e-07 S  per = 7.84e-05  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [nccl]) = 3.060e-07 S  per = 6e-05  per(accum) = 95.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.878e-04 S  per = 0.154  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.320e-04 S  per = 0.0651  per(accum) = 95.6
 T(sweep opt: qops_pool join and erase     ) = 2.227e-02 S  per = 4.37  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 4.419e-05 S  per = 0.00866  per(accum) = 100
##### global opt: 7.715e+00 S #####
 T(global opt: fetch) = 1.412e-01 S  per = 1.83  per(accum) = 1.83
 T(global opt: hdiag) = 2.598e+00 S  per = 33.7  per(accum) = 35.5
 T(global opt: dvdsn) = 4.349e+00 S  per = 56.4  per(accum) = 91.9
 T(global opt: decim) = 1.034e-01 S  per = 1.34  per(accum) = 93.2
 T(global opt: guess) = 1.054e-02 S  per = 0.137  per(accum) = 93.4
 T(global opt: renrm) = 5.101e-01 S  per = 6.61  per(accum) = 100
 T(global opt: save ) = 2.362e-03 S  per = 0.0306  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.349e+00 S  T(sum) = 4.343e+00 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 5.167e-02 S  per = 1.19  per(accum) = 1.19
 T(global opt: symbolic_formulae           ) = 4.542e-02 S  per = 1.05  per(accum) = 2.24
 T(global opt: hintermediate init          ) = 1.763e-03 S  per = 0.0406  per(accum) = 2.28
 T(global opt: preprocess_hformulae_Hxlist ) = 1.327e+00 S  per = 30.6  per(accum) = 32.8
 T(global opt: hmmtasks init               ) = 4.495e-01 S  per = 10.3  per(accum) = 43.2
 T(global opt: initial guess for dvdson    ) = 1.169e-02 S  per = 0.269  per(accum) = 43.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.926e+00 S  per = 44.3  per(accum) = 87.8
 T(global opt: dvdson [cpu-gpu]            ) = 5.260e-02 S  per = 1.21  per(accum) = 89
 T(global opt: dvdson [nccl]               ) = 2.937e-04 S  per = 0.00676  per(accum) = 89
 T(global opt: dvdson [mpi]                ) = 7.488e-06 S  per = 0.000172  per(accum) = 89
 T(global opt: dvdson [rest part(linalg)]  ) = 4.768e-01 S  per =   11  per(accum) = 100
Detailed decomposition of T(renrm) = 5.101e-01 S  T(sum) = 5.101e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.626e-03 S  per = 0.319  per(accum) = 0.319
 T(global opt: qops init                    ) = 1.907e-02 S  per = 3.74  per(accum) = 4.06
 T(global opt: symbolic_formulae_renorm     ) = 1.845e-02 S  per = 3.62  per(accum) = 7.67
 T(global opt: allocate qops on gpu         ) = 4.284e-04 S  per = 0.084  per(accum) = 7.76
 T(global opt: site memcpy cpu2gpu          ) = 7.869e-03 S  per = 1.54  per(accum) = 9.3
 T(global opt: rintermediate init           ) = 1.826e-02 S  per = 3.58  per(accum) = 12.9
 T(global opt: preprocess_formulae_Rlist2   ) = 1.053e-01 S  per = 20.6  per(accum) = 33.5
 T(global opt: rmmtasks init                ) = 5.075e-02 S  per = 9.95  per(accum) = 43.5
 T(global opt: qops memset on cpu           ) = 3.080e-07 S  per = 6.04e-05  per(accum) = 43.5
 T(global opt: preprocess_renorm_batchGPU   ) = 2.645e-01 S  per = 51.8  per(accum) = 95.3
 T(global opt: deallocate cpu and gpu memory) = 4.687e-04 S  per = 0.0919  per(accum) = 95.4
 T(global opt: construct opS [ifdists=true] ) = 4.000e-07 S  per = 7.84e-05  per(accum) = 95.4
 T(global opt: reduction of opS & opH [nccl]) = 3.060e-07 S  per = 6e-05  per(accum) = 95.4
 T(global opt: qops memcpy gpu2cpu          ) = 7.878e-04 S  per = 0.154  per(accum) = 95.6
 T(global opt: reduction of opS & opH [mpi] ) = 3.320e-04 S  per = 0.0651  per(accum) = 95.6
 T(global opt: qops_pool join and erase     ) = 2.227e-02 S  per = 4.37  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 4.419e-05 S  per = 0.00866  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.698e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=7/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=704:5.371e-03MB:5.245e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=754:5.753e-03MB:5.618e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
        per(mem): H:0.879 C:3.02 S:4.52 A:0 B:91.6 
 rqops: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=13560:0.103MB:0.000101GB
        per(mem): H:0.516 C:1.47 S:1.47 P:0 Q:96.5 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=18740:0.143MB:0.00014GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.366e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.064e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,16,3,3) nnz=168:1.282e-03MB
qtensor4: wf4 own=1 _data=0x41c60580
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
 qbond: qcol nsym=5 dimAll=16
 (15,1):4 (15,3):6 (15,5):4 (16,2):1 (16,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=380 size=168:1.282e-03MB
### DIAG TIMING: total=1.032e+00 t1=3.531e-05, t2=8.003e-04, t3=2.481e-03, t4=1.029e+00, t5=5.539e-06, t6=1.786e-05, t7=5.028e-06
duration_diagGPU:1.032e+00
duration_diagreduce:6.400e-08
duration_diagtransform:8.720e-07
----- TIMING FOR symbolic_formulae_twodot with size=831 : 1.130e-02 S -----
rank=0 GPUmem(GB): used=1.396e-04 (oper)=1.396e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=831
 no. of hintermediate operators=386
 no. of coefficients=5612:4.282e-02MB:4.181e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.043e-04 S -----
rank=0 GPUmem(GB): used=1.814e-04 (oper,hinter)=1.396e-04,4.181e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.993e-01 S size(H_formulae)=831 size(Hxlst2)=29 T(Hmu/Hxlist)=2.258e-03,4.970e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.035e-01 S size(H_formulae)=831 size(Hxlst)=29620 -----
rank=0 GPUmem(GB): used=1.814e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=2.503e-06 batch[need]=1.434e-02 blksize=24 blksize0=16 batchsize=29620
rank=0 GPUmem(GB): used=1.453e-02 (oper,hinter,dvdson,batch)=1.396e-04,4.181e-05,2.503e-06,1.434e-02
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=168 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.079e-03,5.045e-03,1.019e-02,1.077e-02,2.810e-02
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.069e-03 speed=1.210e-03GB/S T(nccl)=9.670e-06 speed=2.589e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=45 t=5.0e-03 per=1.9e+01 cost=2.1e+06 flops=4.1e+08
 sigma[gemm] counter=45 i=0 t=1.4e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=1.2e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=1.4e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=3 t=1.1e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=4 t=2.5e-03 per=9.7e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=45 i=5 t=2.6e-03 per=9.8e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=45 i=6 t=2.5e-03 per=9.8e+00 cost=4.5e+05 flops=1.8e+08
 sigma[gemm] counter=45 i=7 t=2.5e-03 per=9.8e+00 cost=4.6e+05 flops=1.8e+08
 sigma[gemm] counter=45 total t=1.0e-02 per=3.9e+01 cost=1.7e+06 flops=1.7e+08
 sigma[red] counter=45 t=1.1e-02 per=4.1e+01 cost=3.7e+05 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=4.0e-01 t_gemm=1.1e+00 t_reduction=4.9e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=45 t=4.0e-01 per=2.1e+01 cost=3.3e+07 flops=8.2e+07
 sigma_tot[gemm] counter=45 i=0 t=1.1e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=9.4e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=7.4e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=3 t=7.3e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=4 t=2.8e-01 per=1.5e+01 cost=5.7e+06 flops=2.0e+07
 sigma_tot[gemm] counter=45 i=5 t=2.8e-01 per=1.5e+01 cost=5.7e+06 flops=2.0e+07
 sigma_tot[gemm] counter=45 i=6 t=2.4e-01 per=1.2e+01 cost=7.0e+06 flops=2.9e+07
 sigma_tot[gemm] counter=45 i=7 t=2.4e-01 per=1.3e+01 cost=7.4e+06 flops=3.0e+07
 sigma_tot[gemm] counter=45 total t=1.1e+00 per=5.4e+01 cost=2.6e+07 flops=2.5e+07
 sigma_tot[red] counter=45 t=4.9e-01 per=2.5e+01 cost=6.1e+06 flops=1.2e+07
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,7.1e-06,2.3e-06,1.4e-06,2.1e-07
settings: ndim=168 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.237931699329 -1.116e+03  5.705e-02    1     1  2.825e-02 2.825e-02 2.821e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.704e-03,5.069e-03,1.026e-02,1.072e-02,2.777e-02
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=1.697e-03 speed=1.475e-03GB/S T(nccl)=7.251e-06 speed=3.452e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=46 t=5.1e-03 per=1.9e+01 cost=2.1e+06 flops=4.1e+08
 sigma[gemm] counter=46 i=0 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=1.3e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=3 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=4 t=2.5e-03 per=9.8e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=46 i=5 t=2.6e-03 per=9.8e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=46 i=6 t=2.6e-03 per=9.8e+00 cost=4.5e+05 flops=1.8e+08
 sigma[gemm] counter=46 i=7 t=2.6e-03 per=1.0e+01 cost=4.6e+05 flops=1.8e+08
 sigma[gemm] counter=46 total t=1.0e-02 per=3.9e+01 cost=1.7e+06 flops=1.7e+08
 sigma[red] counter=46 t=1.1e-02 per=4.1e+01 cost=3.7e+05 flops=3.5e+07
----- TIMING FOR sigma_tot : t_inter=4.1e-01 t_gemm=1.1e+00 t_reduction=5.0e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=46 t=4.1e-01 per=2.1e+01 cost=3.5e+07 flops=8.6e+07
 sigma_tot[gemm] counter=46 i=0 t=1.1e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=9.5e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=7.5e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=3 t=7.5e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=4 t=2.9e-01 per=1.4e+01 cost=6.1e+06 flops=2.1e+07
 sigma_tot[gemm] counter=46 i=5 t=2.9e-01 per=1.5e+01 cost=6.2e+06 flops=2.1e+07
 sigma_tot[gemm] counter=46 i=6 t=2.4e-01 per=1.2e+01 cost=7.5e+06 flops=3.1e+07
 sigma_tot[gemm] counter=46 i=7 t=2.5e-01 per=1.2e+01 cost=7.8e+06 flops=3.2e+07
 sigma_tot[gemm] counter=46 total t=1.1e+00 per=5.4e+01 cost=2.8e+07 flops=2.6e+07
 sigma_tot[red] counter=46 t=5.0e-01 per=2.6e+01 cost=6.4e+06 flops=1.3e+07
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=6.8e-06,2.3e-05,4.0e-06,1.6e-06,2.3e-07
    2   0 -    -116.247601693789 -9.670e-03  2.179e-02    2     2  6.943e-02 3.472e-02 2.805e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.318e-03,5.001e-03,1.016e-02,1.080e-02,2.829e-02
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.312e-03 speed=1.083e-03GB/S T(nccl)=5.700e-06 speed=4.392e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=47 t=5.0e-03 per=1.9e+01 cost=2.1e+06 flops=4.1e+08
 sigma[gemm] counter=47 i=0 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=1.3e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=3 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=4 t=2.5e-03 per=9.7e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=47 i=5 t=2.5e-03 per=9.8e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=47 i=6 t=2.5e-03 per=9.8e+00 cost=4.5e+05 flops=1.8e+08
 sigma[gemm] counter=47 i=7 t=2.6e-03 per=9.8e+00 cost=4.6e+05 flops=1.8e+08
 sigma[gemm] counter=47 total t=1.0e-02 per=3.9e+01 cost=1.7e+06 flops=1.7e+08
 sigma[red] counter=47 t=1.1e-02 per=4.2e+01 cost=3.7e+05 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=4.1e-01 t_gemm=1.1e+00 t_reduction=5.1e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=47 t=4.1e-01 per=2.1e+01 cost=3.7e+07 flops=9.0e+07
 sigma_tot[gemm] counter=47 i=0 t=1.1e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=9.6e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=7.6e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=3 t=7.6e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=4 t=2.9e-01 per=1.4e+01 cost=6.5e+06 flops=2.3e+07
 sigma_tot[gemm] counter=47 i=5 t=2.9e-01 per=1.4e+01 cost=6.6e+06 flops=2.3e+07
 sigma_tot[gemm] counter=47 i=6 t=2.5e-01 per=1.2e+01 cost=7.9e+06 flops=3.2e+07
 sigma_tot[gemm] counter=47 i=7 t=2.5e-01 per=1.2e+01 cost=8.3e+06 flops=3.3e+07
 sigma_tot[gemm] counter=47 total t=1.1e+00 per=5.4e+01 cost=2.9e+07 flops=2.7e+07
 sigma_tot[red] counter=47 t=5.1e-01 per=2.6e+01 cost=6.8e+06 flops=1.3e+07
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,2.3e-05,3.2e-06,1.7e-06,2.0e-07
    3   0 -    -116.248767971210 -1.166e-03  8.644e-03    3     3  1.146e-01 3.821e-02 2.817e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.208e-03,5.083e-03,1.032e-02,1.084e-02,2.846e-02
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=2.200e-03 speed=1.138e-03GB/S T(nccl)=7.137e-06 speed=3.508e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=48 t=5.1e-03 per=1.9e+01 cost=2.1e+06 flops=4.0e+08
 sigma[gemm] counter=48 i=0 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=1.2e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=3 t=1.3e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=4 t=2.6e-03 per=9.7e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=48 i=5 t=2.6e-03 per=9.8e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=48 i=6 t=2.6e-03 per=9.9e+00 cost=4.5e+05 flops=1.7e+08
 sigma[gemm] counter=48 i=7 t=2.6e-03 per=9.9e+00 cost=4.6e+05 flops=1.8e+08
 sigma[gemm] counter=48 total t=1.0e-02 per=3.9e+01 cost=1.7e+06 flops=1.7e+08
 sigma[red] counter=48 t=1.1e-02 per=4.1e+01 cost=3.7e+05 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=4.2e-01 t_gemm=1.1e+00 t_reduction=5.3e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=48 t=4.2e-01 per=2.1e+01 cost=3.9e+07 flops=9.4e+07
 sigma_tot[gemm] counter=48 i=0 t=1.2e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=9.8e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=7.7e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=3 t=7.7e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=4 t=2.9e-01 per=1.4e+01 cost=6.9e+06 flops=2.4e+07
 sigma_tot[gemm] counter=48 i=5 t=2.9e-01 per=1.4e+01 cost=7.0e+06 flops=2.4e+07
 sigma_tot[gemm] counter=48 i=6 t=2.5e-01 per=1.2e+01 cost=8.4e+06 flops=3.4e+07
 sigma_tot[gemm] counter=48 i=7 t=2.5e-01 per=1.2e+01 cost=8.7e+06 flops=3.5e+07
 sigma_tot[gemm] counter=48 total t=1.1e+00 per=5.4e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[red] counter=48 t=5.3e-01 per=2.6e+01 cost=7.2e+06 flops=1.4e+07
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.0e-06,1.7e-05,3.6e-06,1.8e-06,2.8e-07
    4   0 -    -116.248968824981 -2.009e-04  3.032e-03    3     4  1.539e-01 3.847e-02 2.827e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.787e-03,5.077e-03,1.017e-02,1.076e-02,2.781e-02
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=1.780e-03 speed=1.407e-03GB/S T(nccl)=7.317e-06 speed=3.421e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=49 t=5.1e-03 per=2.0e+01 cost=2.1e+06 flops=4.0e+08
 sigma[gemm] counter=49 i=0 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=1.2e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=3 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=4 t=2.5e-03 per=9.7e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=49 i=5 t=2.6e-03 per=9.8e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=49 i=6 t=2.5e-03 per=9.7e+00 cost=4.5e+05 flops=1.8e+08
 sigma[gemm] counter=49 i=7 t=2.5e-03 per=9.7e+00 cost=4.6e+05 flops=1.8e+08
 sigma[gemm] counter=49 total t=1.0e-02 per=3.9e+01 cost=1.7e+06 flops=1.7e+08
 sigma[red] counter=49 t=1.1e-02 per=4.1e+01 cost=3.7e+05 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=4.2e-01 t_gemm=1.1e+00 t_reduction=5.4e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=49 t=4.2e-01 per=2.1e+01 cost=4.1e+07 flops=9.8e+07
 sigma_tot[gemm] counter=49 i=0 t=1.2e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=9.9e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=7.9e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=3 t=7.8e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=4 t=2.9e-01 per=1.4e+01 cost=7.3e+06 flops=2.5e+07
 sigma_tot[gemm] counter=49 i=5 t=2.9e-01 per=1.4e+01 cost=7.4e+06 flops=2.5e+07
 sigma_tot[gemm] counter=49 i=6 t=2.5e-01 per=1.2e+01 cost=8.8e+06 flops=3.5e+07
 sigma_tot[gemm] counter=49 i=7 t=2.5e-01 per=1.2e+01 cost=9.2e+06 flops=3.6e+07
 sigma_tot[gemm] counter=49 total t=1.1e+00 per=5.3e+01 cost=3.3e+07 flops=3.0e+07
 sigma_tot[red] counter=49 t=5.4e-01 per=2.6e+01 cost=7.5e+06 flops=1.4e+07
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.7e-05,3.6e-06,1.7e-06,2.7e-07
    5   0 -    -116.248992623280 -2.380e-05  9.245e-04    3     5  1.908e-01 3.816e-02 2.820e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.884e-04,5.131e-03,4.356e-03,2.568e-03,1.305e-02
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=9.807e-04 speed=2.553e-03GB/S T(nccl)=7.698e-06 speed=3.252e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=4.4e-03 t_reduction=2.6e-03 tot=1.2e-02 -----
 sigma[inter] counter=50 t=5.1e-03 per=4.3e+01 cost=2.1e+06 flops=4.0e+08
 sigma[gemm] counter=50 i=0 t=1.9e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=1.7e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=1.7e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=3 t=1.7e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=4 t=2.2e-03 per=1.8e+01 cost=4.1e+05 flops=1.9e+08
 sigma[gemm] counter=50 i=5 t=6.8e-04 per=5.6e+00 cost=4.1e+05 flops=6.0e+08
 sigma[gemm] counter=50 i=6 t=7.3e-04 per=6.0e+00 cost=4.5e+05 flops=6.2e+08
 sigma[gemm] counter=50 i=7 t=7.3e-04 per=6.0e+00 cost=4.6e+05 flops=6.3e+08
 sigma[gemm] counter=50 total t=4.4e-03 per=3.6e+01 cost=1.7e+06 flops=4.0e+08
 sigma[red] counter=50 t=2.6e-03 per=2.1e+01 cost=3.7e+05 flops=1.4e+08
----- TIMING FOR sigma_tot : t_inter=4.3e-01 t_gemm=1.1e+00 t_reduction=5.4e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=50 t=4.3e-01 per=2.1e+01 cost=4.3e+07 flops=1.0e+08
 sigma_tot[gemm] counter=50 i=0 t=1.2e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=1.0e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=8.0e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=3 t=8.0e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=4 t=3.0e-01 per=1.4e+01 cost=7.8e+06 flops=2.6e+07
 sigma_tot[gemm] counter=50 i=5 t=3.0e-01 per=1.4e+01 cost=7.8e+06 flops=2.6e+07
 sigma_tot[gemm] counter=50 i=6 t=2.5e-01 per=1.2e+01 cost=9.3e+06 flops=3.7e+07
 sigma_tot[gemm] counter=50 i=7 t=2.5e-01 per=1.2e+01 cost=9.7e+06 flops=3.8e+07
 sigma_tot[gemm] counter=50 total t=1.1e+00 per=5.3e+01 cost=3.4e+07 flops=3.1e+07
 sigma_tot[red] counter=50 t=5.4e-01 per=2.6e+01 cost=7.9e+06 flops=1.5e+07
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,1.8e-05,3.6e-06,1.8e-06,2.8e-07
    6   0 -    -116.248994383554 -1.760e-06  1.963e-04    3     6  2.117e-01 3.528e-02 2.570e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.523e-04,5.104e-03,1.014e-02,1.068e-02,2.690e-02
 analyze_tgpu[Hx]: ndim=168:1.252e-06GB T(cpu-gpu)=9.449e-04 speed=2.649e-03GB/S T(nccl)=7.349e-06 speed=3.406e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=51 t=5.1e-03 per=2.0e+01 cost=2.1e+06 flops=4.0e+08
 sigma[gemm] counter=51 i=0 t=1.9e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=1.7e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=1.7e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=3 t=1.7e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=4 t=2.5e-03 per=9.7e+00 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=51 i=5 t=2.6e-03 per=1.0e+01 cost=4.1e+05 flops=1.6e+08
 sigma[gemm] counter=51 i=6 t=2.5e-03 per=9.7e+00 cost=4.5e+05 flops=1.8e+08
 sigma[gemm] counter=51 i=7 t=2.5e-03 per=9.7e+00 cost=4.6e+05 flops=1.8e+08
 sigma[gemm] counter=51 total t=1.0e-02 per=3.9e+01 cost=1.7e+06 flops=1.7e+08
 sigma[red] counter=51 t=1.1e-02 per=4.1e+01 cost=3.7e+05 flops=3.5e+07
----- TIMING FOR sigma_tot : t_inter=4.3e-01 t_gemm=1.1e+00 t_reduction=5.5e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=51 t=4.3e-01 per=2.1e+01 cost=4.5e+07 flops=1.0e+08
 sigma_tot[gemm] counter=51 i=0 t=1.2e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=1.0e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=8.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=3 t=8.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=4 t=3.0e-01 per=1.4e+01 cost=8.2e+06 flops=2.7e+07
 sigma_tot[gemm] counter=51 i=5 t=3.0e-01 per=1.4e+01 cost=8.2e+06 flops=2.7e+07
 sigma_tot[gemm] counter=51 i=6 t=2.5e-01 per=1.2e+01 cost=9.7e+06 flops=3.8e+07
 sigma_tot[gemm] counter=51 i=7 t=2.6e-01 per=1.2e+01 cost=1.0e+07 flops=3.9e+07
 sigma_tot[gemm] counter=51 total t=1.1e+00 per=5.3e+01 cost=3.6e+07 flops=3.3e+07
 sigma_tot[red] counter=51 t=5.5e-01 per=2.6e+01 cost=8.3e+06 flops=1.5e+07
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,1.8e-05,3.6e-06,1.7e-06,2.7e-07
    7   0 +    -116.248994471347 -8.779e-08  5.467e-05    3     7  2.458e-01 3.511e-02 2.589e-02
TIMING FOR Davidson : 2.458e-01  T(cal/comm/rest)=1.812e-01,1.068e-06,6.459e-02
decomposed t_rest=6.459e-02
 T(sub)    =2.011e-04 per=3.113e-01
 T(precond)=6.417e-02 per=9.935e+01
 T(ortho)  =5.889e-05 per=9.118e-02
 T(xcopy)  =1.116e-06 per=1.728e-03
 T(xnrm2)  =3.990e-06 per=6.177e-03
 T(other)  =1.529e-04 per=2.367e-01
optimized energies: isweep=0 ibond=7 dots=2 e[0]=-116.248994471347 nmvp=7
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.161e-02 change=7.402e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=11 dimAll=37
 (12,2):6 (14,2):4 (13,1):8 (13,3):6 (12,0):4 (14,0):3 (11,1):1 (11,3):1 (12,4):2 (14,4):1 (13,5):1
timing for divide=1.2e-04
timing for compute=6.3e-03
timing for collect=4.2e-05
----- TMING FOR decimation_genbasis(su2): 6.4e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.2e-04,6.3e-03,0.0e+00,6.5e-06,4.2e-05 -----
decimation summary: 37->10 dwt=+5.960e-04 SvN=1.233e+00
 qbond: qkept nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
----- TIMING for decimation_row(nkr): 7.046e-03 S T(decim/select/formRot)=6.505e-03,4.294e-04,1.110e-04 -----
----- TIMING FOR twodot_decimation: 7.824e-03 S T(wf/decim)=7.607e-04,7.063e-03 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:9 S:11 A:81 B:90 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3913:2.985e-02MB:2.915e-05GB
        per(mem): H:0.716 C:2.76 S:3.37 A:0 B:93.2 
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.150e-02 change=3.787e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=192 : 4.929e-03 S -----
rank=0 GPUmem(GB): used=1.096e-04 (oper)=6.031e-05
rank=0 GPUmem(GB): used=1.099e-04 (oper,site)=6.031e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=192
 no. of rintermediate operators=104
 no. of coefficients=2732:2.084e-02MB:2.035e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.502e-03 S -----
rank=0 GPUmem(GB): used=1.302e-04 (oper,site,rinter)=6.031e-05,2.980e-07,2.035e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.949e-02 S size(rtasks)=192 size(Rlst2)=25 T(Rmu/Rlist)=1.140e-03,2.835e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.974e-02 S size(rtasks)=192 size(Rlst)=1829 -----
rank=0 GPUmem(GB): used=1.302e-04 avail=6.174e+00 total=6.174e+00 batch[need]=6.677e-04 blksize=16 blksize0=16 batchsize=1829
rank=0 GPUmem(GB): used=7.979e-04 (oper,site,rinter,batch)=6.031e-05,2.980e-07,2.035e-05,6.677e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.836e-03,2.248e-02,9.971e-03
----- TIMING FOR renorm : t_inter=6.8e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=8 t=6.8e-03 per=1.7e+01 cost=2.1e+05 flops=3.1e+07
 renorm[gemm] counter=8 i=0 t=1.7e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=3 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=4 t=7.5e-03 per=1.9e+01 cost=1.1e+04 flops=1.4e+06
 renorm[gemm] counter=8 i=5 t=7.5e-03 per=1.9e+01 cost=4.3e+04 flops=5.7e+06
 renorm[gemm] counter=8 i=6 t=7.5e-03 per=1.9e+01 cost=3.3e+04 flops=4.4e+06
 renorm[gemm] counter=8 total t=2.2e-02 per=5.7e+01 cost=8.7e+04 flops=3.9e+06
 renorm[red] counter=8 t=1.0e-02 per=2.5e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=4.4e-02 t_gemm=1.8e-01 t_reduction=8.0e-02 tot=3.0e-01 -----
 renorm_tot[inter] counter=8 t=4.4e-02 per=1.4e+01 cost=7.6e+05 flops=1.8e+07
 renorm_tot[gemm] counter=8 i=0 t=1.3e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=1.1e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=1.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=3 t=1.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=4 t=5.9e-02 per=1.9e+01 cost=8.1e+04 flops=1.4e+06
 renorm_tot[gemm] counter=8 i=5 t=6.0e-02 per=2.0e+01 cost=1.9e+05 flops=3.2e+06
 renorm_tot[gemm] counter=8 i=6 t=6.0e-02 per=2.0e+01 cost=2.1e+05 flops=3.4e+06
 renorm_tot[gemm] counter=8 total t=1.8e-01 per=5.9e+01 cost=4.8e+05 flops=2.7e+06
 renorm_tot[red] counter=8 t=8.0e-02 per=2.6e+01 cost=8.0e+04 flops=1.0e+06
----- TIMING FOR oper_renorm : 9.9e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.234e-02 change=6.880e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.427e-02 change=-2.268e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(8,0) superblock=lc alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:9 S:11 P:121 Q:132 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=5614:4.283e-02MB:4.183e-05GB
        per(mem): H:0.499 C:1.92 S:2.35 P:0 Q:95.2 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.427e-02 change=5.503e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.427e-02 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.202e-04 avail=6.174e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=0 ifkr=1 maxsize=3645:2.716e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:90 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3645:2.781e-02MB:2.716e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.0025 tinit=0.0025
   copy opB to qops_tmps: dt=0.00151 tcopy=0.00151
   bcast: size(opB)=3645:2.72e-05GB dt=3.3e-08 speed=823GB/s tcomm=3.3e-08
   compute opQ from opB: dt=0.00498 tcomp=0.00498
iproc=0
 qops_tmp: oplist=N nops=N:90 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=3645:0.0278MB:2.72e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.00229 tinit=0.00479
   from opB to opB.H(): dt=0.00701 tadjt=0.00701
   bcast: size(opN)=3645:2.72e-05GB dt=4e-08 speed=679GB/s tcomm=7.3e-08
   compute opQ from opB.H(): dt=0.00465 tcomp=0.00963
----- TIMING FOR oper_b2qGPU : 0.0235 S T(init/copy/adjt+bcast/comp/rest)=0.00479,0.00151,0.00701,0.00963,0.000602 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.427e-02 change=1.088e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.202e-04 avail=6.174e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.427e-02 change=4.578e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.202e-04 avail=6.174e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.427e-02 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=1.202e-04 avail=6.174e+00 before move
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.427e-02 change=-3.872e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=9.108e-05 avail=6.174e+00 after move
check ||H-H.dagger||=4.295e-15 coord=(8,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0323 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00743,2.41e-05,5.55e-06,0.0236,0,0.000455,0.00073 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.427e-02 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.427e-02 change=-3.830e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.170e+00 S #####
 T(local opt: fetch) = 1.473e-02 S  per = 0.679  per(accum) = 0.679
 T(local opt: hdiag) = 1.033e+00 S  per = 47.6  per(accum) = 48.3
 T(local opt: dvdsn) = 9.769e-01 S  per =   45  per(accum) = 93.3
 T(local opt: decim) = 7.852e-03 S  per = 0.362  per(accum) = 93.7
 T(local opt: guess) = 1.611e-03 S  per = 0.0742  per(accum) = 93.7
 T(local opt: renrm) = 1.356e-01 S  per = 6.25  per(accum) = 100
 T(local opt: save ) = 4.166e-04 S  per = 0.0192  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.769e-01 S  T(sum) = 9.754e-01 S  per = 9.984e+01
 T(local opt: preprocess                  ) = 5.589e-03 S  per = 0.573  per(accum) = 0.573
 T(local opt: symbolic_formulae           ) = 1.132e-02 S  per = 1.16  per(accum) = 1.73
 T(local opt: hintermediate init          ) = 4.261e-04 S  per = 0.0437  per(accum) = 1.78
 T(local opt: preprocess_hformulae_Hxlist ) = 5.045e-01 S  per = 51.7  per(accum) = 53.5
 T(local opt: hmmtasks init               ) = 2.060e-01 S  per = 21.1  per(accum) = 74.6
 T(local opt: initial guess for dvdson    ) = 1.712e-03 S  per = 0.176  per(accum) = 74.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.692e-01 S  per = 17.3  per(accum) = 92.1
 T(local opt: dvdson [cpu-gpu]            ) = 1.198e-02 S  per = 1.23  per(accum) = 93.4
 T(local opt: dvdson [nccl]               ) = 5.212e-05 S  per = 0.00534  per(accum) = 93.4
 T(local opt: dvdson [mpi]                ) = 1.068e-06 S  per = 0.000109  per(accum) = 93.4
 T(local opt: dvdson [rest part(linalg)]  ) = 6.459e-02 S  per = 6.62  per(accum) = 100
Detailed decomposition of T(renrm) = 1.356e-01 S  T(sum) = 1.356e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.309e-04 S  per = 0.244  per(accum) = 0.244
 T(local opt: qops init                    ) = 7.202e-03 S  per = 5.31  per(accum) = 5.56
 T(local opt: symbolic_formulae_renorm     ) = 4.943e-03 S  per = 3.65  per(accum) = 9.2
 T(local opt: allocate qops on gpu         ) = 6.717e-05 S  per = 0.0495  per(accum) = 9.25
 T(local opt: site memcpy cpu2gpu          ) = 1.913e-03 S  per = 1.41  per(accum) = 10.7
 T(local opt: rintermediate init           ) = 2.516e-03 S  per = 1.86  per(accum) = 12.5
 T(local opt: preprocess_formulae_Rlist2   ) = 2.982e-02 S  per =   22  per(accum) = 34.5
 T(local opt: rmmtasks init                ) = 1.318e-02 S  per = 9.72  per(accum) = 44.2
 T(local opt: qops memset on cpu           ) = 3.600e-08 S  per = 2.66e-05  per(accum) = 44.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.939e-02 S  per = 29.1  per(accum) = 73.3
 T(local opt: deallocate cpu and gpu memory) = 8.959e-05 S  per = 0.0661  per(accum) = 73.4
 T(local opt: construct opS [ifdists=true] ) = 4.800e-08 S  per = 3.54e-05  per(accum) = 73.4
 T(local opt: reduction of opS & opH [nccl]) = 4.100e-08 S  per = 3.02e-05  per(accum) = 73.4
 T(local opt: qops memcpy gpu2cpu          ) = 3.100e-08 S  per = 2.29e-05  per(accum) = 73.4
 T(local opt: reduction of opS & opH [mpi] ) = 1.420e-07 S  per = 0.000105  per(accum) = 73.4
 T(local opt: qops_pool join and erase     ) = 3.803e-03 S  per = 2.81  per(accum) = 76.2
 T(local opt: conversion from opAB to opPQ ) = 3.232e-02 S  per = 23.8  per(accum) = 100
##### sweep opt: 9.885e+00 S #####
 T(sweep opt: fetch) = 1.559e-01 S  per = 1.58  per(accum) = 1.58
 T(sweep opt: hdiag) = 3.631e+00 S  per = 36.7  per(accum) = 38.3
 T(sweep opt: dvdsn) = 5.326e+00 S  per = 53.9  per(accum) = 92.2
 T(sweep opt: decim) = 1.112e-01 S  per = 1.13  per(accum) = 93.3
 T(sweep opt: guess) = 1.216e-02 S  per = 0.123  per(accum) = 93.4
 T(sweep opt: renrm) = 6.457e-01 S  per = 6.53  per(accum) = 100
 T(sweep opt: save ) = 2.778e-03 S  per = 0.0281  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.326e+00 S  T(sum) = 5.318e+00 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 5.726e-02 S  per = 1.08  per(accum) = 1.08
 T(sweep opt: symbolic_formulae           ) = 5.674e-02 S  per = 1.07  per(accum) = 2.14
 T(sweep opt: hintermediate init          ) = 2.189e-03 S  per = 0.0412  per(accum) = 2.18
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.832e+00 S  per = 34.4  per(accum) = 36.6
 T(sweep opt: hmmtasks init               ) = 6.555e-01 S  per = 12.3  per(accum) = 49
 T(sweep opt: initial guess for dvdson    ) = 1.340e-02 S  per = 0.252  per(accum) = 49.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.095e+00 S  per = 39.4  per(accum) = 88.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.458e-02 S  per = 1.21  per(accum) = 89.8
 T(sweep opt: dvdson [nccl]               ) = 3.458e-04 S  per = 0.0065  per(accum) = 89.8
 T(sweep opt: dvdson [mpi]                ) = 8.556e-06 S  per = 0.000161  per(accum) = 89.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.414e-01 S  per = 10.2  per(accum) = 100
Detailed decomposition of T(renrm) = 6.457e-01 S  T(sum) = 6.457e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.957e-03 S  per = 0.303  per(accum) = 0.303
 T(sweep opt: qops init                    ) = 2.627e-02 S  per = 4.07  per(accum) = 4.37
 T(sweep opt: symbolic_formulae_renorm     ) = 2.339e-02 S  per = 3.62  per(accum) = 7.99
 T(sweep opt: allocate qops on gpu         ) = 4.956e-04 S  per = 0.0768  per(accum) = 8.07
 T(sweep opt: site memcpy cpu2gpu          ) = 9.781e-03 S  per = 1.51  per(accum) = 9.59
 T(sweep opt: rintermediate init           ) = 2.078e-02 S  per = 3.22  per(accum) = 12.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.351e-01 S  per = 20.9  per(accum) = 33.7
 T(sweep opt: rmmtasks init                ) = 6.393e-02 S  per =  9.9  per(accum) = 43.6
 T(sweep opt: qops memset on cpu           ) = 3.440e-07 S  per = 5.33e-05  per(accum) = 43.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.039e-01 S  per = 47.1  per(accum) = 90.7
 T(sweep opt: deallocate cpu and gpu memory) = 5.583e-04 S  per = 0.0865  per(accum) = 90.8
 T(sweep opt: construct opS [ifdists=true] ) = 4.480e-07 S  per = 6.94e-05  per(accum) = 90.8
 T(sweep opt: reduction of opS & opH [nccl]) = 3.470e-07 S  per = 5.37e-05  per(accum) = 90.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.878e-04 S  per = 0.122  per(accum) = 90.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.321e-04 S  per = 0.0514  per(accum) = 90.9
 T(sweep opt: qops_pool join and erase     ) = 2.607e-02 S  per = 4.04  per(accum) = 95
 T(sweep opt: conversion from opAB to opPQ ) = 3.236e-02 S  per = 5.01  per(accum) = 100
##### global opt: 9.885e+00 S #####
 T(global opt: fetch) = 1.559e-01 S  per = 1.58  per(accum) = 1.58
 T(global opt: hdiag) = 3.631e+00 S  per = 36.7  per(accum) = 38.3
 T(global opt: dvdsn) = 5.326e+00 S  per = 53.9  per(accum) = 92.2
 T(global opt: decim) = 1.112e-01 S  per = 1.13  per(accum) = 93.3
 T(global opt: guess) = 1.216e-02 S  per = 0.123  per(accum) = 93.4
 T(global opt: renrm) = 6.457e-01 S  per = 6.53  per(accum) = 100
 T(global opt: save ) = 2.778e-03 S  per = 0.0281  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.326e+00 S  T(sum) = 5.318e+00 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 5.726e-02 S  per = 1.08  per(accum) = 1.08
 T(global opt: symbolic_formulae           ) = 5.674e-02 S  per = 1.07  per(accum) = 2.14
 T(global opt: hintermediate init          ) = 2.189e-03 S  per = 0.0412  per(accum) = 2.18
 T(global opt: preprocess_hformulae_Hxlist ) = 1.832e+00 S  per = 34.4  per(accum) = 36.6
 T(global opt: hmmtasks init               ) = 6.555e-01 S  per = 12.3  per(accum) = 49
 T(global opt: initial guess for dvdson    ) = 1.340e-02 S  per = 0.252  per(accum) = 49.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.095e+00 S  per = 39.4  per(accum) = 88.6
 T(global opt: dvdson [cpu-gpu]            ) = 6.458e-02 S  per = 1.21  per(accum) = 89.8
 T(global opt: dvdson [nccl]               ) = 3.458e-04 S  per = 0.0065  per(accum) = 89.8
 T(global opt: dvdson [mpi]                ) = 8.556e-06 S  per = 0.000161  per(accum) = 89.8
 T(global opt: dvdson [rest part(linalg)]  ) = 5.414e-01 S  per = 10.2  per(accum) = 100
Detailed decomposition of T(renrm) = 6.457e-01 S  T(sum) = 6.457e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.957e-03 S  per = 0.303  per(accum) = 0.303
 T(global opt: qops init                    ) = 2.627e-02 S  per = 4.07  per(accum) = 4.37
 T(global opt: symbolic_formulae_renorm     ) = 2.339e-02 S  per = 3.62  per(accum) = 7.99
 T(global opt: allocate qops on gpu         ) = 4.956e-04 S  per = 0.0768  per(accum) = 8.07
 T(global opt: site memcpy cpu2gpu          ) = 9.781e-03 S  per = 1.51  per(accum) = 9.59
 T(global opt: rintermediate init           ) = 2.078e-02 S  per = 3.22  per(accum) = 12.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.351e-01 S  per = 20.9  per(accum) = 33.7
 T(global opt: rmmtasks init                ) = 6.393e-02 S  per =  9.9  per(accum) = 43.6
 T(global opt: qops memset on cpu           ) = 3.440e-07 S  per = 5.33e-05  per(accum) = 43.6
 T(global opt: preprocess_renorm_batchGPU   ) = 3.039e-01 S  per = 47.1  per(accum) = 90.7
 T(global opt: deallocate cpu and gpu memory) = 5.583e-04 S  per = 0.0865  per(accum) = 90.8
 T(global opt: construct opS [ifdists=true] ) = 4.480e-07 S  per = 6.94e-05  per(accum) = 90.8
 T(global opt: reduction of opS & opH [nccl]) = 3.470e-07 S  per = 5.37e-05  per(accum) = 90.8
 T(global opt: qops memcpy gpu2cpu          ) = 7.878e-04 S  per = 0.122  per(accum) = 90.9
 T(global opt: reduction of opS & opH [mpi] ) = 3.321e-04 S  per = 0.0514  per(accum) = 90.9
 T(global opt: qops_pool join and erase     ) = 2.607e-02 S  per = 4.04  per(accum) = 95
 T(global opt: conversion from opAB to opPQ ) = 3.236e-02 S  per = 5.01  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-7.343e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=8/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=647:4.936e-03MB:4.821e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=80:6.104e-04MB:5.960e-07GB
total mem of comb=728:5.554e-03MB:5.424e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:9 S:11 P:121 Q:132 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=5614:4.283e-02MB:4.183e-05GB
        per(mem): H:0.499 C:1.92 S:2.35 P:0 Q:95.2 
 rqops: oplist=HCSAB nops=H:1 C:9 S:11 A:81 B:90 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=4603:0.0351MB:3.43e-05GB
        per(mem): H:0.717 C:1.56 S:1.91 A:0 B:95.8 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=12213:0.0932MB:9.1e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.033e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-3.773e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,9,3,3) nnz=151:1.152e-03MB
qtensor4: wf4 own=1 _data=0x45be6300
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
 qbond: qcol nsym=3 dimAll=9
 (14,2):4 (14,4):4 (15,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=26 nblocks=228 size=151:1.152e-03MB
### DIAG TIMING: total=1.252e+00 t1=3.096e-05, t2=3.389e-04, t3=3.390e-04, t4=1.252e+00, t5=1.167e-05, t6=2.716e-05, t7=1.411e-05
duration_diagGPU:1.253e+00
duration_diagreduce:2.330e-07
duration_diagtransform:1.471e-06
----- TIMING FOR symbolic_formulae_twodot with size=972 : 1.315e-02 S -----
rank=0 GPUmem(GB): used=9.099e-05 (oper)=9.099e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=972
 no. of hintermediate operators=445
 no. of coefficients=6255:4.772e-02MB:4.660e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.696e-04 S -----
rank=0 GPUmem(GB): used=1.376e-04 (oper,hinter)=9.099e-05,4.660e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.170e-01 S size(H_formulae)=972 size(Hxlst2)=26 T(Hmu/Hxlist)=2.800e-03,5.142e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.216e-01 S size(H_formulae)=972 size(Hxlst)=30986 -----
rank=0 GPUmem(GB): used=1.376e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=2.250e-06 batch[need]=1.131e-02 blksize=16 blksize0=16 batchsize=30986
rank=0 GPUmem(GB): used=1.145e-02 (oper,hinter,dvdson,batch)=9.099e-05,4.660e-05,2.250e-06,1.131e-02
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=151 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.417e-03,5.160e-03,1.049e-02,1.080e-02,2.788e-02
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=1.408e-03 speed=1.598e-03GB/S T(nccl)=9.101e-06 speed=2.472e-01GB/S
----- TIMING FOR sigma : t_inter=5.2e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=52 t=5.2e-03 per=2.0e+01 cost=2.5e+06 flops=4.9e+08
 sigma[gemm] counter=52 i=0 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=1.3e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=1.2e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=3 t=1.1e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=4 t=2.6e-03 per=9.8e+00 cost=6.3e+05 flops=2.4e+08
 sigma[gemm] counter=52 i=5 t=2.7e-03 per=1.0e+01 cost=6.4e+05 flops=2.4e+08
 sigma[gemm] counter=52 i=6 t=2.6e-03 per=9.8e+00 cost=2.9e+05 flops=1.1e+08
 sigma[gemm] counter=52 i=7 t=2.6e-03 per=9.8e+00 cost=3.2e+05 flops=1.2e+08
 sigma[gemm] counter=52 total t=1.0e-02 per=4.0e+01 cost=1.9e+06 flops=1.8e+08
 sigma[red] counter=52 t=1.1e-02 per=4.1e+01 cost=3.9e+05 flops=3.6e+07
----- TIMING FOR sigma_tot : t_inter=4.4e-01 t_gemm=1.1e+00 t_reduction=5.6e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=52 t=4.4e-01 per=2.1e+01 cost=4.8e+07 flops=1.1e+08
 sigma_tot[gemm] counter=52 i=0 t=1.2e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=1.0e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=8.3e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=3 t=8.3e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=4 t=3.0e-01 per=1.4e+01 cost=8.8e+06 flops=2.9e+07
 sigma_tot[gemm] counter=52 i=5 t=3.0e-01 per=1.4e+01 cost=8.8e+06 flops=2.9e+07
 sigma_tot[gemm] counter=52 i=6 t=2.6e-01 per=1.2e+01 cost=1.0e+07 flops=3.9e+07
 sigma_tot[gemm] counter=52 i=7 t=2.6e-01 per=1.2e+01 cost=1.0e+07 flops=4.0e+07
 sigma_tot[gemm] counter=52 total t=1.1e+00 per=5.3e+01 cost=3.8e+07 flops=3.4e+07
 sigma_tot[red] counter=52 t=5.6e-01 per=2.6e+01 cost=8.7e+06 flops=1.5e+07
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,8.0e-06,2.5e-06,1.2e-06,2.5e-07
settings: ndim=151 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.248757672847 -1.116e+03  2.443e-02    1     1  2.802e-02 2.802e-02 2.799e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.959e-03,5.083e-03,1.049e-02,1.088e-02,2.843e-02
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=1.953e-03 speed=1.152e-03GB/S T(nccl)=6.298e-06 speed=3.573e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=53 t=5.1e-03 per=1.9e+01 cost=2.5e+06 flops=4.9e+08
 sigma[gemm] counter=53 i=0 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=1.3e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=3 t=1.3e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=4 t=2.6e-03 per=9.8e+00 cost=6.3e+05 flops=2.4e+08
 sigma[gemm] counter=53 i=5 t=2.7e-03 per=1.0e+01 cost=6.4e+05 flops=2.3e+08
 sigma[gemm] counter=53 i=6 t=2.6e-03 per=9.8e+00 cost=2.9e+05 flops=1.1e+08
 sigma[gemm] counter=53 i=7 t=2.6e-03 per=9.7e+00 cost=3.2e+05 flops=1.2e+08
 sigma[gemm] counter=53 total t=1.0e-02 per=4.0e+01 cost=1.9e+06 flops=1.8e+08
 sigma[red] counter=53 t=1.1e-02 per=4.1e+01 cost=3.9e+05 flops=3.5e+07
----- TIMING FOR sigma_tot : t_inter=4.4e-01 t_gemm=1.1e+00 t_reduction=5.7e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=53 t=4.4e-01 per=2.1e+01 cost=5.0e+07 flops=1.1e+08
 sigma_tot[gemm] counter=53 i=0 t=1.2e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=1.0e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=8.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=3 t=8.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=4 t=3.0e-01 per=1.4e+01 cost=9.4e+06 flops=3.1e+07
 sigma_tot[gemm] counter=53 i=5 t=3.0e-01 per=1.4e+01 cost=9.5e+06 flops=3.1e+07
 sigma_tot[gemm] counter=53 i=6 t=2.6e-01 per=1.2e+01 cost=1.0e+07 flops=4.0e+07
 sigma_tot[gemm] counter=53 i=7 t=2.6e-01 per=1.2e+01 cost=1.1e+07 flops=4.1e+07
 sigma_tot[gemm] counter=53 total t=1.1e+00 per=5.3e+01 cost=4.0e+07 flops=3.5e+07
 sigma_tot[red] counter=53 t=5.7e-01 per=2.7e+01 cost=9.0e+06 flops=1.6e+07
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,3.8e-05,3.5e-06,1.7e-06,2.7e-07
    2   0 -    -116.250671974043 -1.914e-03  6.274e-03    2     2  6.957e-02 3.479e-02 2.827e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.934e-04,5.066e-03,1.036e-02,1.089e-02,2.682e-02
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=4.870e-04 speed=4.620e-03GB/S T(nccl)=6.415e-06 speed=3.508e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=54 t=5.1e-03 per=1.9e+01 cost=2.5e+06 flops=4.9e+08
 sigma[gemm] counter=54 i=0 t=1.7e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=1.5e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=3 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=4 t=2.5e-03 per=9.7e+00 cost=6.3e+05 flops=2.5e+08
 sigma[gemm] counter=54 i=5 t=2.7e-03 per=1.0e+01 cost=6.4e+05 flops=2.3e+08
 sigma[gemm] counter=54 i=6 t=2.5e-03 per=9.5e+00 cost=2.9e+05 flops=1.2e+08
 sigma[gemm] counter=54 i=7 t=2.6e-03 per=9.8e+00 cost=3.2e+05 flops=1.2e+08
 sigma[gemm] counter=54 total t=1.0e-02 per=3.9e+01 cost=1.9e+06 flops=1.8e+08
 sigma[red] counter=54 t=1.1e-02 per=4.1e+01 cost=3.9e+05 flops=3.5e+07
----- TIMING FOR sigma_tot : t_inter=4.5e-01 t_gemm=1.1e+00 t_reduction=5.8e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=54 t=4.5e-01 per=2.1e+01 cost=5.3e+07 flops=1.2e+08
 sigma_tot[gemm] counter=54 i=0 t=1.3e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=1.1e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=8.6e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=3 t=8.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=4 t=3.1e-01 per=1.4e+01 cost=1.0e+07 flops=3.3e+07
 sigma_tot[gemm] counter=54 i=5 t=3.1e-01 per=1.4e+01 cost=1.0e+07 flops=3.3e+07
 sigma_tot[gemm] counter=54 i=6 t=2.6e-01 per=1.2e+01 cost=1.1e+07 flops=4.0e+07
 sigma_tot[gemm] counter=54 i=7 t=2.6e-01 per=1.2e+01 cost=1.1e+07 flops=4.2e+07
 sigma_tot[gemm] counter=54 total t=1.1e+00 per=5.3e+01 cost=4.2e+07 flops=3.7e+07
 sigma_tot[red] counter=54 t=5.8e-01 per=2.7e+01 cost=9.4e+06 flops=1.6e+07
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,4.5e-05,3.2e-06,1.7e-06,2.8e-07
    3   0 -    -116.250763625795 -9.165e-05  1.816e-03    3     3  1.089e-01 3.630e-02 2.782e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.402e-03,5.042e-03,1.031e-02,1.092e-02,2.768e-02
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=1.396e-03 speed=1.612e-03GB/S T(nccl)=6.288e-06 speed=3.578e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=55 t=5.0e-03 per=1.9e+01 cost=2.5e+06 flops=5.0e+08
 sigma[gemm] counter=55 i=0 t=1.7e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=3 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=4 t=2.5e-03 per=9.7e+00 cost=6.3e+05 flops=2.5e+08
 sigma[gemm] counter=55 i=5 t=2.7e-03 per=1.0e+01 cost=6.4e+05 flops=2.4e+08
 sigma[gemm] counter=55 i=6 t=2.5e-03 per=9.7e+00 cost=2.9e+05 flops=1.1e+08
 sigma[gemm] counter=55 i=7 t=2.6e-03 per=9.7e+00 cost=3.2e+05 flops=1.3e+08
 sigma[gemm] counter=55 total t=1.0e-02 per=3.9e+01 cost=1.9e+06 flops=1.8e+08
 sigma[red] counter=55 t=1.1e-02 per=4.2e+01 cost=3.9e+05 flops=3.5e+07
----- TIMING FOR sigma_tot : t_inter=4.5e-01 t_gemm=1.1e+00 t_reduction=5.9e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=55 t=4.5e-01 per=2.1e+01 cost=5.5e+07 flops=1.2e+08
 sigma_tot[gemm] counter=55 i=0 t=1.3e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=1.1e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=8.7e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=3 t=8.7e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=4 t=3.1e-01 per=1.4e+01 cost=1.1e+07 flops=3.5e+07
 sigma_tot[gemm] counter=55 i=5 t=3.1e-01 per=1.4e+01 cost=1.1e+07 flops=3.5e+07
 sigma_tot[gemm] counter=55 i=6 t=2.6e-01 per=1.2e+01 cost=1.1e+07 flops=4.1e+07
 sigma_tot[gemm] counter=55 i=7 t=2.7e-01 per=1.2e+01 cost=1.1e+07 flops=4.3e+07
 sigma_tot[gemm] counter=55 total t=1.1e+00 per=5.2e+01 cost=4.4e+07 flops=3.8e+07
 sigma_tot[red] counter=55 t=5.9e-01 per=2.7e+01 cost=9.8e+06 flops=1.7e+07
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=7.1e-06,1.9e-05,3.3e-06,1.3e-06,2.2e-07
    4   0 -    -116.250772291414 -8.666e-06  6.851e-04    3     4  1.481e-01 3.703e-02 2.782e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.879e-03,5.045e-03,1.022e-02,1.061e-02,2.777e-02
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=1.873e-03 speed=1.201e-03GB/S T(nccl)=6.518e-06 speed=3.452e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=56 t=5.0e-03 per=1.9e+01 cost=2.5e+06 flops=5.0e+08
 sigma[gemm] counter=56 i=0 t=1.5e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=1.3e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=3 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=4 t=2.5e-03 per=9.7e+00 cost=6.3e+05 flops=2.5e+08
 sigma[gemm] counter=56 i=5 t=2.7e-03 per=1.0e+01 cost=6.4e+05 flops=2.4e+08
 sigma[gemm] counter=56 i=6 t=2.5e-03 per=9.8e+00 cost=2.9e+05 flops=1.1e+08
 sigma[gemm] counter=56 i=7 t=2.5e-03 per=9.7e+00 cost=3.2e+05 flops=1.3e+08
 sigma[gemm] counter=56 total t=1.0e-02 per=3.9e+01 cost=1.9e+06 flops=1.8e+08
 sigma[red] counter=56 t=1.1e-02 per=4.1e+01 cost=3.9e+05 flops=3.6e+07
----- TIMING FOR sigma_tot : t_inter=4.6e-01 t_gemm=1.2e+00 t_reduction=6.0e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=56 t=4.6e-01 per=2.1e+01 cost=5.8e+07 flops=1.3e+08
 sigma_tot[gemm] counter=56 i=0 t=1.3e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=1.1e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=8.9e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=3 t=8.8e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=4 t=3.1e-01 per=1.4e+01 cost=1.1e+07 flops=3.6e+07
 sigma_tot[gemm] counter=56 i=5 t=3.1e-01 per=1.4e+01 cost=1.1e+07 flops=3.7e+07
 sigma_tot[gemm] counter=56 i=6 t=2.7e-01 per=1.2e+01 cost=1.1e+07 flops=4.2e+07
 sigma_tot[gemm] counter=56 i=7 t=2.7e-01 per=1.2e+01 cost=1.2e+07 flops=4.3e+07
 sigma_tot[gemm] counter=56 total t=1.2e+00 per=5.2e+01 cost=4.6e+07 flops=3.9e+07
 sigma_tot[red] counter=56 t=6.0e-01 per=2.7e+01 cost=1.0e+07 flops=1.7e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.5e-05,3.3e-06,1.7e-06,2.9e-07
    5   0 -    -116.250773469210 -1.178e-06  1.611e-04    3     5  1.840e-01 3.680e-02 2.783e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.115e-03,5.050e-03,1.018e-02,1.052e-02,2.688e-02
 analyze_tgpu[Hx]: ndim=151:1.125e-06GB T(cpu-gpu)=1.108e-03 speed=2.030e-03GB/S T(nccl)=6.244e-06 speed=3.604e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=57 t=5.1e-03 per=2.0e+01 cost=2.5e+06 flops=5.0e+08
 sigma[gemm] counter=57 i=0 t=1.7e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=1.5e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=3 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=4 t=2.5e-03 per=9.8e+00 cost=6.3e+05 flops=2.5e+08
 sigma[gemm] counter=57 i=5 t=2.7e-03 per=1.0e+01 cost=6.4e+05 flops=2.4e+08
 sigma[gemm] counter=57 i=6 t=2.5e-03 per=9.7e+00 cost=2.9e+05 flops=1.2e+08
 sigma[gemm] counter=57 i=7 t=2.5e-03 per=9.7e+00 cost=3.2e+05 flops=1.3e+08
 sigma[gemm] counter=57 total t=1.0e-02 per=4.0e+01 cost=1.9e+06 flops=1.8e+08
 sigma[red] counter=57 t=1.1e-02 per=4.1e+01 cost=3.9e+05 flops=3.7e+07
----- TIMING FOR sigma_tot : t_inter=4.6e-01 t_gemm=1.2e+00 t_reduction=6.1e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=57 t=4.6e-01 per=2.1e+01 cost=6.0e+07 flops=1.3e+08
 sigma_tot[gemm] counter=57 i=0 t=1.3e-04 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=1.1e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=9.0e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=3 t=9.0e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=4 t=3.1e-01 per=1.4e+01 cost=1.2e+07 flops=3.8e+07
 sigma_tot[gemm] counter=57 i=5 t=3.1e-01 per=1.4e+01 cost=1.2e+07 flops=3.8e+07
 sigma_tot[gemm] counter=57 i=6 t=2.7e-01 per=1.2e+01 cost=1.1e+07 flops=4.3e+07
 sigma_tot[gemm] counter=57 i=7 t=2.7e-01 per=1.2e+01 cost=1.2e+07 flops=4.4e+07
 sigma_tot[gemm] counter=57 total t=1.2e+00 per=5.2e+01 cost=4.7e+07 flops=4.1e+07
 sigma_tot[red] counter=57 t=6.1e-01 per=2.7e+01 cost=1.1e+07 flops=1.7e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.5e-05,3.2e-06,1.7e-06,2.5e-07
    6   0 +    -116.250773542643 -7.343e-08  3.777e-05    3     6  2.185e-01 3.641e-02 2.769e-02
TIMING FOR Davidson : 2.185e-01  T(cal/comm/rest)=1.661e-01,8.930e-07,5.234e-02
decomposed t_rest=5.234e-02
 T(sub)    =2.067e-04 per=3.949e-01
 T(precond)=5.195e-02 per=9.926e+01
 T(ortho)  =4.820e-05 per=9.208e-02
 T(xcopy)  =1.040e-06 per=1.987e-03
 T(xnrm2)  =2.848e-06 per=5.441e-03
 T(other)  =1.296e-04 per=2.476e-01
optimized energies: isweep=0 ibond=8 dots=2 e[0]=-116.250773542643 nmvp=6
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.310e-02 change=7.686e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=11 dimAll=37
 (14,2):6 (16,2):4 (15,1):8 (15,3):6 (14,0):4 (16,0):3 (13,1):1 (13,3):1 (14,4):2 (16,4):1 (15,5):1
timing for divide=8.5e-05
timing for compute=6.8e-03
timing for collect=2.4e-05
----- TMING FOR decimation_genbasis(su2): 6.9e-03 S T(divide/compute[cpu/gpu/rest]/collect)=8.5e-05,6.8e-03,0.0e+00,8.5e-06,2.4e-05 -----
decimation summary: 37->10 dwt=+4.871e-03 SvN=1.161e+00
 qbond: qkept nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
----- TIMING for decimation_row(nkr): 7.465e-03 S T(decim/select/formRot)=6.954e-03,4.086e-04,1.032e-04 -----
----- TIMING FOR twodot_decimation: 8.030e-03 S T(wf/decim)=5.491e-04,7.481e-03 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=5088:3.882e-02MB:3.791e-05GB
        per(mem): H:0.55 C:2.16 S:2.16 P:0 Q:95.1 
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.305e-02 change=4.596e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=231 : 8.079e-03 S -----
rank=0 GPUmem(GB): used=1.412e-04 (oper)=8.717e-05
rank=0 GPUmem(GB): used=1.417e-04 (oper,site)=8.717e-05,4.396e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=231
 no. of rintermediate operators=350
 no. of coefficients=3150:2.403e-02MB:2.347e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.455e-03 S -----
rank=0 GPUmem(GB): used=1.651e-04 (oper,site,rinter)=8.717e-05,4.396e-07,2.347e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.550e-02 S size(rtasks)=231 size(Rlst2)=25 T(Rmu/Rlist)=2.449e-03,7.305e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.608e-02 S size(rtasks)=231 size(Rlst)=6873 -----
rank=0 GPUmem(GB): used=1.651e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.895e-03 blksize=16 blksize0=4 batchsize=6873
rank=0 GPUmem(GB): used=2.060e-03 (oper,site,rinter,batch)=8.717e-05,4.396e-07,2.347e-05,1.895e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.299e-03,2.275e-02,1.012e-02
----- TIMING FOR renorm : t_inter=6.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=9 t=6.3e-03 per=1.6e+01 cost=1.2e+05 flops=1.9e+07
 renorm[gemm] counter=9 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=4 t=7.6e-03 per=2.0e+01 cost=2.7e+04 flops=3.6e+06
 renorm[gemm] counter=9 i=5 t=7.5e-03 per=1.9e+01 cost=9.8e+04 flops=1.3e+07
 renorm[gemm] counter=9 i=6 t=7.5e-03 per=1.9e+01 cost=2.1e+05 flops=2.8e+07
 renorm[gemm] counter=9 total t=2.3e-02 per=5.8e+01 cost=3.4e+05 flops=1.5e+07
 renorm[red] counter=9 t=1.0e-02 per=2.6e+01 cost=9.0e+04 flops=8.9e+06
----- TIMING FOR renorm_tot : t_inter=5.0e-02 t_gemm=2.0e-01 t_reduction=9.0e-02 tot=3.4e-01 -----
 renorm_tot[inter] counter=9 t=5.0e-02 per=1.5e+01 cost=8.9e+05 flops=1.8e+07
 renorm_tot[gemm] counter=9 i=0 t=1.4e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=1.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=1.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=3 t=1.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=4 t=6.6e-02 per=1.9e+01 cost=1.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=9 i=5 t=6.8e-02 per=2.0e+01 cost=2.9e+05 flops=4.3e+06
 renorm_tot[gemm] counter=9 i=6 t=6.8e-02 per=2.0e+01 cost=4.2e+05 flops=6.2e+06
 renorm_tot[gemm] counter=9 total t=2.0e-01 per=5.9e+01 cost=8.2e+05 flops=4.1e+06
 renorm_tot[red] counter=9 t=9.0e-02 per=2.6e+01 cost=1.7e+05 flops=1.9e+06
qops.to_cpu: size(tot)=5088:3.9e-02MB:3.8e-05GB T(to_cpu)=2.7e-04S speed=1.4e-01GB/S
check ||H-H.dagger||=1.202e-14 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.178 S rank=0 -----
rank=0 CPUmem(GB): used=1.017e+00 pageheap_free=1.357e-02 change=2.017e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.505e-02 change=-3.544e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.505e-02 change=-3.979e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.455e+00 S #####
 T(local opt: fetch) = 1.186e-02 S  per = 0.483  per(accum) = 0.483
 T(local opt: hdiag) = 1.253e+00 S  per =   51  per(accum) = 51.5
 T(local opt: dvdsn) = 9.982e-01 S  per = 40.7  per(accum) = 92.2
 T(local opt: decim) = 8.055e-03 S  per = 0.328  per(accum) = 92.5
 T(local opt: guess) = 9.864e-04 S  per = 0.0402  per(accum) = 92.6
 T(local opt: renrm) = 1.822e-01 S  per = 7.42  per(accum) = 100
 T(local opt: save ) = 4.163e-04 S  per = 0.017  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.982e-01 S  T(sum) = 9.964e-01 S  per = 9.982e+01
 T(local opt: preprocess                  ) = 3.404e-03 S  per = 0.342  per(accum) = 0.342
 T(local opt: symbolic_formulae           ) = 1.316e-02 S  per = 1.32  per(accum) = 1.66
 T(local opt: hintermediate init          ) = 4.909e-04 S  per = 0.0493  per(accum) = 1.71
 T(local opt: preprocess_hformulae_Hxlist ) = 5.227e-01 S  per = 52.5  per(accum) = 54.2
 T(local opt: hmmtasks init               ) = 2.369e-01 S  per = 23.8  per(accum) = 77.9
 T(local opt: initial guess for dvdson    ) = 1.240e-03 S  per = 0.124  per(accum) = 78.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.579e-01 S  per = 15.8  per(accum) = 93.9
 T(local opt: dvdson [cpu-gpu]            ) = 8.225e-03 S  per = 0.825  per(accum) = 94.7
 T(local opt: dvdson [nccl]               ) = 4.086e-05 S  per = 0.0041  per(accum) = 94.7
 T(local opt: dvdson [mpi]                ) = 8.930e-07 S  per = 8.96e-05  per(accum) = 94.7
 T(local opt: dvdson [rest part(linalg)]  ) = 5.234e-02 S  per = 5.25  per(accum) = 100
Detailed decomposition of T(renrm) = 1.822e-01 S  T(sum) = 1.822e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.203e-04 S  per = 0.176  per(accum) = 0.176
 T(local opt: qops init                    ) = 7.131e-03 S  per = 3.91  per(accum) = 4.09
 T(local opt: symbolic_formulae_renorm     ) = 8.093e-03 S  per = 4.44  per(accum) = 8.53
 T(local opt: allocate qops on gpu         ) = 6.711e-05 S  per = 0.0368  per(accum) = 8.57
 T(local opt: site memcpy cpu2gpu          ) = 1.107e-03 S  per = 0.608  per(accum) = 9.18
 T(local opt: rintermediate init           ) = 2.465e-03 S  per = 1.35  per(accum) = 10.5
 T(local opt: preprocess_formulae_Rlist2   ) = 7.630e-02 S  per = 41.9  per(accum) = 52.4
 T(local opt: rmmtasks init                ) = 4.277e-02 S  per = 23.5  per(accum) = 75.9
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 2.36e-05  per(accum) = 75.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.926e-02 S  per = 21.5  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 4.178e-04 S  per = 0.229  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 1.190e-07 S  per = 6.53e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 2.14e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 2.824e-04 S  per = 0.155  per(accum) = 97.8
 T(local opt: reduction of opS & opH [mpi] ) = 5.477e-05 S  per = 0.0301  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 3.933e-03 S  per = 2.16  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.402e-06 S  per = 0.00461  per(accum) = 100
##### sweep opt: 1.234e+01 S #####
 T(sweep opt: fetch) = 1.678e-01 S  per = 1.36  per(accum) = 1.36
 T(sweep opt: hdiag) = 4.884e+00 S  per = 39.6  per(accum) = 40.9
 T(sweep opt: dvdsn) = 6.324e+00 S  per = 51.2  per(accum) = 92.2
 T(sweep opt: decim) = 1.193e-01 S  per = 0.967  per(accum) = 93.2
 T(sweep opt: guess) = 1.314e-02 S  per = 0.107  per(accum) = 93.3
 T(sweep opt: renrm) = 8.279e-01 S  per = 6.71  per(accum) = 100
 T(sweep opt: save ) = 3.195e-03 S  per = 0.0259  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.324e+00 S  T(sum) = 6.315e+00 S  per = 9.985e+01
 T(sweep opt: preprocess                  ) = 6.066e-02 S  per = 0.961  per(accum) = 0.961
 T(sweep opt: symbolic_formulae           ) = 6.990e-02 S  per = 1.11  per(accum) = 2.07
 T(sweep opt: hintermediate init          ) = 2.680e-03 S  per = 0.0424  per(accum) = 2.11
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.355e+00 S  per = 37.3  per(accum) = 39.4
 T(sweep opt: hmmtasks init               ) = 8.924e-01 S  per = 14.1  per(accum) = 53.5
 T(sweep opt: initial guess for dvdson    ) = 1.464e-02 S  per = 0.232  per(accum) = 53.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.253e+00 S  per = 35.7  per(accum) = 89.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 7.281e-02 S  per = 1.15  per(accum) = 90.6
 T(sweep opt: dvdson [nccl]               ) = 3.867e-04 S  per = 0.00612  per(accum) = 90.6
 T(sweep opt: dvdson [mpi]                ) = 9.449e-06 S  per = 0.00015  per(accum) = 90.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.938e-01 S  per =  9.4  per(accum) = 100
Detailed decomposition of T(renrm) = 8.279e-01 S  T(sum) = 8.279e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.277e-03 S  per = 0.275  per(accum) = 0.275
 T(sweep opt: qops init                    ) = 3.340e-02 S  per = 4.03  per(accum) = 4.31
 T(sweep opt: symbolic_formulae_renorm     ) = 3.148e-02 S  per =  3.8  per(accum) = 8.11
 T(sweep opt: allocate qops on gpu         ) = 5.627e-04 S  per = 0.068  per(accum) = 8.18
 T(sweep opt: site memcpy cpu2gpu          ) = 1.089e-02 S  per = 1.32  per(accum) = 9.5
 T(sweep opt: rintermediate init           ) = 2.324e-02 S  per = 2.81  per(accum) = 12.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.114e-01 S  per = 25.5  per(accum) = 37.8
 T(sweep opt: rmmtasks init                ) = 1.067e-01 S  per = 12.9  per(accum) = 50.7
 T(sweep opt: qops memset on cpu           ) = 3.870e-07 S  per = 4.67e-05  per(accum) = 50.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.431e-01 S  per = 41.4  per(accum) = 92.2
 T(sweep opt: deallocate cpu and gpu memory) = 9.762e-04 S  per = 0.118  per(accum) = 92.3
 T(sweep opt: construct opS [ifdists=true] ) = 5.670e-07 S  per = 6.85e-05  per(accum) = 92.3
 T(sweep opt: reduction of opS & opH [nccl]) = 3.860e-07 S  per = 4.66e-05  per(accum) = 92.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.070e-03 S  per = 0.129  per(accum) = 92.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.869e-04 S  per = 0.0467  per(accum) = 92.5
 T(sweep opt: qops_pool join and erase     ) = 3.000e-02 S  per = 3.62  per(accum) = 96.1
 T(sweep opt: conversion from opAB to opPQ ) = 3.237e-02 S  per = 3.91  per(accum) = 100
##### global opt: 1.234e+01 S #####
 T(global opt: fetch) = 1.678e-01 S  per = 1.36  per(accum) = 1.36
 T(global opt: hdiag) = 4.884e+00 S  per = 39.6  per(accum) = 40.9
 T(global opt: dvdsn) = 6.324e+00 S  per = 51.2  per(accum) = 92.2
 T(global opt: decim) = 1.193e-01 S  per = 0.967  per(accum) = 93.2
 T(global opt: guess) = 1.314e-02 S  per = 0.107  per(accum) = 93.3
 T(global opt: renrm) = 8.279e-01 S  per = 6.71  per(accum) = 100
 T(global opt: save ) = 3.195e-03 S  per = 0.0259  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.324e+00 S  T(sum) = 6.315e+00 S  per = 9.985e+01
 T(global opt: preprocess                  ) = 6.066e-02 S  per = 0.961  per(accum) = 0.961
 T(global opt: symbolic_formulae           ) = 6.990e-02 S  per = 1.11  per(accum) = 2.07
 T(global opt: hintermediate init          ) = 2.680e-03 S  per = 0.0424  per(accum) = 2.11
 T(global opt: preprocess_hformulae_Hxlist ) = 2.355e+00 S  per = 37.3  per(accum) = 39.4
 T(global opt: hmmtasks init               ) = 8.924e-01 S  per = 14.1  per(accum) = 53.5
 T(global opt: initial guess for dvdson    ) = 1.464e-02 S  per = 0.232  per(accum) = 53.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.253e+00 S  per = 35.7  per(accum) = 89.4
 T(global opt: dvdson [cpu-gpu]            ) = 7.281e-02 S  per = 1.15  per(accum) = 90.6
 T(global opt: dvdson [nccl]               ) = 3.867e-04 S  per = 0.00612  per(accum) = 90.6
 T(global opt: dvdson [mpi]                ) = 9.449e-06 S  per = 0.00015  per(accum) = 90.6
 T(global opt: dvdson [rest part(linalg)]  ) = 5.938e-01 S  per =  9.4  per(accum) = 100
Detailed decomposition of T(renrm) = 8.279e-01 S  T(sum) = 8.279e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.277e-03 S  per = 0.275  per(accum) = 0.275
 T(global opt: qops init                    ) = 3.340e-02 S  per = 4.03  per(accum) = 4.31
 T(global opt: symbolic_formulae_renorm     ) = 3.148e-02 S  per =  3.8  per(accum) = 8.11
 T(global opt: allocate qops on gpu         ) = 5.627e-04 S  per = 0.068  per(accum) = 8.18
 T(global opt: site memcpy cpu2gpu          ) = 1.089e-02 S  per = 1.32  per(accum) = 9.5
 T(global opt: rintermediate init           ) = 2.324e-02 S  per = 2.81  per(accum) = 12.3
 T(global opt: preprocess_formulae_Rlist2   ) = 2.114e-01 S  per = 25.5  per(accum) = 37.8
 T(global opt: rmmtasks init                ) = 1.067e-01 S  per = 12.9  per(accum) = 50.7
 T(global opt: qops memset on cpu           ) = 3.870e-07 S  per = 4.67e-05  per(accum) = 50.7
 T(global opt: preprocess_renorm_batchGPU   ) = 3.431e-01 S  per = 41.4  per(accum) = 92.2
 T(global opt: deallocate cpu and gpu memory) = 9.762e-04 S  per = 0.118  per(accum) = 92.3
 T(global opt: construct opS [ifdists=true] ) = 5.670e-07 S  per = 6.85e-05  per(accum) = 92.3
 T(global opt: reduction of opS & opH [nccl]) = 3.860e-07 S  per = 4.66e-05  per(accum) = 92.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.070e-03 S  per = 0.129  per(accum) = 92.4
 T(global opt: reduction of opS & opH [mpi] ) = 3.869e-04 S  per = 0.0467  per(accum) = 92.5
 T(global opt: qops_pool join and erase     ) = 3.000e-02 S  per = 3.62  per(accum) = 96.1
 T(global opt: conversion from opAB to opPQ ) = 3.237e-02 S  per = 3.91  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-7.657e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=9/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=554:4.227e-03MB:4.128e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=612:4.669e-03MB:4.560e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=5088:3.882e-02MB:3.791e-05GB
        per(mem): H:0.55 C:2.16 S:2.16 P:0 Q:95.1 
 rqops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=2494:0.019MB:1.86e-05GB
        per(mem): H:0.882 C:3.85 S:5.77 A:0 B:89.5 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=9578:0.0731MB:7.14e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.786e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,8,3,3) nnz=114:8.698e-04MB
qtensor4: wf4 own=1 _data=0x3ada8400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
 qbond: qcol nsym=3 dimAll=8
 (12,2):3 (12,4):3 (13,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=20 nblocks=240 size=114:8.698e-04MB
### DIAG TIMING: total=1.012e+00 t1=3.181e-05, t2=1.661e-03, t3=2.487e-03, t4=1.008e+00, t5=1.839e-05, t6=3.003e-05, t7=8.174e-06
duration_diagGPU:1.012e+00
duration_diagreduce:2.650e-07
duration_diagtransform:4.797e-06
----- TIMING FOR symbolic_formulae_twodot with size=831 : 1.233e-02 S -----
rank=0 GPUmem(GB): used=7.136e-05 (oper)=7.136e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=831
 no. of hintermediate operators=386
 no. of coefficients=5612:4.282e-02MB:4.181e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.209e-04 S -----
rank=0 GPUmem(GB): used=1.132e-04 (oper,hinter)=7.136e-05,4.181e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.913e-01 S size(H_formulae)=831 size(Hxlst2)=20 T(Hmu/Hxlist)=2.770e-03,2.885e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.944e-01 S size(H_formulae)=831 size(Hxlst)=16750 -----
rank=0 GPUmem(GB): used=1.132e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.699e-06 batch[need]=4.243e-03 blksize=12 blksize0=9 batchsize=16750
rank=0 GPUmem(GB): used=4.358e-03 (oper,hinter,dvdson,batch)=7.136e-05,4.181e-05,1.699e-06,4.243e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=114 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.801e-03,1.026e-02,3.028e-02,1.054e-02,5.289e-02
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=1.792e-03 speed=9.482e-04GB/S T(nccl)=9.109e-06 speed=1.865e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=58 t=1.0e-02 per=2.0e+01 cost=8.1e+05 flops=7.9e+07
 sigma[gemm] counter=58 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=3 t=1.0e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=4 t=7.6e-03 per=1.5e+01 cost=2.2e+05 flops=2.9e+07
 sigma[gemm] counter=58 i=5 t=7.7e-03 per=1.5e+01 cost=2.3e+05 flops=3.0e+07
 sigma[gemm] counter=58 i=6 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=58 i=7 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=58 total t=3.0e-02 per=5.9e+01 cost=7.7e+05 flops=2.5e+07
 sigma[red] counter=58 t=1.1e-02 per=2.1e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=4.7e-01 t_gemm=1.2e+00 t_reduction=6.2e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=58 t=4.7e-01 per=2.1e+01 cost=6.1e+07 flops=1.3e+08
 sigma_tot[gemm] counter=58 i=0 t=1.3e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=1.1e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=9.1e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=3 t=9.1e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=4 t=3.2e-01 per=1.4e+01 cost=1.2e+07 flops=3.8e+07
 sigma_tot[gemm] counter=58 i=5 t=3.2e-01 per=1.4e+01 cost=1.2e+07 flops=3.8e+07
 sigma_tot[gemm] counter=58 i=6 t=2.8e-01 per=1.2e+01 cost=1.2e+07 flops=4.2e+07
 sigma_tot[gemm] counter=58 i=7 t=2.8e-01 per=1.2e+01 cost=1.2e+07 flops=4.4e+07
 sigma_tot[gemm] counter=58 total t=1.2e+00 per=5.2e+01 cost=4.8e+07 flops=4.0e+07
 sigma_tot[red] counter=58 t=6.2e-01 per=2.7e+01 cost=1.1e+07 flops=1.7e+07
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,6.9e-06,2.3e-06,1.1e-06,2.0e-07
settings: ndim=114 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.248461708954 -1.116e+03  6.701e-02    1     1  5.303e-02 5.303e-02 5.300e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.227e-04,1.014e-02,3.031e-02,1.048e-02,5.177e-02
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=8.163e-04 speed=2.081e-03GB/S T(nccl)=6.388e-06 speed=2.659e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=59 t=1.0e-02 per=2.0e+01 cost=8.1e+05 flops=8.0e+07
 sigma[gemm] counter=59 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=4 t=7.6e-03 per=1.5e+01 cost=2.2e+05 flops=2.9e+07
 sigma[gemm] counter=59 i=5 t=7.7e-03 per=1.5e+01 cost=2.3e+05 flops=3.0e+07
 sigma[gemm] counter=59 i=6 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=59 i=7 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=59 total t=3.0e-02 per=6.0e+01 cost=7.7e+05 flops=2.5e+07
 sigma[red] counter=59 t=1.0e-02 per=2.1e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=4.8e-01 t_gemm=1.2e+00 t_reduction=6.3e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=59 t=4.8e-01 per=2.1e+01 cost=6.2e+07 flops=1.3e+08
 sigma_tot[gemm] counter=59 i=0 t=1.3e-04 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=1.1e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=9.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=3 t=9.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=4 t=3.3e-01 per=1.4e+01 cost=1.2e+07 flops=3.8e+07
 sigma_tot[gemm] counter=59 i=5 t=3.3e-01 per=1.4e+01 cost=1.2e+07 flops=3.8e+07
 sigma_tot[gemm] counter=59 i=6 t=2.8e-01 per=1.2e+01 cost=1.2e+07 flops=4.1e+07
 sigma_tot[gemm] counter=59 i=7 t=2.9e-01 per=1.2e+01 cost=1.2e+07 flops=4.3e+07
 sigma_tot[gemm] counter=59 total t=1.2e+00 per=5.2e+01 cost=4.9e+07 flops=4.0e+07
 sigma_tot[red] counter=59 t=6.3e-01 per=2.7e+01 cost=1.1e+07 flops=1.7e+07
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,2.2e-05,1.4e-05,1.1e-06,2.1e-07
    2   0 -    -116.264421556857 -1.596e-02  2.513e-02    2     2  1.191e-01 5.953e-02 5.244e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.325e-03,1.013e-02,3.047e-02,1.051e-02,5.244e-02
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=1.320e-03 speed=1.287e-03GB/S T(nccl)=5.771e-06 speed=2.944e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=60 t=1.0e-02 per=2.0e+01 cost=8.1e+05 flops=8.0e+07
 sigma[gemm] counter=60 i=0 t=1.9e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=1.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=3 t=1.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=4 t=7.5e-03 per=1.5e+01 cost=2.2e+05 flops=2.9e+07
 sigma[gemm] counter=60 i=5 t=7.8e-03 per=1.5e+01 cost=2.3e+05 flops=2.9e+07
 sigma[gemm] counter=60 i=6 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=60 i=7 t=7.6e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=60 total t=3.0e-02 per=6.0e+01 cost=7.7e+05 flops=2.5e+07
 sigma[red] counter=60 t=1.1e-02 per=2.1e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=4.9e-01 t_gemm=1.3e+00 t_reduction=6.5e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=60 t=4.9e-01 per=2.1e+01 cost=6.3e+07 flops=1.3e+08
 sigma_tot[gemm] counter=60 i=0 t=1.3e-04 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=1.1e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=9.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=3 t=9.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=4 t=3.4e-01 per=1.4e+01 cost=1.3e+07 flops=3.8e+07
 sigma_tot[gemm] counter=60 i=5 t=3.4e-01 per=1.4e+01 cost=1.3e+07 flops=3.8e+07
 sigma_tot[gemm] counter=60 i=6 t=2.9e-01 per=1.2e+01 cost=1.2e+07 flops=4.1e+07
 sigma_tot[gemm] counter=60 i=7 t=2.9e-01 per=1.2e+01 cost=1.3e+07 flops=4.3e+07
 sigma_tot[gemm] counter=60 total t=1.3e+00 per=5.3e+01 cost=5.0e+07 flops=3.9e+07
 sigma_tot[red] counter=60 t=6.5e-01 per=2.7e+01 cost=1.1e+07 flops=1.7e+07
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,3.8e-05,3.3e-06,1.3e-06,2.2e-07
    3   0 -    -116.266390591391 -1.969e-03  9.422e-03    3     3  1.811e-01 6.037e-02 5.248e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.132e-03,9.969e-03,3.060e-02,1.054e-02,5.225e-02
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=1.126e-03 speed=1.508e-03GB/S T(nccl)=5.883e-06 speed=2.888e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.1e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=61 t=1.0e-02 per=2.0e+01 cost=8.1e+05 flops=8.1e+07
 sigma[gemm] counter=61 i=0 t=1.9e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=3 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=4 t=7.6e-03 per=1.5e+01 cost=2.2e+05 flops=2.9e+07
 sigma[gemm] counter=61 i=5 t=7.7e-03 per=1.5e+01 cost=2.3e+05 flops=2.9e+07
 sigma[gemm] counter=61 i=6 t=7.7e-03 per=1.5e+01 cost=1.6e+05 flops=2.0e+07
 sigma[gemm] counter=61 i=7 t=7.6e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=61 total t=3.1e-02 per=6.0e+01 cost=7.7e+05 flops=2.5e+07
 sigma[red] counter=61 t=1.1e-02 per=2.1e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=5.0e-01 t_gemm=1.3e+00 t_reduction=6.6e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=61 t=5.0e-01 per=2.0e+01 cost=6.3e+07 flops=1.3e+08
 sigma_tot[gemm] counter=61 i=0 t=1.4e-04 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=1.2e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=9.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=3 t=9.5e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=4 t=3.4e-01 per=1.4e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=61 i=5 t=3.5e-01 per=1.4e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=61 i=6 t=3.0e-01 per=1.2e+01 cost=1.2e+07 flops=4.0e+07
 sigma_tot[gemm] counter=61 i=7 t=3.0e-01 per=1.2e+01 cost=1.3e+07 flops=4.2e+07
 sigma_tot[gemm] counter=61 total t=1.3e+00 per=5.3e+01 cost=5.1e+07 flops=3.9e+07
 sigma_tot[red] counter=61 t=6.6e-01 per=2.7e+01 cost=1.1e+07 flops=1.7e+07
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,2.4e-05,3.3e-06,1.2e-06,1.9e-07
    4   0 -    -116.266651227099 -2.606e-04  4.244e-03    3     4  2.431e-01 6.077e-02 5.245e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.180e-03,1.015e-02,3.017e-02,9.737e-03,5.125e-02
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=1.175e-03 speed=1.446e-03GB/S T(nccl)=5.798e-06 speed=2.930e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=9.7e-03 tot=5.0e-02 -----
 sigma[inter] counter=62 t=1.0e-02 per=2.0e+01 cost=8.1e+05 flops=8.0e+07
 sigma[gemm] counter=62 i=0 t=1.8e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=1.6e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=3 t=1.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=4 t=7.5e-03 per=1.5e+01 cost=2.2e+05 flops=2.9e+07
 sigma[gemm] counter=62 i=5 t=7.6e-03 per=1.5e+01 cost=2.3e+05 flops=3.0e+07
 sigma[gemm] counter=62 i=6 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=62 i=7 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=62 total t=3.0e-02 per=6.0e+01 cost=7.7e+05 flops=2.6e+07
 sigma[red] counter=62 t=9.7e-03 per=1.9e+01 cost=1.9e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=5.1e-01 t_gemm=1.3e+00 t_reduction=6.7e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=62 t=5.1e-01 per=2.0e+01 cost=6.4e+07 flops=1.3e+08
 sigma_tot[gemm] counter=62 i=0 t=1.4e-04 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=1.2e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=9.7e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=3 t=9.7e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=4 t=3.5e-01 per=1.4e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=62 i=5 t=3.5e-01 per=1.4e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=62 i=6 t=3.1e-01 per=1.2e+01 cost=1.2e+07 flops=4.0e+07
 sigma_tot[gemm] counter=62 i=7 t=3.1e-01 per=1.2e+01 cost=1.3e+07 flops=4.1e+07
 sigma_tot[gemm] counter=62 total t=1.3e+00 per=5.3e+01 cost=5.1e+07 flops=3.9e+07
 sigma_tot[red] counter=62 t=6.7e-01 per=2.7e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.6e-05,3.4e-06,1.3e-06,2.2e-07
    5   0 -    -116.266697415709 -4.619e-05  1.196e-03    3     5  3.041e-01 6.081e-02 5.223e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.322e-03,1.016e-02,3.006e-02,1.036e-02,5.292e-02
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=2.305e-03 speed=7.370e-04GB/S T(nccl)=1.683e-05 speed=1.010e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=63 t=1.0e-02 per=2.0e+01 cost=8.1e+05 flops=8.0e+07
 sigma[gemm] counter=63 i=0 t=3.5e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=3.0e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=2.9e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=3 t=2.9e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=4 t=7.4e-03 per=1.5e+01 cost=2.2e+05 flops=3.0e+07
 sigma[gemm] counter=63 i=5 t=7.6e-03 per=1.5e+01 cost=2.3e+05 flops=3.0e+07
 sigma[gemm] counter=63 i=6 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=63 i=7 t=7.4e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=63 total t=3.0e-02 per=5.9e+01 cost=7.7e+05 flops=2.6e+07
 sigma[red] counter=63 t=1.0e-02 per=2.0e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=5.2e-01 t_gemm=1.4e+00 t_reduction=6.8e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=63 t=5.2e-01 per=2.0e+01 cost=6.5e+07 flops=1.2e+08
 sigma_tot[gemm] counter=63 i=0 t=1.4e-04 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=1.2e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=1.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=3 t=1.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=4 t=3.6e-01 per=1.4e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=63 i=5 t=3.6e-01 per=1.4e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=63 i=6 t=3.2e-01 per=1.2e+01 cost=1.2e+07 flops=3.9e+07
 sigma_tot[gemm] counter=63 i=7 t=3.2e-01 per=1.2e+01 cost=1.3e+07 flops=4.1e+07
 sigma_tot[gemm] counter=63 total t=1.4e+00 per=5.3e+01 cost=5.2e+07 flops=3.9e+07
 sigma_tot[red] counter=63 t=6.8e-01 per=2.7e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=1.1e-04 T(gemm/eig/ortho/gemm/axpy)=2.8e-05,6.9e-05,1.1e-05,2.1e-06,4.6e-07
    6   0 -    -116.266700925753 -3.510e-06  3.469e-04    3     6  3.704e-01 6.173e-02 5.238e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.408e-03,1.006e-02,2.985e-02,1.043e-02,5.653e-02
 analyze_tgpu[Hx]: ndim=114:8.494e-07GB T(cpu-gpu)=1.401e-03 speed=1.213e-03GB/S T(nccl)=7.276e-06 speed=2.335e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=64 t=1.0e-02 per=2.0e+01 cost=8.1e+05 flops=8.1e+07
 sigma[gemm] counter=64 i=0 t=4.6e-06 per=9.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=3.7e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=3.5e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=3 t=3.5e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=4 t=7.4e-03 per=1.5e+01 cost=2.2e+05 flops=3.0e+07
 sigma[gemm] counter=64 i=5 t=7.6e-03 per=1.5e+01 cost=2.3e+05 flops=3.0e+07
 sigma[gemm] counter=64 i=6 t=7.4e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=64 i=7 t=7.4e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=64 total t=3.0e-02 per=5.9e+01 cost=7.7e+05 flops=2.6e+07
 sigma[red] counter=64 t=1.0e-02 per=2.1e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=5.3e-01 t_gemm=1.4e+00 t_reduction=6.9e-01 tot=2.6e+00 -----
 sigma_tot[inter] counter=64 t=5.3e-01 per=2.0e+01 cost=6.6e+07 flops=1.2e+08
 sigma_tot[gemm] counter=64 i=0 t=1.5e-04 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=1.2e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=1.0e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=3 t=1.0e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=4 t=3.7e-01 per=1.4e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=64 i=5 t=3.7e-01 per=1.4e+01 cost=1.4e+07 flops=3.7e+07
 sigma_tot[gemm] counter=64 i=6 t=3.2e-01 per=1.2e+01 cost=1.3e+07 flops=3.9e+07
 sigma_tot[gemm] counter=64 i=7 t=3.2e-01 per=1.2e+01 cost=1.3e+07 flops=4.1e+07
 sigma_tot[gemm] counter=64 total t=1.4e+00 per=5.3e+01 cost=5.3e+07 flops=3.8e+07
 sigma_tot[red] counter=64 t=6.9e-01 per=2.6e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,2.6e-05,5.7e-06,2.3e-06,5.3e-07
    7   0 +    -116.266701220275 -2.945e-07  9.912e-05    3     7  4.399e-01 6.285e-02 5.301e-02
TIMING FOR Davidson : 4.400e-01  T(cal/comm/rest)=3.710e-01,1.386e-06,6.892e-02
decomposed t_rest=6.892e-02
 T(sub)    =3.164e-04 per=4.590e-01
 T(precond)=6.371e-02 per=9.243e+01
 T(ortho)  =4.409e-05 per=6.396e-02
 T(xcopy)  =4.221e-06 per=6.124e-03
 T(xnrm2)  =4.268e-06 per=6.192e-03
 T(other)  =4.849e-03 per=7.035e+00
optimized energies: isweep=0 ibond=9 dots=2 e[0]=-116.266701220275 nmvp=7
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=7.309e-03 change=4.512e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=12 dimAll=40
 (15,1):5 (17,1):4 (16,0):4 (16,2):8 (15,3):5 (17,3):3 (16,4):5 (14,2):1 (14,4):1 (15,5):2 (17,5):1 (16,6):1
timing for divide=1.8e-04
timing for compute=1.9e-02
timing for collect=2.6e-05
----- TMING FOR decimation_genbasis(su2): 1.9e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.8e-04,1.9e-02,0.0e+00,1.0e-05,2.6e-05 -----
decimation summary: 40->10 dwt=+1.232e-03 SvN=1.012e+00
 qbond: qkept nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
----- TIMING for decimation_row(nkr): 1.977e-02 S T(decim/select/formRot)=1.922e-02,4.231e-04,1.318e-04 -----
----- TIMING FOR twodot_decimation: 2.093e-02 S T(wf/decim)=1.141e-03,1.979e-02 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=4935:3.765e-02MB:3.677e-05GB
        per(mem): H:0.689 C:3.57 S:2.92 P:1.64 Q:91.2 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=7.301e-03 change=2.805e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=192 : 9.614e-03 S -----
rank=0 GPUmem(GB): used=1.314e-04 (oper)=8.211e-05
rank=0 GPUmem(GB): used=1.318e-04 (oper,site)=8.211e-05,4.470e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=192
 no. of rintermediate operators=288
 no. of coefficients=2880:2.197e-02MB:2.146e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.463e-03 S -----
rank=0 GPUmem(GB): used=1.533e-04 (oper,site,rinter)=8.211e-05,4.470e-07,2.146e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.282e-02 S size(rtasks)=192 size(Rlst2)=16 T(Rmu/Rlist)=2.688e-03,6.013e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.376e-02 S size(rtasks)=192 size(Rlst)=4492 -----
rank=0 GPUmem(GB): used=1.533e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.238e-03 blksize=16 blksize0=4 batchsize=4492
rank=0 GPUmem(GB): used=1.392e-03 (oper,site,rinter,batch)=8.211e-05,4.470e-07,2.146e-05,1.238e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.749e-03,2.264e-02,1.009e-02
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=10 t=6.7e-03 per=1.7e+01 cost=9.0e+04 flops=1.3e+07
 renorm[gemm] counter=10 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=3 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=4 t=7.5e-03 per=1.9e+01 cost=2.2e+04 flops=2.9e+06
 renorm[gemm] counter=10 i=5 t=7.5e-03 per=1.9e+01 cost=7.5e+04 flops=1.0e+07
 renorm[gemm] counter=10 i=6 t=7.6e-03 per=1.9e+01 cost=2.0e+05 flops=2.6e+07
 renorm[gemm] counter=10 total t=2.3e-02 per=5.7e+01 cost=3.0e+05 flops=1.3e+07
 renorm[red] counter=10 t=1.0e-02 per=2.6e+01 cost=9.2e+04 flops=9.1e+06
----- TIMING FOR renorm_tot : t_inter=5.7e-02 t_gemm=2.2e-01 t_reduction=1.0e-01 tot=3.8e-01 -----
 renorm_tot[inter] counter=10 t=5.7e-02 per=1.5e+01 cost=9.8e+05 flops=1.7e+07
 renorm_tot[gemm] counter=10 i=0 t=1.6e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=1.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=3 t=1.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=4 t=7.4e-02 per=1.9e+01 cost=1.3e+05 flops=1.8e+06
 renorm_tot[gemm] counter=10 i=5 t=7.5e-02 per=2.0e+01 cost=3.7e+05 flops=4.9e+06
 renorm_tot[gemm] counter=10 i=6 t=7.6e-02 per=2.0e+01 cost=6.2e+05 flops=8.2e+06
 renorm_tot[gemm] counter=10 total t=2.2e-01 per=5.9e+01 cost=1.1e+06 flops=5.0e+06
 renorm_tot[red] counter=10 t=1.0e-01 per=2.6e+01 cost=2.6e+05 flops=2.6e+06
qops.to_cpu: size(tot)=4935:3.8e-02MB:3.7e-05GB T(to_cpu)=2.0e-04S speed=1.9e-01GB/S
check ||H-H.dagger||=6.544e-15 coord=(10,0) rank=0
----- TIMING FOR oper_renorm : 0.157 S rank=0 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=6.989e-03 change=1.431e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=8.064e-03 change=-2.837e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=8.072e-03 change=-3.546e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.074e+00 S #####
 T(local opt: fetch) = 1.077e-02 S  per = 0.519  per(accum) = 0.519
 T(local opt: hdiag) = 1.013e+00 S  per = 48.8  per(accum) = 49.3
 T(local opt: dvdsn) = 8.672e-01 S  per = 41.8  per(accum) = 91.2
 T(local opt: decim) = 2.096e-02 S  per = 1.01  per(accum) = 92.2
 T(local opt: guess) = 1.200e-03 S  per = 0.0579  per(accum) = 92.2
 T(local opt: renrm) = 1.610e-01 S  per = 7.76  per(accum) = 100
 T(local opt: save ) = 4.017e-04 S  per = 0.0194  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.672e-01 S  T(sum) = 8.649e-01 S  per = 9.973e+01
 T(local opt: preprocess                  ) = 3.739e-03 S  per = 0.432  per(accum) = 0.432
 T(local opt: symbolic_formulae           ) = 1.235e-02 S  per = 1.43  per(accum) = 1.86
 T(local opt: hintermediate init          ) = 4.443e-04 S  per = 0.0514  per(accum) = 1.91
 T(local opt: preprocess_hformulae_Hxlist ) = 2.956e-01 S  per = 34.2  per(accum) = 36.1
 T(local opt: hmmtasks init               ) = 1.118e-01 S  per = 12.9  per(accum) = 49
 T(local opt: initial guess for dvdson    ) = 1.089e-03 S  per = 0.126  per(accum) = 49.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.611e-01 S  per = 41.7  per(accum) = 90.9
 T(local opt: dvdson [cpu-gpu]            ) = 9.934e-03 S  per = 1.15  per(accum) = 92
 T(local opt: dvdson [nccl]               ) = 5.705e-05 S  per = 0.0066  per(accum) = 92
 T(local opt: dvdson [mpi]                ) = 1.386e-06 S  per = 0.00016  per(accum) = 92
 T(local opt: dvdson [rest part(linalg)]  ) = 6.892e-02 S  per = 7.97  per(accum) = 100
Detailed decomposition of T(renrm) = 1.610e-01 S  T(sum) = 1.610e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.265e-04 S  per = 0.203  per(accum) = 0.203
 T(local opt: qops init                    ) = 5.791e-03 S  per =  3.6  per(accum) = 3.8
 T(local opt: symbolic_formulae_renorm     ) = 9.631e-03 S  per = 5.98  per(accum) = 9.78
 T(local opt: allocate qops on gpu         ) = 6.886e-05 S  per = 0.0428  per(accum) = 9.83
 T(local opt: site memcpy cpu2gpu          ) = 1.762e-03 S  per = 1.09  per(accum) = 10.9
 T(local opt: rintermediate init           ) = 2.478e-03 S  per = 1.54  per(accum) = 12.5
 T(local opt: preprocess_formulae_Rlist2   ) = 6.393e-02 S  per = 39.7  per(accum) = 52.2
 T(local opt: rmmtasks init                ) = 3.365e-02 S  per = 20.9  per(accum) = 73.1
 T(local opt: qops memset on cpu           ) = 3.700e-08 S  per = 2.3e-05  per(accum) = 73.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.956e-02 S  per = 24.6  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 1.930e-04 S  per = 0.12  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 2.61e-05  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 2.36e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 2.067e-04 S  per = 0.128  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 4.398e-05 S  per = 0.0273  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 3.309e-03 S  per = 2.06  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.925e-06 S  per = 0.00554  per(accum) = 100
##### sweep opt: 1.441e+01 S #####
 T(sweep opt: fetch) = 1.786e-01 S  per = 1.24  per(accum) = 1.24
 T(sweep opt: hdiag) = 5.897e+00 S  per = 40.9  per(accum) = 42.2
 T(sweep opt: dvdsn) = 7.191e+00 S  per = 49.9  per(accum) = 92
 T(sweep opt: decim) = 1.402e-01 S  per = 0.973  per(accum) = 93
 T(sweep opt: guess) = 1.434e-02 S  per = 0.0995  per(accum) = 93.1
 T(sweep opt: renrm) = 9.888e-01 S  per = 6.86  per(accum) = 100
 T(sweep opt: save ) = 3.596e-03 S  per = 0.025  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.191e+00 S  T(sum) = 7.180e+00 S  per = 9.984e+01
 T(sweep opt: preprocess                  ) = 6.440e-02 S  per = 0.897  per(accum) = 0.897
 T(sweep opt: symbolic_formulae           ) = 8.225e-02 S  per = 1.15  per(accum) = 2.04
 T(sweep opt: hintermediate init          ) = 3.124e-03 S  per = 0.0435  per(accum) = 2.09
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.650e+00 S  per = 36.9  per(accum) = 39
 T(sweep opt: hmmtasks init               ) = 1.004e+00 S  per =   14  per(accum) = 53
 T(sweep opt: initial guess for dvdson    ) = 1.573e-02 S  per = 0.219  per(accum) = 53.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.614e+00 S  per = 36.4  per(accum) = 89.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 8.274e-02 S  per = 1.15  per(accum) = 90.8
 T(sweep opt: dvdson [nccl]               ) = 4.438e-04 S  per = 0.00618  per(accum) = 90.8
 T(sweep opt: dvdson [mpi]                ) = 1.084e-05 S  per = 0.000151  per(accum) = 90.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.627e-01 S  per = 9.23  per(accum) = 100
Detailed decomposition of T(renrm) = 9.888e-01 S  T(sum) = 9.888e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.604e-03 S  per = 0.263  per(accum) = 0.263
 T(sweep opt: qops init                    ) = 3.920e-02 S  per = 3.96  per(accum) = 4.23
 T(sweep opt: symbolic_formulae_renorm     ) = 4.111e-02 S  per = 4.16  per(accum) = 8.38
 T(sweep opt: allocate qops on gpu         ) = 6.315e-04 S  per = 0.0639  per(accum) = 8.45
 T(sweep opt: site memcpy cpu2gpu          ) = 1.265e-02 S  per = 1.28  per(accum) = 9.73
 T(sweep opt: rintermediate init           ) = 2.572e-02 S  per =  2.6  per(accum) = 12.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.753e-01 S  per = 27.8  per(accum) = 40.2
 T(sweep opt: rmmtasks init                ) = 1.404e-01 S  per = 14.2  per(accum) = 54.4
 T(sweep opt: qops memset on cpu           ) = 4.240e-07 S  per = 4.29e-05  per(accum) = 54.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.827e-01 S  per = 38.7  per(accum) = 93.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.169e-03 S  per = 0.118  per(accum) = 93.2
 T(sweep opt: construct opS [ifdists=true] ) = 6.090e-07 S  per = 6.16e-05  per(accum) = 93.2
 T(sweep opt: reduction of opS & opH [nccl]) = 4.240e-07 S  per = 4.29e-05  per(accum) = 93.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.277e-03 S  per = 0.129  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.309e-04 S  per = 0.0436  per(accum) = 93.4
 T(sweep opt: qops_pool join and erase     ) = 3.331e-02 S  per = 3.37  per(accum) = 96.7
 T(sweep opt: conversion from opAB to opPQ ) = 3.238e-02 S  per = 3.27  per(accum) = 100
##### global opt: 1.441e+01 S #####
 T(global opt: fetch) = 1.786e-01 S  per = 1.24  per(accum) = 1.24
 T(global opt: hdiag) = 5.897e+00 S  per = 40.9  per(accum) = 42.2
 T(global opt: dvdsn) = 7.191e+00 S  per = 49.9  per(accum) = 92
 T(global opt: decim) = 1.402e-01 S  per = 0.973  per(accum) = 93
 T(global opt: guess) = 1.434e-02 S  per = 0.0995  per(accum) = 93.1
 T(global opt: renrm) = 9.888e-01 S  per = 6.86  per(accum) = 100
 T(global opt: save ) = 3.596e-03 S  per = 0.025  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.191e+00 S  T(sum) = 7.180e+00 S  per = 9.984e+01
 T(global opt: preprocess                  ) = 6.440e-02 S  per = 0.897  per(accum) = 0.897
 T(global opt: symbolic_formulae           ) = 8.225e-02 S  per = 1.15  per(accum) = 2.04
 T(global opt: hintermediate init          ) = 3.124e-03 S  per = 0.0435  per(accum) = 2.09
 T(global opt: preprocess_hformulae_Hxlist ) = 2.650e+00 S  per = 36.9  per(accum) = 39
 T(global opt: hmmtasks init               ) = 1.004e+00 S  per =   14  per(accum) = 53
 T(global opt: initial guess for dvdson    ) = 1.573e-02 S  per = 0.219  per(accum) = 53.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.614e+00 S  per = 36.4  per(accum) = 89.6
 T(global opt: dvdson [cpu-gpu]            ) = 8.274e-02 S  per = 1.15  per(accum) = 90.8
 T(global opt: dvdson [nccl]               ) = 4.438e-04 S  per = 0.00618  per(accum) = 90.8
 T(global opt: dvdson [mpi]                ) = 1.084e-05 S  per = 0.000151  per(accum) = 90.8
 T(global opt: dvdson [rest part(linalg)]  ) = 6.627e-01 S  per = 9.23  per(accum) = 100
Detailed decomposition of T(renrm) = 9.888e-01 S  T(sum) = 9.888e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.604e-03 S  per = 0.263  per(accum) = 0.263
 T(global opt: qops init                    ) = 3.920e-02 S  per = 3.96  per(accum) = 4.23
 T(global opt: symbolic_formulae_renorm     ) = 4.111e-02 S  per = 4.16  per(accum) = 8.38
 T(global opt: allocate qops on gpu         ) = 6.315e-04 S  per = 0.0639  per(accum) = 8.45
 T(global opt: site memcpy cpu2gpu          ) = 1.265e-02 S  per = 1.28  per(accum) = 9.73
 T(global opt: rintermediate init           ) = 2.572e-02 S  per =  2.6  per(accum) = 12.3
 T(global opt: preprocess_formulae_Rlist2   ) = 2.753e-01 S  per = 27.8  per(accum) = 40.2
 T(global opt: rmmtasks init                ) = 1.404e-01 S  per = 14.2  per(accum) = 54.4
 T(global opt: qops memset on cpu           ) = 4.240e-07 S  per = 4.29e-05  per(accum) = 54.4
 T(global opt: preprocess_renorm_batchGPU   ) = 3.827e-01 S  per = 38.7  per(accum) = 93.1
 T(global opt: deallocate cpu and gpu memory) = 1.169e-03 S  per = 0.118  per(accum) = 93.2
 T(global opt: construct opS [ifdists=true] ) = 6.090e-07 S  per = 6.16e-05  per(accum) = 93.2
 T(global opt: reduction of opS & opH [nccl]) = 4.240e-07 S  per = 4.29e-05  per(accum) = 93.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.277e-03 S  per = 0.129  per(accum) = 93.3
 T(global opt: reduction of opS & opH [mpi] ) = 4.309e-04 S  per = 0.0436  per(accum) = 93.4
 T(global opt: qops_pool join and erase     ) = 3.331e-02 S  per = 3.37  per(accum) = 96.7
 T(global opt: conversion from opAB to opPQ ) = 3.238e-02 S  per = 3.27  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-4.485e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=10/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=518:3.952e-03MB:3.859e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=50:3.815e-04MB:3.725e-07GB
total mem of comb=569:4.341e-03MB:4.239e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=4935:3.765e-02MB:3.677e-05GB
        per(mem): H:0.689 C:3.57 S:2.92 P:1.64 Q:91.2 
 rqops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=1068:0.00815MB:7.96e-06GB
        per(mem): H:1.12 C:5.24 S:9.74 A:0 B:83.9 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=7999:0.061MB:5.96e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.361e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-8.166e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,6,3,3) nnz=66:5.035e-04MB
qtensor4: wf4 own=1 _data=0x3a63d200
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
 qbond: qcol nsym=3 dimAll=6
 (10,2):2 (10,4):2 (11,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=192 size=66:5.035e-04MB
### DIAG TIMING: total=8.068e-01 t1=3.874e-05, t2=1.800e-03, t3=2.492e-03, t4=8.024e-01, t5=8.299e-06, t6=3.511e-05, t7=8.763e-06
duration_diagGPU:8.068e-01
duration_diagreduce:4.411e-06
duration_diagtransform:1.071e-06
----- TIMING FOR symbolic_formulae_twodot with size=704 : 1.273e-02 S -----
rank=0 GPUmem(GB): used=5.960e-05 (oper)=5.960e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=704
 no. of hintermediate operators=333
 no. of coefficients=4876:3.720e-02MB:3.633e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.359e-04 S -----
rank=0 GPUmem(GB): used=9.593e-05 (oper,hinter)=5.960e-05,3.633e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.735e-01 S size(H_formulae)=704 size(Hxlst2)=15 T(Hmu/Hxlist)=2.527e-03,1.709e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.753e-01 S size(H_formulae)=704 size(Hxlst)=10000 -----
rank=0 GPUmem(GB): used=9.593e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=9.835e-07 batch[need]=1.565e-03 blksize=8 blksize0=4 batchsize=10000
rank=0 GPUmem(GB): used=1.662e-03 (oper,hinter,dvdson,batch)=5.960e-05,3.633e-05,9.835e-07,1.565e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=66 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.030e-03,1.016e-02,3.032e-02,1.013e-02,5.265e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.022e-03 speed=4.864e-04GB/S T(nccl)=7.735e-06 speed=1.271e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=65 t=1.0e-02 per=2.0e+01 cost=5.2e+05 flops=5.1e+07
 sigma[gemm] counter=65 i=0 t=1.5e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=5.7e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=4 t=7.5e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=65 i=5 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=65 i=6 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=65 i=7 t=7.5e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=65 total t=3.0e-02 per=6.0e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=65 t=1.0e-02 per=2.0e+01 cost=9.2e+04 flops=9.0e+06
----- TIMING FOR sigma_tot : t_inter=5.4e-01 t_gemm=1.4e+00 t_reduction=7.0e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=65 t=5.4e-01 per=2.0e+01 cost=6.6e+07 flops=1.2e+08
 sigma_tot[gemm] counter=65 i=0 t=1.5e-04 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=1.3e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=1.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=3 t=1.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=4 t=3.7e-01 per=1.4e+01 cost=1.4e+07 flops=3.6e+07
 sigma_tot[gemm] counter=65 i=5 t=3.8e-01 per=1.4e+01 cost=1.4e+07 flops=3.6e+07
 sigma_tot[gemm] counter=65 i=6 t=3.3e-01 per=1.2e+01 cost=1.3e+07 flops=3.8e+07
 sigma_tot[gemm] counter=65 i=7 t=3.3e-01 per=1.3e+01 cost=1.3e+07 flops=4.0e+07
 sigma_tot[gemm] counter=65 total t=1.4e+00 per=5.3e+01 cost=5.3e+07 flops=3.8e+07
 sigma_tot[red] counter=65 t=7.0e-01 per=2.6e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,5.9e-06,2.2e-06,1.2e-06,2.0e-07
settings: ndim=66 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.265955787654 -1.116e+03  6.723e-02    1     1  5.279e-02 5.279e-02 5.276e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.121e-03,1.019e-02,3.020e-02,1.037e-02,5.289e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.115e-03 speed=4.650e-04GB/S T(nccl)=6.053e-06 speed=1.625e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=66 t=1.0e-02 per=2.0e+01 cost=5.2e+05 flops=5.1e+07
 sigma[gemm] counter=66 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=4 t=7.5e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=66 i=5 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=66 i=6 t=7.5e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=66 i=7 t=7.5e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=66 total t=3.0e-02 per=5.9e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=66 t=1.0e-02 per=2.0e+01 cost=9.2e+04 flops=8.8e+06
----- TIMING FOR sigma_tot : t_inter=5.5e-01 t_gemm=1.4e+00 t_reduction=7.1e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=66 t=5.5e-01 per=2.0e+01 cost=6.7e+07 flops=1.2e+08
 sigma_tot[gemm] counter=66 i=0 t=1.5e-04 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=1.3e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=1.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=3 t=1.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=4 t=3.8e-01 per=1.4e+01 cost=1.4e+07 flops=3.6e+07
 sigma_tot[gemm] counter=66 i=5 t=3.8e-01 per=1.4e+01 cost=1.4e+07 flops=3.6e+07
 sigma_tot[gemm] counter=66 i=6 t=3.4e-01 per=1.2e+01 cost=1.3e+07 flops=3.8e+07
 sigma_tot[gemm] counter=66 i=7 t=3.4e-01 per=1.3e+01 cost=1.3e+07 flops=3.9e+07
 sigma_tot[gemm] counter=66 total t=1.4e+00 per=5.3e+01 cost=5.4e+07 flops=3.7e+07
 sigma_tot[red] counter=66 t=7.1e-01 per=2.6e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.0e-06,1.9e-05,3.6e-06,1.0e-05,2.3e-07
    2   0 -    -116.283268563121 -1.731e-02  1.917e-02    2     2  1.228e-01 6.141e-02 5.288e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.544e-04,1.003e-02,3.032e-02,1.043e-02,5.114e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=3.494e-04 speed=2.815e-03GB/S T(nccl)=5.025e-06 speed=1.957e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=67 t=1.0e-02 per=2.0e+01 cost=5.2e+05 flops=5.2e+07
 sigma[gemm] counter=67 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=3 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=4 t=7.6e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=67 i=5 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=67 i=6 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=67 i=7 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=67 total t=3.0e-02 per=6.0e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=67 t=1.0e-02 per=2.1e+01 cost=9.2e+04 flops=8.8e+06
----- TIMING FOR sigma_tot : t_inter=5.6e-01 t_gemm=1.5e+00 t_reduction=7.2e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=67 t=5.6e-01 per=2.0e+01 cost=6.7e+07 flops=1.2e+08
 sigma_tot[gemm] counter=67 i=0 t=1.5e-04 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=1.3e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=1.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=3 t=1.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=4 t=3.9e-01 per=1.4e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=67 i=5 t=3.9e-01 per=1.4e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=67 i=6 t=3.5e-01 per=1.3e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=67 i=7 t=3.5e-01 per=1.3e+01 cost=1.3e+07 flops=3.9e+07
 sigma_tot[gemm] counter=67 total t=1.5e+00 per=5.3e+01 cost=5.4e+07 flops=3.7e+07
 sigma_tot[red] counter=67 t=7.2e-01 per=2.6e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,2.1e-05,3.1e-06,1.1e-05,2.2e-07
    3   0 -    -116.284692016057 -1.423e-03  9.291e-03    3     3  1.866e-01 6.219e-02 5.234e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.268e-03,1.017e-02,3.020e-02,7.460e-03,5.010e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.263e-03 speed=4.346e-04GB/S T(nccl)=4.977e-06 speed=1.976e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=7.5e-03 tot=4.8e-02 -----
 sigma[inter] counter=68 t=1.0e-02 per=2.1e+01 cost=5.2e+05 flops=5.1e+07
 sigma[gemm] counter=68 i=0 t=1.5e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=3 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=4 t=7.5e-03 per=1.6e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=68 i=5 t=7.6e-03 per=1.6e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=68 i=6 t=7.5e-03 per=1.6e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=68 i=7 t=7.6e-03 per=1.6e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=68 total t=3.0e-02 per=6.3e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=68 t=7.5e-03 per=1.6e+01 cost=9.2e+04 flops=1.2e+07
----- TIMING FOR sigma_tot : t_inter=5.7e-01 t_gemm=1.5e+00 t_reduction=7.2e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=68 t=5.7e-01 per=2.0e+01 cost=6.8e+07 flops=1.2e+08
 sigma_tot[gemm] counter=68 i=0 t=1.5e-04 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=1.3e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=1.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=3 t=1.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=4 t=4.0e-01 per=1.4e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=68 i=5 t=4.0e-01 per=1.4e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=68 i=6 t=3.5e-01 per=1.3e+01 cost=1.3e+07 flops=3.7e+07
 sigma_tot[gemm] counter=68 i=7 t=3.5e-01 per=1.3e+01 cost=1.4e+07 flops=3.8e+07
 sigma_tot[gemm] counter=68 total t=1.5e+00 per=5.4e+01 cost=5.4e+07 flops=3.6e+07
 sigma_tot[red] counter=68 t=7.2e-01 per=2.6e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.0e-06,1.0e-06,2.2e-07
    4   0 -    -116.284939065654 -2.470e-04  3.261e-03    3     4  2.495e-01 6.238e-02 5.180e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.511e-04,1.015e-02,2.994e-02,1.011e-02,5.097e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=7.461e-04 speed=1.318e-03GB/S T(nccl)=5.001e-06 speed=1.967e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=69 t=1.0e-02 per=2.0e+01 cost=5.2e+05 flops=5.1e+07
 sigma[gemm] counter=69 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=3 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=4 t=7.4e-03 per=1.5e+01 cost=8.6e+04 flops=1.2e+07
 sigma[gemm] counter=69 i=5 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=69 i=6 t=7.4e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=69 i=7 t=7.5e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=69 total t=3.0e-02 per=6.0e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=69 t=1.0e-02 per=2.0e+01 cost=9.2e+04 flops=9.0e+06
----- TIMING FOR sigma_tot : t_inter=5.8e-01 t_gemm=1.5e+00 t_reduction=7.4e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=69 t=5.8e-01 per=2.0e+01 cost=6.8e+07 flops=1.2e+08
 sigma_tot[gemm] counter=69 i=0 t=1.5e-04 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=1.4e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=3 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=4 t=4.0e-01 per=1.4e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=69 i=5 t=4.1e-01 per=1.4e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=69 i=6 t=3.6e-01 per=1.3e+01 cost=1.3e+07 flops=3.6e+07
 sigma_tot[gemm] counter=69 i=7 t=3.6e-01 per=1.3e+01 cost=1.4e+07 flops=3.8e+07
 sigma_tot[gemm] counter=69 total t=1.5e+00 per=5.4e+01 cost=5.5e+07 flops=3.6e+07
 sigma_tot[red] counter=69 t=7.4e-01 per=2.6e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.0e-06,1.0e-06,2.5e-07
    5   0 -    -116.284965677036 -2.661e-05  8.213e-04    3     5  3.128e-01 6.257e-02 5.166e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.372e-03,9.995e-03,2.986e-02,1.012e-02,5.135e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=1.366e-03 speed=7.197e-04GB/S T(nccl)=5.016e-06 speed=1.961e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=70 t=1.0e-02 per=2.0e+01 cost=5.2e+05 flops=5.2e+07
 sigma[gemm] counter=70 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=3 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=4 t=7.5e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=70 i=5 t=7.6e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=70 i=6 t=7.4e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=70 i=7 t=7.4e-03 per=1.5e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=70 total t=3.0e-02 per=6.0e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=70 t=1.0e-02 per=2.0e+01 cost=9.2e+04 flops=9.0e+06
----- TIMING FOR sigma_tot : t_inter=5.9e-01 t_gemm=1.6e+00 t_reduction=7.5e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=70 t=5.9e-01 per=2.0e+01 cost=6.9e+07 flops=1.2e+08
 sigma_tot[gemm] counter=70 i=0 t=1.6e-04 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=1.4e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=3 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=4 t=4.1e-01 per=1.4e+01 cost=1.4e+07 flops=3.4e+07
 sigma_tot[gemm] counter=70 i=5 t=4.1e-01 per=1.4e+01 cost=1.4e+07 flops=3.4e+07
 sigma_tot[gemm] counter=70 i=6 t=3.7e-01 per=1.3e+01 cost=1.3e+07 flops=3.6e+07
 sigma_tot[gemm] counter=70 i=7 t=3.7e-01 per=1.3e+01 cost=1.4e+07 flops=3.7e+07
 sigma_tot[gemm] counter=70 total t=1.6e+00 per=5.4e+01 cost=5.5e+07 flops=3.5e+07
 sigma_tot[red] counter=70 t=7.5e-01 per=2.6e+01 cost=1.2e+07 flops=1.7e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.0e-06,1.0e-06,2.6e-07
    6   0 -    -116.284967142752 -1.466e-06  2.087e-04    3     6  3.757e-01 6.262e-02 5.162e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.603e-04,1.369e-02,3.072e-02,1.008e-02,5.486e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=3.505e-04 speed=2.806e-03GB/S T(nccl)=9.774e-06 speed=1.006e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=3.1e-02 t_reduction=1.0e-02 tot=5.4e-02 -----
 sigma[inter] counter=71 t=1.4e-02 per=2.5e+01 cost=5.2e+05 flops=3.8e+07
 sigma[gemm] counter=71 i=0 t=3.5e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=3 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=4 t=8.0e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=71 i=5 t=7.6e-03 per=1.4e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=71 i=6 t=7.6e-03 per=1.4e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=71 i=7 t=7.5e-03 per=1.4e+01 cost=8.2e+04 flops=1.1e+07
 sigma[gemm] counter=71 total t=3.1e-02 per=5.6e+01 cost=3.3e+05 flops=1.1e+07
 sigma[red] counter=71 t=1.0e-02 per=1.9e+01 cost=9.2e+04 flops=9.1e+06
----- TIMING FOR sigma_tot : t_inter=6.1e-01 t_gemm=1.6e+00 t_reduction=7.6e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=71 t=6.1e-01 per=2.1e+01 cost=7.0e+07 flops=1.1e+08
 sigma_tot[gemm] counter=71 i=0 t=1.6e-04 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=1.4e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=3 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=4 t=4.2e-01 per=1.4e+01 cost=1.4e+07 flops=3.4e+07
 sigma_tot[gemm] counter=71 i=5 t=4.2e-01 per=1.4e+01 cost=1.4e+07 flops=3.4e+07
 sigma_tot[gemm] counter=71 i=6 t=3.8e-01 per=1.3e+01 cost=1.3e+07 flops=3.5e+07
 sigma_tot[gemm] counter=71 i=7 t=3.8e-01 per=1.3e+01 cost=1.4e+07 flops=3.6e+07
 sigma_tot[gemm] counter=71 total t=1.6e+00 per=5.4e+01 cost=5.5e+07 flops=3.5e+07
 sigma_tot[red] counter=71 t=7.6e-01 per=2.6e+01 cost=1.3e+07 flops=1.7e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.0e-06,1.1e-06,2.3e-07
    7   0 +    -116.284967260831 -1.181e-07  7.495e-05    3     7  4.433e-01 6.333e-02 5.210e-02
TIMING FOR Davidson : 4.433e-01  T(cal/comm/rest)=3.647e-01,8.960e-07,7.857e-02
decomposed t_rest=7.857e-02
 T(sub)    =1.826e-04 per=2.324e-01
 T(precond)=7.819e-02 per=9.951e+01
 T(ortho)  =2.467e-05 per=3.139e-02
 T(xcopy)  =1.228e-06 per=1.563e-03
 T(xnrm2)  =3.111e-06 per=3.960e-03
 T(other)  =1.706e-04 per=2.172e-01
optimized energies: isweep=0 ibond=10 dots=2 e[0]=-116.284967260831 nmvp=7
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=3.403e-03 change=2.915e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=9 dimAll=40
 (16,2):5 (18,2):5 (17,1):4 (17,3):10 (16,4):5 (18,4):5 (17,5):4 (15,3):1 (19,3):1
timing for divide=7.8e-05
timing for compute=1.2e-02
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=7.8e-05,1.2e-02,0.0e+00,7.9e-06,1.9e-05 -----
decimation summary: 40->10 dwt=+7.393e-07 SvN=7.321e-01
 qbond: qkept nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
----- TIMING for decimation_row(nkr): 1.287e-02 S T(decim/select/formRot)=1.242e-02,3.787e-04,7.114e-05 -----
----- TIMING FOR twodot_decimation: 1.329e-02 S T(wf/decim)=4.140e-04,1.288e-02 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=3602:2.748e-02MB:2.684e-05GB
        per(mem): H:0.833 C:7 S:4.66 P:3.55 Q:84 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=3.403e-03 change=2.308e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=157 : 6.973e-03 S -----
rank=0 GPUmem(GB): used=1.148e-04 (oper)=7.104e-05
rank=0 GPUmem(GB): used=1.152e-04 (oper,site)=7.104e-05,4.172e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=157
 no. of rintermediate operators=232
 no. of coefficients=2552:1.947e-02MB:1.901e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.491e-03 S -----
rank=0 GPUmem(GB): used=1.342e-04 (oper,site,rinter)=7.104e-05,4.172e-07,1.901e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.662e-02 S size(rtasks)=157 size(Rlst2)=16 T(Rmu/Rlist)=1.706e-03,3.491e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.723e-02 S size(rtasks)=157 size(Rlst)=3274 -----
rank=0 GPUmem(GB): used=1.342e-04 avail=6.174e+00 total=6.174e+00 batch[need]=9.025e-04 blksize=16 blksize0=4 batchsize=3274
rank=0 GPUmem(GB): used=1.037e-03 (oper,site,rinter,batch)=7.104e-05,4.172e-07,1.901e-05,9.025e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.551e-03,2.264e-02,9.981e-03
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=11 t=6.6e-03 per=1.7e+01 cost=1.1e+05 flops=1.7e+07
 renorm[gemm] counter=11 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=4 t=7.5e-03 per=1.9e+01 cost=2.2e+04 flops=3.0e+06
 renorm[gemm] counter=11 i=5 t=7.6e-03 per=1.9e+01 cost=5.7e+04 flops=7.5e+06
 renorm[gemm] counter=11 i=6 t=7.5e-03 per=1.9e+01 cost=1.1e+05 flops=1.5e+07
 renorm[gemm] counter=11 total t=2.3e-02 per=5.8e+01 cost=1.9e+05 flops=8.6e+06
 renorm[red] counter=11 t=1.0e-02 per=2.5e+01 cost=4.7e+04 flops=4.7e+06
----- TIMING FOR renorm_tot : t_inter=6.3e-02 t_gemm=2.5e-01 t_reduction=1.1e-01 tot=4.2e-01 -----
 renorm_tot[inter] counter=11 t=6.3e-02 per=1.5e+01 cost=1.1e+06 flops=1.7e+07
 renorm_tot[gemm] counter=11 i=0 t=1.7e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=1.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=3 t=1.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=4 t=8.1e-02 per=1.9e+01 cost=1.5e+05 flops=1.9e+06
 renorm_tot[gemm] counter=11 i=5 t=8.3e-02 per=2.0e+01 cost=4.2e+05 flops=5.1e+06
 renorm_tot[gemm] counter=11 i=6 t=8.3e-02 per=2.0e+01 cost=7.4e+05 flops=8.8e+06
 renorm_tot[gemm] counter=11 total t=2.5e-01 per=5.9e+01 cost=1.3e+06 flops=5.3e+06
 renorm_tot[red] counter=11 t=1.1e-01 per=2.6e+01 cost=3.1e+05 flops=2.8e+06
qops.to_cpu: size(tot)=3602:2.7e-02MB:2.7e-05GB T(to_cpu)=1.6e-04S speed=1.7e-01GB/S
check ||H-H.dagger||=9.401e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.113 S rank=0 -----
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=3.311e-03 change=1.099e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=5.379e-03 change=-2.285e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=5.379e-03 change=-2.801e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.665e+00 S #####
 T(local opt: fetch) = 1.202e-02 S  per = 0.722  per(accum) = 0.722
 T(local opt: hdiag) = 8.072e-01 S  per = 48.5  per(accum) = 49.2
 T(local opt: dvdsn) = 7.143e-01 S  per = 42.9  per(accum) = 92.1
 T(local opt: decim) = 1.331e-02 S  per =  0.8  per(accum) = 92.9
 T(local opt: guess) = 7.701e-04 S  per = 0.0463  per(accum) = 93
 T(local opt: renrm) = 1.167e-01 S  per = 7.01  per(accum) = 100
 T(local opt: save ) = 3.949e-04 S  per = 0.0237  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.143e-01 S  T(sum) = 7.099e-01 S  per = 9.938e+01
 T(local opt: preprocess                  ) = 3.790e-03 S  per = 0.534  per(accum) = 0.534
 T(local opt: symbolic_formulae           ) = 1.275e-02 S  per =  1.8  per(accum) = 2.33
 T(local opt: hintermediate init          ) = 4.593e-04 S  per = 0.0647  per(accum) = 2.39
 T(local opt: preprocess_hformulae_Hxlist ) = 1.760e-01 S  per = 24.8  per(accum) = 27.2
 T(local opt: hmmtasks init               ) = 7.278e-02 S  per = 10.3  per(accum) = 37.4
 T(local opt: initial guess for dvdson    ) = 8.363e-04 S  per = 0.118  per(accum) = 37.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.555e-01 S  per = 50.1  per(accum) = 87.6
 T(local opt: dvdson [cpu-gpu]            ) = 9.213e-03 S  per =  1.3  per(accum) = 88.9
 T(local opt: dvdson [nccl]               ) = 4.358e-05 S  per = 0.00614  per(accum) = 88.9
 T(local opt: dvdson [mpi]                ) = 8.960e-07 S  per = 0.000126  per(accum) = 88.9
 T(local opt: dvdson [rest part(linalg)]  ) = 7.857e-02 S  per = 11.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.167e-01 S  T(sum) = 1.167e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.278e-04 S  per = 0.195  per(accum) = 0.195
 T(local opt: qops init                    ) = 3.658e-03 S  per = 3.13  per(accum) = 3.33
 T(local opt: symbolic_formulae_renorm     ) = 6.989e-03 S  per = 5.99  per(accum) = 9.32
 T(local opt: allocate qops on gpu         ) = 2.274e-04 S  per = 0.195  per(accum) = 9.51
 T(local opt: site memcpy cpu2gpu          ) = 2.063e-03 S  per = 1.77  per(accum) = 11.3
 T(local opt: rintermediate init           ) = 2.506e-03 S  per = 2.15  per(accum) = 13.4
 T(local opt: preprocess_formulae_Rlist2   ) = 3.735e-02 S  per =   32  per(accum) = 45.4
 T(local opt: rmmtasks init                ) = 2.061e-02 S  per = 17.7  per(accum) = 63.1
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 3.6e-05  per(accum) = 63.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.926e-02 S  per = 33.6  per(accum) = 96.7
 T(local opt: deallocate cpu and gpu memory) = 1.240e-04 S  per = 0.106  per(accum) = 96.8
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 3.6e-05  per(accum) = 96.8
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 3.08e-05  per(accum) = 96.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.687e-04 S  per = 0.145  per(accum) = 97
 T(local opt: reduction of opS & opH [mpi] ) = 4.503e-05 S  per = 0.0386  per(accum) = 97
 T(local opt: qops_pool join and erase     ) = 3.482e-03 S  per = 2.98  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 5.768e-06 S  per = 0.00494  per(accum) = 100
##### sweep opt: 1.608e+01 S #####
 T(sweep opt: fetch) = 1.906e-01 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: hdiag) = 6.704e+00 S  per = 41.7  per(accum) = 42.9
 T(sweep opt: dvdsn) = 7.906e+00 S  per = 49.2  per(accum) = 92.1
 T(sweep opt: decim) = 1.536e-01 S  per = 0.955  per(accum) = 93
 T(sweep opt: guess) = 1.511e-02 S  per = 0.094  per(accum) = 93.1
 T(sweep opt: renrm) = 1.106e+00 S  per = 6.88  per(accum) = 100
 T(sweep opt: save ) = 3.991e-03 S  per = 0.0248  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.906e+00 S  T(sum) = 7.890e+00 S  per = 9.980e+01
 T(sweep opt: preprocess                  ) = 6.819e-02 S  per = 0.864  per(accum) = 0.864
 T(sweep opt: symbolic_formulae           ) = 9.500e-02 S  per =  1.2  per(accum) = 2.07
 T(sweep opt: hintermediate init          ) = 3.584e-03 S  per = 0.0454  per(accum) = 2.11
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.826e+00 S  per = 35.8  per(accum) = 37.9
 T(sweep opt: hmmtasks init               ) = 1.077e+00 S  per = 13.7  per(accum) = 51.6
 T(sweep opt: initial guess for dvdson    ) = 1.656e-02 S  per = 0.21  per(accum) = 51.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.969e+00 S  per = 37.6  per(accum) = 89.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 9.195e-02 S  per = 1.17  per(accum) = 90.6
 T(sweep opt: dvdson [nccl]               ) = 4.873e-04 S  per = 0.00618  per(accum) = 90.6
 T(sweep opt: dvdson [mpi]                ) = 1.173e-05 S  per = 0.000149  per(accum) = 90.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.413e-01 S  per =  9.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.106e+00 S  T(sum) = 1.106e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.831e-03 S  per = 0.256  per(accum) = 0.256
 T(sweep opt: qops init                    ) = 4.285e-02 S  per = 3.88  per(accum) = 4.13
 T(sweep opt: symbolic_formulae_renorm     ) = 4.810e-02 S  per = 4.35  per(accum) = 8.48
 T(sweep opt: allocate qops on gpu         ) = 8.589e-04 S  per = 0.0777  per(accum) = 8.56
 T(sweep opt: site memcpy cpu2gpu          ) = 1.471e-02 S  per = 1.33  per(accum) = 9.89
 T(sweep opt: rintermediate init           ) = 2.823e-02 S  per = 2.55  per(accum) = 12.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.127e-01 S  per = 28.3  per(accum) = 40.7
 T(sweep opt: rmmtasks init                ) = 1.610e-01 S  per = 14.6  per(accum) = 55.3
 T(sweep opt: qops memset on cpu           ) = 4.660e-07 S  per = 4.22e-05  per(accum) = 55.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.219e-01 S  per = 38.2  per(accum) = 93.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.293e-03 S  per = 0.117  per(accum) = 93.6
 T(sweep opt: construct opS [ifdists=true] ) = 6.510e-07 S  per = 5.89e-05  per(accum) = 93.6
 T(sweep opt: reduction of opS & opH [nccl]) = 4.600e-07 S  per = 4.16e-05  per(accum) = 93.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.446e-03 S  per = 0.131  per(accum) = 93.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.759e-04 S  per = 0.043  per(accum) = 93.7
 T(sweep opt: qops_pool join and erase     ) = 3.679e-02 S  per = 3.33  per(accum) = 97.1
 T(sweep opt: conversion from opAB to opPQ ) = 3.239e-02 S  per = 2.93  per(accum) = 100
##### global opt: 1.608e+01 S #####
 T(global opt: fetch) = 1.906e-01 S  per = 1.19  per(accum) = 1.19
 T(global opt: hdiag) = 6.704e+00 S  per = 41.7  per(accum) = 42.9
 T(global opt: dvdsn) = 7.906e+00 S  per = 49.2  per(accum) = 92.1
 T(global opt: decim) = 1.536e-01 S  per = 0.955  per(accum) = 93
 T(global opt: guess) = 1.511e-02 S  per = 0.094  per(accum) = 93.1
 T(global opt: renrm) = 1.106e+00 S  per = 6.88  per(accum) = 100
 T(global opt: save ) = 3.991e-03 S  per = 0.0248  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.906e+00 S  T(sum) = 7.890e+00 S  per = 9.980e+01
 T(global opt: preprocess                  ) = 6.819e-02 S  per = 0.864  per(accum) = 0.864
 T(global opt: symbolic_formulae           ) = 9.500e-02 S  per =  1.2  per(accum) = 2.07
 T(global opt: hintermediate init          ) = 3.584e-03 S  per = 0.0454  per(accum) = 2.11
 T(global opt: preprocess_hformulae_Hxlist ) = 2.826e+00 S  per = 35.8  per(accum) = 37.9
 T(global opt: hmmtasks init               ) = 1.077e+00 S  per = 13.7  per(accum) = 51.6
 T(global opt: initial guess for dvdson    ) = 1.656e-02 S  per = 0.21  per(accum) = 51.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.969e+00 S  per = 37.6  per(accum) = 89.4
 T(global opt: dvdson [cpu-gpu]            ) = 9.195e-02 S  per = 1.17  per(accum) = 90.6
 T(global opt: dvdson [nccl]               ) = 4.873e-04 S  per = 0.00618  per(accum) = 90.6
 T(global opt: dvdson [mpi]                ) = 1.173e-05 S  per = 0.000149  per(accum) = 90.6
 T(global opt: dvdson [rest part(linalg)]  ) = 7.413e-01 S  per =  9.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.106e+00 S  T(sum) = 1.106e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.831e-03 S  per = 0.256  per(accum) = 0.256
 T(global opt: qops init                    ) = 4.285e-02 S  per = 3.88  per(accum) = 4.13
 T(global opt: symbolic_formulae_renorm     ) = 4.810e-02 S  per = 4.35  per(accum) = 8.48
 T(global opt: allocate qops on gpu         ) = 8.589e-04 S  per = 0.0777  per(accum) = 8.56
 T(global opt: site memcpy cpu2gpu          ) = 1.471e-02 S  per = 1.33  per(accum) = 9.89
 T(global opt: rintermediate init           ) = 2.823e-02 S  per = 2.55  per(accum) = 12.4
 T(global opt: preprocess_formulae_Rlist2   ) = 3.127e-01 S  per = 28.3  per(accum) = 40.7
 T(global opt: rmmtasks init                ) = 1.610e-01 S  per = 14.6  per(accum) = 55.3
 T(global opt: qops memset on cpu           ) = 4.660e-07 S  per = 4.22e-05  per(accum) = 55.3
 T(global opt: preprocess_renorm_batchGPU   ) = 4.219e-01 S  per = 38.2  per(accum) = 93.5
 T(global opt: deallocate cpu and gpu memory) = 1.293e-03 S  per = 0.117  per(accum) = 93.6
 T(global opt: construct opS [ifdists=true] ) = 6.510e-07 S  per = 5.89e-05  per(accum) = 93.6
 T(global opt: reduction of opS & opH [nccl]) = 4.600e-07 S  per = 4.16e-05  per(accum) = 93.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.446e-03 S  per = 0.131  per(accum) = 93.7
 T(global opt: reduction of opS & opH [mpi] ) = 4.759e-04 S  per = 0.043  per(accum) = 93.7
 T(global opt: qops_pool join and erase     ) = 3.679e-02 S  per = 3.33  per(accum) = 97.1
 T(global opt: conversion from opAB to opPQ ) = 3.239e-02 S  per = 2.93  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.907e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=11/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=532:4.059e-03MB:3.964e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=38:2.899e-04MB:2.831e-07GB
total mem of comb=571:4.356e-03MB:4.254e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=3602:2.748e-02MB:2.684e-05GB
        per(mem): H:0.833 C:7 S:4.66 P:3.55 Q:84 
 rqops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=380:0.0029MB:2.83e-06GB
        per(mem): H:1.58 C:6.32 S:14.7 A:0 B:77.4 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5978:0.0456MB:4.45e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.028e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.444e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,4,3,3) nnz=51:3.891e-04MB
qtensor4: wf4 own=1 _data=0x45c41d40
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
 qbond: qcol nsym=3 dimAll=4
 (8,2):1 (8,4):1 (9,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=6.184e-01 t1=2.687e-05, t2=1.779e-03, t3=2.501e-03, t4=6.141e-01, t5=6.989e-06, t6=1.649e-05, t7=3.520e-06
duration_diagGPU:6.184e-01
duration_diagreduce:7.400e-08
duration_diagtransform:5.490e-07
----- TIMING FOR symbolic_formulae_twodot with size=591 : 8.518e-03 S -----
rank=0 GPUmem(GB): used=4.454e-05 (oper)=4.454e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=591
 no. of hintermediate operators=286
 no. of coefficients=4083:3.115e-02MB:3.042e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.795e-04 S -----
rank=0 GPUmem(GB): used=7.496e-05 (oper,hinter)=4.454e-05,3.042e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.404e-01 S size(H_formulae)=591 size(Hxlst2)=15 T(Hmu/Hxlist)=1.629e-03,1.387e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.417e-01 S size(H_formulae)=591 size(Hxlst)=8400 -----
rank=0 GPUmem(GB): used=7.496e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=7.600e-07 batch[need]=1.565e-03 blksize=8 blksize0=8 batchsize=8400
rank=0 GPUmem(GB): used=1.640e-03 (oper,hinter,dvdson,batch)=4.454e-05,3.042e-05,7.600e-07,1.565e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.836e-03,1.003e-02,3.000e-02,1.006e-02,5.194e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=1.829e-03 speed=4.154e-04GB/S T(nccl)=6.124e-06 speed=1.241e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=72 t=1.0e-02 per=2.0e+01 cost=3.9e+05 flops=3.9e+07
 sigma[gemm] counter=72 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=3 t=4.7e-06 per=9.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=4 t=7.5e-03 per=1.5e+01 cost=4.6e+04 flops=6.1e+06
 sigma[gemm] counter=72 i=5 t=7.4e-03 per=1.5e+01 cost=4.5e+04 flops=6.0e+06
 sigma[gemm] counter=72 i=6 t=7.6e-03 per=1.5e+01 cost=5.5e+04 flops=7.2e+06
 sigma[gemm] counter=72 i=7 t=7.5e-03 per=1.5e+01 cost=5.1e+04 flops=6.8e+06
 sigma[gemm] counter=72 total t=3.0e-02 per=6.0e+01 cost=2.0e+05 flops=6.5e+06
 sigma[red] counter=72 t=1.0e-02 per=2.0e+01 cost=6.0e+04 flops=6.0e+06
----- TIMING FOR sigma_tot : t_inter=6.2e-01 t_gemm=1.6e+00 t_reduction=7.7e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=72 t=6.2e-01 per=2.1e+01 cost=7.0e+07 flops=1.1e+08
 sigma_tot[gemm] counter=72 i=0 t=1.6e-04 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=1.4e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=3 t=1.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=4 t=4.3e-01 per=1.4e+01 cost=1.4e+07 flops=3.3e+07
 sigma_tot[gemm] counter=72 i=5 t=4.3e-01 per=1.4e+01 cost=1.4e+07 flops=3.3e+07
 sigma_tot[gemm] counter=72 i=6 t=3.8e-01 per=1.3e+01 cost=1.3e+07 flops=3.5e+07
 sigma_tot[gemm] counter=72 i=7 t=3.8e-01 per=1.3e+01 cost=1.4e+07 flops=3.6e+07
 sigma_tot[gemm] counter=72 total t=1.6e+00 per=5.4e+01 cost=5.5e+07 flops=3.4e+07
 sigma_tot[red] counter=72 t=7.7e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.6e-06,2.0e-06,8.5e-07,1.9e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.284966887172 -1.116e+03  5.064e-02    1     1  5.207e-02 5.207e-02 5.204e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.537e-03,1.057e-02,2.964e-02,1.032e-02,5.256e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=1.522e-03 speed=4.994e-04GB/S T(nccl)=1.488e-05 speed=5.108e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=73 t=1.1e-02 per=2.1e+01 cost=3.9e+05 flops=3.7e+07
 sigma[gemm] counter=73 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=3 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=4 t=7.1e-03 per=1.4e+01 cost=4.6e+04 flops=6.5e+06
 sigma[gemm] counter=73 i=5 t=7.5e-03 per=1.5e+01 cost=4.5e+04 flops=6.0e+06
 sigma[gemm] counter=73 i=6 t=7.5e-03 per=1.5e+01 cost=5.5e+04 flops=7.3e+06
 sigma[gemm] counter=73 i=7 t=7.6e-03 per=1.5e+01 cost=5.1e+04 flops=6.7e+06
 sigma[gemm] counter=73 total t=3.0e-02 per=5.9e+01 cost=2.0e+05 flops=6.6e+06
 sigma[red] counter=73 t=1.0e-02 per=2.0e+01 cost=6.0e+04 flops=5.9e+06
----- TIMING FOR sigma_tot : t_inter=6.3e-01 t_gemm=1.7e+00 t_reduction=7.8e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=73 t=6.3e-01 per=2.1e+01 cost=7.0e+07 flops=1.1e+08
 sigma_tot[gemm] counter=73 i=0 t=1.6e-04 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=1.4e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=1.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=3 t=1.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=4 t=4.3e-01 per=1.4e+01 cost=1.4e+07 flops=3.3e+07
 sigma_tot[gemm] counter=73 i=5 t=4.4e-01 per=1.4e+01 cost=1.4e+07 flops=3.3e+07
 sigma_tot[gemm] counter=73 i=6 t=3.9e-01 per=1.3e+01 cost=1.3e+07 flops=3.4e+07
 sigma_tot[gemm] counter=73 i=7 t=3.9e-01 per=1.3e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=73 total t=1.7e+00 per=5.4e+01 cost=5.6e+07 flops=3.4e+07
 sigma_tot[red] counter=73 t=7.8e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,2.2e-05,4.5e-06,1.6e-06,2.1e-07
    2   0 -    -116.290956146613 -5.989e-03  1.085e-02    2     2  1.156e-01 5.781e-02 5.236e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.683e-04,9.946e-03,2.987e-02,1.021e-02,5.040e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=3.617e-04 speed=2.101e-03GB/S T(nccl)=6.536e-06 speed=1.163e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=74 t=9.9e-03 per=2.0e+01 cost=3.9e+05 flops=4.0e+07
 sigma[gemm] counter=74 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=3 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=4 t=7.4e-03 per=1.5e+01 cost=4.6e+04 flops=6.2e+06
 sigma[gemm] counter=74 i=5 t=7.5e-03 per=1.5e+01 cost=4.5e+04 flops=6.0e+06
 sigma[gemm] counter=74 i=6 t=7.5e-03 per=1.5e+01 cost=5.5e+04 flops=7.3e+06
 sigma[gemm] counter=74 i=7 t=7.5e-03 per=1.5e+01 cost=5.1e+04 flops=6.8e+06
 sigma[gemm] counter=74 total t=3.0e-02 per=6.0e+01 cost=2.0e+05 flops=6.6e+06
 sigma[red] counter=74 t=1.0e-02 per=2.0e+01 cost=6.0e+04 flops=5.9e+06
----- TIMING FOR sigma_tot : t_inter=6.4e-01 t_gemm=1.7e+00 t_reduction=7.9e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=74 t=6.4e-01 per=2.1e+01 cost=7.1e+07 flops=1.1e+08
 sigma_tot[gemm] counter=74 i=0 t=1.6e-04 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=1.4e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=3 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=4 t=4.4e-01 per=1.4e+01 cost=1.4e+07 flops=3.2e+07
 sigma_tot[gemm] counter=74 i=5 t=4.4e-01 per=1.4e+01 cost=1.4e+07 flops=3.2e+07
 sigma_tot[gemm] counter=74 i=6 t=4.0e-01 per=1.3e+01 cost=1.3e+07 flops=3.3e+07
 sigma_tot[gemm] counter=74 i=7 t=4.0e-01 per=1.3e+01 cost=1.4e+07 flops=3.5e+07
 sigma_tot[gemm] counter=74 total t=1.7e+00 per=5.4e+01 cost=5.6e+07 flops=3.3e+07
 sigma_tot[red] counter=74 t=7.9e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.9e-05,3.1e-06,1.1e-06,2.0e-07
    3   0 -    -116.291453914930 -4.978e-04  2.000e-03    3     3  1.786e-01 5.952e-02 5.175e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.190e-03,1.016e-02,3.011e-02,1.013e-02,5.260e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.184e-03 speed=3.480e-04GB/S T(nccl)=6.620e-06 speed=1.148e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=75 t=1.0e-02 per=2.0e+01 cost=3.9e+05 flops=3.9e+07
 sigma[gemm] counter=75 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=4 t=7.5e-03 per=1.5e+01 cost=4.6e+04 flops=6.1e+06
 sigma[gemm] counter=75 i=5 t=7.6e-03 per=1.5e+01 cost=4.5e+04 flops=5.9e+06
 sigma[gemm] counter=75 i=6 t=7.5e-03 per=1.5e+01 cost=5.5e+04 flops=7.3e+06
 sigma[gemm] counter=75 i=7 t=7.4e-03 per=1.5e+01 cost=5.1e+04 flops=6.8e+06
 sigma[gemm] counter=75 total t=3.0e-02 per=6.0e+01 cost=2.0e+05 flops=6.5e+06
 sigma[red] counter=75 t=1.0e-02 per=2.0e+01 cost=6.0e+04 flops=6.0e+06
----- TIMING FOR sigma_tot : t_inter=6.5e-01 t_gemm=1.7e+00 t_reduction=8.0e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=75 t=6.5e-01 per=2.1e+01 cost=7.1e+07 flops=1.1e+08
 sigma_tot[gemm] counter=75 i=0 t=1.7e-04 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=1.4e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=3 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=4 t=4.5e-01 per=1.4e+01 cost=1.4e+07 flops=3.2e+07
 sigma_tot[gemm] counter=75 i=5 t=4.5e-01 per=1.4e+01 cost=1.4e+07 flops=3.2e+07
 sigma_tot[gemm] counter=75 i=6 t=4.1e-01 per=1.3e+01 cost=1.3e+07 flops=3.3e+07
 sigma_tot[gemm] counter=75 i=7 t=4.1e-01 per=1.3e+01 cost=1.4e+07 flops=3.4e+07
 sigma_tot[gemm] counter=75 total t=1.7e+00 per=5.4e+01 cost=5.6e+07 flops=3.3e+07
 sigma_tot[red] counter=75 t=8.0e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.5e-05,3.2e-06,1.1e-06,2.0e-07
    4   0 -    -116.291463949187 -1.003e-05  4.314e-04    3     4  2.483e-01 6.206e-02 5.199e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.216e-03,1.024e-02,3.032e-02,1.024e-02,5.303e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.210e-03 speed=3.439e-04GB/S T(nccl)=6.360e-06 speed=1.195e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=76 t=1.0e-02 per=2.0e+01 cost=3.9e+05 flops=3.9e+07
 sigma[gemm] counter=76 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=3 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=4 t=7.5e-03 per=1.5e+01 cost=4.6e+04 flops=6.1e+06
 sigma[gemm] counter=76 i=5 t=7.7e-03 per=1.5e+01 cost=4.5e+04 flops=5.8e+06
 sigma[gemm] counter=76 i=6 t=7.6e-03 per=1.5e+01 cost=5.5e+04 flops=7.2e+06
 sigma[gemm] counter=76 i=7 t=7.5e-03 per=1.5e+01 cost=5.1e+04 flops=6.8e+06
 sigma[gemm] counter=76 total t=3.0e-02 per=6.0e+01 cost=2.0e+05 flops=6.5e+06
 sigma[red] counter=76 t=1.0e-02 per=2.0e+01 cost=6.0e+04 flops=5.9e+06
----- TIMING FOR sigma_tot : t_inter=6.6e-01 t_gemm=1.7e+00 t_reduction=8.1e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=76 t=6.6e-01 per=2.0e+01 cost=7.1e+07 flops=1.1e+08
 sigma_tot[gemm] counter=76 i=0 t=1.7e-04 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=1.4e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=3 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=4 t=4.6e-01 per=1.4e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=76 i=5 t=4.6e-01 per=1.4e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=76 i=6 t=4.1e-01 per=1.3e+01 cost=1.3e+07 flops=3.3e+07
 sigma_tot[gemm] counter=76 i=7 t=4.1e-01 per=1.3e+01 cost=1.4e+07 flops=3.4e+07
 sigma_tot[gemm] counter=76 total t=1.7e+00 per=5.4e+01 cost=5.6e+07 flops=3.2e+07
 sigma_tot[red] counter=76 t=8.1e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.5e-05,3.0e-06,1.1e-06,2.0e-07
    5   0 -    -116.291464608223 -6.590e-07  1.600e-04    3     5  3.142e-01 6.283e-02 5.222e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.218e-03,1.024e-02,3.047e-02,1.044e-02,5.237e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=1.211e-03 speed=6.274e-04GB/S T(nccl)=6.362e-06 speed=1.195e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=77 t=1.0e-02 per=2.0e+01 cost=3.9e+05 flops=3.9e+07
 sigma[gemm] counter=77 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=4 t=7.6e-03 per=1.5e+01 cost=4.6e+04 flops=6.0e+06
 sigma[gemm] counter=77 i=5 t=7.6e-03 per=1.5e+01 cost=4.5e+04 flops=5.9e+06
 sigma[gemm] counter=77 i=6 t=7.7e-03 per=1.5e+01 cost=5.5e+04 flops=7.1e+06
 sigma[gemm] counter=77 i=7 t=7.5e-03 per=1.5e+01 cost=5.1e+04 flops=6.7e+06
 sigma[gemm] counter=77 total t=3.0e-02 per=6.0e+01 cost=2.0e+05 flops=6.4e+06
 sigma[red] counter=77 t=1.0e-02 per=2.0e+01 cost=6.0e+04 flops=5.8e+06
----- TIMING FOR sigma_tot : t_inter=6.7e-01 t_gemm=1.8e+00 t_reduction=8.2e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=77 t=6.7e-01 per=2.0e+01 cost=7.2e+07 flops=1.1e+08
 sigma_tot[gemm] counter=77 i=0 t=1.7e-04 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=1.5e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=3 t=1.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=4 t=4.6e-01 per=1.4e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=77 i=5 t=4.7e-01 per=1.4e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=77 i=6 t=4.2e-01 per=1.3e+01 cost=1.3e+07 flops=3.2e+07
 sigma_tot[gemm] counter=77 i=7 t=4.2e-01 per=1.3e+01 cost=1.4e+07 flops=3.3e+07
 sigma_tot[gemm] counter=77 total t=1.8e+00 per=5.4e+01 cost=5.6e+07 flops=3.2e+07
 sigma_tot[red] counter=77 t=8.2e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.5e-05,3.1e-06,1.2e-06,2.3e-07
    6   0 +    -116.291464685952 -7.773e-08  5.642e-05    3     6  3.805e-01 6.341e-02 5.226e-02
TIMING FOR Davidson : 3.805e-01  T(cal/comm/rest)=3.136e-01,8.290e-07,6.690e-02
decomposed t_rest=6.690e-02
 T(sub)    =1.467e-04 per=2.193e-01
 T(precond)=6.656e-02 per=9.949e+01
 T(ortho)  =3.195e-05 per=4.775e-02
 T(xcopy)  =7.310e-07 per=1.093e-03
 T(xnrm2)  =2.646e-06 per=3.955e-03
 T(other)  =1.615e-04 per=2.414e-01
optimized energies: isweep=0 ibond=11 dots=2 e[0]=-116.291464685952 nmvp=6
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.625e-03 change=2.499e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=9 dimAll=40
 (18,2):6 (20,2):5 (19,1):4 (19,3):10 (18,4):5 (20,4):4 (19,5):3 (17,3):2 (21,3):1
timing for divide=6.5e-05
timing for compute=1.7e-02
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(su2): 1.7e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.5e-05,1.7e-02,0.0e+00,5.2e-06,1.9e-05 -----
decimation summary: 40->9 dwt=-2.220e-16 SvN=4.139e-01
 qbond: qkept nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
----- TIMING for decimation_row(nkr): 1.738e-02 S T(decim/select/formRot)=1.703e-02,2.817e-04,6.396e-05 -----
----- TIMING FOR twodot_decimation: 1.777e-02 S T(wf/decim)=3.871e-04,1.739e-02 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=2273:1.734e-02MB:1.694e-05GB
        per(mem): H:1.01 C:10.3 S:5.54 P:4.31 Q:78.8 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.625e-03 change=1.870e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=126 : 5.191e-03 S -----
rank=0 GPUmem(GB): used=8.906e-05 (oper)=5.121e-05
rank=0 GPUmem(GB): used=8.942e-05 (oper,site)=5.121e-05,3.576e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=126
 no. of rintermediate operators=182
 no. of coefficients=2184:1.666e-02MB:1.627e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.104e-03 S -----
rank=0 GPUmem(GB): used=1.057e-04 (oper,site,rinter)=5.121e-05,3.576e-07,1.627e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.055e-02 S size(rtasks)=126 size(Rlst2)=16 T(Rmu/Rlist)=1.429e-03,2.912e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.105e-02 S size(rtasks)=126 size(Rlst)=2667 -----
rank=0 GPUmem(GB): used=1.057e-04 avail=6.174e+00 total=6.174e+00 batch[need]=6.557e-04 blksize=12 blksize0=8 batchsize=2667
rank=0 GPUmem(GB): used=7.614e-04 (oper,site,rinter,batch)=5.121e-05,3.576e-07,1.627e-05,6.557e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.086e-03,2.274e-02,1.011e-02
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=12 t=6.1e-03 per=1.6e+01 cost=1.0e+05 flops=1.7e+07
 renorm[gemm] counter=12 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=4 t=7.6e-03 per=1.9e+01 cost=1.7e+04 flops=2.2e+06
 renorm[gemm] counter=12 i=5 t=7.6e-03 per=1.9e+01 cost=3.8e+04 flops=5.0e+06
 renorm[gemm] counter=12 i=6 t=7.6e-03 per=1.9e+01 cost=7.1e+04 flops=9.4e+06
 renorm[gemm] counter=12 total t=2.3e-02 per=5.8e+01 cost=1.3e+05 flops=5.5e+06
 renorm[red] counter=12 t=1.0e-02 per=2.6e+01 cost=3.1e+04 flops=3.1e+06
----- TIMING FOR renorm_tot : t_inter=6.9e-02 t_gemm=2.7e-01 t_reduction=1.2e-01 tot=4.6e-01 -----
 renorm_tot[inter] counter=12 t=6.9e-02 per=1.5e+01 cost=1.2e+06 flops=1.7e+07
 renorm_tot[gemm] counter=12 i=0 t=1.8e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=1.5e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=3 t=1.5e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=4 t=8.9e-02 per=1.9e+01 cost=1.7e+05 flops=1.9e+06
 renorm_tot[gemm] counter=12 i=5 t=9.0e-02 per=2.0e+01 cost=4.6e+05 flops=5.1e+06
 renorm_tot[gemm] counter=12 i=6 t=9.1e-02 per=2.0e+01 cost=8.1e+05 flops=8.9e+06
 renorm_tot[gemm] counter=12 total t=2.7e-01 per=5.9e+01 cost=1.4e+06 flops=5.3e+06
 renorm_tot[red] counter=12 t=1.2e-01 per=2.6e+01 cost=3.4e+05 flops=2.8e+06
qops.to_cpu: size(tot)=2273:1.7e-02MB:1.7e-05GB T(to_cpu)=1.3e-04S speed=1.3e-01GB/S
check ||H-H.dagger||=1.778e-14 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.1 S rank=0 -----
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=2.159e-03 change=9.076e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=3.937e-03 change=-2.013e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=3.937e-03 change=-2.742e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.343e+00 S #####
 T(local opt: fetch) = 1.073e-02 S  per = 0.798  per(accum) = 0.798
 T(local opt: hdiag) = 6.189e-01 S  per = 46.1  per(accum) = 46.9
 T(local opt: dvdsn) = 5.915e-01 S  per =   44  per(accum) = 90.9
 T(local opt: decim) = 1.779e-02 S  per = 1.32  per(accum) = 92.2
 T(local opt: guess) = 7.199e-04 S  per = 0.0536  per(accum) = 92.3
 T(local opt: renrm) = 1.034e-01 S  per =  7.7  per(accum) = 100
 T(local opt: save ) = 3.697e-04 S  per = 0.0275  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.915e-01 S  T(sum) = 5.909e-01 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 2.904e-03 S  per = 0.492  per(accum) = 0.492
 T(local opt: symbolic_formulae           ) = 8.535e-03 S  per = 1.44  per(accum) = 1.94
 T(local opt: hintermediate init          ) = 2.968e-04 S  per = 0.0502  per(accum) = 1.99
 T(local opt: preprocess_hformulae_Hxlist ) = 1.421e-01 S  per = 24.1  per(accum) = 26
 T(local opt: hmmtasks init               ) = 5.572e-02 S  per = 9.43  per(accum) = 35.5
 T(local opt: initial guess for dvdson    ) = 8.533e-04 S  per = 0.144  per(accum) = 35.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.042e-01 S  per = 51.5  per(accum) = 87.1
 T(local opt: dvdson [cpu-gpu]            ) = 9.318e-03 S  per = 1.58  per(accum) = 88.7
 T(local opt: dvdson [nccl]               ) = 4.688e-05 S  per = 0.00793  per(accum) = 88.7
 T(local opt: dvdson [mpi]                ) = 8.290e-07 S  per = 0.00014  per(accum) = 88.7
 T(local opt: dvdson [rest part(linalg)]  ) = 6.690e-02 S  per = 11.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.034e-01 S  T(sum) = 1.034e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.050e-04 S  per = 0.198  per(accum) = 0.198
 T(local opt: qops init                    ) = 2.744e-03 S  per = 2.65  per(accum) = 2.85
 T(local opt: symbolic_formulae_renorm     ) = 5.206e-03 S  per = 5.04  per(accum) = 7.89
 T(local opt: allocate qops on gpu         ) = 1.709e-03 S  per = 1.65  per(accum) = 9.54
 T(local opt: site memcpy cpu2gpu          ) = 1.046e-03 S  per = 1.01  per(accum) = 10.6
 T(local opt: rintermediate init           ) = 2.123e-03 S  per = 2.05  per(accum) = 12.6
 T(local opt: preprocess_formulae_Rlist2   ) = 3.115e-02 S  per = 30.1  per(accum) = 42.7
 T(local opt: rmmtasks init                ) = 1.686e-02 S  per = 16.3  per(accum) = 59
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 4.16e-05  per(accum) = 59
 T(local opt: preprocess_renorm_batchGPU   ) = 3.902e-02 S  per = 37.7  per(accum) = 96.8
 T(local opt: deallocate cpu and gpu memory) = 1.130e-04 S  per = 0.109  per(accum) = 96.9
 T(local opt: construct opS [ifdists=true] ) = 5.100e-08 S  per = 4.93e-05  per(accum) = 96.9
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 3.48e-05  per(accum) = 96.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.447e-04 S  per = 0.14  per(accum) = 97
 T(local opt: reduction of opS & opH [mpi] ) = 5.227e-05 S  per = 0.0505  per(accum) = 97.1
 T(local opt: qops_pool join and erase     ) = 3.021e-03 S  per = 2.92  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 5.940e-06 S  per = 0.00574  per(accum) = 100
##### sweep opt: 1.742e+01 S #####
 T(sweep opt: fetch) = 2.013e-01 S  per = 1.16  per(accum) = 1.16
 T(sweep opt: hdiag) = 7.323e+00 S  per =   42  per(accum) = 43.2
 T(sweep opt: dvdsn) = 8.497e+00 S  per = 48.8  per(accum) = 92
 T(sweep opt: decim) = 1.713e-01 S  per = 0.984  per(accum) = 92.9
 T(sweep opt: guess) = 1.583e-02 S  per = 0.0909  per(accum) = 93
 T(sweep opt: renrm) = 1.209e+00 S  per = 6.94  per(accum) = 100
 T(sweep opt: save ) = 4.361e-03 S  per = 0.025  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.497e+00 S  T(sum) = 8.480e+00 S  per = 9.980e+01
 T(sweep opt: preprocess                  ) = 7.110e-02 S  per = 0.838  per(accum) = 0.838
 T(sweep opt: symbolic_formulae           ) = 1.035e-01 S  per = 1.22  per(accum) = 2.06
 T(sweep opt: hintermediate init          ) = 3.880e-03 S  per = 0.0458  per(accum) = 2.11
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.968e+00 S  per =   35  per(accum) = 37.1
 T(sweep opt: hmmtasks init               ) = 1.133e+00 S  per = 13.4  per(accum) = 50.5
 T(sweep opt: initial guess for dvdson    ) = 1.742e-02 S  per = 0.205  per(accum) = 50.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.274e+00 S  per = 38.6  per(accum) = 89.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.013e-01 S  per = 1.19  per(accum) = 90.5
 T(sweep opt: dvdson [nccl]               ) = 5.342e-04 S  per = 0.0063  per(accum) = 90.5
 T(sweep opt: dvdson [mpi]                ) = 1.256e-05 S  per = 0.000148  per(accum) = 90.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.082e-01 S  per = 9.53  per(accum) = 100
Detailed decomposition of T(renrm) = 1.209e+00 S  T(sum) = 1.209e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.036e-03 S  per = 0.251  per(accum) = 0.251
 T(sweep opt: qops init                    ) = 4.560e-02 S  per = 3.77  per(accum) = 4.02
 T(sweep opt: symbolic_formulae_renorm     ) = 5.331e-02 S  per = 4.41  per(accum) = 8.43
 T(sweep opt: allocate qops on gpu         ) = 2.568e-03 S  per = 0.212  per(accum) = 8.64
 T(sweep opt: site memcpy cpu2gpu          ) = 1.576e-02 S  per =  1.3  per(accum) = 9.95
 T(sweep opt: rintermediate init           ) = 3.035e-02 S  per = 2.51  per(accum) = 12.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.438e-01 S  per = 28.4  per(accum) = 40.9
 T(sweep opt: rmmtasks init                ) = 1.778e-01 S  per = 14.7  per(accum) = 55.6
 T(sweep opt: qops memset on cpu           ) = 5.090e-07 S  per = 4.21e-05  per(accum) = 55.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.610e-01 S  per = 38.1  per(accum) = 93.7
 T(sweep opt: deallocate cpu and gpu memory) = 1.406e-03 S  per = 0.116  per(accum) = 93.9
 T(sweep opt: construct opS [ifdists=true] ) = 7.020e-07 S  per = 5.81e-05  per(accum) = 93.9
 T(sweep opt: reduction of opS & opH [nccl]) = 4.960e-07 S  per = 4.1e-05  per(accum) = 93.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.590e-03 S  per = 0.132  per(accum) = 94
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.282e-04 S  per = 0.0437  per(accum) = 94
 T(sweep opt: qops_pool join and erase     ) = 3.981e-02 S  per = 3.29  per(accum) = 97.3
 T(sweep opt: conversion from opAB to opPQ ) = 3.239e-02 S  per = 2.68  per(accum) = 100
##### global opt: 1.742e+01 S #####
 T(global opt: fetch) = 2.013e-01 S  per = 1.16  per(accum) = 1.16
 T(global opt: hdiag) = 7.323e+00 S  per =   42  per(accum) = 43.2
 T(global opt: dvdsn) = 8.497e+00 S  per = 48.8  per(accum) = 92
 T(global opt: decim) = 1.713e-01 S  per = 0.984  per(accum) = 92.9
 T(global opt: guess) = 1.583e-02 S  per = 0.0909  per(accum) = 93
 T(global opt: renrm) = 1.209e+00 S  per = 6.94  per(accum) = 100
 T(global opt: save ) = 4.361e-03 S  per = 0.025  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.497e+00 S  T(sum) = 8.480e+00 S  per = 9.980e+01
 T(global opt: preprocess                  ) = 7.110e-02 S  per = 0.838  per(accum) = 0.838
 T(global opt: symbolic_formulae           ) = 1.035e-01 S  per = 1.22  per(accum) = 2.06
 T(global opt: hintermediate init          ) = 3.880e-03 S  per = 0.0458  per(accum) = 2.11
 T(global opt: preprocess_hformulae_Hxlist ) = 2.968e+00 S  per =   35  per(accum) = 37.1
 T(global opt: hmmtasks init               ) = 1.133e+00 S  per = 13.4  per(accum) = 50.5
 T(global opt: initial guess for dvdson    ) = 1.742e-02 S  per = 0.205  per(accum) = 50.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.274e+00 S  per = 38.6  per(accum) = 89.3
 T(global opt: dvdson [cpu-gpu]            ) = 1.013e-01 S  per = 1.19  per(accum) = 90.5
 T(global opt: dvdson [nccl]               ) = 5.342e-04 S  per = 0.0063  per(accum) = 90.5
 T(global opt: dvdson [mpi]                ) = 1.256e-05 S  per = 0.000148  per(accum) = 90.5
 T(global opt: dvdson [rest part(linalg)]  ) = 8.082e-01 S  per = 9.53  per(accum) = 100
Detailed decomposition of T(renrm) = 1.209e+00 S  T(sum) = 1.209e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.036e-03 S  per = 0.251  per(accum) = 0.251
 T(global opt: qops init                    ) = 4.560e-02 S  per = 3.77  per(accum) = 4.02
 T(global opt: symbolic_formulae_renorm     ) = 5.331e-02 S  per = 4.41  per(accum) = 8.43
 T(global opt: allocate qops on gpu         ) = 2.568e-03 S  per = 0.212  per(accum) = 8.64
 T(global opt: site memcpy cpu2gpu          ) = 1.576e-02 S  per =  1.3  per(accum) = 9.95
 T(global opt: rintermediate init           ) = 3.035e-02 S  per = 2.51  per(accum) = 12.5
 T(global opt: preprocess_formulae_Rlist2   ) = 3.438e-01 S  per = 28.4  per(accum) = 40.9
 T(global opt: rmmtasks init                ) = 1.778e-01 S  per = 14.7  per(accum) = 55.6
 T(global opt: qops memset on cpu           ) = 5.090e-07 S  per = 4.21e-05  per(accum) = 55.6
 T(global opt: preprocess_renorm_batchGPU   ) = 4.610e-01 S  per = 38.1  per(accum) = 93.7
 T(global opt: deallocate cpu and gpu memory) = 1.406e-03 S  per = 0.116  per(accum) = 93.9
 T(global opt: construct opS [ifdists=true] ) = 7.020e-07 S  per = 5.81e-05  per(accum) = 93.9
 T(global opt: reduction of opS & opH [nccl]) = 4.960e-07 S  per = 4.1e-05  per(accum) = 93.9
 T(global opt: qops memcpy gpu2cpu          ) = 1.590e-03 S  per = 0.132  per(accum) = 94
 T(global opt: reduction of opS & opH [mpi] ) = 5.282e-04 S  per = 0.0437  per(accum) = 94
 T(global opt: qops_pool join and erase     ) = 3.981e-02 S  per = 3.29  per(accum) = 97.3
 T(global opt: conversion from opAB to opPQ ) = 3.239e-02 S  per = 2.68  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.467e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=12/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=552:4.211e-03MB:4.113e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=579:4.417e-03MB:4.314e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=2273:1.734e-02MB:1.694e-05GB
        per(mem): H:1.01 C:10.3 S:5.54 P:4.31 Q:78.8 
 rqops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4393:0.0335MB:3.27e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.322e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-5.364e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(9,2,3,3) nnz=36:2.747e-04MB
qtensor4: wf4 own=1 _data=0x3a5179e0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
 qbond: qcol nsym=1 dimAll=2
 (7,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=9 nblocks=64 size=36:2.747e-04MB
### DIAG TIMING: total=4.854e-01 t1=3.216e-05, t2=2.100e-03, t3=2.491e-03, t4=4.807e-01, t5=8.085e-06, t6=1.643e-05, t7=3.145e-06
duration_diagGPU:4.854e-01
duration_diagreduce:6.300e-08
duration_diagtransform:3.780e-07
----- TIMING FOR symbolic_formulae_twodot with size=491 : 6.625e-03 S -----
rank=0 GPUmem(GB): used=3.273e-05 (oper)=3.273e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=491
 no. of hintermediate operators=244
 no. of coefficients=3269:2.494e-02MB:2.436e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.515e-04 S -----
rank=0 GPUmem(GB): used=5.709e-05 (oper,hinter)=3.273e-05,2.436e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.665e-02 S size(H_formulae)=491 size(Hxlst2)=9 T(Hmu/Hxlist)=1.310e-03,5.534e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.727e-02 S size(H_formulae)=491 size(Hxlst)=3588 -----
rank=0 GPUmem(GB): used=5.709e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=5.364e-07 batch[need]=5.079e-04 blksize=6 blksize0=6 batchsize=3588
rank=0 GPUmem(GB): used=5.655e-04 (oper,hinter,dvdson,batch)=3.273e-05,2.436e-05,5.364e-07,5.079e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=36 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.009e-03,1.012e-02,3.005e-02,1.262e-02,5.482e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.003e-03 speed=2.679e-04GB/S T(nccl)=6.128e-06 speed=8.754e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=78 t=1.0e-02 per=1.9e+01 cost=2.0e+05 flops=2.0e+07
 sigma[gemm] counter=78 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=3 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=4 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.3e+06
 sigma[gemm] counter=78 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=78 i=6 t=7.5e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=78 i=7 t=7.5e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=78 total t=3.0e-02 per=5.7e+01 cost=9.9e+04 flops=3.3e+06
 sigma[red] counter=78 t=1.3e-02 per=2.4e+01 cost=3.0e+04 flops=2.4e+06
----- TIMING FOR sigma_tot : t_inter=6.8e-01 t_gemm=1.8e+00 t_reduction=8.3e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=78 t=6.8e-01 per=2.0e+01 cost=7.2e+07 flops=1.1e+08
 sigma_tot[gemm] counter=78 i=0 t=1.7e-04 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=1.5e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=1.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=3 t=1.2e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=4 t=4.7e-01 per=1.4e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=78 i=5 t=4.7e-01 per=1.4e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=78 i=6 t=4.3e-01 per=1.3e+01 cost=1.4e+07 flops=3.2e+07
 sigma_tot[gemm] counter=78 i=7 t=4.3e-01 per=1.3e+01 cost=1.4e+07 flops=3.3e+07
 sigma_tot[gemm] counter=78 total t=1.8e+00 per=5.4e+01 cost=5.6e+07 flops=3.1e+07
 sigma_tot[red] counter=78 t=8.3e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.6e-06,2.0e-06,1.1e-06,1.8e-07
settings: ndim=36 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.291464685952 -1.116e+03  5.531e-02    1     1  5.494e-02 5.494e-02 5.492e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.545e-03,1.007e-02,1.896e-02,6.306e-03,3.690e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=1.539e-03 speed=3.485e-04GB/S T(nccl)=6.153e-06 speed=8.718e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=1.9e-02 t_reduction=6.3e-03 tot=3.5e-02 -----
 sigma[inter] counter=79 t=1.0e-02 per=2.9e+01 cost=2.0e+05 flops=2.0e+07
 sigma[gemm] counter=79 i=0 t=1.5e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=1.7e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=1.3e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=3 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=4 t=6.9e-03 per=2.0e+01 cost=2.4e+04 flops=3.5e+06
 sigma[gemm] counter=79 i=5 t=4.1e-03 per=1.2e+01 cost=2.4e+04 flops=6.0e+06
 sigma[gemm] counter=79 i=6 t=5.6e-03 per=1.6e+01 cost=2.5e+04 flops=4.5e+06
 sigma[gemm] counter=79 i=7 t=2.4e-03 per=6.7e+00 cost=2.5e+04 flops=1.0e+07
 sigma[gemm] counter=79 total t=1.9e-02 per=5.4e+01 cost=9.9e+04 flops=5.2e+06
 sigma[red] counter=79 t=6.3e-03 per=1.8e+01 cost=3.0e+04 flops=4.7e+06
----- TIMING FOR sigma_tot : t_inter=6.9e-01 t_gemm=1.8e+00 t_reduction=8.4e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=79 t=6.9e-01 per=2.1e+01 cost=7.2e+07 flops=1.1e+08
 sigma_tot[gemm] counter=79 i=0 t=1.7e-04 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=1.5e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=1.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=3 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=4 t=4.8e-01 per=1.4e+01 cost=1.4e+07 flops=3.0e+07
 sigma_tot[gemm] counter=79 i=5 t=4.8e-01 per=1.4e+01 cost=1.5e+07 flops=3.0e+07
 sigma_tot[gemm] counter=79 i=6 t=4.3e-01 per=1.3e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=79 i=7 t=4.3e-01 per=1.3e+01 cost=1.4e+07 flops=3.3e+07
 sigma_tot[gemm] counter=79 total t=1.8e+00 per=5.4e+01 cost=5.7e+07 flops=3.1e+07
 sigma_tot[red] counter=79 t=8.4e-01 per=2.5e+01 cost=1.3e+07 flops=1.6e+07
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.9e-05,3.7e-06,1.1e-06,2.4e-07
    2   0 -    -116.298300665264 -6.836e-03  1.037e-02    2     2  1.033e-01 5.165e-02 4.597e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.561e-03,9.942e-03,2.974e-02,1.260e-02,5.385e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=1.556e-03 speed=3.448e-04GB/S T(nccl)=4.886e-06 speed=1.098e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=80 t=9.9e-03 per=1.9e+01 cost=2.0e+05 flops=2.0e+07
 sigma[gemm] counter=80 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=4 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.3e+06
 sigma[gemm] counter=80 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.3e+06
 sigma[gemm] counter=80 i=6 t=7.4e-03 per=1.4e+01 cost=2.5e+04 flops=3.4e+06
 sigma[gemm] counter=80 i=7 t=7.4e-03 per=1.4e+01 cost=2.5e+04 flops=3.4e+06
 sigma[gemm] counter=80 total t=3.0e-02 per=5.7e+01 cost=9.9e+04 flops=3.3e+06
 sigma[red] counter=80 t=1.3e-02 per=2.4e+01 cost=3.0e+04 flops=2.4e+06
----- TIMING FOR sigma_tot : t_inter=7.0e-01 t_gemm=1.9e+00 t_reduction=8.5e-01 tot=3.4e+00 -----
 sigma_tot[inter] counter=80 t=7.0e-01 per=2.1e+01 cost=7.2e+07 flops=1.0e+08
 sigma_tot[gemm] counter=80 i=0 t=1.7e-04 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=1.5e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=1.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=3 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=4 t=4.9e-01 per=1.4e+01 cost=1.4e+07 flops=3.0e+07
 sigma_tot[gemm] counter=80 i=5 t=4.9e-01 per=1.4e+01 cost=1.5e+07 flops=3.0e+07
 sigma_tot[gemm] counter=80 i=6 t=4.4e-01 per=1.3e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=80 i=7 t=4.4e-01 per=1.3e+01 cost=1.4e+07 flops=3.2e+07
 sigma_tot[gemm] counter=80 total t=1.9e+00 per=5.5e+01 cost=5.7e+07 flops=3.1e+07
 sigma_tot[red] counter=80 t=8.5e-01 per=2.5e+01 cost=1.3e+07 flops=1.5e+07
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,2.3e-05,2.9e-06,9.9e-07,1.6e-07
    3   0 -    -116.298781495821 -4.808e-04  3.350e-03    3     3  1.718e-01 5.727e-02 4.863e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.347e-04,9.871e-03,2.970e-02,1.257e-02,5.249e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=3.293e-04 speed=1.629e-03GB/S T(nccl)=5.364e-06 speed=1.000e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=81 t=9.9e-03 per=1.9e+01 cost=2.0e+05 flops=2.0e+07
 sigma[gemm] counter=81 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=3 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=4 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.3e+06
 sigma[gemm] counter=81 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.3e+06
 sigma[gemm] counter=81 i=6 t=7.4e-03 per=1.4e+01 cost=2.5e+04 flops=3.4e+06
 sigma[gemm] counter=81 i=7 t=7.4e-03 per=1.4e+01 cost=2.5e+04 flops=3.4e+06
 sigma[gemm] counter=81 total t=3.0e-02 per=5.7e+01 cost=9.9e+04 flops=3.3e+06
 sigma[red] counter=81 t=1.3e-02 per=2.4e+01 cost=3.0e+04 flops=2.4e+06
----- TIMING FOR sigma_tot : t_inter=7.1e-01 t_gemm=1.9e+00 t_reduction=8.6e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=81 t=7.1e-01 per=2.1e+01 cost=7.3e+07 flops=1.0e+08
 sigma_tot[gemm] counter=81 i=0 t=1.7e-04 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=1.5e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=1.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=3 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=4 t=4.9e-01 per=1.4e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=81 i=5 t=4.9e-01 per=1.4e+01 cost=1.5e+07 flops=3.0e+07
 sigma_tot[gemm] counter=81 i=6 t=4.5e-01 per=1.3e+01 cost=1.4e+07 flops=3.0e+07
 sigma_tot[gemm] counter=81 i=7 t=4.5e-01 per=1.3e+01 cost=1.4e+07 flops=3.2e+07
 sigma_tot[gemm] counter=81 total t=1.9e+00 per=5.5e+01 cost=5.7e+07 flops=3.0e+07
 sigma_tot[red] counter=81 t=8.6e-01 per=2.5e+01 cost=1.3e+07 flops=1.5e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.1e-06,1.0e-06,2.1e-07
    4   0 -    -116.298816092521 -3.460e-05  1.166e-03    3     4  2.369e-01 5.922e-02 4.962e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.377e-03,1.002e-02,3.021e-02,1.249e-02,5.410e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=1.371e-03 speed=3.914e-04GB/S T(nccl)=6.133e-06 speed=8.747e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=82 t=1.0e-02 per=1.9e+01 cost=2.0e+05 flops=2.0e+07
 sigma[gemm] counter=82 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=4 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=82 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=82 i=6 t=7.6e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=82 i=7 t=7.5e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=82 total t=3.0e-02 per=5.7e+01 cost=9.9e+04 flops=3.3e+06
 sigma[red] counter=82 t=1.2e-02 per=2.4e+01 cost=3.0e+04 flops=2.4e+06
----- TIMING FOR sigma_tot : t_inter=7.2e-01 t_gemm=1.9e+00 t_reduction=8.7e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=82 t=7.2e-01 per=2.0e+01 cost=7.3e+07 flops=1.0e+08
 sigma_tot[gemm] counter=82 i=0 t=1.8e-04 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=1.5e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=3 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=4 t=5.0e-01 per=1.4e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=82 i=5 t=5.0e-01 per=1.4e+01 cost=1.5e+07 flops=2.9e+07
 sigma_tot[gemm] counter=82 i=6 t=4.6e-01 per=1.3e+01 cost=1.4e+07 flops=3.0e+07
 sigma_tot[gemm] counter=82 i=7 t=4.5e-01 per=1.3e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=82 total t=1.9e+00 per=5.5e+01 cost=5.7e+07 flops=3.0e+07
 sigma_tot[red] counter=82 t=8.7e-01 per=2.5e+01 cost=1.3e+07 flops=1.5e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.1e-06,1.2e-06,2.3e-07
    5   0 -    -116.298821082599 -4.990e-06  3.193e-04    3     5  3.047e-01 6.093e-02 5.054e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.863e-03,9.927e-03,2.995e-02,1.281e-02,5.458e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=1.857e-03 speed=2.889e-04GB/S T(nccl)=6.326e-06 speed=8.480e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=83 t=9.9e-03 per=1.9e+01 cost=2.0e+05 flops=2.0e+07
 sigma[gemm] counter=83 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=4 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.3e+06
 sigma[gemm] counter=83 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.3e+06
 sigma[gemm] counter=83 i=6 t=7.5e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=83 i=7 t=7.6e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=83 total t=3.0e-02 per=5.7e+01 cost=9.9e+04 flops=3.3e+06
 sigma[red] counter=83 t=1.3e-02 per=2.4e+01 cost=3.0e+04 flops=2.3e+06
----- TIMING FOR sigma_tot : t_inter=7.3e-01 t_gemm=1.9e+00 t_reduction=8.9e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=83 t=7.3e-01 per=2.0e+01 cost=7.3e+07 flops=1.0e+08
 sigma_tot[gemm] counter=83 i=0 t=1.8e-04 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=1.5e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=3 t=1.3e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=4 t=5.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.9e+07
 sigma_tot[gemm] counter=83 i=5 t=5.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.9e+07
 sigma_tot[gemm] counter=83 i=6 t=4.6e-01 per=1.3e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=83 i=7 t=4.6e-01 per=1.3e+01 cost=1.4e+07 flops=3.1e+07
 sigma_tot[gemm] counter=83 total t=1.9e+00 per=5.5e+01 cost=5.7e+07 flops=2.9e+07
 sigma_tot[red] counter=83 t=8.9e-01 per=2.5e+01 cost=1.3e+07 flops=1.5e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.2e-06,1.1e-06,2.2e-07
    6   0 +    -116.298821391660 -3.091e-07  6.914e-05    3     6  3.703e-01 6.172e-02 5.123e-02
TIMING FOR Davidson : 3.703e-01  T(cal/comm/rest)=3.074e-01,8.150e-07,6.293e-02
decomposed t_rest=6.293e-02
 T(sub)    =1.423e-04 per=2.261e-01
 T(precond)=6.259e-02 per=9.945e+01
 T(ortho)  =7.354e-05 per=1.168e-01
 T(xcopy)  =9.030e-07 per=1.435e-03
 T(xnrm2)  =2.400e-06 per=3.814e-03
 T(other)  =1.263e-04 per=2.007e-01
optimized energies: isweep=0 ibond=12 dots=2 e[0]=-116.298821391660 nmvp=6
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.265e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=9 dimAll=36
 (20,2):5 (22,2):4 (21,1):3 (21,3):9 (20,4):5 (22,4):4 (21,5):3 (19,3):2 (23,3):1
timing for divide=3.2e-05
timing for compute=1.2e-02
timing for collect=4.0e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=3.2e-05,1.2e-02,0.0e+00,5.1e-06,4.0e-05 -----
decimation summary: 36->7 dwt=+2.220e-16 SvN=3.298e-01
 qbond: qkept nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
----- TIMING for decimation_row(nkr): 1.311e-02 S T(decim/select/formRot)=1.256e-02,4.327e-04,1.119e-04 -----
----- TIMING FOR twodot_decimation: 1.331e-02 S T(wf/decim)=1.800e-04,1.313e-02 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=1039:7.927e-03MB:7.741e-06GB
        per(mem): H:1.25 C:16.2 S:6.93 P:6.93 Q:68.7 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.467e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=99 : 8.370e-03 S -----
rank=0 GPUmem(GB): used=6.390e-05 (oper)=3.211e-05
rank=0 GPUmem(GB): used=6.416e-05 (oper,site)=3.211e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=99
 no. of rintermediate operators=138
 no. of coefficients=1794:1.369e-02MB:1.337e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.462e-03 S -----
rank=0 GPUmem(GB): used=7.753e-05 (oper,site,rinter)=3.211e-05,2.608e-07,1.337e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 4.254e-02 S size(rtasks)=99 size(Rlst2)=16 T(Rmu/Rlist)=2.011e-03,4.053e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.312e-02 S size(rtasks)=99 size(Rlst)=2133 -----
rank=0 GPUmem(GB): used=7.753e-05 avail=6.174e+00 total=6.174e+00 batch[need]=3.019e-04 blksize=6 blksize0=6 batchsize=2133
rank=0 GPUmem(GB): used=3.795e-04 (oper,site,rinter,batch)=3.211e-05,2.608e-07,1.337e-05,3.019e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.282e-03,2.290e-02,1.013e-02
----- TIMING FOR renorm : t_inter=7.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=13 t=7.3e-03 per=1.8e+01 cost=7.2e+04 flops=9.9e+06
 renorm[gemm] counter=13 i=0 t=2.0e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.7e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=1.7e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=3 t=1.7e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=4 t=7.6e-03 per=1.9e+01 cost=9.2e+03 flops=1.2e+06
 renorm[gemm] counter=13 i=5 t=7.6e-03 per=1.9e+01 cost=2.0e+04 flops=2.6e+06
 renorm[gemm] counter=13 i=6 t=7.7e-03 per=1.9e+01 cost=3.4e+04 flops=4.4e+06
 renorm[gemm] counter=13 total t=2.3e-02 per=5.7e+01 cost=6.2e+04 flops=2.7e+06
 renorm[red] counter=13 t=1.0e-02 per=2.5e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=7.7e-02 t_gemm=2.9e-01 t_reduction=1.3e-01 tot=5.0e-01 -----
 renorm_tot[inter] counter=13 t=7.7e-02 per=1.5e+01 cost=1.3e+06 flops=1.6e+07
 renorm_tot[gemm] counter=13 i=0 t=2.0e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=1.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=3 t=1.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=4 t=9.6e-02 per=1.9e+01 cost=1.8e+05 flops=1.8e+06
 renorm_tot[gemm] counter=13 i=5 t=9.8e-02 per=2.0e+01 cost=4.8e+05 flops=4.9e+06
 renorm_tot[gemm] counter=13 i=6 t=9.8e-02 per=2.0e+01 cost=8.4e+05 flops=8.5e+06
 renorm_tot[gemm] counter=13 total t=2.9e-01 per=5.9e+01 cost=1.5e+06 flops=5.1e+06
 renorm_tot[red] counter=13 t=1.3e-01 per=2.6e+01 cost=3.6e+05 flops=2.7e+06
qops.to_cpu: size(tot)=1039:7.9e-03MB:7.7e-06GB T(to_cpu)=1.4e-04S speed=5.4e-02GB/S
check ||H-H.dagger||=3.291e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.124 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.343e-03 change=7.199e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.808e-03 change=-1.729e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.808e-03 change=-2.652e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.099e+00 S #####
 T(local opt: fetch) = 1.185e-02 S  per = 1.08  per(accum) = 1.08
 T(local opt: hdiag) = 4.855e-01 S  per = 44.2  per(accum) = 45.2
 T(local opt: dvdsn) = 4.601e-01 S  per = 41.8  per(accum) = 87.1
 T(local opt: decim) = 1.333e-02 S  per = 1.21  per(accum) = 88.3
 T(local opt: guess) = 6.443e-04 S  per = 0.0586  per(accum) = 88.4
 T(local opt: renrm) = 1.276e-01 S  per = 11.6  per(accum) = 100
 T(local opt: save ) = 4.233e-04 S  per = 0.0385  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.601e-01 S  T(sum) = 4.598e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 8.614e-04 S  per = 0.187  per(accum) = 0.187
 T(local opt: symbolic_formulae           ) = 6.640e-03 S  per = 1.44  per(accum) = 1.63
 T(local opt: hintermediate init          ) = 2.693e-04 S  per = 0.0586  per(accum) = 1.69
 T(local opt: preprocess_hformulae_Hxlist ) = 5.739e-02 S  per = 12.5  per(accum) = 14.2
 T(local opt: hmmtasks init               ) = 2.385e-02 S  per = 5.19  per(accum) = 19.4
 T(local opt: initial guess for dvdson    ) = 4.469e-04 S  per = 0.0972  per(accum) = 19.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.987e-01 S  per =   65  per(accum) = 84.4
 T(local opt: dvdson [cpu-gpu]            ) = 8.654e-03 S  per = 1.88  per(accum) = 86.3
 T(local opt: dvdson [nccl]               ) = 3.499e-05 S  per = 0.00761  per(accum) = 86.3
 T(local opt: dvdson [mpi]                ) = 8.150e-07 S  per = 0.000177  per(accum) = 86.3
 T(local opt: dvdson [rest part(linalg)]  ) = 6.293e-02 S  per = 13.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.276e-01 S  T(sum) = 1.276e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.638e-04 S  per = 0.285  per(accum) = 0.285
 T(local opt: qops init                    ) = 4.361e-03 S  per = 3.42  per(accum) = 3.7
 T(local opt: symbolic_formulae_renorm     ) = 8.390e-03 S  per = 6.57  per(accum) = 10.3
 T(local opt: allocate qops on gpu         ) = 9.007e-05 S  per = 0.0706  per(accum) = 10.3
 T(local opt: site memcpy cpu2gpu          ) = 2.166e-03 S  per =  1.7  per(accum) = 12
 T(local opt: rintermediate init           ) = 2.481e-03 S  per = 1.94  per(accum) = 14
 T(local opt: preprocess_formulae_Rlist2   ) = 4.323e-02 S  per = 33.9  per(accum) = 47.9
 T(local opt: rmmtasks init                ) = 2.240e-02 S  per = 17.5  per(accum) = 65.4
 T(local opt: qops memset on cpu           ) = 4.800e-08 S  per = 3.76e-05  per(accum) = 65.4
 T(local opt: preprocess_renorm_batchGPU   ) = 4.044e-02 S  per = 31.7  per(accum) = 97.1
 T(local opt: deallocate cpu and gpu memory) = 3.981e-04 S  per = 0.312  per(accum) = 97.4
 T(local opt: construct opS [ifdists=true] ) = 5.600e-08 S  per = 4.39e-05  per(accum) = 97.4
 T(local opt: reduction of opS & opH [nccl]) = 5.100e-08 S  per = 4e-05  per(accum) = 97.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.544e-04 S  per = 0.121  per(accum) = 97.5
 T(local opt: reduction of opS & opH [mpi] ) = 5.428e-05 S  per = 0.0425  per(accum) = 97.6
 T(local opt: qops_pool join and erase     ) = 3.099e-03 S  per = 2.43  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.580e-06 S  per = 0.00594  per(accum) = 100
##### sweep opt: 1.852e+01 S #####
 T(sweep opt: fetch) = 2.132e-01 S  per = 1.15  per(accum) = 1.15
 T(sweep opt: hdiag) = 7.809e+00 S  per = 42.2  per(accum) = 43.3
 T(sweep opt: dvdsn) = 8.957e+00 S  per = 48.4  per(accum) = 91.7
 T(sweep opt: decim) = 1.847e-01 S  per = 0.997  per(accum) = 92.7
 T(sweep opt: guess) = 1.648e-02 S  per = 0.089  per(accum) = 92.8
 T(sweep opt: renrm) = 1.337e+00 S  per = 7.22  per(accum) = 100
 T(sweep opt: save ) = 4.784e-03 S  per = 0.0258  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.957e+00 S  T(sum) = 8.940e+00 S  per = 9.981e+01
 T(sweep opt: preprocess                  ) = 7.196e-02 S  per = 0.805  per(accum) = 0.805
 T(sweep opt: symbolic_formulae           ) = 1.102e-01 S  per = 1.23  per(accum) = 2.04
 T(sweep opt: hintermediate init          ) = 4.150e-03 S  per = 0.0464  per(accum) = 2.08
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.026e+00 S  per = 33.8  per(accum) = 35.9
 T(sweep opt: hmmtasks init               ) = 1.157e+00 S  per = 12.9  per(accum) = 48.9
 T(sweep opt: initial guess for dvdson    ) = 1.786e-02 S  per =  0.2  per(accum) = 49.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.572e+00 S  per =   40  per(accum) = 89
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.099e-01 S  per = 1.23  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 5.692e-04 S  per = 0.00637  per(accum) = 90.3
 T(sweep opt: dvdson [mpi]                ) = 1.337e-05 S  per = 0.00015  per(accum) = 90.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.711e-01 S  per = 9.74  per(accum) = 100
Detailed decomposition of T(renrm) = 1.337e+00 S  T(sum) = 1.337e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.400e-03 S  per = 0.254  per(accum) = 0.254
 T(sweep opt: qops init                    ) = 4.996e-02 S  per = 3.74  per(accum) = 3.99
 T(sweep opt: symbolic_formulae_renorm     ) = 6.170e-02 S  per = 4.62  per(accum) = 8.61
 T(sweep opt: allocate qops on gpu         ) = 2.658e-03 S  per = 0.199  per(accum) = 8.81
 T(sweep opt: site memcpy cpu2gpu          ) = 1.793e-02 S  per = 1.34  per(accum) = 10.1
 T(sweep opt: rintermediate init           ) = 3.283e-02 S  per = 2.46  per(accum) = 12.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.871e-01 S  per =   29  per(accum) = 41.6
 T(sweep opt: rmmtasks init                ) = 2.002e-01 S  per =   15  per(accum) = 56.5
 T(sweep opt: qops memset on cpu           ) = 5.570e-07 S  per = 4.17e-05  per(accum) = 56.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.014e-01 S  per = 37.5  per(accum) = 94.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.804e-03 S  per = 0.135  per(accum) = 94.2
 T(sweep opt: construct opS [ifdists=true] ) = 7.580e-07 S  per = 5.67e-05  per(accum) = 94.2
 T(sweep opt: reduction of opS & opH [nccl]) = 5.470e-07 S  per = 4.09e-05  per(accum) = 94.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.745e-03 S  per = 0.131  per(accum) = 94.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.824e-04 S  per = 0.0436  per(accum) = 94.4
 T(sweep opt: qops_pool join and erase     ) = 4.291e-02 S  per = 3.21  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 3.240e-02 S  per = 2.42  per(accum) = 100
##### global opt: 1.852e+01 S #####
 T(global opt: fetch) = 2.132e-01 S  per = 1.15  per(accum) = 1.15
 T(global opt: hdiag) = 7.809e+00 S  per = 42.2  per(accum) = 43.3
 T(global opt: dvdsn) = 8.957e+00 S  per = 48.4  per(accum) = 91.7
 T(global opt: decim) = 1.847e-01 S  per = 0.997  per(accum) = 92.7
 T(global opt: guess) = 1.648e-02 S  per = 0.089  per(accum) = 92.8
 T(global opt: renrm) = 1.337e+00 S  per = 7.22  per(accum) = 100
 T(global opt: save ) = 4.784e-03 S  per = 0.0258  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.957e+00 S  T(sum) = 8.940e+00 S  per = 9.981e+01
 T(global opt: preprocess                  ) = 7.196e-02 S  per = 0.805  per(accum) = 0.805
 T(global opt: symbolic_formulae           ) = 1.102e-01 S  per = 1.23  per(accum) = 2.04
 T(global opt: hintermediate init          ) = 4.150e-03 S  per = 0.0464  per(accum) = 2.08
 T(global opt: preprocess_hformulae_Hxlist ) = 3.026e+00 S  per = 33.8  per(accum) = 35.9
 T(global opt: hmmtasks init               ) = 1.157e+00 S  per = 12.9  per(accum) = 48.9
 T(global opt: initial guess for dvdson    ) = 1.786e-02 S  per =  0.2  per(accum) = 49.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.572e+00 S  per =   40  per(accum) = 89
 T(global opt: dvdson [cpu-gpu]            ) = 1.099e-01 S  per = 1.23  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 5.692e-04 S  per = 0.00637  per(accum) = 90.3
 T(global opt: dvdson [mpi]                ) = 1.337e-05 S  per = 0.00015  per(accum) = 90.3
 T(global opt: dvdson [rest part(linalg)]  ) = 8.711e-01 S  per = 9.74  per(accum) = 100
Detailed decomposition of T(renrm) = 1.337e+00 S  T(sum) = 1.337e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.400e-03 S  per = 0.254  per(accum) = 0.254
 T(global opt: qops init                    ) = 4.996e-02 S  per = 3.74  per(accum) = 3.99
 T(global opt: symbolic_formulae_renorm     ) = 6.170e-02 S  per = 4.62  per(accum) = 8.61
 T(global opt: allocate qops on gpu         ) = 2.658e-03 S  per = 0.199  per(accum) = 8.81
 T(global opt: site memcpy cpu2gpu          ) = 1.793e-02 S  per = 1.34  per(accum) = 10.1
 T(global opt: rintermediate init           ) = 3.283e-02 S  per = 2.46  per(accum) = 12.6
 T(global opt: preprocess_formulae_Rlist2   ) = 3.871e-01 S  per =   29  per(accum) = 41.6
 T(global opt: rmmtasks init                ) = 2.002e-01 S  per =   15  per(accum) = 56.5
 T(global opt: qops memset on cpu           ) = 5.570e-07 S  per = 4.17e-05  per(accum) = 56.5
 T(global opt: preprocess_renorm_batchGPU   ) = 5.014e-01 S  per = 37.5  per(accum) = 94.1
 T(global opt: deallocate cpu and gpu memory) = 1.804e-03 S  per = 0.135  per(accum) = 94.2
 T(global opt: construct opS [ifdists=true] ) = 7.580e-07 S  per = 5.67e-05  per(accum) = 94.2
 T(global opt: reduction of opS & opH [nccl]) = 5.470e-07 S  per = 4.09e-05  per(accum) = 94.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.745e-03 S  per = 0.131  per(accum) = 94.3
 T(global opt: reduction of opS & opH [mpi] ) = 5.824e-04 S  per = 0.0436  per(accum) = 94.4
 T(global opt: qops_pool join and erase     ) = 4.291e-02 S  per = 3.21  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 3.240e-02 S  per = 2.42  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.256e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=13/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=571:4.356e-03MB:4.254e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=586:4.471e-03MB:4.366e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=1039:7.927e-03MB:7.741e-06GB
        per(mem): H:1.25 C:16.2 S:6.93 P:6.93 Q:68.7 
 rqops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3180:0.0243MB:2.37e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.371e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-7.749e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,3,3,3) nnz=44:3.357e-04MB
qtensor4: wf4 own=1 _data=0x3a9caf20
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
 qbond: qcol nsym=2 dimAll=3
 (5,3):2 (6,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=18 nblocks=128 size=44:3.357e-04MB
### DIAG TIMING: total=2.858e-01 t1=3.125e-05, t2=1.822e-03, t3=2.499e-03, t4=2.814e-01, t5=4.148e-06, t6=1.528e-05, t7=3.962e-06
duration_diagGPU:2.858e-01
duration_diagreduce:6.200e-08
duration_diagtransform:3.730e-07
----- TIMING FOR symbolic_formulae_twodot with size=371 : 5.072e-03 S -----
rank=0 GPUmem(GB): used=2.369e-05 (oper)=2.369e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=371
 no. of hintermediate operators=174
 no. of coefficients=2358:1.799e-02MB:1.757e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.882e-04 S -----
rank=0 GPUmem(GB): used=4.126e-05 (oper,hinter)=2.369e-05,1.757e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.127e-01 S size(H_formulae)=371 size(Hxlst2)=18 T(Hmu/Hxlist)=9.611e-04,1.118e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.138e-01 S size(H_formulae)=371 size(Hxlst)=6920 -----
rank=0 GPUmem(GB): used=4.126e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=6.557e-07 batch[need]=6.703e-04 blksize=4 blksize0=4 batchsize=6920
rank=0 GPUmem(GB): used=7.122e-04 (oper,hinter,dvdson,batch)=2.369e-05,1.757e-05,6.557e-07,6.703e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=44 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.298e-04,1.026e-02,3.010e-02,1.302e-02,5.413e-02
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=7.167e-04 speed=9.149e-04GB/S T(nccl)=1.314e-05 speed=4.989e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=84 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=84 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=84 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=84 i=6 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=84 i=7 t=7.5e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=84 total t=3.0e-02 per=5.6e+01 cost=9.0e+04 flops=3.0e+06
 sigma[red] counter=84 t=1.3e-02 per=2.4e+01 cost=3.4e+04 flops=2.6e+06
----- TIMING FOR sigma_tot : t_inter=7.4e-01 t_gemm=2.0e+00 t_reduction=9.0e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=84 t=7.4e-01 per=2.0e+01 cost=7.3e+07 flops=9.9e+07
 sigma_tot[gemm] counter=84 i=0 t=1.8e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=1.5e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=3 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=4 t=5.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.8e+07
 sigma_tot[gemm] counter=84 i=5 t=5.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.8e+07
 sigma_tot[gemm] counter=84 i=6 t=4.7e-01 per=1.3e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=84 i=7 t=4.7e-01 per=1.3e+01 cost=1.4e+07 flops=3.0e+07
 sigma_tot[gemm] counter=84 total t=2.0e+00 per=5.5e+01 cost=5.7e+07 flops=2.9e+07
 sigma_tot[red] counter=84 t=9.0e-01 per=2.5e+01 cost=1.3e+07 flops=1.5e+07
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,9.1e-06,2.1e-06,1.1e-06,2.0e-07
settings: ndim=44 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.298821391660 -1.116e+03  2.683e-02    1     1  5.427e-02 5.427e-02 5.424e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.507e-04,1.004e-02,3.011e-02,1.278e-02,5.330e-02
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=3.444e-04 speed=1.904e-03GB/S T(nccl)=6.272e-06 speed=1.045e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=85 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=85 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=85 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=85 i=6 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=85 i=7 t=7.4e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=85 total t=3.0e-02 per=5.7e+01 cost=9.0e+04 flops=3.0e+06
 sigma[red] counter=85 t=1.3e-02 per=2.4e+01 cost=3.4e+04 flops=2.7e+06
----- TIMING FOR sigma_tot : t_inter=7.5e-01 t_gemm=2.0e+00 t_reduction=9.1e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=85 t=7.5e-01 per=2.0e+01 cost=7.4e+07 flops=9.8e+07
 sigma_tot[gemm] counter=85 i=0 t=1.8e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.6e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=1.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=3 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=4 t=5.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.8e+07
 sigma_tot[gemm] counter=85 i=5 t=5.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.8e+07
 sigma_tot[gemm] counter=85 i=6 t=4.8e-01 per=1.3e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=85 i=7 t=4.8e-01 per=1.3e+01 cost=1.4e+07 flops=3.0e+07
 sigma_tot[gemm] counter=85 total t=2.0e+00 per=5.5e+01 cost=5.7e+07 flops=2.9e+07
 sigma_tot[red] counter=85 t=9.1e-01 per=2.5e+01 cost=1.3e+07 flops=1.4e+07
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,3.8e-05,3.5e-06,9.9e-07,2.5e-07
    2   0 -    -116.301168729010 -2.347e-03  9.570e-03    2     2  1.202e-01 6.010e-02 5.382e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.847e-03,1.005e-02,3.018e-02,1.313e-02,5.522e-02
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=1.839e-03 speed=3.565e-04GB/S T(nccl)=7.931e-06 speed=8.267e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=86 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=86 i=0 t=2.2e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=2.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=3 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=86 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=86 i=6 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=86 i=7 t=7.5e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=86 total t=3.0e-02 per=5.7e+01 cost=9.0e+04 flops=3.0e+06
 sigma[red] counter=86 t=1.3e-02 per=2.5e+01 cost=3.4e+04 flops=2.6e+06
----- TIMING FOR sigma_tot : t_inter=7.6e-01 t_gemm=2.0e+00 t_reduction=9.2e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=86 t=7.6e-01 per=2.0e+01 cost=7.4e+07 flops=9.7e+07
 sigma_tot[gemm] counter=86 i=0 t=1.8e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.6e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=1.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=3 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=4 t=5.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=86 i=5 t=5.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.8e+07
 sigma_tot[gemm] counter=86 i=6 t=4.9e-01 per=1.3e+01 cost=1.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=86 i=7 t=4.8e-01 per=1.3e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=86 total t=2.0e+00 per=5.5e+01 cost=5.7e+07 flops=2.8e+07
 sigma_tot[red] counter=86 t=9.2e-01 per=2.5e+01 cost=1.3e+07 flops=1.4e+07
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,3.7e-05,3.8e-06,1.4e-06,2.8e-07
    3   0 -    -116.301414230834 -2.455e-04  3.487e-03    3     3  1.866e-01 6.221e-02 5.434e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.768e-04,1.007e-02,1.956e-02,3.366e-03,3.328e-02
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.701e-04 speed=2.427e-03GB/S T(nccl)=6.734e-06 speed=9.736e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.0e-02 t_reduction=3.4e-03 tot=3.3e-02 -----
 sigma[inter] counter=87 t=1.0e-02 per=3.1e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=87 i=0 t=1.7e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=1.5e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=1.5e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=3 t=1.5e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=4 t=7.6e-03 per=2.3e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=87 i=5 t=7.6e-03 per=2.3e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=87 i=6 t=2.9e-03 per=8.8e+00 cost=2.3e+04 flops=7.8e+06
 sigma[gemm] counter=87 i=7 t=1.5e-03 per=4.5e+00 cost=2.5e+04 flops=1.7e+07
 sigma[gemm] counter=87 total t=2.0e-02 per=5.9e+01 cost=9.0e+04 flops=4.6e+06
 sigma[red] counter=87 t=3.4e-03 per=1.0e+01 cost=3.4e+04 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=7.7e-01 t_gemm=2.1e+00 t_reduction=9.3e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=87 t=7.7e-01 per=2.0e+01 cost=7.4e+07 flops=9.6e+07
 sigma_tot[gemm] counter=87 i=0 t=1.8e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=1.6e-04 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=1.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=3 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=4 t=5.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=87 i=5 t=5.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=87 i=6 t=4.9e-01 per=1.3e+01 cost=1.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=87 i=7 t=4.9e-01 per=1.3e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=87 total t=2.1e+00 per=5.5e+01 cost=5.7e+07 flops=2.8e+07
 sigma_tot[red] counter=87 t=9.3e-01 per=2.5e+01 cost=1.3e+07 flops=1.4e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.1e-06,1.1e-06,2.4e-07
    4   0 -    -116.301450947453 -3.672e-05  1.343e-03    3     4  2.325e-01 5.813e-02 4.910e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.176e-03,9.973e-03,2.991e-02,1.273e-02,5.380e-02
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=1.169e-03 speed=5.607e-04GB/S T(nccl)=6.620e-06 speed=9.904e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=88 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=88 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=4 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=88 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=88 i=6 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=88 i=7 t=7.4e-03 per=1.4e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=88 total t=3.0e-02 per=5.7e+01 cost=9.0e+04 flops=3.0e+06
 sigma[red] counter=88 t=1.3e-02 per=2.4e+01 cost=3.4e+04 flops=2.7e+06
----- TIMING FOR sigma_tot : t_inter=7.8e-01 t_gemm=2.1e+00 t_reduction=9.4e-01 tot=3.8e+00 -----
 sigma_tot[inter] counter=88 t=7.8e-01 per=2.0e+01 cost=7.4e+07 flops=9.5e+07
 sigma_tot[gemm] counter=88 i=0 t=1.9e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=1.6e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=1.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=3 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=4 t=5.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=88 i=5 t=5.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=88 i=6 t=5.0e-01 per=1.3e+01 cost=1.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=88 i=7 t=4.9e-01 per=1.3e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=88 total t=2.1e+00 per=5.5e+01 cost=5.7e+07 flops=2.8e+07
 sigma_tot[red] counter=88 t=9.4e-01 per=2.5e+01 cost=1.3e+07 flops=1.4e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.2e-06,1.1e-06,2.7e-07
    5   0 -    -116.301456187403 -5.240e-06  3.883e-04    3     5  2.978e-01 5.956e-02 5.006e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.269e-03,1.002e-02,2.968e-02,1.277e-02,5.475e-02
 analyze_tgpu[Hx]: ndim=44:3.278e-07GB T(cpu-gpu)=2.263e-03 speed=2.897e-04GB/S T(nccl)=5.615e-06 speed=1.168e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=89 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=89 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=89 i=5 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=89 i=6 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=89 i=7 t=7.4e-03 per=1.4e+01 cost=2.5e+04 flops=3.4e+06
 sigma[gemm] counter=89 total t=3.0e-02 per=5.7e+01 cost=9.0e+04 flops=3.0e+06
 sigma[red] counter=89 t=1.3e-02 per=2.4e+01 cost=3.4e+04 flops=2.7e+06
----- TIMING FOR sigma_tot : t_inter=7.9e-01 t_gemm=2.1e+00 t_reduction=9.5e-01 tot=3.9e+00 -----
 sigma_tot[inter] counter=89 t=7.9e-01 per=2.0e+01 cost=7.5e+07 flops=9.5e+07
 sigma_tot[gemm] counter=89 i=0 t=1.9e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=1.6e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=1.4e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=3 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=4 t=5.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=89 i=5 t=5.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=89 i=6 t=5.0e-01 per=1.3e+01 cost=1.4e+07 flops=2.7e+07
 sigma_tot[gemm] counter=89 i=7 t=5.0e-01 per=1.3e+01 cost=1.4e+07 flops=2.9e+07
 sigma_tot[gemm] counter=89 total t=2.1e+00 per=5.5e+01 cost=5.8e+07 flops=2.7e+07
 sigma_tot[red] counter=89 t=9.5e-01 per=2.5e+01 cost=1.3e+07 flops=1.4e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.1e-06,1.1e-06,2.3e-07
    6   0 +    -116.301456582762 -3.954e-07  7.438e-05    3     6  3.653e-01 6.089e-02 5.086e-02
TIMING FOR Davidson : 3.653e-01  T(cal/comm/rest)=3.052e-01,8.700e-07,6.015e-02
decomposed t_rest=6.015e-02
 T(sub)    =1.815e-04 per=3.018e-01
 T(precond)=5.979e-02 per=9.939e+01
 T(ortho)  =4.093e-05 per=6.804e-02
 T(xcopy)  =9.070e-07 per=1.508e-03
 T(xnrm2)  =1.243e-05 per=2.066e-02
 T(other)  =1.290e-04 per=2.145e-01
optimized energies: isweep=0 ibond=13 dots=2 e[0]=-116.301456582762 nmvp=6
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.534e-03 change=1.911e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=9 dimAll=28
 (22,2):4 (24,2):3 (23,1):2 (23,3):7 (21,3):2 (22,4):4 (24,4):3 (23,5):2 (25,3):1
timing for divide=4.4e-05
timing for compute=1.1e-02
timing for collect=3.9e-05
----- TMING FOR decimation_genbasis(su2): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=4.4e-05,1.1e-02,0.0e+00,5.7e-06,3.9e-05 -----
decimation summary: 28->10 dwt=+7.605e-09 SvN=1.460e-01
 qbond: qkept nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
----- TIMING for decimation_row(nkr): 1.148e-02 S T(decim/select/formRot)=1.105e-02,3.280e-04,1.049e-04 -----
----- TIMING FOR twodot_decimation: 1.180e-02 S T(wf/decim)=3.079e-04,1.150e-02 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1425:1.087e-02MB:1.062e-05GB
        per(mem): H:1.4 C:23.2 S:7.72 P:10.9 Q:56.8 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.534e-03 change=2.159e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 3.475e-03 S -----
rank=0 GPUmem(GB): used=5.080e-05 (oper)=2.579e-05
rank=0 GPUmem(GB): used=5.110e-05 (oper,site)=2.579e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=76
 no. of rintermediate operators=100
 no. of coefficients=1400:1.068e-02MB:1.043e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.501e-03 S -----
rank=0 GPUmem(GB): used=6.153e-05 (oper,site,rinter)=2.579e-05,2.980e-07,1.043e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.060e-02 S size(rtasks)=76 size(Rlst2)=36 T(Rmu/Rlist)=8.869e-04,2.971e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.106e-02 S size(rtasks)=76 size(Rlst)=2429 -----
rank=0 GPUmem(GB): used=6.153e-05 avail=6.174e+00 total=6.174e+00 batch[need]=4.162e-04 blksize=9 blksize0=4 batchsize=2429
rank=0 GPUmem(GB): used=4.778e-04 (oper,site,rinter,batch)=2.579e-05,2.980e-07,1.043e-05,4.162e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.566e-03,2.245e-02,1.002e-02
----- TIMING FOR renorm : t_inter=5.6e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=14 t=5.6e-03 per=1.5e+01 cost=6.0e+04 flops=1.1e+07
 renorm[gemm] counter=14 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=4 t=7.5e-03 per=2.0e+01 cost=8.9e+03 flops=1.2e+06
 renorm[gemm] counter=14 i=5 t=7.5e-03 per=2.0e+01 cost=1.6e+04 flops=2.1e+06
 renorm[gemm] counter=14 i=6 t=7.5e-03 per=2.0e+01 cost=3.9e+04 flops=5.2e+06
 renorm[gemm] counter=14 total t=2.2e-02 per=5.9e+01 cost=6.3e+04 flops=2.8e+06
 renorm[red] counter=14 t=1.0e-02 per=2.6e+01 cost=2.3e+04 flops=2.3e+06
----- TIMING FOR renorm_tot : t_inter=8.2e-02 t_gemm=3.2e-01 t_reduction=1.4e-01 tot=5.4e-01 -----
 renorm_tot[inter] counter=14 t=8.2e-02 per=1.5e+01 cost=1.3e+06 flops=1.6e+07
 renorm_tot[gemm] counter=14 i=0 t=2.2e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.9e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=1.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=3 t=1.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=4 t=1.0e-01 per=1.9e+01 cost=1.9e+05 flops=1.8e+06
 renorm_tot[gemm] counter=14 i=5 t=1.1e-01 per=2.0e+01 cost=5.0e+05 flops=4.7e+06
 renorm_tot[gemm] counter=14 i=6 t=1.1e-01 per=2.0e+01 cost=8.8e+05 flops=8.3e+06
 renorm_tot[gemm] counter=14 total t=3.2e-01 per=5.9e+01 cost=1.6e+06 flops=5.0e+06
 renorm_tot[red] counter=14 t=1.4e-01 per=2.6e+01 cost=3.8e+05 flops=2.7e+06
qops.to_cpu: size(tot)=1425:1.1e-02MB:1.1e-05GB T(to_cpu)=9.5e-05S speed=1.1e-01GB/S
check ||H-H.dagger||=1.314e-14 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.095 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.152e-03 change=7.373e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.678e-03 change=-1.693e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.678e-03 change=-3.740e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 9.484e-01 S #####
 T(local opt: fetch) = 1.369e-02 S  per = 1.44  per(accum) = 1.44
 T(local opt: hdiag) = 2.862e-01 S  per = 30.2  per(accum) = 31.6
 T(local opt: dvdsn) = 5.381e-01 S  per = 56.7  per(accum) = 88.4
 T(local opt: decim) = 1.182e-02 S  per = 1.25  per(accum) = 89.6
 T(local opt: guess) = 7.091e-04 S  per = 0.0748  per(accum) = 89.7
 T(local opt: renrm) = 9.763e-02 S  per = 10.3  per(accum) = 100
 T(local opt: save ) = 3.176e-04 S  per = 0.0335  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.381e-01 S  T(sum) = 5.374e-01 S  per = 9.987e+01
 T(local opt: preprocess                  ) = 1.833e-03 S  per = 0.341  per(accum) = 0.341
 T(local opt: symbolic_formulae           ) = 5.085e-03 S  per = 0.946  per(accum) = 1.29
 T(local opt: hintermediate init          ) = 2.045e-04 S  per = 0.038  per(accum) = 1.33
 T(local opt: preprocess_hformulae_Hxlist ) = 1.142e-01 S  per = 21.3  per(accum) = 22.6
 T(local opt: hmmtasks init               ) = 5.008e-02 S  per = 9.32  per(accum) = 31.9
 T(local opt: initial guess for dvdson    ) = 6.194e-04 S  per = 0.115  per(accum) = 32
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.985e-01 S  per = 55.6  per(accum) = 87.6
 T(local opt: dvdson [cpu-gpu]            ) = 6.603e-03 S  per = 1.23  per(accum) = 88.8
 T(local opt: dvdson [nccl]               ) = 4.631e-05 S  per = 0.00862  per(accum) = 88.8
 T(local opt: dvdson [mpi]                ) = 8.700e-07 S  per = 0.000162  per(accum) = 88.8
 T(local opt: dvdson [rest part(linalg)]  ) = 6.015e-02 S  per = 11.2  per(accum) = 100
Detailed decomposition of T(renrm) = 9.763e-02 S  T(sum) = 9.763e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.493e-04 S  per = 0.358  per(accum) = 0.358
 T(local opt: qops init                    ) = 3.821e-03 S  per = 3.91  per(accum) = 4.27
 T(local opt: symbolic_formulae_renorm     ) = 3.486e-03 S  per = 3.57  per(accum) = 7.84
 T(local opt: allocate qops on gpu         ) = 6.122e-05 S  per = 0.0627  per(accum) = 7.9
 T(local opt: site memcpy cpu2gpu          ) = 3.142e-04 S  per = 0.322  per(accum) = 8.23
 T(local opt: rintermediate init           ) = 2.512e-03 S  per = 2.57  per(accum) = 10.8
 T(local opt: preprocess_formulae_Rlist2   ) = 3.114e-02 S  per = 31.9  per(accum) = 42.7
 T(local opt: rmmtasks init                ) = 1.522e-02 S  per = 15.6  per(accum) = 58.3
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 3.07e-05  per(accum) = 58.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.812e-02 S  per =   39  per(accum) = 97.3
 T(local opt: deallocate cpu and gpu memory) = 1.030e-04 S  per = 0.105  per(accum) = 97.4
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 4.3e-05  per(accum) = 97.4
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 3.89e-05  per(accum) = 97.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.033e-04 S  per = 0.106  per(accum) = 97.5
 T(local opt: reduction of opS & opH [mpi] ) = 7.720e-05 S  per = 0.0791  per(accum) = 97.6
 T(local opt: qops_pool join and erase     ) = 2.314e-03 S  per = 2.37  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.499e-06 S  per = 0.00768  per(accum) = 100
##### sweep opt: 1.947e+01 S #####
 T(sweep opt: fetch) = 2.269e-01 S  per = 1.17  per(accum) = 1.17
 T(sweep opt: hdiag) = 8.095e+00 S  per = 41.6  per(accum) = 42.7
 T(sweep opt: dvdsn) = 9.495e+00 S  per = 48.8  per(accum) = 91.5
 T(sweep opt: decim) = 1.965e-01 S  per = 1.01  per(accum) = 92.5
 T(sweep opt: guess) = 1.719e-02 S  per = 0.0883  per(accum) = 92.6
 T(sweep opt: renrm) = 1.434e+00 S  per = 7.37  per(accum) = 100
 T(sweep opt: save ) = 5.102e-03 S  per = 0.0262  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.495e+00 S  T(sum) = 9.478e+00 S  per = 9.981e+01
 T(sweep opt: preprocess                  ) = 7.379e-02 S  per = 0.779  per(accum) = 0.779
 T(sweep opt: symbolic_formulae           ) = 1.153e-01 S  per = 1.22  per(accum) = 1.99
 T(sweep opt: hintermediate init          ) = 4.354e-03 S  per = 0.0459  per(accum) = 2.04
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.140e+00 S  per = 33.1  per(accum) = 35.2
 T(sweep opt: hmmtasks init               ) = 1.207e+00 S  per = 12.7  per(accum) = 47.9
 T(sweep opt: initial guess for dvdson    ) = 1.848e-02 S  per = 0.195  per(accum) = 48.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.871e+00 S  per = 40.8  per(accum) = 88.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.165e-01 S  per = 1.23  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 6.155e-04 S  per = 0.00649  per(accum) = 90.2
 T(sweep opt: dvdson [mpi]                ) = 1.424e-05 S  per = 0.00015  per(accum) = 90.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.313e-01 S  per = 9.83  per(accum) = 100
Detailed decomposition of T(renrm) = 1.434e+00 S  T(sum) = 1.434e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.750e-03 S  per = 0.261  per(accum) = 0.261
 T(sweep opt: qops init                    ) = 5.378e-02 S  per = 3.75  per(accum) = 4.01
 T(sweep opt: symbolic_formulae_renorm     ) = 6.519e-02 S  per = 4.55  per(accum) = 8.56
 T(sweep opt: allocate qops on gpu         ) = 2.720e-03 S  per = 0.19  per(accum) = 8.75
 T(sweep opt: site memcpy cpu2gpu          ) = 1.824e-02 S  per = 1.27  per(accum) = 10
 T(sweep opt: rintermediate init           ) = 3.534e-02 S  per = 2.46  per(accum) = 12.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.182e-01 S  per = 29.2  per(accum) = 41.6
 T(sweep opt: rmmtasks init                ) = 2.154e-01 S  per =   15  per(accum) = 56.7
 T(sweep opt: qops memset on cpu           ) = 5.870e-07 S  per = 4.09e-05  per(accum) = 56.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.395e-01 S  per = 37.6  per(accum) = 94.3
 T(sweep opt: deallocate cpu and gpu memory) = 1.907e-03 S  per = 0.133  per(accum) = 94.4
 T(sweep opt: construct opS [ifdists=true] ) = 8.000e-07 S  per = 5.58e-05  per(accum) = 94.4
 T(sweep opt: reduction of opS & opH [nccl]) = 5.850e-07 S  per = 4.08e-05  per(accum) = 94.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.848e-03 S  per = 0.129  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.596e-04 S  per = 0.046  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 4.523e-02 S  per = 3.15  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 3.241e-02 S  per = 2.26  per(accum) = 100
##### global opt: 1.947e+01 S #####
 T(global opt: fetch) = 2.269e-01 S  per = 1.17  per(accum) = 1.17
 T(global opt: hdiag) = 8.095e+00 S  per = 41.6  per(accum) = 42.7
 T(global opt: dvdsn) = 9.495e+00 S  per = 48.8  per(accum) = 91.5
 T(global opt: decim) = 1.965e-01 S  per = 1.01  per(accum) = 92.5
 T(global opt: guess) = 1.719e-02 S  per = 0.0883  per(accum) = 92.6
 T(global opt: renrm) = 1.434e+00 S  per = 7.37  per(accum) = 100
 T(global opt: save ) = 5.102e-03 S  per = 0.0262  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.495e+00 S  T(sum) = 9.478e+00 S  per = 9.981e+01
 T(global opt: preprocess                  ) = 7.379e-02 S  per = 0.779  per(accum) = 0.779
 T(global opt: symbolic_formulae           ) = 1.153e-01 S  per = 1.22  per(accum) = 1.99
 T(global opt: hintermediate init          ) = 4.354e-03 S  per = 0.0459  per(accum) = 2.04
 T(global opt: preprocess_hformulae_Hxlist ) = 3.140e+00 S  per = 33.1  per(accum) = 35.2
 T(global opt: hmmtasks init               ) = 1.207e+00 S  per = 12.7  per(accum) = 47.9
 T(global opt: initial guess for dvdson    ) = 1.848e-02 S  per = 0.195  per(accum) = 48.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.871e+00 S  per = 40.8  per(accum) = 88.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.165e-01 S  per = 1.23  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 6.155e-04 S  per = 0.00649  per(accum) = 90.2
 T(global opt: dvdson [mpi]                ) = 1.424e-05 S  per = 0.00015  per(accum) = 90.2
 T(global opt: dvdson [rest part(linalg)]  ) = 9.313e-01 S  per = 9.83  per(accum) = 100
Detailed decomposition of T(renrm) = 1.434e+00 S  T(sum) = 1.434e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.750e-03 S  per = 0.261  per(accum) = 0.261
 T(global opt: qops init                    ) = 5.378e-02 S  per = 3.75  per(accum) = 4.01
 T(global opt: symbolic_formulae_renorm     ) = 6.519e-02 S  per = 4.55  per(accum) = 8.56
 T(global opt: allocate qops on gpu         ) = 2.720e-03 S  per = 0.19  per(accum) = 8.75
 T(global opt: site memcpy cpu2gpu          ) = 1.824e-02 S  per = 1.27  per(accum) = 10
 T(global opt: rintermediate init           ) = 3.534e-02 S  per = 2.46  per(accum) = 12.5
 T(global opt: preprocess_formulae_Rlist2   ) = 4.182e-01 S  per = 29.2  per(accum) = 41.6
 T(global opt: rmmtasks init                ) = 2.154e-01 S  per =   15  per(accum) = 56.7
 T(global opt: qops memset on cpu           ) = 5.870e-07 S  per = 4.09e-05  per(accum) = 56.7
 T(global opt: preprocess_renorm_batchGPU   ) = 5.395e-01 S  per = 37.6  per(accum) = 94.3
 T(global opt: deallocate cpu and gpu memory) = 1.907e-03 S  per = 0.133  per(accum) = 94.4
 T(global opt: construct opS [ifdists=true] ) = 8.000e-07 S  per = 5.58e-05  per(accum) = 94.4
 T(global opt: reduction of opS & opH [nccl]) = 5.850e-07 S  per = 4.08e-05  per(accum) = 94.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.848e-03 S  per = 0.129  per(accum) = 94.5
 T(global opt: reduction of opS & opH [mpi] ) = 6.596e-04 S  per = 0.046  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 4.523e-02 S  per = 3.15  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 3.241e-02 S  per = 2.26  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=14/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=603:4.601e-03MB:4.493e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=627:4.784e-03MB:4.672e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1425:1.087e-02MB:1.062e-05GB
        per(mem): H:1.4 C:23.2 S:7.72 P:10.9 Q:56.8 
 rqops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3526:0.0269MB:2.63e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.268e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-4.172e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=57:4.349e-04MB
qtensor4: wf4 own=1 _data=0x3ad27e00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
 qbond: qcol nsym=2 dimAll=3
 (3,3):1 (4,2):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=57:4.349e-04MB
### DIAG TIMING: total=2.170e-01 t1=2.623e-05, t2=1.786e-03, t3=2.486e-03, t4=2.127e-01, t5=4.078e-06, t6=1.532e-05, t7=3.516e-06
duration_diagGPU:2.170e-01
duration_diagreduce:6.500e-08
duration_diagtransform:5.600e-07
----- TIMING FOR symbolic_formulae_twodot with size=273 : 3.665e-03 S -----
rank=0 GPUmem(GB): used=2.627e-05 (oper)=2.627e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=273
 no. of hintermediate operators=118
 no. of coefficients=1632:1.245e-02MB:1.216e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.344e-04 S -----
rank=0 GPUmem(GB): used=3.843e-05 (oper,hinter)=2.627e-05,1.216e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.017e-01 S size(H_formulae)=273 size(Hxlst2)=21 T(Hmu/Hxlist)=6.831e-04,1.010e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.027e-01 S size(H_formulae)=273 size(Hxlst)=6428 -----
rank=0 GPUmem(GB): used=3.843e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=8.494e-07 batch[need]=9.100e-04 blksize=6 blksize0=6 batchsize=6428
rank=0 GPUmem(GB): used=9.492e-04 (oper,hinter,dvdson,batch)=2.627e-05,1.216e-05,8.494e-07,9.100e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.238e-03,1.003e-02,2.983e-02,1.292e-02,5.402e-02
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=1.231e-03 speed=6.901e-04GB/S T(nccl)=6.908e-06 speed=1.230e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=90 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=90 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=4 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=90 i=5 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=90 i=6 t=7.4e-03 per=1.4e+01 cost=2.9e+04 flops=3.9e+06
 sigma[gemm] counter=90 i=7 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=90 total t=3.0e-02 per=5.7e+01 cost=9.7e+04 flops=3.2e+06
 sigma[red] counter=90 t=1.3e-02 per=2.4e+01 cost=3.7e+04 flops=2.8e+06
----- TIMING FOR sigma_tot : t_inter=8.0e-01 t_gemm=2.1e+00 t_reduction=9.7e-01 tot=3.9e+00 -----
 sigma_tot[inter] counter=90 t=8.0e-01 per=2.0e+01 cost=7.5e+07 flops=9.4e+07
 sigma_tot[gemm] counter=90 i=0 t=1.9e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=1.6e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=1.4e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=3 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=4 t=5.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=90 i=5 t=5.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=90 i=6 t=5.1e-01 per=1.3e+01 cost=1.4e+07 flops=2.7e+07
 sigma_tot[gemm] counter=90 i=7 t=5.1e-01 per=1.3e+01 cost=1.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=90 total t=2.1e+00 per=5.5e+01 cost=5.8e+07 flops=2.7e+07
 sigma_tot[red] counter=90 t=9.7e-01 per=2.5e+01 cost=1.3e+07 flops=1.4e+07
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.3e-06,2.1e-06,9.1e-07,2.2e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.301456576461 -1.116e+03  3.490e-02    1     1  5.415e-02 5.415e-02 5.412e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.788e-03,1.008e-02,2.985e-02,1.272e-02,5.445e-02
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=1.779e-03 speed=4.775e-04GB/S T(nccl)=8.815e-06 speed=9.635e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=91 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=91 i=0 t=3.3e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=2.8e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=2.8e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=3 t=2.8e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.7e+06
 sigma[gemm] counter=91 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.7e+06
 sigma[gemm] counter=91 i=6 t=7.4e-03 per=1.4e+01 cost=2.9e+04 flops=3.9e+06
 sigma[gemm] counter=91 i=7 t=7.4e-03 per=1.4e+01 cost=2.6e+04 flops=3.6e+06
 sigma[gemm] counter=91 total t=3.0e-02 per=5.7e+01 cost=9.7e+04 flops=3.2e+06
 sigma[red] counter=91 t=1.3e-02 per=2.4e+01 cost=3.7e+04 flops=2.9e+06
----- TIMING FOR sigma_tot : t_inter=8.1e-01 t_gemm=2.2e+00 t_reduction=9.8e-01 tot=4.0e+00 -----
 sigma_tot[inter] counter=91 t=8.1e-01 per=2.0e+01 cost=7.5e+07 flops=9.3e+07
 sigma_tot[gemm] counter=91 i=0 t=1.9e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=1.7e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=1.4e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=3 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=4 t=5.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=91 i=5 t=5.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=91 i=6 t=5.2e-01 per=1.3e+01 cost=1.4e+07 flops=2.7e+07
 sigma_tot[gemm] counter=91 i=7 t=5.2e-01 per=1.3e+01 cost=1.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=91 total t=2.2e+00 per=5.5e+01 cost=5.8e+07 flops=2.7e+07
 sigma_tot[red] counter=91 t=9.8e-01 per=2.5e+01 cost=1.3e+07 flops=1.4e+07
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.6e-05,5.3e-06,1.4e-06,1.3e-05
    2   0 -    -116.306474424740 -5.018e-03  1.734e-02    2     2  1.220e-01 6.100e-02 5.437e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.057e-03,9.979e-03,3.019e-02,1.309e-02,5.533e-02
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.052e-03 speed=4.139e-04GB/S T(nccl)=4.683e-06 speed=1.814e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=92 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=92 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.7e+06
 sigma[gemm] counter=92 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=92 i=6 t=7.6e-03 per=1.4e+01 cost=2.9e+04 flops=3.8e+06
 sigma[gemm] counter=92 i=7 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=92 total t=3.0e-02 per=5.7e+01 cost=9.7e+04 flops=3.2e+06
 sigma[red] counter=92 t=1.3e-02 per=2.5e+01 cost=3.7e+04 flops=2.8e+06
----- TIMING FOR sigma_tot : t_inter=8.2e-01 t_gemm=2.2e+00 t_reduction=9.9e-01 tot=4.0e+00 -----
 sigma_tot[inter] counter=92 t=8.2e-01 per=2.0e+01 cost=7.5e+07 flops=9.2e+07
 sigma_tot[gemm] counter=92 i=0 t=1.9e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=1.7e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=1.4e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=3 t=1.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=4 t=5.8e-01 per=1.4e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=92 i=5 t=5.8e-01 per=1.4e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=92 i=6 t=5.3e-01 per=1.3e+01 cost=1.4e+07 flops=2.6e+07
 sigma_tot[gemm] counter=92 i=7 t=5.2e-01 per=1.3e+01 cost=1.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=92 total t=2.2e+00 per=5.5e+01 cost=5.8e+07 flops=2.6e+07
 sigma_tot[red] counter=92 t=9.9e-01 per=2.5e+01 cost=1.3e+07 flops=1.3e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.6e-05,3.0e-06,1.2e-06,2.0e-07
    3   0 -    -116.307204522826 -7.301e-04  5.966e-03    3     3  1.944e-01 6.480e-02 5.473e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.923e-03,9.872e-03,3.009e-02,1.312e-02,5.503e-02
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=1.917e-03 speed=4.431e-04GB/S T(nccl)=5.965e-06 speed=1.424e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=93 t=9.9e-03 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=93 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=4 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=93 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.7e+06
 sigma[gemm] counter=93 i=6 t=7.6e-03 per=1.4e+01 cost=2.9e+04 flops=3.8e+06
 sigma[gemm] counter=93 i=7 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=93 total t=3.0e-02 per=5.7e+01 cost=9.7e+04 flops=3.2e+06
 sigma[red] counter=93 t=1.3e-02 per=2.5e+01 cost=3.7e+04 flops=2.8e+06
----- TIMING FOR sigma_tot : t_inter=8.3e-01 t_gemm=2.2e+00 t_reduction=1.0e+00 tot=4.1e+00 -----
 sigma_tot[inter] counter=93 t=8.3e-01 per=2.0e+01 cost=7.5e+07 flops=9.1e+07
 sigma_tot[gemm] counter=93 i=0 t=2.0e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=1.7e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=1.4e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=3 t=1.5e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=4 t=5.8e-01 per=1.4e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=93 i=5 t=5.8e-01 per=1.4e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=93 i=6 t=5.3e-01 per=1.3e+01 cost=1.4e+07 flops=2.6e+07
 sigma_tot[gemm] counter=93 i=7 t=5.3e-01 per=1.3e+01 cost=1.4e+07 flops=2.7e+07
 sigma_tot[gemm] counter=93 total t=2.2e+00 per=5.5e+01 cost=5.8e+07 flops=2.6e+07
 sigma_tot[red] counter=93 t=1.0e+00 per=2.5e+01 cost=1.3e+07 flops=1.3e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.1e-06,1.1e-06,2.6e-07
    4   0 -    -116.307292153216 -8.763e-05  2.234e-03    3     4  2.625e-01 6.563e-02 5.483e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.244e-03,9.964e-03,3.018e-02,1.303e-02,5.443e-02
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=1.238e-03 speed=6.860e-04GB/S T(nccl)=6.245e-06 speed=1.360e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=94 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=94 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=94 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.7e+06
 sigma[gemm] counter=94 i=6 t=7.6e-03 per=1.4e+01 cost=2.9e+04 flops=3.8e+06
 sigma[gemm] counter=94 i=7 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=94 total t=3.0e-02 per=5.7e+01 cost=9.7e+04 flops=3.2e+06
 sigma[red] counter=94 t=1.3e-02 per=2.4e+01 cost=3.7e+04 flops=2.8e+06
----- TIMING FOR sigma_tot : t_inter=8.4e-01 t_gemm=2.3e+00 t_reduction=1.0e+00 tot=4.1e+00 -----
 sigma_tot[inter] counter=94 t=8.4e-01 per=2.0e+01 cost=7.6e+07 flops=9.0e+07
 sigma_tot[gemm] counter=94 i=0 t=2.0e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=1.7e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=1.4e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=3 t=1.5e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=4 t=5.9e-01 per=1.4e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=94 i=5 t=5.9e-01 per=1.4e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=94 i=6 t=5.4e-01 per=1.3e+01 cost=1.4e+07 flops=2.6e+07
 sigma_tot[gemm] counter=94 i=7 t=5.4e-01 per=1.3e+01 cost=1.4e+07 flops=2.7e+07
 sigma_tot[gemm] counter=94 total t=2.3e+00 per=5.5e+01 cost=5.8e+07 flops=2.6e+07
 sigma_tot[red] counter=94 t=1.0e+00 per=2.5e+01 cost=1.3e+07 flops=1.3e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.1e-06,1.2e-06,2.5e-07
    5   0 -    -116.307302063452 -9.910e-06  5.918e-04    3     5  3.286e-01 6.572e-02 5.477e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.214e-03,9.934e-03,3.009e-02,1.318e-02,5.543e-02
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=2.208e-03 speed=3.848e-04GB/S T(nccl)=6.106e-06 speed=1.391e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=95 t=9.9e-03 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=95 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=4 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=95 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=95 i=6 t=7.5e-03 per=1.4e+01 cost=2.9e+04 flops=3.9e+06
 sigma[gemm] counter=95 i=7 t=7.6e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=95 total t=3.0e-02 per=5.7e+01 cost=9.7e+04 flops=3.2e+06
 sigma[red] counter=95 t=1.3e-02 per=2.5e+01 cost=3.7e+04 flops=2.8e+06
----- TIMING FOR sigma_tot : t_inter=8.5e-01 t_gemm=2.3e+00 t_reduction=1.0e+00 tot=4.2e+00 -----
 sigma_tot[inter] counter=95 t=8.5e-01 per=2.0e+01 cost=7.6e+07 flops=9.0e+07
 sigma_tot[gemm] counter=95 i=0 t=2.0e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=1.7e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=3 t=1.5e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=4 t=6.0e-01 per=1.4e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=95 i=5 t=6.0e-01 per=1.4e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=95 i=6 t=5.5e-01 per=1.3e+01 cost=1.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=95 i=7 t=5.5e-01 per=1.3e+01 cost=1.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=95 total t=2.3e+00 per=5.5e+01 cost=5.8e+07 flops=2.5e+07
 sigma_tot[red] counter=95 t=1.0e+00 per=2.5e+01 cost=1.3e+07 flops=1.3e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.1e-06,1.1e-06,2.6e-07
    6   0 -    -116.307302748026 -6.846e-07  1.732e-04    3     6  3.969e-01 6.616e-02 5.490e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.812e-03,1.004e-02,3.020e-02,1.306e-02,5.512e-02
 analyze_tgpu[Hx]: ndim=57:4.247e-07GB T(cpu-gpu)=1.805e-03 speed=4.704e-04GB/S T(nccl)=6.104e-06 speed=1.391e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=96 t=1.0e-02 per=1.9e+01 cost=2.3e+05 flops=2.3e+07
 sigma[gemm] counter=96 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=3 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.7e+06
 sigma[gemm] counter=96 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.7e+06
 sigma[gemm] counter=96 i=6 t=7.5e-03 per=1.4e+01 cost=2.9e+04 flops=3.9e+06
 sigma[gemm] counter=96 i=7 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=96 total t=3.0e-02 per=5.7e+01 cost=9.7e+04 flops=3.2e+06
 sigma[red] counter=96 t=1.3e-02 per=2.5e+01 cost=3.7e+04 flops=2.8e+06
----- TIMING FOR sigma_tot : t_inter=8.6e-01 t_gemm=2.3e+00 t_reduction=1.0e+00 tot=4.2e+00 -----
 sigma_tot[inter] counter=96 t=8.6e-01 per=2.0e+01 cost=7.6e+07 flops=8.9e+07
 sigma_tot[gemm] counter=96 i=0 t=2.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=1.7e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=3 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=4 t=6.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=96 i=5 t=6.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=96 i=6 t=5.6e-01 per=1.3e+01 cost=1.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=96 i=7 t=5.5e-01 per=1.3e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=96 total t=2.3e+00 per=5.5e+01 cost=5.8e+07 flops=2.5e+07
 sigma_tot[red] counter=96 t=1.0e+00 per=2.5e+01 cost=1.4e+07 flops=1.3e+07
T(sub)=3.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,2.4e-05,3.1e-06,1.2e-06,2.7e-07
    7   0 +    -116.307302820366 -7.234e-08  5.927e-05    3     7  4.653e-01 6.647e-02 5.495e-02
TIMING FOR Davidson : 4.653e-01  T(cal/comm/rest)=3.847e-01,1.121e-06,8.066e-02
decomposed t_rest=8.066e-02
 T(sub)    =1.775e-04 per=2.200e-01
 T(precond)=8.024e-02 per=9.948e+01
 T(ortho)  =4.654e-05 per=5.770e-02
 T(xcopy)  =1.138e-06 per=1.411e-03
 T(xnrm2)  =3.103e-06 per=3.847e-03
 T(other)  =1.949e-04 per=2.416e-01
optimized energies: isweep=0 ibond=14 dots=2 e[0]=-116.307302820366 nmvp=7
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=8.469e-04 change=1.783e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=12 dimAll=40
 (23,3):4 (25,3):8 (24,2):7 (24,4):5 (26,2):3 (25,1):3 (26,4):3 (25,5):2 (22,2):1 (23,1):2 (24,0):1 (27,3):1
timing for divide=6.0e-05
timing for compute=1.4e-02
timing for collect=2.7e-05
----- TMING FOR decimation_genbasis(su2): 1.4e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.0e-05,1.4e-02,0.0e+00,5.3e-06,2.7e-05 -----
decimation summary: 40->10 dwt=+6.494e-06 SvN=7.273e-01
 qbond: qkept nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
----- TIMING for decimation_row(nkr): 1.434e-02 S T(decim/select/formRot)=1.397e-02,2.355e-04,1.356e-04 -----
----- TIMING FOR twodot_decimation: 1.473e-02 S T(wf/decim)=3.752e-04,1.435e-02 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1090:8.316e-03MB:8.121e-06GB
        per(mem): H:1.83 C:32.3 S:8.07 P:11.9 Q:45.9 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=8.163e-04 change=1.682e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.222e-03 S -----
rank=0 GPUmem(GB): used=4.577e-05 (oper)=2.617e-05
rank=0 GPUmem(GB): used=4.615e-05 (oper,site)=2.617e-05,3.800e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=68
 no. of coefficients=1020:7.782e-03MB:7.600e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.510e-03 S -----
rank=0 GPUmem(GB): used=5.375e-05 (oper,site,rinter)=2.617e-05,3.800e-07,7.600e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.310e-02 S size(rtasks)=57 size(Rlst2)=36 T(Rmu/Rlist)=5.126e-04,3.259e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.359e-02 S size(rtasks)=57 size(Rlst)=2557 -----
rank=0 GPUmem(GB): used=5.375e-05 avail=6.174e+00 total=6.174e+00 batch[need]=4.763e-04 blksize=9 blksize0=6 batchsize=2557
rank=0 GPUmem(GB): used=5.300e-04 (oper,site,rinter,batch)=2.617e-05,3.800e-07,7.600e-06,4.763e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.768e-03,2.255e-02,9.864e-03
----- TIMING FOR renorm : t_inter=6.8e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=15 t=6.8e-03 per=1.7e+01 cost=6.9e+04 flops=1.0e+07
 renorm[gemm] counter=15 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=4 t=7.5e-03 per=1.9e+01 cost=1.0e+04 flops=1.4e+06
 renorm[gemm] counter=15 i=5 t=7.6e-03 per=1.9e+01 cost=1.9e+04 flops=2.5e+06
 renorm[gemm] counter=15 i=6 t=7.5e-03 per=1.9e+01 cost=4.1e+04 flops=5.5e+06
 renorm[gemm] counter=15 total t=2.3e-02 per=5.8e+01 cost=7.0e+04 flops=3.1e+06
 renorm[red] counter=15 t=9.9e-03 per=2.5e+01 cost=2.2e+04 flops=2.2e+06
----- TIMING FOR renorm_tot : t_inter=8.9e-02 t_gemm=3.4e-01 t_reduction=1.5e-01 tot=5.8e-01 -----
 renorm_tot[inter] counter=15 t=8.9e-02 per=1.5e+01 cost=1.4e+06 flops=1.6e+07
 renorm_tot[gemm] counter=15 i=0 t=2.3e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=2.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=1.9e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=3 t=1.9e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=4 t=1.1e-01 per=1.9e+01 cost=2.0e+05 flops=1.8e+06
 renorm_tot[gemm] counter=15 i=5 t=1.1e-01 per=2.0e+01 cost=5.1e+05 flops=4.5e+06
 renorm_tot[gemm] counter=15 i=6 t=1.1e-01 per=2.0e+01 cost=9.2e+05 flops=8.1e+06
 renorm_tot[gemm] counter=15 total t=3.4e-01 per=5.9e+01 cost=1.6e+06 flops=4.8e+06
 renorm_tot[red] counter=15 t=1.5e-01 per=2.6e+01 cost=4.0e+05 flops=2.7e+06
qops.to_cpu: size(tot)=1090:8.3e-03MB:8.1e-06GB T(to_cpu)=7.8e-05S speed=1.0e-01GB/S
check ||H-H.dagger||=2.034e-14 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.097 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.053e-03 change=7.372e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.610e-03 change=-1.738e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.610e-03 change=-4.843e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 9.609e-01 S #####
 T(local opt: fetch) = 1.087e-02 S  per = 1.13  per(accum) = 1.13
 T(local opt: hdiag) = 2.174e-01 S  per = 22.6  per(accum) = 23.8
 T(local opt: dvdsn) = 6.172e-01 S  per = 64.2  per(accum) = 88
 T(local opt: decim) = 1.475e-02 S  per = 1.53  per(accum) = 89.5
 T(local opt: guess) = 7.424e-04 S  per = 0.0773  per(accum) = 89.6
 T(local opt: renrm) = 9.961e-02 S  per = 10.4  per(accum) = 100
 T(local opt: save ) = 2.848e-04 S  per = 0.0296  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.172e-01 S  T(sum) = 6.169e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 2.732e-03 S  per = 0.443  per(accum) = 0.443
 T(local opt: symbolic_formulae           ) = 3.677e-03 S  per = 0.596  per(accum) = 1.04
 T(local opt: hintermediate init          ) = 1.491e-04 S  per = 0.0242  per(accum) = 1.06
 T(local opt: preprocess_hformulae_Hxlist ) = 1.029e-01 S  per = 16.7  per(accum) = 17.7
 T(local opt: hmmtasks init               ) = 4.130e-02 S  per = 6.69  per(accum) = 24.4
 T(local opt: initial guess for dvdson    ) = 8.204e-04 S  per = 0.133  per(accum) = 24.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.724e-01 S  per = 60.4  per(accum) = 84.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.223e-02 S  per = 1.98  per(accum) = 86.9
 T(local opt: dvdson [nccl]               ) = 4.483e-05 S  per = 0.00727  per(accum) = 86.9
 T(local opt: dvdson [mpi]                ) = 1.121e-06 S  per = 0.000182  per(accum) = 86.9
 T(local opt: dvdson [rest part(linalg)]  ) = 8.066e-02 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 9.961e-02 S  T(sum) = 9.961e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.720e-04 S  per = 0.474  per(accum) = 0.474
 T(local opt: qops init                    ) = 2.563e-03 S  per = 2.57  per(accum) = 3.05
 T(local opt: symbolic_formulae_renorm     ) = 2.233e-03 S  per = 2.24  per(accum) = 5.29
 T(local opt: allocate qops on gpu         ) = 5.666e-05 S  per = 0.0569  per(accum) = 5.35
 T(local opt: site memcpy cpu2gpu          ) = 7.550e-04 S  per = 0.758  per(accum) = 6.1
 T(local opt: rintermediate init           ) = 2.522e-03 S  per = 2.53  per(accum) = 8.64
 T(local opt: preprocess_formulae_Rlist2   ) = 3.367e-02 S  per = 33.8  per(accum) = 42.4
 T(local opt: rmmtasks init                ) = 1.567e-02 S  per = 15.7  per(accum) = 58.2
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 3.41e-05  per(accum) = 58.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.927e-02 S  per = 39.4  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 1.454e-04 S  per = 0.146  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 4.300e-08 S  per = 4.32e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 3.82e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 8.669e-05 S  per = 0.087  per(accum) = 97.8
 T(local opt: reduction of opS & opH [mpi] ) = 7.014e-05 S  per = 0.0704  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 2.080e-03 S  per = 2.09  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.729e-06 S  per = 0.00876  per(accum) = 100
##### sweep opt: 2.043e+01 S #####
 T(sweep opt: fetch) = 2.377e-01 S  per = 1.16  per(accum) = 1.16
 T(sweep opt: hdiag) = 8.312e+00 S  per = 40.7  per(accum) = 41.8
 T(sweep opt: dvdsn) = 1.011e+01 S  per = 49.5  per(accum) = 91.3
 T(sweep opt: decim) = 2.112e-01 S  per = 1.03  per(accum) = 92.4
 T(sweep opt: guess) = 1.793e-02 S  per = 0.0878  per(accum) = 92.5
 T(sweep opt: renrm) = 1.534e+00 S  per = 7.51  per(accum) = 100
 T(sweep opt: save ) = 5.387e-03 S  per = 0.0264  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.011e+01 S  T(sum) = 1.009e+01 S  per = 9.982e+01
 T(sweep opt: preprocess                  ) = 7.652e-02 S  per = 0.758  per(accum) = 0.758
 T(sweep opt: symbolic_formulae           ) = 1.189e-01 S  per = 1.18  per(accum) = 1.94
 T(sweep opt: hintermediate init          ) = 4.503e-03 S  per = 0.0446  per(accum) = 1.98
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.243e+00 S  per = 32.1  per(accum) = 34.1
 T(sweep opt: hmmtasks init               ) = 1.248e+00 S  per = 12.4  per(accum) = 46.5
 T(sweep opt: initial guess for dvdson    ) = 1.930e-02 S  per = 0.191  per(accum) = 46.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.243e+00 S  per =   42  per(accum) = 88.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.288e-01 S  per = 1.28  per(accum) = 90
 T(sweep opt: dvdson [nccl]               ) = 6.603e-04 S  per = 0.00654  per(accum) = 90
 T(sweep opt: dvdson [mpi]                ) = 1.537e-05 S  per = 0.000152  per(accum) = 90
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.012e+00 S  per =   10  per(accum) = 100
Detailed decomposition of T(renrm) = 1.534e+00 S  T(sum) = 1.534e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.222e-03 S  per = 0.275  per(accum) = 0.275
 T(sweep opt: qops init                    ) = 5.634e-02 S  per = 3.67  per(accum) = 3.95
 T(sweep opt: symbolic_formulae_renorm     ) = 6.742e-02 S  per =  4.4  per(accum) = 8.34
 T(sweep opt: allocate qops on gpu         ) = 2.776e-03 S  per = 0.181  per(accum) = 8.53
 T(sweep opt: site memcpy cpu2gpu          ) = 1.900e-02 S  per = 1.24  per(accum) = 9.76
 T(sweep opt: rintermediate init           ) = 3.786e-02 S  per = 2.47  per(accum) = 12.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.519e-01 S  per = 29.5  per(accum) = 41.7
 T(sweep opt: rmmtasks init                ) = 2.311e-01 S  per = 15.1  per(accum) = 56.8
 T(sweep opt: qops memset on cpu           ) = 6.210e-07 S  per = 4.05e-05  per(accum) = 56.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.788e-01 S  per = 37.7  per(accum) = 94.5
 T(sweep opt: deallocate cpu and gpu memory) = 2.053e-03 S  per = 0.134  per(accum) = 94.6
 T(sweep opt: construct opS [ifdists=true] ) = 8.430e-07 S  per = 5.5e-05  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [nccl]) = 6.230e-07 S  per = 4.06e-05  per(accum) = 94.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.935e-03 S  per = 0.126  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.298e-04 S  per = 0.0476  per(accum) = 94.8
 T(sweep opt: qops_pool join and erase     ) = 4.731e-02 S  per = 3.08  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 3.242e-02 S  per = 2.11  per(accum) = 100
##### global opt: 2.043e+01 S #####
 T(global opt: fetch) = 2.377e-01 S  per = 1.16  per(accum) = 1.16
 T(global opt: hdiag) = 8.312e+00 S  per = 40.7  per(accum) = 41.8
 T(global opt: dvdsn) = 1.011e+01 S  per = 49.5  per(accum) = 91.3
 T(global opt: decim) = 2.112e-01 S  per = 1.03  per(accum) = 92.4
 T(global opt: guess) = 1.793e-02 S  per = 0.0878  per(accum) = 92.5
 T(global opt: renrm) = 1.534e+00 S  per = 7.51  per(accum) = 100
 T(global opt: save ) = 5.387e-03 S  per = 0.0264  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.011e+01 S  T(sum) = 1.009e+01 S  per = 9.982e+01
 T(global opt: preprocess                  ) = 7.652e-02 S  per = 0.758  per(accum) = 0.758
 T(global opt: symbolic_formulae           ) = 1.189e-01 S  per = 1.18  per(accum) = 1.94
 T(global opt: hintermediate init          ) = 4.503e-03 S  per = 0.0446  per(accum) = 1.98
 T(global opt: preprocess_hformulae_Hxlist ) = 3.243e+00 S  per = 32.1  per(accum) = 34.1
 T(global opt: hmmtasks init               ) = 1.248e+00 S  per = 12.4  per(accum) = 46.5
 T(global opt: initial guess for dvdson    ) = 1.930e-02 S  per = 0.191  per(accum) = 46.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.243e+00 S  per =   42  per(accum) = 88.7
 T(global opt: dvdson [cpu-gpu]            ) = 1.288e-01 S  per = 1.28  per(accum) = 90
 T(global opt: dvdson [nccl]               ) = 6.603e-04 S  per = 0.00654  per(accum) = 90
 T(global opt: dvdson [mpi]                ) = 1.537e-05 S  per = 0.000152  per(accum) = 90
 T(global opt: dvdson [rest part(linalg)]  ) = 1.012e+00 S  per =   10  per(accum) = 100
Detailed decomposition of T(renrm) = 1.534e+00 S  T(sum) = 1.534e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.222e-03 S  per = 0.275  per(accum) = 0.275
 T(global opt: qops init                    ) = 5.634e-02 S  per = 3.67  per(accum) = 3.95
 T(global opt: symbolic_formulae_renorm     ) = 6.742e-02 S  per =  4.4  per(accum) = 8.34
 T(global opt: allocate qops on gpu         ) = 2.776e-03 S  per = 0.181  per(accum) = 8.53
 T(global opt: site memcpy cpu2gpu          ) = 1.900e-02 S  per = 1.24  per(accum) = 9.76
 T(global opt: rintermediate init           ) = 3.786e-02 S  per = 2.47  per(accum) = 12.2
 T(global opt: preprocess_formulae_Rlist2   ) = 4.519e-01 S  per = 29.5  per(accum) = 41.7
 T(global opt: rmmtasks init                ) = 2.311e-01 S  per = 15.1  per(accum) = 56.8
 T(global opt: qops memset on cpu           ) = 6.210e-07 S  per = 4.05e-05  per(accum) = 56.8
 T(global opt: preprocess_renorm_batchGPU   ) = 5.788e-01 S  per = 37.7  per(accum) = 94.5
 T(global opt: deallocate cpu and gpu memory) = 2.053e-03 S  per = 0.134  per(accum) = 94.6
 T(global opt: construct opS [ifdists=true] ) = 8.430e-07 S  per = 5.5e-05  per(accum) = 94.6
 T(global opt: reduction of opS & opH [nccl]) = 6.230e-07 S  per = 4.06e-05  per(accum) = 94.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.935e-03 S  per = 0.126  per(accum) = 94.8
 T(global opt: reduction of opS & opH [mpi] ) = 7.298e-04 S  per = 0.0476  per(accum) = 94.8
 T(global opt: qops_pool join and erase     ) = 4.731e-02 S  per = 3.08  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 3.242e-02 S  per = 2.11  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.756e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=15/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=648:4.944e-03MB:4.828e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=672:5.127e-03MB:5.007e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1090:8.316e-03MB:8.121e-06GB
        per(mem): H:1.83 C:32.3 S:8.07 P:11.9 Q:45.9 
 rqops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3161:0.0241MB:2.36e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.193e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.788e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=51:3.891e-04MB
qtensor4: wf4 own=1 _data=0x3a493ba0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
 qbond: qcol nsym=2 dimAll=3
 (2,2):1 (3,1):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=1.265e-01 t1=2.698e-05, t2=1.830e-03, t3=2.484e-03, t4=1.221e-01, t5=3.165e-06, t6=1.486e-05, t7=3.473e-06
duration_diagGPU:1.265e-01
duration_diagreduce:7.000e-08
duration_diagtransform:9.000e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 2.428e-03 S -----
rank=0 GPUmem(GB): used=2.355e-05 (oper)=2.355e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=195
 no. of hintermediate operators=73
 no. of coefficients=996:7.599e-03MB:7.421e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.936e-05 S -----
rank=0 GPUmem(GB): used=3.097e-05 (oper,hinter)=2.355e-05,7.421e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.793e-02 S size(H_formulae)=195 size(Hxlst2)=21 T(Hmu/Hxlist)=4.697e-04,7.746e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.867e-02 S size(H_formulae)=195 size(Hxlst)=4740 -----
rank=0 GPUmem(GB): used=3.097e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=7.600e-07 batch[need]=6.710e-04 blksize=6 blksize0=6 batchsize=4740
rank=0 GPUmem(GB): used=7.027e-04 (oper,hinter,dvdson,batch)=2.355e-05,7.421e-06,7.600e-07,6.710e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.510e-04,1.009e-02,3.047e-02,1.316e-02,5.459e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=8.458e-04 speed=8.985e-04GB/S T(nccl)=5.165e-06 speed=1.471e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.4e-02 -----
 sigma[inter] counter=97 t=1.0e-02 per=1.9e+01 cost=1.4e+05 flops=1.4e+07
 sigma[gemm] counter=97 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=3 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=4 t=7.7e-03 per=1.4e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=97 i=5 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.4e+06
 sigma[gemm] counter=97 i=6 t=7.6e-03 per=1.4e+01 cost=1.9e+04 flops=2.5e+06
 sigma[gemm] counter=97 i=7 t=7.6e-03 per=1.4e+01 cost=1.7e+04 flops=2.2e+06
 sigma[gemm] counter=97 total t=3.0e-02 per=5.7e+01 cost=5.7e+04 flops=1.9e+06
 sigma[red] counter=97 t=1.3e-02 per=2.4e+01 cost=2.4e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=8.7e-01 t_gemm=2.4e+00 t_reduction=1.1e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=97 t=8.7e-01 per=2.0e+01 cost=7.6e+07 flops=8.8e+07
 sigma_tot[gemm] counter=97 i=0 t=2.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=1.7e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=3 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=4 t=6.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=97 i=5 t=6.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=97 i=6 t=5.6e-01 per=1.3e+01 cost=1.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=97 i=7 t=5.6e-01 per=1.3e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=97 total t=2.4e+00 per=5.5e+01 cost=5.8e+07 flops=2.5e+07
 sigma_tot[red] counter=97 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.3e+07
T(sub)=9.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.1e-06,2.1e-06,7.9e-07,2.3e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.307298452327 -1.116e+03  3.154e-02    1     1  5.472e-02 5.472e-02 5.469e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.173e-03,9.965e-03,3.034e-02,1.309e-02,5.558e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.168e-03 speed=3.506e-04GB/S T(nccl)=5.647e-06 speed=1.346e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=98 t=1.0e-02 per=1.9e+01 cost=1.4e+05 flops=1.4e+07
 sigma[gemm] counter=98 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=98 i=5 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.4e+06
 sigma[gemm] counter=98 i=6 t=7.5e-03 per=1.4e+01 cost=1.9e+04 flops=2.5e+06
 sigma[gemm] counter=98 i=7 t=7.7e-03 per=1.4e+01 cost=1.7e+04 flops=2.2e+06
 sigma[gemm] counter=98 total t=3.0e-02 per=5.7e+01 cost=5.7e+04 flops=1.9e+06
 sigma[red] counter=98 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=8.8e-01 t_gemm=2.4e+00 t_reduction=1.1e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=98 t=8.8e-01 per=2.0e+01 cost=7.6e+07 flops=8.7e+07
 sigma_tot[gemm] counter=98 i=0 t=2.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=1.8e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=1.5e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=3 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=4 t=6.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=98 i=5 t=6.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=98 i=6 t=5.7e-01 per=1.3e+01 cost=1.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=98 i=7 t=5.7e-01 per=1.3e+01 cost=1.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=98 total t=2.4e+00 per=5.5e+01 cost=5.8e+07 flops=2.4e+07
 sigma_tot[red] counter=98 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.3e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,3.5e-06,9.0e-07,2.4e-07
    2   0 -    -116.311083616854 -3.785e-03  1.515e-02    2     2  1.211e-01 6.054e-02 5.520e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.010e-04,1.019e-02,3.008e-02,1.314e-02,5.372e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.950e-04 speed=2.576e-03GB/S T(nccl)=6.007e-06 speed=1.265e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=99 t=1.0e-02 per=1.9e+01 cost=1.4e+05 flops=1.4e+07
 sigma[gemm] counter=99 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=3 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=99 i=5 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.4e+06
 sigma[gemm] counter=99 i=6 t=7.5e-03 per=1.4e+01 cost=1.9e+04 flops=2.5e+06
 sigma[gemm] counter=99 i=7 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=99 total t=3.0e-02 per=5.6e+01 cost=5.7e+04 flops=1.9e+06
 sigma[red] counter=99 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=8.9e-01 t_gemm=2.4e+00 t_reduction=1.1e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=99 t=8.9e-01 per=2.0e+01 cost=7.7e+07 flops=8.6e+07
 sigma_tot[gemm] counter=99 i=0 t=2.1e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=1.8e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=1.5e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=3 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=4 t=6.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=99 i=5 t=6.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=99 i=6 t=5.8e-01 per=1.3e+01 cost=1.4e+07 flops=2.4e+07
 sigma_tot[gemm] counter=99 i=7 t=5.8e-01 per=1.3e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=99 total t=2.4e+00 per=5.5e+01 cost=5.8e+07 flops=2.4e+07
 sigma_tot[red] counter=99 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.3e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.5e-05,3.1e-06,1.2e-06,2.4e-07
    3   0 -    -116.311472269527 -3.887e-04  2.220e-03    3     3  1.875e-01 6.249e-02 5.474e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.386e-04,1.008e-02,2.988e-02,1.280e-02,5.362e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=8.329e-04 speed=9.124e-04GB/S T(nccl)=5.719e-06 speed=1.329e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=100 t=1.0e-02 per=1.9e+01 cost=1.4e+05 flops=1.4e+07
 sigma[gemm] counter=100 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=100 i=5 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.4e+06
 sigma[gemm] counter=100 i=6 t=7.5e-03 per=1.4e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=100 i=7 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=100 total t=3.0e-02 per=5.7e+01 cost=5.7e+04 flops=1.9e+06
 sigma[red] counter=100 t=1.3e-02 per=2.4e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=9.0e-01 t_gemm=2.4e+00 t_reduction=1.1e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=100 t=9.0e-01 per=2.0e+01 cost=7.7e+07 flops=8.5e+07
 sigma_tot[gemm] counter=100 i=0 t=2.1e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=1.8e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=1.5e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=3 t=1.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=4 t=6.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=100 i=5 t=6.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=100 i=6 t=5.9e-01 per=1.3e+01 cost=1.4e+07 flops=2.4e+07
 sigma_tot[gemm] counter=100 i=7 t=5.8e-01 per=1.3e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=100 total t=2.4e+00 per=5.5e+01 cost=5.8e+07 flops=2.4e+07
 sigma_tot[red] counter=100 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.0e-06,1.1e-06,2.3e-07
    4   0 -    -116.311486264161 -1.399e-05  7.097e-04    3     4  2.543e-01 6.358e-02 5.449e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.659e-03,8.807e-03,2.970e-02,1.290e-02,5.569e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=2.648e-03 speed=2.870e-04GB/S T(nccl)=1.034e-05 speed=7.349e-02GB/S
----- TIMING FOR sigma : t_inter=8.8e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=101 t=8.8e-03 per=1.7e+01 cost=1.4e+05 flops=1.6e+07
 sigma[gemm] counter=101 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=3 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=4 t=7.5e-03 per=1.5e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=101 i=5 t=7.4e-03 per=1.4e+01 cost=1.1e+04 flops=1.4e+06
 sigma[gemm] counter=101 i=6 t=7.4e-03 per=1.4e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=101 i=7 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=101 total t=3.0e-02 per=5.8e+01 cost=5.7e+04 flops=1.9e+06
 sigma[red] counter=101 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=9.1e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=101 t=9.1e-01 per=2.0e+01 cost=7.7e+07 flops=8.5e+07
 sigma_tot[gemm] counter=101 i=0 t=2.1e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=1.8e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=1.5e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=3 t=1.6e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=4 t=6.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=101 i=5 t=6.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=101 i=6 t=5.9e-01 per=1.3e+01 cost=1.4e+07 flops=2.4e+07
 sigma_tot[gemm] counter=101 i=7 t=5.9e-01 per=1.3e+01 cost=1.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=101 total t=2.5e+00 per=5.5e+01 cost=5.8e+07 flops=2.4e+07
 sigma_tot[red] counter=101 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,2.9e-06,1.2e-06,2.1e-07
    5   0 -    -116.311487642229 -1.378e-06  2.297e-04    3     5  3.263e-01 6.526e-02 5.475e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.568e-03,1.004e-02,2.998e-02,1.275e-02,5.436e-02
 analyze_tgpu[Hx]: ndim=51:3.800e-07GB T(cpu-gpu)=1.562e-03 speed=4.865e-04GB/S T(nccl)=6.151e-06 speed=1.236e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=102 t=1.0e-02 per=1.9e+01 cost=1.4e+05 flops=1.4e+07
 sigma[gemm] counter=102 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=4 t=7.5e-03 per=1.4e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=102 i=5 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.4e+06
 sigma[gemm] counter=102 i=6 t=7.5e-03 per=1.4e+01 cost=1.9e+04 flops=2.5e+06
 sigma[gemm] counter=102 i=7 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=102 total t=3.0e-02 per=5.7e+01 cost=5.7e+04 flops=1.9e+06
 sigma[red] counter=102 t=1.3e-02 per=2.4e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=9.2e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=102 t=9.2e-01 per=2.0e+01 cost=7.7e+07 flops=8.4e+07
 sigma_tot[gemm] counter=102 i=0 t=2.1e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=1.8e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=1.5e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=3 t=1.6e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=4 t=6.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=102 i=5 t=6.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=102 i=6 t=6.0e-01 per=1.3e+01 cost=1.4e+07 flops=2.3e+07
 sigma_tot[gemm] counter=102 i=7 t=6.0e-01 per=1.3e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=102 total t=2.5e+00 per=5.5e+01 cost=5.9e+07 flops=2.3e+07
 sigma_tot[red] counter=102 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,3.1e-06,1.2e-06,2.4e-07
    6   0 +    -116.311487752567 -1.103e-07  5.271e-05    3     6  3.941e-01 6.568e-02 5.471e-02
TIMING FOR Davidson : 3.941e-01  T(cal/comm/rest)=3.282e-01,7.960e-07,6.585e-02
decomposed t_rest=6.585e-02
 T(sub)    =1.254e-04 per=1.905e-01
 T(precond)=6.545e-02 per=9.940e+01
 T(ortho)  =1.019e-04 per=1.547e-01
 T(xcopy)  =1.045e-06 per=1.587e-03
 T(xnrm2)  =2.425e-06 per=3.683e-03
 T(other)  =1.672e-04 per=2.539e-01
optimized energies: isweep=0 ibond=15 dots=2 e[0]=-116.311487752567 nmvp=6
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=9.079e-04 change=1.328e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=12 dimAll=40
 (25,3):5 (27,3):7 (26,2):8 (26,4):4 (24,2):2 (25,1):3 (28,2):3 (27,1):3 (26,0):1 (28,4):2 (27,5):1 (29,3):1
timing for divide=6.1e-05
timing for compute=1.5e-02
timing for collect=2.6e-05
----- TMING FOR decimation_genbasis(su2): 1.5e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.1e-05,1.5e-02,0.0e+00,4.9e-06,2.6e-05 -----
decimation summary: 40->10 dwt=+5.064e-08 SvN=8.797e-01
 qbond: qkept nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 1.510e-02 S T(decim/select/formRot)=1.466e-02,3.248e-04,1.194e-04 -----
----- TIMING FOR twodot_decimation: 1.549e-02 S T(wf/decim)=3.756e-04,1.512e-02 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=826:6.302e-03MB:6.154e-06GB
        per(mem): H:2.42 C:45.3 S:7.99 P:8.72 Q:35.6 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=9.079e-04 change=1.274e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=42 : 1.525e-03 S -----
rank=0 GPUmem(GB): used=3.657e-05 (oper)=2.171e-05
rank=0 GPUmem(GB): used=3.692e-05 (oper,site)=2.171e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=42
 no. of rintermediate operators=42
 no. of coefficients=672:5.127e-03MB:5.007e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.471e-03 S -----
rank=0 GPUmem(GB): used=4.192e-05 (oper,site,rinter)=2.171e-05,3.502e-07,5.007e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.522e-02 S size(rtasks)=42 size(Rlst2)=36 T(Rmu/Rlist)=3.576e-04,2.486e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.558e-02 S size(rtasks)=42 size(Rlst)=1910 -----
rank=0 GPUmem(GB): used=4.192e-05 avail=6.174e+00 total=6.174e+00 batch[need]=3.558e-04 blksize=9 blksize0=6 batchsize=1910
rank=0 GPUmem(GB): used=3.977e-04 (oper,site,rinter,batch)=2.171e-05,3.502e-07,5.007e-06,3.558e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.444e-03,2.254e-02,9.994e-03
----- TIMING FOR renorm : t_inter=6.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=16 t=6.4e-03 per=1.7e+01 cost=4.6e+04 flops=7.2e+06
 renorm[gemm] counter=16 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=4 t=7.5e-03 per=1.9e+01 cost=6.8e+03 flops=9.1e+05
 renorm[gemm] counter=16 i=5 t=7.5e-03 per=1.9e+01 cost=1.3e+04 flops=1.8e+06
 renorm[gemm] counter=16 i=6 t=7.5e-03 per=1.9e+01 cost=2.7e+04 flops=3.6e+06
 renorm[gemm] counter=16 total t=2.3e-02 per=5.8e+01 cost=4.7e+04 flops=2.1e+06
 renorm[red] counter=16 t=1.0e-02 per=2.6e+01 cost=1.5e+04 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=9.5e-02 t_gemm=3.6e-01 t_reduction=1.6e-01 tot=6.2e-01 -----
 renorm_tot[inter] counter=16 t=9.5e-02 per=1.5e+01 cost=1.4e+06 flops=1.5e+07
 renorm_tot[gemm] counter=16 i=0 t=2.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=2.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=2.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=3 t=2.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=4 t=1.2e-01 per=1.9e+01 cost=2.0e+05 flops=1.7e+06
 renorm_tot[gemm] counter=16 i=5 t=1.2e-01 per=2.0e+01 cost=5.3e+05 flops=4.4e+06
 renorm_tot[gemm] counter=16 i=6 t=1.2e-01 per=2.0e+01 cost=9.5e+05 flops=7.8e+06
 renorm_tot[gemm] counter=16 total t=3.6e-01 per=5.8e+01 cost=1.7e+06 flops=4.7e+06
 renorm_tot[red] counter=16 t=1.6e-01 per=2.6e+01 cost=4.2e+05 flops=2.6e+06
qops.to_cpu: size(tot)=826:6.3e-03MB:6.2e-06GB T(to_cpu)=5.9e-05S speed=1.0e-01GB/S
check ||H-H.dagger||=6.947e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0851 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=7.858e-04 change=5.530e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.221e-03 change=-1.496e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.221e-03 change=-4.813e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.505e-01 S #####
 T(local opt: fetch) = 1.132e-02 S  per = 1.51  per(accum) = 1.51
 T(local opt: hdiag) = 1.269e-01 S  per = 16.9  per(accum) = 18.4
 T(local opt: dvdsn) = 5.078e-01 S  per = 67.7  per(accum) = 86.1
 T(local opt: decim) = 1.551e-02 S  per = 2.07  per(accum) = 88.1
 T(local opt: guess) = 8.640e-04 S  per = 0.115  per(accum) = 88.3
 T(local opt: renrm) = 8.784e-02 S  per = 11.7  per(accum) = 100
 T(local opt: save ) = 2.600e-04 S  per = 0.0346  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.078e-01 S  T(sum) = 5.073e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 2.734e-03 S  per = 0.539  per(accum) = 0.539
 T(local opt: symbolic_formulae           ) = 2.438e-03 S  per = 0.481  per(accum) = 1.02
 T(local opt: hintermediate init          ) = 1.137e-04 S  per = 0.0224  per(accum) = 1.04
 T(local opt: preprocess_hformulae_Hxlist ) = 7.882e-02 S  per = 15.5  per(accum) = 16.6
 T(local opt: hmmtasks init               ) = 2.831e-02 S  per = 5.58  per(accum) = 22.2
 T(local opt: initial guess for dvdson    ) = 8.279e-04 S  per = 0.163  per(accum) = 22.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.198e-01 S  per =   63  per(accum) = 85.4
 T(local opt: dvdson [cpu-gpu]            ) = 8.352e-03 S  per = 1.65  per(accum) = 87
 T(local opt: dvdson [nccl]               ) = 3.903e-05 S  per = 0.00769  per(accum) = 87
 T(local opt: dvdson [mpi]                ) = 7.960e-07 S  per = 0.000157  per(accum) = 87
 T(local opt: dvdson [rest part(linalg)]  ) = 6.585e-02 S  per =   13  per(accum) = 100
Detailed decomposition of T(renrm) = 8.784e-02 S  T(sum) = 8.784e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.019e-04 S  per = 0.457  per(accum) = 0.457
 T(local opt: qops init                    ) = 2.154e-03 S  per = 2.45  per(accum) = 2.91
 T(local opt: symbolic_formulae_renorm     ) = 1.537e-03 S  per = 1.75  per(accum) = 4.66
 T(local opt: allocate qops on gpu         ) = 1.422e-04 S  per = 0.162  per(accum) = 4.82
 T(local opt: site memcpy cpu2gpu          ) = 2.253e-03 S  per = 2.57  per(accum) = 7.39
 T(local opt: rintermediate init           ) = 2.483e-03 S  per = 2.83  per(accum) = 10.2
 T(local opt: preprocess_formulae_Rlist2   ) = 2.565e-02 S  per = 29.2  per(accum) = 39.4
 T(local opt: rmmtasks init                ) = 1.163e-02 S  per = 13.2  per(accum) = 52.7
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 4.33e-05  per(accum) = 52.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.907e-02 S  per = 44.5  per(accum) = 97.1
 T(local opt: deallocate cpu and gpu memory) = 8.473e-05 S  per = 0.0965  per(accum) = 97.2
 T(local opt: construct opS [ifdists=true] ) = 4.100e-08 S  per = 4.67e-05  per(accum) = 97.2
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 4.44e-05  per(accum) = 97.2
 T(local opt: qops memcpy gpu2cpu          ) = 6.660e-05 S  per = 0.0758  per(accum) = 97.3
 T(local opt: reduction of opS & opH [mpi] ) = 6.962e-05 S  per = 0.0793  per(accum) = 97.4
 T(local opt: qops_pool join and erase     ) = 2.295e-03 S  per = 2.61  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.428e-06 S  per = 0.0107  per(accum) = 100
##### sweep opt: 2.118e+01 S #####
 T(sweep opt: fetch) = 2.491e-01 S  per = 1.18  per(accum) = 1.18
 T(sweep opt: hdiag) = 8.439e+00 S  per = 39.8  per(accum) = 41
 T(sweep opt: dvdsn) = 1.062e+01 S  per = 50.1  per(accum) = 91.2
 T(sweep opt: decim) = 2.268e-01 S  per = 1.07  per(accum) = 92.2
 T(sweep opt: guess) = 1.879e-02 S  per = 0.0887  per(accum) = 92.3
 T(sweep opt: renrm) = 1.622e+00 S  per = 7.66  per(accum) = 100
 T(sweep opt: save ) = 5.647e-03 S  per = 0.0267  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.062e+01 S  T(sum) = 1.060e+01 S  per = 9.983e+01
 T(sweep opt: preprocess                  ) = 7.926e-02 S  per = 0.748  per(accum) = 0.748
 T(sweep opt: symbolic_formulae           ) = 1.214e-01 S  per = 1.14  per(accum) = 1.89
 T(sweep opt: hintermediate init          ) = 4.617e-03 S  per = 0.0435  per(accum) = 1.94
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.322e+00 S  per = 31.3  per(accum) = 33.3
 T(sweep opt: hmmtasks init               ) = 1.276e+00 S  per =   12  per(accum) = 45.3
 T(sweep opt: initial guess for dvdson    ) = 2.013e-02 S  per = 0.19  per(accum) = 45.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.563e+00 S  per =   43  per(accum) = 88.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.371e-01 S  per = 1.29  per(accum) = 89.8
 T(sweep opt: dvdson [nccl]               ) = 6.994e-04 S  per = 0.0066  per(accum) = 89.8
 T(sweep opt: dvdson [mpi]                ) = 1.616e-05 S  per = 0.000152  per(accum) = 89.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.078e+00 S  per = 10.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.622e+00 S  T(sum) = 1.622e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.623e-03 S  per = 0.285  per(accum) = 0.285
 T(sweep opt: qops init                    ) = 5.850e-02 S  per = 3.61  per(accum) = 3.89
 T(sweep opt: symbolic_formulae_renorm     ) = 6.896e-02 S  per = 4.25  per(accum) = 8.14
 T(sweep opt: allocate qops on gpu         ) = 2.918e-03 S  per = 0.18  per(accum) = 8.32
 T(sweep opt: site memcpy cpu2gpu          ) = 2.125e-02 S  per = 1.31  per(accum) = 9.63
 T(sweep opt: rintermediate init           ) = 4.035e-02 S  per = 2.49  per(accum) = 12.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.775e-01 S  per = 29.4  per(accum) = 41.6
 T(sweep opt: rmmtasks init                ) = 2.427e-01 S  per =   15  per(accum) = 56.5
 T(sweep opt: qops memset on cpu           ) = 6.590e-07 S  per = 4.06e-05  per(accum) = 56.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.179e-01 S  per = 38.1  per(accum) = 94.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.137e-03 S  per = 0.132  per(accum) = 94.8
 T(sweep opt: construct opS [ifdists=true] ) = 8.840e-07 S  per = 5.45e-05  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [nccl]) = 6.620e-07 S  per = 4.08e-05  per(accum) = 94.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.001e-03 S  per = 0.123  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.994e-04 S  per = 0.0493  per(accum) = 94.9
 T(sweep opt: qops_pool join and erase     ) = 4.960e-02 S  per = 3.06  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 3.243e-02 S  per =    2  per(accum) = 100
##### global opt: 2.118e+01 S #####
 T(global opt: fetch) = 2.491e-01 S  per = 1.18  per(accum) = 1.18
 T(global opt: hdiag) = 8.439e+00 S  per = 39.8  per(accum) = 41
 T(global opt: dvdsn) = 1.062e+01 S  per = 50.1  per(accum) = 91.2
 T(global opt: decim) = 2.268e-01 S  per = 1.07  per(accum) = 92.2
 T(global opt: guess) = 1.879e-02 S  per = 0.0887  per(accum) = 92.3
 T(global opt: renrm) = 1.622e+00 S  per = 7.66  per(accum) = 100
 T(global opt: save ) = 5.647e-03 S  per = 0.0267  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.062e+01 S  T(sum) = 1.060e+01 S  per = 9.983e+01
 T(global opt: preprocess                  ) = 7.926e-02 S  per = 0.748  per(accum) = 0.748
 T(global opt: symbolic_formulae           ) = 1.214e-01 S  per = 1.14  per(accum) = 1.89
 T(global opt: hintermediate init          ) = 4.617e-03 S  per = 0.0435  per(accum) = 1.94
 T(global opt: preprocess_hformulae_Hxlist ) = 3.322e+00 S  per = 31.3  per(accum) = 33.3
 T(global opt: hmmtasks init               ) = 1.276e+00 S  per =   12  per(accum) = 45.3
 T(global opt: initial guess for dvdson    ) = 2.013e-02 S  per = 0.19  per(accum) = 45.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.563e+00 S  per =   43  per(accum) = 88.5
 T(global opt: dvdson [cpu-gpu]            ) = 1.371e-01 S  per = 1.29  per(accum) = 89.8
 T(global opt: dvdson [nccl]               ) = 6.994e-04 S  per = 0.0066  per(accum) = 89.8
 T(global opt: dvdson [mpi]                ) = 1.616e-05 S  per = 0.000152  per(accum) = 89.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.078e+00 S  per = 10.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.622e+00 S  T(sum) = 1.622e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.623e-03 S  per = 0.285  per(accum) = 0.285
 T(global opt: qops init                    ) = 5.850e-02 S  per = 3.61  per(accum) = 3.89
 T(global opt: symbolic_formulae_renorm     ) = 6.896e-02 S  per = 4.25  per(accum) = 8.14
 T(global opt: allocate qops on gpu         ) = 2.918e-03 S  per = 0.18  per(accum) = 8.32
 T(global opt: site memcpy cpu2gpu          ) = 2.125e-02 S  per = 1.31  per(accum) = 9.63
 T(global opt: rintermediate init           ) = 4.035e-02 S  per = 2.49  per(accum) = 12.1
 T(global opt: preprocess_formulae_Rlist2   ) = 4.775e-01 S  per = 29.4  per(accum) = 41.6
 T(global opt: rmmtasks init                ) = 2.427e-01 S  per =   15  per(accum) = 56.5
 T(global opt: qops memset on cpu           ) = 6.590e-07 S  per = 4.06e-05  per(accum) = 56.5
 T(global opt: preprocess_renorm_batchGPU   ) = 6.179e-01 S  per = 38.1  per(accum) = 94.6
 T(global opt: deallocate cpu and gpu memory) = 2.137e-03 S  per = 0.132  per(accum) = 94.8
 T(global opt: construct opS [ifdists=true] ) = 8.840e-07 S  per = 5.45e-05  per(accum) = 94.8
 T(global opt: reduction of opS & opH [nccl]) = 6.620e-07 S  per = 4.08e-05  per(accum) = 94.8
 T(global opt: qops memcpy gpu2cpu          ) = 2.001e-03 S  per = 0.123  per(accum) = 94.9
 T(global opt: reduction of opS & opH [mpi] ) = 7.994e-04 S  per = 0.0493  per(accum) = 94.9
 T(global opt: qops_pool join and erase     ) = 4.960e-02 S  per = 3.06  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 3.243e-02 S  per =    2  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.299e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=16/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=687:5.241e-03MB:5.119e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=711:5.424e-03MB:5.297e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=826:6.302e-03MB:6.154e-06GB
        per(mem): H:2.42 C:45.3 S:7.99 P:8.72 Q:35.6 
 rqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3820:0.0291MB:2.85e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.589e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=4.172e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=41:3.128e-04MB
qtensor4: wf4 own=1 _data=0x3a57c420
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=41:3.128e-04MB
### DIAG TIMING: total=6.712e-02 t1=2.734e-05, t2=1.720e-03, t3=2.563e-03, t4=6.278e-02, t5=4.334e-06, t6=1.394e-05, t7=4.131e-06
duration_diagGPU:6.713e-02
duration_diagreduce:9.800e-08
duration_diagtransform:4.700e-07
----- TIMING FOR symbolic_formulae_twodot with size=228 : 2.132e-03 S -----
rank=0 GPUmem(GB): used=2.846e-05 (oper)=2.846e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:2.853e-03MB:2.787e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.636e-05 S -----
rank=0 GPUmem(GB): used=3.125e-05 (oper,hinter)=2.846e-05,2.787e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.590e-02 S size(H_formulae)=228 size(Hxlst2)=24 T(Hmu/Hxlist)=5.569e-04,9.534e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.684e-02 S size(H_formulae)=228 size(Hxlst)=6332 -----
rank=0 GPUmem(GB): used=3.125e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=6.109e-07 batch[need]=6.133e-04 blksize=3 blksize0=6 batchsize=6332
rank=0 GPUmem(GB): used=6.452e-04 (oper,hinter,dvdson,batch)=2.846e-05,2.787e-06,6.109e-07,6.133e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=41 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.187e-04,2.755e-03,2.450e-02,1.309e-02,4.057e-02
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.140e-04 speed=2.855e-03GB/S T(nccl)=4.712e-06 speed=1.297e-01GB/S
----- TIMING FOR sigma : t_inter=2.8e-03 t_gemm=2.4e-02 t_reduction=1.3e-02 tot=4.0e-02 -----
 sigma[inter] counter=103 t=2.8e-03 per=6.8e+00 cost=5.4e+04 flops=2.0e+07
 sigma[gemm] counter=103 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=4 t=1.7e-03 per=4.2e+00 cost=7.6e+03 flops=4.5e+06
 sigma[gemm] counter=103 i=5 t=7.6e-03 per=1.9e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=103 i=6 t=7.6e-03 per=1.9e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=103 i=7 t=7.6e-03 per=1.9e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=103 total t=2.4e-02 per=6.1e+01 cost=5.2e+04 flops=2.1e+06
 sigma[red] counter=103 t=1.3e-02 per=3.2e+01 cost=2.3e+04 flops=1.7e+06
----- TIMING FOR sigma_tot : t_inter=9.2e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=103 t=9.2e-01 per=2.0e+01 cost=7.7e+07 flops=8.4e+07
 sigma_tot[gemm] counter=103 i=0 t=2.1e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=1.8e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=3 t=1.6e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=4 t=6.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=103 i=5 t=6.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=103 i=6 t=6.1e-01 per=1.3e+01 cost=1.4e+07 flops=2.3e+07
 sigma_tot[gemm] counter=103 i=7 t=6.1e-01 per=1.3e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=103 total t=2.5e+00 per=5.5e+01 cost=5.9e+07 flops=2.3e+07
 sigma_tot[red] counter=103 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=9.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.1e-06,2.1e-06,9.3e-07,1.9e-07
settings: ndim=41 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.311487721542 -1.116e+03  4.799e-02    1     1  4.070e-02 4.070e-02 4.068e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.046e-04,9.986e-03,2.977e-02,1.292e-02,5.321e-02
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=4.984e-04 speed=1.226e-03GB/S T(nccl)=6.242e-06 speed=9.788e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=104 t=1.0e-02 per=1.9e+01 cost=5.4e+04 flops=5.4e+06
 sigma[gemm] counter=104 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=1.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=4 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=104 i=5 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=104 i=6 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.5e+06
 sigma[gemm] counter=104 i=7 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=104 total t=3.0e-02 per=5.7e+01 cost=5.2e+04 flops=1.7e+06
 sigma[red] counter=104 t=1.3e-02 per=2.5e+01 cost=2.3e+04 flops=1.7e+06
----- TIMING FOR sigma_tot : t_inter=9.3e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=104 t=9.3e-01 per=2.0e+01 cost=7.7e+07 flops=8.3e+07
 sigma_tot[gemm] counter=104 i=0 t=2.1e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=1.8e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=3 t=1.6e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=4 t=6.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=104 i=5 t=6.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=104 i=6 t=6.2e-01 per=1.3e+01 cost=1.4e+07 flops=2.3e+07
 sigma_tot[gemm] counter=104 i=7 t=6.1e-01 per=1.3e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=104 total t=2.6e+00 per=5.5e+01 cost=5.9e+07 flops=2.3e+07
 sigma_tot[red] counter=104 t=1.1e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.2e-05,3.6e-06,8.9e-07,2.4e-07
    2   0 -    -116.316320812362 -4.833e-03  9.176e-03    2     2  1.063e-01 5.317e-02 4.700e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.269e-03,9.979e-03,2.994e-02,1.301e-02,5.521e-02
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.260e-03 speed=2.703e-04GB/S T(nccl)=8.355e-06 speed=7.312e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=105 t=1.0e-02 per=1.9e+01 cost=5.4e+04 flops=5.4e+06
 sigma[gemm] counter=105 i=0 t=2.9e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=2.6e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=2.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=3 t=2.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=4 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=105 i=5 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=105 i=6 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.5e+06
 sigma[gemm] counter=105 i=7 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=105 total t=3.0e-02 per=5.7e+01 cost=5.2e+04 flops=1.7e+06
 sigma[red] counter=105 t=1.3e-02 per=2.5e+01 cost=2.3e+04 flops=1.7e+06
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=2.6e+00 t_reduction=1.2e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=105 t=9.4e-01 per=2.0e+01 cost=7.7e+07 flops=8.2e+07
 sigma_tot[gemm] counter=105 i=0 t=2.2e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=1.9e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=3 t=1.6e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=4 t=6.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=105 i=5 t=6.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=105 i=6 t=6.2e-01 per=1.3e+01 cost=1.4e+07 flops=2.3e+07
 sigma_tot[gemm] counter=105 i=7 t=6.2e-01 per=1.3e+01 cost=1.5e+07 flops=2.4e+07
 sigma_tot[gemm] counter=105 total t=2.6e+00 per=5.5e+01 cost=5.9e+07 flops=2.3e+07
 sigma_tot[red] counter=105 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,2.0e-05,1.6e-05,1.6e-06,2.8e-07
    3   0 -    -116.316684783080 -3.640e-04  2.834e-03    3     3  1.744e-01 5.813e-02 4.979e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.230e-03,9.837e-03,2.979e-02,1.301e-02,5.488e-02
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.224e-03 speed=2.747e-04GB/S T(nccl)=6.254e-06 speed=9.769e-02GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=106 t=9.8e-03 per=1.9e+01 cost=5.4e+04 flops=5.5e+06
 sigma[gemm] counter=106 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=4 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=106 i=5 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=106 i=6 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.5e+06
 sigma[gemm] counter=106 i=7 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.5e+06
 sigma[gemm] counter=106 total t=3.0e-02 per=5.7e+01 cost=5.2e+04 flops=1.7e+06
 sigma[red] counter=106 t=1.3e-02 per=2.5e+01 cost=2.3e+04 flops=1.7e+06
----- TIMING FOR sigma_tot : t_inter=9.5e-01 t_gemm=2.6e+00 t_reduction=1.2e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=106 t=9.5e-01 per=2.0e+01 cost=7.7e+07 flops=8.1e+07
 sigma_tot[gemm] counter=106 i=0 t=2.2e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=1.9e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=3 t=1.6e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=4 t=6.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=106 i=5 t=6.8e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=106 i=6 t=6.3e-01 per=1.3e+01 cost=1.4e+07 flops=2.2e+07
 sigma_tot[gemm] counter=106 i=7 t=6.3e-01 per=1.3e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=106 total t=2.6e+00 per=5.5e+01 cost=5.9e+07 flops=2.2e+07
 sigma_tot[red] counter=106 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,2.9e-06,1.1e-06,2.5e-07
    4   0 -    -116.316727036912 -4.225e-05  7.229e-04    3     4  2.420e-01 6.049e-02 5.109e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.318e-03,9.942e-03,3.008e-02,1.292e-02,5.527e-02
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=2.312e-03 speed=2.643e-04GB/S T(nccl)=6.538e-06 speed=9.345e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=107 t=9.9e-03 per=1.9e+01 cost=5.4e+04 flops=5.4e+06
 sigma[gemm] counter=107 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=107 i=5 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=107 i=6 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=107 i=7 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.5e+06
 sigma[gemm] counter=107 total t=3.0e-02 per=5.7e+01 cost=5.2e+04 flops=1.7e+06
 sigma[red] counter=107 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.7e+06
----- TIMING FOR sigma_tot : t_inter=9.6e-01 t_gemm=2.6e+00 t_reduction=1.2e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=107 t=9.6e-01 per=2.0e+01 cost=7.7e+07 flops=8.0e+07
 sigma_tot[gemm] counter=107 i=0 t=2.2e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=1.9e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=3 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=4 t=6.8e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=107 i=5 t=6.9e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=107 i=6 t=6.4e-01 per=1.3e+01 cost=1.4e+07 flops=2.2e+07
 sigma_tot[gemm] counter=107 i=7 t=6.4e-01 per=1.3e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=107 total t=2.6e+00 per=5.5e+01 cost=5.9e+07 flops=2.2e+07
 sigma_tot[red] counter=107 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,3.0e-06,1.0e-06,2.3e-07
    5   0 -    -116.316728559371 -1.522e-06  2.466e-04    3     5  3.100e-01 6.200e-02 5.195e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.924e-03,1.009e-02,3.029e-02,1.292e-02,5.523e-02
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=1.918e-03 speed=3.185e-04GB/S T(nccl)=6.220e-06 speed=9.822e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=108 t=1.0e-02 per=1.9e+01 cost=5.4e+04 flops=5.3e+06
 sigma[gemm] counter=108 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=108 i=5 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=9.9e+05
 sigma[gemm] counter=108 i=6 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=108 i=7 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.5e+06
 sigma[gemm] counter=108 total t=3.0e-02 per=5.7e+01 cost=5.2e+04 flops=1.7e+06
 sigma[red] counter=108 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.7e+06
----- TIMING FOR sigma_tot : t_inter=9.7e-01 t_gemm=2.7e+00 t_reduction=1.2e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=108 t=9.7e-01 per=2.0e+01 cost=7.7e+07 flops=8.0e+07
 sigma_tot[gemm] counter=108 i=0 t=2.2e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=1.9e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=3 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=4 t=6.9e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=108 i=5 t=7.0e-01 per=1.4e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=108 i=6 t=6.5e-01 per=1.3e+01 cost=1.4e+07 flops=2.2e+07
 sigma_tot[gemm] counter=108 i=7 t=6.4e-01 per=1.3e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=108 total t=2.7e+00 per=5.5e+01 cost=5.9e+07 flops=2.2e+07
 sigma_tot[red] counter=108 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.2e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.4e-05,3.0e-06,1.0e-06,2.5e-07
    6   0 +    -116.316728679445 -1.201e-07  3.658e-05    3     6  3.784e-01 6.306e-02 5.251e-02
TIMING FOR Davidson : 3.784e-01  T(cal/comm/rest)=3.151e-01,9.020e-07,6.330e-02
decomposed t_rest=6.330e-02
 T(sub)    =1.417e-04 per=2.239e-01
 T(precond)=6.292e-02 per=9.940e+01
 T(ortho)  =7.644e-05 per=1.208e-01
 T(xcopy)  =8.680e-07 per=1.371e-03
 T(xnrm2)  =1.221e-05 per=1.928e-02
 T(other)  =1.516e-04 per=2.394e-01
optimized energies: isweep=0 ibond=16 dots=2 e[0]=-116.316728679445 nmvp=6
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=9.232e-04 change=1.658e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=11 dimAll=39
 (26,2):5 (28,2):7 (27,1):8 (27,3):4 (25,1):2 (26,0):3 (29,1):3 (28,0):3 (29,3):2 (28,4):1 (30,2):1
timing for divide=5.5e-05
timing for compute=1.2e-02
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=5.5e-05,1.2e-02,0.0e+00,4.8e-06,1.8e-05 -----
decimation summary: 39->9 dwt=+1.110e-16 SvN=9.103e-01
 qbond: qkept nsym=5 dimAll=9
 (28,0):3 (27,1):2 (29,1):2 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 1.210e-02 S T(decim/select/formRot)=1.177e-02,2.403e-04,9.633e-05 -----
----- TIMING FOR twodot_decimation: 1.253e-02 S T(wf/decim)=4.119e-04,1.212e-02 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:18 S:2 P:4 Q:6 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=507:3.868e-03MB:3.777e-06GB
        per(mem): H:3.75 C:63.9 S:7.1 P:5.13 Q:20.1 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=9.232e-04 change=7.631e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=31 : 1.107e-03 S -----
rank=0 GPUmem(GB): used=3.503e-05 (oper)=1.737e-05
rank=0 GPUmem(GB): used=3.533e-05 (oper,site)=1.737e-05,3.055e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=31
 no. of rintermediate operators=22
 no. of coefficients=374:2.853e-03MB:2.787e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.539e-03 S -----
rank=0 GPUmem(GB): used=3.812e-05 (oper,site,rinter)=1.737e-05,3.055e-07,2.787e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.584e-02 S size(rtasks)=31 size(Rlst2)=25 T(Rmu/Rlist)=2.556e-04,1.558e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.610e-02 S size(rtasks)=31 size(Rlst)=1279 -----
rank=0 GPUmem(GB): used=3.812e-05 avail=6.174e+00 total=6.174e+00 batch[need]=2.382e-04 blksize=9 blksize0=6 batchsize=1279
rank=0 GPUmem(GB): used=2.763e-04 (oper,site,rinter,batch)=1.737e-05,3.055e-07,2.787e-06,2.382e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.437e-03,2.279e-02,9.967e-03
----- TIMING FOR renorm : t_inter=5.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=17 t=5.4e-03 per=1.4e+01 cost=2.3e+04 flops=4.3e+06
 renorm[gemm] counter=17 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=3 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=4 t=7.7e-03 per=2.0e+01 cost=4.6e+03 flops=6.0e+05
 renorm[gemm] counter=17 i=5 t=7.6e-03 per=2.0e+01 cost=8.3e+03 flops=1.1e+06
 renorm[gemm] counter=17 i=6 t=7.5e-03 per=2.0e+01 cost=1.4e+04 flops=1.9e+06
 renorm[gemm] counter=17 total t=2.3e-02 per=6.0e+01 cost=2.7e+04 flops=1.2e+06
 renorm[red] counter=17 t=1.0e-02 per=2.6e+01 cost=8.1e+03 flops=8.1e+05
----- TIMING FOR renorm_tot : t_inter=1.0e-01 t_gemm=3.8e-01 t_reduction=1.7e-01 tot=6.5e-01 -----
 renorm_tot[inter] counter=17 t=1.0e-01 per=1.5e+01 cost=1.5e+06 flops=1.4e+07
 renorm_tot[gemm] counter=17 i=0 t=2.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=2.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=2.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=3 t=2.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=4 t=1.3e-01 per=1.9e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=17 i=5 t=1.3e-01 per=2.0e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=17 i=6 t=1.3e-01 per=2.0e+01 cost=9.6e+05 flops=7.5e+06
 renorm_tot[gemm] counter=17 total t=3.8e-01 per=5.9e+01 cost=1.7e+06 flops=4.5e+06
 renorm_tot[red] counter=17 t=1.7e-01 per=2.6e+01 cost=4.2e+05 flops=2.5e+06
qops.to_cpu: size(tot)=507:3.9e-03MB:3.8e-06GB T(to_cpu)=5.1e-05S speed=7.5e-02GB/S
check ||H-H.dagger||=9.603e-15 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.0675 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=8.698e-04 change=3.784e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.152e-03 change=-3.426e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.152e-03 change=-3.859e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.908e-01 S #####
 T(local opt: fetch) = 1.966e-02 S  per = 2.85  per(accum) = 2.85
 T(local opt: hdiag) = 6.761e-02 S  per = 9.79  per(accum) = 12.6
 T(local opt: dvdsn) = 5.220e-01 S  per = 75.6  per(accum) = 88.2
 T(local opt: decim) = 1.254e-02 S  per = 1.82  per(accum) = 90
 T(local opt: guess) = 8.147e-04 S  per = 0.118  per(accum) = 90.1
 T(local opt: renrm) = 6.801e-02 S  per = 9.85  per(accum) = 100
 T(local opt: save ) = 2.330e-04 S  per = 0.0337  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.220e-01 S  T(sum) = 5.216e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 3.322e-03 S  per = 0.637  per(accum) = 0.637
 T(local opt: symbolic_formulae           ) = 2.142e-03 S  per = 0.411  per(accum) = 1.05
 T(local opt: hintermediate init          ) = 9.104e-05 S  per = 0.0175  per(accum) = 1.07
 T(local opt: preprocess_hformulae_Hxlist ) = 9.704e-02 S  per = 18.6  per(accum) = 19.7
 T(local opt: hmmtasks init               ) = 3.966e-02 S  per =  7.6  per(accum) = 27.3
 T(local opt: initial guess for dvdson    ) = 9.168e-04 S  per = 0.176  per(accum) = 27.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.056e-01 S  per = 58.6  per(accum) = 86
 T(local opt: dvdson [cpu-gpu]            ) = 9.426e-03 S  per = 1.81  per(accum) = 87.9
 T(local opt: dvdson [nccl]               ) = 3.832e-05 S  per = 0.00735  per(accum) = 87.9
 T(local opt: dvdson [mpi]                ) = 9.020e-07 S  per = 0.000173  per(accum) = 87.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.330e-02 S  per = 12.1  per(accum) = 100
Detailed decomposition of T(renrm) = 6.801e-02 S  T(sum) = 6.801e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.105e-04 S  per = 0.457  per(accum) = 0.457
 T(local opt: qops init                    ) = 1.289e-03 S  per = 1.89  per(accum) = 2.35
 T(local opt: symbolic_formulae_renorm     ) = 1.117e-03 S  per = 1.64  per(accum) = 3.99
 T(local opt: allocate qops on gpu         ) = 1.004e-04 S  per = 0.148  per(accum) = 4.14
 T(local opt: site memcpy cpu2gpu          ) = 4.409e-04 S  per = 0.648  per(accum) = 4.79
 T(local opt: rintermediate init           ) = 2.551e-03 S  per = 3.75  per(accum) = 8.54
 T(local opt: preprocess_formulae_Rlist2   ) = 1.614e-02 S  per = 23.7  per(accum) = 32.3
 T(local opt: rmmtasks init                ) = 7.415e-03 S  per = 10.9  per(accum) = 43.2
 T(local opt: qops memset on cpu           ) = 4.100e-08 S  per = 6.03e-05  per(accum) = 43.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.828e-02 S  per = 56.3  per(accum) = 99.5
 T(local opt: deallocate cpu and gpu memory) = 6.436e-05 S  per = 0.0946  per(accum) = 99.6
 T(local opt: construct opS [ifdists=true] ) = 5.400e-08 S  per = 7.94e-05  per(accum) = 99.6
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 5.59e-05  per(accum) = 99.6
 T(local opt: qops memcpy gpu2cpu          ) = 5.759e-05 S  per = 0.0847  per(accum) = 99.6
 T(local opt: reduction of opS & opH [mpi] ) = 5.155e-05 S  per = 0.0758  per(accum) = 99.7
 T(local opt: qops_pool join and erase     ) = 1.877e-04 S  per = 0.276  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 5.807e-06 S  per = 0.00854  per(accum) = 100
##### sweep opt: 2.187e+01 S #####
 T(sweep opt: fetch) = 2.687e-01 S  per = 1.23  per(accum) = 1.23
 T(sweep opt: hdiag) = 8.507e+00 S  per = 38.9  per(accum) = 40.1
 T(sweep opt: dvdsn) = 1.114e+01 S  per = 50.9  per(accum) = 91.1
 T(sweep opt: decim) = 2.393e-01 S  per = 1.09  per(accum) = 92.2
 T(sweep opt: guess) = 1.961e-02 S  per = 0.0896  per(accum) = 92.2
 T(sweep opt: renrm) = 1.690e+00 S  per = 7.73  per(accum) = 100
 T(sweep opt: save ) = 5.880e-03 S  per = 0.0269  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.114e+01 S  T(sum) = 1.112e+01 S  per = 9.983e+01
 T(sweep opt: preprocess                  ) = 8.258e-02 S  per = 0.742  per(accum) = 0.742
 T(sweep opt: symbolic_formulae           ) = 1.235e-01 S  per = 1.11  per(accum) = 1.85
 T(sweep opt: hintermediate init          ) = 4.708e-03 S  per = 0.0423  per(accum) = 1.9
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.419e+00 S  per = 30.7  per(accum) = 32.6
 T(sweep opt: hmmtasks init               ) = 1.316e+00 S  per = 11.8  per(accum) = 44.5
 T(sweep opt: initial guess for dvdson    ) = 2.105e-02 S  per = 0.189  per(accum) = 44.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.869e+00 S  per = 43.8  per(accum) = 88.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.465e-01 S  per = 1.32  per(accum) = 89.7
 T(sweep opt: dvdson [nccl]               ) = 7.377e-04 S  per = 0.00663  per(accum) = 89.7
 T(sweep opt: dvdson [mpi]                ) = 1.706e-05 S  per = 0.000153  per(accum) = 89.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.141e+00 S  per = 10.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.690e+00 S  T(sum) = 1.690e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.934e-03 S  per = 0.292  per(accum) = 0.292
 T(sweep opt: qops init                    ) = 5.979e-02 S  per = 3.54  per(accum) = 3.83
 T(sweep opt: symbolic_formulae_renorm     ) = 7.007e-02 S  per = 4.15  per(accum) = 7.98
 T(sweep opt: allocate qops on gpu         ) = 3.019e-03 S  per = 0.179  per(accum) = 8.16
 T(sweep opt: site memcpy cpu2gpu          ) = 2.169e-02 S  per = 1.28  per(accum) = 9.44
 T(sweep opt: rintermediate init           ) = 4.290e-02 S  per = 2.54  per(accum) = 12
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.937e-01 S  per = 29.2  per(accum) = 41.2
 T(sweep opt: rmmtasks init                ) = 2.501e-01 S  per = 14.8  per(accum) = 56
 T(sweep opt: qops memset on cpu           ) = 7.000e-07 S  per = 4.14e-05  per(accum) = 56
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.561e-01 S  per = 38.8  per(accum) = 94.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.202e-03 S  per = 0.13  per(accum) = 95
 T(sweep opt: construct opS [ifdists=true] ) = 9.380e-07 S  per = 5.55e-05  per(accum) = 95
 T(sweep opt: reduction of opS & opH [nccl]) = 7.000e-07 S  per = 4.14e-05  per(accum) = 95
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.059e-03 S  per = 0.122  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.510e-04 S  per = 0.0504  per(accum) = 95.1
 T(sweep opt: qops_pool join and erase     ) = 4.979e-02 S  per = 2.95  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 3.243e-02 S  per = 1.92  per(accum) = 100
##### global opt: 2.187e+01 S #####
 T(global opt: fetch) = 2.687e-01 S  per = 1.23  per(accum) = 1.23
 T(global opt: hdiag) = 8.507e+00 S  per = 38.9  per(accum) = 40.1
 T(global opt: dvdsn) = 1.114e+01 S  per = 50.9  per(accum) = 91.1
 T(global opt: decim) = 2.393e-01 S  per = 1.09  per(accum) = 92.2
 T(global opt: guess) = 1.961e-02 S  per = 0.0896  per(accum) = 92.2
 T(global opt: renrm) = 1.690e+00 S  per = 7.73  per(accum) = 100
 T(global opt: save ) = 5.880e-03 S  per = 0.0269  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.114e+01 S  T(sum) = 1.112e+01 S  per = 9.983e+01
 T(global opt: preprocess                  ) = 8.258e-02 S  per = 0.742  per(accum) = 0.742
 T(global opt: symbolic_formulae           ) = 1.235e-01 S  per = 1.11  per(accum) = 1.85
 T(global opt: hintermediate init          ) = 4.708e-03 S  per = 0.0423  per(accum) = 1.9
 T(global opt: preprocess_hformulae_Hxlist ) = 3.419e+00 S  per = 30.7  per(accum) = 32.6
 T(global opt: hmmtasks init               ) = 1.316e+00 S  per = 11.8  per(accum) = 44.5
 T(global opt: initial guess for dvdson    ) = 2.105e-02 S  per = 0.189  per(accum) = 44.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.869e+00 S  per = 43.8  per(accum) = 88.4
 T(global opt: dvdson [cpu-gpu]            ) = 1.465e-01 S  per = 1.32  per(accum) = 89.7
 T(global opt: dvdson [nccl]               ) = 7.377e-04 S  per = 0.00663  per(accum) = 89.7
 T(global opt: dvdson [mpi]                ) = 1.706e-05 S  per = 0.000153  per(accum) = 89.7
 T(global opt: dvdson [rest part(linalg)]  ) = 1.141e+00 S  per = 10.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.690e+00 S  T(sum) = 1.690e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.934e-03 S  per = 0.292  per(accum) = 0.292
 T(global opt: qops init                    ) = 5.979e-02 S  per = 3.54  per(accum) = 3.83
 T(global opt: symbolic_formulae_renorm     ) = 7.007e-02 S  per = 4.15  per(accum) = 7.98
 T(global opt: allocate qops on gpu         ) = 3.019e-03 S  per = 0.179  per(accum) = 8.16
 T(global opt: site memcpy cpu2gpu          ) = 2.169e-02 S  per = 1.28  per(accum) = 9.44
 T(global opt: rintermediate init           ) = 4.290e-02 S  per = 2.54  per(accum) = 12
 T(global opt: preprocess_formulae_Rlist2   ) = 4.937e-01 S  per = 29.2  per(accum) = 41.2
 T(global opt: rmmtasks init                ) = 2.501e-01 S  per = 14.8  per(accum) = 56
 T(global opt: qops memset on cpu           ) = 7.000e-07 S  per = 4.14e-05  per(accum) = 56
 T(global opt: preprocess_renorm_batchGPU   ) = 6.561e-01 S  per = 38.8  per(accum) = 94.8
 T(global opt: deallocate cpu and gpu memory) = 2.202e-03 S  per = 0.13  per(accum) = 95
 T(global opt: construct opS [ifdists=true] ) = 9.380e-07 S  per = 5.55e-05  per(accum) = 95
 T(global opt: reduction of opS & opH [nccl]) = 7.000e-07 S  per = 4.14e-05  per(accum) = 95
 T(global opt: qops memcpy gpu2cpu          ) = 2.059e-03 S  per = 0.122  per(accum) = 95.1
 T(global opt: reduction of opS & opH [mpi] ) = 8.510e-04 S  per = 0.0504  per(accum) = 95.1
 T(global opt: qops_pool join and erase     ) = 4.979e-02 S  per = 2.95  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 3.243e-02 S  per = 1.92  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.642e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=17/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=721:5.501e-03MB:5.372e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=741:5.653e-03MB:5.521e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=826:6.302e-03MB:6.154e-06GB
        per(mem): H:2.42 C:45.3 S:7.99 P:8.72 Q:35.6 
 rqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3820:0.0291MB:2.85e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=5.364e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.341e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=41:3.128e-04MB
qtensor4: wf4 own=1 _data=0x3a57c420
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=41:3.128e-04MB
### DIAG TIMING: total=6.760e-02 t1=4.383e-05, t2=1.951e-03, t3=2.507e-03, t4=6.308e-02, t5=4.142e-06, t6=1.378e-05, t7=3.919e-06
duration_diagGPU:6.762e-02
duration_diagreduce:2.057e-06
duration_diagtransform:5.160e-07
----- TIMING FOR symbolic_formulae_twodot with size=228 : 2.076e-03 S -----
rank=0 GPUmem(GB): used=3.224e-05 (oper)=2.846e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:2.853e-03MB:2.787e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.545e-05 S -----
rank=0 GPUmem(GB): used=3.503e-05 (oper,hinter)=2.846e-05,2.787e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.496e-02 S size(H_formulae)=228 size(Hxlst2)=24 T(Hmu/Hxlist)=5.263e-04,9.444e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.588e-02 S size(H_formulae)=228 size(Hxlst)=6332 -----
rank=0 GPUmem(GB): used=3.503e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=6.109e-07 batch[need]=6.133e-04 blksize=3 blksize0=6 batchsize=6332
rank=0 GPUmem(GB): used=6.489e-04 (oper,hinter,dvdson,batch)=2.846e-05,2.787e-06,6.109e-07,6.133e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=41 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.222e-03,1.003e-02,3.001e-02,1.311e-02,5.438e-02
 analyze_tgpu[Hx]: ndim=41:3.055e-07GB T(cpu-gpu)=1.217e-03 speed=5.019e-04GB/S T(nccl)=4.878e-06 speed=1.252e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=109 t=1.0e-02 per=1.9e+01 cost=5.4e+04 flops=5.4e+06
 sigma[gemm] counter=109 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=109 i=5 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=109 i=6 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.5e+06
 sigma[gemm] counter=109 i=7 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=109 total t=3.0e-02 per=5.6e+01 cost=5.2e+04 flops=1.7e+06
 sigma[red] counter=109 t=1.3e-02 per=2.5e+01 cost=2.3e+04 flops=1.7e+06
----- TIMING FOR sigma_tot : t_inter=9.8e-01 t_gemm=2.7e+00 t_reduction=1.2e+00 tot=4.9e+00 -----
 sigma_tot[inter] counter=109 t=9.8e-01 per=2.0e+01 cost=7.7e+07 flops=7.9e+07
 sigma_tot[gemm] counter=109 i=0 t=2.2e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=1.9e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=1.6e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=3 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=4 t=7.0e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=109 i=5 t=7.0e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=109 i=6 t=6.5e-01 per=1.3e+01 cost=1.4e+07 flops=2.2e+07
 sigma_tot[gemm] counter=109 i=7 t=6.5e-01 per=1.3e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=109 total t=2.7e+00 per=5.5e+01 cost=5.9e+07 flops=2.2e+07
 sigma_tot[red] counter=109 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=9.0e-06 T(gemm/eig/ortho/gemm/axpy)=2.3e-06,3.9e-06,2.0e-06,7.6e-07,1.8e-07
settings: ndim=41 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.316728679445 -1.116e+03  3.658e-05    1     1  5.451e-02 5.451e-02 5.449e-02
TIMING FOR Davidson : 5.454e-02  T(cal/comm/rest)=5.449e-02,1.320e-07,4.762e-05
decomposed t_rest=4.762e-05
 T(sub)    =9.041e-06 per=1.898e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.450e-07 per=5.144e-01
 T(xnrm2)  =3.470e-07 per=7.286e-01
 T(other)  =3.799e-05 per=7.977e+01
optimized energies: isweep=0 ibond=17 dots=2 e[0]=-116.316728679445 nmvp=1
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=1.642e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond17.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
timing for divide=5.2e-05
timing for compute=1.0e-02
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(su2): 1.0e-02 S T(divide/compute[cpu/gpu/rest]/collect)=5.2e-05,1.0e-02,0.0e+00,4.2e-06,1.6e-05 -----
decimation summary: 10->9 dwt=+0.000e+00 SvN=9.103e-01
 qbond: qkept nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 1.056e-02 S T(decim/select/formRot)=1.029e-02,2.179e-04,5.849e-05 -----
----- TIMING FOR twodot_decimation: 1.109e-02 S T(wf/decim)=4.603e-04,1.063e-02 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=507:3.868e-03MB:3.777e-06GB
        per(mem): H:3.75 C:7.1 S:63.9 A:5.13 B:20.1 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=7.337e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=31 : 1.055e-03 S -----
rank=0 GPUmem(GB): used=3.265e-05 (oper)=1.865e-05
rank=0 GPUmem(GB): used=3.279e-05 (oper,site)=1.865e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=31
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=3.279e-05 (oper,site,rinter)=1.865e-05,1.416e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 1.036e-02 S size(rtasks)=31 size(Rlst2)=25 T(Rmu/Rlist)=4.028e-04,9.958e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.051e-02 S size(rtasks)=31 size(Rlst)=828 -----
rank=0 GPUmem(GB): used=3.279e-05 avail=6.174e+00 total=6.174e+00 batch[need]=1.172e-04 blksize=9 blksize0=0 batchsize=828
rank=0 GPUmem(GB): used=1.500e-04 (oper,site,rinter,batch)=1.865e-05,1.416e-07,0.000e+00,1.172e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.452e-06,2.223e-02,9.980e-03
----- TIMING FOR renorm : t_inter=8.2e-06 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.2e-02 -----
 renorm[inter] counter=18 t=8.2e-06 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=1.6e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=7.3e-03 per=2.3e+01 cost=1.2e+03 flops=1.6e+05
 renorm[gemm] counter=18 i=3 t=7.5e-03 per=2.3e+01 cost=1.5e+03 flops=2.1e+05
 renorm[gemm] counter=18 i=4 t=1.3e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=7.5e-03 per=2.3e+01 cost=7.3e+03 flops=9.8e+05
 renorm[gemm] counter=18 total t=2.2e-02 per=6.9e+01 cost=1.0e+04 flops=4.5e+05
 renorm[red] counter=18 t=1.0e-02 per=3.1e+01 cost=7.3e+03 flops=7.3e+05
----- TIMING FOR renorm_tot : t_inter=1.0e-01 t_gemm=4.1e-01 t_reduction=1.8e-01 tot=6.9e-01 -----
 renorm_tot[inter] counter=18 t=1.0e-01 per=1.5e+01 cost=1.5e+06 flops=1.4e+07
 renorm_tot[gemm] counter=18 i=0 t=2.7e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=7.3e-03 per=1.1e+00 cost=1.2e+03 flops=1.6e+05
 renorm_tot[gemm] counter=18 i=3 t=7.5e-03 per=1.1e+00 cost=1.5e+03 flops=2.1e+05
 renorm_tot[gemm] counter=18 i=4 t=1.3e-01 per=1.8e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=18 i=5 t=1.3e-01 per=1.9e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=18 i=6 t=1.4e-01 per=2.0e+01 cost=9.7e+05 flops=7.1e+06
 renorm_tot[gemm] counter=18 total t=4.1e-01 per=5.9e+01 cost=1.7e+06 flops=4.2e+06
 renorm_tot[red] counter=18 t=1.8e-01 per=2.6e+01 cost=4.3e+05 flops=2.4e+06
qops.to_cpu: size(tot)=507:3.9e-03MB:3.8e-06GB T(to_cpu)=4.5e-05S speed=8.4e-02GB/S
check ||H-H.dagger||=1.998e-15 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.052 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=2.462e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.831e-03 change=-1.997e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.831e-03 change=-2.176e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 3.325e-01 S #####
 T(local opt: fetch) = 2.484e-04 S  per = 0.0747  per(accum) = 0.0747
 T(local opt: hdiag) = 6.810e-02 S  per = 20.5  per(accum) = 20.6
 T(local opt: dvdsn) = 1.961e-01 S  per =   59  per(accum) = 79.5
 T(local opt: decim) = 1.110e-02 S  per = 3.34  per(accum) = 82.9
 T(local opt: guess) = 9.629e-04 S  per = 0.29  per(accum) = 83.2
 T(local opt: renrm) = 5.579e-02 S  per = 16.8  per(accum) = 99.9
 T(local opt: save ) = 1.848e-04 S  per = 0.0556  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.961e-01 S  T(sum) = 1.958e-01 S  per = 9.982e+01
 T(local opt: preprocess                  ) = 3.219e-03 S  per = 1.64  per(accum) = 1.64
 T(local opt: symbolic_formulae           ) = 2.085e-03 S  per = 1.06  per(accum) = 2.71
 T(local opt: hintermediate init          ) = 7.919e-05 S  per = 0.0405  per(accum) = 2.75
 T(local opt: preprocess_hformulae_Hxlist ) = 9.607e-02 S  per = 49.1  per(accum) = 51.8
 T(local opt: hmmtasks init               ) = 3.888e-02 S  per = 19.9  per(accum) = 71.7
 T(local opt: initial guess for dvdson    ) = 9.077e-04 S  per = 0.464  per(accum) = 72.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.327e-02 S  per = 27.2  per(accum) = 99.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.217e-03 S  per = 0.622  per(accum) = 100
 T(local opt: dvdson [nccl]               ) = 4.878e-06 S  per = 0.00249  per(accum) = 100
 T(local opt: dvdson [mpi]                ) = 1.320e-07 S  per = 6.74e-05  per(accum) = 100
 T(local opt: dvdson [rest part(linalg)]  ) = 4.762e-05 S  per = 0.0243  per(accum) = 100
Detailed decomposition of T(renrm) = 5.579e-02 S  T(sum) = 5.579e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.696e-04 S  per = 0.304  per(accum) = 0.304
 T(local opt: qops init                    ) = 1.243e-03 S  per = 2.23  per(accum) = 2.53
 T(local opt: symbolic_formulae_renorm     ) = 1.065e-03 S  per = 1.91  per(accum) = 4.44
 T(local opt: allocate qops on gpu         ) = 5.453e-05 S  per = 0.0977  per(accum) = 4.54
 T(local opt: site memcpy cpu2gpu          ) = 2.059e-03 S  per = 3.69  per(accum) = 8.23
 T(local opt: rintermediate init           ) = 2.771e-05 S  per = 0.0497  per(accum) = 8.28
 T(local opt: preprocess_formulae_Rlist2   ) = 1.054e-02 S  per = 18.9  per(accum) = 27.2
 T(local opt: rmmtasks init                ) = 4.585e-03 S  per = 8.22  per(accum) = 35.4
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 6.27e-05  per(accum) = 35.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.231e-02 S  per = 57.9  per(accum) = 93.3
 T(local opt: deallocate cpu and gpu memory) = 4.519e-05 S  per = 0.081  per(accum) = 93.4
 T(local opt: construct opS [ifdists=true] ) = 4.100e-08 S  per = 7.35e-05  per(accum) = 93.4
 T(local opt: reduction of opS & opH [nccl]) = 3.100e-08 S  per = 5.56e-05  per(accum) = 93.4
 T(local opt: qops memcpy gpu2cpu          ) = 5.192e-05 S  per = 0.0931  per(accum) = 93.5
 T(local opt: reduction of opS & opH [mpi] ) = 5.140e-05 S  per = 0.0921  per(accum) = 93.6
 T(local opt: qops_pool join and erase     ) = 3.584e-03 S  per = 6.42  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.530e-06 S  per = 0.00812  per(accum) = 100
##### sweep opt: 2.220e+01 S #####
 T(sweep opt: fetch) = 2.690e-01 S  per = 1.21  per(accum) = 1.21
 T(sweep opt: hdiag) = 8.575e+00 S  per = 38.6  per(accum) = 39.8
 T(sweep opt: dvdsn) = 1.134e+01 S  per = 51.1  per(accum) = 90.9
 T(sweep opt: decim) = 2.504e-01 S  per = 1.13  per(accum) = 92
 T(sweep opt: guess) = 2.057e-02 S  per = 0.0926  per(accum) = 92.1
 T(sweep opt: renrm) = 1.745e+00 S  per = 7.86  per(accum) = 100
 T(sweep opt: save ) = 6.064e-03 S  per = 0.0273  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.134e+01 S  T(sum) = 1.132e+01 S  per = 9.983e+01
 T(sweep opt: preprocess                  ) = 8.580e-02 S  per = 0.758  per(accum) = 0.758
 T(sweep opt: symbolic_formulae           ) = 1.256e-01 S  per = 1.11  per(accum) = 1.87
 T(sweep opt: hintermediate init          ) = 4.787e-03 S  per = 0.0423  per(accum) = 1.91
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.515e+00 S  per = 31.1  per(accum) = 33
 T(sweep opt: hmmtasks init               ) = 1.355e+00 S  per =   12  per(accum) = 44.9
 T(sweep opt: initial guess for dvdson    ) = 2.196e-02 S  per = 0.194  per(accum) = 45.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.922e+00 S  per = 43.5  per(accum) = 88.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.478e-01 S  per = 1.31  per(accum) = 89.9
 T(sweep opt: dvdson [nccl]               ) = 7.426e-04 S  per = 0.00656  per(accum) = 89.9
 T(sweep opt: dvdson [mpi]                ) = 1.720e-05 S  per = 0.000152  per(accum) = 89.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.141e+00 S  per = 10.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.745e+00 S  T(sum) = 1.745e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.104e-03 S  per = 0.292  per(accum) = 0.292
 T(sweep opt: qops init                    ) = 6.103e-02 S  per =  3.5  per(accum) = 3.79
 T(sweep opt: symbolic_formulae_renorm     ) = 7.114e-02 S  per = 4.08  per(accum) = 7.86
 T(sweep opt: allocate qops on gpu         ) = 3.073e-03 S  per = 0.176  per(accum) = 8.04
 T(sweep opt: site memcpy cpu2gpu          ) = 2.375e-02 S  per = 1.36  per(accum) = 9.4
 T(sweep opt: rintermediate init           ) = 4.292e-02 S  per = 2.46  per(accum) = 11.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.042e-01 S  per = 28.9  per(accum) = 40.7
 T(sweep opt: rmmtasks init                ) = 2.547e-01 S  per = 14.6  per(accum) = 55.3
 T(sweep opt: qops memset on cpu           ) = 7.350e-07 S  per = 4.21e-05  per(accum) = 55.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.884e-01 S  per = 39.4  per(accum) = 94.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.247e-03 S  per = 0.129  per(accum) = 94.9
 T(sweep opt: construct opS [ifdists=true] ) = 9.790e-07 S  per = 5.61e-05  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [nccl]) = 7.310e-07 S  per = 4.19e-05  per(accum) = 94.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.111e-03 S  per = 0.121  per(accum) = 95
 T(sweep opt: reduction of opS & opH [mpi] ) = 9.024e-04 S  per = 0.0517  per(accum) = 95.1
 T(sweep opt: qops_pool join and erase     ) = 5.337e-02 S  per = 3.06  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 3.244e-02 S  per = 1.86  per(accum) = 100
##### global opt: 2.220e+01 S #####
 T(global opt: fetch) = 2.690e-01 S  per = 1.21  per(accum) = 1.21
 T(global opt: hdiag) = 8.575e+00 S  per = 38.6  per(accum) = 39.8
 T(global opt: dvdsn) = 1.134e+01 S  per = 51.1  per(accum) = 90.9
 T(global opt: decim) = 2.504e-01 S  per = 1.13  per(accum) = 92
 T(global opt: guess) = 2.057e-02 S  per = 0.0926  per(accum) = 92.1
 T(global opt: renrm) = 1.745e+00 S  per = 7.86  per(accum) = 100
 T(global opt: save ) = 6.064e-03 S  per = 0.0273  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.134e+01 S  T(sum) = 1.132e+01 S  per = 9.983e+01
 T(global opt: preprocess                  ) = 8.580e-02 S  per = 0.758  per(accum) = 0.758
 T(global opt: symbolic_formulae           ) = 1.256e-01 S  per = 1.11  per(accum) = 1.87
 T(global opt: hintermediate init          ) = 4.787e-03 S  per = 0.0423  per(accum) = 1.91
 T(global opt: preprocess_hformulae_Hxlist ) = 3.515e+00 S  per = 31.1  per(accum) = 33
 T(global opt: hmmtasks init               ) = 1.355e+00 S  per =   12  per(accum) = 44.9
 T(global opt: initial guess for dvdson    ) = 2.196e-02 S  per = 0.194  per(accum) = 45.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.922e+00 S  per = 43.5  per(accum) = 88.6
 T(global opt: dvdson [cpu-gpu]            ) = 1.478e-01 S  per = 1.31  per(accum) = 89.9
 T(global opt: dvdson [nccl]               ) = 7.426e-04 S  per = 0.00656  per(accum) = 89.9
 T(global opt: dvdson [mpi]                ) = 1.720e-05 S  per = 0.000152  per(accum) = 89.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.141e+00 S  per = 10.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.745e+00 S  T(sum) = 1.745e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.104e-03 S  per = 0.292  per(accum) = 0.292
 T(global opt: qops init                    ) = 6.103e-02 S  per =  3.5  per(accum) = 3.79
 T(global opt: symbolic_formulae_renorm     ) = 7.114e-02 S  per = 4.08  per(accum) = 7.86
 T(global opt: allocate qops on gpu         ) = 3.073e-03 S  per = 0.176  per(accum) = 8.04
 T(global opt: site memcpy cpu2gpu          ) = 2.375e-02 S  per = 1.36  per(accum) = 9.4
 T(global opt: rintermediate init           ) = 4.292e-02 S  per = 2.46  per(accum) = 11.9
 T(global opt: preprocess_formulae_Rlist2   ) = 5.042e-01 S  per = 28.9  per(accum) = 40.7
 T(global opt: rmmtasks init                ) = 2.547e-01 S  per = 14.6  per(accum) = 55.3
 T(global opt: qops memset on cpu           ) = 7.350e-07 S  per = 4.21e-05  per(accum) = 55.3
 T(global opt: preprocess_renorm_batchGPU   ) = 6.884e-01 S  per = 39.4  per(accum) = 94.8
 T(global opt: deallocate cpu and gpu memory) = 2.247e-03 S  per = 0.129  per(accum) = 94.9
 T(global opt: construct opS [ifdists=true] ) = 9.790e-07 S  per = 5.61e-05  per(accum) = 94.9
 T(global opt: reduction of opS & opH [nccl]) = 7.310e-07 S  per = 4.19e-05  per(accum) = 94.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.111e-03 S  per = 0.121  per(accum) = 95
 T(global opt: reduction of opS & opH [mpi] ) = 9.024e-04 S  per = 0.0517  per(accum) = 95.1
 T(global opt: qops_pool join and erase     ) = 5.337e-02 S  per = 3.06  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 3.244e-02 S  per = 1.86  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.644e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=18/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=735:5.608e-03MB:5.476e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=41:3.128e-04MB:3.055e-07GB
total mem of comb=777:5.928e-03MB:5.789e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1090:8.316e-03MB:8.121e-06GB
        per(mem): H:1.83 C:32.3 S:8.07 P:11.9 Q:45.9 
 rqops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=9,9 size(op)=19:0.000145MB size(tot)=507:0.00387MB:3.78e-06GB
        per(mem): H:3.75 C:7.1 S:63.9 A:5.13 B:20.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3593:0.0274MB:2.68e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.579e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-8.166e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,9,3,3) nnz=79:6.027e-04MB
qtensor4: wf4 own=1 _data=0x3b5f5680
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
 qbond: qcol nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=31 nblocks=432 size=79:6.027e-04MB
### DIAG TIMING: total=1.263e-01 t1=2.478e-05, t2=1.313e-03, t3=2.490e-03, t4=1.225e-01, t5=4.421e-06, t6=1.411e-05, t7=4.776e-06
duration_diagGPU:1.263e-01
duration_diagreduce:3.400e-08
duration_diagtransform:7.290e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 2.433e-03 S -----
rank=0 GPUmem(GB): used=2.677e-05 (oper)=2.677e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=195
 no. of hintermediate operators=73
 no. of coefficients=996:7.599e-03MB:7.421e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.015e-04 S -----
rank=0 GPUmem(GB): used=3.419e-05 (oper,hinter)=2.677e-05,7.421e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.343e-01 S size(H_formulae)=195 size(Hxlst2)=31 T(Hmu/Hxlist)=4.704e-04,1.338e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.354e-01 S size(H_formulae)=195 size(Hxlst)=7950 -----
rank=0 GPUmem(GB): used=3.419e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.177e-06 batch[need]=1.658e-03 blksize=9 blksize0=9 batchsize=7950
rank=0 GPUmem(GB): used=1.694e-03 (oper,hinter,dvdson,batch)=2.677e-05,7.421e-06,1.177e-06,1.658e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=79 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.009e-03,1.004e-02,2.996e-02,1.301e-02,5.502e-02
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=2.004e-03 speed=5.874e-04GB/S T(nccl)=4.934e-06 speed=2.386e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=110 t=1.0e-02 per=1.9e+01 cost=2.1e+05 flops=2.1e+07
 sigma[gemm] counter=110 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=4 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=110 i=5 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.4e+06
 sigma[gemm] counter=110 i=6 t=7.6e-03 per=1.4e+01 cost=3.0e+04 flops=3.9e+06
 sigma[gemm] counter=110 i=7 t=7.4e-03 per=1.4e+01 cost=3.0e+04 flops=4.1e+06
 sigma[gemm] counter=110 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.7e+06
 sigma[red] counter=110 t=1.3e-02 per=2.5e+01 cost=4.3e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=9.9e-01 t_gemm=2.7e+00 t_reduction=1.2e+00 tot=5.0e+00 -----
 sigma_tot[inter] counter=110 t=9.9e-01 per=2.0e+01 cost=7.8e+07 flops=7.8e+07
 sigma_tot[gemm] counter=110 i=0 t=2.2e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=1.9e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=1.7e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=3 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=4 t=7.0e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=110 i=5 t=7.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=110 i=6 t=6.6e-01 per=1.3e+01 cost=1.4e+07 flops=2.2e+07
 sigma_tot[gemm] counter=110 i=7 t=6.6e-01 per=1.3e+01 cost=1.5e+07 flops=2.3e+07
 sigma_tot[gemm] counter=110 total t=2.7e+00 per=5.5e+01 cost=5.9e+07 flops=2.2e+07
 sigma_tot[red] counter=110 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.0e-06,2.0e-06,8.9e-07,2.1e-07
settings: ndim=79 neig=1 maxcycle=30 nbuff=4 memory=9e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316728679445 -1.116e+03  4.972e-03    1     1  5.514e-02 5.514e-02 5.512e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.698e-03,1.002e-02,2.752e-02,9.600e-03,4.886e-02
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=1.689e-03 speed=6.968e-04GB/S T(nccl)=8.498e-06 speed=1.385e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.8e-02 t_reduction=9.6e-03 tot=4.7e-02 -----
 sigma[inter] counter=111 t=1.0e-02 per=2.1e+01 cost=2.1e+05 flops=2.1e+07
 sigma[gemm] counter=111 i=0 t=1.7e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=1.5e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=1.4e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=3 t=1.5e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=4 t=7.5e-03 per=1.6e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=111 i=5 t=7.5e-03 per=1.6e+01 cost=2.6e+04 flops=3.4e+06
 sigma[gemm] counter=111 i=6 t=7.7e-03 per=1.6e+01 cost=3.0e+04 flops=3.9e+06
 sigma[gemm] counter=111 i=7 t=4.9e-03 per=1.0e+01 cost=3.0e+04 flops=6.2e+06
 sigma[gemm] counter=111 total t=2.8e-02 per=5.8e+01 cost=1.1e+05 flops=4.1e+06
 sigma[red] counter=111 t=9.6e-03 per=2.0e+01 cost=4.3e+04 flops=4.5e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=5.0e+00 -----
 sigma_tot[inter] counter=111 t=1.0e+00 per=2.0e+01 cost=7.8e+07 flops=7.8e+07
 sigma_tot[gemm] counter=111 i=0 t=2.2e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=1.9e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=1.7e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=3 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=4 t=7.1e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=111 i=5 t=7.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=111 i=6 t=6.7e-01 per=1.3e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=111 i=7 t=6.6e-01 per=1.3e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=111 total t=2.8e+00 per=5.5e+01 cost=5.9e+07 flops=2.1e+07
 sigma_tot[red] counter=111 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,2.1e-05,2.1e-05,2.1e-06,4.4e-07
    2   0 -    -116.316764282601 -3.560e-05  8.028e-04    2     2  1.154e-01 5.771e-02 5.211e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.537e-04,8.460e-03,2.992e-02,1.294e-02,5.252e-02
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=2.078e-04 speed=5.665e-03GB/S T(nccl)=4.592e-05 speed=2.564e-02GB/S
----- TIMING FOR sigma : t_inter=8.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=112 t=8.5e-03 per=1.6e+01 cost=2.1e+05 flops=2.5e+07
 sigma[gemm] counter=112 i=0 t=3.1e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=2.7e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=2.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=3 t=2.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=4 t=7.5e-03 per=1.5e+01 cost=2.6e+04 flops=3.4e+06
 sigma[gemm] counter=112 i=5 t=7.4e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=112 i=6 t=7.5e-03 per=1.5e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=112 i=7 t=7.4e-03 per=1.4e+01 cost=3.0e+04 flops=4.1e+06
 sigma[gemm] counter=112 total t=3.0e-02 per=5.8e+01 cost=1.1e+05 flops=3.7e+06
 sigma[red] counter=112 t=1.3e-02 per=2.5e+01 cost=4.3e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=112 t=1.0e+00 per=2.0e+01 cost=7.8e+07 flops=7.7e+07
 sigma_tot[gemm] counter=112 i=0 t=2.3e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=3 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=4 t=7.2e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=112 i=5 t=7.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=112 i=6 t=6.8e-01 per=1.3e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=112 i=7 t=6.7e-01 per=1.3e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=112 total t=2.8e+00 per=5.5e+01 cost=5.9e+07 flops=2.1e+07
 sigma_tot[red] counter=112 t=1.2e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=7.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.0e-06,5.5e-05,9.6e-06,3.2e-06,3.2e-07
    3   0 -    -116.316765757078 -1.474e-06  3.027e-04    3     3  1.812e-01 6.041e-02 5.231e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.081e-03,9.807e-03,2.986e-02,1.290e-02,5.366e-02
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=1.076e-03 speed=1.094e-03GB/S T(nccl)=4.783e-06 speed=2.461e-01GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=113 t=9.8e-03 per=1.9e+01 cost=2.1e+05 flops=2.2e+07
 sigma[gemm] counter=113 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=4 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=113 i=5 t=7.5e-03 per=1.4e+01 cost=2.6e+04 flops=3.4e+06
 sigma[gemm] counter=113 i=6 t=7.5e-03 per=1.4e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=113 i=7 t=7.4e-03 per=1.4e+01 cost=3.0e+04 flops=4.1e+06
 sigma[gemm] counter=113 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.7e+06
 sigma[red] counter=113 t=1.3e-02 per=2.5e+01 cost=4.3e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=2.8e+00 t_reduction=1.3e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=113 t=1.0e+00 per=2.0e+01 cost=7.8e+07 flops=7.7e+07
 sigma_tot[gemm] counter=113 i=0 t=2.3e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=1.7e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=3 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=4 t=7.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=113 i=5 t=7.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=113 i=6 t=6.8e-01 per=1.3e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=113 i=7 t=6.8e-01 per=1.3e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=113 total t=2.8e+00 per=5.5e+01 cost=5.9e+07 flops=2.1e+07
 sigma_tot[red] counter=113 t=1.3e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,2.9e-06,1.1e-06,2.1e-07
    4   0 -    -116.316765951898 -1.948e-07  1.027e-04    3     4  2.508e-01 6.269e-02 5.268e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.173e-03,9.948e-03,3.020e-02,1.295e-02,5.428e-02
 analyze_tgpu[Hx]: ndim=79:5.886e-07GB T(cpu-gpu)=1.167e-03 speed=1.009e-03GB/S T(nccl)=6.114e-06 speed=1.925e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=114 t=9.9e-03 per=1.9e+01 cost=2.1e+05 flops=2.2e+07
 sigma[gemm] counter=114 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=3 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=4 t=7.4e-03 per=1.4e+01 cost=2.6e+04 flops=3.5e+06
 sigma[gemm] counter=114 i=5 t=7.6e-03 per=1.4e+01 cost=2.6e+04 flops=3.4e+06
 sigma[gemm] counter=114 i=6 t=7.6e-03 per=1.4e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=114 i=7 t=7.6e-03 per=1.4e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=114 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.7e+06
 sigma[red] counter=114 t=1.3e-02 per=2.4e+01 cost=4.3e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=2.9e+00 t_reduction=1.3e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=114 t=1.0e+00 per=2.0e+01 cost=7.8e+07 flops=7.6e+07
 sigma_tot[gemm] counter=114 i=0 t=2.3e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=1.7e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=3 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=4 t=7.3e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=114 i=5 t=7.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=114 i=6 t=6.9e-01 per=1.3e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=114 i=7 t=6.9e-01 per=1.3e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=114 total t=2.9e+00 per=5.5e+01 cost=5.9e+07 flops=2.1e+07
 sigma_tot[red] counter=114 t=1.3e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.1e-06,1.3e-06,2.1e-07
    5   0 +    -116.316765976237 -2.434e-08  3.292e-05    3     5  3.168e-01 6.337e-02 5.302e-02
TIMING FOR Davidson : 3.169e-01  T(cal/comm/rest)=2.651e-01,9.680e-07,5.175e-02
decomposed t_rest=5.175e-02
 T(sub)    =1.819e-04 per=3.515e-01
 T(precond)=5.136e-02 per=9.926e+01
 T(ortho)  =4.545e-05 per=8.783e-02
 T(xcopy)  =1.034e-06 per=1.998e-03
 T(xnrm2)  =1.287e-05 per=2.487e-02
 T(other)  =1.429e-04 per=2.762e-01
optimized energies: isweep=0 ibond=18 dots=2 e[0]=-116.316765976237 nmvp=5
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.129e-03 change=2.171e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond18.txt
 qbond: qsuper nsym=9 dimAll=32
 (2,0):5 (1,1):2 (3,1):8 (4,0):6 (2,2):3 (5,1):3 (6,0):1 (4,2):3 (3,3):1
timing for divide=8.8e-05
timing for compute=1.3e-02
timing for collect=9.0e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.8e-05,1.3e-02,0.0e+00,5.5e-06,9.0e-05 -----
decimation summary: 32->10 dwt=+2.861e-05 SvN=9.576e-01
 qbond: qkept nsym=6 dimAll=10
 (4,2):3 (3,1):2 (2,2):2 (4,0):1 (5,1):1 (3,3):1
----- TIMING for decimation_row(nkr): 1.332e-02 S T(decim/select/formRot)=1.293e-02,2.884e-04,9.629e-05 -----
----- TIMING FOR twodot_decimation: 1.442e-02 S T(wf/decim)=9.564e-04,1.346e-02 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=815:6.218e-03MB:6.072e-06GB
        per(mem): H:2.45 C:7.73 S:43.8 A:9.94 B:36.1 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.129e-03 change=1.187e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=42 : 3.556e-03 S -----
rank=0 GPUmem(GB): used=3.214e-05 (oper)=1.729e-05
rank=0 GPUmem(GB): used=3.245e-05 (oper,site)=1.729e-05,3.055e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=42
 no. of rintermediate operators=141
 no. of coefficients=372:2.838e-03MB:2.772e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.462e-03 S -----
rank=0 GPUmem(GB): used=3.522e-05 (oper,site,rinter)=1.729e-05,3.055e-07,2.772e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.999e-02 S size(rtasks)=42 size(Rlst2)=36 T(Rmu/Rlist)=1.232e-03,2.876e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.044e-02 S size(rtasks)=42 size(Rlst)=2315 -----
rank=0 GPUmem(GB): used=3.522e-05 avail=6.174e+00 total=6.174e+00 batch[need]=4.829e-04 blksize=9 blksize0=9 batchsize=2315
rank=0 GPUmem(GB): used=5.182e-04 (oper,site,rinter,batch)=1.729e-05,3.055e-07,2.772e-06,4.829e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.532e-03,2.247e-02,1.003e-02
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=19 t=6.5e-03 per=1.7e+01 cost=2.3e+04 flops=3.6e+06
 renorm[gemm] counter=19 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=7.5e-03 per=1.9e+01 cost=1.2e+04 flops=1.6e+06
 renorm[gemm] counter=19 i=3 t=7.5e-03 per=1.9e+01 cost=1.0e+04 flops=1.4e+06
 renorm[gemm] counter=19 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=7.5e-03 per=1.9e+01 cost=2.6e+04 flops=3.5e+06
 renorm[gemm] counter=19 total t=2.2e-02 per=5.8e+01 cost=4.8e+04 flops=2.2e+06
 renorm[red] counter=19 t=1.0e-02 per=2.6e+01 cost=1.5e+04 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.3e-01 t_reduction=1.9e-01 tot=7.3e-01 -----
 renorm_tot[inter] counter=19 t=1.1e-01 per=1.5e+01 cost=1.5e+06 flops=1.4e+07
 renorm_tot[gemm] counter=19 i=0 t=2.9e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=1.5e-02 per=2.0e+00 cost=1.3e+04 flops=8.8e+05
 renorm_tot[gemm] counter=19 i=3 t=1.5e-02 per=2.1e+00 cost=1.2e+04 flops=7.8e+05
 renorm_tot[gemm] counter=19 i=4 t=1.3e-01 per=1.7e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=19 i=5 t=1.3e-01 per=1.8e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=19 i=6 t=1.4e-01 per=2.0e+01 cost=9.9e+05 flops=6.9e+06
 renorm_tot[gemm] counter=19 total t=4.3e-01 per=5.9e+01 cost=1.8e+06 flops=4.1e+06
 renorm_tot[red] counter=19 t=1.9e-01 per=2.6e+01 cost=4.5e+05 flops=2.3e+06
qops.to_cpu: size(tot)=815:6.2e-03MB:6.1e-06GB T(to_cpu)=6.6e-05S speed=9.2e-02GB/S
check ||H-H.dagger||=1.907e-15 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.0975 S rank=0 -----
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=1.862e-03 change=6.461e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.365e-03 change=-1.622e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.365e-03 change=-3.770e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.728e-01 S #####
 T(local opt: fetch) = 1.229e-02 S  per = 1.59  per(accum) = 1.59
 T(local opt: hdiag) = 1.272e-01 S  per = 16.5  per(accum) = 18.1
 T(local opt: dvdsn) = 5.165e-01 S  per = 66.8  per(accum) = 84.9
 T(local opt: decim) = 1.444e-02 S  per = 1.87  per(accum) = 86.7
 T(local opt: guess) = 1.673e-03 S  per = 0.216  per(accum) = 87
 T(local opt: renrm) = 1.005e-01 S  per =   13  per(accum) = 100
 T(local opt: save ) = 2.399e-04 S  per = 0.031  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.165e-01 S  T(sum) = 5.137e-01 S  per = 9.946e+01
 T(local opt: preprocess                  ) = 6.529e-03 S  per = 1.27  per(accum) = 1.27
 T(local opt: symbolic_formulae           ) = 2.444e-03 S  per = 0.476  per(accum) = 1.75
 T(local opt: hintermediate init          ) = 1.158e-04 S  per = 0.0225  per(accum) = 1.77
 T(local opt: preprocess_hformulae_Hxlist ) = 1.357e-01 S  per = 26.4  per(accum) = 28.2
 T(local opt: hmmtasks init               ) = 5.023e-02 S  per = 9.78  per(accum) = 38
 T(local opt: initial guess for dvdson    ) = 1.825e-03 S  per = 0.355  per(accum) = 38.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.589e-01 S  per = 50.4  per(accum) = 88.7
 T(local opt: dvdson [cpu-gpu]            ) = 6.145e-03 S  per =  1.2  per(accum) = 89.9
 T(local opt: dvdson [nccl]               ) = 7.024e-05 S  per = 0.0137  per(accum) = 89.9
 T(local opt: dvdson [mpi]                ) = 9.680e-07 S  per = 0.000188  per(accum) = 89.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.175e-02 S  per = 10.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.005e-01 S  T(sum) = 1.005e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.803e-04 S  per = 0.478  per(accum) = 0.478
 T(local opt: qops init                    ) = 3.216e-03 S  per =  3.2  per(accum) = 3.68
 T(local opt: symbolic_formulae_renorm     ) = 3.570e-03 S  per = 3.55  per(accum) = 7.23
 T(local opt: allocate qops on gpu         ) = 5.987e-05 S  per = 0.0596  per(accum) = 7.29
 T(local opt: site memcpy cpu2gpu          ) = 1.231e-03 S  per = 1.23  per(accum) = 8.51
 T(local opt: rintermediate init           ) = 2.473e-03 S  per = 2.46  per(accum) = 11
 T(local opt: preprocess_formulae_Rlist2   ) = 3.052e-02 S  per = 30.4  per(accum) = 41.3
 T(local opt: rmmtasks init                ) = 1.710e-02 S  per =   17  per(accum) = 58.4
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 3.18e-05  per(accum) = 58.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.914e-02 S  per = 38.9  per(accum) = 97.3
 T(local opt: deallocate cpu and gpu memory) = 9.677e-05 S  per = 0.0963  per(accum) = 97.4
 T(local opt: construct opS [ifdists=true] ) = 4.100e-08 S  per = 4.08e-05  per(accum) = 97.4
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 3.88e-05  per(accum) = 97.4
 T(local opt: qops memcpy gpu2cpu          ) = 7.348e-05 S  per = 0.0731  per(accum) = 97.5
 T(local opt: reduction of opS & opH [mpi] ) = 6.775e-05 S  per = 0.0674  per(accum) = 97.5
 T(local opt: qops_pool join and erase     ) = 2.471e-03 S  per = 2.46  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 5.925e-06 S  per = 0.0059  per(accum) = 100
##### sweep opt: 2.298e+01 S #####
 T(sweep opt: fetch) = 2.812e-01 S  per = 1.22  per(accum) = 1.22
 T(sweep opt: hdiag) = 8.702e+00 S  per = 37.9  per(accum) = 39.1
 T(sweep opt: dvdsn) = 1.185e+01 S  per = 51.6  per(accum) = 90.7
 T(sweep opt: decim) = 2.648e-01 S  per = 1.15  per(accum) = 91.8
 T(sweep opt: guess) = 2.224e-02 S  per = 0.0968  per(accum) = 91.9
 T(sweep opt: renrm) = 1.846e+00 S  per = 8.03  per(accum) = 100
 T(sweep opt: save ) = 6.304e-03 S  per = 0.0274  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.185e+01 S  T(sum) = 1.183e+01 S  per = 9.981e+01
 T(sweep opt: preprocess                  ) = 9.233e-02 S  per = 0.78  per(accum) = 0.78
 T(sweep opt: symbolic_formulae           ) = 1.280e-01 S  per = 1.08  per(accum) = 1.86
 T(sweep opt: hintermediate init          ) = 4.903e-03 S  per = 0.0414  per(accum) = 1.9
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.650e+00 S  per = 30.8  per(accum) = 32.8
 T(sweep opt: hmmtasks init               ) = 1.405e+00 S  per = 11.9  per(accum) = 44.6
 T(sweep opt: initial guess for dvdson    ) = 2.378e-02 S  per = 0.201  per(accum) = 44.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.181e+00 S  per = 43.8  per(accum) = 88.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.539e-01 S  per =  1.3  per(accum) = 89.9
 T(sweep opt: dvdson [nccl]               ) = 8.128e-04 S  per = 0.00687  per(accum) = 89.9
 T(sweep opt: dvdson [mpi]                ) = 1.816e-05 S  per = 0.000154  per(accum) = 89.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.193e+00 S  per = 10.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.846e+00 S  T(sum) = 1.846e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.584e-03 S  per = 0.302  per(accum) = 0.302
 T(sweep opt: qops init                    ) = 6.424e-02 S  per = 3.48  per(accum) = 3.78
 T(sweep opt: symbolic_formulae_renorm     ) = 7.471e-02 S  per = 4.05  per(accum) = 7.83
 T(sweep opt: allocate qops on gpu         ) = 3.133e-03 S  per = 0.17  per(accum) = 8
 T(sweep opt: site memcpy cpu2gpu          ) = 2.498e-02 S  per = 1.35  per(accum) = 9.35
 T(sweep opt: rintermediate init           ) = 4.540e-02 S  per = 2.46  per(accum) = 11.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.347e-01 S  per =   29  per(accum) = 40.8
 T(sweep opt: rmmtasks init                ) = 2.718e-01 S  per = 14.7  per(accum) = 55.5
 T(sweep opt: qops memset on cpu           ) = 7.670e-07 S  per = 4.15e-05  per(accum) = 55.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.276e-01 S  per = 39.4  per(accum) = 94.9
 T(sweep opt: deallocate cpu and gpu memory) = 2.344e-03 S  per = 0.127  per(accum) = 95
 T(sweep opt: construct opS [ifdists=true] ) = 1.020e-06 S  per = 5.53e-05  per(accum) = 95
 T(sweep opt: reduction of opS & opH [nccl]) = 7.700e-07 S  per = 4.17e-05  per(accum) = 95
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.184e-03 S  per = 0.118  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 9.701e-04 S  per = 0.0526  per(accum) = 95.2
 T(sweep opt: qops_pool join and erase     ) = 5.585e-02 S  per = 3.03  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 3.244e-02 S  per = 1.76  per(accum) = 100
##### global opt: 2.298e+01 S #####
 T(global opt: fetch) = 2.812e-01 S  per = 1.22  per(accum) = 1.22
 T(global opt: hdiag) = 8.702e+00 S  per = 37.9  per(accum) = 39.1
 T(global opt: dvdsn) = 1.185e+01 S  per = 51.6  per(accum) = 90.7
 T(global opt: decim) = 2.648e-01 S  per = 1.15  per(accum) = 91.8
 T(global opt: guess) = 2.224e-02 S  per = 0.0968  per(accum) = 91.9
 T(global opt: renrm) = 1.846e+00 S  per = 8.03  per(accum) = 100
 T(global opt: save ) = 6.304e-03 S  per = 0.0274  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.185e+01 S  T(sum) = 1.183e+01 S  per = 9.981e+01
 T(global opt: preprocess                  ) = 9.233e-02 S  per = 0.78  per(accum) = 0.78
 T(global opt: symbolic_formulae           ) = 1.280e-01 S  per = 1.08  per(accum) = 1.86
 T(global opt: hintermediate init          ) = 4.903e-03 S  per = 0.0414  per(accum) = 1.9
 T(global opt: preprocess_hformulae_Hxlist ) = 3.650e+00 S  per = 30.8  per(accum) = 32.8
 T(global opt: hmmtasks init               ) = 1.405e+00 S  per = 11.9  per(accum) = 44.6
 T(global opt: initial guess for dvdson    ) = 2.378e-02 S  per = 0.201  per(accum) = 44.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.181e+00 S  per = 43.8  per(accum) = 88.6
 T(global opt: dvdson [cpu-gpu]            ) = 1.539e-01 S  per =  1.3  per(accum) = 89.9
 T(global opt: dvdson [nccl]               ) = 8.128e-04 S  per = 0.00687  per(accum) = 89.9
 T(global opt: dvdson [mpi]                ) = 1.816e-05 S  per = 0.000154  per(accum) = 89.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.193e+00 S  per = 10.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.846e+00 S  T(sum) = 1.846e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.584e-03 S  per = 0.302  per(accum) = 0.302
 T(global opt: qops init                    ) = 6.424e-02 S  per = 3.48  per(accum) = 3.78
 T(global opt: symbolic_formulae_renorm     ) = 7.471e-02 S  per = 4.05  per(accum) = 7.83
 T(global opt: allocate qops on gpu         ) = 3.133e-03 S  per = 0.17  per(accum) = 8
 T(global opt: site memcpy cpu2gpu          ) = 2.498e-02 S  per = 1.35  per(accum) = 9.35
 T(global opt: rintermediate init           ) = 4.540e-02 S  per = 2.46  per(accum) = 11.8
 T(global opt: preprocess_formulae_Rlist2   ) = 5.347e-01 S  per =   29  per(accum) = 40.8
 T(global opt: rmmtasks init                ) = 2.718e-01 S  per = 14.7  per(accum) = 55.5
 T(global opt: qops memset on cpu           ) = 7.670e-07 S  per = 4.15e-05  per(accum) = 55.5
 T(global opt: preprocess_renorm_batchGPU   ) = 7.276e-01 S  per = 39.4  per(accum) = 94.9
 T(global opt: deallocate cpu and gpu memory) = 2.344e-03 S  per = 0.127  per(accum) = 95
 T(global opt: construct opS [ifdists=true] ) = 1.020e-06 S  per = 5.53e-05  per(accum) = 95
 T(global opt: reduction of opS & opH [nccl]) = 7.700e-07 S  per = 4.17e-05  per(accum) = 95
 T(global opt: qops memcpy gpu2cpu          ) = 2.184e-03 S  per = 0.118  per(accum) = 95.2
 T(global opt: reduction of opS & opH [mpi] ) = 9.701e-04 S  per = 0.0526  per(accum) = 95.2
 T(global opt: qops_pool join and erase     ) = 5.585e-02 S  per = 3.03  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 3.244e-02 S  per = 1.76  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.131e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=19/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=735:5.608e-03MB:5.476e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=47:3.586e-04MB:3.502e-07GB
total mem of comb=783:5.974e-03MB:5.834e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1425:1.087e-02MB:1.062e-05GB
        per(mem): H:1.4 C:23.2 S:7.72 P:10.9 Q:56.8 
 rqops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=10,10 size(op)=29:0.000221MB size(tot)=815:0.00622MB:6.07e-06GB
        per(mem): H:2.45 C:7.73 S:43.8 A:9.94 B:36.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4236:0.0323MB:3.16e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.011e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.103e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=115:8.774e-04MB
qtensor4: wf4 own=1 _data=0x3a67d400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
 qbond: qcol nsym=6 dimAll=10
 (4,2):3 (3,1):2 (2,2):2 (4,0):1 (5,1):1 (3,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=40 nblocks=552 size=115:8.774e-04MB
### DIAG TIMING: total=2.171e-01 t1=3.608e-05, t2=1.056e-03, t3=2.539e-03, t4=2.135e-01, t5=3.856e-06, t6=1.451e-05, t7=4.149e-06
duration_diagGPU:2.171e-01
duration_diagreduce:7.400e-08
duration_diagtransform:8.120e-07
----- TIMING FOR symbolic_formulae_twodot with size=273 : 4.048e-03 S -----
rank=0 GPUmem(GB): used=3.156e-05 (oper)=3.156e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=273
 no. of hintermediate operators=118
 no. of coefficients=1632:1.245e-02MB:1.216e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.449e-04 S -----
rank=0 GPUmem(GB): used=4.372e-05 (oper,hinter)=3.156e-05,1.216e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.591e-01 S size(H_formulae)=273 size(Hxlst2)=40 T(Hmu/Hxlist)=7.048e-04,2.584e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.619e-01 S size(H_formulae)=273 size(Hxlst)=15730 -----
rank=0 GPUmem(GB): used=4.372e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.714e-06 batch[need]=3.282e-03 blksize=9 blksize0=9 batchsize=15730
rank=0 GPUmem(GB): used=3.327e-03 (oper,hinter,dvdson,batch)=3.156e-05,1.216e-05,1.714e-06,3.282e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=115 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.580e-03,1.037e-02,3.034e-02,1.113e-02,5.346e-02
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=1.564e-03 speed=1.096e-03GB/S T(nccl)=1.537e-05 speed=1.115e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.2e-02 -----
 sigma[inter] counter=115 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=4.8e+07
 sigma[gemm] counter=115 i=0 t=2.7e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=2.4e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=2.4e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=3 t=2.2e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=4 t=7.6e-03 per=1.5e+01 cost=7.7e+04 flops=1.0e+07
 sigma[gemm] counter=115 i=5 t=7.6e-03 per=1.5e+01 cost=7.6e+04 flops=1.0e+07
 sigma[gemm] counter=115 i=6 t=7.6e-03 per=1.5e+01 cost=7.1e+04 flops=9.3e+06
 sigma[gemm] counter=115 i=7 t=7.6e-03 per=1.5e+01 cost=7.0e+04 flops=9.3e+06
 sigma[gemm] counter=115 total t=3.0e-02 per=5.9e+01 cost=2.9e+05 flops=9.7e+06
 sigma[red] counter=115 t=1.1e-02 per=2.1e+01 cost=9.9e+04 flops=8.9e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=2.9e+00 t_reduction=1.3e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=115 t=1.0e+00 per=2.0e+01 cost=7.9e+07 flops=7.6e+07
 sigma_tot[gemm] counter=115 i=0 t=2.3e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=2.0e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=1.7e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=3 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=4 t=7.4e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=115 i=5 t=7.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=115 i=6 t=7.0e-01 per=1.3e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=115 i=7 t=6.9e-01 per=1.3e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=115 total t=2.9e+00 per=5.5e+01 cost=6.0e+07 flops=2.1e+07
 sigma_tot[red] counter=115 t=1.3e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,7.7e-06,3.5e-06,1.4e-06,3.6e-07
settings: ndim=115 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316747067343 -1.116e+03  1.828e-02    1     1  5.370e-02 5.370e-02 5.365e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.546e-03,1.229e-02,2.995e-02,1.077e-02,5.457e-02
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=1.527e-03 speed=1.122e-03GB/S T(nccl)=1.942e-05 speed=8.823e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.3e-02 -----
 sigma[inter] counter=116 t=1.2e-02 per=2.3e+01 cost=5.0e+05 flops=4.1e+07
 sigma[gemm] counter=116 i=0 t=5.5e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=3.2e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=3.2e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=3 t=3.0e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=4 t=7.4e-03 per=1.4e+01 cost=7.7e+04 flops=1.0e+07
 sigma[gemm] counter=116 i=5 t=7.6e-03 per=1.4e+01 cost=7.6e+04 flops=1.0e+07
 sigma[gemm] counter=116 i=6 t=7.5e-03 per=1.4e+01 cost=7.1e+04 flops=9.4e+06
 sigma[gemm] counter=116 i=7 t=7.5e-03 per=1.4e+01 cost=7.0e+04 flops=9.3e+06
 sigma[gemm] counter=116 total t=3.0e-02 per=5.7e+01 cost=2.9e+05 flops=9.8e+06
 sigma[red] counter=116 t=1.1e-02 per=2.0e+01 cost=9.9e+04 flops=9.2e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=2.9e+00 t_reduction=1.3e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=116 t=1.1e+00 per=2.0e+01 cost=7.9e+07 flops=7.6e+07
 sigma_tot[gemm] counter=116 i=0 t=2.4e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=3 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=4 t=7.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=116 i=5 t=7.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=116 i=6 t=7.1e-01 per=1.3e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=116 i=7 t=7.0e-01 per=1.3e+01 cost=1.5e+07 flops=2.2e+07
 sigma_tot[gemm] counter=116 total t=2.9e+00 per=5.5e+01 cost=6.0e+07 flops=2.1e+07
 sigma_tot[red] counter=116 t=1.3e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=1.1e-04 T(gemm/eig/ortho/gemm/axpy)=3.2e-05,6.4e-05,1.4e-05,2.4e-06,3.9e-07
    2   0 -    -116.317173934304 -4.269e-04  3.616e-03    2     2  1.216e-01 6.079e-02 5.422e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.758e-04,1.005e-02,2.986e-02,1.078e-02,5.168e-02
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=9.707e-04 speed=1.765e-03GB/S T(nccl)=5.126e-06 speed=3.343e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=117 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=5.0e+07
 sigma[gemm] counter=117 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=1.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=3 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=4 t=7.5e-03 per=1.5e+01 cost=7.7e+04 flops=1.0e+07
 sigma[gemm] counter=117 i=5 t=7.5e-03 per=1.5e+01 cost=7.6e+04 flops=1.0e+07
 sigma[gemm] counter=117 i=6 t=7.4e-03 per=1.5e+01 cost=7.1e+04 flops=9.5e+06
 sigma[gemm] counter=117 i=7 t=7.4e-03 per=1.5e+01 cost=7.0e+04 flops=9.4e+06
 sigma[gemm] counter=117 total t=3.0e-02 per=5.9e+01 cost=2.9e+05 flops=9.8e+06
 sigma[red] counter=117 t=1.1e-02 per=2.1e+01 cost=9.9e+04 flops=9.2e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=2.9e+00 t_reduction=1.3e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=117 t=1.1e+00 per=2.0e+01 cost=8.0e+07 flops=7.5e+07
 sigma_tot[gemm] counter=117 i=0 t=2.4e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=3 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=4 t=7.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=117 i=5 t=7.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=117 i=6 t=7.1e-01 per=1.3e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=117 i=7 t=7.1e-01 per=1.3e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=117 total t=2.9e+00 per=5.5e+01 cost=6.0e+07 flops=2.0e+07
 sigma_tot[red] counter=117 t=1.3e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,3.7e-05,3.1e-06,1.6e-06,2.1e-07
    3   0 -    -116.317223655373 -4.972e-05  1.683e-03    3     3  1.892e-01 6.306e-02 5.342e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.250e-04,9.943e-03,3.022e-02,1.068e-02,5.178e-02
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=9.202e-04 speed=1.862e-03GB/S T(nccl)=4.792e-06 speed=3.576e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=118 t=9.9e-03 per=2.0e+01 cost=5.0e+05 flops=5.1e+07
 sigma[gemm] counter=118 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=3 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=4 t=7.5e-03 per=1.5e+01 cost=7.7e+04 flops=1.0e+07
 sigma[gemm] counter=118 i=5 t=7.6e-03 per=1.5e+01 cost=7.6e+04 flops=1.0e+07
 sigma[gemm] counter=118 i=6 t=7.6e-03 per=1.5e+01 cost=7.1e+04 flops=9.4e+06
 sigma[gemm] counter=118 i=7 t=7.5e-03 per=1.5e+01 cost=7.0e+04 flops=9.3e+06
 sigma[gemm] counter=118 total t=3.0e-02 per=5.9e+01 cost=2.9e+05 flops=9.7e+06
 sigma[red] counter=118 t=1.1e-02 per=2.1e+01 cost=9.9e+04 flops=9.3e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.0e+00 t_reduction=1.3e+00 tot=5.4e+00 -----
 sigma_tot[inter] counter=118 t=1.1e+00 per=2.0e+01 cost=8.0e+07 flops=7.5e+07
 sigma_tot[gemm] counter=118 i=0 t=2.4e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=3 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=4 t=7.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=118 i=5 t=7.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=118 i=6 t=7.2e-01 per=1.3e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=118 i=7 t=7.2e-01 per=1.3e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=118 total t=3.0e+00 per=5.5e+01 cost=6.1e+07 flops=2.0e+07
 sigma_tot[red] counter=118 t=1.3e+00 per=2.5e+01 cost=1.4e+07 flops=1.1e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.4e-05,2.8e-06,1.2e-06,2.1e-07
    4   0 -    -116.317230451088 -6.796e-06  6.074e-04    3     4  2.529e-01 6.324e-02 5.303e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.005e-03,9.885e-03,2.998e-02,1.100e-02,5.288e-02
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=2.000e-03 speed=8.568e-04GB/S T(nccl)=4.611e-06 speed=3.716e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=119 t=9.9e-03 per=1.9e+01 cost=5.0e+05 flops=5.1e+07
 sigma[gemm] counter=119 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=4 t=7.5e-03 per=1.5e+01 cost=7.7e+04 flops=1.0e+07
 sigma[gemm] counter=119 i=5 t=7.5e-03 per=1.5e+01 cost=7.6e+04 flops=1.0e+07
 sigma[gemm] counter=119 i=6 t=7.5e-03 per=1.5e+01 cost=7.1e+04 flops=9.4e+06
 sigma[gemm] counter=119 i=7 t=7.5e-03 per=1.5e+01 cost=7.0e+04 flops=9.3e+06
 sigma[gemm] counter=119 total t=3.0e-02 per=5.9e+01 cost=2.9e+05 flops=9.8e+06
 sigma[red] counter=119 t=1.1e-02 per=2.2e+01 cost=9.9e+04 flops=9.0e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.0e+00 t_reduction=1.3e+00 tot=5.4e+00 -----
 sigma_tot[inter] counter=119 t=1.1e+00 per=2.0e+01 cost=8.1e+07 flops=7.5e+07
 sigma_tot[gemm] counter=119 i=0 t=2.4e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=3 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=4 t=7.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=119 i=5 t=7.8e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=119 i=6 t=7.3e-01 per=1.3e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=119 i=7 t=7.2e-01 per=1.3e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=119 total t=3.0e+00 per=5.5e+01 cost=6.1e+07 flops=2.0e+07
 sigma_tot[red] counter=119 t=1.3e+00 per=2.5e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,2.8e-06,1.2e-06,1.9e-07
    5   0 -    -116.317231340389 -8.893e-07  2.148e-04    3     5  3.167e-01 6.334e-02 5.302e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.020e-03,1.015e-02,2.987e-02,1.098e-02,5.202e-02
 analyze_tgpu[Hx]: ndim=115:8.568e-07GB T(cpu-gpu)=1.015e-03 speed=1.689e-03GB/S T(nccl)=4.828e-06 speed=3.549e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=120 t=1.0e-02 per=2.0e+01 cost=5.0e+05 flops=5.0e+07
 sigma[gemm] counter=120 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=3 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=4 t=7.5e-03 per=1.5e+01 cost=7.7e+04 flops=1.0e+07
 sigma[gemm] counter=120 i=5 t=7.5e-03 per=1.5e+01 cost=7.6e+04 flops=1.0e+07
 sigma[gemm] counter=120 i=6 t=7.5e-03 per=1.5e+01 cost=7.1e+04 flops=9.5e+06
 sigma[gemm] counter=120 i=7 t=7.5e-03 per=1.5e+01 cost=7.0e+04 flops=9.4e+06
 sigma[gemm] counter=120 total t=3.0e-02 per=5.9e+01 cost=2.9e+05 flops=9.8e+06
 sigma[red] counter=120 t=1.1e-02 per=2.2e+01 cost=9.9e+04 flops=9.1e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.0e+00 t_reduction=1.3e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=120 t=1.1e+00 per=2.0e+01 cost=8.1e+07 flops=7.5e+07
 sigma_tot[gemm] counter=120 i=0 t=2.4e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=2.1e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=1.8e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=3 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=4 t=7.8e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=120 i=5 t=7.9e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=120 i=6 t=7.4e-01 per=1.3e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=120 i=7 t=7.3e-01 per=1.3e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=120 total t=3.0e+00 per=5.6e+01 cost=6.1e+07 flops=2.0e+07
 sigma_tot[red] counter=120 t=1.3e+00 per=2.5e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.5e-05,2.9e-06,1.4e-06,2.0e-07
    6   0 +    -116.317231466819 -1.264e-07  8.444e-05    3     6  3.807e-01 6.344e-02 5.287e-02
TIMING FOR Davidson : 3.807e-01  T(cal/comm/rest)=3.172e-01,1.180e-06,6.342e-02
decomposed t_rest=6.342e-02
 T(sub)    =2.467e-04 per=3.889e-01
 T(precond)=6.294e-02 per=9.925e+01
 T(ortho)  =2.147e-05 per=3.386e-02
 T(xcopy)  =2.653e-06 per=4.183e-03
 T(xnrm2)  =3.937e-06 per=6.208e-03
 T(other)  =2.036e-04 per=3.210e-01
optimized energies: isweep=0 ibond=19 dots=2 e[0]=-116.317231466819 nmvp=6
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=5.745e-03 change=4.019e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=11 dimAll=39
 (4,2):8 (3,1):4 (2,2):2 (4,0):3 (5,1):7 (3,3):3 (6,2):4 (6,0):2 (7,1):1 (5,3):4 (4,4):1
timing for divide=1.1e-04
timing for compute=1.2e-02
timing for collect=3.0e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-04,1.2e-02,0.0e+00,5.5e-06,3.0e-05 -----
decimation summary: 39->10 dwt=+3.341e-04 SvN=7.724e-01
 qbond: qkept nsym=6 dimAll=10
 (5,3):3 (4,2):2 (6,2):2 (5,1):1 (7,1):1 (4,4):1
----- TIMING for decimation_row(nkr): 1.302e-02 S T(decim/select/formRot)=1.261e-02,3.007e-04,1.138e-04 -----
----- TIMING FOR twodot_decimation: 1.424e-02 S T(wf/decim)=1.087e-03,1.315e-02 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1050:8.011e-03MB:7.823e-06GB
        per(mem): H:1.9 C:8 S:32 A:10.5 B:47.6 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=5.722e-03 change=1.572e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.005e-03 S -----
rank=0 GPUmem(GB): used=4.093e-05 (oper)=2.133e-05
rank=0 GPUmem(GB): used=4.126e-05 (oper,site)=2.133e-05,3.353e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=149
 no. of coefficients=702:5.356e-03MB:5.230e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.518e-03 S -----
rank=0 GPUmem(GB): used=4.649e-05 (oper,site,rinter)=2.133e-05,3.353e-07,5.230e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.213e-02 S size(rtasks)=57 size(Rlst2)=36 T(Rmu/Rlist)=7.633e-04,3.137e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.240e-02 S size(rtasks)=57 size(Rlst)=2376 -----
rank=0 GPUmem(GB): used=4.649e-05 avail=6.174e+00 total=6.174e+00 batch[need]=4.957e-04 blksize=9 blksize0=9 batchsize=2376
rank=0 GPUmem(GB): used=5.422e-04 (oper,site,rinter,batch)=2.133e-05,3.353e-07,5.230e-06,4.957e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.511e-03,2.291e-02,1.011e-02
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=20 t=5.5e-03 per=1.4e+01 cost=5.5e+04 flops=1.0e+07
 renorm[gemm] counter=20 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=2 t=7.6e-03 per=2.0e+01 cost=1.5e+04 flops=2.0e+06
 renorm[gemm] counter=20 i=3 t=7.6e-03 per=2.0e+01 cost=1.6e+04 flops=2.1e+06
 renorm[gemm] counter=20 i=4 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=6 t=7.7e-03 per=2.0e+01 cost=3.1e+04 flops=4.0e+06
 renorm[gemm] counter=20 total t=2.3e-02 per=5.9e+01 cost=6.2e+04 flops=2.7e+06
 renorm[red] counter=20 t=1.0e-02 per=2.6e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.5e-01 t_reduction=2.0e-01 tot=7.6e-01 -----
 renorm_tot[inter] counter=20 t=1.1e-01 per=1.5e+01 cost=1.5e+06 flops=1.4e+07
 renorm_tot[gemm] counter=20 i=0 t=3.0e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=1 t=2.6e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=2 t=2.2e-02 per=2.9e+00 cost=2.8e+04 flops=1.3e+06
 renorm_tot[gemm] counter=20 i=3 t=2.3e-02 per=2.9e+00 cost=2.7e+04 flops=1.2e+06
 renorm_tot[gemm] counter=20 i=4 t=1.3e-01 per=1.7e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=20 i=5 t=1.3e-01 per=1.7e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=20 i=6 t=1.5e-01 per=2.0e+01 cost=1.0e+06 flops=6.8e+06
 renorm_tot[gemm] counter=20 total t=4.5e-01 per=5.9e+01 cost=1.8e+06 flops=4.0e+06
 renorm_tot[red] counter=20 t=2.0e-01 per=2.6e+01 cost=4.6e+05 flops=2.3e+06
qops.to_cpu: size(tot)=1050:8.0e-03MB:7.8e-06GB T(to_cpu)=7.2e-05S speed=1.1e-01GB/S
check ||H-H.dagger||=3.330e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0954 S rank=0 -----
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=4.829e-03 change=6.850e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=7.149e-03 change=-1.761e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=7.149e-03 change=-4.545e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.186e+00 S #####
 T(local opt: fetch) = 1.280e-02 S  per = 1.08  per(accum) = 1.08
 T(local opt: hdiag) = 2.183e-01 S  per = 18.4  per(accum) = 19.5
 T(local opt: dvdsn) = 8.396e-01 S  per = 70.8  per(accum) = 90.3
 T(local opt: decim) = 1.426e-02 S  per =  1.2  per(accum) = 91.5
 T(local opt: guess) = 1.709e-03 S  per = 0.144  per(accum) = 91.6
 T(local opt: renrm) = 9.902e-02 S  per = 8.35  per(accum) = 100
 T(local opt: save ) = 2.963e-04 S  per = 0.025  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.396e-01 S  T(sum) = 8.379e-01 S  per = 9.980e+01
 T(local opt: preprocess                  ) = 8.672e-03 S  per = 1.03  per(accum) = 1.03
 T(local opt: symbolic_formulae           ) = 4.062e-03 S  per = 0.485  per(accum) = 1.52
 T(local opt: hintermediate init          ) = 1.598e-04 S  per = 0.0191  per(accum) = 1.54
 T(local opt: preprocess_hformulae_Hxlist ) = 2.625e-01 S  per = 31.3  per(accum) = 32.9
 T(local opt: hmmtasks init               ) = 1.773e-01 S  per = 21.2  per(accum) = 54
 T(local opt: initial guess for dvdson    ) = 4.550e-03 S  per = 0.543  per(accum) = 54.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.092e-01 S  per = 36.9  per(accum) = 91.5
 T(local opt: dvdson [cpu-gpu]            ) = 7.997e-03 S  per = 0.954  per(accum) = 92.4
 T(local opt: dvdson [nccl]               ) = 5.415e-05 S  per = 0.00646  per(accum) = 92.4
 T(local opt: dvdson [mpi]                ) = 1.180e-06 S  per = 0.000141  per(accum) = 92.4
 T(local opt: dvdson [rest part(linalg)]  ) = 6.342e-02 S  per = 7.57  per(accum) = 100
Detailed decomposition of T(renrm) = 9.902e-02 S  T(sum) = 9.902e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.237e-04 S  per = 0.428  per(accum) = 0.428
 T(local opt: qops init                    ) = 2.877e-03 S  per = 2.91  per(accum) = 3.33
 T(local opt: symbolic_formulae_renorm     ) = 2.016e-03 S  per = 2.04  per(accum) = 5.37
 T(local opt: allocate qops on gpu         ) = 5.918e-05 S  per = 0.0598  per(accum) = 5.43
 T(local opt: site memcpy cpu2gpu          ) = 3.199e-04 S  per = 0.323  per(accum) = 5.75
 T(local opt: rintermediate init           ) = 2.528e-03 S  per = 2.55  per(accum) = 8.31
 T(local opt: preprocess_formulae_Rlist2   ) = 3.249e-02 S  per = 32.8  per(accum) = 41.1
 T(local opt: rmmtasks init                ) = 1.618e-02 S  per = 16.3  per(accum) = 57.5
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 4.34e-05  per(accum) = 57.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.862e-02 S  per =   39  per(accum) = 96.5
 T(local opt: deallocate cpu and gpu memory) = 1.309e-04 S  per = 0.132  per(accum) = 96.6
 T(local opt: construct opS [ifdists=true] ) = 3.900e-08 S  per = 3.94e-05  per(accum) = 96.6
 T(local opt: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 4.34e-05  per(accum) = 96.6
 T(local opt: qops memcpy gpu2cpu          ) = 7.987e-05 S  per = 0.0807  per(accum) = 96.7
 T(local opt: reduction of opS & opH [mpi] ) = 7.278e-05 S  per = 0.0735  per(accum) = 96.7
 T(local opt: qops_pool join and erase     ) = 3.219e-03 S  per = 3.25  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.881e-06 S  per = 0.00796  per(accum) = 100
##### sweep opt: 2.416e+01 S #####
 T(sweep opt: fetch) = 2.940e-01 S  per = 1.22  per(accum) = 1.22
 T(sweep opt: hdiag) = 8.920e+00 S  per = 36.9  per(accum) = 38.1
 T(sweep opt: dvdsn) = 1.269e+01 S  per = 52.5  per(accum) = 90.7
 T(sweep opt: decim) = 2.791e-01 S  per = 1.16  per(accum) = 91.8
 T(sweep opt: guess) = 2.395e-02 S  per = 0.0991  per(accum) = 91.9
 T(sweep opt: renrm) = 1.945e+00 S  per = 8.05  per(accum) = 100
 T(sweep opt: save ) = 6.601e-03 S  per = 0.0273  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.269e+01 S  T(sum) = 1.267e+01 S  per = 9.981e+01
 T(sweep opt: preprocess                  ) = 1.010e-01 S  per = 0.797  per(accum) = 0.797
 T(sweep opt: symbolic_formulae           ) = 1.321e-01 S  per = 1.04  per(accum) = 1.84
 T(sweep opt: hintermediate init          ) = 5.063e-03 S  per = 0.04  per(accum) = 1.88
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.913e+00 S  per = 30.9  per(accum) = 32.8
 T(sweep opt: hmmtasks init               ) = 1.582e+00 S  per = 12.5  per(accum) = 45.2
 T(sweep opt: initial guess for dvdson    ) = 2.833e-02 S  per = 0.224  per(accum) = 45.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.490e+00 S  per = 43.3  per(accum) = 88.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.619e-01 S  per = 1.28  per(accum) = 90.1
 T(sweep opt: dvdson [nccl]               ) = 8.670e-04 S  per = 0.00684  per(accum) = 90.1
 T(sweep opt: dvdson [mpi]                ) = 1.934e-05 S  per = 0.000153  per(accum) = 90.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.256e+00 S  per = 9.91  per(accum) = 100
Detailed decomposition of T(renrm) = 1.945e+00 S  T(sum) = 1.945e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.008e-03 S  per = 0.309  per(accum) = 0.309
 T(sweep opt: qops init                    ) = 6.712e-02 S  per = 3.45  per(accum) = 3.76
 T(sweep opt: symbolic_formulae_renorm     ) = 7.672e-02 S  per = 3.94  per(accum) = 7.7
 T(sweep opt: allocate qops on gpu         ) = 3.192e-03 S  per = 0.164  per(accum) = 7.87
 T(sweep opt: site memcpy cpu2gpu          ) = 2.530e-02 S  per =  1.3  per(accum) = 9.17
 T(sweep opt: rintermediate init           ) = 4.793e-02 S  per = 2.46  per(accum) = 11.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.672e-01 S  per = 29.2  per(accum) = 40.8
 T(sweep opt: rmmtasks init                ) = 2.880e-01 S  per = 14.8  per(accum) = 55.6
 T(sweep opt: qops memset on cpu           ) = 8.100e-07 S  per = 4.16e-05  per(accum) = 55.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.662e-01 S  per = 39.4  per(accum) = 95
 T(sweep opt: deallocate cpu and gpu memory) = 2.475e-03 S  per = 0.127  per(accum) = 95.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.059e-06 S  per = 5.44e-05  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [nccl]) = 8.130e-07 S  per = 4.18e-05  per(accum) = 95.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.264e-03 S  per = 0.116  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.043e-03 S  per = 0.0536  per(accum) = 95.3
 T(sweep opt: qops_pool join and erase     ) = 5.906e-02 S  per = 3.04  per(accum) = 98.3
 T(sweep opt: conversion from opAB to opPQ ) = 3.245e-02 S  per = 1.67  per(accum) = 100
##### global opt: 2.416e+01 S #####
 T(global opt: fetch) = 2.940e-01 S  per = 1.22  per(accum) = 1.22
 T(global opt: hdiag) = 8.920e+00 S  per = 36.9  per(accum) = 38.1
 T(global opt: dvdsn) = 1.269e+01 S  per = 52.5  per(accum) = 90.7
 T(global opt: decim) = 2.791e-01 S  per = 1.16  per(accum) = 91.8
 T(global opt: guess) = 2.395e-02 S  per = 0.0991  per(accum) = 91.9
 T(global opt: renrm) = 1.945e+00 S  per = 8.05  per(accum) = 100
 T(global opt: save ) = 6.601e-03 S  per = 0.0273  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.269e+01 S  T(sum) = 1.267e+01 S  per = 9.981e+01
 T(global opt: preprocess                  ) = 1.010e-01 S  per = 0.797  per(accum) = 0.797
 T(global opt: symbolic_formulae           ) = 1.321e-01 S  per = 1.04  per(accum) = 1.84
 T(global opt: hintermediate init          ) = 5.063e-03 S  per = 0.04  per(accum) = 1.88
 T(global opt: preprocess_hformulae_Hxlist ) = 3.913e+00 S  per = 30.9  per(accum) = 32.8
 T(global opt: hmmtasks init               ) = 1.582e+00 S  per = 12.5  per(accum) = 45.2
 T(global opt: initial guess for dvdson    ) = 2.833e-02 S  per = 0.224  per(accum) = 45.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.490e+00 S  per = 43.3  per(accum) = 88.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.619e-01 S  per = 1.28  per(accum) = 90.1
 T(global opt: dvdson [nccl]               ) = 8.670e-04 S  per = 0.00684  per(accum) = 90.1
 T(global opt: dvdson [mpi]                ) = 1.934e-05 S  per = 0.000153  per(accum) = 90.1
 T(global opt: dvdson [rest part(linalg)]  ) = 1.256e+00 S  per = 9.91  per(accum) = 100
Detailed decomposition of T(renrm) = 1.945e+00 S  T(sum) = 1.945e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.008e-03 S  per = 0.309  per(accum) = 0.309
 T(global opt: qops init                    ) = 6.712e-02 S  per = 3.45  per(accum) = 3.76
 T(global opt: symbolic_formulae_renorm     ) = 7.672e-02 S  per = 3.94  per(accum) = 7.7
 T(global opt: allocate qops on gpu         ) = 3.192e-03 S  per = 0.164  per(accum) = 7.87
 T(global opt: site memcpy cpu2gpu          ) = 2.530e-02 S  per =  1.3  per(accum) = 9.17
 T(global opt: rintermediate init           ) = 4.793e-02 S  per = 2.46  per(accum) = 11.6
 T(global opt: preprocess_formulae_Rlist2   ) = 5.672e-01 S  per = 29.2  per(accum) = 40.8
 T(global opt: rmmtasks init                ) = 2.880e-01 S  per = 14.8  per(accum) = 55.6
 T(global opt: qops memset on cpu           ) = 8.100e-07 S  per = 4.16e-05  per(accum) = 55.6
 T(global opt: preprocess_renorm_batchGPU   ) = 7.662e-01 S  per = 39.4  per(accum) = 95
 T(global opt: deallocate cpu and gpu memory) = 2.475e-03 S  per = 0.127  per(accum) = 95.1
 T(global opt: construct opS [ifdists=true] ) = 1.059e-06 S  per = 5.44e-05  per(accum) = 95.1
 T(global opt: reduction of opS & opH [nccl]) = 8.130e-07 S  per = 4.18e-05  per(accum) = 95.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.264e-03 S  per = 0.116  per(accum) = 95.2
 T(global opt: reduction of opS & opH [mpi] ) = 1.043e-03 S  per = 0.0536  per(accum) = 95.3
 T(global opt: qops_pool join and erase     ) = 5.906e-02 S  per = 3.04  per(accum) = 98.3
 T(global opt: conversion from opAB to opPQ ) = 3.245e-02 S  per = 1.67  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.968e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=20/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=733:5.592e-03MB:5.461e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=52:3.967e-04MB:3.874e-07GB
total mem of comb=786:5.997e-03MB:5.856e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=1039:7.927e-03MB:7.741e-06GB
        per(mem): H:1.25 C:16.2 S:6.93 P:6.93 Q:68.7 
 rqops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=10,10 size(op)=30:0.000229MB size(tot)=1050:0.00801MB:7.82e-06GB
        per(mem): H:1.9 C:8 S:32 A:10.5 B:47.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4085:0.0312MB:3.04e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.485e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-8.166e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,10,3,3) nnz=97:7.401e-04MB
qtensor4: wf4 own=1 _data=0x3aaf0e00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
 qbond: qcol nsym=6 dimAll=10
 (5,3):3 (4,2):2 (6,2):2 (5,1):1 (7,1):1 (4,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=30 nblocks=384 size=97:7.401e-04MB
### DIAG TIMING: total=2.959e-01 t1=3.030e-05, t2=1.345e-03, t3=2.545e-03, t4=2.919e-01, t5=4.124e-06, t6=1.524e-05, t7=4.739e-06
duration_diagGPU:2.959e-01
duration_diagreduce:5.000e-08
duration_diagtransform:9.250e-07
----- TIMING FOR symbolic_formulae_twodot with size=371 : 5.096e-03 S -----
rank=0 GPUmem(GB): used=3.044e-05 (oper)=3.044e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=371
 no. of hintermediate operators=174
 no. of coefficients=2358:1.799e-02MB:1.757e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.905e-04 S -----
rank=0 GPUmem(GB): used=4.800e-05 (oper,hinter)=3.044e-05,1.757e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.312e-01 S size(H_formulae)=371 size(Hxlst2)=30 T(Hmu/Hxlist)=9.657e-04,2.302e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.336e-01 S size(H_formulae)=371 size(Hxlst)=14014 -----
rank=0 GPUmem(GB): used=4.800e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.445e-06 batch[need]=2.297e-03 blksize=6 blksize0=9 batchsize=14014
rank=0 GPUmem(GB): used=2.347e-03 (oper,hinter,dvdson,batch)=3.044e-05,1.757e-05,1.445e-06,2.297e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=97 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.979e-03,1.023e-02,3.024e-02,1.065e-02,5.312e-02
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=1.973e-03 speed=7.327e-04GB/S T(nccl)=5.841e-06 speed=2.475e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=121 t=1.0e-02 per=2.0e+01 cost=4.5e+05 flops=4.4e+07
 sigma[gemm] counter=121 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=4 t=7.6e-03 per=1.5e+01 cost=8.7e+04 flops=1.1e+07
 sigma[gemm] counter=121 i=5 t=7.7e-03 per=1.5e+01 cost=8.5e+04 flops=1.1e+07
 sigma[gemm] counter=121 i=6 t=7.5e-03 per=1.5e+01 cost=6.3e+04 flops=8.4e+06
 sigma[gemm] counter=121 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+04 flops=8.5e+06
 sigma[gemm] counter=121 total t=3.0e-02 per=5.9e+01 cost=3.0e+05 flops=9.9e+06
 sigma[red] counter=121 t=1.1e-02 per=2.1e+01 cost=9.5e+04 flops=8.9e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.1e+00 t_reduction=1.4e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=121 t=1.1e+00 per=2.0e+01 cost=8.2e+07 flops=7.4e+07
 sigma_tot[gemm] counter=121 i=0 t=2.5e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=2.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=1.8e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=3 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=4 t=7.9e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=121 i=5 t=7.9e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=121 i=6 t=7.4e-01 per=1.3e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=121 i=7 t=7.4e-01 per=1.3e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=121 total t=3.1e+00 per=5.6e+01 cost=6.2e+07 flops=2.0e+07
 sigma_tot[red] counter=121 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.9e-06,2.1e-06,1.2e-06,2.0e-07
settings: ndim=97 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316983833544 -1.116e+03  1.087e-02    1     1  5.324e-02 5.324e-02 5.322e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.366e-03,1.009e-02,2.979e-02,1.061e-02,5.186e-02
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=1.361e-03 speed=1.062e-03GB/S T(nccl)=5.206e-06 speed=2.776e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.0e-02 -----
 sigma[inter] counter=122 t=1.0e-02 per=2.0e+01 cost=4.5e+05 flops=4.5e+07
 sigma[gemm] counter=122 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=3 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=4 t=7.5e-03 per=1.5e+01 cost=8.7e+04 flops=1.2e+07
 sigma[gemm] counter=122 i=5 t=7.5e-03 per=1.5e+01 cost=8.5e+04 flops=1.1e+07
 sigma[gemm] counter=122 i=6 t=7.4e-03 per=1.5e+01 cost=6.3e+04 flops=8.5e+06
 sigma[gemm] counter=122 i=7 t=7.4e-03 per=1.5e+01 cost=6.4e+04 flops=8.6e+06
 sigma[gemm] counter=122 total t=3.0e-02 per=5.9e+01 cost=3.0e+05 flops=1.0e+07
 sigma[red] counter=122 t=1.1e-02 per=2.1e+01 cost=9.5e+04 flops=8.9e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.1e+00 t_reduction=1.4e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=122 t=1.1e+00 per=2.0e+01 cost=8.2e+07 flops=7.4e+07
 sigma_tot[gemm] counter=122 i=0 t=2.5e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=2.1e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=1.9e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=3 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=4 t=7.9e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=122 i=5 t=8.0e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=122 i=6 t=7.5e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=122 i=7 t=7.5e-01 per=1.3e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=122 total t=3.1e+00 per=5.6e+01 cost=6.2e+07 flops=2.0e+07
 sigma_tot[red] counter=122 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.6e-05,3.4e-06,1.3e-06,2.3e-07
    2   0 -    -116.317273851910 -2.900e-04  2.982e-03    2     2  1.230e-01 6.149e-02 5.259e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.122e-03,1.001e-02,3.029e-02,1.044e-02,5.187e-02
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=1.117e-03 speed=1.294e-03GB/S T(nccl)=4.744e-06 speed=3.047e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=123 t=1.0e-02 per=2.0e+01 cost=4.5e+05 flops=4.5e+07
 sigma[gemm] counter=123 i=0 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=3 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=4 t=7.6e-03 per=1.5e+01 cost=8.7e+04 flops=1.2e+07
 sigma[gemm] counter=123 i=5 t=7.6e-03 per=1.5e+01 cost=8.5e+04 flops=1.1e+07
 sigma[gemm] counter=123 i=6 t=7.6e-03 per=1.5e+01 cost=6.3e+04 flops=8.4e+06
 sigma[gemm] counter=123 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+04 flops=8.4e+06
 sigma[gemm] counter=123 total t=3.0e-02 per=6.0e+01 cost=3.0e+05 flops=9.9e+06
 sigma[red] counter=123 t=1.0e-02 per=2.1e+01 cost=9.5e+04 flops=9.1e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.1e+00 t_reduction=1.4e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=123 t=1.1e+00 per=2.0e+01 cost=8.3e+07 flops=7.4e+07
 sigma_tot[gemm] counter=123 i=0 t=2.5e-04 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=2.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=1.9e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=3 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=4 t=8.0e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=123 i=5 t=8.1e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=123 i=6 t=7.6e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=123 i=7 t=7.5e-01 per=1.3e+01 cost=1.6e+07 flops=2.1e+07
 sigma_tot[gemm] counter=123 total t=3.1e+00 per=5.6e+01 cost=6.2e+07 flops=2.0e+07
 sigma_tot[red] counter=123 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,2.9e-06,1.4e-06,2.1e-07
    3   0 -    -116.317293224830 -1.937e-05  1.085e-03    3     3  1.846e-01 6.152e-02 5.238e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.001e-04,1.002e-02,3.000e-02,1.065e-02,5.147e-02
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=7.937e-04 speed=1.821e-03GB/S T(nccl)=6.457e-06 speed=2.239e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=124 t=1.0e-02 per=2.0e+01 cost=4.5e+05 flops=4.5e+07
 sigma[gemm] counter=124 i=0 t=3.9e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=3.2e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=3.1e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=3 t=3.2e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=4 t=7.4e-03 per=1.5e+01 cost=8.7e+04 flops=1.2e+07
 sigma[gemm] counter=124 i=5 t=7.5e-03 per=1.5e+01 cost=8.5e+04 flops=1.1e+07
 sigma[gemm] counter=124 i=6 t=7.5e-03 per=1.5e+01 cost=6.3e+04 flops=8.5e+06
 sigma[gemm] counter=124 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+04 flops=8.5e+06
 sigma[gemm] counter=124 total t=3.0e-02 per=5.9e+01 cost=3.0e+05 flops=1.0e+07
 sigma[red] counter=124 t=1.1e-02 per=2.1e+01 cost=9.5e+04 flops=8.9e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.7e+00 -----
 sigma_tot[inter] counter=124 t=1.1e+00 per=2.0e+01 cost=8.3e+07 flops=7.4e+07
 sigma_tot[gemm] counter=124 i=0 t=2.5e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=2.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=3 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=4 t=8.1e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=124 i=5 t=8.2e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=124 i=6 t=7.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=124 i=7 t=7.6e-01 per=1.3e+01 cost=1.6e+07 flops=2.1e+07
 sigma_tot[gemm] counter=124 total t=3.2e+00 per=5.6e+01 cost=6.2e+07 flops=2.0e+07
 sigma_tot[red] counter=124 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=3.8e-05 T(gemm/eig/ortho/gemm/axpy)=6.9e-06,2.4e-05,4.9e-06,2.4e-06,3.7e-07
    4   0 -    -116.317295375904 -2.151e-06  3.934e-04    3     4  2.462e-01 6.154e-02 5.220e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.546e-03,1.005e-02,2.990e-02,1.070e-02,5.220e-02
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=1.540e-03 speed=9.384e-04GB/S T(nccl)=5.831e-06 speed=2.479e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=125 t=1.0e-02 per=2.0e+01 cost=4.5e+05 flops=4.5e+07
 sigma[gemm] counter=125 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=3 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=4 t=7.5e-03 per=1.5e+01 cost=8.7e+04 flops=1.2e+07
 sigma[gemm] counter=125 i=5 t=7.5e-03 per=1.5e+01 cost=8.5e+04 flops=1.1e+07
 sigma[gemm] counter=125 i=6 t=7.4e-03 per=1.5e+01 cost=6.3e+04 flops=8.5e+06
 sigma[gemm] counter=125 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+04 flops=8.5e+06
 sigma[gemm] counter=125 total t=3.0e-02 per=5.9e+01 cost=3.0e+05 flops=1.0e+07
 sigma[red] counter=125 t=1.1e-02 per=2.1e+01 cost=9.5e+04 flops=8.9e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.7e+00 -----
 sigma_tot[inter] counter=125 t=1.1e+00 per=2.0e+01 cost=8.4e+07 flops=7.3e+07
 sigma_tot[gemm] counter=125 i=0 t=2.6e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=2.2e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=3 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=4 t=8.2e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=125 i=5 t=8.2e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=125 i=6 t=7.7e-01 per=1.4e+01 cost=1.5e+07 flops=2.0e+07
 sigma_tot[gemm] counter=125 i=7 t=7.7e-01 per=1.3e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=125 total t=3.2e+00 per=5.6e+01 cost=6.3e+07 flops=2.0e+07
 sigma_tot[red] counter=125 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.1e-06,1.3e-06,2.4e-07
    5   0 -    -116.317295765957 -3.901e-07  1.661e-04    3     5  3.118e-01 6.235e-02 5.223e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.192e-03,1.006e-02,3.015e-02,1.064e-02,5.206e-02
 analyze_tgpu[Hx]: ndim=97:7.227e-07GB T(cpu-gpu)=1.186e-03 speed=1.218e-03GB/S T(nccl)=5.539e-06 speed=2.610e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=126 t=1.0e-02 per=2.0e+01 cost=4.5e+05 flops=4.5e+07
 sigma[gemm] counter=126 i=0 t=2.9e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=2.6e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=2.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=3 t=2.5e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=4 t=7.6e-03 per=1.5e+01 cost=8.7e+04 flops=1.1e+07
 sigma[gemm] counter=126 i=5 t=7.6e-03 per=1.5e+01 cost=8.5e+04 flops=1.1e+07
 sigma[gemm] counter=126 i=6 t=7.5e-03 per=1.5e+01 cost=6.3e+04 flops=8.5e+06
 sigma[gemm] counter=126 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+04 flops=8.5e+06
 sigma[gemm] counter=126 total t=3.0e-02 per=5.9e+01 cost=3.0e+05 flops=9.9e+06
 sigma[red] counter=126 t=1.1e-02 per=2.1e+01 cost=9.5e+04 flops=8.9e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=126 t=1.2e+00 per=2.0e+01 cost=8.4e+07 flops=7.3e+07
 sigma_tot[gemm] counter=126 i=0 t=2.6e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=2.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=1.9e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=3 t=2.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=4 t=8.2e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=126 i=5 t=8.3e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=126 i=6 t=7.8e-01 per=1.4e+01 cost=1.5e+07 flops=1.9e+07
 sigma_tot[gemm] counter=126 i=7 t=7.8e-01 per=1.3e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=126 total t=3.2e+00 per=5.6e+01 cost=6.3e+07 flops=2.0e+07
 sigma_tot[red] counter=126 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.9e-05,4.4e-06,1.6e-06,2.8e-07
    6   0 +    -116.317295830466 -6.451e-08  7.554e-05    3     6  3.735e-01 6.226e-02 5.222e-02
TIMING FOR Davidson : 3.736e-01  T(cal/comm/rest)=3.133e-01,9.400e-07,6.021e-02
decomposed t_rest=6.021e-02
 T(sub)    =1.548e-04 per=2.571e-01
 T(precond)=5.988e-02 per=9.946e+01
 T(ortho)  =1.857e-05 per=3.084e-02
 T(xcopy)  =1.140e-06 per=1.894e-03
 T(xnrm2)  =3.518e-06 per=5.843e-03
 T(other)  =1.462e-04 per=2.429e-01
optimized energies: isweep=0 ibond=20 dots=2 e[0]=-116.317295830466 nmvp=6
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=3.105e-03 change=3.641e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=13 dimAll=40
 (5,3):6 (4,2):2 (6,2):8 (5,1):3 (7,1):4 (4,4):1 (7,3):5 (8,2):3 (9,1):1 (6,4):4 (6,0):1 (8,0):1 (5,5):1
timing for divide=1.4e-04
timing for compute=8.2e-03
timing for collect=2.2e-05
----- TMING FOR decimation_genbasis(su2): 8.4e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-04,8.2e-03,0.0e+00,7.3e-06,2.2e-05 -----
decimation summary: 40->10 dwt=+6.719e-05 SvN=2.693e-01
 qbond: qkept nsym=5 dimAll=10
 (6,2):3 (7,3):3 (6,4):2 (5,3):1 (8,2):1
----- TIMING for decimation_row(nkr): 8.880e-03 S T(decim/select/formRot)=8.445e-03,3.182e-04,1.172e-04 -----
----- TIMING FOR twodot_decimation: 1.028e-02 S T(wf/decim)=1.258e-03,9.019e-03 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=1554:1.186e-02MB:1.158e-05GB
        per(mem): H:1.54 C:7.4 S:22.2 A:10.9 B:57.9 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=3.105e-03 change=1.534e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 2.727e-03 S -----
rank=0 GPUmem(GB): used=5.184e-05 (oper)=2.684e-05
rank=0 GPUmem(GB): used=5.226e-05 (oper,site)=2.684e-05,4.172e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=76
 no. of rintermediate operators=140
 no. of coefficients=1070:8.163e-03MB:7.972e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.495e-03 S -----
rank=0 GPUmem(GB): used=6.023e-05 (oper,site,rinter)=2.684e-05,4.172e-07,7.972e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.600e-02 S size(rtasks)=76 size(Rlst2)=25 T(Rmu/Rlist)=7.304e-04,2.527e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.643e-02 S size(rtasks)=76 size(Rlst)=2258 -----
rank=0 GPUmem(GB): used=6.023e-05 avail=6.174e+00 total=6.174e+00 batch[need]=4.711e-04 blksize=9 blksize0=9 batchsize=2258
rank=0 GPUmem(GB): used=5.313e-04 (oper,site,rinter,batch)=2.684e-05,4.172e-07,7.972e-06,4.711e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.870e-03,2.313e-02,1.018e-02
----- TIMING FOR renorm : t_inter=6.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=21 t=6.9e-03 per=1.7e+01 cost=8.9e+04 flops=1.3e+07
 renorm[gemm] counter=21 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=1 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=2 t=7.7e-03 per=1.9e+01 cost=2.1e+04 flops=2.7e+06
 renorm[gemm] counter=21 i=3 t=7.7e-03 per=1.9e+01 cost=2.6e+04 flops=3.3e+06
 renorm[gemm] counter=21 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=5 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=6 t=7.7e-03 per=1.9e+01 cost=4.6e+04 flops=6.0e+06
 renorm[gemm] counter=21 total t=2.3e-02 per=5.8e+01 cost=9.3e+04 flops=4.0e+06
 renorm[red] counter=21 t=1.0e-02 per=2.5e+01 cost=2.2e+04 flops=2.1e+06
----- TIMING FOR renorm_tot : t_inter=1.2e-01 t_gemm=4.7e-01 t_reduction=2.1e-01 tot=8.0e-01 -----
 renorm_tot[inter] counter=21 t=1.2e-01 per=1.5e+01 cost=1.6e+06 flops=1.4e+07
 renorm_tot[gemm] counter=21 i=0 t=3.1e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=1 t=2.7e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=2 t=3.0e-02 per=3.7e+00 cost=4.9e+04 flops=1.6e+06
 renorm_tot[gemm] counter=21 i=3 t=3.0e-02 per=3.8e+00 cost=5.3e+04 flops=1.8e+06
 renorm_tot[gemm] counter=21 i=4 t=1.3e-01 per=1.6e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=21 i=5 t=1.3e-01 per=1.6e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=21 i=6 t=1.6e-01 per=2.0e+01 cost=1.1e+06 flops=6.8e+06
 renorm_tot[gemm] counter=21 total t=4.7e-01 per=5.9e+01 cost=1.9e+06 flops=4.0e+06
 renorm_tot[red] counter=21 t=2.1e-01 per=2.6e+01 cost=4.8e+05 flops=2.3e+06
qops.to_cpu: size(tot)=1554:1.2e-02MB:1.2e-05GB T(to_cpu)=1.1e-04S speed=1.1e-01GB/S
check ||H-H.dagger||=7.890e-15 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0918 S rank=0 -----
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=4.829e-03 change=6.831e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=5.318e-03 change=-1.739e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=5.318e-03 change=-4.560e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.136e+00 S #####
 T(local opt: fetch) = 1.267e-02 S  per = 1.12  per(accum) = 1.12
 T(local opt: hdiag) = 2.968e-01 S  per = 26.1  per(accum) = 27.2
 T(local opt: dvdsn) = 7.193e-01 S  per = 63.3  per(accum) = 90.6
 T(local opt: decim) = 1.030e-02 S  per = 0.907  per(accum) = 91.5
 T(local opt: guess) = 1.475e-03 S  per = 0.13  per(accum) = 91.6
 T(local opt: renrm) = 9.503e-02 S  per = 8.37  per(accum) = 100
 T(local opt: save ) = 2.826e-04 S  per = 0.0249  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.193e-01 S  T(sum) = 7.181e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 6.059e-03 S  per = 0.844  per(accum) = 0.844
 T(local opt: symbolic_formulae           ) = 5.109e-03 S  per = 0.712  per(accum) = 1.56
 T(local opt: hintermediate init          ) = 2.056e-04 S  per = 0.0286  per(accum) = 1.58
 T(local opt: preprocess_hformulae_Hxlist ) = 2.344e-01 S  per = 32.6  per(accum) = 34.2
 T(local opt: hmmtasks init               ) = 9.690e-02 S  per = 13.5  per(accum) = 47.7
 T(local opt: initial guess for dvdson    ) = 1.838e-03 S  per = 0.256  per(accum) = 48
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.053e-01 S  per = 42.5  per(accum) = 90.5
 T(local opt: dvdson [cpu-gpu]            ) = 7.971e-03 S  per = 1.11  per(accum) = 91.6
 T(local opt: dvdson [nccl]               ) = 3.362e-05 S  per = 0.00468  per(accum) = 91.6
 T(local opt: dvdson [mpi]                ) = 9.400e-07 S  per = 0.000131  per(accum) = 91.6
 T(local opt: dvdson [rest part(linalg)]  ) = 6.021e-02 S  per = 8.38  per(accum) = 100
Detailed decomposition of T(renrm) = 9.503e-02 S  T(sum) = 9.503e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.041e-04 S  per = 0.425  per(accum) = 0.425
 T(local opt: qops init                    ) = 2.979e-03 S  per = 3.13  per(accum) = 3.56
 T(local opt: symbolic_formulae_renorm     ) = 2.738e-03 S  per = 2.88  per(accum) = 6.44
 T(local opt: allocate qops on gpu         ) = 5.977e-05 S  per = 0.0629  per(accum) = 6.5
 T(local opt: site memcpy cpu2gpu          ) = 1.993e-03 S  per =  2.1  per(accum) = 8.6
 T(local opt: rintermediate init           ) = 2.506e-03 S  per = 2.64  per(accum) = 11.2
 T(local opt: preprocess_formulae_Rlist2   ) = 2.651e-02 S  per = 27.9  per(accum) = 39.1
 T(local opt: rmmtasks init                ) = 1.450e-02 S  per = 15.3  per(accum) = 54.4
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 4e-05  per(accum) = 54.4
 T(local opt: preprocess_renorm_batchGPU   ) = 4.027e-02 S  per = 42.4  per(accum) = 96.8
 T(local opt: deallocate cpu and gpu memory) = 9.489e-05 S  per = 0.0999  per(accum) = 96.9
 T(local opt: construct opS [ifdists=true] ) = 3.900e-08 S  per = 4.1e-05  per(accum) = 96.9
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 3.89e-05  per(accum) = 96.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.180e-04 S  per = 0.124  per(accum) = 97
 T(local opt: reduction of opS & opH [mpi] ) = 5.479e-05 S  per = 0.0577  per(accum) = 97
 T(local opt: qops_pool join and erase     ) = 2.795e-03 S  per = 2.94  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.280e-06 S  per = 0.00977  per(accum) = 100
##### sweep opt: 2.530e+01 S #####
 T(sweep opt: fetch) = 3.067e-01 S  per = 1.21  per(accum) = 1.21
 T(sweep opt: hdiag) = 9.217e+00 S  per = 36.4  per(accum) = 37.6
 T(sweep opt: dvdsn) = 1.341e+01 S  per =   53  per(accum) = 90.7
 T(sweep opt: decim) = 2.894e-01 S  per = 1.14  per(accum) = 91.8
 T(sweep opt: guess) = 2.543e-02 S  per = 0.101  per(accum) = 91.9
 T(sweep opt: renrm) = 2.040e+00 S  per = 8.06  per(accum) = 100
 T(sweep opt: save ) = 6.883e-03 S  per = 0.0272  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.341e+01 S  T(sum) = 1.339e+01 S  per = 9.981e+01
 T(sweep opt: preprocess                  ) = 1.071e-01 S  per =  0.8  per(accum) = 0.8
 T(sweep opt: symbolic_formulae           ) = 1.372e-01 S  per = 1.02  per(accum) = 1.82
 T(sweep opt: hintermediate init          ) = 5.268e-03 S  per = 0.0393  per(accum) = 1.86
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.147e+00 S  per =   31  per(accum) = 32.8
 T(sweep opt: hmmtasks init               ) = 1.679e+00 S  per = 12.5  per(accum) = 45.4
 T(sweep opt: initial guess for dvdson    ) = 3.017e-02 S  per = 0.225  per(accum) = 45.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.795e+00 S  per = 43.3  per(accum) = 88.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.699e-01 S  per = 1.27  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 9.006e-04 S  per = 0.00673  per(accum) = 90.2
 T(sweep opt: dvdson [mpi]                ) = 2.028e-05 S  per = 0.000152  per(accum) = 90.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.316e+00 S  per = 9.83  per(accum) = 100
Detailed decomposition of T(renrm) = 2.040e+00 S  T(sum) = 2.040e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.412e-03 S  per = 0.314  per(accum) = 0.314
 T(sweep opt: qops init                    ) = 7.010e-02 S  per = 3.44  per(accum) = 3.75
 T(sweep opt: symbolic_formulae_renorm     ) = 7.946e-02 S  per =  3.9  per(accum) = 7.65
 T(sweep opt: allocate qops on gpu         ) = 3.252e-03 S  per = 0.159  per(accum) = 7.81
 T(sweep opt: site memcpy cpu2gpu          ) = 2.729e-02 S  per = 1.34  per(accum) = 9.14
 T(sweep opt: rintermediate init           ) = 5.043e-02 S  per = 2.47  per(accum) = 11.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.937e-01 S  per = 29.1  per(accum) = 40.7
 T(sweep opt: rmmtasks init                ) = 3.025e-01 S  per = 14.8  per(accum) = 55.5
 T(sweep opt: qops memset on cpu           ) = 8.480e-07 S  per = 4.16e-05  per(accum) = 55.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.065e-01 S  per = 39.5  per(accum) = 95.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.570e-03 S  per = 0.126  per(accum) = 95.2
 T(sweep opt: construct opS [ifdists=true] ) = 1.098e-06 S  per = 5.38e-05  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [nccl]) = 8.500e-07 S  per = 4.17e-05  per(accum) = 95.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.382e-03 S  per = 0.117  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.098e-03 S  per = 0.0538  per(accum) = 95.4
 T(sweep opt: qops_pool join and erase     ) = 6.186e-02 S  per = 3.03  per(accum) = 98.4
 T(sweep opt: conversion from opAB to opPQ ) = 3.246e-02 S  per = 1.59  per(accum) = 100
##### global opt: 2.530e+01 S #####
 T(global opt: fetch) = 3.067e-01 S  per = 1.21  per(accum) = 1.21
 T(global opt: hdiag) = 9.217e+00 S  per = 36.4  per(accum) = 37.6
 T(global opt: dvdsn) = 1.341e+01 S  per =   53  per(accum) = 90.7
 T(global opt: decim) = 2.894e-01 S  per = 1.14  per(accum) = 91.8
 T(global opt: guess) = 2.543e-02 S  per = 0.101  per(accum) = 91.9
 T(global opt: renrm) = 2.040e+00 S  per = 8.06  per(accum) = 100
 T(global opt: save ) = 6.883e-03 S  per = 0.0272  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.341e+01 S  T(sum) = 1.339e+01 S  per = 9.981e+01
 T(global opt: preprocess                  ) = 1.071e-01 S  per =  0.8  per(accum) = 0.8
 T(global opt: symbolic_formulae           ) = 1.372e-01 S  per = 1.02  per(accum) = 1.82
 T(global opt: hintermediate init          ) = 5.268e-03 S  per = 0.0393  per(accum) = 1.86
 T(global opt: preprocess_hformulae_Hxlist ) = 4.147e+00 S  per =   31  per(accum) = 32.8
 T(global opt: hmmtasks init               ) = 1.679e+00 S  per = 12.5  per(accum) = 45.4
 T(global opt: initial guess for dvdson    ) = 3.017e-02 S  per = 0.225  per(accum) = 45.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.795e+00 S  per = 43.3  per(accum) = 88.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.699e-01 S  per = 1.27  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 9.006e-04 S  per = 0.00673  per(accum) = 90.2
 T(global opt: dvdson [mpi]                ) = 2.028e-05 S  per = 0.000152  per(accum) = 90.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.316e+00 S  per = 9.83  per(accum) = 100
Detailed decomposition of T(renrm) = 2.040e+00 S  T(sum) = 2.040e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.412e-03 S  per = 0.314  per(accum) = 0.314
 T(global opt: qops init                    ) = 7.010e-02 S  per = 3.44  per(accum) = 3.75
 T(global opt: symbolic_formulae_renorm     ) = 7.946e-02 S  per =  3.9  per(accum) = 7.65
 T(global opt: allocate qops on gpu         ) = 3.252e-03 S  per = 0.159  per(accum) = 7.81
 T(global opt: site memcpy cpu2gpu          ) = 2.729e-02 S  per = 1.34  per(accum) = 9.14
 T(global opt: rintermediate init           ) = 5.043e-02 S  per = 2.47  per(accum) = 11.6
 T(global opt: preprocess_formulae_Rlist2   ) = 5.937e-01 S  per = 29.1  per(accum) = 40.7
 T(global opt: rmmtasks init                ) = 3.025e-01 S  per = 14.8  per(accum) = 55.5
 T(global opt: qops memset on cpu           ) = 8.480e-07 S  per = 4.16e-05  per(accum) = 55.5
 T(global opt: preprocess_renorm_batchGPU   ) = 8.065e-01 S  per = 39.5  per(accum) = 95.1
 T(global opt: deallocate cpu and gpu memory) = 2.570e-03 S  per = 0.126  per(accum) = 95.2
 T(global opt: construct opS [ifdists=true] ) = 1.098e-06 S  per = 5.38e-05  per(accum) = 95.2
 T(global opt: reduction of opS & opH [nccl]) = 8.500e-07 S  per = 4.17e-05  per(accum) = 95.2
 T(global opt: qops memcpy gpu2cpu          ) = 2.382e-03 S  per = 0.117  per(accum) = 95.3
 T(global opt: reduction of opS & opH [mpi] ) = 1.098e-03 S  per = 0.0538  per(accum) = 95.4
 T(global opt: qops_pool join and erase     ) = 6.186e-02 S  per = 3.03  per(accum) = 98.4
 T(global opt: conversion from opAB to opPQ ) = 3.246e-02 S  per = 1.59  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.574e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=21/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=738:5.630e-03MB:5.499e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=41:3.128e-04MB:3.055e-07GB
total mem of comb=780:5.951e-03MB:5.811e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=2273:1.734e-02MB:1.694e-05GB
        per(mem): H:1.01 C:10.3 S:5.54 P:4.31 Q:78.8 
 rqops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=36:0.000275MB size(tot)=1554:0.0119MB:1.16e-05GB
        per(mem): H:1.54 C:7.4 S:22.2 A:10.9 B:57.9 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5823:0.0444MB:4.34e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.975e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(9,10,3,3) nnz=101:7.706e-04MB
qtensor4: wf4 own=1 _data=0x3aaf0e00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
 qbond: qcol nsym=5 dimAll=10
 (6,2):3 (7,3):3 (6,4):2 (5,3):1 (8,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=25 nblocks=320 size=101:7.706e-04MB
### DIAG TIMING: total=4.417e-01 t1=2.688e-05, t2=1.615e-03, t3=2.559e-03, t4=4.375e-01, t5=4.835e-06, t6=1.479e-05, t7=3.584e-06
duration_diagGPU:4.418e-01
duration_diagreduce:5.500e-08
duration_diagtransform:6.030e-07
----- TIMING FOR symbolic_formulae_twodot with size=491 : 6.637e-03 S -----
rank=0 GPUmem(GB): used=4.338e-05 (oper)=4.338e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=491
 no. of hintermediate operators=244
 no. of coefficients=3269:2.494e-02MB:2.436e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.526e-04 S -----
rank=0 GPUmem(GB): used=6.774e-05 (oper,hinter)=4.338e-05,2.436e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.176e-01 S size(H_formulae)=491 size(Hxlst2)=25 T(Hmu/Hxlist)=1.311e-03,2.163e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.198e-01 S size(H_formulae)=491 size(Hxlst)=14084 -----
rank=0 GPUmem(GB): used=6.774e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.505e-06 batch[need]=2.938e-03 blksize=9 blksize0=9 batchsize=14084
rank=0 GPUmem(GB): used=3.007e-03 (oper,hinter,dvdson,batch)=4.338e-05,2.436e-05,1.505e-06,2.938e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=101 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.166e-03,9.949e-03,2.988e-02,1.051e-02,5.152e-02
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=1.145e-03 speed=1.314e-03GB/S T(nccl)=2.062e-05 speed=7.297e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.0e-02 -----
 sigma[inter] counter=127 t=9.9e-03 per=2.0e+01 cost=7.9e+05 flops=7.9e+07
 sigma[gemm] counter=127 i=0 t=5.4e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=4.4e-06 per=8.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=4.3e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=3 t=4.3e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=127 i=5 t=7.5e-03 per=1.5e+01 cost=1.2e+05 flops=1.6e+07
 sigma[gemm] counter=127 i=6 t=7.5e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=127 i=7 t=7.5e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=127 total t=3.0e-02 per=5.9e+01 cost=4.4e+05 flops=1.5e+07
 sigma[red] counter=127 t=1.1e-02 per=2.1e+01 cost=1.2e+05 flops=1.1e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=127 t=1.2e+00 per=2.0e+01 cost=8.5e+07 flops=7.3e+07
 sigma_tot[gemm] counter=127 i=0 t=2.6e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=2.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=3 t=2.0e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=4 t=8.3e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=127 i=5 t=8.4e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=127 i=6 t=7.9e-01 per=1.4e+01 cost=1.5e+07 flops=1.9e+07
 sigma_tot[gemm] counter=127 i=7 t=7.8e-01 per=1.3e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=127 total t=3.2e+00 per=5.6e+01 cost=6.3e+07 flops=2.0e+07
 sigma_tot[red] counter=127 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.0e-05,5.0e-06,2.4e-06,5.4e-07
settings: ndim=101 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.317262557766 -1.116e+03  4.006e-02    1     1  5.186e-02 5.186e-02 5.179e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.466e-03,1.016e-02,3.020e-02,1.041e-02,5.225e-02
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=1.459e-03 speed=1.031e-03GB/S T(nccl)=6.978e-06 speed=2.157e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=128 t=1.0e-02 per=2.0e+01 cost=7.9e+05 flops=7.7e+07
 sigma[gemm] counter=128 i=0 t=2.9e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=2.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=2.6e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=3 t=2.6e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=128 i=5 t=7.7e-03 per=1.5e+01 cost=1.2e+05 flops=1.5e+07
 sigma[gemm] counter=128 i=6 t=7.6e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=128 i=7 t=7.4e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=128 total t=3.0e-02 per=5.9e+01 cost=4.4e+05 flops=1.5e+07
 sigma[red] counter=128 t=1.0e-02 per=2.1e+01 cost=1.2e+05 flops=1.2e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=128 t=1.2e+00 per=2.0e+01 cost=8.6e+07 flops=7.3e+07
 sigma_tot[gemm] counter=128 i=0 t=2.7e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=2.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=3 t=2.0e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=4 t=8.4e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=128 i=5 t=8.5e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=128 i=6 t=8.0e-01 per=1.4e+01 cost=1.5e+07 flops=1.9e+07
 sigma_tot[gemm] counter=128 i=7 t=7.9e-01 per=1.3e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=128 total t=3.3e+00 per=5.6e+01 cost=6.4e+07 flops=2.0e+07
 sigma_tot[red] counter=128 t=1.4e+00 per=2.4e+01 cost=1.5e+07 flops=1.1e+07
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=7.1e-06,2.1e-05,1.7e-05,2.1e-06,2.8e-07
    2   0 -    -116.323091101205 -5.829e-03  1.019e-02    2     2  1.155e-01 5.773e-02 5.211e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.871e-04,1.015e-02,3.030e-02,1.046e-02,5.130e-02
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=3.820e-04 speed=3.940e-03GB/S T(nccl)=5.126e-06 speed=2.936e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=129 t=1.0e-02 per=2.0e+01 cost=7.9e+05 flops=7.7e+07
 sigma[gemm] counter=129 i=0 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=3 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=4 t=7.6e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=129 i=5 t=7.5e-03 per=1.5e+01 cost=1.2e+05 flops=1.6e+07
 sigma[gemm] counter=129 i=6 t=7.6e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=129 i=7 t=7.6e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=129 total t=3.0e-02 per=6.0e+01 cost=4.4e+05 flops=1.4e+07
 sigma[red] counter=129 t=1.0e-02 per=2.1e+01 cost=1.2e+05 flops=1.1e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=129 t=1.2e+00 per=2.0e+01 cost=8.6e+07 flops=7.3e+07
 sigma_tot[gemm] counter=129 i=0 t=2.7e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=2.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=3 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=4 t=8.5e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=129 i=5 t=8.6e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=129 i=6 t=8.0e-01 per=1.4e+01 cost=1.5e+07 flops=1.9e+07
 sigma_tot[gemm] counter=129 i=7 t=8.0e-01 per=1.3e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=129 total t=3.3e+00 per=5.6e+01 cost=6.4e+07 flops=1.9e+07
 sigma_tot[red] counter=129 t=1.4e+00 per=2.4e+01 cost=1.6e+07 flops=1.1e+07
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,1.8e-05,3.2e-06,1.4e-06,2.5e-07
    3   0 -    -116.323357526302 -2.664e-04  3.036e-03    3     3  1.792e-01 5.974e-02 5.188e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.827e-03,1.006e-02,3.045e-02,1.071e-02,5.306e-02
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=1.820e-03 speed=8.269e-04GB/S T(nccl)=6.794e-06 speed=2.215e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=130 t=1.0e-02 per=2.0e+01 cost=7.9e+05 flops=7.8e+07
 sigma[gemm] counter=130 i=0 t=7.0e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=1.9e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=3 t=2.4e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=4 t=7.7e-03 per=1.5e+01 cost=1.3e+05 flops=1.6e+07
 sigma[gemm] counter=130 i=5 t=7.6e-03 per=1.5e+01 cost=1.2e+05 flops=1.5e+07
 sigma[gemm] counter=130 i=6 t=7.6e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=130 i=7 t=7.5e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=130 total t=3.0e-02 per=5.9e+01 cost=4.4e+05 flops=1.4e+07
 sigma[red] counter=130 t=1.1e-02 per=2.1e+01 cost=1.2e+05 flops=1.1e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=130 t=1.2e+00 per=2.0e+01 cost=8.7e+07 flops=7.3e+07
 sigma_tot[gemm] counter=130 i=0 t=2.8e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=2.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=3 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=4 t=8.5e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=130 i=5 t=8.6e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=130 i=6 t=8.1e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=130 i=7 t=8.1e-01 per=1.3e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=130 total t=3.3e+00 per=5.6e+01 cost=6.5e+07 flops=1.9e+07
 sigma_tot[red] counter=130 t=1.4e+00 per=2.4e+01 cost=1.6e+07 flops=1.1e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.5e-05,3.1e-06,1.3e-06,2.5e-07
    4   0 -    -116.323385101891 -2.758e-05  1.279e-03    3     4  2.455e-01 6.138e-02 5.220e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.072e-04,1.003e-02,3.053e-02,1.072e-02,5.180e-02
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=5.019e-04 speed=2.999e-03GB/S T(nccl)=5.302e-06 speed=2.839e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.1e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=131 t=1.0e-02 per=2.0e+01 cost=7.9e+05 flops=7.8e+07
 sigma[gemm] counter=131 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=131 i=5 t=7.6e-03 per=1.5e+01 cost=1.2e+05 flops=1.5e+07
 sigma[gemm] counter=131 i=6 t=7.7e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=131 i=7 t=7.7e-03 per=1.5e+01 cost=1.0e+05 flops=1.3e+07
 sigma[gemm] counter=131 total t=3.1e-02 per=6.0e+01 cost=4.4e+05 flops=1.4e+07
 sigma[red] counter=131 t=1.1e-02 per=2.1e+01 cost=1.2e+05 flops=1.1e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.4e+00 t_reduction=1.5e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=131 t=1.2e+00 per=2.0e+01 cost=8.8e+07 flops=7.3e+07
 sigma_tot[gemm] counter=131 i=0 t=2.8e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=2.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=2.1e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=3 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=4 t=8.6e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=131 i=5 t=8.7e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=131 i=6 t=8.2e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=131 i=7 t=8.1e-01 per=1.3e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=131 total t=3.4e+00 per=5.6e+01 cost=6.5e+07 flops=1.9e+07
 sigma_tot[red] counter=131 t=1.5e+00 per=2.4e+01 cost=1.6e+07 flops=1.1e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,3.0e-06,1.2e-06,2.2e-07
    5   0 -    -116.323388886297 -3.784e-06  3.463e-04    3     5  3.098e-01 6.195e-02 5.214e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.920e-03,1.022e-02,3.007e-02,1.075e-02,5.297e-02
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=1.914e-03 speed=7.864e-04GB/S T(nccl)=6.248e-06 speed=2.409e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=5.1e-02 -----
 sigma[inter] counter=132 t=1.0e-02 per=2.0e+01 cost=7.9e+05 flops=7.7e+07
 sigma[gemm] counter=132 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=3 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=132 i=5 t=7.5e-03 per=1.5e+01 cost=1.2e+05 flops=1.6e+07
 sigma[gemm] counter=132 i=6 t=7.5e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=132 i=7 t=7.5e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=132 total t=3.0e-02 per=5.9e+01 cost=4.4e+05 flops=1.5e+07
 sigma[red] counter=132 t=1.1e-02 per=2.1e+01 cost=1.2e+05 flops=1.1e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.4e+00 t_reduction=1.5e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=132 t=1.2e+00 per=2.0e+01 cost=8.9e+07 flops=7.3e+07
 sigma_tot[gemm] counter=132 i=0 t=2.8e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=2.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=2.1e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=3 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=4 t=8.7e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=132 i=5 t=8.8e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=132 i=6 t=8.3e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=132 i=7 t=8.2e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=132 total t=3.4e+00 per=5.6e+01 cost=6.6e+07 flops=1.9e+07
 sigma_tot[red] counter=132 t=1.5e+00 per=2.4e+01 cost=1.6e+07 flops=1.1e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.5e-05,3.2e-06,1.3e-06,2.4e-07
    6   0 -    -116.323389262986 -3.767e-07  1.551e-04    3     6  3.780e-01 6.299e-02 5.230e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.544e-03,1.016e-02,3.010e-02,1.040e-02,5.222e-02
 analyze_tgpu[Hx]: ndim=101:7.525e-07GB T(cpu-gpu)=1.538e-03 speed=9.785e-04GB/S T(nccl)=6.297e-06 speed=2.390e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.1e-02 -----
 sigma[inter] counter=133 t=1.0e-02 per=2.0e+01 cost=7.9e+05 flops=7.7e+07
 sigma[gemm] counter=133 i=0 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=1.4e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=3 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=133 i=5 t=7.6e-03 per=1.5e+01 cost=1.2e+05 flops=1.5e+07
 sigma[gemm] counter=133 i=6 t=7.5e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=133 i=7 t=7.5e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=133 total t=3.0e-02 per=5.9e+01 cost=4.4e+05 flops=1.5e+07
 sigma[red] counter=133 t=1.0e-02 per=2.1e+01 cost=1.2e+05 flops=1.2e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.4e+00 t_reduction=1.5e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=133 t=1.2e+00 per=2.0e+01 cost=9.0e+07 flops=7.3e+07
 sigma_tot[gemm] counter=133 i=0 t=2.8e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=2.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=2.1e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=3 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=4 t=8.8e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=133 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=133 i=6 t=8.3e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=133 i=7 t=8.3e-01 per=1.4e+01 cost=1.6e+07 flops=2.0e+07
 sigma_tot[gemm] counter=133 total t=3.4e+00 per=5.6e+01 cost=6.6e+07 flops=1.9e+07
 sigma_tot[red] counter=133 t=1.5e+00 per=2.4e+01 cost=1.6e+07 flops=1.1e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.5e-05,3.1e-06,1.3e-06,2.5e-07
    7   0 +    -116.323389329774 -6.679e-08  5.925e-05    3     7  4.427e-01 6.324e-02 5.230e-02
TIMING FOR Davidson : 4.427e-01  T(cal/comm/rest)=3.661e-01,1.301e-06,7.655e-02
decomposed t_rest=7.655e-02
 T(sub)    =1.971e-04 per=2.575e-01
 T(precond)=7.611e-02 per=9.942e+01
 T(ortho)  =4.208e-05 per=5.497e-02
 T(xcopy)  =1.297e-06 per=1.694e-03
 T(xnrm2)  =4.033e-06 per=5.268e-03
 T(other)  =2.005e-04 per=2.618e-01
optimized energies: isweep=0 ibond=21 dots=2 e[0]=-116.323389329774 nmvp=7
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=6.149e-03 change=3.708e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=11 dimAll=40
 (6,2):4 (7,3):9 (6,4):3 (5,3):1 (8,2):7 (9,3):4 (8,4):5 (10,2):1 (7,1):3 (7,5):2 (9,1):1
timing for divide=8.3e-05
timing for compute=1.2e-02
timing for collect=4.0e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.3e-05,1.2e-02,0.0e+00,6.5e-06,4.0e-05 -----
decimation summary: 40->10 dwt=+4.290e-04 SvN=5.600e-01
 qbond: qkept nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (10,2):1 (9,1):1
----- TIMING for decimation_row(nkr): 1.301e-02 S T(decim/select/formRot)=1.250e-02,3.637e-04,1.465e-04 -----
----- TIMING FOR twodot_decimation: 1.396e-02 S T(wf/decim)=8.245e-04,1.314e-02 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1819:1.388e-02MB:1.355e-05GB
        per(mem): H:1.1 C:7.26 S:16.9 A:12.4 B:62.3 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=6.149e-03 change=2.713e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=99 : 2.947e-03 S -----
rank=0 GPUmem(GB): used=6.436e-05 (oper)=3.257e-05
rank=0 GPUmem(GB): used=6.471e-05 (oper,site)=3.257e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=99
 no. of rintermediate operators=131
 no. of coefficients=1475:1.125e-02MB:1.099e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.501e-03 S -----
rank=0 GPUmem(GB): used=7.570e-05 (oper,site,rinter)=3.257e-05,3.502e-07,1.099e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.198e-02 S size(rtasks)=99 size(Rlst2)=36 T(Rmu/Rlist)=7.896e-04,3.119e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.225e-02 S size(rtasks)=99 size(Rlst)=2511 -----
rank=0 GPUmem(GB): used=7.570e-05 avail=6.174e+00 total=6.174e+00 batch[need]=5.238e-04 blksize=9 blksize0=9 batchsize=2511
rank=0 GPUmem(GB): used=5.995e-04 (oper,site,rinter,batch)=3.257e-05,3.502e-07,1.099e-05,5.238e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.137e-03,2.281e-02,1.003e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=22 t=7.1e-03 per=1.8e+01 cost=1.4e+05 flops=2.0e+07
 renorm[gemm] counter=22 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=2 t=7.6e-03 per=1.9e+01 cost=1.9e+04 flops=2.5e+06
 renorm[gemm] counter=22 i=3 t=7.6e-03 per=1.9e+01 cost=2.6e+04 flops=3.4e+06
 renorm[gemm] counter=22 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=6 t=7.6e-03 per=1.9e+01 cost=3.6e+04 flops=4.7e+06
 renorm[gemm] counter=22 total t=2.3e-02 per=5.7e+01 cost=8.1e+04 flops=3.6e+06
 renorm[red] counter=22 t=1.0e-02 per=2.5e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=1.3e-01 t_gemm=5.0e-01 t_reduction=2.2e-01 tot=8.4e-01 -----
 renorm_tot[inter] counter=22 t=1.3e-01 per=1.5e+01 cost=1.8e+06 flops=1.4e+07
 renorm_tot[gemm] counter=22 i=0 t=3.3e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=1 t=2.8e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=2 t=3.8e-02 per=4.5e+00 cost=6.8e+04 flops=1.8e+06
 renorm_tot[gemm] counter=22 i=3 t=3.8e-02 per=4.5e+00 cost=7.9e+04 flops=2.1e+06
 renorm_tot[gemm] counter=22 i=4 t=1.3e-01 per=1.5e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=22 i=5 t=1.3e-01 per=1.5e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=22 i=6 t=1.7e-01 per=2.0e+01 cost=1.1e+06 flops=6.7e+06
 renorm_tot[gemm] counter=22 total t=5.0e-01 per=5.9e+01 cost=2.0e+06 flops=4.0e+06
 renorm_tot[red] counter=22 t=2.2e-01 per=2.6e+01 cost=5.0e+05 flops=2.3e+06
qops.to_cpu: size(tot)=1819:1.4e-02MB:1.4e-05GB T(to_cpu)=1.1e-04S speed=1.2e-01GB/S
check ||H-H.dagger||=1.067e-14 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.1 S rank=0 -----
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=5.096e-03 change=7.793e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=5.646e-03 change=-1.877e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=5.646e-03 change=-4.545e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.350e+00 S #####
 T(local opt: fetch) = 1.154e-02 S  per = 0.855  per(accum) = 0.855
 T(local opt: hdiag) = 4.424e-01 S  per = 32.8  per(accum) = 33.6
 T(local opt: dvdsn) = 7.769e-01 S  per = 57.5  per(accum) = 91.2
 T(local opt: decim) = 1.399e-02 S  per = 1.04  per(accum) = 92.2
 T(local opt: guess) = 1.282e-03 S  per = 0.095  per(accum) = 92.3
 T(local opt: renrm) = 1.038e-01 S  per = 7.69  per(accum) = 100
 T(local opt: save ) = 3.003e-04 S  per = 0.0222  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.769e-01 S  T(sum) = 7.756e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 4.917e-03 S  per = 0.634  per(accum) = 0.634
 T(local opt: symbolic_formulae           ) = 6.650e-03 S  per = 0.857  per(accum) = 1.49
 T(local opt: hintermediate init          ) = 2.714e-04 S  per = 0.035  per(accum) = 1.53
 T(local opt: preprocess_hformulae_Hxlist ) = 2.203e-01 S  per = 28.4  per(accum) = 29.9
 T(local opt: hmmtasks init               ) = 9.931e-02 S  per = 12.8  per(accum) = 42.7
 T(local opt: initial guess for dvdson    ) = 1.407e-03 S  per = 0.181  per(accum) = 42.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.573e-01 S  per = 46.1  per(accum) = 89
 T(local opt: dvdson [cpu-gpu]            ) = 8.760e-03 S  per = 1.13  per(accum) = 90.1
 T(local opt: dvdson [nccl]               ) = 5.737e-05 S  per = 0.0074  per(accum) = 90.1
 T(local opt: dvdson [mpi]                ) = 1.301e-06 S  per = 0.000168  per(accum) = 90.1
 T(local opt: dvdson [rest part(linalg)]  ) = 7.655e-02 S  per = 9.87  per(accum) = 100
Detailed decomposition of T(renrm) = 1.038e-01 S  T(sum) = 1.038e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.864e-04 S  per = 0.469  per(accum) = 0.469
 T(local opt: qops init                    ) = 4.756e-03 S  per = 4.58  per(accum) = 5.05
 T(local opt: symbolic_formulae_renorm     ) = 2.961e-03 S  per = 2.85  per(accum) = 7.9
 T(local opt: allocate qops on gpu         ) = 9.986e-05 S  per = 0.0962  per(accum) = 8
 T(local opt: site memcpy cpu2gpu          ) = 5.261e-04 S  per = 0.507  per(accum) = 8.51
 T(local opt: rintermediate init           ) = 2.512e-03 S  per = 2.42  per(accum) = 10.9
 T(local opt: preprocess_formulae_Rlist2   ) = 3.233e-02 S  per = 31.2  per(accum) = 42.1
 T(local opt: rmmtasks init                ) = 1.672e-02 S  per = 16.1  per(accum) = 58.2
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 2.99e-05  per(accum) = 58.2
 T(local opt: preprocess_renorm_batchGPU   ) = 4.007e-02 S  per = 38.6  per(accum) = 96.8
 T(local opt: deallocate cpu and gpu memory) = 9.864e-05 S  per = 0.095  per(accum) = 96.9
 T(local opt: construct opS [ifdists=true] ) = 4.000e-08 S  per = 3.85e-05  per(accum) = 96.9
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 3.47e-05  per(accum) = 96.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.193e-04 S  per = 0.115  per(accum) = 97
 T(local opt: reduction of opS & opH [mpi] ) = 6.935e-05 S  per = 0.0668  per(accum) = 97.1
 T(local opt: qops_pool join and erase     ) = 3.032e-03 S  per = 2.92  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.434e-06 S  per = 0.00716  per(accum) = 100
##### sweep opt: 2.665e+01 S #####
 T(sweep opt: fetch) = 3.183e-01 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: hdiag) = 9.660e+00 S  per = 36.2  per(accum) = 37.4
 T(sweep opt: dvdsn) = 1.419e+01 S  per = 53.2  per(accum) = 90.7
 T(sweep opt: decim) = 3.034e-01 S  per = 1.14  per(accum) = 91.8
 T(sweep opt: guess) = 2.671e-02 S  per =  0.1  per(accum) = 91.9
 T(sweep opt: renrm) = 2.144e+00 S  per = 8.04  per(accum) = 100
 T(sweep opt: save ) = 7.183e-03 S  per = 0.027  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.419e+01 S  T(sum) = 1.416e+01 S  per = 9.982e+01
 T(sweep opt: preprocess                  ) = 1.120e-01 S  per = 0.791  per(accum) = 0.791
 T(sweep opt: symbolic_formulae           ) = 1.439e-01 S  per = 1.02  per(accum) = 1.81
 T(sweep opt: hintermediate init          ) = 5.540e-03 S  per = 0.0391  per(accum) = 1.85
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.368e+00 S  per = 30.8  per(accum) = 32.7
 T(sweep opt: hmmtasks init               ) = 1.778e+00 S  per = 12.6  per(accum) = 45.2
 T(sweep opt: initial guess for dvdson    ) = 3.158e-02 S  per = 0.223  per(accum) = 45.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.153e+00 S  per = 43.4  per(accum) = 88.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.786e-01 S  per = 1.26  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 9.580e-04 S  per = 0.00676  per(accum) = 90.2
 T(sweep opt: dvdson [mpi]                ) = 2.159e-05 S  per = 0.000152  per(accum) = 90.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.393e+00 S  per = 9.83  per(accum) = 100
Detailed decomposition of T(renrm) = 2.144e+00 S  T(sum) = 2.144e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.898e-03 S  per = 0.322  per(accum) = 0.322
 T(sweep opt: qops init                    ) = 7.486e-02 S  per = 3.49  per(accum) = 3.81
 T(sweep opt: symbolic_formulae_renorm     ) = 8.242e-02 S  per = 3.84  per(accum) = 7.66
 T(sweep opt: allocate qops on gpu         ) = 3.352e-03 S  per = 0.156  per(accum) = 7.81
 T(sweep opt: site memcpy cpu2gpu          ) = 2.782e-02 S  per =  1.3  per(accum) = 9.11
 T(sweep opt: rintermediate init           ) = 5.294e-02 S  per = 2.47  per(accum) = 11.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.260e-01 S  per = 29.2  per(accum) = 40.8
 T(sweep opt: rmmtasks init                ) = 3.192e-01 S  per = 14.9  per(accum) = 55.7
 T(sweep opt: qops memset on cpu           ) = 8.790e-07 S  per = 4.1e-05  per(accum) = 55.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.465e-01 S  per = 39.5  per(accum) = 95.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.668e-03 S  per = 0.124  per(accum) = 95.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.138e-06 S  per = 5.31e-05  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [nccl]) = 8.860e-07 S  per = 4.13e-05  per(accum) = 95.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.501e-03 S  per = 0.117  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.167e-03 S  per = 0.0544  per(accum) = 95.5
 T(sweep opt: qops_pool join and erase     ) = 6.489e-02 S  per = 3.03  per(accum) = 98.5
 T(sweep opt: conversion from opAB to opPQ ) = 3.247e-02 S  per = 1.51  per(accum) = 100
##### global opt: 2.665e+01 S #####
 T(global opt: fetch) = 3.183e-01 S  per = 1.19  per(accum) = 1.19
 T(global opt: hdiag) = 9.660e+00 S  per = 36.2  per(accum) = 37.4
 T(global opt: dvdsn) = 1.419e+01 S  per = 53.2  per(accum) = 90.7
 T(global opt: decim) = 3.034e-01 S  per = 1.14  per(accum) = 91.8
 T(global opt: guess) = 2.671e-02 S  per =  0.1  per(accum) = 91.9
 T(global opt: renrm) = 2.144e+00 S  per = 8.04  per(accum) = 100
 T(global opt: save ) = 7.183e-03 S  per = 0.027  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.419e+01 S  T(sum) = 1.416e+01 S  per = 9.982e+01
 T(global opt: preprocess                  ) = 1.120e-01 S  per = 0.791  per(accum) = 0.791
 T(global opt: symbolic_formulae           ) = 1.439e-01 S  per = 1.02  per(accum) = 1.81
 T(global opt: hintermediate init          ) = 5.540e-03 S  per = 0.0391  per(accum) = 1.85
 T(global opt: preprocess_hformulae_Hxlist ) = 4.368e+00 S  per = 30.8  per(accum) = 32.7
 T(global opt: hmmtasks init               ) = 1.778e+00 S  per = 12.6  per(accum) = 45.2
 T(global opt: initial guess for dvdson    ) = 3.158e-02 S  per = 0.223  per(accum) = 45.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.153e+00 S  per = 43.4  per(accum) = 88.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.786e-01 S  per = 1.26  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 9.580e-04 S  per = 0.00676  per(accum) = 90.2
 T(global opt: dvdson [mpi]                ) = 2.159e-05 S  per = 0.000152  per(accum) = 90.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.393e+00 S  per = 9.83  per(accum) = 100
Detailed decomposition of T(renrm) = 2.144e+00 S  T(sum) = 2.144e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.898e-03 S  per = 0.322  per(accum) = 0.322
 T(global opt: qops init                    ) = 7.486e-02 S  per = 3.49  per(accum) = 3.81
 T(global opt: symbolic_formulae_renorm     ) = 8.242e-02 S  per = 3.84  per(accum) = 7.66
 T(global opt: allocate qops on gpu         ) = 3.352e-03 S  per = 0.156  per(accum) = 7.81
 T(global opt: site memcpy cpu2gpu          ) = 2.782e-02 S  per =  1.3  per(accum) = 9.11
 T(global opt: rintermediate init           ) = 5.294e-02 S  per = 2.47  per(accum) = 11.6
 T(global opt: preprocess_formulae_Rlist2   ) = 6.260e-01 S  per = 29.2  per(accum) = 40.8
 T(global opt: rmmtasks init                ) = 3.192e-01 S  per = 14.9  per(accum) = 55.7
 T(global opt: qops memset on cpu           ) = 8.790e-07 S  per = 4.1e-05  per(accum) = 55.7
 T(global opt: preprocess_renorm_batchGPU   ) = 8.465e-01 S  per = 39.5  per(accum) = 95.2
 T(global opt: deallocate cpu and gpu memory) = 2.668e-03 S  per = 0.124  per(accum) = 95.3
 T(global opt: construct opS [ifdists=true] ) = 1.138e-06 S  per = 5.31e-05  per(accum) = 95.3
 T(global opt: reduction of opS & opH [nccl]) = 8.860e-07 S  per = 4.13e-05  per(accum) = 95.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.501e-03 S  per = 0.117  per(accum) = 95.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.167e-03 S  per = 0.0544  per(accum) = 95.5
 T(global opt: qops_pool join and erase     ) = 6.489e-02 S  per = 3.03  per(accum) = 98.5
 T(global opt: conversion from opAB to opPQ ) = 3.247e-02 S  per = 1.51  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.669e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=22/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=745:5.684e-03MB:5.551e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=52:3.967e-04MB:3.874e-07GB
total mem of comb=798:6.088e-03MB:5.946e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=3602:2.748e-02MB:2.684e-05GB
        per(mem): H:0.833 C:7 S:4.66 P:3.55 Q:84 
 rqops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=34:0.000259MB size(tot)=1819:0.0139MB:1.36e-05GB
        per(mem): H:1.1 C:7.26 S:16.9 A:12.4 B:62.3 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=7417:0.0566MB:5.53e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.053e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-3.010e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=117:8.926e-04MB
qtensor4: wf4 own=1 _data=0x41ceb400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
 qbond: qcol nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (10,2):1 (9,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=28 nblocks=384 size=117:8.926e-04MB
### DIAG TIMING: total=3.975e-01 t1=3.056e-05, t2=1.396e-03, t3=2.475e-03, t4=3.935e-01, t5=4.714e-06, t6=1.770e-05, t7=4.051e-06
duration_diagGPU:3.975e-01
duration_diagreduce:6.300e-08
duration_diagtransform:7.010e-07
----- TIMING FOR symbolic_formulae_twodot with size=591 : 8.093e-03 S -----
rank=0 GPUmem(GB): used=5.526e-05 (oper)=5.526e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=591
 no. of hintermediate operators=286
 no. of coefficients=4083:3.115e-02MB:3.042e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.826e-04 S -----
rank=0 GPUmem(GB): used=8.568e-05 (oper,hinter)=5.526e-05,3.042e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.857e-01 S size(H_formulae)=591 size(Hxlst2)=28 T(Hmu/Hxlist)=1.591e-03,3.841e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.928e-01 S size(H_formulae)=591 size(Hxlst)=20712 -----
rank=0 GPUmem(GB): used=8.568e-05 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.743e-06 batch[need]=5.247e-03 blksize=12 blksize0=9 batchsize=20712
rank=0 GPUmem(GB): used=5.334e-03 (oper,hinter,dvdson,batch)=5.526e-05,3.042e-05,1.743e-06,5.247e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=117 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.183e-03,5.141e-03,1.011e-02,1.066e-02,2.711e-02
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=1.172e-03 speed=1.487e-03GB/S T(nccl)=1.048e-05 speed=1.664e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=134 t=5.1e-03 per=2.0e+01 cost=1.2e+06 flops=2.3e+08
 sigma[gemm] counter=134 i=0 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=1.2e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=1.2e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=3 t=1.2e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=4 t=2.5e-03 per=9.7e+00 cost=1.7e+05 flops=7.0e+07
 sigma[gemm] counter=134 i=5 t=2.6e-03 per=9.9e+00 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=134 i=6 t=2.5e-03 per=9.7e+00 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=134 i=7 t=2.5e-03 per=9.7e+00 cost=1.7e+05 flops=6.9e+07
 sigma[gemm] counter=134 total t=1.0e-02 per=3.9e+01 cost=6.7e+05 flops=6.6e+07
 sigma[red] counter=134 t=1.1e-02 per=4.1e+01 cost=1.8e+05 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.4e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=134 t=1.2e+00 per=2.0e+01 cost=9.1e+07 flops=7.4e+07
 sigma_tot[gemm] counter=134 i=0 t=2.8e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=2.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=2.1e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=3 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=4 t=8.8e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=134 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=134 i=6 t=8.4e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=134 i=7 t=8.3e-01 per=1.3e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=134 total t=3.4e+00 per=5.6e+01 cost=6.7e+07 flops=1.9e+07
 sigma_tot[red] counter=134 t=1.5e+00 per=2.4e+01 cost=1.6e+07 flops=1.1e+07
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,6.7e-06,2.5e-06,1.2e-06,2.3e-07
settings: ndim=117 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323178960724 -1.116e+03  3.577e-02    1     1  2.726e-02 2.726e-02 2.723e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.072e-03,5.035e-03,1.219e-02,1.046e-02,2.976e-02
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.064e-03 speed=8.446e-04GB/S T(nccl)=8.278e-06 speed=2.106e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.2e-02 t_reduction=1.0e-02 tot=2.8e-02 -----
 sigma[inter] counter=135 t=5.0e-03 per=1.8e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=135 i=0 t=1.9e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=1.7e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=1.7e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=3 t=1.7e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=4 t=5.0e-03 per=1.8e+01 cost=1.7e+05 flops=3.5e+07
 sigma[gemm] counter=135 i=5 t=2.2e-03 per=7.9e+00 cost=1.6e+05 flops=7.4e+07
 sigma[gemm] counter=135 i=6 t=2.5e-03 per=9.1e+00 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=135 i=7 t=2.5e-03 per=9.0e+00 cost=1.7e+05 flops=7.0e+07
 sigma[gemm] counter=135 total t=1.2e-02 per=4.4e+01 cost=6.7e+05 flops=5.5e+07
 sigma[red] counter=135 t=1.0e-02 per=3.8e+01 cost=1.8e+05 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.4e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=135 t=1.2e+00 per=2.0e+01 cost=9.2e+07 flops=7.5e+07
 sigma_tot[gemm] counter=135 i=0 t=2.8e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=2.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=2.1e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=3 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=4 t=8.9e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=135 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=135 i=6 t=8.4e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=135 i=7 t=8.3e-01 per=1.3e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=135 total t=3.4e+00 per=5.6e+01 cost=6.7e+07 flops=2.0e+07
 sigma_tot[red] counter=135 t=1.5e+00 per=2.4e+01 cost=1.6e+07 flops=1.1e+07
T(sub)=6.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,4.3e-05,7.0e-06,2.8e-06,5.1e-07
    2   0 -    -116.327002472094 -3.824e-03  1.195e-02    2     2  7.023e-02 3.512e-02 2.863e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.101e-03,5.039e-03,1.020e-02,1.076e-02,2.812e-02
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.093e-03 speed=8.330e-04GB/S T(nccl)=7.591e-06 speed=2.297e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=136 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=136 i=0 t=3.1e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=2.8e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=2.7e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=3 t=2.7e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=4 t=2.5e-03 per=9.8e+00 cost=1.7e+05 flops=6.9e+07
 sigma[gemm] counter=136 i=5 t=2.6e-03 per=9.9e+00 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=136 i=6 t=2.5e-03 per=9.7e+00 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=136 i=7 t=2.5e-03 per=9.7e+00 cost=1.7e+05 flops=6.8e+07
 sigma[gemm] counter=136 total t=1.0e-02 per=3.9e+01 cost=6.7e+05 flops=6.6e+07
 sigma[red] counter=136 t=1.1e-02 per=4.1e+01 cost=1.8e+05 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=136 t=1.2e+00 per=2.0e+01 cost=9.3e+07 flops=7.5e+07
 sigma_tot[gemm] counter=136 i=0 t=2.9e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=2.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=2.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=3 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=4 t=8.9e-01 per=1.4e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=136 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+07 flops=1.9e+07
 sigma_tot[gemm] counter=136 i=6 t=8.4e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=136 i=7 t=8.4e-01 per=1.3e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=136 total t=3.5e+00 per=5.6e+01 cost=6.8e+07 flops=2.0e+07
 sigma_tot[red] counter=136 t=1.5e+00 per=2.4e+01 cost=1.7e+07 flops=1.1e+07
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,3.2e-05,4.5e-06,2.1e-06,2.9e-07
    3   0 -    -116.327419414968 -4.169e-04  4.801e-03    3     3  1.174e-01 3.915e-02 2.852e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.259e-03,5.131e-03,1.017e-02,1.056e-02,2.813e-02
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.253e-03 speed=7.738e-04GB/S T(nccl)=6.019e-06 speed=2.897e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=137 t=5.1e-03 per=2.0e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=137 i=0 t=2.6e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=2.3e-06 per=8.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=2.2e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=3 t=2.3e-06 per=8.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=4 t=2.6e-03 per=9.9e+00 cost=1.7e+05 flops=6.8e+07
 sigma[gemm] counter=137 i=5 t=2.6e-03 per=9.9e+00 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=137 i=6 t=2.5e-03 per=9.8e+00 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=137 i=7 t=2.5e-03 per=9.7e+00 cost=1.7e+05 flops=6.9e+07
 sigma[gemm] counter=137 total t=1.0e-02 per=3.9e+01 cost=6.7e+05 flops=6.6e+07
 sigma[red] counter=137 t=1.1e-02 per=4.1e+01 cost=1.8e+05 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=137 t=1.2e+00 per=2.0e+01 cost=9.4e+07 flops=7.6e+07
 sigma_tot[gemm] counter=137 i=0 t=2.9e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=2.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=3 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=4 t=8.9e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=137 i=5 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=137 i=6 t=8.4e-01 per=1.4e+01 cost=1.6e+07 flops=1.9e+07
 sigma_tot[gemm] counter=137 i=7 t=8.4e-01 per=1.3e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=137 total t=3.5e+00 per=5.6e+01 cost=6.9e+07 flops=2.0e+07
 sigma_tot[red] counter=137 t=1.5e+00 per=2.4e+01 cost=1.7e+07 flops=1.1e+07
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.0e-06,1.7e-05,4.1e-06,1.4e-05,2.7e-07
    4   0 -    -116.327507432793 -8.802e-05  2.485e-03    3     4  1.626e-01 4.064e-02 2.846e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.448e-03,5.136e-03,1.031e-02,1.069e-02,2.760e-02
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=1.442e-03 speed=1.209e-03GB/S T(nccl)=5.881e-06 speed=2.965e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=138 t=5.1e-03 per=2.0e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=138 i=0 t=2.3e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=1.9e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=1.9e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=3 t=1.9e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=4 t=2.6e-03 per=9.9e+00 cost=1.7e+05 flops=6.7e+07
 sigma[gemm] counter=138 i=5 t=2.6e-03 per=1.0e+01 cost=1.6e+05 flops=6.2e+07
 sigma[gemm] counter=138 i=6 t=2.5e-03 per=9.7e+00 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=138 i=7 t=2.5e-03 per=9.7e+00 cost=1.7e+05 flops=6.9e+07
 sigma[gemm] counter=138 total t=1.0e-02 per=3.9e+01 cost=6.7e+05 flops=6.5e+07
 sigma[red] counter=138 t=1.1e-02 per=4.1e+01 cost=1.8e+05 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=138 t=1.2e+00 per=2.0e+01 cost=9.6e+07 flops=7.7e+07
 sigma_tot[gemm] counter=138 i=0 t=2.9e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=2.5e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=3 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=4 t=8.9e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=138 i=5 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=138 i=6 t=8.5e-01 per=1.4e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=138 i=7 t=8.4e-01 per=1.3e+01 cost=1.7e+07 flops=2.1e+07
 sigma_tot[gemm] counter=138 total t=3.5e+00 per=5.6e+01 cost=6.9e+07 flops=2.0e+07
 sigma_tot[red] counter=138 t=1.5e+00 per=2.4e+01 cost=1.7e+07 flops=1.1e+07
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.7e-05,3.7e-06,1.9e-06,3.1e-07
    5   0 -    -116.327523715919 -1.628e-05  7.352e-04    3     5  2.058e-01 4.116e-02 2.831e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.171e-03,5.009e-03,1.011e-02,1.066e-02,2.795e-02
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=2.166e-03 speed=8.047e-04GB/S T(nccl)=5.011e-06 speed=3.479e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=139 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=139 i=0 t=2.0e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=1 t=1.8e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=2 t=1.7e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=3 t=1.7e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=4 t=2.5e-03 per=9.8e+00 cost=1.7e+05 flops=6.9e+07
 sigma[gemm] counter=139 i=5 t=2.6e-03 per=9.9e+00 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=139 i=6 t=2.5e-03 per=9.7e+00 cost=1.6e+05 flops=6.5e+07
 sigma[gemm] counter=139 i=7 t=2.5e-03 per=9.8e+00 cost=1.7e+05 flops=6.9e+07
 sigma[gemm] counter=139 total t=1.0e-02 per=3.9e+01 cost=6.7e+05 flops=6.7e+07
 sigma[red] counter=139 t=1.1e-02 per=4.1e+01 cost=1.8e+05 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=139 t=1.3e+00 per=2.0e+01 cost=9.7e+07 flops=7.7e+07
 sigma_tot[gemm] counter=139 i=0 t=2.9e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=1 t=2.5e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=2 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=3 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=4 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=139 i=5 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=139 i=6 t=8.5e-01 per=1.4e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=139 i=7 t=8.4e-01 per=1.3e+01 cost=1.7e+07 flops=2.1e+07
 sigma_tot[gemm] counter=139 total t=3.5e+00 per=5.6e+01 cost=7.0e+07 flops=2.0e+07
 sigma_tot[red] counter=139 t=1.5e+00 per=2.5e+01 cost=1.7e+07 flops=1.1e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.5e-05,3.4e-06,1.6e-06,2.4e-07
    6   0 -    -116.327525646041 -1.930e-06  2.496e-04    3     6  2.445e-01 4.075e-02 2.827e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.289e-03,5.045e-03,1.027e-02,1.061e-02,2.722e-02
 analyze_tgpu[Hx]: ndim=117:8.717e-07GB T(cpu-gpu)=1.284e-03 speed=1.358e-03GB/S T(nccl)=4.751e-06 speed=3.670e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=140 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=140 i=0 t=1.8e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=1 t=1.6e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=2 t=1.5e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=3 t=1.5e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=4 t=2.5e-03 per=9.8e+00 cost=1.7e+05 flops=6.9e+07
 sigma[gemm] counter=140 i=5 t=2.6e-03 per=1.0e+01 cost=1.6e+05 flops=6.2e+07
 sigma[gemm] counter=140 i=6 t=2.6e-03 per=9.9e+00 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=140 i=7 t=2.6e-03 per=9.9e+00 cost=1.7e+05 flops=6.7e+07
 sigma[gemm] counter=140 total t=1.0e-02 per=4.0e+01 cost=6.7e+05 flops=6.5e+07
 sigma[red] counter=140 t=1.1e-02 per=4.1e+01 cost=1.8e+05 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.5e+00 t_reduction=1.6e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=140 t=1.3e+00 per=2.0e+01 cost=9.8e+07 flops=7.8e+07
 sigma_tot[gemm] counter=140 i=0 t=3.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=1 t=2.5e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=2 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=4 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=140 i=5 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=140 i=6 t=8.5e-01 per=1.4e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=140 i=7 t=8.5e-01 per=1.3e+01 cost=1.8e+07 flops=2.1e+07
 sigma_tot[gemm] counter=140 total t=3.5e+00 per=5.5e+01 cost=7.1e+07 flops=2.0e+07
 sigma_tot[red] counter=140 t=1.6e+00 per=2.5e+01 cost=1.7e+07 flops=1.1e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.4e-05,3.2e-06,1.4e-06,2.3e-07
    7   0 +    -116.327525813352 -1.673e-07  7.757e-05    3     7  2.834e-01 4.049e-02 2.814e-02
TIMING FOR Davidson : 2.834e-01  T(cal/comm/rest)=1.970e-01,1.368e-06,8.644e-02
decomposed t_rest=8.644e-02
 T(sub)    =2.430e-04 per=2.811e-01
 T(precond)=8.594e-02 per=9.941e+01
 T(ortho)  =3.134e-05 per=3.625e-02
 T(xcopy)  =1.433e-06 per=1.658e-03
 T(xnrm2)  =4.389e-06 per=5.077e-03
 T(other)  =2.287e-04 per=2.645e-01
optimized energies: isweep=0 ibond=22 dots=2 e[0]=-116.327525813352 nmvp=7
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=9.872e-03 change=5.303e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=12 dimAll=40
 (9,3):8 (8,2):3 (8,4):3 (7,3):1 (10,2):7 (9,1):3 (11,3):4 (10,4):5 (12,2):1 (11,1):2 (9,5):2 (10,0):1
timing for divide=9.8e-05
timing for compute=6.4e-03
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(su2): 6.5e-03 S T(divide/compute[cpu/gpu/rest]/collect)=9.8e-05,6.4e-03,0.0e+00,6.2e-06,2.0e-05 -----
decimation summary: 40->10 dwt=+7.384e-04 SvN=7.675e-01
 qbond: qkept nsym=5 dimAll=10
 (10,2):3 (11,3):3 (10,4):2 (9,3):1 (12,2):1
----- TIMING for decimation_row(nkr): 6.952e-03 S T(decim/select/formRot)=6.538e-03,3.153e-04,9.900e-05 -----
----- TIMING FOR twodot_decimation: 7.991e-03 S T(wf/decim)=9.220e-04,7.069e-03 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=2500:1.907e-02MB:1.863e-05GB
        per(mem): H:0.96 C:6.44 S:12 A:13.4 B:67.2 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=9.857e-03 change=2.619e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=126 : 3.648e-03 S -----
rank=0 GPUmem(GB): used=7.747e-05 (oper)=3.961e-05
rank=0 GPUmem(GB): used=7.786e-05 (oper,site)=3.961e-05,3.874e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=126
 no. of rintermediate operators=122
 no. of coefficients=1899:1.449e-02MB:1.415e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.479e-03 S -----
rank=0 GPUmem(GB): used=9.201e-05 (oper,site,rinter)=3.961e-05,3.874e-07,1.415e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.389e-02 S size(rtasks)=126 size(Rlst2)=25 T(Rmu/Rlist)=8.324e-04,3.306e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.416e-02 S size(rtasks)=126 size(Rlst)=2748 -----
rank=0 GPUmem(GB): used=9.201e-05 avail=6.174e+00 total=6.174e+00 batch[need]=5.733e-04 blksize=9 blksize0=9 batchsize=2748
rank=0 GPUmem(GB): used=6.653e-04 (oper,site,rinter,batch)=3.961e-05,3.874e-07,1.415e-05,5.733e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.783e-03,2.286e-02,1.003e-02
----- TIMING FOR renorm : t_inter=6.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=23 t=6.8e-03 per=1.7e+01 cost=1.6e+05 flops=2.3e+07
 renorm[gemm] counter=23 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=2 t=7.7e-03 per=1.9e+01 cost=1.9e+04 flops=2.5e+06
 renorm[gemm] counter=23 i=3 t=7.6e-03 per=1.9e+01 cost=3.2e+04 flops=4.2e+06
 renorm[gemm] counter=23 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=6 t=7.6e-03 per=1.9e+01 cost=5.2e+04 flops=6.9e+06
 renorm[gemm] counter=23 total t=2.3e-02 per=5.8e+01 cost=1.0e+05 flops=4.5e+06
 renorm[red] counter=23 t=1.0e-02 per=2.5e+01 cost=2.6e+04 flops=2.6e+06
----- TIMING FOR renorm_tot : t_inter=1.3e-01 t_gemm=5.2e-01 t_reduction=2.3e-01 tot=8.8e-01 -----
 renorm_tot[inter] counter=23 t=1.3e-01 per=1.5e+01 cost=1.9e+06 flops=1.4e+07
 renorm_tot[gemm] counter=23 i=0 t=3.4e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=1 t=2.9e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=2 t=4.5e-02 per=5.1e+00 cost=8.7e+04 flops=1.9e+06
 renorm_tot[gemm] counter=23 i=3 t=4.5e-02 per=5.1e+00 cost=1.1e+05 flops=2.4e+06
 renorm_tot[gemm] counter=23 i=4 t=1.3e-01 per=1.4e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=23 i=5 t=1.3e-01 per=1.4e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=23 i=6 t=1.7e-01 per=2.0e+01 cost=1.2e+06 flops=6.7e+06
 renorm_tot[gemm] counter=23 total t=5.2e-01 per=5.9e+01 cost=2.1e+06 flops=4.0e+06
 renorm_tot[red] counter=23 t=2.3e-01 per=2.6e+01 cost=5.2e+05 flops=2.3e+06
qops.to_cpu: size(tot)=2500:1.9e-02MB:1.9e-05GB T(to_cpu)=1.4e-04S speed=1.3e-01GB/S
check ||H-H.dagger||=1.256e-14 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.105 S rank=0 -----
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.035e-02 change=8.655e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.094e-02 change=-2.113e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.094e-02 change=-4.172e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.443e+00 S #####
 T(local opt: fetch) = 1.280e-02 S  per = 0.887  per(accum) = 0.887
 T(local opt: hdiag) = 3.983e-01 S  per = 27.6  per(accum) = 28.5
 T(local opt: dvdsn) = 9.134e-01 S  per = 63.3  per(accum) = 91.8
 T(local opt: decim) = 8.014e-03 S  per = 0.555  per(accum) = 92.4
 T(local opt: guess) = 1.249e-03 S  per = 0.0865  per(accum) = 92.4
 T(local opt: renrm) = 1.087e-01 S  per = 7.54  per(accum) = 100
 T(local opt: save ) = 3.351e-04 S  per = 0.0232  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.134e-01 S  T(sum) = 9.122e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 5.905e-03 S  per = 0.647  per(accum) = 0.647
 T(local opt: symbolic_formulae           ) = 8.107e-03 S  per = 0.889  per(accum) = 1.54
 T(local opt: hintermediate init          ) = 2.990e-04 S  per = 0.0328  per(accum) = 1.57
 T(local opt: preprocess_hformulae_Hxlist ) = 3.949e-01 S  per = 43.3  per(accum) = 44.9
 T(local opt: hmmtasks init               ) = 2.178e-01 S  per = 23.9  per(accum) = 68.7
 T(local opt: initial guess for dvdson    ) = 1.743e-03 S  per = 0.191  per(accum) = 68.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.845e-01 S  per = 20.2  per(accum) = 89.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.248e-02 S  per = 1.37  per(accum) = 90.5
 T(local opt: dvdson [nccl]               ) = 4.801e-05 S  per = 0.00526  per(accum) = 90.5
 T(local opt: dvdson [mpi]                ) = 1.368e-06 S  per = 0.00015  per(accum) = 90.5
 T(local opt: dvdson [rest part(linalg)]  ) = 8.644e-02 S  per = 9.48  per(accum) = 100
Detailed decomposition of T(renrm) = 1.087e-01 S  T(sum) = 1.087e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.788e-04 S  per = 0.348  per(accum) = 0.348
 T(local opt: qops init                    ) = 4.375e-03 S  per = 4.02  per(accum) = 4.37
 T(local opt: symbolic_formulae_renorm     ) = 3.661e-03 S  per = 3.37  per(accum) = 7.74
 T(local opt: allocate qops on gpu         ) = 5.559e-05 S  per = 0.0511  per(accum) = 7.79
 T(local opt: site memcpy cpu2gpu          ) = 2.191e-03 S  per = 2.01  per(accum) = 9.8
 T(local opt: rintermediate init           ) = 2.489e-03 S  per = 2.29  per(accum) = 12.1
 T(local opt: preprocess_formulae_Rlist2   ) = 3.427e-02 S  per = 31.5  per(accum) = 43.6
 T(local opt: rmmtasks init                ) = 1.736e-02 S  per =   16  per(accum) = 59.6
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 3.03e-05  per(accum) = 59.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.977e-02 S  per = 36.6  per(accum) = 96.1
 T(local opt: deallocate cpu and gpu memory) = 1.325e-04 S  per = 0.122  per(accum) = 96.3
 T(local opt: construct opS [ifdists=true] ) = 1.010e-07 S  per = 9.29e-05  per(accum) = 96.3
 T(local opt: reduction of opS & opH [nccl]) = 4.400e-08 S  per = 4.05e-05  per(accum) = 96.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.519e-04 S  per = 0.14  per(accum) = 96.4
 T(local opt: reduction of opS & opH [mpi] ) = 5.970e-05 S  per = 0.0549  per(accum) = 96.5
 T(local opt: qops_pool join and erase     ) = 3.845e-03 S  per = 3.54  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.904e-06 S  per = 0.00911  per(accum) = 100
##### sweep opt: 2.809e+01 S #####
 T(sweep opt: fetch) = 3.311e-01 S  per = 1.18  per(accum) = 1.18
 T(sweep opt: hdiag) = 1.006e+01 S  per = 35.8  per(accum) = 37
 T(sweep opt: dvdsn) = 1.510e+01 S  per = 53.8  per(accum) = 90.7
 T(sweep opt: decim) = 3.114e-01 S  per = 1.11  per(accum) = 91.9
 T(sweep opt: guess) = 2.796e-02 S  per = 0.0995  per(accum) = 92
 T(sweep opt: renrm) = 2.253e+00 S  per = 8.02  per(accum) = 100
 T(sweep opt: save ) = 7.519e-03 S  per = 0.0268  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.510e+01 S  T(sum) = 1.508e+01 S  per = 9.982e+01
 T(sweep opt: preprocess                  ) = 1.179e-01 S  per = 0.782  per(accum) = 0.782
 T(sweep opt: symbolic_formulae           ) = 1.520e-01 S  per = 1.01  per(accum) = 1.79
 T(sweep opt: hintermediate init          ) = 5.839e-03 S  per = 0.0387  per(accum) = 1.83
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.762e+00 S  per = 31.6  per(accum) = 33.4
 T(sweep opt: hmmtasks init               ) = 1.996e+00 S  per = 13.2  per(accum) = 46.7
 T(sweep opt: initial guess for dvdson    ) = 3.332e-02 S  per = 0.221  per(accum) = 46.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.337e+00 S  per =   42  per(accum) = 88.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.911e-01 S  per = 1.27  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 1.006e-03 S  per = 0.00667  per(accum) = 90.2
 T(sweep opt: dvdson [mpi]                ) = 2.295e-05 S  per = 0.000152  per(accum) = 90.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.479e+00 S  per = 9.81  per(accum) = 100
Detailed decomposition of T(renrm) = 2.253e+00 S  T(sum) = 2.253e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.277e-03 S  per = 0.323  per(accum) = 0.323
 T(sweep opt: qops init                    ) = 7.923e-02 S  per = 3.52  per(accum) = 3.84
 T(sweep opt: symbolic_formulae_renorm     ) = 8.608e-02 S  per = 3.82  per(accum) = 7.66
 T(sweep opt: allocate qops on gpu         ) = 3.408e-03 S  per = 0.151  per(accum) = 7.81
 T(sweep opt: site memcpy cpu2gpu          ) = 3.001e-02 S  per = 1.33  per(accum) = 9.15
 T(sweep opt: rintermediate init           ) = 5.543e-02 S  per = 2.46  per(accum) = 11.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.603e-01 S  per = 29.3  per(accum) = 40.9
 T(sweep opt: rmmtasks init                ) = 3.366e-01 S  per = 14.9  per(accum) = 55.9
 T(sweep opt: qops memset on cpu           ) = 9.120e-07 S  per = 4.05e-05  per(accum) = 55.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.863e-01 S  per = 39.3  per(accum) = 95.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.801e-03 S  per = 0.124  per(accum) = 95.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.239e-06 S  per = 5.5e-05  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [nccl]) = 9.300e-07 S  per = 4.13e-05  per(accum) = 95.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.653e-03 S  per = 0.118  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.227e-03 S  per = 0.0545  per(accum) = 95.5
 T(sweep opt: qops_pool join and erase     ) = 6.874e-02 S  per = 3.05  per(accum) = 98.6
 T(sweep opt: conversion from opAB to opPQ ) = 3.248e-02 S  per = 1.44  per(accum) = 100
##### global opt: 2.809e+01 S #####
 T(global opt: fetch) = 3.311e-01 S  per = 1.18  per(accum) = 1.18
 T(global opt: hdiag) = 1.006e+01 S  per = 35.8  per(accum) = 37
 T(global opt: dvdsn) = 1.510e+01 S  per = 53.8  per(accum) = 90.7
 T(global opt: decim) = 3.114e-01 S  per = 1.11  per(accum) = 91.9
 T(global opt: guess) = 2.796e-02 S  per = 0.0995  per(accum) = 92
 T(global opt: renrm) = 2.253e+00 S  per = 8.02  per(accum) = 100
 T(global opt: save ) = 7.519e-03 S  per = 0.0268  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.510e+01 S  T(sum) = 1.508e+01 S  per = 9.982e+01
 T(global opt: preprocess                  ) = 1.179e-01 S  per = 0.782  per(accum) = 0.782
 T(global opt: symbolic_formulae           ) = 1.520e-01 S  per = 1.01  per(accum) = 1.79
 T(global opt: hintermediate init          ) = 5.839e-03 S  per = 0.0387  per(accum) = 1.83
 T(global opt: preprocess_hformulae_Hxlist ) = 4.762e+00 S  per = 31.6  per(accum) = 33.4
 T(global opt: hmmtasks init               ) = 1.996e+00 S  per = 13.2  per(accum) = 46.7
 T(global opt: initial guess for dvdson    ) = 3.332e-02 S  per = 0.221  per(accum) = 46.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.337e+00 S  per =   42  per(accum) = 88.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.911e-01 S  per = 1.27  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 1.006e-03 S  per = 0.00667  per(accum) = 90.2
 T(global opt: dvdson [mpi]                ) = 2.295e-05 S  per = 0.000152  per(accum) = 90.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.479e+00 S  per = 9.81  per(accum) = 100
Detailed decomposition of T(renrm) = 2.253e+00 S  T(sum) = 2.253e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.277e-03 S  per = 0.323  per(accum) = 0.323
 T(global opt: qops init                    ) = 7.923e-02 S  per = 3.52  per(accum) = 3.84
 T(global opt: symbolic_formulae_renorm     ) = 8.608e-02 S  per = 3.82  per(accum) = 7.66
 T(global opt: allocate qops on gpu         ) = 3.408e-03 S  per = 0.151  per(accum) = 7.81
 T(global opt: site memcpy cpu2gpu          ) = 3.001e-02 S  per = 1.33  per(accum) = 9.15
 T(global opt: rintermediate init           ) = 5.543e-02 S  per = 2.46  per(accum) = 11.6
 T(global opt: preprocess_formulae_Rlist2   ) = 6.603e-01 S  per = 29.3  per(accum) = 40.9
 T(global opt: rmmtasks init                ) = 3.366e-01 S  per = 14.9  per(accum) = 55.9
 T(global opt: qops memset on cpu           ) = 9.120e-07 S  per = 4.05e-05  per(accum) = 55.9
 T(global opt: preprocess_renorm_batchGPU   ) = 8.863e-01 S  per = 39.3  per(accum) = 95.2
 T(global opt: deallocate cpu and gpu memory) = 2.801e-03 S  per = 0.124  per(accum) = 95.3
 T(global opt: construct opS [ifdists=true] ) = 1.239e-06 S  per = 5.5e-05  per(accum) = 95.3
 T(global opt: reduction of opS & opH [nccl]) = 9.300e-07 S  per = 4.13e-05  per(accum) = 95.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.653e-03 S  per = 0.118  per(accum) = 95.5
 T(global opt: reduction of opS & opH [mpi] ) = 1.227e-03 S  per = 0.0545  per(accum) = 95.5
 T(global opt: qops_pool join and erase     ) = 6.874e-02 S  per = 3.05  per(accum) = 98.6
 T(global opt: conversion from opAB to opPQ ) = 3.248e-02 S  per = 1.44  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-5.242e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=23/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=762:5.814e-03MB:5.677e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=60:4.578e-04MB:4.470e-07GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=4935:3.765e-02MB:3.677e-05GB
        per(mem): H:0.689 C:3.57 S:2.92 P:1.64 Q:91.2 
 rqops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=36:0.000275MB size(tot)=2500:0.0191MB:1.86e-05GB
        per(mem): H:0.96 C:6.44 S:12 A:13.4 B:67.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=9431:0.072MB:7.03e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.111e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-3.773e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=118:9.003e-04MB
qtensor4: wf4 own=1 _data=0x3a4f7400
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
 qbond: qcol nsym=5 dimAll=10
 (10,2):3 (11,3):3 (10,4):2 (9,3):1 (12,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=25 nblocks=320 size=118:9.003e-04MB
### DIAG TIMING: total=8.255e-01 t1=2.723e-05, t2=1.531e-03, t3=2.495e-03, t4=8.214e-01, t5=3.132e-05, t6=2.856e-05, t7=2.889e-05
duration_diagGPU:8.256e-01
duration_diagreduce:2.290e-07
duration_diagtransform:1.485e-06
----- TIMING FOR symbolic_formulae_twodot with size=704 : 2.275e-02 S -----
rank=0 GPUmem(GB): used=7.027e-05 (oper)=7.027e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=704
 no. of hintermediate operators=333
 no. of coefficients=4876:3.720e-02MB:3.633e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.004e-04 S -----
rank=0 GPUmem(GB): used=1.066e-04 (oper,hinter)=7.027e-05,3.633e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.828e-01 S size(H_formulae)=704 size(Hxlst2)=25 T(Hmu/Hxlist)=4.272e-03,3.785e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.862e-01 S size(H_formulae)=704 size(Hxlst)=20002 -----
rank=0 GPUmem(GB): used=1.066e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.758e-06 batch[need]=5.067e-03 blksize=12 blksize0=9 batchsize=20002
rank=0 GPUmem(GB): used=5.175e-03 (oper,hinter,dvdson,batch)=7.027e-05,3.633e-05,1.758e-06,5.067e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=118 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.337e-03,5.160e-03,2.029e-02,1.060e-02,3.841e-02
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=2.323e-03 speed=7.568e-04GB/S T(nccl)=1.328e-05 speed=1.324e-01GB/S
----- TIMING FOR sigma : t_inter=5.2e-03 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=3.6e-02 -----
 sigma[inter] counter=141 t=5.2e-03 per=1.4e+01 cost=1.2e+06 flops=2.3e+08
 sigma[gemm] counter=141 i=0 t=1.5e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=2 t=1.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=3 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=4 t=2.6e-03 per=7.1e+00 cost=2.2e+05 flops=8.5e+07
 sigma[gemm] counter=141 i=5 t=2.7e-03 per=7.4e+00 cost=2.0e+05 flops=7.7e+07
 sigma[gemm] counter=141 i=6 t=7.5e-03 per=2.1e+01 cost=1.7e+05 flops=2.2e+07
 sigma[gemm] counter=141 i=7 t=7.5e-03 per=2.1e+01 cost=1.8e+05 flops=2.4e+07
 sigma[gemm] counter=141 total t=2.0e-02 per=5.6e+01 cost=7.7e+05 flops=3.8e+07
 sigma[red] counter=141 t=1.1e-02 per=2.9e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.5e+00 t_reduction=1.6e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=141 t=1.3e+00 per=2.0e+01 cost=9.9e+07 flops=7.9e+07
 sigma_tot[gemm] counter=141 i=0 t=3.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=1 t=2.5e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=2 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=4 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=141 i=5 t=9.1e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=141 i=6 t=8.6e-01 per=1.4e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=141 i=7 t=8.5e-01 per=1.3e+01 cost=1.8e+07 flops=2.1e+07
 sigma_tot[gemm] counter=141 total t=3.5e+00 per=5.5e+01 cost=7.2e+07 flops=2.0e+07
 sigma_tot[red] counter=141 t=1.6e+00 per=2.5e+01 cost=1.8e+07 flops=1.1e+07
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.5e-05,7.6e-06,2.9e-06,7.5e-07
settings: ndim=118 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.327207159735 -1.116e+03  3.081e-02    1     1  3.889e-02 3.889e-02 3.881e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.950e-03,5.142e-03,2.019e-02,1.066e-02,3.796e-02
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=1.944e-03 speed=9.046e-04GB/S T(nccl)=6.188e-06 speed=2.842e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=3.6e-02 -----
 sigma[inter] counter=142 t=5.1e-03 per=1.4e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=142 i=0 t=1.8e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=1 t=1.4e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=2 t=1.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=3 t=1.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=4 t=2.5e-03 per=7.0e+00 cost=2.2e+05 flops=8.7e+07
 sigma[gemm] counter=142 i=5 t=2.6e-03 per=7.2e+00 cost=2.0e+05 flops=7.8e+07
 sigma[gemm] counter=142 i=6 t=7.6e-03 per=2.1e+01 cost=1.7e+05 flops=2.2e+07
 sigma[gemm] counter=142 i=7 t=7.5e-03 per=2.1e+01 cost=1.8e+05 flops=2.5e+07
 sigma[gemm] counter=142 total t=2.0e-02 per=5.6e+01 cost=7.7e+05 flops=3.8e+07
 sigma[red] counter=142 t=1.1e-02 per=3.0e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.5e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=142 t=1.3e+00 per=2.0e+01 cost=1.0e+08 flops=7.9e+07
 sigma_tot[gemm] counter=142 i=0 t=3.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=1 t=2.5e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=2 t=2.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=4 t=9.0e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=142 i=5 t=9.1e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=142 i=6 t=8.7e-01 per=1.4e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=142 i=7 t=8.6e-01 per=1.3e+01 cost=1.8e+07 flops=2.1e+07
 sigma_tot[gemm] counter=142 total t=3.5e+00 per=5.5e+01 cost=7.2e+07 flops=2.0e+07
 sigma_tot[red] counter=142 t=1.6e+00 per=2.5e+01 cost=1.8e+07 flops=1.1e+07
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=8.2e-06,2.4e-05,3.5e-06,1.2e-06,2.1e-07
    2   0 -    -116.329431037463 -2.224e-03  1.179e-02    2     2  9.165e-02 4.582e-02 3.845e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.491e-03,5.003e-03,2.026e-02,1.073e-02,3.748e-02
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=1.486e-03 speed=1.183e-03GB/S T(nccl)=5.045e-06 speed=3.485e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=3.6e-02 -----
 sigma[inter] counter=143 t=5.0e-03 per=1.4e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=143 i=0 t=1.8e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=1 t=1.6e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=2 t=1.5e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=3 t=1.5e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=4 t=2.5e-03 per=7.0e+00 cost=2.2e+05 flops=8.8e+07
 sigma[gemm] counter=143 i=5 t=2.6e-03 per=7.1e+00 cost=2.0e+05 flops=7.9e+07
 sigma[gemm] counter=143 i=6 t=7.5e-03 per=2.1e+01 cost=1.7e+05 flops=2.2e+07
 sigma[gemm] counter=143 i=7 t=7.7e-03 per=2.1e+01 cost=1.8e+05 flops=2.4e+07
 sigma[gemm] counter=143 total t=2.0e-02 per=5.6e+01 cost=7.7e+05 flops=3.8e+07
 sigma[red] counter=143 t=1.1e-02 per=3.0e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.6e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=143 t=1.3e+00 per=2.0e+01 cost=1.0e+08 flops=8.0e+07
 sigma_tot[gemm] counter=143 i=0 t=3.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=1 t=2.5e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=2 t=2.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=4 t=9.1e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=143 i=5 t=9.1e-01 per=1.4e+01 cost=1.9e+07 flops=2.0e+07
 sigma_tot[gemm] counter=143 i=6 t=8.7e-01 per=1.4e+01 cost=1.7e+07 flops=2.0e+07
 sigma_tot[gemm] counter=143 i=7 t=8.7e-01 per=1.4e+01 cost=1.8e+07 flops=2.1e+07
 sigma_tot[gemm] counter=143 total t=3.6e+00 per=5.5e+01 cost=7.3e+07 flops=2.1e+07
 sigma_tot[red] counter=143 t=1.6e+00 per=2.5e+01 cost=1.8e+07 flops=1.1e+07
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.7e-05,3.0e-06,1.5e-06,2.4e-07
    3   0 -    -116.329868692264 -4.377e-04  5.326e-03    3     3  1.427e-01 4.756e-02 3.816e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.249e-03,5.092e-03,2.036e-02,1.071e-02,3.742e-02
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=1.244e-03 speed=1.413e-03GB/S T(nccl)=4.741e-06 speed=3.709e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=2.0e-02 t_reduction=1.1e-02 tot=3.6e-02 -----
 sigma[inter] counter=144 t=5.1e-03 per=1.4e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=144 i=0 t=1.7e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=1 t=1.5e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=2 t=1.5e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=3 t=1.5e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=4 t=2.6e-03 per=7.1e+00 cost=2.2e+05 flops=8.6e+07
 sigma[gemm] counter=144 i=5 t=2.6e-03 per=7.2e+00 cost=2.0e+05 flops=7.8e+07
 sigma[gemm] counter=144 i=6 t=7.5e-03 per=2.1e+01 cost=1.7e+05 flops=2.2e+07
 sigma[gemm] counter=144 i=7 t=7.7e-03 per=2.1e+01 cost=1.8e+05 flops=2.4e+07
 sigma[gemm] counter=144 total t=2.0e-02 per=5.6e+01 cost=7.7e+05 flops=3.8e+07
 sigma[red] counter=144 t=1.1e-02 per=3.0e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.6e+00 t_reduction=1.6e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=144 t=1.3e+00 per=2.0e+01 cost=1.0e+08 flops=8.1e+07
 sigma_tot[gemm] counter=144 i=0 t=3.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=1 t=2.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=2 t=2.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=4 t=9.1e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=144 i=5 t=9.1e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=144 i=6 t=8.8e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=144 i=7 t=8.8e-01 per=1.4e+01 cost=1.8e+07 flops=2.1e+07
 sigma_tot[gemm] counter=144 total t=3.6e+00 per=5.5e+01 cost=7.4e+07 flops=2.1e+07
 sigma_tot[red] counter=144 t=1.6e+00 per=2.5e+01 cost=1.8e+07 flops=1.1e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.4e-05,3.0e-06,1.4e-06,2.3e-07
    4   0 -    -116.329961643364 -9.295e-05  2.485e-03    3     4  1.897e-01 4.743e-02 3.800e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.170e-03,5.041e-03,2.036e-02,2.524e-03,2.911e-02
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=1.165e-03 speed=1.510e-03GB/S T(nccl)=4.833e-06 speed=3.638e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=2.0e-02 t_reduction=2.5e-03 tot=2.8e-02 -----
 sigma[inter] counter=145 t=5.0e-03 per=1.8e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=145 i=0 t=1.7e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=1 t=1.5e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=2 t=1.5e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=3 t=1.5e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=4 t=2.5e-03 per=9.1e+00 cost=2.2e+05 flops=8.6e+07
 sigma[gemm] counter=145 i=5 t=2.6e-03 per=9.4e+00 cost=2.0e+05 flops=7.8e+07
 sigma[gemm] counter=145 i=6 t=7.6e-03 per=2.7e+01 cost=1.7e+05 flops=2.2e+07
 sigma[gemm] counter=145 i=7 t=7.6e-03 per=2.7e+01 cost=1.8e+05 flops=2.4e+07
 sigma[gemm] counter=145 total t=2.0e-02 per=7.3e+01 cost=7.7e+05 flops=3.8e+07
 sigma[red] counter=145 t=2.5e-03 per=9.0e+00 cost=2.0e+05 flops=7.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.6e+00 t_reduction=1.6e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=145 t=1.3e+00 per=2.0e+01 cost=1.0e+08 flops=8.1e+07
 sigma_tot[gemm] counter=145 i=0 t=3.0e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=1 t=2.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=2 t=2.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=4 t=9.1e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=145 i=5 t=9.2e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=145 i=6 t=8.9e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=145 i=7 t=8.8e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=145 total t=3.6e+00 per=5.6e+01 cost=7.5e+07 flops=2.1e+07
 sigma_tot[red] counter=145 t=1.6e+00 per=2.5e+01 cost=1.8e+07 flops=1.1e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,3.0e-06,1.3e-06,2.2e-07
    5   0 -    -116.329978641602 -1.700e-05  7.597e-04    3     5  2.285e-01 4.570e-02 3.625e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.831e-04,5.103e-03,2.029e-02,1.044e-02,3.683e-02
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=9.779e-04 speed=1.798e-03GB/S T(nccl)=5.287e-06 speed=3.326e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=2.0e-02 t_reduction=1.0e-02 tot=3.6e-02 -----
 sigma[inter] counter=146 t=5.1e-03 per=1.4e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=146 i=0 t=1.7e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=1 t=1.5e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=2 t=1.5e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=3 t=1.5e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=4 t=2.6e-03 per=7.1e+00 cost=2.2e+05 flops=8.6e+07
 sigma[gemm] counter=146 i=5 t=2.6e-03 per=7.2e+00 cost=2.0e+05 flops=7.9e+07
 sigma[gemm] counter=146 i=6 t=7.6e-03 per=2.1e+01 cost=1.7e+05 flops=2.2e+07
 sigma[gemm] counter=146 i=7 t=7.6e-03 per=2.1e+01 cost=1.8e+05 flops=2.4e+07
 sigma[gemm] counter=146 total t=2.0e-02 per=5.7e+01 cost=7.7e+05 flops=3.8e+07
 sigma[red] counter=146 t=1.0e-02 per=2.9e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.6e+00 t_reduction=1.6e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=146 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.2e+07
 sigma_tot[gemm] counter=146 i=0 t=3.1e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=1 t=2.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=2 t=2.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=4 t=9.1e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=146 i=5 t=9.2e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=146 i=6 t=9.0e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=146 i=7 t=8.9e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=146 total t=3.6e+00 per=5.6e+01 cost=7.5e+07 flops=2.1e+07
 sigma_tot[red] counter=146 t=1.6e+00 per=2.5e+01 cost=1.9e+07 flops=1.2e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.3e-05,3.0e-06,1.2e-06,2.1e-07
    6   0 -    -116.329980035776 -1.394e-06  2.286e-04    3     6  2.773e-01 4.621e-02 3.636e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.548e-04,5.001e-03,2.411e-02,1.053e-02,4.021e-02
 analyze_tgpu[Hx]: ndim=118:8.792e-07GB T(cpu-gpu)=5.459e-04 speed=3.221e-03GB/S T(nccl)=8.827e-06 speed=1.992e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=2.4e-02 t_reduction=1.1e-02 tot=4.0e-02 -----
 sigma[inter] counter=147 t=5.0e-03 per=1.3e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=147 i=0 t=1.7e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=1 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=2 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=3 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=4 t=2.5e-03 per=6.2e+00 cost=2.2e+05 flops=8.9e+07
 sigma[gemm] counter=147 i=5 t=4.7e-03 per=1.2e+01 cost=2.0e+05 flops=4.4e+07
 sigma[gemm] counter=147 i=6 t=9.5e-03 per=2.4e+01 cost=1.7e+05 flops=1.8e+07
 sigma[gemm] counter=147 i=7 t=7.5e-03 per=1.9e+01 cost=1.8e+05 flops=2.5e+07
 sigma[gemm] counter=147 total t=2.4e-02 per=6.1e+01 cost=7.7e+05 flops=3.2e+07
 sigma[red] counter=147 t=1.1e-02 per=2.7e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.6e+00 t_reduction=1.6e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=147 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.2e+07
 sigma_tot[gemm] counter=147 i=0 t=3.1e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=1 t=2.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=2 t=2.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=3 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=4 t=9.2e-01 per=1.4e+01 cost=2.0e+07 flops=2.1e+07
 sigma_tot[gemm] counter=147 i=5 t=9.2e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=147 i=6 t=9.1e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=147 i=7 t=9.0e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=147 total t=3.6e+00 per=5.6e+01 cost=7.6e+07 flops=2.1e+07
 sigma_tot[red] counter=147 t=1.6e+00 per=2.5e+01 cost=1.9e+07 flops=1.2e+07
T(sub)=8.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,5.1e-05,8.8e-06,1.0e-05,5.4e-07
    7   0 +    -116.329980164893 -1.291e-07  8.649e-05    3     7  3.301e-01 4.716e-02 3.695e-02
TIMING FOR Davidson : 3.302e-01  T(cal/comm/rest)=2.586e-01,1.735e-06,7.153e-02
decomposed t_rest=7.153e-02
 T(sub)    =2.574e-04 per=3.599e-01
 T(precond)=7.102e-02 per=9.929e+01
 T(ortho)  =2.822e-05 per=3.945e-02
 T(xcopy)  =4.020e-06 per=5.620e-03
 T(xnrm2)  =9.453e-06 per=1.322e-02
 T(other)  =2.103e-04 per=2.940e-01
optimized energies: isweep=0 ibond=23 dots=2 e[0]=-116.329980164893 nmvp=7
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=9.056e-03 change=5.173e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=11 dimAll=40
 (10,2):4 (11,3):9 (10,4):3 (9,3):1 (12,2):7 (13,3):4 (12,4):5 (14,2):1 (11,1):3 (11,5):2 (13,1):1
timing for divide=2.0e-04
timing for compute=2.0e-02
timing for collect=3.0e-05
----- TMING FOR decimation_genbasis(su2): 2.0e-02 S T(divide/compute[cpu/gpu/rest]/collect)=2.0e-04,2.0e-02,0.0e+00,1.7e-05,3.0e-05 -----
decimation summary: 40->10 dwt=+3.719e-03 SvN=1.041e+00
 qbond: qkept nsym=5 dimAll=10
 (12,2):4 (12,4):3 (11,3):1 (13,3):1 (14,2):1
----- TIMING for decimation_row(nkr): 2.084e-02 S T(decim/select/formRot)=2.036e-02,3.556e-04,1.184e-04 -----
----- TIMING FOR twodot_decimation: 2.281e-02 S T(wf/decim)=1.839e-03,2.097e-02 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=52:3.967e-04MB size(tot)=3612:2.756e-02MB:2.691e-05GB
        per(mem): H:0.775 C:3.32 S:4.98 A:11.2 B:79.7 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=9.041e-03 change=3.237e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=157 : 5.216e-03 S -----
rank=0 GPUmem(GB): used=9.674e-05 (oper)=5.297e-05
rank=0 GPUmem(GB): used=9.716e-05 (oper,site)=5.297e-05,4.247e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=157
 no. of rintermediate operators=113
 no. of coefficients=2324:1.773e-02MB:1.732e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.512e-03 S -----
rank=0 GPUmem(GB): used=1.145e-04 (oper,site,rinter)=5.297e-05,4.247e-07,1.732e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.918e-02 S size(rtasks)=157 size(Rlst2)=25 T(Rmu/Rlist)=1.228e-03,3.795e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.001e-02 S size(rtasks)=157 size(Rlst)=2612 -----
rank=0 GPUmem(GB): used=1.145e-04 avail=6.174e+00 total=6.174e+00 batch[need]=8.174e-04 blksize=16 blksize0=9 batchsize=2612
rank=0 GPUmem(GB): used=9.318e-04 (oper,site,rinter,batch)=5.297e-05,4.247e-07,1.732e-05,8.174e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.570e-03,2.269e-02,1.009e-02
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=24 t=6.6e-03 per=1.7e+01 cost=2.1e+05 flops=3.2e+07
 renorm[gemm] counter=24 i=0 t=1.6e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=1 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=2 t=7.5e-03 per=1.9e+01 cost=2.1e+04 flops=2.9e+06
 renorm[gemm] counter=24 i=3 t=7.6e-03 per=1.9e+01 cost=4.3e+04 flops=5.7e+06
 renorm[gemm] counter=24 i=4 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=5 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=6 t=7.6e-03 per=1.9e+01 cost=5.9e+04 flops=7.7e+06
 renorm[gemm] counter=24 total t=2.3e-02 per=5.8e+01 cost=1.2e+05 flops=5.4e+06
 renorm[red] counter=24 t=1.0e-02 per=2.6e+01 cost=2.4e+04 flops=2.4e+06
----- TIMING FOR renorm_tot : t_inter=1.4e-01 t_gemm=5.4e-01 t_reduction=2.4e-01 tot=9.2e-01 -----
 renorm_tot[inter] counter=24 t=1.4e-01 per=1.5e+01 cost=2.1e+06 flops=1.5e+07
 renorm_tot[gemm] counter=24 i=0 t=3.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=1 t=3.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=2 t=5.3e-02 per=5.7e+00 cost=1.1e+05 flops=2.1e+06
 renorm_tot[gemm] counter=24 i=3 t=5.3e-02 per=5.7e+00 cost=1.5e+05 flops=2.9e+06
 renorm_tot[gemm] counter=24 i=4 t=1.3e-01 per=1.4e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=24 i=5 t=1.3e-01 per=1.4e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=24 i=6 t=1.8e-01 per=2.0e+01 cost=1.2e+06 flops=6.7e+06
 renorm_tot[gemm] counter=24 total t=5.4e-01 per=5.9e+01 cost=2.2e+06 flops=4.1e+06
 renorm_tot[red] counter=24 t=2.4e-01 per=2.6e+01 cost=5.5e+05 flops=2.3e+06
qops.to_cpu: size(tot)=3612:2.8e-02MB:2.7e-05GB T(to_cpu)=1.8e-04S speed=1.5e-01GB/S
check ||H-H.dagger||=6.249e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.117 S rank=0 -----
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=7.950e-03 change=8.749e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.054e-02 change=-2.159e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.054e-02 change=-3.979e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.897e+00 S #####
 T(local opt: fetch) = 1.463e-02 S  per = 0.771  per(accum) = 0.771
 T(local opt: hdiag) = 8.262e-01 S  per = 43.5  per(accum) = 44.3
 T(local opt: dvdsn) = 9.102e-01 S  per =   48  per(accum) = 92.3
 T(local opt: decim) = 2.285e-02 S  per =  1.2  per(accum) = 93.5
 T(local opt: guess) = 1.488e-03 S  per = 0.0784  per(accum) = 93.6
 T(local opt: renrm) = 1.216e-01 S  per = 6.41  per(accum) = 100
 T(local opt: save ) = 3.193e-04 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.102e-01 S  T(sum) = 8.992e-01 S  per = 9.879e+01
 T(local opt: preprocess                  ) = 1.307e-02 S  per = 1.45  per(accum) = 1.45
 T(local opt: symbolic_formulae           ) = 2.278e-02 S  per = 2.53  per(accum) = 3.99
 T(local opt: hintermediate init          ) = 7.374e-04 S  per = 0.082  per(accum) = 4.07
 T(local opt: preprocess_hformulae_Hxlist ) = 3.871e-01 S  per =   43  per(accum) = 47.1
 T(local opt: hmmtasks init               ) = 1.439e-01 S  per =   16  per(accum) = 63.1
 T(local opt: initial guess for dvdson    ) = 1.445e-03 S  per = 0.161  per(accum) = 63.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.489e-01 S  per = 27.7  per(accum) = 91
 T(local opt: dvdson [cpu-gpu]            ) = 9.686e-03 S  per = 1.08  per(accum) = 92
 T(local opt: dvdson [nccl]               ) = 4.820e-05 S  per = 0.00536  per(accum) = 92
 T(local opt: dvdson [mpi]                ) = 1.735e-06 S  per = 0.000193  per(accum) = 92
 T(local opt: dvdson [rest part(linalg)]  ) = 7.153e-02 S  per = 7.96  per(accum) = 100
Detailed decomposition of T(renrm) = 1.216e-01 S  T(sum) = 1.216e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.944e-04 S  per = 0.407  per(accum) = 0.407
 T(local opt: qops init                    ) = 6.981e-03 S  per = 5.74  per(accum) = 6.15
 T(local opt: symbolic_formulae_renorm     ) = 5.232e-03 S  per =  4.3  per(accum) = 10.5
 T(local opt: allocate qops on gpu         ) = 6.434e-05 S  per = 0.0529  per(accum) = 10.5
 T(local opt: site memcpy cpu2gpu          ) = 2.234e-03 S  per = 1.84  per(accum) = 12.3
 T(local opt: rintermediate init           ) = 2.526e-03 S  per = 2.08  per(accum) = 14.4
 T(local opt: preprocess_formulae_Rlist2   ) = 4.012e-02 S  per =   33  per(accum) = 47.4
 T(local opt: rmmtasks init                ) = 1.997e-02 S  per = 16.4  per(accum) = 63.9
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 3.62e-05  per(accum) = 63.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.945e-02 S  per = 32.4  per(accum) = 96.3
 T(local opt: deallocate cpu and gpu memory) = 1.175e-04 S  per = 0.0966  per(accum) = 96.4
 T(local opt: construct opS [ifdists=true] ) = 4.800e-08 S  per = 3.95e-05  per(accum) = 96.4
 T(local opt: reduction of opS & opH [nccl]) = 4.100e-08 S  per = 3.37e-05  per(accum) = 96.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.888e-04 S  per = 0.155  per(accum) = 96.6
 T(local opt: reduction of opS & opH [mpi] ) = 6.272e-05 S  per = 0.0516  per(accum) = 96.6
 T(local opt: qops_pool join and erase     ) = 4.114e-03 S  per = 3.38  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.610e-06 S  per = 0.00791  per(accum) = 100
##### sweep opt: 2.999e+01 S #####
 T(sweep opt: fetch) = 3.457e-01 S  per = 1.15  per(accum) = 1.15
 T(sweep opt: hdiag) = 1.088e+01 S  per = 36.3  per(accum) = 37.4
 T(sweep opt: dvdsn) = 1.601e+01 S  per = 53.4  per(accum) = 90.8
 T(sweep opt: decim) = 3.342e-01 S  per = 1.11  per(accum) = 92
 T(sweep opt: guess) = 2.945e-02 S  per = 0.0982  per(accum) = 92.1
 T(sweep opt: renrm) = 2.374e+00 S  per = 7.92  per(accum) = 100
 T(sweep opt: save ) = 7.838e-03 S  per = 0.0261  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.601e+01 S  T(sum) = 1.598e+01 S  per = 9.976e+01
 T(sweep opt: preprocess                  ) = 1.310e-01 S  per = 0.82  per(accum) = 0.82
 T(sweep opt: symbolic_formulae           ) = 1.748e-01 S  per = 1.09  per(accum) = 1.91
 T(sweep opt: hintermediate init          ) = 6.576e-03 S  per = 0.0412  per(accum) = 1.95
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.149e+00 S  per = 32.2  per(accum) = 34.2
 T(sweep opt: hmmtasks init               ) = 2.140e+00 S  per = 13.4  per(accum) = 47.6
 T(sweep opt: initial guess for dvdson    ) = 3.476e-02 S  per = 0.218  per(accum) = 47.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.586e+00 S  per = 41.2  per(accum) = 89
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.008e-01 S  per = 1.26  per(accum) = 90.3
 T(sweep opt: dvdson [nccl]               ) = 1.054e-03 S  per = 0.0066  per(accum) = 90.3
 T(sweep opt: dvdson [mpi]                ) = 2.469e-05 S  per = 0.000155  per(accum) = 90.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.551e+00 S  per = 9.71  per(accum) = 100
Detailed decomposition of T(renrm) = 2.374e+00 S  T(sum) = 2.374e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.771e-03 S  per = 0.327  per(accum) = 0.327
 T(sweep opt: qops init                    ) = 8.621e-02 S  per = 3.63  per(accum) = 3.96
 T(sweep opt: symbolic_formulae_renorm     ) = 9.132e-02 S  per = 3.85  per(accum) = 7.8
 T(sweep opt: allocate qops on gpu         ) = 3.472e-03 S  per = 0.146  per(accum) = 7.95
 T(sweep opt: site memcpy cpu2gpu          ) = 3.224e-02 S  per = 1.36  per(accum) = 9.31
 T(sweep opt: rintermediate init           ) = 5.796e-02 S  per = 2.44  per(accum) = 11.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.004e-01 S  per = 29.5  per(accum) = 41.3
 T(sweep opt: rmmtasks init                ) = 3.566e-01 S  per =   15  per(accum) = 56.3
 T(sweep opt: qops memset on cpu           ) = 9.560e-07 S  per = 4.03e-05  per(accum) = 56.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.258e-01 S  per =   39  per(accum) = 95.3
 T(sweep opt: deallocate cpu and gpu memory) = 2.918e-03 S  per = 0.123  per(accum) = 95.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.287e-06 S  per = 5.42e-05  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [nccl]) = 9.710e-07 S  per = 4.09e-05  per(accum) = 95.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.842e-03 S  per = 0.12  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.289e-03 S  per = 0.0543  per(accum) = 95.6
 T(sweep opt: qops_pool join and erase     ) = 7.285e-02 S  per = 3.07  per(accum) = 98.6
 T(sweep opt: conversion from opAB to opPQ ) = 3.249e-02 S  per = 1.37  per(accum) = 100
##### global opt: 2.999e+01 S #####
 T(global opt: fetch) = 3.457e-01 S  per = 1.15  per(accum) = 1.15
 T(global opt: hdiag) = 1.088e+01 S  per = 36.3  per(accum) = 37.4
 T(global opt: dvdsn) = 1.601e+01 S  per = 53.4  per(accum) = 90.8
 T(global opt: decim) = 3.342e-01 S  per = 1.11  per(accum) = 92
 T(global opt: guess) = 2.945e-02 S  per = 0.0982  per(accum) = 92.1
 T(global opt: renrm) = 2.374e+00 S  per = 7.92  per(accum) = 100
 T(global opt: save ) = 7.838e-03 S  per = 0.0261  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.601e+01 S  T(sum) = 1.598e+01 S  per = 9.976e+01
 T(global opt: preprocess                  ) = 1.310e-01 S  per = 0.82  per(accum) = 0.82
 T(global opt: symbolic_formulae           ) = 1.748e-01 S  per = 1.09  per(accum) = 1.91
 T(global opt: hintermediate init          ) = 6.576e-03 S  per = 0.0412  per(accum) = 1.95
 T(global opt: preprocess_hformulae_Hxlist ) = 5.149e+00 S  per = 32.2  per(accum) = 34.2
 T(global opt: hmmtasks init               ) = 2.140e+00 S  per = 13.4  per(accum) = 47.6
 T(global opt: initial guess for dvdson    ) = 3.476e-02 S  per = 0.218  per(accum) = 47.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.586e+00 S  per = 41.2  per(accum) = 89
 T(global opt: dvdson [cpu-gpu]            ) = 2.008e-01 S  per = 1.26  per(accum) = 90.3
 T(global opt: dvdson [nccl]               ) = 1.054e-03 S  per = 0.0066  per(accum) = 90.3
 T(global opt: dvdson [mpi]                ) = 2.469e-05 S  per = 0.000155  per(accum) = 90.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.551e+00 S  per = 9.71  per(accum) = 100
Detailed decomposition of T(renrm) = 2.374e+00 S  T(sum) = 2.374e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.771e-03 S  per = 0.327  per(accum) = 0.327
 T(global opt: qops init                    ) = 8.621e-02 S  per = 3.63  per(accum) = 3.96
 T(global opt: symbolic_formulae_renorm     ) = 9.132e-02 S  per = 3.85  per(accum) = 7.8
 T(global opt: allocate qops on gpu         ) = 3.472e-03 S  per = 0.146  per(accum) = 7.95
 T(global opt: site memcpy cpu2gpu          ) = 3.224e-02 S  per = 1.36  per(accum) = 9.31
 T(global opt: rintermediate init           ) = 5.796e-02 S  per = 2.44  per(accum) = 11.8
 T(global opt: preprocess_formulae_Rlist2   ) = 7.004e-01 S  per = 29.5  per(accum) = 41.3
 T(global opt: rmmtasks init                ) = 3.566e-01 S  per =   15  per(accum) = 56.3
 T(global opt: qops memset on cpu           ) = 9.560e-07 S  per = 4.03e-05  per(accum) = 56.3
 T(global opt: preprocess_renorm_batchGPU   ) = 9.258e-01 S  per =   39  per(accum) = 95.3
 T(global opt: deallocate cpu and gpu memory) = 2.918e-03 S  per = 0.123  per(accum) = 95.4
 T(global opt: construct opS [ifdists=true] ) = 1.287e-06 S  per = 5.42e-05  per(accum) = 95.4
 T(global opt: reduction of opS & opH [nccl]) = 9.710e-07 S  per = 4.09e-05  per(accum) = 95.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.842e-03 S  per = 0.12  per(accum) = 95.5
 T(global opt: reduction of opS & opH [mpi] ) = 1.289e-03 S  per = 0.0543  per(accum) = 95.6
 T(global opt: qops_pool join and erase     ) = 7.285e-02 S  per = 3.07  per(accum) = 98.6
 T(global opt: conversion from opAB to opPQ ) = 3.249e-02 S  per = 1.37  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-5.140e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=24/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=771:5.882e-03MB:5.744e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=5088:3.882e-02MB:3.791e-05GB
        per(mem): H:0.55 C:2.16 S:2.16 P:0 Q:95.1 
 rqops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=52:0.000397MB size(tot)=3612:0.0276MB:2.69e-05GB
        per(mem): H:0.775 C:3.32 S:4.98 A:11.2 B:79.7 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=10696:0.0816MB:7.97e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.298e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-3.773e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=130:9.918e-04MB
qtensor4: wf4 own=1 _data=0x398d9180
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
 qbond: qcol nsym=5 dimAll=10
 (12,2):4 (12,4):3 (11,3):1 (13,3):1 (14,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=30 nblocks=400 size=130:9.918e-04MB
### DIAG TIMING: total=1.019e+00 t1=3.479e-05, t2=1.274e-03, t3=2.492e-03, t4=1.015e+00, t5=7.056e-06, t6=1.911e-05, t7=9.698e-06
duration_diagGPU:1.019e+00
duration_diagreduce:2.820e-07
duration_diagtransform:1.069e-06
----- TIMING FOR symbolic_formulae_twodot with size=831 : 1.161e-02 S -----
rank=0 GPUmem(GB): used=7.969e-05 (oper)=7.969e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=831
 no. of hintermediate operators=386
 no. of coefficients=5612:4.282e-02MB:4.181e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.285e-04 S -----
rank=0 GPUmem(GB): used=1.215e-04 (oper,hinter)=7.969e-05,4.181e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.094e-01 S size(H_formulae)=831 size(Hxlst2)=30 T(Hmu/Hxlist)=2.448e-03,6.070e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.141e-01 S size(H_formulae)=831 size(Hxlst)=28046 -----
rank=0 GPUmem(GB): used=1.215e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=1.937e-06 batch[need]=1.024e-02 blksize=16 blksize0=16 batchsize=28046
rank=0 GPUmem(GB): used=1.036e-02 (oper,hinter,dvdson,batch)=7.969e-05,4.181e-05,1.937e-06,1.024e-02
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=130 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.454e-03,5.103e-03,1.009e-02,1.066e-02,2.733e-02
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=1.444e-03 speed=1.342e-03GB/S T(nccl)=1.040e-05 speed=1.864e-01GB/S
----- TIMING FOR sigma : t_inter=5.1e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=148 t=5.1e-03 per=2.0e+01 cost=1.2e+06 flops=2.3e+08
 sigma[gemm] counter=148 i=0 t=1.4e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=1 t=1.2e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=2 t=1.1e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=3 t=1.2e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=4 t=2.5e-03 per=9.7e+00 cost=2.5e+05 flops=1.0e+08
 sigma[gemm] counter=148 i=5 t=2.6e-03 per=9.9e+00 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=148 i=6 t=2.5e-03 per=9.7e+00 cost=1.9e+05 flops=7.4e+07
 sigma[gemm] counter=148 i=7 t=2.5e-03 per=9.8e+00 cost=2.2e+05 flops=8.6e+07
 sigma[gemm] counter=148 total t=1.0e-02 per=3.9e+01 cost=9.2e+05 flops=9.2e+07
 sigma[red] counter=148 t=1.1e-02 per=4.1e+01 cost=2.4e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.6e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=148 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.3e+07
 sigma_tot[gemm] counter=148 i=0 t=3.1e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=1 t=2.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=2 t=2.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=3 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=4 t=9.2e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=148 i=5 t=9.3e-01 per=1.4e+01 cost=2.0e+07 flops=2.1e+07
 sigma_tot[gemm] counter=148 i=6 t=9.1e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=148 i=7 t=9.0e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=148 total t=3.7e+00 per=5.6e+01 cost=7.7e+07 flops=2.1e+07
 sigma_tot[red] counter=148 t=1.6e+00 per=2.5e+01 cost=1.9e+07 flops=1.2e+07
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,8.4e-06,2.4e-06,1.2e-06,2.3e-07
settings: ndim=130 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328558693349 -1.116e+03  3.333e-02    1     1  2.749e-02 2.749e-02 2.745e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.474e-03,4.979e-03,1.211e-02,1.061e-02,2.918e-02
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=1.462e-03 speed=1.325e-03GB/S T(nccl)=1.244e-05 speed=1.557e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.2e-02 t_reduction=1.1e-02 tot=2.8e-02 -----
 sigma[inter] counter=149 t=5.0e-03 per=1.8e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=149 i=0 t=1.9e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=1 t=1.7e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=2 t=1.7e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=3 t=1.9e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=4 t=4.1e-03 per=1.5e+01 cost=2.5e+05 flops=6.1e+07
 sigma[gemm] counter=149 i=5 t=3.0e-03 per=1.1e+01 cost=2.7e+05 flops=9.1e+07
 sigma[gemm] counter=149 i=6 t=2.5e-03 per=9.0e+00 cost=1.9e+05 flops=7.4e+07
 sigma[gemm] counter=149 i=7 t=2.5e-03 per=9.0e+00 cost=2.2e+05 flops=8.6e+07
 sigma[gemm] counter=149 total t=1.2e-02 per=4.4e+01 cost=9.2e+05 flops=7.6e+07
 sigma[red] counter=149 t=1.1e-02 per=3.8e+01 cost=2.4e+05 flops=2.3e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.6e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=149 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.4e+07
 sigma_tot[gemm] counter=149 i=0 t=3.1e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=1 t=2.6e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=2 t=2.3e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=3 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=4 t=9.2e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=149 i=5 t=9.3e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=149 i=6 t=9.1e-01 per=1.4e+01 cost=1.8e+07 flops=2.0e+07
 sigma_tot[gemm] counter=149 i=7 t=9.0e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=149 total t=3.7e+00 per=5.5e+01 cost=7.8e+07 flops=2.1e+07
 sigma_tot[red] counter=149 t=1.6e+00 per=2.5e+01 cost=1.9e+07 flops=1.2e+07
T(sub)=7.9e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,4.7e-05,7.7e-06,3.6e-06,2.2e-07
    2   0 -    -116.330776748166 -2.218e-03  8.955e-03    2     2  7.449e-02 3.724e-02 2.838e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.949e-04,5.016e-03,1.021e-02,1.071e-02,2.626e-02
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=2.839e-04 speed=6.822e-03GB/S T(nccl)=1.092e-05 speed=1.774e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=150 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=150 i=0 t=4.0e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=1 t=3.7e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=2 t=3.5e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=3 t=3.6e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=4 t=2.5e-03 per=9.6e+00 cost=2.5e+05 flops=1.0e+08
 sigma[gemm] counter=150 i=5 t=2.6e-03 per=1.0e+01 cost=2.7e+05 flops=1.0e+08
 sigma[gemm] counter=150 i=6 t=2.5e-03 per=9.8e+00 cost=1.9e+05 flops=7.3e+07
 sigma[gemm] counter=150 i=7 t=2.5e-03 per=9.8e+00 cost=2.2e+05 flops=8.5e+07
 sigma[gemm] counter=150 total t=1.0e-02 per=3.9e+01 cost=9.2e+05 flops=9.1e+07
 sigma[red] counter=150 t=1.1e-02 per=4.1e+01 cost=2.4e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=150 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.4e+07
 sigma_tot[gemm] counter=150 i=0 t=3.1e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=1 t=2.7e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=2 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=3 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=4 t=9.2e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=150 i=5 t=9.3e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=150 i=6 t=9.1e-01 per=1.4e+01 cost=1.9e+07 flops=2.0e+07
 sigma_tot[gemm] counter=150 i=7 t=9.1e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=150 total t=3.7e+00 per=5.5e+01 cost=7.9e+07 flops=2.1e+07
 sigma_tot[red] counter=150 t=1.7e+00 per=2.5e+01 cost=1.9e+07 flops=1.2e+07
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=8.4e-06,4.0e-05,5.6e-06,2.7e-06,5.4e-07
    3   0 -    -116.330990410498 -2.137e-04  2.929e-03    3     3  1.135e-01 3.783e-02 2.776e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.628e-04,4.983e-03,1.003e-02,1.044e-02,2.592e-02
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=4.551e-04 speed=4.257e-03GB/S T(nccl)=7.763e-06 speed=2.495e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.0e-02 tot=2.5e-02 -----
 sigma[inter] counter=151 t=5.0e-03 per=2.0e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=151 i=0 t=3.4e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=1 t=3.0e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=2 t=3.0e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=3 t=2.9e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=4 t=2.5e-03 per=9.8e+00 cost=2.5e+05 flops=1.0e+08
 sigma[gemm] counter=151 i=5 t=2.5e-03 per=1.0e+01 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=151 i=6 t=2.5e-03 per=9.8e+00 cost=1.9e+05 flops=7.5e+07
 sigma[gemm] counter=151 i=7 t=2.5e-03 per=9.8e+00 cost=2.2e+05 flops=8.7e+07
 sigma[gemm] counter=151 total t=1.0e-02 per=3.9e+01 cost=9.2e+05 flops=9.2e+07
 sigma[red] counter=151 t=1.0e-02 per=4.1e+01 cost=2.4e+05 flops=2.3e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=151 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.5e+07
 sigma_tot[gemm] counter=151 i=0 t=3.2e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=1 t=2.7e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=2 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=3 t=2.4e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=4 t=9.3e-01 per=1.4e+01 cost=2.1e+07 flops=2.2e+07
 sigma_tot[gemm] counter=151 i=5 t=9.3e-01 per=1.4e+01 cost=2.1e+07 flops=2.2e+07
 sigma_tot[gemm] counter=151 i=6 t=9.2e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=151 i=7 t=9.1e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=151 total t=3.7e+00 per=5.5e+01 cost=8.0e+07 flops=2.2e+07
 sigma_tot[red] counter=151 t=1.7e+00 per=2.5e+01 cost=2.0e+07 flops=1.2e+07
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.0e-06,2.2e-05,4.8e-06,2.5e-06,3.5e-07
    4   0 -    -116.331013186422 -2.278e-05  1.108e-03    3     4  1.497e-01 3.743e-02 2.735e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.072e-04,5.008e-03,1.018e-02,1.078e-02,2.648e-02
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=5.004e-04 speed=3.871e-03GB/S T(nccl)=6.730e-06 speed=2.878e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=152 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=152 i=0 t=2.8e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=1 t=2.4e-06 per=9.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=2 t=2.3e-06 per=9.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=3 t=2.4e-06 per=9.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=4 t=2.5e-03 per=9.8e+00 cost=2.5e+05 flops=1.0e+08
 sigma[gemm] counter=152 i=5 t=2.6e-03 per=1.0e+01 cost=2.7e+05 flops=1.0e+08
 sigma[gemm] counter=152 i=6 t=2.5e-03 per=9.7e+00 cost=1.9e+05 flops=7.4e+07
 sigma[gemm] counter=152 i=7 t=2.5e-03 per=9.7e+00 cost=2.2e+05 flops=8.6e+07
 sigma[gemm] counter=152 total t=1.0e-02 per=3.9e+01 cost=9.2e+05 flops=9.1e+07
 sigma[red] counter=152 t=1.1e-02 per=4.2e+01 cost=2.4e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=152 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.5e+07
 sigma_tot[gemm] counter=152 i=0 t=3.2e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=1 t=2.7e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=2 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=3 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=4 t=9.3e-01 per=1.4e+01 cost=2.1e+07 flops=2.2e+07
 sigma_tot[gemm] counter=152 i=5 t=9.4e-01 per=1.4e+01 cost=2.1e+07 flops=2.2e+07
 sigma_tot[gemm] counter=152 i=6 t=9.2e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=152 i=7 t=9.1e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=152 total t=3.7e+00 per=5.5e+01 cost=8.1e+07 flops=2.2e+07
 sigma_tot[red] counter=152 t=1.7e+00 per=2.5e+01 cost=2.0e+07 flops=1.2e+07
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.0e-06,1.9e-05,1.6e-05,1.8e-06,3.0e-07
    5   0 -    -116.331016817102 -3.631e-06  4.098e-04    3     5  1.928e-01 3.856e-02 2.721e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.070e-04,5.016e-03,1.031e-02,1.067e-02,2.671e-02
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=6.908e-04 speed=2.804e-03GB/S T(nccl)=1.611e-05 speed=1.202e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=153 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=153 i=0 t=2.5e-06 per=9.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=1 t=2.1e-06 per=8.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=2 t=2.1e-06 per=8.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=3 t=2.1e-06 per=8.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=4 t=2.6e-03 per=9.9e+00 cost=2.5e+05 flops=9.8e+07
 sigma[gemm] counter=153 i=5 t=2.6e-03 per=1.0e+01 cost=2.7e+05 flops=1.0e+08
 sigma[gemm] counter=153 i=6 t=2.6e-03 per=9.9e+00 cost=1.9e+05 flops=7.2e+07
 sigma[gemm] counter=153 i=7 t=2.6e-03 per=9.8e+00 cost=2.2e+05 flops=8.4e+07
 sigma[gemm] counter=153 total t=1.0e-02 per=4.0e+01 cost=9.2e+05 flops=9.0e+07
 sigma[red] counter=153 t=1.1e-02 per=4.1e+01 cost=2.4e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=153 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.6e+07
 sigma_tot[gemm] counter=153 i=0 t=3.2e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=1 t=2.7e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=2 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=3 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=4 t=9.3e-01 per=1.4e+01 cost=2.1e+07 flops=2.3e+07
 sigma_tot[gemm] counter=153 i=5 t=9.4e-01 per=1.4e+01 cost=2.1e+07 flops=2.2e+07
 sigma_tot[gemm] counter=153 i=6 t=9.2e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=153 i=7 t=9.1e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=153 total t=3.7e+00 per=5.5e+01 cost=8.2e+07 flops=2.2e+07
 sigma_tot[red] counter=153 t=1.7e+00 per=2.5e+01 cost=2.0e+07 flops=1.2e+07
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.7e-05,3.9e-06,2.0e-06,2.9e-07
    6   0 -    -116.331017275736 -4.586e-07  1.172e-04    3     6  2.338e-01 3.896e-02 2.715e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.905e-04,4.973e-03,1.011e-02,1.084e-02,2.682e-02
 analyze_tgpu[Hx]: ndim=130:9.686e-07GB T(cpu-gpu)=8.854e-04 speed=2.188e-03GB/S T(nccl)=5.080e-06 speed=3.813e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=154 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma[gemm] counter=154 i=0 t=2.1e-06 per=8.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=1 t=1.9e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=2 t=1.9e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=3 t=1.8e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=4 t=2.5e-03 per=9.7e+00 cost=2.5e+05 flops=1.0e+08
 sigma[gemm] counter=154 i=5 t=2.6e-03 per=9.9e+00 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=154 i=6 t=2.5e-03 per=9.7e+00 cost=1.9e+05 flops=7.4e+07
 sigma[gemm] counter=154 i=7 t=2.5e-03 per=9.8e+00 cost=2.2e+05 flops=8.5e+07
 sigma[gemm] counter=154 total t=1.0e-02 per=3.9e+01 cost=9.2e+05 flops=9.1e+07
 sigma[red] counter=154 t=1.1e-02 per=4.2e+01 cost=2.4e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=154 t=1.3e+00 per=2.0e+01 cost=1.1e+08 flops=8.7e+07
 sigma_tot[gemm] counter=154 i=0 t=3.3e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=1 t=2.8e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=2 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=3 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=4 t=9.3e-01 per=1.4e+01 cost=2.1e+07 flops=2.3e+07
 sigma_tot[gemm] counter=154 i=5 t=9.4e-01 per=1.4e+01 cost=2.1e+07 flops=2.3e+07
 sigma_tot[gemm] counter=154 i=6 t=9.2e-01 per=1.4e+01 cost=1.9e+07 flops=2.1e+07
 sigma_tot[gemm] counter=154 i=7 t=9.2e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=154 total t=3.7e+00 per=5.5e+01 cost=8.3e+07 flops=2.2e+07
 sigma_tot[red] counter=154 t=1.7e+00 per=2.5e+01 cost=2.0e+07 flops=1.2e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.5e-05,3.6e-06,1.6e-06,2.9e-07
    7   0 +    -116.331017307255 -3.152e-08  2.668e-05    3     7  2.663e-01 3.804e-02 2.712e-02
TIMING FOR Davidson : 2.663e-01  T(cal/comm/rest)=1.899e-01,1.497e-06,7.646e-02
decomposed t_rest=7.646e-02
 T(sub)    =2.863e-04 per=3.744e-01
 T(precond)=7.587e-02 per=9.924e+01
 T(ortho)  =4.762e-05 per=6.228e-02
 T(xcopy)  =3.857e-06 per=5.045e-03
 T(xnrm2)  =4.584e-06 per=5.996e-03
 T(other)  =2.423e-04 per=3.170e-01
optimized energies: isweep=0 ibond=24 dots=2 e[0]=-116.331017307255 nmvp=7
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.150e-02 change=7.065e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=11 dimAll=40
 (12,2):5 (12,4):4 (11,3):1 (13,3):9 (14,2):6 (14,4):4 (15,3):2 (16,2):1 (13,1):4 (13,5):3 (15,1):1
timing for divide=1.4e-04
timing for compute=5.4e-03
timing for collect=2.3e-05
----- TMING FOR decimation_genbasis(su2): 5.5e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-04,5.4e-03,0.0e+00,6.6e-06,2.3e-05 -----
decimation summary: 40->10 dwt=+3.623e-03 SvN=1.286e+00
 qbond: qkept nsym=4 dimAll=10
 (14,2):5 (14,4):3 (13,3):1 (15,3):1
----- TIMING for decimation_row(nkr): 6.015e-03 S T(decim/select/formRot)=5.610e-03,3.320e-04,7.296e-05 -----
----- TIMING FOR twodot_decimation: 7.327e-03 S T(wf/decim)=1.224e-03,6.103e-03 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:9 S:11 A:81 B:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=5027:3.835e-02MB:3.745e-05GB
        per(mem): H:0.716 C:2.86 S:3.5 A:1.61 B:91.3 
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.142e-02 change=2.806e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=192 : 4.930e-03 S -----
rank=0 GPUmem(GB): used=1.210e-04 (oper)=7.180e-05
rank=0 GPUmem(GB): used=1.214e-04 (oper,site)=7.180e-05,3.949e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=192
 no. of rintermediate operators=104
 no. of coefficients=2732:2.084e-02MB:2.035e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.478e-03 S -----
rank=0 GPUmem(GB): used=1.418e-04 (oper,site,rinter)=7.180e-05,3.949e-07,2.035e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.153e-02 S size(rtasks)=192 size(Rlst2)=16 T(Rmu/Rlist)=1.064e-03,3.046e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.184e-02 S size(rtasks)=192 size(Rlst)=2597 -----
rank=0 GPUmem(GB): used=1.418e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.296e-03 blksize=25 blksize0=16 batchsize=2597
rank=0 GPUmem(GB): used=1.438e-03 (oper,site,rinter,batch)=7.180e-05,3.949e-07,2.035e-05,1.296e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.643e-03,2.290e-02,1.001e-02
----- TIMING FOR renorm : t_inter=5.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=25 t=5.6e-03 per=1.5e+01 cost=1.9e+05 flops=3.4e+07
 renorm[gemm] counter=25 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=2 t=7.5e-03 per=2.0e+01 cost=1.7e+04 flops=2.2e+06
 renorm[gemm] counter=25 i=3 t=7.7e-03 per=2.0e+01 cost=4.5e+04 flops=5.8e+06
 renorm[gemm] counter=25 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=5 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=6 t=7.7e-03 per=2.0e+01 cost=7.1e+04 flops=9.2e+06
 renorm[gemm] counter=25 total t=2.3e-02 per=5.9e+01 cost=1.3e+05 flops=5.8e+06
 renorm[red] counter=25 t=1.0e-02 per=2.6e+01 cost=3.4e+04 flops=3.4e+06
----- TIMING FOR renorm_tot : t_inter=1.5e-01 t_gemm=5.7e-01 t_reduction=2.5e-01 tot=9.6e-01 -----
 renorm_tot[inter] counter=25 t=1.5e-01 per=1.5e+01 cost=2.3e+06 flops=1.6e+07
 renorm_tot[gemm] counter=25 i=0 t=3.7e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=1 t=3.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=2 t=6.0e-02 per=6.3e+00 cost=1.3e+05 flops=2.1e+06
 renorm_tot[gemm] counter=25 i=3 t=6.1e-02 per=6.3e+00 cost=2.0e+05 flops=3.3e+06
 renorm_tot[gemm] counter=25 i=4 t=1.3e-01 per=1.3e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=25 i=5 t=1.3e-01 per=1.3e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=25 i=6 t=1.9e-01 per=2.0e+01 cost=1.3e+06 flops=6.8e+06
 renorm_tot[gemm] counter=25 total t=5.7e-01 per=5.9e+01 cost=2.4e+06 flops=4.2e+06
 renorm_tot[red] counter=25 t=2.5e-01 per=2.6e+01 cost=5.8e+05 flops=2.3e+06
qops.to_cpu: size(tot)=5027:3.8e-02MB:3.7e-05GB T(to_cpu)=2.1e-04S speed=1.8e-01GB/S
check ||H-H.dagger||=9.319e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.102 S rank=0 -----
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.270e-02 change=9.124e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.327e-02 change=-2.450e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.327e-02 change=-3.308e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.259e+00 S #####
 T(local opt: fetch) = 1.706e-02 S  per = 0.755  per(accum) = 0.755
 T(local opt: hdiag) = 1.020e+00 S  per = 45.1  per(accum) = 45.9
 T(local opt: dvdsn) = 1.106e+00 S  per =   49  per(accum) = 94.9
 T(local opt: decim) = 7.367e-03 S  per = 0.326  per(accum) = 95.2
 T(local opt: guess) = 1.385e-03 S  per = 0.0613  per(accum) = 95.2
 T(local opt: renrm) = 1.071e-01 S  per = 4.74  per(accum) = 100
 T(local opt: save ) = 3.306e-04 S  per = 0.0146  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.106e+00 S  T(sum) = 1.104e+00 S  per = 9.980e+01
 T(local opt: preprocess                  ) = 6.236e-03 S  per = 0.565  per(accum) = 0.565
 T(local opt: symbolic_formulae           ) = 1.163e-02 S  per = 1.05  per(accum) = 1.62
 T(local opt: hintermediate init          ) = 4.484e-04 S  per = 0.0406  per(accum) = 1.66
 T(local opt: preprocess_hformulae_Hxlist ) = 6.153e-01 S  per = 55.7  per(accum) = 57.4
 T(local opt: hmmtasks init               ) = 2.026e-01 S  per = 18.3  per(accum) = 75.7
 T(local opt: initial guess for dvdson    ) = 1.727e-03 S  per = 0.156  per(accum) = 75.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.841e-01 S  per = 16.7  per(accum) = 92.6
 T(local opt: dvdson [cpu-gpu]            ) = 5.721e-03 S  per = 0.518  per(accum) = 93.1
 T(local opt: dvdson [nccl]               ) = 6.944e-05 S  per = 0.00629  per(accum) = 93.1
 T(local opt: dvdson [mpi]                ) = 1.497e-06 S  per = 0.000136  per(accum) = 93.1
 T(local opt: dvdson [rest part(linalg)]  ) = 7.646e-02 S  per = 6.92  per(accum) = 100
Detailed decomposition of T(renrm) = 1.071e-01 S  T(sum) = 1.071e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.966e-04 S  per = 0.277  per(accum) = 0.277
 T(local opt: qops init                    ) = 4.846e-03 S  per = 4.53  per(accum) = 4.8
 T(local opt: symbolic_formulae_renorm     ) = 4.951e-03 S  per = 4.63  per(accum) = 9.43
 T(local opt: allocate qops on gpu         ) = 6.179e-05 S  per = 0.0577  per(accum) = 9.49
 T(local opt: site memcpy cpu2gpu          ) = 2.227e-03 S  per = 2.08  per(accum) = 11.6
 T(local opt: rintermediate init           ) = 2.490e-03 S  per = 2.33  per(accum) = 13.9
 T(local opt: preprocess_formulae_Rlist2   ) = 3.197e-02 S  per = 29.9  per(accum) = 43.8
 T(local opt: rmmtasks init                ) = 1.650e-02 S  per = 15.4  per(accum) = 59.2
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 3.08e-05  per(accum) = 59.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.865e-02 S  per = 36.1  per(accum) = 95.3
 T(local opt: deallocate cpu and gpu memory) = 1.307e-04 S  per = 0.122  per(accum) = 95.4
 T(local opt: construct opS [ifdists=true] ) = 4.900e-08 S  per = 4.58e-05  per(accum) = 95.4
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 3.46e-05  per(accum) = 95.4
 T(local opt: qops memcpy gpu2cpu          ) = 2.157e-04 S  per = 0.201  per(accum) = 95.6
 T(local opt: reduction of opS & opH [mpi] ) = 5.016e-05 S  per = 0.0469  per(accum) = 95.6
 T(local opt: qops_pool join and erase     ) = 4.660e-03 S  per = 4.35  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.944e-06 S  per = 0.00742  per(accum) = 100
##### sweep opt: 3.225e+01 S #####
 T(sweep opt: fetch) = 3.627e-01 S  per = 1.12  per(accum) = 1.12
 T(sweep opt: hdiag) = 1.190e+01 S  per = 36.9  per(accum) = 38
 T(sweep opt: dvdsn) = 1.712e+01 S  per = 53.1  per(accum) = 91.1
 T(sweep opt: decim) = 3.416e-01 S  per = 1.06  per(accum) = 92.2
 T(sweep opt: guess) = 3.083e-02 S  per = 0.0956  per(accum) = 92.3
 T(sweep opt: renrm) = 2.481e+00 S  per = 7.69  per(accum) = 100
 T(sweep opt: save ) = 8.168e-03 S  per = 0.0253  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.712e+01 S  T(sum) = 1.708e+01 S  per = 9.976e+01
 T(sweep opt: preprocess                  ) = 1.372e-01 S  per = 0.803  per(accum) = 0.803
 T(sweep opt: symbolic_formulae           ) = 1.864e-01 S  per = 1.09  per(accum) = 1.89
 T(sweep opt: hintermediate init          ) = 7.024e-03 S  per = 0.0411  per(accum) = 1.94
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.765e+00 S  per = 33.8  per(accum) = 35.7
 T(sweep opt: hmmtasks init               ) = 2.343e+00 S  per = 13.7  per(accum) = 49.4
 T(sweep opt: initial guess for dvdson    ) = 3.649e-02 S  per = 0.214  per(accum) = 49.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.770e+00 S  per = 39.6  per(accum) = 89.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.065e-01 S  per = 1.21  per(accum) = 90.5
 T(sweep opt: dvdson [nccl]               ) = 1.124e-03 S  per = 0.00658  per(accum) = 90.5
 T(sweep opt: dvdson [mpi]                ) = 2.619e-05 S  per = 0.000153  per(accum) = 90.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.627e+00 S  per = 9.53  per(accum) = 100
Detailed decomposition of T(renrm) = 2.481e+00 S  T(sum) = 2.481e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.068e-03 S  per = 0.325  per(accum) = 0.325
 T(sweep opt: qops init                    ) = 9.106e-02 S  per = 3.67  per(accum) = 4
 T(sweep opt: symbolic_formulae_renorm     ) = 9.627e-02 S  per = 3.88  per(accum) = 7.88
 T(sweep opt: allocate qops on gpu         ) = 3.534e-03 S  per = 0.142  per(accum) = 8.02
 T(sweep opt: site memcpy cpu2gpu          ) = 3.447e-02 S  per = 1.39  per(accum) = 9.41
 T(sweep opt: rintermediate init           ) = 6.045e-02 S  per = 2.44  per(accum) = 11.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.324e-01 S  per = 29.5  per(accum) = 41.4
 T(sweep opt: rmmtasks init                ) = 3.731e-01 S  per =   15  per(accum) = 56.4
 T(sweep opt: qops memset on cpu           ) = 9.890e-07 S  per = 3.99e-05  per(accum) = 56.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.644e-01 S  per = 38.9  per(accum) = 95.3
 T(sweep opt: deallocate cpu and gpu memory) = 3.049e-03 S  per = 0.123  per(accum) = 95.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.336e-06 S  per = 5.38e-05  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.008e-06 S  per = 4.06e-05  per(accum) = 95.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.058e-03 S  per = 0.123  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.340e-03 S  per = 0.054  per(accum) = 95.6
 T(sweep opt: qops_pool join and erase     ) = 7.751e-02 S  per = 3.12  per(accum) = 98.7
 T(sweep opt: conversion from opAB to opPQ ) = 3.249e-02 S  per = 1.31  per(accum) = 100
##### global opt: 3.225e+01 S #####
 T(global opt: fetch) = 3.627e-01 S  per = 1.12  per(accum) = 1.12
 T(global opt: hdiag) = 1.190e+01 S  per = 36.9  per(accum) = 38
 T(global opt: dvdsn) = 1.712e+01 S  per = 53.1  per(accum) = 91.1
 T(global opt: decim) = 3.416e-01 S  per = 1.06  per(accum) = 92.2
 T(global opt: guess) = 3.083e-02 S  per = 0.0956  per(accum) = 92.3
 T(global opt: renrm) = 2.481e+00 S  per = 7.69  per(accum) = 100
 T(global opt: save ) = 8.168e-03 S  per = 0.0253  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.712e+01 S  T(sum) = 1.708e+01 S  per = 9.976e+01
 T(global opt: preprocess                  ) = 1.372e-01 S  per = 0.803  per(accum) = 0.803
 T(global opt: symbolic_formulae           ) = 1.864e-01 S  per = 1.09  per(accum) = 1.89
 T(global opt: hintermediate init          ) = 7.024e-03 S  per = 0.0411  per(accum) = 1.94
 T(global opt: preprocess_hformulae_Hxlist ) = 5.765e+00 S  per = 33.8  per(accum) = 35.7
 T(global opt: hmmtasks init               ) = 2.343e+00 S  per = 13.7  per(accum) = 49.4
 T(global opt: initial guess for dvdson    ) = 3.649e-02 S  per = 0.214  per(accum) = 49.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.770e+00 S  per = 39.6  per(accum) = 89.3
 T(global opt: dvdson [cpu-gpu]            ) = 2.065e-01 S  per = 1.21  per(accum) = 90.5
 T(global opt: dvdson [nccl]               ) = 1.124e-03 S  per = 0.00658  per(accum) = 90.5
 T(global opt: dvdson [mpi]                ) = 2.619e-05 S  per = 0.000153  per(accum) = 90.5
 T(global opt: dvdson [rest part(linalg)]  ) = 1.627e+00 S  per = 9.53  per(accum) = 100
Detailed decomposition of T(renrm) = 2.481e+00 S  T(sum) = 2.481e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.068e-03 S  per = 0.325  per(accum) = 0.325
 T(global opt: qops init                    ) = 9.106e-02 S  per = 3.67  per(accum) = 4
 T(global opt: symbolic_formulae_renorm     ) = 9.627e-02 S  per = 3.88  per(accum) = 7.88
 T(global opt: allocate qops on gpu         ) = 3.534e-03 S  per = 0.142  per(accum) = 8.02
 T(global opt: site memcpy cpu2gpu          ) = 3.447e-02 S  per = 1.39  per(accum) = 9.41
 T(global opt: rintermediate init           ) = 6.045e-02 S  per = 2.44  per(accum) = 11.8
 T(global opt: preprocess_formulae_Rlist2   ) = 7.324e-01 S  per = 29.5  per(accum) = 41.4
 T(global opt: rmmtasks init                ) = 3.731e-01 S  per =   15  per(accum) = 56.4
 T(global opt: qops memset on cpu           ) = 9.890e-07 S  per = 3.99e-05  per(accum) = 56.4
 T(global opt: preprocess_renorm_batchGPU   ) = 9.644e-01 S  per = 38.9  per(accum) = 95.3
 T(global opt: deallocate cpu and gpu memory) = 3.049e-03 S  per = 0.123  per(accum) = 95.4
 T(global opt: construct opS [ifdists=true] ) = 1.336e-06 S  per = 5.38e-05  per(accum) = 95.4
 T(global opt: reduction of opS & opH [nccl]) = 1.008e-06 S  per = 4.06e-05  per(accum) = 95.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.058e-03 S  per = 0.123  per(accum) = 95.5
 T(global opt: reduction of opS & opH [mpi] ) = 1.340e-03 S  per = 0.054  per(accum) = 95.6
 T(global opt: qops_pool join and erase     ) = 7.751e-02 S  per = 3.12  per(accum) = 98.7
 T(global opt: conversion from opAB to opPQ ) = 3.249e-02 S  per = 1.31  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-7.019e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=25/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=768:5.859e-03MB:5.722e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=63:4.807e-04MB:4.694e-07GB
total mem of comb=832:6.348e-03MB:6.199e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:9 S:11 P:121 Q:132 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=5614:4.283e-02MB:4.183e-05GB
        per(mem): H:0.499 C:1.92 S:2.35 P:0 Q:95.2 
 rqops: oplist=HCSAB nops=H:1 C:9 S:11 A:81 B:90 
        dim(bra,ket)=10,10 size(op)=66:0.000504MB size(tot)=5027:0.0384MB:3.75e-05GB
        per(mem): H:0.716 C:2.86 S:3.5 A:1.61 B:91.3 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=12637:0.0964MB:9.42e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.392e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-4.536e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=176:1.343e-03MB
qtensor4: wf4 own=1 _data=0x3a5f3700
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
 qbond: qcol nsym=4 dimAll=10
 (14,2):5 (14,4):3 (13,3):1 (15,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=31 nblocks=304 size=176:1.343e-03MB
### DIAG TIMING: total=1.268e+00 t1=3.914e-05, t2=1.573e-03, t3=2.569e-03, t4=1.263e+00, t5=1.153e-05, t6=2.588e-05, t7=7.693e-06
duration_diagGPU:1.268e+00
duration_diagreduce:2.641e-06
duration_diagtransform:1.164e-06
----- TIMING FOR symbolic_formulae_twodot with size=972 : 1.697e-02 S -----
rank=0 GPUmem(GB): used=9.415e-05 (oper)=9.415e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=972
 no. of hintermediate operators=445
 no. of coefficients=6255:4.772e-02MB:4.660e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.839e-04 S -----
rank=0 GPUmem(GB): used=1.408e-04 (oper,hinter)=9.415e-05,4.660e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.280e-01 S size(H_formulae)=972 size(Hxlst2)=31 T(Hmu/Hxlist)=3.438e-03,7.246e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.338e-01 S size(H_formulae)=972 size(Hxlst)=38638 -----
rank=0 GPUmem(GB): used=1.408e-04 avail=6.174e+00 total=6.174e+00 dvdson[need]=2.623e-06 batch[need]=1.900e-02 blksize=20 blksize0=25 batchsize=38638
rank=0 GPUmem(GB): used=1.914e-02 (oper,hinter,dvdson,batch)=9.415e-05,4.660e-05,2.623e-06,1.900e-02
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=176 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.292e-03,5.016e-03,1.022e-02,1.078e-02,2.834e-02
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.278e-03 speed=1.151e-03GB/S T(nccl)=1.391e-05 speed=1.886e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=155 t=5.0e-03 per=1.9e+01 cost=3.0e+06 flops=5.9e+08
 sigma[gemm] counter=155 i=0 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=1 t=1.2e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=2 t=1.1e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=3 t=1.1e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=4 t=2.5e-03 per=9.6e+00 cost=7.7e+05 flops=3.1e+08
 sigma[gemm] counter=155 i=5 t=2.6e-03 per=1.0e+01 cost=7.9e+05 flops=3.0e+08
 sigma[gemm] counter=155 i=6 t=2.6e-03 per=9.8e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=155 i=7 t=2.6e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=155 total t=1.0e-02 per=3.9e+01 cost=2.3e+06 flops=2.3e+08
 sigma[red] counter=155 t=1.1e-02 per=4.1e+01 cost=4.7e+05 flops=4.3e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=155 t=1.3e+00 per=2.0e+01 cost=1.2e+08 flops=8.8e+07
 sigma_tot[gemm] counter=155 i=0 t=3.3e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=1 t=2.8e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=2 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=3 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=4 t=9.4e-01 per=1.4e+01 cost=2.2e+07 flops=2.4e+07
 sigma_tot[gemm] counter=155 i=5 t=9.4e-01 per=1.4e+01 cost=2.2e+07 flops=2.3e+07
 sigma_tot[gemm] counter=155 i=6 t=9.3e-01 per=1.4e+01 cost=2.0e+07 flops=2.1e+07
 sigma_tot[gemm] counter=155 i=7 t=9.2e-01 per=1.4e+01 cost=2.1e+07 flops=2.3e+07
 sigma_tot[gemm] counter=155 total t=3.7e+00 per=5.5e+01 cost=8.5e+07 flops=2.3e+07
 sigma_tot[red] counter=155 t=1.7e+00 per=2.5e+01 cost=2.1e+07 flops=1.2e+07
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,8.4e-06,2.5e-06,1.2e-06,2.3e-07
settings: ndim=176 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.329089711429 -1.116e+03  3.540e-02    1     1  2.849e-02 2.849e-02 2.846e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.445e-04,4.968e-03,1.021e-02,1.078e-02,2.651e-02
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=5.378e-04 speed=4.876e-03GB/S T(nccl)=6.673e-06 speed=3.930e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=156 t=5.0e-03 per=1.9e+01 cost=3.0e+06 flops=6.0e+08
 sigma[gemm] counter=156 i=0 t=2.0e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=1 t=1.7e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=2 t=1.7e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=3 t=1.7e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=4 t=2.5e-03 per=9.7e+00 cost=7.7e+05 flops=3.1e+08
 sigma[gemm] counter=156 i=5 t=2.6e-03 per=1.0e+01 cost=7.9e+05 flops=3.0e+08
 sigma[gemm] counter=156 i=6 t=2.5e-03 per=9.7e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=156 i=7 t=2.5e-03 per=9.7e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=156 total t=1.0e-02 per=3.9e+01 cost=2.3e+06 flops=2.3e+08
 sigma[red] counter=156 t=1.1e-02 per=4.2e+01 cost=4.7e+05 flops=4.3e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=156 t=1.3e+00 per=2.0e+01 cost=1.2e+08 flops=9.0e+07
 sigma_tot[gemm] counter=156 i=0 t=3.3e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=1 t=2.8e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=2 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=3 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=4 t=9.4e-01 per=1.4e+01 cost=2.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=156 i=5 t=9.5e-01 per=1.4e+01 cost=2.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=156 i=6 t=9.3e-01 per=1.4e+01 cost=2.0e+07 flops=2.2e+07
 sigma_tot[gemm] counter=156 i=7 t=9.2e-01 per=1.4e+01 cost=2.1e+07 flops=2.3e+07
 sigma_tot[gemm] counter=156 total t=3.7e+00 per=5.5e+01 cost=8.7e+07 flops=2.3e+07
 sigma_tot[red] counter=156 t=1.7e+00 per=2.5e+01 cost=2.1e+07 flops=1.2e+07
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=8.5e-06,3.9e-05,4.7e-06,2.1e-06,2.9e-07
    2   0 -    -116.332238333927 -3.149e-03  9.601e-03    2     2  6.531e-02 3.266e-02 2.754e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.245e-03,5.040e-03,1.034e-02,1.084e-02,2.748e-02
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=1.240e-03 speed=2.116e-03GB/S T(nccl)=5.615e-06 speed=4.671e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=157 t=5.0e-03 per=1.9e+01 cost=3.0e+06 flops=5.9e+08
 sigma[gemm] counter=157 i=0 t=2.0e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=1 t=1.7e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=2 t=1.7e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=3 t=1.7e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=4 t=2.6e-03 per=9.7e+00 cost=7.7e+05 flops=3.0e+08
 sigma[gemm] counter=157 i=5 t=2.7e-03 per=1.0e+01 cost=7.9e+05 flops=2.9e+08
 sigma[gemm] counter=157 i=6 t=2.5e-03 per=9.7e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=157 i=7 t=2.6e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=157 total t=1.0e-02 per=3.9e+01 cost=2.3e+06 flops=2.2e+08
 sigma[red] counter=157 t=1.1e-02 per=4.1e+01 cost=4.7e+05 flops=4.3e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.7e+00 t_reduction=1.7e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=157 t=1.3e+00 per=2.0e+01 cost=1.2e+08 flops=9.2e+07
 sigma_tot[gemm] counter=157 i=0 t=3.3e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=1 t=2.8e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=2 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=3 t=2.6e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=4 t=9.4e-01 per=1.4e+01 cost=2.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=157 i=5 t=9.5e-01 per=1.4e+01 cost=2.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=157 i=6 t=9.3e-01 per=1.4e+01 cost=2.1e+07 flops=2.2e+07
 sigma_tot[gemm] counter=157 i=7 t=9.2e-01 per=1.4e+01 cost=2.2e+07 flops=2.3e+07
 sigma_tot[gemm] counter=157 total t=3.7e+00 per=5.5e+01 cost=9.0e+07 flops=2.4e+07
 sigma_tot[red] counter=157 t=1.7e+00 per=2.5e+01 cost=2.2e+07 flops=1.3e+07
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,2.7e-05,3.3e-06,2.1e-06,2.1e-07
    3   0 -    -116.332525303671 -2.870e-04  3.692e-03    3     3  1.044e-01 3.481e-02 2.756e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.057e-03,4.966e-03,1.019e-02,1.077e-02,2.799e-02
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=2.051e-03 speed=1.279e-03GB/S T(nccl)=5.901e-06 speed=4.444e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=158 t=5.0e-03 per=1.9e+01 cost=3.0e+06 flops=6.0e+08
 sigma[gemm] counter=158 i=0 t=1.4e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=1 t=1.2e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=2 t=1.2e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=3 t=1.2e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=4 t=2.5e-03 per=9.7e+00 cost=7.7e+05 flops=3.1e+08
 sigma[gemm] counter=158 i=5 t=2.6e-03 per=1.0e+01 cost=7.9e+05 flops=3.0e+08
 sigma[gemm] counter=158 i=6 t=2.5e-03 per=9.7e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=158 i=7 t=2.5e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=158 total t=1.0e-02 per=3.9e+01 cost=2.3e+06 flops=2.3e+08
 sigma[red] counter=158 t=1.1e-02 per=4.2e+01 cost=4.7e+05 flops=4.3e+07
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.8e+00 t_reduction=1.7e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=158 t=1.3e+00 per=2.0e+01 cost=1.3e+08 flops=9.4e+07
 sigma_tot[gemm] counter=158 i=0 t=3.3e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=1 t=2.8e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=2 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=3 t=2.6e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=4 t=9.4e-01 per=1.4e+01 cost=2.4e+07 flops=2.6e+07
 sigma_tot[gemm] counter=158 i=5 t=9.5e-01 per=1.4e+01 cost=2.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=158 i=6 t=9.3e-01 per=1.4e+01 cost=2.1e+07 flops=2.2e+07
 sigma_tot[gemm] counter=158 i=7 t=9.3e-01 per=1.4e+01 cost=2.2e+07 flops=2.4e+07
 sigma_tot[gemm] counter=158 total t=3.8e+00 per=5.5e+01 cost=9.2e+07 flops=2.4e+07
 sigma_tot[red] counter=158 t=1.7e+00 per=2.5e+01 cost=2.2e+07 flops=1.3e+07
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=6.0e-06,1.6e-05,3.5e-06,1.6e-06,2.3e-07
    4   0 -    -116.332566343534 -4.104e-05  1.347e-03    3     4  1.433e-01 3.582e-02 2.769e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.476e-04,5.014e-03,1.025e-02,1.101e-02,2.673e-02
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=4.417e-04 speed=5.938e-03GB/S T(nccl)=5.929e-06 speed=4.423e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=159 t=5.0e-03 per=1.9e+01 cost=3.0e+06 flops=5.9e+08
 sigma[gemm] counter=159 i=0 t=1.9e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=1 t=1.6e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=2 t=1.5e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=3 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=4 t=2.5e-03 per=9.6e+00 cost=7.7e+05 flops=3.0e+08
 sigma[gemm] counter=159 i=5 t=2.6e-03 per=1.0e+01 cost=7.9e+05 flops=3.0e+08
 sigma[gemm] counter=159 i=6 t=2.5e-03 per=9.6e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=159 i=7 t=2.6e-03 per=9.7e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=159 total t=1.0e-02 per=3.9e+01 cost=2.3e+06 flops=2.3e+08
 sigma[red] counter=159 t=1.1e-02 per=4.2e+01 cost=4.7e+05 flops=4.2e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.7e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=159 t=1.4e+00 per=2.0e+01 cost=1.3e+08 flops=9.6e+07
 sigma_tot[gemm] counter=159 i=0 t=3.3e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=1 t=2.8e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=2 t=2.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=3 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=4 t=9.5e-01 per=1.4e+01 cost=2.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=159 i=5 t=9.6e-01 per=1.4e+01 cost=2.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=159 i=6 t=9.4e-01 per=1.4e+01 cost=2.1e+07 flops=2.3e+07
 sigma_tot[gemm] counter=159 i=7 t=9.3e-01 per=1.4e+01 cost=2.2e+07 flops=2.4e+07
 sigma_tot[gemm] counter=159 total t=3.8e+00 per=5.5e+01 cost=9.4e+07 flops=2.5e+07
 sigma_tot[red] counter=159 t=1.7e+00 per=2.5e+01 cost=2.3e+07 flops=1.3e+07
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.6e-05,3.5e-06,1.7e-06,2.6e-07
    5   0 -    -116.332571893962 -5.550e-06  4.656e-04    3     5  1.804e-01 3.608e-02 2.752e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.139e-04,5.026e-03,1.038e-02,1.086e-02,2.708e-02
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=8.079e-04 speed=3.246e-03GB/S T(nccl)=6.026e-06 speed=4.352e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=160 t=5.0e-03 per=1.9e+01 cost=3.0e+06 flops=5.9e+08
 sigma[gemm] counter=160 i=0 t=1.8e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=1 t=1.6e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=2 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=3 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=4 t=2.5e-03 per=9.6e+00 cost=7.7e+05 flops=3.0e+08
 sigma[gemm] counter=160 i=5 t=2.7e-03 per=1.0e+01 cost=7.9e+05 flops=2.9e+08
 sigma[gemm] counter=160 i=6 t=2.6e-03 per=9.8e+00 cost=3.7e+05 flops=1.4e+08
 sigma[gemm] counter=160 i=7 t=2.6e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=160 total t=1.0e-02 per=4.0e+01 cost=2.3e+06 flops=2.2e+08
 sigma[red] counter=160 t=1.1e-02 per=4.1e+01 cost=4.7e+05 flops=4.3e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=160 t=1.4e+00 per=2.0e+01 cost=1.3e+08 flops=9.8e+07
 sigma_tot[gemm] counter=160 i=0 t=3.4e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=1 t=2.9e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=2 t=2.6e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=3 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=4 t=9.5e-01 per=1.4e+01 cost=2.6e+07 flops=2.7e+07
 sigma_tot[gemm] counter=160 i=5 t=9.6e-01 per=1.4e+01 cost=2.6e+07 flops=2.7e+07
 sigma_tot[gemm] counter=160 i=6 t=9.4e-01 per=1.4e+01 cost=2.2e+07 flops=2.3e+07
 sigma_tot[gemm] counter=160 i=7 t=9.3e-01 per=1.4e+01 cost=2.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=160 total t=3.8e+00 per=5.5e+01 cost=9.7e+07 flops=2.6e+07
 sigma_tot[red] counter=160 t=1.8e+00 per=2.5e+01 cost=2.3e+07 flops=1.3e+07
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.6e-05,3.6e-06,1.6e-06,2.3e-07
    6   0 -    -116.332572616535 -7.226e-07  1.438e-04    3     6  2.175e-01 3.625e-02 2.747e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.182e-03,5.014e-03,1.025e-02,1.089e-02,2.734e-02
 analyze_tgpu[Hx]: ndim=176:1.311e-06GB T(cpu-gpu)=1.176e-03 speed=2.231e-03GB/S T(nccl)=6.062e-06 speed=4.326e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=161 t=5.0e-03 per=1.9e+01 cost=3.0e+06 flops=5.9e+08
 sigma[gemm] counter=161 i=0 t=1.8e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=1 t=1.6e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=2 t=1.6e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=3 t=1.6e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=4 t=2.5e-03 per=9.7e+00 cost=7.7e+05 flops=3.0e+08
 sigma[gemm] counter=161 i=5 t=2.6e-03 per=1.0e+01 cost=7.9e+05 flops=3.0e+08
 sigma[gemm] counter=161 i=6 t=2.5e-03 per=9.7e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=161 i=7 t=2.5e-03 per=9.7e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=161 total t=1.0e-02 per=3.9e+01 cost=2.3e+06 flops=2.3e+08
 sigma[red] counter=161 t=1.1e-02 per=4.2e+01 cost=4.7e+05 flops=4.3e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=161 t=1.4e+00 per=2.0e+01 cost=1.4e+08 flops=1.0e+08
 sigma_tot[gemm] counter=161 i=0 t=3.4e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=1 t=2.9e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=2 t=2.6e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=3 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=4 t=9.5e-01 per=1.4e+01 cost=2.7e+07 flops=2.8e+07
 sigma_tot[gemm] counter=161 i=5 t=9.6e-01 per=1.4e+01 cost=2.7e+07 flops=2.8e+07
 sigma_tot[gemm] counter=161 i=6 t=9.4e-01 per=1.4e+01 cost=2.2e+07 flops=2.3e+07
 sigma_tot[gemm] counter=161 i=7 t=9.3e-01 per=1.3e+01 cost=2.3e+07 flops=2.5e+07
 sigma_tot[gemm] counter=161 total t=3.8e+00 per=5.5e+01 cost=9.9e+07 flops=2.6e+07
 sigma_tot[red] counter=161 t=1.8e+00 per=2.6e+01 cost=2.4e+07 flops=1.3e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.5e-05,3.3e-06,1.6e-06,2.3e-07
    7   0 +    -116.332572672318 -5.578e-08  3.729e-05    3     7  2.545e-01 3.636e-02 2.747e-02
TIMING FOR Davidson : 2.545e-01  T(cal/comm/rest)=1.923e-01,9.090e-07,6.225e-02
decomposed t_rest=6.225e-02
 T(sub)    =2.193e-04 per=3.523e-01
 T(precond)=6.184e-02 per=9.934e+01
 T(ortho)  =2.777e-05 per=4.462e-02
 T(xcopy)  =1.278e-06 per=2.053e-03
 T(xnrm2)  =1.421e-05 per=2.283e-02
 T(other)  =1.469e-04 per=2.359e-01
optimized energies: isweep=0 ibond=25 dots=2 e[0]=-116.332572672318 nmvp=7
rank=0 CPUmem(GB): used=1.017e+00 pageheap_free=1.325e-02 change=9.397e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=9 dimAll=40
 (14,2):6 (14,4):4 (13,3):1 (15,3):10 (16,2):6 (16,4):4 (17,3):1 (15,1):5 (15,5):3
timing for divide=8.5e-05
timing for compute=9.6e-03
timing for collect=2.9e-05
----- TMING FOR decimation_genbasis(su2): 9.7e-03 S T(divide/compute[cpu/gpu/rest]/collect)=8.5e-05,9.5e-03,0.0e+00,6.9e-06,2.9e-05 -----
decimation summary: 40->10 dwt=+4.776e-03 SvN=1.463e+00
 qbond: qkept nsym=4 dimAll=10
 (15,3):4 (15,1):4 (16,2):1 (16,4):1
----- TIMING for decimation_row(nkr): 1.016e-02 S T(decim/select/formRot)=9.721e-03,3.690e-04,7.010e-05 -----
----- TIMING FOR twodot_decimation: 1.106e-02 S T(wf/decim)=8.190e-04,1.025e-02 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:10 A:100 B:110 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=5884:4.489e-02MB:4.384e-05GB
        per(mem): H:0.578 C:2.04 S:2.04 A:0 B:95.3 
rank=0 CPUmem(GB): used=1.018e+00 pageheap_free=1.591e-02 change=3.307e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=231 : 4.438e-03 S -----
rank=0 GPUmem(GB): used=1.428e-04 (oper)=8.873e-05
rank=0 GPUmem(GB): used=1.433e-04 (oper,site)=8.873e-05,5.215e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=231
 no. of rintermediate operators=95
 no. of coefficients=3105:2.369e-02MB:2.313e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.482e-03 S -----
rank=0 GPUmem(GB): used=1.664e-04 (oper,site,rinter)=8.873e-05,5.215e-07,2.313e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.438e-02 S size(rtasks)=231 size(Rlst2)=16 T(Rmu/Rlist)=9.752e-04,2.341e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.460e-02 S size(rtasks)=231 size(Rlst)=2245 -----
rank=0 GPUmem(GB): used=1.664e-04 avail=6.174e+00 total=6.174e+00 batch[need]=1.104e-03 blksize=20 blksize0=25 batchsize=2245
rank=0 GPUmem(GB): used=1.270e-03 (oper,site,rinter,batch)=8.873e-05,5.215e-07,2.313e-05,1.104e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.295e-03,2.282e-02,1.020e-02
----- TIMING FOR renorm : t_inter=6.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=26 t=6.3e-03 per=1.6e+01 cost=3.5e+05 flops=5.6e+07
 renorm[gemm] counter=26 i=0 t=5.7e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=2 t=7.6e-03 per=1.9e+01 cost=1.2e+04 flops=1.6e+06
 renorm[gemm] counter=26 i=3 t=7.7e-03 per=1.9e+01 cost=1.0e+05 flops=1.3e+07
 renorm[gemm] counter=26 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=6 t=7.6e-03 per=1.9e+01 cost=1.2e+05 flops=1.6e+07
 renorm[gemm] counter=26 total t=2.3e-02 per=5.8e+01 cost=2.4e+05 flops=1.0e+07
 renorm[red] counter=26 t=1.0e-02 per=2.6e+01 cost=3.7e+04 flops=3.6e+06
----- TIMING FOR renorm_tot : t_inter=1.5e-01 t_gemm=5.9e-01 t_reduction=2.6e-01 tot=1.0e+00 -----
 renorm_tot[inter] counter=26 t=1.5e-01 per=1.5e+01 cost=2.7e+06 flops=1.8e+07
 renorm_tot[gemm] counter=26 i=0 t=4.3e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=1 t=3.3e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=2 t=6.8e-02 per=6.8e+00 cost=1.4e+05 flops=2.0e+06
 renorm_tot[gemm] counter=26 i=3 t=6.8e-02 per=6.8e+00 cost=3.0e+05 flops=4.4e+06
 renorm_tot[gemm] counter=26 i=4 t=1.3e-01 per=1.3e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=26 i=5 t=1.3e-01 per=1.3e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=26 i=6 t=2.0e-01 per=2.0e+01 cost=1.4e+06 flops=7.2e+06
 renorm_tot[gemm] counter=26 total t=5.9e-01 per=5.9e+01 cost=2.6e+06 flops=4.4e+06
 renorm_tot[red] counter=26 t=2.6e-01 per=2.6e+01 cost=6.2e+05 flops=2.4e+06
----- TIMING FOR oper_renorm : 9.0e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.018e+00 pageheap_free=1.476e-02 change=8.251e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.525e-02 change=-2.463e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=5884:4.489e-02MB:4.384e-05GB
        per(mem): H:0.578 C:2.04 S:2.04 P:0 Q:95.3 
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.525e-02 change=3.304e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.525e-02 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.417e-04 avail=6.174e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=0 ifkr=1 maxsize=5610:4.180e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:110 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=5610:4.280e-02MB:4.180e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.00185 tinit=0.00185
   copy opB to qops_tmps: dt=0.00247 tcopy=0.00247
   bcast: size(opB)=5610:4.18e-05GB dt=3.7e-08 speed=1.13e+03GB/s tcomm=3.7e-08
   compute opQ from opB: dt=0.00498 tcomp=0.00498
iproc=0
 qops_tmp: oplist=N nops=N:110 
        dim(bra,ket)=10,10 size(op)=68:0.000519MB size(tot)=5610:0.0428MB:4.18e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.00173 tinit=0.00357
   from opB to opB.H(): dt=0.00763 tadjt=0.00763
   bcast: size(opN)=5610:4.18e-05GB dt=4.1e-08 speed=1.02e+03GB/s tcomm=7.8e-08
   compute opQ from opB.H(): dt=0.00504 tcomp=0.01
----- TIMING FOR oper_b2qGPU : 0.0242 S T(init/copy/adjt+bcast/comp/rest)=0.00357,0.00247,0.00763,0.01,0.000522 -----
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.525e-02 change=6.557e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.417e-04 avail=6.174e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.525e-02 change=4.578e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.417e-04 avail=6.174e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.525e-02 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=1.417e-04 avail=6.174e+00 before move
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.840e-02 change=-3.315e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=9.788e-05 avail=6.174e+00 after move
check ||H-H.dagger||=9.496e-15 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0295 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00408,2.02e-05,5.86e-06,0.0242,0,0.000422,0.000673 -----
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.840e-02 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.840e-02 change=-2.921e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.724e+00 S #####
 T(local opt: fetch) = 1.609e-02 S  per = 0.591  per(accum) = 0.591
 T(local opt: hdiag) = 1.268e+00 S  per = 46.6  per(accum) = 47.1
 T(local opt: dvdsn) = 1.303e+00 S  per = 47.8  per(accum) = 95
 T(local opt: decim) = 1.109e-02 S  per = 0.407  per(accum) = 95.4
 T(local opt: guess) = 1.172e-03 S  per = 0.043  per(accum) = 95.4
 T(local opt: renrm) = 1.248e-01 S  per = 4.58  per(accum) = 100
 T(local opt: save ) = 3.629e-04 S  per = 0.0133  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.303e+00 S  T(sum) = 1.301e+00 S  per = 9.985e+01
 T(local opt: preprocess                  ) = 6.196e-03 S  per = 0.476  per(accum) = 0.476
 T(local opt: symbolic_formulae           ) = 1.700e-02 S  per = 1.31  per(accum) = 1.78
 T(local opt: hintermediate init          ) = 6.080e-04 S  per = 0.0467  per(accum) = 1.83
 T(local opt: preprocess_hformulae_Hxlist ) = 7.354e-01 S  per = 56.5  per(accum) = 58.4
 T(local opt: hmmtasks init               ) = 2.855e-01 S  per = 21.9  per(accum) = 80.3
 T(local opt: initial guess for dvdson    ) = 1.475e-03 S  per = 0.113  per(accum) = 80.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.837e-01 S  per = 14.1  per(accum) = 94.6
 T(local opt: dvdson [cpu-gpu]            ) = 8.532e-03 S  per = 0.656  per(accum) = 95.2
 T(local opt: dvdson [nccl]               ) = 5.011e-05 S  per = 0.00385  per(accum) = 95.2
 T(local opt: dvdson [mpi]                ) = 9.090e-07 S  per = 6.99e-05  per(accum) = 95.2
 T(local opt: dvdson [rest part(linalg)]  ) = 6.225e-02 S  per = 4.79  per(accum) = 100
Detailed decomposition of T(renrm) = 1.248e-01 S  T(sum) = 1.248e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.480e-04 S  per = 0.199  per(accum) = 0.199
 T(local opt: qops init                    ) = 5.094e-03 S  per = 4.08  per(accum) = 4.28
 T(local opt: symbolic_formulae_renorm     ) = 4.453e-03 S  per = 3.57  per(accum) = 7.85
 T(local opt: allocate qops on gpu         ) = 6.772e-05 S  per = 0.0543  per(accum) = 7.9
 T(local opt: site memcpy cpu2gpu          ) = 1.373e-03 S  per =  1.1  per(accum) = 9
 T(local opt: rintermediate init           ) = 2.495e-03 S  per =    2  per(accum) = 11
 T(local opt: preprocess_formulae_Rlist2   ) = 2.469e-02 S  per = 19.8  per(accum) = 30.8
 T(local opt: rmmtasks init                ) = 1.267e-02 S  per = 10.2  per(accum) = 40.9
 T(local opt: qops memset on cpu           ) = 5.700e-08 S  per = 4.57e-05  per(accum) = 40.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.941e-02 S  per = 31.6  per(accum) = 72.5
 T(local opt: deallocate cpu and gpu memory) = 9.098e-05 S  per = 0.0729  per(accum) = 72.6
 T(local opt: construct opS [ifdists=true] ) = 5.300e-08 S  per = 4.25e-05  per(accum) = 72.6
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 2.96e-05  per(accum) = 72.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.600e-08 S  per = 2.08e-05  per(accum) = 72.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.830e-07 S  per = 0.000147  per(accum) = 72.6
 T(local opt: qops_pool join and erase     ) = 4.662e-03 S  per = 3.74  per(accum) = 76.3
 T(local opt: conversion from opAB to opPQ ) = 2.955e-02 S  per = 23.7  per(accum) = 100
##### sweep opt: 3.497e+01 S #####
 T(sweep opt: fetch) = 3.788e-01 S  per = 1.08  per(accum) = 1.08
 T(sweep opt: hdiag) = 1.317e+01 S  per = 37.7  per(accum) = 38.7
 T(sweep opt: dvdsn) = 1.842e+01 S  per = 52.7  per(accum) = 91.4
 T(sweep opt: decim) = 3.527e-01 S  per = 1.01  per(accum) = 92.4
 T(sweep opt: guess) = 3.200e-02 S  per = 0.0915  per(accum) = 92.5
 T(sweep opt: renrm) = 2.606e+00 S  per = 7.45  per(accum) = 100
 T(sweep opt: save ) = 8.531e-03 S  per = 0.0244  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.842e+01 S  T(sum) = 1.838e+01 S  per = 9.977e+01
 T(sweep opt: preprocess                  ) = 1.434e-01 S  per = 0.78  per(accum) = 0.78
 T(sweep opt: symbolic_formulae           ) = 2.034e-01 S  per = 1.11  per(accum) = 1.89
 T(sweep opt: hintermediate init          ) = 7.632e-03 S  per = 0.0415  per(accum) = 1.93
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.500e+00 S  per = 35.4  per(accum) = 37.3
 T(sweep opt: hmmtasks init               ) = 2.628e+00 S  per = 14.3  per(accum) = 51.6
 T(sweep opt: initial guess for dvdson    ) = 3.797e-02 S  per = 0.207  per(accum) = 51.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.954e+00 S  per = 37.8  per(accum) = 89.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.150e-01 S  per = 1.17  per(accum) = 90.8
 T(sweep opt: dvdson [nccl]               ) = 1.174e-03 S  per = 0.00639  per(accum) = 90.8
 T(sweep opt: dvdson [mpi]                ) = 2.709e-05 S  per = 0.000147  per(accum) = 90.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.690e+00 S  per = 9.19  per(accum) = 100
Detailed decomposition of T(renrm) = 2.606e+00 S  T(sum) = 2.606e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.316e-03 S  per = 0.319  per(accum) = 0.319
 T(sweep opt: qops init                    ) = 9.615e-02 S  per = 3.69  per(accum) = 4.01
 T(sweep opt: symbolic_formulae_renorm     ) = 1.007e-01 S  per = 3.86  per(accum) = 7.87
 T(sweep opt: allocate qops on gpu         ) = 3.601e-03 S  per = 0.138  per(accum) = 8.01
 T(sweep opt: site memcpy cpu2gpu          ) = 3.584e-02 S  per = 1.38  per(accum) = 9.39
 T(sweep opt: rintermediate init           ) = 6.294e-02 S  per = 2.42  per(accum) = 11.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.571e-01 S  per = 29.1  per(accum) = 40.9
 T(sweep opt: rmmtasks init                ) = 3.857e-01 S  per = 14.8  per(accum) = 55.7
 T(sweep opt: qops memset on cpu           ) = 1.046e-06 S  per = 4.01e-05  per(accum) = 55.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.004e+00 S  per = 38.5  per(accum) = 94.2
 T(sweep opt: deallocate cpu and gpu memory) = 3.140e-03 S  per = 0.12  per(accum) = 94.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.389e-06 S  per = 5.33e-05  per(accum) = 94.3
 T(sweep opt: reduction of opS & opH [nccl]) = 1.045e-06 S  per = 4.01e-05  per(accum) = 94.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.058e-03 S  per = 0.117  per(accum) = 94.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.340e-03 S  per = 0.0514  per(accum) = 94.5
 T(sweep opt: qops_pool join and erase     ) = 8.217e-02 S  per = 3.15  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 6.204e-02 S  per = 2.38  per(accum) = 100
##### global opt: 3.497e+01 S #####
 T(global opt: fetch) = 3.788e-01 S  per = 1.08  per(accum) = 1.08
 T(global opt: hdiag) = 1.317e+01 S  per = 37.7  per(accum) = 38.7
 T(global opt: dvdsn) = 1.842e+01 S  per = 52.7  per(accum) = 91.4
 T(global opt: decim) = 3.527e-01 S  per = 1.01  per(accum) = 92.4
 T(global opt: guess) = 3.200e-02 S  per = 0.0915  per(accum) = 92.5
 T(global opt: renrm) = 2.606e+00 S  per = 7.45  per(accum) = 100
 T(global opt: save ) = 8.531e-03 S  per = 0.0244  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.842e+01 S  T(sum) = 1.838e+01 S  per = 9.977e+01
 T(global opt: preprocess                  ) = 1.434e-01 S  per = 0.78  per(accum) = 0.78
 T(global opt: symbolic_formulae           ) = 2.034e-01 S  per = 1.11  per(accum) = 1.89
 T(global opt: hintermediate init          ) = 7.632e-03 S  per = 0.0415  per(accum) = 1.93
 T(global opt: preprocess_hformulae_Hxlist ) = 6.500e+00 S  per = 35.4  per(accum) = 37.3
 T(global opt: hmmtasks init               ) = 2.628e+00 S  per = 14.3  per(accum) = 51.6
 T(global opt: initial guess for dvdson    ) = 3.797e-02 S  per = 0.207  per(accum) = 51.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.954e+00 S  per = 37.8  per(accum) = 89.6
 T(global opt: dvdson [cpu-gpu]            ) = 2.150e-01 S  per = 1.17  per(accum) = 90.8
 T(global opt: dvdson [nccl]               ) = 1.174e-03 S  per = 0.00639  per(accum) = 90.8
 T(global opt: dvdson [mpi]                ) = 2.709e-05 S  per = 0.000147  per(accum) = 90.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.690e+00 S  per = 9.19  per(accum) = 100
Detailed decomposition of T(renrm) = 2.606e+00 S  T(sum) = 2.606e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.316e-03 S  per = 0.319  per(accum) = 0.319
 T(global opt: qops init                    ) = 9.615e-02 S  per = 3.69  per(accum) = 4.01
 T(global opt: symbolic_formulae_renorm     ) = 1.007e-01 S  per = 3.86  per(accum) = 7.87
 T(global opt: allocate qops on gpu         ) = 3.601e-03 S  per = 0.138  per(accum) = 8.01
 T(global opt: site memcpy cpu2gpu          ) = 3.584e-02 S  per = 1.38  per(accum) = 9.39
 T(global opt: rintermediate init           ) = 6.294e-02 S  per = 2.42  per(accum) = 11.8
 T(global opt: preprocess_formulae_Rlist2   ) = 7.571e-01 S  per = 29.1  per(accum) = 40.9
 T(global opt: rmmtasks init                ) = 3.857e-01 S  per = 14.8  per(accum) = 55.7
 T(global opt: qops memset on cpu           ) = 1.046e-06 S  per = 4.01e-05  per(accum) = 55.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.004e+00 S  per = 38.5  per(accum) = 94.2
 T(global opt: deallocate cpu and gpu memory) = 3.140e-03 S  per = 0.12  per(accum) = 94.3
 T(global opt: construct opS [ifdists=true] ) = 1.389e-06 S  per = 5.33e-05  per(accum) = 94.3
 T(global opt: reduction of opS & opH [nccl]) = 1.045e-06 S  per = 4.01e-05  per(accum) = 94.3
 T(global opt: qops memcpy gpu2cpu          ) = 3.058e-03 S  per = 0.117  per(accum) = 94.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.340e-03 S  per = 0.0514  per(accum) = 94.5
 T(global opt: qops_pool join and erase     ) = 8.217e-02 S  per = 3.15  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 6.204e-02 S  per = 2.38  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-9.357e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=26/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=778:5.936e-03MB:5.797e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=64:4.883e-04MB:4.768e-07GB
total mem of comb=843:6.432e-03MB:6.281e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:12 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
        per(mem): H:0.879 C:3.02 S:4.52 A:0 B:91.6 
 rqops: oplist=HCSPQ nops=H:1 C:10 S:10 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=68:0.000519MB size(tot)=5884:0.0449MB:4.38e-05GB
        per(mem): H:0.578 C:2.04 S:2.04 P:0 Q:95.3 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=11064:0.0844MB:8.24e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.137e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-2.438e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=138:1.053e-03MB
qtensor4: wf4 own=1 _data=0x398d9180
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
 qbond: qcol nsym=4 dimAll=10
 (15,3):4 (15,1):4 (16,2):1 (16,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=27 nblocks=304 size=138:1.053e-03MB
### DIAG TIMING: total=9.731e-01 t1=4.558e-05, t2=1.535e-03, t3=2.534e-03, t4=9.690e-01, t5=5.363e-06, t6=1.933e-05, t7=4.553e-06
duration_diagGPU:9.731e-01
duration_diagreduce:5.700e-08
duration_diagtransform:1.095e-06
----- TIMING FOR symbolic_formulae_twodot with size=831 : 1.159e-02 S -----
rank=0 GPUmem(GB): used=8.243e-05 (oper)=8.243e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=831
 no. of hintermediate operators=386
 no. of coefficients=5612:4.282e-02MB:4.181e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.293e-04 S -----
rank=0 GPUmem(GB): used=1.242e-04 (oper,hinter)=8.243e-05,4.181e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.454e-01 S size(H_formulae)=831 size(Hxlst2)=27 T(Hmu/Hxlist)=2.333e-03,4.430e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.496e-01 S size(H_formulae)=831 size(Hxlst)=26936 -----
rank=0 GPUmem(GB): used=1.242e-04 avail=3.639e+01 total=3.639e+01 dvdson[need]=2.056e-06 batch[need]=9.834e-03 blksize=16 blksize0=16 batchsize=26936
rank=0 GPUmem(GB): used=9.960e-03 (oper,hinter,dvdson,batch)=8.243e-05,4.181e-05,2.056e-06,9.834e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=138 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.723e-04,4.870e-03,9.772e-03,1.029e-02,2.583e-02
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=8.581e-04 speed=2.396e-03GB/S T(nccl)=1.418e-05 speed=1.451e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=9.8e-03 t_reduction=1.0e-02 tot=2.5e-02 -----
 sigma[inter] counter=162 t=4.9e-03 per=2.0e+01 cost=1.7e+06 flops=3.6e+08
 sigma[gemm] counter=162 i=0 t=1.4e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=2 t=1.2e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=3 t=1.1e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=4 t=2.4e-03 per=9.7e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=162 i=5 t=2.5e-03 per=9.9e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=162 i=6 t=2.4e-03 per=9.8e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=162 i=7 t=2.4e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=162 total t=9.8e-03 per=3.9e+01 cost=1.3e+06 flops=1.3e+08
 sigma[red] counter=162 t=1.0e-02 per=4.1e+01 cost=2.9e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=162 t=1.4e+00 per=2.0e+01 cost=1.4e+08 flops=1.0e+08
 sigma_tot[gemm] counter=162 i=0 t=3.4e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=1 t=2.9e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=2 t=2.6e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=3 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=4 t=9.5e-01 per=1.4e+01 cost=2.7e+07 flops=2.8e+07
 sigma_tot[gemm] counter=162 i=5 t=9.6e-01 per=1.4e+01 cost=2.7e+07 flops=2.8e+07
 sigma_tot[gemm] counter=162 i=6 t=9.4e-01 per=1.4e+01 cost=2.2e+07 flops=2.4e+07
 sigma_tot[gemm] counter=162 i=7 t=9.4e-01 per=1.3e+01 cost=2.3e+07 flops=2.5e+07
 sigma_tot[gemm] counter=162 total t=3.8e+00 per=5.5e+01 cost=1.0e+08 flops=2.6e+07
 sigma_tot[red] counter=162 t=1.8e+00 per=2.6e+01 cost=2.4e+07 flops=1.3e+07
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,7.4e-06,2.4e-06,9.9e-07,2.4e-07
settings: ndim=138 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.330547046388 -1.116e+03  2.582e-02    1     1  2.598e-02 2.598e-02 2.594e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.047e-03,4.858e-03,9.779e-03,1.032e-02,2.701e-02
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.041e-03 speed=1.007e-03GB/S T(nccl)=5.736e-06 speed=3.585e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=9.8e-03 t_reduction=1.0e-02 tot=2.5e-02 -----
 sigma[inter] counter=163 t=4.9e-03 per=1.9e+01 cost=1.7e+06 flops=3.6e+08
 sigma[gemm] counter=163 i=0 t=1.9e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=1 t=1.7e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=2 t=2.1e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=3 t=1.6e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=4 t=2.4e-03 per=9.8e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=163 i=5 t=2.4e-03 per=9.8e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=163 i=6 t=2.4e-03 per=9.8e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=163 i=7 t=2.4e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=163 total t=9.8e-03 per=3.9e+01 cost=1.3e+06 flops=1.3e+08
 sigma[red] counter=163 t=1.0e-02 per=4.1e+01 cost=2.9e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=163 t=1.4e+00 per=2.0e+01 cost=1.4e+08 flops=1.0e+08
 sigma_tot[gemm] counter=163 i=0 t=3.4e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=1 t=2.9e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=2 t=2.6e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=3 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=4 t=9.6e-01 per=1.4e+01 cost=2.7e+07 flops=2.9e+07
 sigma_tot[gemm] counter=163 i=5 t=9.7e-01 per=1.4e+01 cost=2.7e+07 flops=2.8e+07
 sigma_tot[gemm] counter=163 i=6 t=9.5e-01 per=1.4e+01 cost=2.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=163 i=7 t=9.4e-01 per=1.3e+01 cost=2.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=163 total t=3.8e+00 per=5.5e+01 cost=1.0e+08 flops=2.7e+07
 sigma_tot[red] counter=163 t=1.8e+00 per=2.6e+01 cost=2.4e+07 flops=1.4e+07
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.0e-06,2.3e-05,3.8e-06,1.7e-06,2.1e-07
    2   0 -    -116.332203099011 -1.656e-03  8.292e-03    2     2  6.172e-02 3.086e-02 2.653e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.133e-03,4.863e-03,9.776e-03,1.031e-02,2.610e-02
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=1.127e-03 speed=1.825e-03GB/S T(nccl)=5.455e-06 speed=3.770e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=9.8e-03 t_reduction=1.0e-02 tot=2.5e-02 -----
 sigma[inter] counter=164 t=4.9e-03 per=1.9e+01 cost=1.7e+06 flops=3.6e+08
 sigma[gemm] counter=164 i=0 t=1.9e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=1 t=1.7e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=2 t=1.7e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=3 t=1.7e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=4 t=2.4e-03 per=9.7e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=164 i=5 t=2.5e-03 per=9.9e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=164 i=6 t=2.4e-03 per=9.8e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=164 i=7 t=2.4e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=164 total t=9.8e-03 per=3.9e+01 cost=1.3e+06 flops=1.3e+08
 sigma[red] counter=164 t=1.0e-02 per=4.1e+01 cost=2.9e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=164 t=1.4e+00 per=2.0e+01 cost=1.4e+08 flops=1.0e+08
 sigma_tot[gemm] counter=164 i=0 t=3.4e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=1 t=2.9e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=2 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=4 t=9.6e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=164 i=5 t=9.7e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=164 i=6 t=9.5e-01 per=1.4e+01 cost=2.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=164 i=7 t=9.4e-01 per=1.3e+01 cost=2.4e+07 flops=2.6e+07
 sigma_tot[gemm] counter=164 total t=3.8e+00 per=5.5e+01 cost=1.0e+08 flops=2.7e+07
 sigma_tot[red] counter=164 t=1.8e+00 per=2.6e+01 cost=2.5e+07 flops=1.4e+07
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,2.2e-05,3.5e-06,1.5e-06,2.1e-07
    3   0 -    -116.332367339197 -1.642e-04  2.832e-03    3     3  9.747e-02 3.249e-02 2.643e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.334e-03,4.858e-03,9.788e-03,1.031e-02,2.630e-02
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=1.329e-03 speed=1.548e-03GB/S T(nccl)=5.631e-06 speed=3.652e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=9.8e-03 t_reduction=1.0e-02 tot=2.5e-02 -----
 sigma[inter] counter=165 t=4.9e-03 per=1.9e+01 cost=1.7e+06 flops=3.6e+08
 sigma[gemm] counter=165 i=0 t=1.9e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=1 t=1.7e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=2 t=1.6e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=3 t=1.6e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=4 t=2.4e-03 per=9.7e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=165 i=5 t=2.5e-03 per=9.8e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=165 i=6 t=2.4e-03 per=9.8e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=165 i=7 t=2.4e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=165 total t=9.8e-03 per=3.9e+01 cost=1.3e+06 flops=1.3e+08
 sigma[red] counter=165 t=1.0e-02 per=4.1e+01 cost=2.9e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=165 t=1.4e+00 per=2.0e+01 cost=1.4e+08 flops=1.0e+08
 sigma_tot[gemm] counter=165 i=0 t=3.4e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=1 t=2.9e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=2 t=2.6e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=4 t=9.6e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=165 i=5 t=9.7e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=165 i=6 t=9.5e-01 per=1.4e+01 cost=2.3e+07 flops=2.5e+07
 sigma_tot[gemm] counter=165 i=7 t=9.4e-01 per=1.3e+01 cost=2.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=165 total t=3.8e+00 per=5.5e+01 cost=1.0e+08 flops=2.7e+07
 sigma_tot[red] counter=165 t=1.8e+00 per=2.6e+01 cost=2.5e+07 flops=1.4e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.5e-05,3.4e-06,1.4e-06,2.3e-07
    4   0 -    -116.332389606967 -2.227e-05  9.163e-04    3     4  1.332e-01 3.330e-02 2.642e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.223e-03,4.865e-03,9.770e-03,1.031e-02,2.717e-02
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=2.217e-03 speed=9.274e-04GB/S T(nccl)=5.555e-06 speed=3.702e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=9.8e-03 t_reduction=1.0e-02 tot=2.5e-02 -----
 sigma[inter] counter=166 t=4.9e-03 per=2.0e+01 cost=1.7e+06 flops=3.6e+08
 sigma[gemm] counter=166 i=0 t=1.4e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=1 t=1.2e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=2 t=1.2e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=3 t=1.2e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=4 t=2.4e-03 per=9.7e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=166 i=5 t=2.5e-03 per=9.8e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=166 i=6 t=2.4e-03 per=9.8e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=166 i=7 t=2.4e-03 per=9.8e+00 cost=3.8e+05 flops=1.6e+08
 sigma[gemm] counter=166 total t=9.8e-03 per=3.9e+01 cost=1.3e+06 flops=1.3e+08
 sigma[red] counter=166 t=1.0e-02 per=4.1e+01 cost=2.9e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=166 t=1.4e+00 per=2.0e+01 cost=1.4e+08 flops=1.0e+08
 sigma_tot[gemm] counter=166 i=0 t=3.5e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=1 t=2.9e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=2 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=4 t=9.6e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=166 i=5 t=9.7e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=166 i=6 t=9.5e-01 per=1.4e+01 cost=2.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=166 i=7 t=9.5e-01 per=1.3e+01 cost=2.5e+07 flops=2.6e+07
 sigma_tot[gemm] counter=166 total t=3.8e+00 per=5.4e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=166 t=1.8e+00 per=2.6e+01 cost=2.5e+07 flops=1.4e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.5e-05,3.6e-06,1.5e-06,2.4e-07
    5   0 -    -116.332392482142 -2.875e-06  2.901e-04    3     5  1.731e-01 3.462e-02 2.660e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.816e-03,4.860e-03,9.782e-03,1.030e-02,2.677e-02
 analyze_tgpu[Hx]: ndim=138:1.028e-06GB T(cpu-gpu)=1.811e-03 speed=1.136e-03GB/S T(nccl)=5.744e-06 speed=3.580e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=9.8e-03 t_reduction=1.0e-02 tot=2.5e-02 -----
 sigma[inter] counter=167 t=4.9e-03 per=1.9e+01 cost=1.7e+06 flops=3.6e+08
 sigma[gemm] counter=167 i=0 t=1.9e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=1 t=1.6e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=2 t=1.6e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=3 t=1.6e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=4 t=2.4e-03 per=9.7e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=167 i=5 t=2.5e-03 per=9.8e+00 cost=2.6e+05 flops=1.1e+08
 sigma[gemm] counter=167 i=6 t=2.4e-03 per=9.8e+00 cost=3.7e+05 flops=1.5e+08
 sigma[gemm] counter=167 i=7 t=2.4e-03 per=9.8e+00 cost=3.8e+05 flops=1.5e+08
 sigma[gemm] counter=167 total t=9.8e-03 per=3.9e+01 cost=1.3e+06 flops=1.3e+08
 sigma[red] counter=167 t=1.0e-02 per=4.1e+01 cost=2.9e+05 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.8e+00 t_reduction=1.8e+00 tot=7.1e+00 -----
 sigma_tot[inter] counter=167 t=1.4e+00 per=2.0e+01 cost=1.5e+08 flops=1.1e+08
 sigma_tot[gemm] counter=167 i=0 t=3.5e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=1 t=3.0e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=2 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=4 t=9.7e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=167 i=5 t=9.8e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=167 i=6 t=9.6e-01 per=1.4e+01 cost=2.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=167 i=7 t=9.5e-01 per=1.3e+01 cost=2.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=167 total t=3.8e+00 per=5.4e+01 cost=1.1e+08 flops=2.8e+07
 sigma_tot[red] counter=167 t=1.8e+00 per=2.6e+01 cost=2.5e+07 flops=1.4e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.5e-05,3.5e-06,1.4e-06,2.3e-07
    6   0 +    -116.332392700332 -2.182e-07  7.807e-05    3     6  2.088e-01 3.480e-02 2.664e-02
TIMING FOR Davidson : 2.088e-01  T(cal/comm/rest)=1.599e-01,8.760e-07,4.897e-02
decomposed t_rest=4.897e-02
 T(sub)    =1.599e-04 per=3.265e-01
 T(precond)=4.865e-02 per=9.935e+01
 T(ortho)  =2.371e-05 per=4.841e-02
 T(xcopy)  =1.131e-06 per=2.309e-03
 T(xnrm2)  =3.190e-06 per=6.514e-03
 T(other)  =1.322e-04 per=2.699e-01
optimized energies: isweep=0 ibond=26 dots=2 e[0]=-116.332392700332 nmvp=6
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.227e-02 change=6.740e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=10 dimAll=40
 (15,3):4 (15,1):4 (16,2):9 (16,4):5 (17,3):6 (17,1):5 (18,2):1 (18,4):1 (16,0):4 (17,5):1
timing for divide=9.6e-05
timing for compute=1.2e-02
timing for collect=2.4e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.6e-05,1.2e-02,0.0e+00,6.4e-06,2.4e-05 -----
decimation summary: 40->10 dwt=+1.635e-04 SvN=1.494e+00
 qbond: qkept nsym=5 dimAll=10
 (16,2):4 (16,0):3 (16,4):1 (17,3):1 (17,1):1
----- TIMING for decimation_row(nkr): 1.286e-02 S T(decim/select/formRot)=1.240e-02,3.637e-04,9.162e-05 -----
----- TIMING FOR twodot_decimation: 1.377e-02 S T(wf/decim)=8.092e-04,1.296e-02 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3913:2.985e-02MB:2.915e-05GB
        per(mem): H:0.716 C:3.37 S:2.76 P:0 Q:93.2 
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.453e-02 change=3.892e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=192 : 7.350e-03 S -----
rank=0 GPUmem(GB): used=1.297e-04 (oper)=8.043e-05
rank=0 GPUmem(GB): used=1.302e-04 (oper,site)=8.043e-05,4.768e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=192
 no. of rintermediate operators=288
 no. of coefficients=2880:2.197e-02MB:2.146e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.408e-03 S -----
rank=0 GPUmem(GB): used=1.516e-04 (oper,site,rinter)=8.043e-05,4.768e-07,2.146e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 5.879e-02 S size(rtasks)=192 size(Rlst2)=25 T(Rmu/Rlist)=2.126e-03,5.666e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.927e-02 S size(rtasks)=192 size(Rlst)=5087 -----
rank=0 GPUmem(GB): used=1.516e-04 avail=3.640e+01 total=3.640e+01 batch[need]=1.402e-03 blksize=16 blksize0=4 batchsize=5087
rank=0 GPUmem(GB): used=1.554e-03 (oper,site,rinter,batch)=8.043e-05,4.768e-07,2.146e-05,1.402e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.509e-03,2.181e-02,9.664e-03
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.2e-02 t_reduction=9.7e-03 tot=3.7e-02 -----
 renorm[inter] counter=27 t=5.5e-03 per=1.5e+01 cost=1.4e+05 flops=2.5e+07
 renorm[gemm] counter=27 i=0 t=1.3e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=2 t=7.2e-03 per=2.0e+01 cost=1.8e+04 flops=2.4e+06
 renorm[gemm] counter=27 i=3 t=7.3e-03 per=2.0e+01 cost=1.1e+05 flops=1.5e+07
 renorm[gemm] counter=27 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=5 t=1.1e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=6 t=7.3e-03 per=2.0e+01 cost=1.7e+05 flops=2.3e+07
 renorm[gemm] counter=27 total t=2.2e-02 per=5.9e+01 cost=2.9e+05 flops=1.3e+07
 renorm[red] counter=27 t=9.7e-03 per=2.6e+01 cost=5.4e+04 flops=5.6e+06
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=6.1e-01 t_reduction=2.7e-01 tot=1.0e+00 -----
 renorm_tot[inter] counter=27 t=1.6e-01 per=1.5e+01 cost=2.8e+06 flops=1.8e+07
 renorm_tot[gemm] counter=27 i=0 t=4.4e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=1 t=3.4e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=2 t=7.5e-02 per=7.3e+00 cost=1.6e+05 flops=2.1e+06
 renorm_tot[gemm] counter=27 i=3 t=7.6e-02 per=7.3e+00 cost=4.1e+05 flops=5.4e+06
 renorm_tot[gemm] counter=27 i=4 t=1.3e-01 per=1.2e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=27 i=5 t=1.3e-01 per=1.2e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=27 i=6 t=2.0e-01 per=2.0e+01 cost=1.6e+06 flops=7.7e+06
 renorm_tot[gemm] counter=27 total t=6.1e-01 per=5.9e+01 cost=2.9e+06 flops=4.7e+06
 renorm_tot[red] counter=27 t=2.7e-01 per=2.6e+01 cost=6.7e+05 flops=2.5e+06
qops.to_cpu: size(tot)=3913:3.0e-02MB:2.9e-05GB T(to_cpu)=1.9e-04S speed=1.5e-01GB/S
check ||H-H.dagger||=1.262e-14 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.148 S rank=0 -----
rank=0 CPUmem(GB): used=1.016e+00 pageheap_free=1.250e-02 change=1.551e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.625e-02 change=-2.992e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.625e-02 change=-3.695e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.499e+00 S #####
 T(local opt: fetch) = 1.334e-02 S  per = 0.534  per(accum) = 0.534
 T(local opt: hdiag) = 9.738e-01 S  per =   39  per(accum) = 39.5
 T(local opt: dvdsn) = 1.344e+00 S  per = 53.8  per(accum) = 93.3
 T(local opt: decim) = 1.392e-02 S  per = 0.557  per(accum) = 93.9
 T(local opt: guess) = 1.265e-03 S  per = 0.0506  per(accum) = 93.9
 T(local opt: renrm) = 1.521e-01 S  per = 6.08  per(accum) = 100
 T(local opt: save ) = 3.303e-04 S  per = 0.0132  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.344e+00 S  T(sum) = 1.338e+00 S  per = 9.950e+01
 T(local opt: preprocess                  ) = 4.587e-03 S  per = 0.343  per(accum) = 0.343
 T(local opt: symbolic_formulae           ) = 1.161e-02 S  per = 0.868  per(accum) = 1.21
 T(local opt: hintermediate init          ) = 4.550e-04 S  per = 0.034  per(accum) = 1.24
 T(local opt: preprocess_hformulae_Hxlist ) = 4.509e-01 S  per = 33.7  per(accum) = 35
 T(local opt: hmmtasks init               ) = 6.596e-01 S  per = 49.3  per(accum) = 84.3
 T(local opt: initial guess for dvdson    ) = 1.577e-03 S  per = 0.118  per(accum) = 84.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.504e-01 S  per = 11.2  per(accum) = 95.6
 T(local opt: dvdson [cpu-gpu]            ) = 9.383e-03 S  per = 0.702  per(accum) = 96.3
 T(local opt: dvdson [nccl]               ) = 4.230e-05 S  per = 0.00316  per(accum) = 96.3
 T(local opt: dvdson [mpi]                ) = 8.760e-07 S  per = 6.55e-05  per(accum) = 96.3
 T(local opt: dvdson [rest part(linalg)]  ) = 4.897e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(renrm) = 1.521e-01 S  T(sum) = 1.521e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.033e-04 S  per = 0.199  per(accum) = 0.199
 T(local opt: qops init                    ) = 6.411e-03 S  per = 4.22  per(accum) = 4.42
 T(local opt: symbolic_formulae_renorm     ) = 7.366e-03 S  per = 4.84  per(accum) = 9.26
 T(local opt: allocate qops on gpu         ) = 6.259e-05 S  per = 0.0412  per(accum) = 9.3
 T(local opt: site memcpy cpu2gpu          ) = 1.874e-03 S  per = 1.23  per(accum) = 10.5
 T(local opt: rintermediate init           ) = 2.421e-03 S  per = 1.59  per(accum) = 12.1
 T(local opt: preprocess_formulae_Rlist2   ) = 5.945e-02 S  per = 39.1  per(accum) = 51.2
 T(local opt: rmmtasks init                ) = 3.281e-02 S  per = 21.6  per(accum) = 72.8
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 2.63e-05  per(accum) = 72.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.707e-02 S  per = 24.4  per(accum) = 97.2
 T(local opt: deallocate cpu and gpu memory) = 1.694e-04 S  per = 0.111  per(accum) = 97.3
 T(local opt: construct opS [ifdists=true] ) = 4.400e-08 S  per = 2.89e-05  per(accum) = 97.3
 T(local opt: reduction of opS & opH [nccl]) = 3.600e-08 S  per = 2.37e-05  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 2.056e-04 S  per = 0.135  per(accum) = 97.4
 T(local opt: reduction of opS & opH [mpi] ) = 6.824e-05 S  per = 0.0449  per(accum) = 97.5
 T(local opt: qops_pool join and erase     ) = 3.841e-03 S  per = 2.53  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.064e-06 S  per = 0.0053  per(accum) = 100
##### sweep opt: 3.747e+01 S #####
 T(sweep opt: fetch) = 3.922e-01 S  per = 1.05  per(accum) = 1.05
 T(sweep opt: hdiag) = 1.415e+01 S  per = 37.8  per(accum) = 38.8
 T(sweep opt: dvdsn) = 1.977e+01 S  per = 52.8  per(accum) = 91.5
 T(sweep opt: decim) = 3.666e-01 S  per = 0.978  per(accum) = 92.5
 T(sweep opt: guess) = 3.327e-02 S  per = 0.0888  per(accum) = 92.6
 T(sweep opt: renrm) = 2.758e+00 S  per = 7.36  per(accum) = 100
 T(sweep opt: save ) = 8.862e-03 S  per = 0.0236  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.977e+01 S  T(sum) = 1.972e+01 S  per = 9.975e+01
 T(sweep opt: preprocess                  ) = 1.480e-01 S  per = 0.75  per(accum) = 0.75
 T(sweep opt: symbolic_formulae           ) = 2.150e-01 S  per = 1.09  per(accum) = 1.84
 T(sweep opt: hintermediate init          ) = 8.087e-03 S  per = 0.041  per(accum) = 1.88
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.951e+00 S  per = 35.3  per(accum) = 37.1
 T(sweep opt: hmmtasks init               ) = 3.288e+00 S  per = 16.7  per(accum) = 53.8
 T(sweep opt: initial guess for dvdson    ) = 3.954e-02 S  per = 0.201  per(accum) = 54
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.104e+00 S  per =   36  per(accum) = 90
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.244e-01 S  per = 1.14  per(accum) = 91.2
 T(sweep opt: dvdson [nccl]               ) = 1.216e-03 S  per = 0.00617  per(accum) = 91.2
 T(sweep opt: dvdson [mpi]                ) = 2.797e-05 S  per = 0.000142  per(accum) = 91.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.739e+00 S  per = 8.82  per(accum) = 100
Detailed decomposition of T(renrm) = 2.758e+00 S  T(sum) = 2.758e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.619e-03 S  per = 0.313  per(accum) = 0.313
 T(sweep opt: qops init                    ) = 1.026e-01 S  per = 3.72  per(accum) = 4.03
 T(sweep opt: symbolic_formulae_renorm     ) = 1.081e-01 S  per = 3.92  per(accum) = 7.95
 T(sweep opt: allocate qops on gpu         ) = 3.664e-03 S  per = 0.133  per(accum) = 8.08
 T(sweep opt: site memcpy cpu2gpu          ) = 3.772e-02 S  per = 1.37  per(accum) = 9.45
 T(sweep opt: rintermediate init           ) = 6.537e-02 S  per = 2.37  per(accum) = 11.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.165e-01 S  per = 29.6  per(accum) = 41.4
 T(sweep opt: rmmtasks init                ) = 4.185e-01 S  per = 15.2  per(accum) = 56.6
 T(sweep opt: qops memset on cpu           ) = 1.086e-06 S  per = 3.94e-05  per(accum) = 56.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.041e+00 S  per = 37.7  per(accum) = 94.3
 T(sweep opt: deallocate cpu and gpu memory) = 3.309e-03 S  per = 0.12  per(accum) = 94.5
 T(sweep opt: construct opS [ifdists=true] ) = 1.433e-06 S  per = 5.2e-05  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.081e-06 S  per = 3.92e-05  per(accum) = 94.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.263e-03 S  per = 0.118  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.408e-03 S  per = 0.0511  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 8.601e-02 S  per = 3.12  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 6.205e-02 S  per = 2.25  per(accum) = 100
##### global opt: 3.747e+01 S #####
 T(global opt: fetch) = 3.922e-01 S  per = 1.05  per(accum) = 1.05
 T(global opt: hdiag) = 1.415e+01 S  per = 37.8  per(accum) = 38.8
 T(global opt: dvdsn) = 1.977e+01 S  per = 52.8  per(accum) = 91.5
 T(global opt: decim) = 3.666e-01 S  per = 0.978  per(accum) = 92.5
 T(global opt: guess) = 3.327e-02 S  per = 0.0888  per(accum) = 92.6
 T(global opt: renrm) = 2.758e+00 S  per = 7.36  per(accum) = 100
 T(global opt: save ) = 8.862e-03 S  per = 0.0236  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.977e+01 S  T(sum) = 1.972e+01 S  per = 9.975e+01
 T(global opt: preprocess                  ) = 1.480e-01 S  per = 0.75  per(accum) = 0.75
 T(global opt: symbolic_formulae           ) = 2.150e-01 S  per = 1.09  per(accum) = 1.84
 T(global opt: hintermediate init          ) = 8.087e-03 S  per = 0.041  per(accum) = 1.88
 T(global opt: preprocess_hformulae_Hxlist ) = 6.951e+00 S  per = 35.3  per(accum) = 37.1
 T(global opt: hmmtasks init               ) = 3.288e+00 S  per = 16.7  per(accum) = 53.8
 T(global opt: initial guess for dvdson    ) = 3.954e-02 S  per = 0.201  per(accum) = 54
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.104e+00 S  per =   36  per(accum) = 90
 T(global opt: dvdson [cpu-gpu]            ) = 2.244e-01 S  per = 1.14  per(accum) = 91.2
 T(global opt: dvdson [nccl]               ) = 1.216e-03 S  per = 0.00617  per(accum) = 91.2
 T(global opt: dvdson [mpi]                ) = 2.797e-05 S  per = 0.000142  per(accum) = 91.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.739e+00 S  per = 8.82  per(accum) = 100
Detailed decomposition of T(renrm) = 2.758e+00 S  T(sum) = 2.758e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.619e-03 S  per = 0.313  per(accum) = 0.313
 T(global opt: qops init                    ) = 1.026e-01 S  per = 3.72  per(accum) = 4.03
 T(global opt: symbolic_formulae_renorm     ) = 1.081e-01 S  per = 3.92  per(accum) = 7.95
 T(global opt: allocate qops on gpu         ) = 3.664e-03 S  per = 0.133  per(accum) = 8.08
 T(global opt: site memcpy cpu2gpu          ) = 3.772e-02 S  per = 1.37  per(accum) = 9.45
 T(global opt: rintermediate init           ) = 6.537e-02 S  per = 2.37  per(accum) = 11.8
 T(global opt: preprocess_formulae_Rlist2   ) = 8.165e-01 S  per = 29.6  per(accum) = 41.4
 T(global opt: rmmtasks init                ) = 4.185e-01 S  per = 15.2  per(accum) = 56.6
 T(global opt: qops memset on cpu           ) = 1.086e-06 S  per = 3.94e-05  per(accum) = 56.6
 T(global opt: preprocess_renorm_batchGPU   ) = 1.041e+00 S  per = 37.7  per(accum) = 94.3
 T(global opt: deallocate cpu and gpu memory) = 3.309e-03 S  per = 0.12  per(accum) = 94.5
 T(global opt: construct opS [ifdists=true] ) = 1.433e-06 S  per = 5.2e-05  per(accum) = 94.5
 T(global opt: reduction of opS & opH [nccl]) = 1.081e-06 S  per = 3.92e-05  per(accum) = 94.5
 T(global opt: qops memcpy gpu2cpu          ) = 3.263e-03 S  per = 0.118  per(accum) = 94.6
 T(global opt: reduction of opS & opH [mpi] ) = 1.408e-03 S  per = 0.0511  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 8.601e-02 S  per = 3.12  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 6.205e-02 S  per = 2.25  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-6.719e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=27/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=824:6.287e-03MB:6.139e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:7 S:13 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
        per(mem): H:1.1 C:3.31 S:6.15 A:0 B:89.4 
 rqops: oplist=HCSPQ nops=H:1 C:11 S:9 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=3913:0.0299MB:2.92e-05GB
        per(mem): H:0.716 C:3.37 S:2.76 P:0 Q:93.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=8445:0.0644MB:6.29e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.069e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=52:3.967e-04MB
qtensor4: wf4 own=1 _data=0x315ffa00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
 qbond: qcol nsym=5 dimAll=10
 (16,2):4 (16,0):3 (16,4):1 (17,3):1 (17,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=13 nblocks=361 size=52:3.967e-04MB
### DIAG TIMING: total=8.460e-01 t1=2.701e-05, t2=1.404e-03, t3=2.422e-03, t4=8.422e-01, t5=4.125e-06, t6=1.496e-05, t7=4.150e-06
duration_diagGPU:8.461e-01
duration_diagreduce:6.100e-08
duration_diagtransform:4.450e-07
----- TIMING FOR symbolic_formulae_twodot with size=704 : 9.628e-03 S -----
rank=0 GPUmem(GB): used=6.292e-05 (oper)=6.292e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=704
 no. of hintermediate operators=333
 no. of coefficients=4876:3.720e-02MB:3.633e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.712e-03 S -----
rank=0 GPUmem(GB): used=9.925e-05 (oper,hinter)=6.292e-05,3.633e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.275e-01 S size(H_formulae)=704 size(Hxlst2)=13 T(Hmu/Hxlist)=1.955e-03,1.256e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.287e-01 S size(H_formulae)=704 size(Hxlst)=6890 -----
rank=0 GPUmem(GB): used=9.925e-05 avail=1.279e+01 total=1.279e+01 dvdson[need]=7.749e-07 batch[need]=2.515e-03 blksize=16 blksize0=16 batchsize=6890
rank=0 GPUmem(GB): used=2.615e-03 (oper,hinter,dvdson,batch)=6.292e-05,3.633e-05,7.749e-07,2.515e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=52 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.241e-03,1.014e-02,3.004e-02,1.273e-02,5.417e-02
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=1.232e-03 speed=6.291e-04GB/S T(nccl)=9.158e-06 speed=8.461e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=168 t=1.0e-02 per=1.9e+01 cost=4.2e+05 flops=4.1e+07
 sigma[gemm] counter=168 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=2 t=1.1e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=3 t=1.1e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=4 t=7.5e-03 per=1.4e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=168 i=5 t=7.5e-03 per=1.4e+01 cost=4.5e+04 flops=6.0e+06
 sigma[gemm] counter=168 i=6 t=7.5e-03 per=1.4e+01 cost=9.1e+04 flops=1.2e+07
 sigma[gemm] counter=168 i=7 t=7.6e-03 per=1.4e+01 cost=9.2e+04 flops=1.2e+07
 sigma[gemm] counter=168 total t=3.0e-02 per=5.7e+01 cost=2.7e+05 flops=9.0e+06
 sigma[red] counter=168 t=1.3e-02 per=2.4e+01 cost=6.4e+04 flops=5.0e+06
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.9e+00 t_reduction=1.8e+00 tot=7.1e+00 -----
 sigma_tot[inter] counter=168 t=1.4e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=168 i=0 t=3.5e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=1 t=3.0e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=2 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=4 t=9.7e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=168 i=5 t=9.8e-01 per=1.4e+01 cost=2.9e+07 flops=2.9e+07
 sigma_tot[gemm] counter=168 i=6 t=9.6e-01 per=1.4e+01 cost=2.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=168 i=7 t=9.6e-01 per=1.3e+01 cost=2.5e+07 flops=2.7e+07
 sigma_tot[gemm] counter=168 total t=3.9e+00 per=5.4e+01 cost=1.1e+08 flops=2.8e+07
 sigma_tot[red] counter=168 t=1.8e+00 per=2.6e+01 cost=2.5e+07 flops=1.4e+07
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,8.2e-06,2.5e-06,1.1e-06,1.8e-07
settings: ndim=52 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.332314928371 -1.116e+03  3.331e-02    1     1  5.431e-02 5.431e-02 5.428e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.411e-03,9.907e-03,3.403e-02,1.271e-02,5.806e-02
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=1.404e-03 speed=5.518e-04GB/S T(nccl)=6.366e-06 speed=1.217e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.4e-02 t_reduction=1.3e-02 tot=5.7e-02 -----
 sigma[inter] counter=169 t=9.9e-03 per=1.7e+01 cost=4.2e+05 flops=4.2e+07
 sigma[gemm] counter=169 i=0 t=1.4e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=2 t=1.2e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=3 t=1.1e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=4 t=7.5e-03 per=1.3e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=169 i=5 t=7.5e-03 per=1.3e+01 cost=4.5e+04 flops=6.0e+06
 sigma[gemm] counter=169 i=6 t=7.4e-03 per=1.3e+01 cost=9.1e+04 flops=1.2e+07
 sigma[gemm] counter=169 i=7 t=1.2e-02 per=2.1e+01 cost=9.2e+04 flops=7.9e+06
 sigma[gemm] counter=169 total t=3.4e-02 per=6.0e+01 cost=2.7e+05 flops=7.9e+06
 sigma[red] counter=169 t=1.3e-02 per=2.2e+01 cost=6.4e+04 flops=5.0e+06
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.9e+00 t_reduction=1.9e+00 tot=7.2e+00 -----
 sigma_tot[inter] counter=169 t=1.4e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=169 i=0 t=3.5e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=1 t=3.0e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=2 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=4 t=9.8e-01 per=1.4e+01 cost=2.8e+07 flops=2.9e+07
 sigma_tot[gemm] counter=169 i=5 t=9.9e-01 per=1.4e+01 cost=2.9e+07 flops=2.9e+07
 sigma_tot[gemm] counter=169 i=6 t=9.7e-01 per=1.4e+01 cost=2.4e+07 flops=2.5e+07
 sigma_tot[gemm] counter=169 i=7 t=9.7e-01 per=1.3e+01 cost=2.6e+07 flops=2.6e+07
 sigma_tot[gemm] counter=169 total t=3.9e+00 per=5.4e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=169 t=1.9e+00 per=2.6e+01 cost=2.6e+07 flops=1.4e+07
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.1e-06,2.3e-05,1.4e-05,1.5e-06,2.1e-07
    2   0 -    -116.335303794645 -2.989e-03  9.109e-03    2     2  1.282e-01 6.408e-02 5.623e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.186e-03,9.957e-03,2.983e-02,1.307e-02,5.405e-02
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=1.179e-03 speed=6.571e-04GB/S T(nccl)=6.305e-06 speed=1.229e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=170 t=1.0e-02 per=1.9e+01 cost=4.2e+05 flops=4.2e+07
 sigma[gemm] counter=170 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=3 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=4 t=7.4e-03 per=1.4e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=170 i=5 t=7.4e-03 per=1.4e+01 cost=4.5e+04 flops=6.0e+06
 sigma[gemm] counter=170 i=6 t=7.4e-03 per=1.4e+01 cost=9.1e+04 flops=1.2e+07
 sigma[gemm] counter=170 i=7 t=7.6e-03 per=1.4e+01 cost=9.2e+04 flops=1.2e+07
 sigma[gemm] counter=170 total t=3.0e-02 per=5.6e+01 cost=2.7e+05 flops=9.1e+06
 sigma[red] counter=170 t=1.3e-02 per=2.5e+01 cost=6.4e+04 flops=4.9e+06
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=3.9e+00 t_reduction=1.9e+00 tot=7.2e+00 -----
 sigma_tot[inter] counter=170 t=1.4e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=170 i=0 t=3.5e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=1 t=3.0e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=2 t=2.7e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=4 t=9.9e-01 per=1.4e+01 cost=2.9e+07 flops=2.9e+07
 sigma_tot[gemm] counter=170 i=5 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.9e+07
 sigma_tot[gemm] counter=170 i=6 t=9.8e-01 per=1.4e+01 cost=2.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=170 i=7 t=9.8e-01 per=1.3e+01 cost=2.6e+07 flops=2.6e+07
 sigma_tot[gemm] counter=170 total t=3.9e+00 per=5.5e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=170 t=1.9e+00 per=2.6e+01 cost=2.6e+07 flops=1.4e+07
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,2.0e-05,1.3e-05,1.3e-06,1.9e-07
    3   0 -    -116.335522245947 -2.185e-04  2.815e-03    3     3  1.961e-01 6.535e-02 5.554e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.594e-03,1.007e-02,2.990e-02,1.265e-02,5.423e-02
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=1.589e-03 speed=4.878e-04GB/S T(nccl)=5.472e-06 speed=1.416e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=171 t=1.0e-02 per=1.9e+01 cost=4.2e+05 flops=4.2e+07
 sigma[gemm] counter=171 i=0 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=1 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=2 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=3 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=4 t=7.5e-03 per=1.4e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=171 i=5 t=7.5e-03 per=1.4e+01 cost=4.5e+04 flops=6.0e+06
 sigma[gemm] counter=171 i=6 t=7.4e-03 per=1.4e+01 cost=9.1e+04 flops=1.2e+07
 sigma[gemm] counter=171 i=7 t=7.5e-03 per=1.4e+01 cost=9.2e+04 flops=1.2e+07
 sigma[gemm] counter=171 total t=3.0e-02 per=5.7e+01 cost=2.7e+05 flops=9.0e+06
 sigma[red] counter=171 t=1.3e-02 per=2.4e+01 cost=6.4e+04 flops=5.1e+06
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=4.0e+00 t_reduction=1.9e+00 tot=7.3e+00 -----
 sigma_tot[inter] counter=171 t=1.4e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=171 i=0 t=3.5e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=1 t=3.0e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=2 t=2.7e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=3 t=2.7e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=4 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.9e+07
 sigma_tot[gemm] counter=171 i=5 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=171 i=6 t=9.9e-01 per=1.4e+01 cost=2.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=171 i=7 t=9.8e-01 per=1.3e+01 cost=2.6e+07 flops=2.6e+07
 sigma_tot[gemm] counter=171 total t=4.0e+00 per=5.5e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=171 t=1.9e+00 per=2.6e+01 cost=2.6e+07 flops=1.4e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.6e-05,3.4e-06,1.1e-06,2.2e-07
    4   0 -    -116.335546244339 -2.400e-05  9.969e-04    3     4  2.596e-01 6.489e-02 5.524e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.830e-03,1.199e-02,2.974e-02,1.257e-02,5.613e-02
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=1.824e-03 speed=4.249e-04GB/S T(nccl)=6.356e-06 speed=1.219e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.4e-02 -----
 sigma[inter] counter=172 t=1.2e-02 per=2.2e+01 cost=4.2e+05 flops=3.5e+07
 sigma[gemm] counter=172 i=0 t=2.3e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=1 t=2.0e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=2 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=3 t=2.0e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=4 t=7.5e-03 per=1.4e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=172 i=5 t=7.4e-03 per=1.4e+01 cost=4.5e+04 flops=6.1e+06
 sigma[gemm] counter=172 i=6 t=7.5e-03 per=1.4e+01 cost=9.1e+04 flops=1.2e+07
 sigma[gemm] counter=172 i=7 t=7.4e-03 per=1.4e+01 cost=9.2e+04 flops=1.2e+07
 sigma[gemm] counter=172 total t=3.0e-02 per=5.5e+01 cost=2.7e+05 flops=9.1e+06
 sigma[red] counter=172 t=1.3e-02 per=2.3e+01 cost=6.4e+04 flops=5.1e+06
----- TIMING FOR sigma_tot : t_inter=1.4e+00 t_gemm=4.0e+00 t_reduction=1.9e+00 tot=7.3e+00 -----
 sigma_tot[inter] counter=172 t=1.4e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=172 i=0 t=3.6e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=1 t=3.0e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=2 t=2.7e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=3 t=2.8e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=4 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=172 i=5 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=172 i=6 t=9.9e-01 per=1.4e+01 cost=2.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=172 i=7 t=9.9e-01 per=1.3e+01 cost=2.6e+07 flops=2.6e+07
 sigma_tot[gemm] counter=172 total t=4.0e+00 per=5.5e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=172 t=1.9e+00 per=2.6e+01 cost=2.6e+07 flops=1.4e+07
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.7e-05,3.7e-06,1.5e-06,2.9e-07
    5   0 -    -116.335549638719 -3.394e-06  2.545e-04    3     5  3.268e-01 6.536e-02 5.544e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.083e-03,9.905e-03,1.846e-03,5.274e-04,1.337e-02
 analyze_tgpu[Hx]: ndim=52:3.874e-07GB T(cpu-gpu)=1.078e-03 speed=7.188e-04GB/S T(nccl)=5.225e-06 speed=1.483e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=1.8e-03 t_reduction=5.3e-04 tot=1.2e-02 -----
 sigma[inter] counter=173 t=9.9e-03 per=8.1e+01 cost=4.2e+05 flops=4.2e+07
 sigma[gemm] counter=173 i=0 t=1.7e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=1 t=1.5e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=2 t=1.5e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=3 t=1.5e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=4 t=1.0e-03 per=8.4e+00 cost=4.3e+04 flops=4.2e+07
 sigma[gemm] counter=173 i=5 t=2.6e-04 per=2.1e+00 cost=4.5e+04 flops=1.7e+08
 sigma[gemm] counter=173 i=6 t=2.8e-04 per=2.3e+00 cost=9.1e+04 flops=3.2e+08
 sigma[gemm] counter=173 i=7 t=2.7e-04 per=2.2e+00 cost=9.2e+04 flops=3.4e+08
 sigma[gemm] counter=173 total t=1.8e-03 per=1.5e+01 cost=2.7e+05 flops=1.5e+08
 sigma[red] counter=173 t=5.3e-04 per=4.3e+00 cost=6.4e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.0e+00 t_reduction=1.9e+00 tot=7.4e+00 -----
 sigma_tot[inter] counter=173 t=1.5e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=173 i=0 t=3.6e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=1 t=3.0e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=2 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=3 t=2.8e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=4 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=173 i=5 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=173 i=6 t=9.9e-01 per=1.4e+01 cost=2.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=173 i=7 t=9.9e-01 per=1.3e+01 cost=2.6e+07 flops=2.6e+07
 sigma_tot[gemm] counter=173 total t=4.0e+00 per=5.4e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=173 t=1.9e+00 per=2.6e+01 cost=2.6e+07 flops=1.4e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.4e-05,3.2e-06,1.2e-06,2.7e-07
    6   0 +    -116.335549867109 -2.284e-07  8.407e-05    3     6  3.520e-01 5.867e-02 4.845e-02
TIMING FOR Davidson : 3.521e-01  T(cal/comm/rest)=2.907e-01,9.590e-07,6.135e-02
decomposed t_rest=6.135e-02
 T(sub)    =1.783e-04 per=2.906e-01
 T(precond)=6.101e-02 per=9.943e+01
 T(ortho)  =2.197e-05 per=3.581e-02
 T(xcopy)  =1.086e-06 per=1.770e-03
 T(xnrm2)  =3.379e-06 per=5.507e-03
 T(other)  =1.419e-04 per=2.314e-01
optimized energies: isweep=0 ibond=27 dots=2 e[0]=-116.335549867109 nmvp=6
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=1.511e-03 change=2.345e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=11 dimAll=37
 (16,2):4 (16,0):3 (16,4):1 (17,3):6 (17,1):8 (18,2):6 (18,0):4 (18,4):2 (19,3):1 (19,1):1 (17,5):1
timing for divide=1.0e-04
timing for compute=1.4e-02
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(su2): 1.4e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-04,1.4e-02,0.0e+00,5.2e-06,1.6e-05 -----
decimation summary: 37->10 dwt=+0.000e+00 SvN=1.560e+00
 qbond: qkept nsym=5 dimAll=10
 (18,2):4 (18,0):3 (18,4):1 (19,3):1 (19,1):1
----- TIMING for decimation_row(nkr): 1.410e-02 S T(decim/select/formRot)=1.370e-02,3.131e-04,9.117e-05 -----
----- TIMING FOR twodot_decimation: 1.516e-02 S T(wf/decim)=9.529e-04,1.421e-02 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
        per(mem): H:0.879 C:4.52 S:3.02 P:0 Q:91.6 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=1.511e-03 change=3.194e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=157 : 5.837e-03 S -----
rank=0 GPUmem(GB): used=1.041e-04 (oper)=6.031e-05
rank=0 GPUmem(GB): used=1.044e-04 (oper,site)=6.031e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=157
 no. of rintermediate operators=232
 no. of coefficients=2552:1.947e-02MB:1.901e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.251e-03 S -----
rank=0 GPUmem(GB): used=1.234e-04 (oper,site,rinter)=6.031e-05,2.980e-07,1.901e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.762e-02 S size(rtasks)=157 size(Rlst2)=25 T(Rmu/Rlist)=1.621e-03,3.600e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.817e-02 S size(rtasks)=157 size(Rlst)=2906 -----
rank=0 GPUmem(GB): used=1.234e-04 avail=3.575e+01 total=3.575e+01 batch[need]=8.011e-04 blksize=16 blksize0=4 batchsize=2906
rank=0 GPUmem(GB): used=9.245e-04 (oper,site,rinter,batch)=6.031e-05,2.980e-07,1.901e-05,8.011e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.247e-03,9.575e-03,3.946e-03
----- TIMING FOR renorm : t_inter=2.2e-03 t_gemm=9.6e-03 t_reduction=3.9e-03 tot=1.6e-02 -----
 renorm[inter] counter=28 t=2.2e-03 per=1.4e+01 cost=5.4e+04 flops=2.4e+07
 renorm[gemm] counter=28 i=0 t=1.3e-06 per=8.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=1 t=1.1e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=2 t=1.4e-03 per=8.6e+00 cost=9.4e+03 flops=6.9e+06
 renorm[gemm] counter=28 i=3 t=4.1e-03 per=2.6e+01 cost=3.4e+04 flops=8.3e+06
 renorm[gemm] counter=28 i=4 t=1.2e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=5 t=1.1e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=6 t=4.1e-03 per=2.6e+01 cost=9.1e+04 flops=2.2e+07
 renorm[gemm] counter=28 total t=9.6e-03 per=6.1e+01 cost=1.3e+05 flops=1.4e+07
 renorm[red] counter=28 t=3.9e-03 per=2.5e+01 cost=4.8e+04 flops=1.2e+07
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=6.2e-01 t_reduction=2.7e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=28 t=1.6e-01 per=1.5e+01 cost=2.9e+06 flops=1.8e+07
 renorm_tot[gemm] counter=28 i=0 t=4.5e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=1 t=3.5e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=2 t=7.7e-02 per=7.3e+00 cost=1.6e+05 flops=2.1e+06
 renorm_tot[gemm] counter=28 i=3 t=8.0e-02 per=7.6e+00 cost=4.4e+05 flops=5.6e+06
 renorm_tot[gemm] counter=28 i=4 t=1.3e-01 per=1.2e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=28 i=5 t=1.3e-01 per=1.2e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=28 i=6 t=2.1e-01 per=2.0e+01 cost=1.7e+06 flops=8.0e+06
 renorm_tot[gemm] counter=28 total t=6.2e-01 per=5.9e+01 cost=3.0e+06 flops=4.9e+06
 renorm_tot[red] counter=28 t=2.7e-01 per=2.6e+01 cost=7.2e+05 flops=2.6e+06
qops.to_cpu: size(tot)=3184:2.4e-02MB:2.4e-05GB T(to_cpu)=1.6e-04S speed=1.5e-01GB/S
check ||H-H.dagger||=1.524e-14 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0856 S rank=0 -----
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=1.274e-03 change=1.004e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.907e-03 change=-2.431e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.907e-03 change=-3.830e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local opt: 1.508e+00 S #####
 T(local opt: fetch) = 1.307e-02 S  per = 0.867  per(accum) = 0.867
 T(local opt: hdiag) = 8.468e-01 S  per = 56.2  per(accum) = 57
 T(local opt: dvdsn) = 5.418e-01 S  per = 35.9  per(accum) = 93
 T(local opt: decim) = 1.518e-02 S  per = 1.01  per(accum) = 94
 T(local opt: guess) = 1.197e-03 S  per = 0.0794  per(accum) = 94
 T(local opt: renrm) = 8.947e-02 S  per = 5.93  per(accum) = 100
 T(local opt: save ) = 2.855e-04 S  per = 0.0189  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.418e-01 S  T(sum) = 5.408e-01 S  per = 9.981e+01
 T(local opt: preprocess                  ) = 5.487e-03 S  per = 1.01  per(accum) = 1.01
 T(local opt: symbolic_formulae           ) = 9.643e-03 S  per = 1.78  per(accum) = 2.8
 T(local opt: hintermediate init          ) = 1.745e-03 S  per = 0.323  per(accum) = 3.12
 T(local opt: preprocess_hformulae_Hxlist ) = 1.289e-01 S  per = 23.8  per(accum) = 27
 T(local opt: hmmtasks init               ) = 4.136e-02 S  per = 7.65  per(accum) = 34.6
 T(local opt: initial guess for dvdson    ) = 1.558e-03 S  per = 0.288  per(accum) = 34.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.824e-01 S  per = 52.2  per(accum) = 87.1
 T(local opt: dvdson [cpu-gpu]            ) = 8.305e-03 S  per = 1.54  per(accum) = 88.6
 T(local opt: dvdson [nccl]               ) = 3.888e-05 S  per = 0.00719  per(accum) = 88.7
 T(local opt: dvdson [mpi]                ) = 9.590e-07 S  per = 0.000177  per(accum) = 88.7
 T(local opt: dvdson [rest part(linalg)]  ) = 6.135e-02 S  per = 11.3  per(accum) = 100
Detailed decomposition of T(renrm) = 8.947e-02 S  T(sum) = 8.947e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.457e-04 S  per = 0.386  per(accum) = 0.386
 T(local opt: qops init                    ) = 5.083e-03 S  per = 5.68  per(accum) = 6.07
 T(local opt: symbolic_formulae_renorm     ) = 5.851e-03 S  per = 6.54  per(accum) = 12.6
 T(local opt: allocate qops on gpu         ) = 8.829e-04 S  per = 0.987  per(accum) = 13.6
 T(local opt: site memcpy cpu2gpu          ) = 1.234e-03 S  per = 1.38  per(accum) = 15
 T(local opt: rintermediate init           ) = 1.263e-03 S  per = 1.41  per(accum) = 16.4
 T(local opt: preprocess_formulae_Rlist2   ) = 3.827e-02 S  per = 42.8  per(accum) = 59.2
 T(local opt: rmmtasks init                ) = 1.680e-02 S  per = 18.8  per(accum) = 77.9
 T(local opt: qops memset on cpu           ) = 4.600e-08 S  per = 5.14e-05  per(accum) = 77.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.585e-02 S  per = 17.7  per(accum) = 95.6
 T(local opt: deallocate cpu and gpu memory) = 1.079e-04 S  per = 0.121  per(accum) = 95.8
 T(local opt: construct opS [ifdists=true] ) = 6.600e-08 S  per = 7.38e-05  per(accum) = 95.8
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 4.14e-05  per(accum) = 95.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.652e-04 S  per = 0.185  per(accum) = 96
 T(local opt: reduction of opS & opH [mpi] ) = 5.798e-05 S  per = 0.0648  per(accum) = 96
 T(local opt: qops_pool join and erase     ) = 3.553e-03 S  per = 3.97  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.484e-06 S  per = 0.00836  per(accum) = 100
##### sweep opt: 3.898e+01 S #####
 T(sweep opt: fetch) = 4.052e-01 S  per = 1.04  per(accum) = 1.04
 T(sweep opt: hdiag) = 1.499e+01 S  per = 38.5  per(accum) = 39.5
 T(sweep opt: dvdsn) = 2.031e+01 S  per = 52.1  per(accum) = 91.6
 T(sweep opt: decim) = 3.818e-01 S  per = 0.979  per(accum) = 92.6
 T(sweep opt: guess) = 3.447e-02 S  per = 0.0884  per(accum) = 92.7
 T(sweep opt: renrm) = 2.848e+00 S  per =  7.3  per(accum) = 100
 T(sweep opt: save ) = 9.147e-03 S  per = 0.0235  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.031e+01 S  T(sum) = 2.026e+01 S  per = 9.975e+01
 T(sweep opt: preprocess                  ) = 1.535e-01 S  per = 0.757  per(accum) = 0.757
 T(sweep opt: symbolic_formulae           ) = 2.246e-01 S  per = 1.11  per(accum) = 1.87
 T(sweep opt: hintermediate init          ) = 9.833e-03 S  per = 0.0485  per(accum) = 1.91
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.080e+00 S  per = 34.9  per(accum) = 36.9
 T(sweep opt: hmmtasks init               ) = 3.329e+00 S  per = 16.4  per(accum) = 53.3
 T(sweep opt: initial guess for dvdson    ) = 4.110e-02 S  per = 0.203  per(accum) = 53.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.387e+00 S  per = 36.5  per(accum) = 90
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.327e-01 S  per = 1.15  per(accum) = 91.1
 T(sweep opt: dvdson [nccl]               ) = 1.255e-03 S  per = 0.00619  per(accum) = 91.1
 T(sweep opt: dvdson [mpi]                ) = 2.893e-05 S  per = 0.000143  per(accum) = 91.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.800e+00 S  per = 8.89  per(accum) = 100
Detailed decomposition of T(renrm) = 2.848e+00 S  T(sum) = 2.848e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.965e-03 S  per = 0.315  per(accum) = 0.315
 T(sweep opt: qops init                    ) = 1.076e-01 S  per = 3.78  per(accum) = 4.1
 T(sweep opt: symbolic_formulae_renorm     ) = 1.139e-01 S  per =    4  per(accum) = 8.1
 T(sweep opt: allocate qops on gpu         ) = 4.547e-03 S  per = 0.16  per(accum) = 8.26
 T(sweep opt: site memcpy cpu2gpu          ) = 3.895e-02 S  per = 1.37  per(accum) = 9.62
 T(sweep opt: rintermediate init           ) = 6.663e-02 S  per = 2.34  per(accum) = 12
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.548e-01 S  per =   30  per(accum) = 42
 T(sweep opt: rmmtasks init                ) = 4.353e-01 S  per = 15.3  per(accum) = 57.3
 T(sweep opt: qops memset on cpu           ) = 1.132e-06 S  per = 3.98e-05  per(accum) = 57.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.057e+00 S  per = 37.1  per(accum) = 94.4
 T(sweep opt: deallocate cpu and gpu memory) = 3.417e-03 S  per = 0.12  per(accum) = 94.5
 T(sweep opt: construct opS [ifdists=true] ) = 1.499e-06 S  per = 5.26e-05  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.118e-06 S  per = 3.93e-05  per(accum) = 94.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.429e-03 S  per = 0.12  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.466e-03 S  per = 0.0515  per(accum) = 94.7
 T(sweep opt: qops_pool join and erase     ) = 8.957e-02 S  per = 3.15  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 6.206e-02 S  per = 2.18  per(accum) = 100
##### global opt: 3.898e+01 S #####
 T(global opt: fetch) = 4.052e-01 S  per = 1.04  per(accum) = 1.04
 T(global opt: hdiag) = 1.499e+01 S  per = 38.5  per(accum) = 39.5
 T(global opt: dvdsn) = 2.031e+01 S  per = 52.1  per(accum) = 91.6
 T(global opt: decim) = 3.818e-01 S  per = 0.979  per(accum) = 92.6
 T(global opt: guess) = 3.447e-02 S  per = 0.0884  per(accum) = 92.7
 T(global opt: renrm) = 2.848e+00 S  per =  7.3  per(accum) = 100
 T(global opt: save ) = 9.147e-03 S  per = 0.0235  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.031e+01 S  T(sum) = 2.026e+01 S  per = 9.975e+01
 T(global opt: preprocess                  ) = 1.535e-01 S  per = 0.757  per(accum) = 0.757
 T(global opt: symbolic_formulae           ) = 2.246e-01 S  per = 1.11  per(accum) = 1.87
 T(global opt: hintermediate init          ) = 9.833e-03 S  per = 0.0485  per(accum) = 1.91
 T(global opt: preprocess_hformulae_Hxlist ) = 7.080e+00 S  per = 34.9  per(accum) = 36.9
 T(global opt: hmmtasks init               ) = 3.329e+00 S  per = 16.4  per(accum) = 53.3
 T(global opt: initial guess for dvdson    ) = 4.110e-02 S  per = 0.203  per(accum) = 53.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.387e+00 S  per = 36.5  per(accum) = 90
 T(global opt: dvdson [cpu-gpu]            ) = 2.327e-01 S  per = 1.15  per(accum) = 91.1
 T(global opt: dvdson [nccl]               ) = 1.255e-03 S  per = 0.00619  per(accum) = 91.1
 T(global opt: dvdson [mpi]                ) = 2.893e-05 S  per = 0.000143  per(accum) = 91.1
 T(global opt: dvdson [rest part(linalg)]  ) = 1.800e+00 S  per = 8.89  per(accum) = 100
Detailed decomposition of T(renrm) = 2.848e+00 S  T(sum) = 2.848e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.965e-03 S  per = 0.315  per(accum) = 0.315
 T(global opt: qops init                    ) = 1.076e-01 S  per = 3.78  per(accum) = 4.1
 T(global opt: symbolic_formulae_renorm     ) = 1.139e-01 S  per =    4  per(accum) = 8.1
 T(global opt: allocate qops on gpu         ) = 4.547e-03 S  per = 0.16  per(accum) = 8.26
 T(global opt: site memcpy cpu2gpu          ) = 3.895e-02 S  per = 1.37  per(accum) = 9.62
 T(global opt: rintermediate init           ) = 6.663e-02 S  per = 2.34  per(accum) = 12
 T(global opt: preprocess_formulae_Rlist2   ) = 8.548e-01 S  per =   30  per(accum) = 42
 T(global opt: rmmtasks init                ) = 4.353e-01 S  per = 15.3  per(accum) = 57.3
 T(global opt: qops memset on cpu           ) = 1.132e-06 S  per = 3.98e-05  per(accum) = 57.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.057e+00 S  per = 37.1  per(accum) = 94.4
 T(global opt: deallocate cpu and gpu memory) = 3.417e-03 S  per = 0.12  per(accum) = 94.5
 T(global opt: construct opS [ifdists=true] ) = 1.499e-06 S  per = 5.26e-05  per(accum) = 94.5
 T(global opt: reduction of opS & opH [nccl]) = 1.118e-06 S  per = 3.93e-05  per(accum) = 94.5
 T(global opt: qops memcpy gpu2cpu          ) = 3.429e-03 S  per = 0.12  per(accum) = 94.6
 T(global opt: reduction of opS & opH [mpi] ) = 1.466e-03 S  per = 0.0515  per(accum) = 94.7
 T(global opt: qops_pool join and erase     ) = 8.957e-02 S  per = 3.15  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 6.206e-02 S  per = 2.18  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-2.331e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=28/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=824:6.287e-03MB:6.139e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:14 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
        per(mem): H:1.34 C:4.83 S:11.3 A:0 B:82.6 
 rqops: oplist=HCSPQ nops=H:1 C:12 S:8 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=3184:0.0243MB:2.37e-05GB
        per(mem): H:0.879 C:4.52 S:3.02 P:0 Q:91.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=7418:0.0566MB:5.53e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=9.577e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=136:1.038e-03MB
qtensor4: wf4 own=1 _data=0x3b527680
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
 qbond: qcol nsym=5 dimAll=10
 (18,2):4 (18,0):3 (18,4):1 (19,3):1 (19,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=26 nblocks=304 size=136:1.038e-03MB
### DIAG TIMING: total=2.242e-02 t1=5.260e-04, t2=1.882e-04, t3=8.514e-05, t4=2.159e-02, t5=4.527e-06, t6=1.484e-05, t7=4.985e-06
duration_diagGPU:2.243e-02
duration_diagreduce:3.100e-08
duration_diagtransform:8.560e-07
----- TIMING FOR symbolic_formulae_twodot with size=591 : 8.029e-03 S -----
rank=0 GPUmem(GB): used=5.527e-05 (oper)=5.527e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=591
 no. of hintermediate operators=286
 no. of coefficients=4083:3.115e-02MB:3.042e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.861e-04 S -----
rank=0 GPUmem(GB): used=8.569e-05 (oper,hinter)=5.527e-05,3.042e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.906e-01 S size(H_formulae)=591 size(Hxlst2)=26 T(Hmu/Hxlist)=1.554e-03,2.890e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.930e-01 S size(H_formulae)=591 size(Hxlst)=17710 -----
rank=0 GPUmem(GB): used=8.569e-05 avail=1.805e+01 total=1.805e+01 dvdson[need]=2.027e-06 batch[need]=6.466e-03 blksize=16 blksize0=16 batchsize=17710
rank=0 GPUmem(GB): used=6.553e-03 (oper,hinter,dvdson,batch)=5.527e-05,3.042e-05,2.027e-06,6.466e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=136 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.803e-04,1.109e-03,7.346e-03,3.515e-03,1.216e-02
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=1.718e-04 speed=1.180e-02GB/S T(nccl)=8.536e-06 speed=2.374e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-03 t_gemm=7.3e-03 t_reduction=3.5e-03 tot=1.2e-02 -----
 sigma[inter] counter=174 t=1.1e-03 per=9.3e+00 cost=1.4e+06 flops=1.3e+09
 sigma[gemm] counter=174 i=0 t=1.5e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=1 t=1.3e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=2 t=1.2e-06 per=9.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=3 t=1.1e-06 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=4 t=3.5e-03 per=2.9e+01 cost=1.5e+05 flops=4.4e+07
 sigma[gemm] counter=174 i=5 t=1.1e-03 per=9.2e+00 cost=1.5e+05 flops=1.4e+08
 sigma[gemm] counter=174 i=6 t=5.2e-04 per=4.3e+00 cost=2.9e+05 flops=5.5e+08
 sigma[gemm] counter=174 i=7 t=2.2e-03 per=1.9e+01 cost=2.9e+05 flops=1.3e+08
 sigma[gemm] counter=174 total t=7.3e-03 per=6.1e+01 cost=8.8e+05 flops=1.2e+08
 sigma[red] counter=174 t=3.5e-03 per=2.9e+01 cost=2.0e+05 flops=5.8e+07
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.0e+00 t_reduction=1.9e+00 tot=7.4e+00 -----
 sigma_tot[inter] counter=174 t=1.5e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=174 i=0 t=3.6e-04 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=1 t=3.1e-04 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=2 t=2.8e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=3 t=2.8e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=4 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.9e+07
 sigma_tot[gemm] counter=174 i=5 t=1.0e+00 per=1.4e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=174 i=6 t=1.0e+00 per=1.4e+01 cost=2.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=174 i=7 t=9.9e-01 per=1.3e+01 cost=2.6e+07 flops=2.6e+07
 sigma_tot[gemm] counter=174 total t=4.0e+00 per=5.4e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=174 t=1.9e+00 per=2.6e+01 cost=2.6e+07 flops=1.4e+07
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,6.2e-06,2.1e-06,1.0e-06,2.1e-07
settings: ndim=136 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.335549867109 -1.116e+03  4.103e-02    1     1  1.231e-02 1.231e-02 1.227e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.788e-04,4.841e-02,2.726e-02,1.492e-01,2.250e-01
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=1.723e-04 speed=1.176e-02GB/S T(nccl)=6.496e-06 speed=3.120e-01GB/S
----- TIMING FOR sigma : t_inter=4.8e-02 t_gemm=2.7e-02 t_reduction=1.5e-01 tot=2.2e-01 -----
 sigma[inter] counter=175 t=4.8e-02 per=2.2e+01 cost=1.4e+06 flops=3.0e+07
 sigma[gemm] counter=175 i=0 t=2.4e-06 per=1.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=1 t=2.1e-06 per=9.2e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=2 t=2.0e-06 per=9.0e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=3 t=2.0e-06 per=9.1e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=4 t=2.9e-03 per=1.3e+00 cost=1.5e+05 flops=5.3e+07
 sigma[gemm] counter=175 i=5 t=9.5e-03 per=4.2e+00 cost=1.5e+05 flops=1.6e+07
 sigma[gemm] counter=175 i=6 t=7.5e-03 per=3.3e+00 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=175 i=7 t=7.4e-03 per=3.3e+00 cost=2.9e+05 flops=3.9e+07
 sigma[gemm] counter=175 total t=2.7e-02 per=1.2e+01 cost=8.8e+05 flops=3.2e+07
 sigma[red] counter=175 t=1.5e-01 per=6.6e+01 cost=2.0e+05 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.0e+00 t_reduction=2.0e+00 tot=7.6e+00 -----
 sigma_tot[inter] counter=175 t=1.5e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=175 i=0 t=3.6e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=1 t=3.1e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=2 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=3 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=4 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.9e+07
 sigma_tot[gemm] counter=175 i=5 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=175 i=6 t=1.0e+00 per=1.3e+01 cost=2.5e+07 flops=2.5e+07
 sigma_tot[gemm] counter=175 i=7 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.7e+07
 sigma_tot[gemm] counter=175 total t=4.0e+00 per=5.3e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=175 t=2.0e+00 per=2.7e+01 cost=2.6e+07 flops=1.3e+07
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,3.4e-05,4.9e-06,1.8e-06,3.3e-07
    2   0 -    -116.339286171806 -3.736e-03  1.160e-02    2     2  2.500e-01 1.250e-01 1.187e-01
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.418e-04,1.414e-02,3.260e-02,1.059e-02,5.808e-02
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=7.332e-04 speed=2.764e-03GB/S T(nccl)=8.612e-06 speed=2.353e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=3.3e-02 t_reduction=1.1e-02 tot=5.7e-02 -----
 sigma[inter] counter=176 t=1.4e-02 per=2.5e+01 cost=1.4e+06 flops=1.0e+08
 sigma[gemm] counter=176 i=0 t=2.5e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=1 t=2.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=2 t=2.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=3 t=2.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=4 t=9.7e-03 per=1.7e+01 cost=1.5e+05 flops=1.6e+07
 sigma[gemm] counter=176 i=5 t=7.7e-03 per=1.3e+01 cost=1.5e+05 flops=2.0e+07
 sigma[gemm] counter=176 i=6 t=7.7e-03 per=1.3e+01 cost=2.9e+05 flops=3.7e+07
 sigma[gemm] counter=176 i=7 t=7.6e-03 per=1.3e+01 cost=2.9e+05 flops=3.9e+07
 sigma[gemm] counter=176 total t=3.3e-02 per=5.7e+01 cost=8.8e+05 flops=2.7e+07
 sigma[red] counter=176 t=1.1e-02 per=1.8e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.1e+00 t_reduction=2.1e+00 tot=7.6e+00 -----
 sigma_tot[inter] counter=176 t=1.5e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=176 i=0 t=3.6e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=1 t=3.1e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=2 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=3 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=4 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=176 i=5 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=176 i=6 t=1.0e+00 per=1.3e+01 cost=2.6e+07 flops=2.5e+07
 sigma_tot[gemm] counter=176 i=7 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.7e+07
 sigma_tot[gemm] counter=176 total t=4.1e+00 per=5.3e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=176 t=2.1e+00 per=2.7e+01 cost=2.6e+07 flops=1.3e+07
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,2.5e-05,4.2e-06,2.2e-06,3.4e-07
    3   0 -    -116.339632081739 -3.459e-04  3.859e-03    3     3  3.165e-01 1.055e-01 9.857e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.801e-03,9.952e-03,2.998e-02,1.043e-02,5.217e-02
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=1.796e-03 speed=1.128e-03GB/S T(nccl)=4.634e-06 speed=4.373e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=177 t=1.0e-02 per=2.0e+01 cost=1.4e+06 flops=1.5e+08
 sigma[gemm] counter=177 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=4 t=7.5e-03 per=1.5e+01 cost=1.5e+05 flops=2.0e+07
 sigma[gemm] counter=177 i=5 t=7.5e-03 per=1.5e+01 cost=1.5e+05 flops=2.0e+07
 sigma[gemm] counter=177 i=6 t=7.4e-03 per=1.5e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=177 i=7 t=7.5e-03 per=1.5e+01 cost=2.9e+05 flops=3.9e+07
 sigma[gemm] counter=177 total t=3.0e-02 per=6.0e+01 cost=8.8e+05 flops=3.0e+07
 sigma[red] counter=177 t=1.0e-02 per=2.1e+01 cost=2.0e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.1e+00 t_reduction=2.1e+00 tot=7.7e+00 -----
 sigma_tot[inter] counter=177 t=1.5e+00 per=2.0e+01 cost=1.5e+08 flops=1.0e+08
 sigma_tot[gemm] counter=177 i=0 t=3.7e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=1 t=3.1e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=2 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=3 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=4 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=177 i=5 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=177 i=6 t=1.0e+00 per=1.3e+01 cost=2.6e+07 flops=2.5e+07
 sigma_tot[gemm] counter=177 i=7 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.7e+07
 sigma_tot[gemm] counter=177 total t=4.1e+00 per=5.3e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=177 t=2.1e+00 per=2.7e+01 cost=2.7e+07 flops=1.3e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.4e-05,3.1e-06,1.6e-06,2.1e-07
    4   0 -    -116.339667732622 -3.565e-05  1.253e-03    3     4  3.861e-01 9.652e-02 8.700e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.664e-03,9.858e-03,2.983e-02,1.036e-02,5.173e-02
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=1.658e-03 speed=1.222e-03GB/S T(nccl)=6.043e-06 speed=3.354e-01GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=178 t=9.9e-03 per=2.0e+01 cost=1.4e+06 flops=1.5e+08
 sigma[gemm] counter=178 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=3 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=4 t=7.4e-03 per=1.5e+01 cost=1.5e+05 flops=2.1e+07
 sigma[gemm] counter=178 i=5 t=7.5e-03 per=1.5e+01 cost=1.5e+05 flops=2.0e+07
 sigma[gemm] counter=178 i=6 t=7.4e-03 per=1.5e+01 cost=2.9e+05 flops=3.8e+07
 sigma[gemm] counter=178 i=7 t=7.4e-03 per=1.5e+01 cost=2.9e+05 flops=3.9e+07
 sigma[gemm] counter=178 total t=3.0e-02 per=6.0e+01 cost=8.8e+05 flops=3.0e+07
 sigma[red] counter=178 t=1.0e-02 per=2.1e+01 cost=2.0e+05 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.1e+00 t_reduction=2.1e+00 tot=7.7e+00 -----
 sigma_tot[inter] counter=178 t=1.5e+00 per=2.0e+01 cost=1.6e+08 flops=1.0e+08
 sigma_tot[gemm] counter=178 i=0 t=3.7e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=1 t=3.1e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=2 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=3 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=4 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=178 i=5 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=178 i=6 t=1.0e+00 per=1.3e+01 cost=2.6e+07 flops=2.6e+07
 sigma_tot[gemm] counter=178 i=7 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.7e+07
 sigma_tot[gemm] counter=178 total t=4.1e+00 per=5.3e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=178 t=2.1e+00 per=2.7e+01 cost=2.7e+07 flops=1.3e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,3.1e-06,1.7e-06,2.2e-07
    5   0 -    -116.339671397293 -3.665e-06  3.962e-04    3     5  4.511e-01 9.023e-02 7.997e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.799e-04,4.716e-04,2.622e-03,1.570e-03,4.854e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=1.738e-04 speed=1.166e-02GB/S T(nccl)=6.153e-06 speed=3.294e-01GB/S
----- TIMING FOR sigma : t_inter=4.7e-04 t_gemm=2.6e-03 t_reduction=1.6e-03 tot=4.7e-03 -----
 sigma[inter] counter=179 t=4.7e-04 per=1.0e+01 cost=1.4e+06 flops=3.1e+09
 sigma[gemm] counter=179 i=0 t=1.7e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=1 t=1.5e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=2 t=1.5e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=3 t=1.5e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=4 t=5.8e-04 per=1.2e+01 cost=1.5e+05 flops=2.7e+08
 sigma[gemm] counter=179 i=5 t=4.0e-04 per=8.6e+00 cost=1.5e+05 flops=3.8e+08
 sigma[gemm] counter=179 i=6 t=5.9e-04 per=1.3e+01 cost=2.9e+05 flops=4.9e+08
 sigma[gemm] counter=179 i=7 t=1.0e-03 per=2.2e+01 cost=2.9e+05 flops=2.8e+08
 sigma[gemm] counter=179 total t=2.6e-03 per=5.6e+01 cost=8.8e+05 flops=3.4e+08
 sigma[red] counter=179 t=1.6e-03 per=3.4e+01 cost=2.0e+05 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.1e+00 t_reduction=2.1e+00 tot=7.8e+00 -----
 sigma_tot[inter] counter=179 t=1.5e+00 per=2.0e+01 cost=1.6e+08 flops=1.0e+08
 sigma_tot[gemm] counter=179 i=0 t=3.7e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=1 t=3.1e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=2 t=2.8e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=3 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=4 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=179 i=5 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=179 i=6 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.6e+07
 sigma_tot[gemm] counter=179 i=7 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=179 total t=4.1e+00 per=5.3e+01 cost=1.1e+08 flops=2.7e+07
 sigma_tot[red] counter=179 t=2.1e+00 per=2.7e+01 cost=2.7e+07 flops=1.3e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.5e-05,3.4e-06,1.6e-06,2.7e-07
    6   0 -    -116.339671851543 -4.543e-07  1.380e-04    3     6  4.732e-01 7.887e-02 6.747e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.481e-05,5.775e-04,2.943e-03,2.004e-03,5.556e-03
 analyze_tgpu[Hx]: ndim=136:1.013e-06GB T(cpu-gpu)=2.031e-05 speed=9.976e-02GB/S T(nccl)=4.494e-06 speed=4.509e-01GB/S
----- TIMING FOR sigma : t_inter=5.8e-04 t_gemm=2.9e-03 t_reduction=2.0e-03 tot=5.5e-03 -----
 sigma[inter] counter=180 t=5.8e-04 per=1.0e+01 cost=1.4e+06 flops=2.5e+09
 sigma[gemm] counter=180 i=0 t=1.9e-06 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=1 t=1.7e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=2 t=1.7e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=3 t=1.8e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=4 t=6.0e-04 per=1.1e+01 cost=1.5e+05 flops=2.5e+08
 sigma[gemm] counter=180 i=5 t=4.8e-04 per=8.7e+00 cost=1.5e+05 flops=3.2e+08
 sigma[gemm] counter=180 i=6 t=9.2e-04 per=1.7e+01 cost=2.9e+05 flops=3.1e+08
 sigma[gemm] counter=180 i=7 t=9.3e-04 per=1.7e+01 cost=2.9e+05 flops=3.2e+08
 sigma[gemm] counter=180 total t=2.9e-03 per=5.3e+01 cost=8.8e+05 flops=3.0e+08
 sigma[red] counter=180 t=2.0e-03 per=3.6e+01 cost=2.0e+05 flops=1.0e+08
----- TIMING FOR sigma_tot : t_inter=1.5e+00 t_gemm=4.1e+00 t_reduction=2.1e+00 tot=7.8e+00 -----
 sigma_tot[inter] counter=180 t=1.5e+00 per=2.0e+01 cost=1.6e+08 flops=1.0e+08
 sigma_tot[gemm] counter=180 i=0 t=3.7e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=1 t=3.2e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=2 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=3 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=4 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=180 i=5 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=180 i=6 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.6e+07
 sigma_tot[gemm] counter=180 i=7 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=180 total t=4.1e+00 per=5.3e+01 cost=1.1e+08 flops=2.8e+07
 sigma_tot[red] counter=180 t=2.1e+00 per=2.7e+01 cost=2.7e+07 flops=1.3e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.4e-05,3.3e-06,1.4e-06,2.5e-07
    7   0 +    -116.339671899742 -4.820e-08  4.304e-05    3     7  4.901e-01 7.001e-02 5.864e-02
TIMING FOR Davidson : 4.901e-01  T(cal/comm/rest)=4.105e-01,1.419e-06,7.963e-02
decomposed t_rest=7.963e-02
 T(sub)    =1.997e-04 per=2.508e-01
 T(precond)=7.919e-02 per=9.945e+01
 T(ortho)  =4.069e-05 per=5.110e-02
 T(xcopy)  =1.581e-06 per=1.985e-03
 T(xnrm2)  =3.536e-06 per=4.440e-03
 T(other)  =1.932e-04 per=2.427e-01
optimized energies: isweep=0 ibond=28 dots=2 e[0]=-116.339671899742 nmvp=7
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=7.973e-03 change=4.583e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=11 dimAll=37
 (18,2):4 (18,0):3 (18,4):1 (19,3):6 (19,1):8 (20,2):6 (20,0):4 (20,4):2 (21,3):1 (21,1):1 (19,5):1
timing for divide=9.6e-05
timing for compute=1.2e-02
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.6e-05,1.2e-02,0.0e+00,5.9e-06,1.9e-05 -----
decimation summary: 37->10 dwt=+8.624e-03 SvN=1.626e+00
 qbond: qkept nsym=5 dimAll=10
 (20,2):4 (20,0):3 (20,4):1 (21,3):1 (21,1):1
----- TIMING for decimation_row(nkr): 1.229e-02 S T(decim/select/formRot)=1.185e-02,3.287e-04,1.105e-04 -----
----- TIMING FOR twodot_decimation: 1.334e-02 S T(wf/decim)=9.402e-04,1.240e-02 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
        per(mem): H:1.1 C:6.15 S:3.31 P:0 Q:89.4 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=7.965e-03 change=2.556e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=126 : 5.011e-03 S -----
rank=0 GPUmem(GB): used=8.791e-05 (oper)=5.005e-05
rank=0 GPUmem(GB): used=8.821e-05 (oper,site)=5.005e-05,2.980e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=126
 no. of rintermediate operators=182
 no. of coefficients=2184:1.666e-02MB:1.627e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 8.688e-03 S -----
rank=0 GPUmem(GB): used=1.045e-04 (oper,site,rinter)=5.005e-05,2.980e-07,1.627e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.118e-02 S size(rtasks)=126 size(Rlst2)=25 T(Rmu/Rlist)=1.364e-03,2.981e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.144e-02 S size(rtasks)=126 size(Rlst)=2336 -----
rank=0 GPUmem(GB): used=1.045e-04 avail=3.578e+01 total=3.578e+01 batch[need]=6.440e-04 blksize=16 blksize0=4 batchsize=2336
rank=0 GPUmem(GB): used=7.484e-04 (oper,site,rinter,batch)=5.005e-05,2.980e-07,1.627e-05,6.440e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=4.755e-04,1.045e-03,1.748e-04
----- TIMING FOR renorm : t_inter=4.8e-04 t_gemm=1.0e-03 t_reduction=1.7e-04 tot=1.7e-03 -----
 renorm[inter] counter=29 t=4.8e-04 per=2.8e+01 cost=4.6e+04 flops=9.8e+07
 renorm[gemm] counter=29 i=0 t=1.3e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=1 t=1.2e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=2 t=1.7e-04 per=1.0e+01 cost=7.7e+03 flops=4.4e+07
 renorm[gemm] counter=29 i=3 t=1.9e-04 per=1.1e+01 cost=2.7e+04 flops=1.4e+08
 renorm[gemm] counter=29 i=4 t=1.2e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=5 t=1.2e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=6 t=6.7e-04 per=4.0e+01 cost=7.3e+04 flops=1.1e+08
 renorm[gemm] counter=29 total t=1.0e-03 per=6.2e+01 cost=1.1e+05 flops=1.0e+08
 renorm[red] counter=29 t=1.7e-04 per=1.0e+01 cost=3.8e+04 flops=2.2e+08
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=6.2e-01 t_reduction=2.7e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=29 t=1.6e-01 per=1.5e+01 cost=2.9e+06 flops=1.8e+07
 renorm_tot[gemm] counter=29 i=0 t=4.7e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=1 t=3.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=2 t=7.7e-02 per=7.3e+00 cost=1.7e+05 flops=2.2e+06
 renorm_tot[gemm] counter=29 i=3 t=8.0e-02 per=7.6e+00 cost=4.7e+05 flops=5.9e+06
 renorm_tot[gemm] counter=29 i=4 t=1.3e-01 per=1.2e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=29 i=5 t=1.3e-01 per=1.2e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=29 i=6 t=2.1e-01 per=2.0e+01 cost=1.7e+06 flops=8.3e+06
 renorm_tot[gemm] counter=29 total t=6.2e-01 per=5.9e+01 cost=3.1e+06 flops=5.0e+06
 renorm_tot[red] counter=29 t=2.7e-01 per=2.6e+01 cost=7.6e+05 flops=2.8e+06
qops.to_cpu: size(tot)=2536:1.9e-02MB:1.9e-05GB T(to_cpu)=1.3e-04S speed=1.4e-01GB/S
check ||H-H.dagger||=3.314e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0797 S rank=0 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=7.080e-03 change=8.166e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=7.629e-03 change=-2.063e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=7.629e-03 change=-3.830e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local opt: 1.062e+00 S #####
 T(local opt: fetch) = 1.115e-02 S  per = 1.05  per(accum) = 1.05
 T(local opt: hdiag) = 2.311e-02 S  per = 2.18  per(accum) = 3.23
 T(local opt: dvdsn) = 9.295e-01 S  per = 87.5  per(accum) = 90.7
 T(local opt: decim) = 1.336e-02 S  per = 1.26  per(accum) = 92
 T(local opt: guess) = 1.192e-03 S  per = 0.112  per(accum) = 92.1
 T(local opt: renrm) = 8.344e-02 S  per = 7.86  per(accum) = 100
 T(local opt: save ) = 3.053e-04 S  per = 0.0287  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.295e-01 S  T(sum) = 9.266e-01 S  per = 9.969e+01
 T(local opt: preprocess                  ) = 4.498e-03 S  per = 0.485  per(accum) = 0.485
 T(local opt: symbolic_formulae           ) = 8.043e-03 S  per = 0.868  per(accum) = 1.35
 T(local opt: hintermediate init          ) = 3.018e-04 S  per = 0.0326  per(accum) = 1.39
 T(local opt: preprocess_hformulae_Hxlist ) = 2.939e-01 S  per = 31.7  per(accum) = 33.1
 T(local opt: hmmtasks init               ) = 1.282e-01 S  per = 13.8  per(accum) = 46.9
 T(local opt: initial guess for dvdson    ) = 1.524e-03 S  per = 0.164  per(accum) = 47.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.057e-01 S  per = 43.8  per(accum) = 90.9
 T(local opt: dvdson [cpu-gpu]            ) = 4.726e-03 S  per = 0.51  per(accum) = 91.4
 T(local opt: dvdson [nccl]               ) = 4.497e-05 S  per = 0.00485  per(accum) = 91.4
 T(local opt: dvdson [mpi]                ) = 1.419e-06 S  per = 0.000153  per(accum) = 91.4
 T(local opt: dvdson [rest part(linalg)]  ) = 7.963e-02 S  per = 8.59  per(accum) = 100
Detailed decomposition of T(renrm) = 8.344e-02 S  T(sum) = 8.344e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.969e-04 S  per = 0.356  per(accum) = 0.356
 T(local opt: qops init                    ) = 4.201e-03 S  per = 5.04  per(accum) = 5.39
 T(local opt: symbolic_formulae_renorm     ) = 5.023e-03 S  per = 6.02  per(accum) = 11.4
 T(local opt: allocate qops on gpu         ) = 1.474e-02 S  per = 17.7  per(accum) = 29.1
 T(local opt: site memcpy cpu2gpu          ) = 6.675e-05 S  per = 0.08  per(accum) = 29.2
 T(local opt: rintermediate init           ) = 8.700e-03 S  per = 10.4  per(accum) = 39.6
 T(local opt: preprocess_formulae_Rlist2   ) = 3.152e-02 S  per = 37.8  per(accum) = 77.4
 T(local opt: rmmtasks init                ) = 1.337e-02 S  per =   16  per(accum) = 93.4
 T(local opt: qops memset on cpu           ) = 5.000e-08 S  per = 5.99e-05  per(accum) = 93.4
 T(local opt: preprocess_renorm_batchGPU   ) = 1.792e-03 S  per = 2.15  per(accum) = 95.5
 T(local opt: deallocate cpu and gpu memory) = 9.615e-05 S  per = 0.115  per(accum) = 95.6
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 5.03e-05  per(accum) = 95.6
 T(local opt: reduction of opS & opH [nccl]) = 4.600e-08 S  per = 5.51e-05  per(accum) = 95.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.416e-04 S  per = 0.17  per(accum) = 95.8
 T(local opt: reduction of opS & opH [mpi] ) = 5.674e-05 S  per = 0.068  per(accum) = 95.9
 T(local opt: qops_pool join and erase     ) = 3.429e-03 S  per = 4.11  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.352e-06 S  per = 0.00881  per(accum) = 100
##### sweep opt: 4.004e+01 S #####
 T(sweep opt: fetch) = 4.164e-01 S  per = 1.04  per(accum) = 1.04
 T(sweep opt: hdiag) = 1.502e+01 S  per = 37.5  per(accum) = 38.5
 T(sweep opt: dvdsn) = 2.124e+01 S  per =   53  per(accum) = 91.6
 T(sweep opt: decim) = 3.952e-01 S  per = 0.987  per(accum) = 92.6
 T(sweep opt: guess) = 3.566e-02 S  per = 0.089  per(accum) = 92.7
 T(sweep opt: renrm) = 2.931e+00 S  per = 7.32  per(accum) = 100
 T(sweep opt: save ) = 9.452e-03 S  per = 0.0236  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.124e+01 S  T(sum) = 2.119e+01 S  per = 9.975e+01
 T(sweep opt: preprocess                  ) = 1.580e-01 S  per = 0.746  per(accum) = 0.746
 T(sweep opt: symbolic_formulae           ) = 2.327e-01 S  per =  1.1  per(accum) = 1.84
 T(sweep opt: hintermediate init          ) = 1.013e-02 S  per = 0.0478  per(accum) = 1.89
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.374e+00 S  per = 34.8  per(accum) = 36.7
 T(sweep opt: hmmtasks init               ) = 3.457e+00 S  per = 16.3  per(accum) = 53
 T(sweep opt: initial guess for dvdson    ) = 4.262e-02 S  per = 0.201  per(accum) = 53.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.792e+00 S  per = 36.8  per(accum) = 90
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.375e-01 S  per = 1.12  per(accum) = 91.1
 T(sweep opt: dvdson [nccl]               ) = 1.300e-03 S  per = 0.00614  per(accum) = 91.1
 T(sweep opt: dvdson [mpi]                ) = 3.035e-05 S  per = 0.000143  per(accum) = 91.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.880e+00 S  per = 8.87  per(accum) = 100
Detailed decomposition of T(renrm) = 2.931e+00 S  T(sum) = 2.931e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.262e-03 S  per = 0.316  per(accum) = 0.316
 T(sweep opt: qops init                    ) = 1.118e-01 S  per = 3.82  per(accum) = 4.13
 T(sweep opt: symbolic_formulae_renorm     ) = 1.190e-01 S  per = 4.06  per(accum) = 8.19
 T(sweep opt: allocate qops on gpu         ) = 1.929e-02 S  per = 0.658  per(accum) = 8.85
 T(sweep opt: site memcpy cpu2gpu          ) = 3.902e-02 S  per = 1.33  per(accum) = 10.2
 T(sweep opt: rintermediate init           ) = 7.533e-02 S  per = 2.57  per(accum) = 12.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.863e-01 S  per = 30.2  per(accum) = 43
 T(sweep opt: rmmtasks init                ) = 4.487e-01 S  per = 15.3  per(accum) = 58.3
 T(sweep opt: qops memset on cpu           ) = 1.182e-06 S  per = 4.03e-05  per(accum) = 58.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.059e+00 S  per = 36.1  per(accum) = 94.4
 T(sweep opt: deallocate cpu and gpu memory) = 3.513e-03 S  per = 0.12  per(accum) = 94.5
 T(sweep opt: construct opS [ifdists=true] ) = 1.541e-06 S  per = 5.26e-05  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.164e-06 S  per = 3.97e-05  per(accum) = 94.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.570e-03 S  per = 0.122  per(accum) = 94.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.523e-03 S  per = 0.052  per(accum) = 94.7
 T(sweep opt: qops_pool join and erase     ) = 9.300e-02 S  per = 3.17  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 6.207e-02 S  per = 2.12  per(accum) = 100
##### global opt: 4.004e+01 S #####
 T(global opt: fetch) = 4.164e-01 S  per = 1.04  per(accum) = 1.04
 T(global opt: hdiag) = 1.502e+01 S  per = 37.5  per(accum) = 38.5
 T(global opt: dvdsn) = 2.124e+01 S  per =   53  per(accum) = 91.6
 T(global opt: decim) = 3.952e-01 S  per = 0.987  per(accum) = 92.6
 T(global opt: guess) = 3.566e-02 S  per = 0.089  per(accum) = 92.7
 T(global opt: renrm) = 2.931e+00 S  per = 7.32  per(accum) = 100
 T(global opt: save ) = 9.452e-03 S  per = 0.0236  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.124e+01 S  T(sum) = 2.119e+01 S  per = 9.975e+01
 T(global opt: preprocess                  ) = 1.580e-01 S  per = 0.746  per(accum) = 0.746
 T(global opt: symbolic_formulae           ) = 2.327e-01 S  per =  1.1  per(accum) = 1.84
 T(global opt: hintermediate init          ) = 1.013e-02 S  per = 0.0478  per(accum) = 1.89
 T(global opt: preprocess_hformulae_Hxlist ) = 7.374e+00 S  per = 34.8  per(accum) = 36.7
 T(global opt: hmmtasks init               ) = 3.457e+00 S  per = 16.3  per(accum) = 53
 T(global opt: initial guess for dvdson    ) = 4.262e-02 S  per = 0.201  per(accum) = 53.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.792e+00 S  per = 36.8  per(accum) = 90
 T(global opt: dvdson [cpu-gpu]            ) = 2.375e-01 S  per = 1.12  per(accum) = 91.1
 T(global opt: dvdson [nccl]               ) = 1.300e-03 S  per = 0.00614  per(accum) = 91.1
 T(global opt: dvdson [mpi]                ) = 3.035e-05 S  per = 0.000143  per(accum) = 91.1
 T(global opt: dvdson [rest part(linalg)]  ) = 1.880e+00 S  per = 8.87  per(accum) = 100
Detailed decomposition of T(renrm) = 2.931e+00 S  T(sum) = 2.931e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.262e-03 S  per = 0.316  per(accum) = 0.316
 T(global opt: qops init                    ) = 1.118e-01 S  per = 3.82  per(accum) = 4.13
 T(global opt: symbolic_formulae_renorm     ) = 1.190e-01 S  per = 4.06  per(accum) = 8.19
 T(global opt: allocate qops on gpu         ) = 1.929e-02 S  per = 0.658  per(accum) = 8.85
 T(global opt: site memcpy cpu2gpu          ) = 3.902e-02 S  per = 1.33  per(accum) = 10.2
 T(global opt: rintermediate init           ) = 7.533e-02 S  per = 2.57  per(accum) = 12.8
 T(global opt: preprocess_formulae_Rlist2   ) = 8.863e-01 S  per = 30.2  per(accum) = 43
 T(global opt: rmmtasks init                ) = 4.487e-01 S  per = 15.3  per(accum) = 58.3
 T(global opt: qops memset on cpu           ) = 1.182e-06 S  per = 4.03e-05  per(accum) = 58.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.059e+00 S  per = 36.1  per(accum) = 94.4
 T(global opt: deallocate cpu and gpu memory) = 3.513e-03 S  per = 0.12  per(accum) = 94.5
 T(global opt: construct opS [ifdists=true] ) = 1.541e-06 S  per = 5.26e-05  per(accum) = 94.5
 T(global opt: reduction of opS & opH [nccl]) = 1.164e-06 S  per = 3.97e-05  per(accum) = 94.5
 T(global opt: qops memcpy gpu2cpu          ) = 3.570e-03 S  per = 0.122  per(accum) = 94.7
 T(global opt: reduction of opS & opH [mpi] ) = 1.523e-03 S  per = 0.052  per(accum) = 94.7
 T(global opt: qops_pool join and erase     ) = 9.300e-02 S  per = 3.17  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 6.207e-02 S  per = 2.12  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-4.547e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=29/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=62:4.730e-04MB:4.619e-07GB
total mem of comb=846:6.454e-03MB:6.303e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:5 S:15 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1365:1.041e-02MB:1.017e-05GB
        per(mem): H:1.47 C:7.69 S:23.1 A:12.8 B:54.9 
 rqops: oplist=HCSPQ nops=H:1 C:13 S:7 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=53:0.000404MB size(tot)=2536:0.0193MB:1.89e-05GB
        per(mem): H:1.1 C:6.15 S:3.31 P:0 Q:89.4 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5897:0.045MB:4.39e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.010e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-1.103e-05 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=166:1.266e-03MB
qtensor4: wf4 own=1 _data=0x3c68ac00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
 qbond: qcol nsym=5 dimAll=10
 (20,2):4 (20,0):3 (20,4):1 (21,3):1 (21,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=41 nblocks=456 size=166:1.266e-03MB
### DIAG TIMING: total=2.285e-02 t1=1.391e-04, t2=2.557e-04, t3=1.507e-04, t4=2.228e-02, t5=3.493e-06, t6=1.553e-05, t7=2.900e-06
duration_diagGPU:2.286e-02
duration_diagreduce:5.900e-08
duration_diagtransform:1.022e-06
----- TIMING FOR symbolic_formulae_twodot with size=491 : 6.572e-03 S -----
rank=0 GPUmem(GB): used=4.394e-05 (oper)=4.394e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=491
 no. of hintermediate operators=244
 no. of coefficients=3269:2.494e-02MB:2.436e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.522e-04 S -----
rank=0 GPUmem(GB): used=6.829e-05 (oper,hinter)=4.394e-05,2.436e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.195e-01 S size(H_formulae)=491 size(Hxlst2)=41 T(Hmu/Hxlist)=1.344e-03,4.181e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.237e-01 S size(H_formulae)=491 size(Hxlst)=26150 -----
rank=0 GPUmem(GB): used=6.829e-05 avail=1.068e+01 total=1.068e+01 dvdson[need]=2.474e-06 batch[need]=6.624e-03 blksize=12 blksize0=9 batchsize=26150
rank=0 GPUmem(GB): used=6.695e-03 (oper,hinter,dvdson,batch)=4.394e-05,2.436e-05,2.474e-06,6.624e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=166 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.039e-04,1.395e-02,8.413e-02,1.072e-02,1.090e-01
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=1.915e-04 speed=1.292e-02GB/S T(nccl)=1.247e-05 speed=1.983e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=8.4e-02 t_reduction=1.1e-02 tot=1.1e-01 -----
 sigma[inter] counter=181 t=1.4e-02 per=1.3e+01 cost=1.2e+06 flops=8.9e+07
 sigma[gemm] counter=181 i=0 t=1.5e-06 per=1.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=1 t=1.2e-06 per=1.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=2 t=1.1e-06 per=1.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=3 t=1.1e-06 per=1.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=4 t=7.2e-02 per=6.7e+01 cost=1.8e+05 flops=2.4e+06
 sigma[gemm] counter=181 i=5 t=6.7e-03 per=6.2e+00 cost=1.8e+05 flops=2.7e+07
 sigma[gemm] counter=181 i=6 t=2.5e-03 per=2.3e+00 cost=2.1e+05 flops=8.2e+07
 sigma[gemm] counter=181 i=7 t=2.5e-03 per=2.3e+00 cost=2.2e+05 flops=9.0e+07
 sigma[gemm] counter=181 total t=8.4e-02 per=7.7e+01 cost=7.9e+05 flops=9.3e+06
 sigma[red] counter=181 t=1.1e-02 per=9.9e+00 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.2e+00 t_reduction=2.1e+00 tot=7.9e+00 -----
 sigma_tot[inter] counter=181 t=1.6e+00 per=2.0e+01 cost=1.6e+08 flops=1.0e+08
 sigma_tot[gemm] counter=181 i=0 t=3.7e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=1 t=3.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=2 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=3 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=4 t=1.1e+00 per=1.4e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=181 i=5 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=181 i=6 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.6e+07
 sigma_tot[gemm] counter=181 i=7 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=181 total t=4.2e+00 per=5.4e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=181 t=2.1e+00 per=2.7e+01 cost=2.7e+07 flops=1.3e+07
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,9.5e-06,3.8e-06,1.7e-06,4.9e-07
settings: ndim=166 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336065256982 -1.116e+03  1.593e-02    1     1  1.093e-01 1.093e-01 1.092e-01
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.215e-03,4.944e-03,1.002e-02,1.083e-02,2.702e-02
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=1.207e-03 speed=2.049e-03GB/S T(nccl)=7.968e-06 speed=3.104e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=182 t=4.9e-03 per=1.9e+01 cost=1.2e+06 flops=2.5e+08
 sigma[gemm] counter=182 i=0 t=2.0e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=1 t=1.6e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=2 t=1.6e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=3 t=1.6e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=4 t=2.5e-03 per=9.6e+00 cost=1.8e+05 flops=7.1e+07
 sigma[gemm] counter=182 i=5 t=2.5e-03 per=9.7e+00 cost=1.8e+05 flops=7.3e+07
 sigma[gemm] counter=182 i=6 t=2.5e-03 per=9.8e+00 cost=2.1e+05 flops=8.1e+07
 sigma[gemm] counter=182 i=7 t=2.5e-03 per=9.8e+00 cost=2.2e+05 flops=8.9e+07
 sigma[gemm] counter=182 total t=1.0e-02 per=3.9e+01 cost=7.9e+05 flops=7.8e+07
 sigma[red] counter=182 t=1.1e-02 per=4.2e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.2e+00 t_reduction=2.1e+00 tot=7.9e+00 -----
 sigma_tot[inter] counter=182 t=1.6e+00 per=2.0e+01 cost=1.6e+08 flops=1.0e+08
 sigma_tot[gemm] counter=182 i=0 t=3.7e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=1 t=3.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=2 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=3 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=4 t=1.1e+00 per=1.4e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=182 i=5 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=182 i=6 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.6e+07
 sigma_tot[gemm] counter=182 i=7 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.8e+07
 sigma_tot[gemm] counter=182 total t=4.2e+00 per=5.4e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=182 t=2.1e+00 per=2.7e+01 cost=2.8e+07 flops=1.3e+07
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,3.8e-05,4.1e-06,1.8e-06,2.8e-07
    2   0 -    -116.336645214260 -5.800e-04  4.132e-03    2     2  1.500e-01 7.500e-02 6.819e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.808e-04,5.019e-03,1.228e-02,1.082e-02,2.902e-02
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=8.740e-04 speed=2.830e-03GB/S T(nccl)=6.741e-06 speed=3.669e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.2e-02 t_reduction=1.1e-02 tot=2.8e-02 -----
 sigma[inter] counter=183 t=5.0e-03 per=1.8e+01 cost=1.2e+06 flops=2.5e+08
 sigma[gemm] counter=183 i=0 t=1.9e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=1 t=1.6e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=2 t=1.6e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=3 t=1.5e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=4 t=4.6e-03 per=1.7e+01 cost=1.8e+05 flops=3.8e+07
 sigma[gemm] counter=183 i=5 t=2.5e-03 per=9.1e+00 cost=1.8e+05 flops=7.1e+07
 sigma[gemm] counter=183 i=6 t=2.6e-03 per=9.1e+00 cost=2.1e+05 flops=8.0e+07
 sigma[gemm] counter=183 i=7 t=2.5e-03 per=9.0e+00 cost=2.2e+05 flops=8.9e+07
 sigma[gemm] counter=183 total t=1.2e-02 per=4.4e+01 cost=7.9e+05 flops=6.4e+07
 sigma[red] counter=183 t=1.1e-02 per=3.8e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.2e+00 t_reduction=2.1e+00 tot=7.9e+00 -----
 sigma_tot[inter] counter=183 t=1.6e+00 per=2.0e+01 cost=1.6e+08 flops=1.0e+08
 sigma_tot[gemm] counter=183 i=0 t=3.8e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=1 t=3.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=2 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=3 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=4 t=1.1e+00 per=1.4e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=183 i=5 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=183 i=6 t=1.0e+00 per=1.3e+01 cost=2.7e+07 flops=2.6e+07
 sigma_tot[gemm] counter=183 i=7 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=183 total t=4.2e+00 per=5.4e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=183 t=2.1e+00 per=2.7e+01 cost=2.8e+07 flops=1.3e+07
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,3.5e-05,3.3e-06,1.8e-06,2.6e-07
    3   0 -    -116.336688708784 -4.349e-05  1.614e-03    3     3  1.911e-01 6.370e-02 5.517e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.916e-04,5.020e-03,1.003e-02,1.077e-02,2.633e-02
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=4.854e-04 speed=5.096e-03GB/S T(nccl)=6.145e-06 speed=4.025e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.6e-02 -----
 sigma[inter] counter=184 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.5e+08
 sigma[gemm] counter=184 i=0 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=1 t=1.4e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=2 t=1.3e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=3 t=1.3e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=4 t=2.5e-03 per=9.6e+00 cost=1.8e+05 flops=7.1e+07
 sigma[gemm] counter=184 i=5 t=2.5e-03 per=9.7e+00 cost=1.8e+05 flops=7.2e+07
 sigma[gemm] counter=184 i=6 t=2.5e-03 per=9.8e+00 cost=2.1e+05 flops=8.1e+07
 sigma[gemm] counter=184 i=7 t=2.5e-03 per=9.7e+00 cost=2.2e+05 flops=8.9e+07
 sigma[gemm] counter=184 total t=1.0e-02 per=3.9e+01 cost=7.9e+05 flops=7.8e+07
 sigma[red] counter=184 t=1.1e-02 per=4.2e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.3e+00 t_reduction=2.1e+00 tot=7.9e+00 -----
 sigma_tot[inter] counter=184 t=1.6e+00 per=2.0e+01 cost=1.6e+08 flops=1.0e+08
 sigma_tot[gemm] counter=184 i=0 t=3.8e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=1 t=3.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=2 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=3 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=4 t=1.1e+00 per=1.4e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=184 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=184 i=6 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=184 i=7 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=184 total t=4.3e+00 per=5.4e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=184 t=2.1e+00 per=2.7e+01 cost=2.8e+07 flops=1.3e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.6e-05,3.2e-06,1.7e-06,2.8e-07
    4   0 -    -116.336696022089 -7.313e-06  6.245e-04    3     4  2.298e-01 5.745e-02 4.799e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.150e-03,4.960e-03,9.884e-03,1.061e-02,2.762e-02
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=2.144e-03 speed=1.154e-03GB/S T(nccl)=6.146e-06 speed=4.025e-01GB/S
----- TIMING FOR sigma : t_inter=5.0e-03 t_gemm=9.9e-03 t_reduction=1.1e-02 tot=2.5e-02 -----
 sigma[inter] counter=185 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.5e+08
 sigma[gemm] counter=185 i=0 t=1.7e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=1 t=1.5e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=2 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=3 t=1.5e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=4 t=2.5e-03 per=9.7e+00 cost=1.8e+05 flops=7.1e+07
 sigma[gemm] counter=185 i=5 t=2.5e-03 per=9.8e+00 cost=1.8e+05 flops=7.3e+07
 sigma[gemm] counter=185 i=6 t=2.5e-03 per=9.6e+00 cost=2.1e+05 flops=8.4e+07
 sigma[gemm] counter=185 i=7 t=2.5e-03 per=9.7e+00 cost=2.2e+05 flops=9.1e+07
 sigma[gemm] counter=185 total t=9.9e-03 per=3.9e+01 cost=7.9e+05 flops=8.0e+07
 sigma[red] counter=185 t=1.1e-02 per=4.2e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.3e+00 t_reduction=2.1e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=185 t=1.6e+00 per=2.0e+01 cost=1.7e+08 flops=1.0e+08
 sigma_tot[gemm] counter=185 i=0 t=3.8e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=1 t=3.2e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=2 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=3 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.7e+07
 sigma_tot[gemm] counter=185 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=185 i=6 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=185 i=7 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=185 total t=4.3e+00 per=5.3e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=185 t=2.1e+00 per=2.7e+01 cost=2.8e+07 flops=1.3e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.5e-05,3.2e-06,1.8e-06,2.9e-07
    5   0 -    -116.336696950672 -9.286e-07  1.592e-04    3     5  2.661e-01 5.321e-02 4.394e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.753e-03,4.887e-03,9.817e-03,1.051e-02,2.698e-02
 analyze_tgpu[Hx]: ndim=166:1.237e-06GB T(cpu-gpu)=1.748e-03 speed=1.415e-03GB/S T(nccl)=5.324e-06 speed=4.646e-01GB/S
----- TIMING FOR sigma : t_inter=4.9e-03 t_gemm=9.8e-03 t_reduction=1.1e-02 tot=2.5e-02 -----
 sigma[inter] counter=186 t=4.9e-03 per=1.9e+01 cost=1.2e+06 flops=2.5e+08
 sigma[gemm] counter=186 i=0 t=1.5e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=1 t=1.2e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=2 t=1.2e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=3 t=1.2e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=4 t=2.4e-03 per=9.7e+00 cost=1.8e+05 flops=7.2e+07
 sigma[gemm] counter=186 i=5 t=2.5e-03 per=9.8e+00 cost=1.8e+05 flops=7.3e+07
 sigma[gemm] counter=186 i=6 t=2.4e-03 per=9.7e+00 cost=2.1e+05 flops=8.4e+07
 sigma[gemm] counter=186 i=7 t=2.5e-03 per=9.7e+00 cost=2.2e+05 flops=9.1e+07
 sigma[gemm] counter=186 total t=9.8e-03 per=3.9e+01 cost=7.9e+05 flops=8.0e+07
 sigma[red] counter=186 t=1.1e-02 per=4.2e+01 cost=2.3e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.3e+00 t_reduction=2.1e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=186 t=1.6e+00 per=2.0e+01 cost=1.7e+08 flops=1.1e+08
 sigma_tot[gemm] counter=186 i=0 t=3.8e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=1 t=3.2e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=2 t=2.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=3 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.7e+07
 sigma_tot[gemm] counter=186 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=186 i=6 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=186 i=7 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=186 total t=4.3e+00 per=5.3e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=186 t=2.1e+00 per=2.7e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.5e-05,3.2e-06,1.7e-06,2.9e-07
    6   0 +    -116.336697017628 -6.696e-08  4.375e-05    3     6  3.042e-01 5.070e-02 4.113e-02
TIMING FOR Davidson : 3.042e-01  T(cal/comm/rest)=2.468e-01,1.143e-06,5.739e-02
decomposed t_rest=5.739e-02
 T(sub)    =1.960e-04 per=3.416e-01
 T(precond)=5.699e-02 per=9.930e+01
 T(ortho)  =3.799e-05 per=6.620e-02
 T(xcopy)  =1.294e-06 per=2.255e-03
 T(xnrm2)  =3.591e-06 per=6.257e-03
 T(other)  =1.611e-04 per=2.807e-01
optimized energies: isweep=0 ibond=29 dots=2 e[0]=-116.336697017628 nmvp=6
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.228e-02 change=6.396e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=11 dimAll=37
 (20,2):4 (20,0):3 (20,4):1 (21,3):6 (21,1):8 (22,2):6 (22,0):4 (22,4):2 (23,3):1 (23,1):1 (21,5):1
timing for divide=1.2e-04
timing for compute=1.2e-02
timing for collect=2.8e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.2e-04,1.2e-02,0.0e+00,5.2e-06,2.8e-05 -----
decimation summary: 37->10 dwt=+1.424e-04 SvN=1.184e+00
 qbond: qkept nsym=4 dimAll=10
 (21,3):4 (21,1):3 (22,2):2 (22,4):1
----- TIMING for decimation_row(nkr): 1.223e-02 S T(decim/select/formRot)=1.185e-02,3.089e-04,6.872e-05 -----
----- TIMING FOR twodot_decimation: 1.340e-02 S T(wf/decim)=1.096e-03,1.231e-02 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
        per(mem): H:1.34 C:11.3 S:4.83 P:0 Q:82.6 
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.228e-02 change=1.456e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=99 : 3.961e-03 S -----
rank=0 GPUmem(GB): used=7.480e-05 (oper)=4.300e-05
rank=0 GPUmem(GB): used=7.526e-05 (oper,site)=4.300e-05,4.619e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=99
 no. of rintermediate operators=138
 no. of coefficients=1794:1.369e-02MB:1.337e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.413e-03 S -----
rank=0 GPUmem(GB): used=8.862e-05 (oper,site,rinter)=4.300e-05,4.619e-07,1.337e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.915e-02 S size(rtasks)=99 size(Rlst2)=16 T(Rmu/Rlist)=1.023e-03,2.813e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.942e-02 S size(rtasks)=99 size(Rlst)=2725 -----
rank=0 GPUmem(GB): used=8.862e-05 avail=5.084e+00 total=5.084e+00 batch[need]=7.512e-04 blksize=16 blksize0=4 batchsize=2725
rank=0 GPUmem(GB): used=8.398e-04 (oper,site,rinter,batch)=4.300e-05,4.619e-07,1.337e-05,7.512e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.406e-03,2.183e-02,9.657e-03
----- TIMING FOR renorm : t_inter=6.4e-03 t_gemm=2.2e-02 t_reduction=9.7e-03 tot=3.8e-02 -----
 renorm[inter] counter=30 t=6.4e-03 per=1.7e+01 cost=6.9e+04 flops=1.1e+07
 renorm[gemm] counter=30 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=2 t=7.3e-03 per=1.9e+01 cost=1.0e+04 flops=1.4e+06
 renorm[gemm] counter=30 i=3 t=7.3e-03 per=1.9e+01 cost=4.4e+04 flops=6.1e+06
 renorm[gemm] counter=30 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=6 t=7.3e-03 per=1.9e+01 cost=9.7e+04 flops=1.3e+07
 renorm[gemm] counter=30 total t=2.2e-02 per=5.8e+01 cost=1.5e+05 flops=6.9e+06
 renorm[red] counter=30 t=9.7e-03 per=2.5e+01 cost=4.2e+04 flops=4.4e+06
----- TIMING FOR renorm_tot : t_inter=1.7e-01 t_gemm=6.4e-01 t_reduction=2.8e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=30 t=1.7e-01 per=1.5e+01 cost=3.0e+06 flops=1.8e+07
 renorm_tot[gemm] counter=30 i=0 t=4.8e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=1 t=3.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=2 t=8.4e-02 per=7.7e+00 cost=1.8e+05 flops=2.2e+06
 renorm_tot[gemm] counter=30 i=3 t=8.7e-02 per=8.0e+00 cost=5.1e+05 flops=5.9e+06
 renorm_tot[gemm] counter=30 i=4 t=1.3e-01 per=1.2e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=30 i=5 t=1.3e-01 per=1.2e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=30 i=6 t=2.2e-01 per=2.0e+01 cost=1.8e+06 flops=8.5e+06
 renorm_tot[gemm] counter=30 total t=6.4e-01 per=5.9e+01 cost=3.3e+06 flops=5.1e+06
 renorm_tot[red] counter=30 t=2.8e-01 per=2.6e+01 cost=8.0e+05 flops=2.8e+06
qops.to_cpu: size(tot)=2238:1.7e-02MB:1.7e-05GB T(to_cpu)=1.1e-04S speed=1.5e-01GB/S
check ||H-H.dagger||=9.843e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0944 S rank=0 -----
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.321e-02 change=8.748e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.398e-02 change=-2.102e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.398e-02 change=-3.368e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local opt: 1.130e+00 S #####
 T(local opt: fetch) = 1.279e-02 S  per = 1.13  per(accum) = 1.13
 T(local opt: hdiag) = 2.386e-02 S  per = 2.11  per(accum) = 3.24
 T(local opt: dvdsn) = 9.798e-01 S  per = 86.7  per(accum) = 90
 T(local opt: decim) = 1.343e-02 S  per = 1.19  per(accum) = 91.2
 T(local opt: guess) = 1.382e-03 S  per = 0.122  per(accum) = 91.3
 T(local opt: renrm) = 9.794e-02 S  per = 8.67  per(accum) = 100
 T(local opt: save ) = 3.285e-04 S  per = 0.0291  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.798e-01 S  T(sum) = 9.781e-01 S  per = 9.982e+01
 T(local opt: preprocess                  ) = 7.013e-03 S  per = 0.717  per(accum) = 0.717
 T(local opt: symbolic_formulae           ) = 6.592e-03 S  per = 0.674  per(accum) = 1.39
 T(local opt: hintermediate init          ) = 2.680e-04 S  per = 0.0274  per(accum) = 1.42
 T(local opt: preprocess_hformulae_Hxlist ) = 4.254e-01 S  per = 43.5  per(accum) = 44.9
 T(local opt: hmmtasks init               ) = 2.325e-01 S  per = 23.8  per(accum) = 68.7
 T(local opt: initial guess for dvdson    ) = 2.111e-03 S  per = 0.216  per(accum) = 68.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.401e-01 S  per = 24.5  per(accum) = 93.4
 T(local opt: dvdson [cpu-gpu]            ) = 6.649e-03 S  per = 0.68  per(accum) = 94.1
 T(local opt: dvdson [nccl]               ) = 4.479e-05 S  per = 0.00458  per(accum) = 94.1
 T(local opt: dvdson [mpi]                ) = 1.143e-06 S  per = 0.000117  per(accum) = 94.1
 T(local opt: dvdson [rest part(linalg)]  ) = 5.739e-02 S  per = 5.87  per(accum) = 100
Detailed decomposition of T(renrm) = 9.794e-02 S  T(sum) = 9.794e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.584e-04 S  per = 0.264  per(accum) = 0.264
 T(local opt: qops init                    ) = 2.185e-03 S  per = 2.23  per(accum) = 2.49
 T(local opt: symbolic_formulae_renorm     ) = 3.973e-03 S  per = 4.06  per(accum) = 6.55
 T(local opt: allocate qops on gpu         ) = 2.074e-03 S  per = 2.12  per(accum) = 8.67
 T(local opt: site memcpy cpu2gpu          ) = 2.800e-04 S  per = 0.286  per(accum) = 8.95
 T(local opt: rintermediate init           ) = 2.424e-03 S  per = 2.47  per(accum) = 11.4
 T(local opt: preprocess_formulae_Rlist2   ) = 2.951e-02 S  per = 30.1  per(accum) = 41.6
 T(local opt: rmmtasks init                ) = 1.572e-02 S  per =   16  per(accum) = 57.6
 T(local opt: qops memset on cpu           ) = 4.100e-08 S  per = 4.19e-05  per(accum) = 57.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.798e-02 S  per = 38.8  per(accum) = 96.4
 T(local opt: deallocate cpu and gpu memory) = 1.115e-04 S  per = 0.114  per(accum) = 96.5
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 4.29e-05  per(accum) = 96.5
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 3.98e-05  per(accum) = 96.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.218e-04 S  per = 0.124  per(accum) = 96.6
 T(local opt: reduction of opS & opH [mpi] ) = 4.716e-05 S  per = 0.0482  per(accum) = 96.7
 T(local opt: qops_pool join and erase     ) = 3.248e-03 S  per = 3.32  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.516e-06 S  per = 0.00767  per(accum) = 100
##### sweep opt: 4.117e+01 S #####
 T(sweep opt: fetch) = 4.292e-01 S  per = 1.04  per(accum) = 1.04
 T(sweep opt: hdiag) = 1.504e+01 S  per = 36.5  per(accum) = 37.6
 T(sweep opt: dvdsn) = 2.222e+01 S  per =   54  per(accum) = 91.5
 T(sweep opt: decim) = 4.086e-01 S  per = 0.992  per(accum) = 92.5
 T(sweep opt: guess) = 3.704e-02 S  per = 0.09  per(accum) = 92.6
 T(sweep opt: renrm) = 3.029e+00 S  per = 7.36  per(accum) = 100
 T(sweep opt: save ) = 9.781e-03 S  per = 0.0238  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.222e+01 S  T(sum) = 2.216e+01 S  per = 9.975e+01
 T(sweep opt: preprocess                  ) = 1.650e-01 S  per = 0.744  per(accum) = 0.744
 T(sweep opt: symbolic_formulae           ) = 2.393e-01 S  per = 1.08  per(accum) = 1.82
 T(sweep opt: hintermediate init          ) = 1.040e-02 S  per = 0.0469  per(accum) = 1.87
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.799e+00 S  per = 35.2  per(accum) = 37.1
 T(sweep opt: hmmtasks init               ) = 3.690e+00 S  per = 16.6  per(accum) = 53.7
 T(sweep opt: initial guess for dvdson    ) = 4.473e-02 S  per = 0.202  per(accum) = 53.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 8.032e+00 S  per = 36.2  per(accum) = 90.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.441e-01 S  per =  1.1  per(accum) = 91.3
 T(sweep opt: dvdson [nccl]               ) = 1.345e-03 S  per = 0.00607  per(accum) = 91.3
 T(sweep opt: dvdson [mpi]                ) = 3.149e-05 S  per = 0.000142  per(accum) = 91.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.937e+00 S  per = 8.74  per(accum) = 100
Detailed decomposition of T(renrm) = 3.029e+00 S  T(sum) = 3.029e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.520e-03 S  per = 0.314  per(accum) = 0.314
 T(sweep opt: qops init                    ) = 1.140e-01 S  per = 3.76  per(accum) = 4.08
 T(sweep opt: symbolic_formulae_renorm     ) = 1.229e-01 S  per = 4.06  per(accum) = 8.14
 T(sweep opt: allocate qops on gpu         ) = 2.136e-02 S  per = 0.705  per(accum) = 8.84
 T(sweep opt: site memcpy cpu2gpu          ) = 3.930e-02 S  per =  1.3  per(accum) = 10.1
 T(sweep opt: rintermediate init           ) = 7.775e-02 S  per = 2.57  per(accum) = 12.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.158e-01 S  per = 30.2  per(accum) = 42.9
 T(sweep opt: rmmtasks init                ) = 4.644e-01 S  per = 15.3  per(accum) = 58.3
 T(sweep opt: qops memset on cpu           ) = 1.223e-06 S  per = 4.04e-05  per(accum) = 58.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.097e+00 S  per = 36.2  per(accum) = 94.5
 T(sweep opt: deallocate cpu and gpu memory) = 3.625e-03 S  per = 0.12  per(accum) = 94.6
 T(sweep opt: construct opS [ifdists=true] ) = 1.583e-06 S  per = 5.23e-05  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.203e-06 S  per = 3.97e-05  per(accum) = 94.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.692e-03 S  per = 0.122  per(accum) = 94.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.570e-03 S  per = 0.0518  per(accum) = 94.8
 T(sweep opt: qops_pool join and erase     ) = 9.624e-02 S  per = 3.18  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 6.207e-02 S  per = 2.05  per(accum) = 100
##### global opt: 4.117e+01 S #####
 T(global opt: fetch) = 4.292e-01 S  per = 1.04  per(accum) = 1.04
 T(global opt: hdiag) = 1.504e+01 S  per = 36.5  per(accum) = 37.6
 T(global opt: dvdsn) = 2.222e+01 S  per =   54  per(accum) = 91.5
 T(global opt: decim) = 4.086e-01 S  per = 0.992  per(accum) = 92.5
 T(global opt: guess) = 3.704e-02 S  per = 0.09  per(accum) = 92.6
 T(global opt: renrm) = 3.029e+00 S  per = 7.36  per(accum) = 100
 T(global opt: save ) = 9.781e-03 S  per = 0.0238  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.222e+01 S  T(sum) = 2.216e+01 S  per = 9.975e+01
 T(global opt: preprocess                  ) = 1.650e-01 S  per = 0.744  per(accum) = 0.744
 T(global opt: symbolic_formulae           ) = 2.393e-01 S  per = 1.08  per(accum) = 1.82
 T(global opt: hintermediate init          ) = 1.040e-02 S  per = 0.0469  per(accum) = 1.87
 T(global opt: preprocess_hformulae_Hxlist ) = 7.799e+00 S  per = 35.2  per(accum) = 37.1
 T(global opt: hmmtasks init               ) = 3.690e+00 S  per = 16.6  per(accum) = 53.7
 T(global opt: initial guess for dvdson    ) = 4.473e-02 S  per = 0.202  per(accum) = 53.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 8.032e+00 S  per = 36.2  per(accum) = 90.2
 T(global opt: dvdson [cpu-gpu]            ) = 2.441e-01 S  per =  1.1  per(accum) = 91.3
 T(global opt: dvdson [nccl]               ) = 1.345e-03 S  per = 0.00607  per(accum) = 91.3
 T(global opt: dvdson [mpi]                ) = 3.149e-05 S  per = 0.000142  per(accum) = 91.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.937e+00 S  per = 8.74  per(accum) = 100
Detailed decomposition of T(renrm) = 3.029e+00 S  T(sum) = 3.029e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.520e-03 S  per = 0.314  per(accum) = 0.314
 T(global opt: qops init                    ) = 1.140e-01 S  per = 3.76  per(accum) = 4.08
 T(global opt: symbolic_formulae_renorm     ) = 1.229e-01 S  per = 4.06  per(accum) = 8.14
 T(global opt: allocate qops on gpu         ) = 2.136e-02 S  per = 0.705  per(accum) = 8.84
 T(global opt: site memcpy cpu2gpu          ) = 3.930e-02 S  per =  1.3  per(accum) = 10.1
 T(global opt: rintermediate init           ) = 7.775e-02 S  per = 2.57  per(accum) = 12.7
 T(global opt: preprocess_formulae_Rlist2   ) = 9.158e-01 S  per = 30.2  per(accum) = 42.9
 T(global opt: rmmtasks init                ) = 4.644e-01 S  per = 15.3  per(accum) = 58.3
 T(global opt: qops memset on cpu           ) = 1.223e-06 S  per = 4.04e-05  per(accum) = 58.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.097e+00 S  per = 36.2  per(accum) = 94.5
 T(global opt: deallocate cpu and gpu memory) = 3.625e-03 S  per = 0.12  per(accum) = 94.6
 T(global opt: construct opS [ifdists=true] ) = 1.583e-06 S  per = 5.23e-05  per(accum) = 94.6
 T(global opt: reduction of opS & opH [nccl]) = 1.203e-06 S  per = 3.97e-05  per(accum) = 94.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.692e-03 S  per = 0.122  per(accum) = 94.7
 T(global opt: reduction of opS & opH [mpi] ) = 1.570e-03 S  per = 0.0518  per(accum) = 94.8
 T(global opt: qops_pool join and erase     ) = 9.624e-02 S  per = 3.18  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 6.207e-02 S  per = 2.05  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-6.356e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=30/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=841:6.416e-03MB:6.266e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:16 A:16 B:20 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=657:5.013e-03MB:4.895e-06GB
        per(mem): H:2.89 C:7.31 S:29.2 A:2.74 B:57.8 
 rqops: oplist=HCSPQ nops=H:1 C:14 S:6 P:36 Q:42 
        dim(bra,ket)=10,10 size(op)=58:0.000443MB size(tot)=2238:0.0171MB:1.67e-05GB
        per(mem): H:1.34 C:11.3 S:4.83 P:0 Q:82.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4891:0.0373MB:3.64e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.627e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-5.305e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(7,10,3,3) nnz=139:1.060e-03MB
qtensor4: wf4 own=1 _data=0x398d7680
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
 qbond: qcol nsym=4 dimAll=10
 (21,3):4 (21,1):3 (22,2):2 (22,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=139:1.060e-03MB
### DIAG TIMING: total=2.002e-01 t1=3.057e-05, t2=1.691e-03, t3=2.422e-03, t4=1.960e-01, t5=4.838e-06, t6=1.468e-05, t7=4.837e-06
duration_diagGPU:2.002e-01
duration_diagreduce:6.800e-08
duration_diagtransform:7.580e-07
----- TIMING FOR symbolic_formulae_twodot with size=371 : 5.202e-03 S -----
rank=0 GPUmem(GB): used=3.644e-05 (oper)=3.644e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=371
 no. of hintermediate operators=174
 no. of coefficients=2358:1.799e-02MB:1.757e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.603e-04 S -----
rank=0 GPUmem(GB): used=5.401e-05 (oper,hinter)=3.644e-05,1.757e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.324e-01 S size(H_formulae)=371 size(Hxlst2)=21 T(Hmu/Hxlist)=9.901e-04,1.314e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.337e-01 S size(H_formulae)=371 size(Hxlst)=7364 -----
rank=0 GPUmem(GB): used=5.401e-05 avail=3.628e+01 total=3.628e+01 dvdson[need]=2.071e-06 batch[need]=1.865e-03 blksize=12 blksize0=9 batchsize=7364
rank=0 GPUmem(GB): used=1.922e-03 (oper,hinter,dvdson,batch)=3.644e-05,1.757e-05,2.071e-06,1.865e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=139 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.768e-04,1.318e-03,4.026e-03,3.325e-03,8.856e-03
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=1.710e-04 speed=1.211e-02GB/S T(nccl)=5.748e-06 speed=3.603e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-03 t_gemm=4.0e-03 t_reduction=3.3e-03 tot=8.7e-03 -----
 sigma[inter] counter=187 t=1.3e-03 per=1.5e+01 cost=5.2e+05 flops=3.9e+08
 sigma[gemm] counter=187 i=0 t=1.4e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=1 t=1.1e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=2 t=1.2e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=3 t=1.1e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=4 t=9.7e-04 per=1.1e+01 cost=1.0e+05 flops=1.1e+08
 sigma[gemm] counter=187 i=5 t=1.0e-03 per=1.2e+01 cost=1.1e+05 flops=1.0e+08
 sigma[gemm] counter=187 i=6 t=1.1e-03 per=1.2e+01 cost=1.1e+05 flops=1.1e+08
 sigma[gemm] counter=187 i=7 t=9.4e-04 per=1.1e+01 cost=1.1e+05 flops=1.2e+08
 sigma[gemm] counter=187 total t=4.0e-03 per=4.6e+01 cost=4.4e+05 flops=1.1e+08
 sigma[red] counter=187 t=3.3e-03 per=3.8e+01 cost=1.0e+05 flops=3.1e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.3e+00 t_reduction=2.2e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=187 t=1.6e+00 per=2.0e+01 cost=1.7e+08 flops=1.1e+08
 sigma_tot[gemm] counter=187 i=0 t=3.8e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=1 t=3.3e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=2 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=3 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.7e+07
 sigma_tot[gemm] counter=187 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=187 i=6 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=187 i=7 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.8e+07
 sigma_tot[gemm] counter=187 total t=4.3e+00 per=5.3e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=187 t=2.2e+00 per=2.7e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.9e-06,2.3e-06,8.8e-07,2.4e-07
settings: ndim=139 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336635896538 -1.116e+03  1.000e-02    1     1  8.985e-03 8.985e-03 8.959e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.663e-04,1.421e-03,4.225e-03,4.303e-03,1.043e-02
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=4.599e-04 speed=4.504e-03GB/S T(nccl)=6.440e-06 speed=3.216e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-03 t_gemm=4.2e-03 t_reduction=4.3e-03 tot=9.9e-03 -----
 sigma[inter] counter=188 t=1.4e-03 per=1.4e+01 cost=5.2e+05 flops=3.6e+08
 sigma[gemm] counter=188 i=0 t=1.7e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=1 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=2 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=3 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=4 t=1.0e-03 per=1.0e+01 cost=1.0e+05 flops=1.0e+08
 sigma[gemm] counter=188 i=5 t=1.0e-03 per=1.0e+01 cost=1.1e+05 flops=1.0e+08
 sigma[gemm] counter=188 i=6 t=9.6e-04 per=9.7e+00 cost=1.1e+05 flops=1.2e+08
 sigma[gemm] counter=188 i=7 t=1.2e-03 per=1.2e+01 cost=1.1e+05 flops=9.3e+07
 sigma[gemm] counter=188 total t=4.2e-03 per=4.2e+01 cost=4.4e+05 flops=1.0e+08
 sigma[red] counter=188 t=4.3e-03 per=4.3e+01 cost=1.0e+05 flops=2.4e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.3e+00 t_reduction=2.2e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=188 t=1.6e+00 per=2.0e+01 cost=1.7e+08 flops=1.1e+08
 sigma_tot[gemm] counter=188 i=0 t=3.8e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=1 t=3.3e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=2 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=3 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.7e+07
 sigma_tot[gemm] counter=188 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=188 i=6 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=188 i=7 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=188 total t=4.3e+00 per=5.3e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=188 t=2.2e+00 per=2.7e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,2.0e-05,3.9e-06,1.1e-05,4.1e-07
    2   0 -    -116.336823387383 -1.875e-04  2.655e-03    2     2  3.215e-02 1.607e-02 9.765e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.256e-03,4.119e-03,4.041e-03,2.270e-03,1.170e-02
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=1.251e-03 speed=1.656e-03GB/S T(nccl)=4.708e-06 speed=4.399e-01GB/S
----- TIMING FOR sigma : t_inter=4.1e-03 t_gemm=4.0e-03 t_reduction=2.3e-03 tot=1.0e-02 -----
 sigma[inter] counter=189 t=4.1e-03 per=3.9e+01 cost=5.2e+05 flops=1.3e+08
 sigma[gemm] counter=189 i=0 t=1.7e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=1 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=2 t=1.5e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=3 t=1.5e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=4 t=1.0e-03 per=9.7e+00 cost=1.0e+05 flops=1.0e+08
 sigma[gemm] counter=189 i=5 t=1.1e-03 per=1.0e+01 cost=1.1e+05 flops=1.0e+08
 sigma[gemm] counter=189 i=6 t=9.7e-04 per=9.3e+00 cost=1.1e+05 flops=1.2e+08
 sigma[gemm] counter=189 i=7 t=9.9e-04 per=9.5e+00 cost=1.1e+05 flops=1.1e+08
 sigma[gemm] counter=189 total t=4.0e-03 per=3.9e+01 cost=4.4e+05 flops=1.1e+08
 sigma[red] counter=189 t=2.3e-03 per=2.2e+01 cost=1.0e+05 flops=4.5e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.3e+00 t_reduction=2.2e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=189 t=1.6e+00 per=2.0e+01 cost=1.7e+08 flops=1.1e+08
 sigma_tot[gemm] counter=189 i=0 t=3.9e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=1 t=3.3e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=2 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=3 t=3.0e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.8e+07
 sigma_tot[gemm] counter=189 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=189 i=6 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=189 i=7 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=189 total t=4.3e+00 per=5.3e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=189 t=2.2e+00 per=2.7e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.7e-05,3.3e-06,1.8e-06,2.3e-07
    3   0 -    -116.336847409293 -2.402e-05  1.454e-03    3     3  5.375e-02 1.792e-02 1.045e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.240e-03,1.375e-03,4.308e-03,6.258e-03,1.319e-02
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=1.234e-03 speed=1.679e-03GB/S T(nccl)=6.357e-06 speed=3.258e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-03 t_gemm=4.3e-03 t_reduction=6.3e-03 tot=1.2e-02 -----
 sigma[inter] counter=190 t=1.4e-03 per=1.2e+01 cost=5.2e+05 flops=3.8e+08
 sigma[gemm] counter=190 i=0 t=2.1e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=1 t=1.8e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=2 t=1.7e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=3 t=1.7e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=4 t=1.0e-03 per=8.5e+00 cost=1.0e+05 flops=1.0e+08
 sigma[gemm] counter=190 i=5 t=1.0e-03 per=8.5e+00 cost=1.1e+05 flops=1.0e+08
 sigma[gemm] counter=190 i=6 t=9.8e-04 per=8.2e+00 cost=1.1e+05 flops=1.2e+08
 sigma[gemm] counter=190 i=7 t=1.3e-03 per=1.1e+01 cost=1.1e+05 flops=8.8e+07
 sigma[gemm] counter=190 total t=4.3e-03 per=3.6e+01 cost=4.4e+05 flops=1.0e+08
 sigma[red] counter=190 t=6.3e-03 per=5.2e+01 cost=1.0e+05 flops=1.6e+07
----- TIMING FOR sigma_tot : t_inter=1.6e+00 t_gemm=4.3e+00 t_reduction=2.2e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=190 t=1.6e+00 per=2.0e+01 cost=1.7e+08 flops=1.1e+08
 sigma_tot[gemm] counter=190 i=0 t=3.9e-04 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=1 t=3.3e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=2 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=3 t=3.0e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.8e+07
 sigma_tot[gemm] counter=190 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=190 i=6 t=1.0e+00 per=1.3e+01 cost=2.8e+07 flops=2.7e+07
 sigma_tot[gemm] counter=190 i=7 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=190 total t=4.3e+00 per=5.3e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=190 t=2.2e+00 per=2.7e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.6e-05,3.2e-06,1.7e-06,2.6e-07
    4   0 -    -116.336854059180 -6.650e-06  6.153e-04    3     4  7.709e-02 1.927e-02 1.116e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.856e-04,1.824e-01,1.062e-02,2.347e-03,1.955e-01
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=1.766e-04 speed=1.173e-02GB/S T(nccl)=9.003e-06 speed=2.301e-01GB/S
----- TIMING FOR sigma : t_inter=1.8e-01 t_gemm=1.1e-02 t_reduction=2.3e-03 tot=2.0e-01 -----
 sigma[inter] counter=191 t=1.8e-01 per=9.3e+01 cost=5.2e+05 flops=2.8e+06
 sigma[gemm] counter=191 i=0 t=1.5e-06 per=7.8e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=1 t=1.3e-06 per=6.6e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=2 t=1.3e-06 per=6.5e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=3 t=1.3e-06 per=6.5e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=4 t=1.7e-03 per=8.5e-01 cost=1.0e+05 flops=6.2e+07
 sigma[gemm] counter=191 i=5 t=6.9e-03 per=3.5e+00 cost=1.1e+05 flops=1.5e+07
 sigma[gemm] counter=191 i=6 t=1.0e-03 per=5.3e-01 cost=1.1e+05 flops=1.1e+08
 sigma[gemm] counter=191 i=7 t=1.0e-03 per=5.2e-01 cost=1.1e+05 flops=1.1e+08
 sigma[gemm] counter=191 total t=1.1e-02 per=5.4e+00 cost=4.4e+05 flops=4.1e+07
 sigma[red] counter=191 t=2.3e-03 per=1.2e+00 cost=1.0e+05 flops=4.3e+07
----- TIMING FOR sigma_tot : t_inter=1.8e+00 t_gemm=4.3e+00 t_reduction=2.2e+00 tot=8.2e+00 -----
 sigma_tot[inter] counter=191 t=1.8e+00 per=2.1e+01 cost=1.7e+08 flops=9.6e+07
 sigma_tot[gemm] counter=191 i=0 t=3.9e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=1 t=3.3e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=2 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=3 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.8e+07
 sigma_tot[gemm] counter=191 i=5 t=1.1e+00 per=1.3e+01 cost=3.1e+07 flops=2.9e+07
 sigma_tot[gemm] counter=191 i=6 t=1.0e+00 per=1.3e+01 cost=2.9e+07 flops=2.7e+07
 sigma_tot[gemm] counter=191 i=7 t=1.0e+00 per=1.3e+01 cost=3.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=191 total t=4.3e+00 per=5.2e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=191 t=2.2e+00 per=2.6e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=9.0e-06,3.9e-05,5.6e-06,2.4e-06,4.5e-07
    5   0 -    -116.336854925618 -8.664e-07  2.552e-04    3     5  2.814e-01 5.628e-02 4.808e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.229e-04,9.693e-03,2.912e-02,1.252e-02,5.207e-02
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=7.154e-04 speed=2.895e-03GB/S T(nccl)=7.455e-06 speed=2.778e-01GB/S
----- TIMING FOR sigma : t_inter=9.7e-03 t_gemm=2.9e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=192 t=9.7e-03 per=1.9e+01 cost=5.2e+05 flops=5.3e+07
 sigma[gemm] counter=192 i=0 t=2.9e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=1 t=2.6e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=2 t=2.5e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=3 t=2.6e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=4 t=7.3e-03 per=1.4e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=192 i=5 t=7.3e-03 per=1.4e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=192 i=6 t=7.2e-03 per=1.4e+01 cost=1.1e+05 flops=1.6e+07
 sigma[gemm] counter=192 i=7 t=7.3e-03 per=1.4e+01 cost=1.1e+05 flops=1.6e+07
 sigma[gemm] counter=192 total t=2.9e-02 per=5.7e+01 cost=4.4e+05 flops=1.5e+07
 sigma[red] counter=192 t=1.3e-02 per=2.4e+01 cost=1.0e+05 flops=8.1e+06
----- TIMING FOR sigma_tot : t_inter=1.8e+00 t_gemm=4.3e+00 t_reduction=2.2e+00 tot=8.3e+00 -----
 sigma_tot[inter] counter=192 t=1.8e+00 per=2.1e+01 cost=1.7e+08 flops=9.5e+07
 sigma_tot[gemm] counter=192 i=0 t=3.9e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=1 t=3.3e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=2 t=3.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=3 t=3.1e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.8e+07
 sigma_tot[gemm] counter=192 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.9e+07
 sigma_tot[gemm] counter=192 i=6 t=1.1e+00 per=1.3e+01 cost=2.9e+07 flops=2.7e+07
 sigma_tot[gemm] counter=192 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=192 total t=4.3e+00 per=5.2e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=192 t=2.2e+00 per=2.6e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.9e-05,1.6e-05,1.9e-06,3.1e-07
    6   0 -    -116.336855100777 -1.752e-07  1.084e-04    3     6  3.414e-01 5.689e-02 4.877e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.731e-03,9.680e-03,2.912e-02,1.252e-02,5.305e-02
 analyze_tgpu[Hx]: ndim=139:1.036e-06GB T(cpu-gpu)=1.726e-03 speed=1.200e-03GB/S T(nccl)=4.824e-06 speed=4.294e-01GB/S
----- TIMING FOR sigma : t_inter=9.7e-03 t_gemm=2.9e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=193 t=9.7e-03 per=1.9e+01 cost=5.2e+05 flops=5.3e+07
 sigma[gemm] counter=193 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=2 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=3 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=4 t=7.3e-03 per=1.4e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=193 i=5 t=7.3e-03 per=1.4e+01 cost=1.1e+05 flops=1.4e+07
 sigma[gemm] counter=193 i=6 t=7.3e-03 per=1.4e+01 cost=1.1e+05 flops=1.6e+07
 sigma[gemm] counter=193 i=7 t=7.3e-03 per=1.4e+01 cost=1.1e+05 flops=1.6e+07
 sigma[gemm] counter=193 total t=2.9e-02 per=5.7e+01 cost=4.4e+05 flops=1.5e+07
 sigma[red] counter=193 t=1.3e-02 per=2.4e+01 cost=1.0e+05 flops=8.2e+06
----- TIMING FOR sigma_tot : t_inter=1.8e+00 t_gemm=4.4e+00 t_reduction=2.2e+00 tot=8.3e+00 -----
 sigma_tot[inter] counter=193 t=1.8e+00 per=2.1e+01 cost=1.7e+08 flops=9.5e+07
 sigma_tot[gemm] counter=193 i=0 t=3.9e-04 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=1 t=3.4e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=2 t=3.1e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=3 t=3.1e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=4 t=1.1e+00 per=1.4e+01 cost=3.1e+07 flops=2.8e+07
 sigma_tot[gemm] counter=193 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.9e+07
 sigma_tot[gemm] counter=193 i=6 t=1.1e+00 per=1.3e+01 cost=2.9e+07 flops=2.7e+07
 sigma_tot[gemm] counter=193 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=193 total t=4.4e+00 per=5.2e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=193 t=2.2e+00 per=2.6e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.3e-05,5.9e-06,1.3e-06,1.9e-07
    7   0 +    -116.336855132062 -3.128e-08  3.614e-05    3     7  4.055e-01 5.793e-02 4.939e-02
TIMING FOR Davidson : 4.055e-01  T(cal/comm/rest)=3.458e-01,1.255e-06,5.975e-02
decomposed t_rest=5.975e-02
 T(sub)    =2.312e-04 per=3.869e-01
 T(precond)=5.922e-02 per=9.910e+01
 T(ortho)  =6.841e-05 per=1.145e-01
 T(xcopy)  =1.236e-06 per=2.069e-03
 T(xnrm2)  =3.954e-06 per=6.618e-03
 T(other)  =2.302e-04 per=3.853e-01
optimized energies: isweep=0 ibond=30 dots=2 e[0]=-116.336855132062 nmvp=7
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=2.068e-03 change=2.049e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=10 dimAll=40
 (21,3):4 (21,1):3 (22,2):9 (22,4):5 (23,3):7 (23,1):5 (24,2):2 (24,4):1 (22,0):3 (23,5):1
timing for divide=6.7e-05
timing for compute=1.3e-02
timing for collect=4.7e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.7e-05,1.3e-02,0.0e+00,5.8e-06,4.7e-05 -----
decimation summary: 40->10 dwt=+5.309e-06 SvN=6.954e-01
 qbond: qkept nsym=5 dimAll=10
 (22,2):3 (23,3):3 (23,1):2 (21,1):1 (24,2):1
----- TIMING for decimation_row(nkr): 1.381e-02 S T(decim/select/formRot)=1.342e-02,3.044e-04,9.124e-05 -----
----- TIMING FOR twodot_decimation: 1.450e-02 S T(wf/decim)=5.841e-04,1.391e-02 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=1539:1.174e-02MB:1.147e-05GB
        per(mem): H:1.56 C:22.4 S:7.47 P:10.1 Q:58.5 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=2.060e-03 change=1.585e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 3.160e-03 S -----
rank=0 GPUmem(GB): used=6.058e-05 (oper)=3.558e-05
rank=0 GPUmem(GB): used=6.105e-05 (oper,site)=3.558e-05,4.694e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=76
 no. of rintermediate operators=100
 no. of coefficients=1400:1.068e-02MB:1.043e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.409e-03 S -----
rank=0 GPUmem(GB): used=7.148e-05 (oper,site,rinter)=3.558e-05,4.694e-07,1.043e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.075e-02 S size(rtasks)=76 size(Rlst2)=25 T(Rmu/Rlist)=7.419e-04,2.001e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.110e-02 S size(rtasks)=76 size(Rlst)=1729 -----
rank=0 GPUmem(GB): used=7.148e-05 avail=3.163e+01 total=3.163e+01 batch[need]=4.251e-04 blksize=12 blksize0=8 batchsize=1729
rank=0 GPUmem(GB): used=4.966e-04 (oper,site,rinter,batch)=3.558e-05,4.694e-07,1.043e-05,4.251e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.212e-03,1.029e-02,1.311e-03
----- TIMING FOR renorm : t_inter=5.2e-03 t_gemm=1.0e-02 t_reduction=1.3e-03 tot=1.7e-02 -----
 renorm[inter] counter=31 t=5.2e-03 per=3.1e+01 cost=9.4e+04 flops=1.8e+07
 renorm[gemm] counter=31 i=0 t=1.3e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=1 t=1.1e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=2 t=3.2e-03 per=1.9e+01 cost=1.4e+04 flops=4.2e+06
 renorm[gemm] counter=31 i=3 t=5.9e-03 per=3.5e+01 cost=3.6e+04 flops=6.0e+06
 renorm[gemm] counter=31 i=4 t=1.2e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=5 t=1.1e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=6 t=1.1e-03 per=6.6e+00 cost=6.1e+04 flops=5.5e+07
 renorm[gemm] counter=31 total t=1.0e-02 per=6.1e+01 cost=1.1e+05 flops=1.1e+07
 renorm[red] counter=31 t=1.3e-03 per=7.8e+00 cost=2.3e+04 flops=1.8e+07
----- TIMING FOR renorm_tot : t_inter=1.7e-01 t_gemm=6.5e-01 t_reduction=2.9e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=31 t=1.7e-01 per=1.5e+01 cost=3.1e+06 flops=1.8e+07
 renorm_tot[gemm] counter=31 i=0 t=4.9e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=1 t=3.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=2 t=8.7e-02 per=7.9e+00 cost=2.0e+05 flops=2.2e+06
 renorm_tot[gemm] counter=31 i=3 t=9.3e-02 per=8.4e+00 cost=5.5e+05 flops=5.9e+06
 renorm_tot[gemm] counter=31 i=4 t=1.3e-01 per=1.1e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=31 i=5 t=1.3e-01 per=1.2e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=31 i=6 t=2.2e-01 per=2.0e+01 cost=1.9e+06 flops=8.7e+06
 renorm_tot[gemm] counter=31 total t=6.5e-01 per=5.9e+01 cost=3.4e+06 flops=5.2e+06
 renorm_tot[red] counter=31 t=2.9e-01 per=2.6e+01 cost=8.3e+05 flops=2.9e+06
qops.to_cpu: size(tot)=1539:1.2e-02MB:1.1e-05GB T(to_cpu)=9.3e-05S speed=1.2e-01GB/S
check ||H-H.dagger||=1.271e-14 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0586 S rank=0 -----
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=1.945e-03 change=5.884e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.335e-03 change=-1.567e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.335e-03 change=-3.695e-06 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local opt: 8.964e-01 S #####
 T(local opt: fetch) = 1.096e-02 S  per = 1.22  per(accum) = 1.22
 T(local opt: hdiag) = 2.006e-01 S  per = 22.4  per(accum) = 23.6
 T(local opt: dvdsn) = 6.077e-01 S  per = 67.8  per(accum) = 91.4
 T(local opt: decim) = 1.452e-02 S  per = 1.62  per(accum) = 93
 T(local opt: guess) = 9.413e-04 S  per = 0.105  per(accum) = 93.1
 T(local opt: renrm) = 6.130e-02 S  per = 6.84  per(accum) = 100
 T(local opt: save ) = 3.020e-04 S  per = 0.0337  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.077e-01 S  T(sum) = 5.976e-01 S  per = 9.833e+01
 T(local opt: preprocess                  ) = 2.931e-03 S  per = 0.49  per(accum) = 0.49
 T(local opt: symbolic_formulae           ) = 5.214e-03 S  per = 0.872  per(accum) = 1.36
 T(local opt: hintermediate init          ) = 2.797e-04 S  per = 0.0468  per(accum) = 1.41
 T(local opt: preprocess_hformulae_Hxlist ) = 1.339e-01 S  per = 22.4  per(accum) = 23.8
 T(local opt: hmmtasks init               ) = 4.858e-02 S  per = 8.13  per(accum) = 32
 T(local opt: initial guess for dvdson    ) = 1.151e-03 S  per = 0.193  per(accum) = 32.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.400e-01 S  per = 56.9  per(accum) = 89
 T(local opt: dvdson [cpu-gpu]            ) = 5.733e-03 S  per = 0.959  per(accum) = 90
 T(local opt: dvdson [nccl]               ) = 4.454e-05 S  per = 0.00745  per(accum) = 90
 T(local opt: dvdson [mpi]                ) = 1.255e-06 S  per = 0.00021  per(accum) = 90
 T(local opt: dvdson [rest part(linalg)]  ) = 5.975e-02 S  per =   10  per(accum) = 100
Detailed decomposition of T(renrm) = 6.130e-02 S  T(sum) = 6.130e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.621e-04 S  per = 0.427  per(accum) = 0.427
 T(local opt: qops init                    ) = 2.773e-03 S  per = 4.52  per(accum) = 4.95
 T(local opt: symbolic_formulae_renorm     ) = 3.171e-03 S  per = 5.17  per(accum) = 10.1
 T(local opt: allocate qops on gpu         ) = 6.301e-05 S  per = 0.103  per(accum) = 10.2
 T(local opt: site memcpy cpu2gpu          ) = 1.855e-03 S  per = 3.03  per(accum) = 13.3
 T(local opt: rintermediate init           ) = 2.420e-03 S  per = 3.95  per(accum) = 17.2
 T(local opt: preprocess_formulae_Rlist2   ) = 2.116e-02 S  per = 34.5  per(accum) = 51.7
 T(local opt: rmmtasks init                ) = 1.005e-02 S  per = 16.4  per(accum) = 68.1
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 5.06e-05  per(accum) = 68.1
 T(local opt: preprocess_renorm_batchGPU   ) = 1.691e-02 S  per = 27.6  per(accum) = 95.7
 T(local opt: deallocate cpu and gpu memory) = 7.715e-05 S  per = 0.126  per(accum) = 95.8
 T(local opt: construct opS [ifdists=true] ) = 4.100e-08 S  per = 6.69e-05  per(accum) = 95.8
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 6.2e-05  per(accum) = 95.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.004e-04 S  per = 0.164  per(accum) = 96
 T(local opt: reduction of opS & opH [mpi] ) = 5.915e-05 S  per = 0.0965  per(accum) = 96.1
 T(local opt: qops_pool join and erase     ) = 2.395e-03 S  per = 3.91  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.040e-06 S  per = 0.0131  per(accum) = 100
##### sweep opt: 4.207e+01 S #####
 T(sweep opt: fetch) = 4.401e-01 S  per = 1.05  per(accum) = 1.05
 T(sweep opt: hdiag) = 1.524e+01 S  per = 36.2  per(accum) = 37.3
 T(sweep opt: dvdsn) = 2.283e+01 S  per = 54.3  per(accum) = 91.5
 T(sweep opt: decim) = 4.231e-01 S  per = 1.01  per(accum) = 92.5
 T(sweep opt: guess) = 3.798e-02 S  per = 0.0903  per(accum) = 92.6
 T(sweep opt: renrm) = 3.090e+00 S  per = 7.35  per(accum) = 100
 T(sweep opt: save ) = 1.008e-02 S  per = 0.024  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.283e+01 S  T(sum) = 2.276e+01 S  per = 9.971e+01
 T(sweep opt: preprocess                  ) = 1.679e-01 S  per = 0.738  per(accum) = 0.738
 T(sweep opt: symbolic_formulae           ) = 2.445e-01 S  per = 1.07  per(accum) = 1.81
 T(sweep opt: hintermediate init          ) = 1.068e-02 S  per = 0.0469  per(accum) = 1.86
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.933e+00 S  per = 34.9  per(accum) = 36.7
 T(sweep opt: hmmtasks init               ) = 3.738e+00 S  per = 16.4  per(accum) = 53.1
 T(sweep opt: initial guess for dvdson    ) = 4.589e-02 S  per = 0.202  per(accum) = 53.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 8.372e+00 S  per = 36.8  per(accum) = 90.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.498e-01 S  per =  1.1  per(accum) = 91.2
 T(sweep opt: dvdson [nccl]               ) = 1.389e-03 S  per = 0.0061  per(accum) = 91.2
 T(sweep opt: dvdson [mpi]                ) = 3.275e-05 S  per = 0.000144  per(accum) = 91.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.997e+00 S  per = 8.77  per(accum) = 100
Detailed decomposition of T(renrm) = 3.090e+00 S  T(sum) = 3.090e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.782e-03 S  per = 0.317  per(accum) = 0.317
 T(sweep opt: qops init                    ) = 1.168e-01 S  per = 3.78  per(accum) = 4.1
 T(sweep opt: symbolic_formulae_renorm     ) = 1.261e-01 S  per = 4.08  per(accum) = 8.18
 T(sweep opt: allocate qops on gpu         ) = 2.142e-02 S  per = 0.693  per(accum) = 8.87
 T(sweep opt: site memcpy cpu2gpu          ) = 4.115e-02 S  per = 1.33  per(accum) = 10.2
 T(sweep opt: rintermediate init           ) = 8.017e-02 S  per = 2.59  per(accum) = 12.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.370e-01 S  per = 30.3  per(accum) = 43.1
 T(sweep opt: rmmtasks init                ) = 4.745e-01 S  per = 15.4  per(accum) = 58.5
 T(sweep opt: qops memset on cpu           ) = 1.254e-06 S  per = 4.06e-05  per(accum) = 58.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.113e+00 S  per =   36  per(accum) = 94.5
 T(sweep opt: deallocate cpu and gpu memory) = 3.702e-03 S  per = 0.12  per(accum) = 94.6
 T(sweep opt: construct opS [ifdists=true] ) = 1.624e-06 S  per = 5.26e-05  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.241e-06 S  per = 4.02e-05  per(accum) = 94.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.792e-03 S  per = 0.123  per(accum) = 94.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.629e-03 S  per = 0.0527  per(accum) = 94.8
 T(sweep opt: qops_pool join and erase     ) = 9.864e-02 S  per = 3.19  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 6.208e-02 S  per = 2.01  per(accum) = 100
##### global opt: 4.207e+01 S #####
 T(global opt: fetch) = 4.401e-01 S  per = 1.05  per(accum) = 1.05
 T(global opt: hdiag) = 1.524e+01 S  per = 36.2  per(accum) = 37.3
 T(global opt: dvdsn) = 2.283e+01 S  per = 54.3  per(accum) = 91.5
 T(global opt: decim) = 4.231e-01 S  per = 1.01  per(accum) = 92.5
 T(global opt: guess) = 3.798e-02 S  per = 0.0903  per(accum) = 92.6
 T(global opt: renrm) = 3.090e+00 S  per = 7.35  per(accum) = 100
 T(global opt: save ) = 1.008e-02 S  per = 0.024  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.283e+01 S  T(sum) = 2.276e+01 S  per = 9.971e+01
 T(global opt: preprocess                  ) = 1.679e-01 S  per = 0.738  per(accum) = 0.738
 T(global opt: symbolic_formulae           ) = 2.445e-01 S  per = 1.07  per(accum) = 1.81
 T(global opt: hintermediate init          ) = 1.068e-02 S  per = 0.0469  per(accum) = 1.86
 T(global opt: preprocess_hformulae_Hxlist ) = 7.933e+00 S  per = 34.9  per(accum) = 36.7
 T(global opt: hmmtasks init               ) = 3.738e+00 S  per = 16.4  per(accum) = 53.1
 T(global opt: initial guess for dvdson    ) = 4.589e-02 S  per = 0.202  per(accum) = 53.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 8.372e+00 S  per = 36.8  per(accum) = 90.1
 T(global opt: dvdson [cpu-gpu]            ) = 2.498e-01 S  per =  1.1  per(accum) = 91.2
 T(global opt: dvdson [nccl]               ) = 1.389e-03 S  per = 0.0061  per(accum) = 91.2
 T(global opt: dvdson [mpi]                ) = 3.275e-05 S  per = 0.000144  per(accum) = 91.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.997e+00 S  per = 8.77  per(accum) = 100
Detailed decomposition of T(renrm) = 3.090e+00 S  T(sum) = 3.090e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.782e-03 S  per = 0.317  per(accum) = 0.317
 T(global opt: qops init                    ) = 1.168e-01 S  per = 3.78  per(accum) = 4.1
 T(global opt: symbolic_formulae_renorm     ) = 1.261e-01 S  per = 4.08  per(accum) = 8.18
 T(global opt: allocate qops on gpu         ) = 2.142e-02 S  per = 0.693  per(accum) = 8.87
 T(global opt: site memcpy cpu2gpu          ) = 4.115e-02 S  per = 1.33  per(accum) = 10.2
 T(global opt: rintermediate init           ) = 8.017e-02 S  per = 2.59  per(accum) = 12.8
 T(global opt: preprocess_formulae_Rlist2   ) = 9.370e-01 S  per = 30.3  per(accum) = 43.1
 T(global opt: rmmtasks init                ) = 4.745e-01 S  per = 15.4  per(accum) = 58.5
 T(global opt: qops memset on cpu           ) = 1.254e-06 S  per = 4.06e-05  per(accum) = 58.5
 T(global opt: preprocess_renorm_batchGPU   ) = 1.113e+00 S  per =   36  per(accum) = 94.5
 T(global opt: deallocate cpu and gpu memory) = 3.702e-03 S  per = 0.12  per(accum) = 94.6
 T(global opt: construct opS [ifdists=true] ) = 1.624e-06 S  per = 5.26e-05  per(accum) = 94.6
 T(global opt: reduction of opS & opH [nccl]) = 1.241e-06 S  per = 4.02e-05  per(accum) = 94.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.792e-03 S  per = 0.123  per(accum) = 94.7
 T(global opt: reduction of opS & opH [mpi] ) = 1.629e-03 S  per = 0.0527  per(accum) = 94.8
 T(global opt: qops_pool join and erase     ) = 9.864e-02 S  per = 3.19  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 6.208e-02 S  per = 2.01  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-2.030e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 

isweep=0 ibond=31/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=789:6.020e-03MB:5.879e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=839:6.401e-03MB:6.251e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:3 S:17 A:9 B:12 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=155:1.183e-03MB:1.155e-06GB
        per(mem): H:3.87 C:7.74 S:43.9 A:1.94 B:42.6 
 rqops: oplist=HCSPQ nops=H:1 C:15 S:5 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=36:0.000275MB size(tot)=1539:0.0117MB:1.15e-05GB
        per(mem): H:1.56 C:22.4 S:7.47 P:10.1 Q:58.5 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3690:0.0282MB:2.75e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.423e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-7.749e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(4,10,3,3) nnz=66:5.035e-04MB
qtensor4: wf4 own=1 _data=0x3a584fc0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
 qbond: qcol nsym=5 dimAll=10
 (22,2):3 (23,3):3 (23,1):2 (21,1):1 (24,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=220 size=66:5.035e-04MB
### DIAG TIMING: total=1.087e-02 t1=2.853e-05, t2=1.626e-03, t3=2.423e-03, t4=6.766e-03, t5=3.506e-06, t6=1.545e-05, t7=4.877e-06
duration_diagGPU:1.088e-02
duration_diagreduce:3.300e-08
duration_diagtransform:8.460e-07
----- TIMING FOR symbolic_formulae_twodot with size=273 : 3.697e-03 S -----
rank=0 GPUmem(GB): used=2.749e-05 (oper)=2.749e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=273
 no. of hintermediate operators=118
 no. of coefficients=1632:1.245e-02MB:1.216e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.926e-03 S -----
rank=0 GPUmem(GB): used=3.965e-05 (oper,hinter)=2.749e-05,1.216e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.157e-01 S size(H_formulae)=273 size(Hxlst2)=24 T(Hmu/Hxlist)=7.192e-04,1.150e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.169e-01 S size(H_formulae)=273 size(Hxlst)=6854 -----
rank=0 GPUmem(GB): used=3.965e-05 avail=2.645e+01 total=2.645e+01 dvdson[need]=9.835e-07 batch[need]=1.123e-03 blksize=6 blksize0=9 batchsize=6854
rank=0 GPUmem(GB): used=1.164e-03 (oper,hinter,dvdson,batch)=2.749e-05,1.216e-05,9.835e-07,1.123e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=66 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.870e-04,2.949e-01,6.356e-02,1.338e-02,3.720e-01
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=1.762e-04 speed=5.582e-03GB/S T(nccl)=1.084e-05 speed=9.075e-02GB/S
----- TIMING FOR sigma : t_inter=2.9e-01 t_gemm=6.4e-02 t_reduction=1.3e-02 tot=3.7e-01 -----
 sigma[inter] counter=194 t=2.9e-01 per=7.9e+01 cost=3.0e+05 flops=1.0e+06
 sigma[gemm] counter=194 i=0 t=2.8e-06 per=7.5e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=1 t=2.1e-06 per=5.7e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=2 t=2.0e-06 per=5.4e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=3 t=2.2e-06 per=6.0e-04 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=4 t=3.0e-03 per=8.1e-01 cost=3.5e+04 flops=1.2e+07
 sigma[gemm] counter=194 i=5 t=7.5e-03 per=2.0e+00 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=194 i=6 t=7.3e-03 per=2.0e+00 cost=2.3e+04 flops=3.2e+06
 sigma[gemm] counter=194 i=7 t=4.6e-02 per=1.2e+01 cost=2.3e+04 flops=5.0e+05
 sigma[gemm] counter=194 total t=6.4e-02 per=1.7e+01 cost=1.2e+05 flops=1.8e+06
 sigma[red] counter=194 t=1.3e-02 per=3.6e+00 cost=4.2e+04 flops=3.1e+06
----- TIMING FOR sigma_tot : t_inter=2.1e+00 t_gemm=4.4e+00 t_reduction=2.2e+00 tot=8.7e+00 -----
 sigma_tot[inter] counter=194 t=2.1e+00 per=2.4e+01 cost=1.7e+08 flops=8.2e+07
 sigma_tot[gemm] counter=194 i=0 t=4.0e-04 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=1 t=3.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=2 t=3.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=3 t=3.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=4 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=194 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.9e+07
 sigma_tot[gemm] counter=194 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.7e+07
 sigma_tot[gemm] counter=194 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=194 total t=4.4e+00 per=5.1e+01 cost=1.2e+08 flops=2.8e+07
 sigma_tot[red] counter=194 t=2.2e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,1.3e-05,4.1e-06,1.5e-06,3.5e-07
settings: ndim=66 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336851548809 -1.116e+03  2.723e-03    1     1  3.722e-01 3.722e-01 3.721e-01
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.279e-03,9.846e-03,2.969e-02,1.295e-02,5.479e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=2.271e-03 speed=4.331e-04GB/S T(nccl)=7.958e-06 speed=1.236e-01GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=195 t=9.8e-03 per=1.9e+01 cost=3.0e+05 flops=3.1e+07
 sigma[gemm] counter=195 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=2 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=3 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=4 t=7.4e-03 per=1.4e+01 cost=3.5e+04 flops=4.8e+06
 sigma[gemm] counter=195 i=5 t=7.5e-03 per=1.4e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=195 i=6 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=195 i=7 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=195 total t=3.0e-02 per=5.7e+01 cost=1.2e+05 flops=3.9e+06
 sigma[red] counter=195 t=1.3e-02 per=2.5e+01 cost=4.2e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=2.1e+00 t_gemm=4.5e+00 t_reduction=2.2e+00 tot=8.8e+00 -----
 sigma_tot[inter] counter=195 t=2.1e+00 per=2.4e+01 cost=1.7e+08 flops=8.2e+07
 sigma_tot[gemm] counter=195 i=0 t=4.0e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=1 t=3.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=2 t=3.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=3 t=3.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=195 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.9e+07
 sigma_tot[gemm] counter=195 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.7e+07
 sigma_tot[gemm] counter=195 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=195 total t=4.5e+00 per=5.1e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=195 t=2.2e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=9.7e-06,4.0e-05,4.1e-06,1.8e-06,2.5e-07
    2   0 -    -116.336863539288 -1.199e-05  5.361e-04    2     2  4.397e-01 2.198e-01 2.135e-01
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.759e-03,9.983e-03,3.012e-02,1.292e-02,5.480e-02
 analyze_tgpu[Hx]: ndim=66:4.917e-07GB T(cpu-gpu)=1.753e-03 speed=5.610e-04GB/S T(nccl)=6.222e-06 speed=1.581e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=196 t=1.0e-02 per=1.9e+01 cost=3.0e+05 flops=3.0e+07
 sigma[gemm] counter=196 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=3 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=4 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.7e+06
 sigma[gemm] counter=196 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=196 i=6 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=196 i=7 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=196 total t=3.0e-02 per=5.7e+01 cost=1.2e+05 flops=3.9e+06
 sigma[red] counter=196 t=1.3e-02 per=2.4e+01 cost=4.2e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=2.1e+00 t_gemm=4.5e+00 t_reduction=2.2e+00 tot=8.8e+00 -----
 sigma_tot[inter] counter=196 t=2.1e+00 per=2.4e+01 cost=1.7e+08 flops=8.1e+07
 sigma_tot[gemm] counter=196 i=0 t=4.0e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=1 t=3.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=2 t=3.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=3 t=3.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=196 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.8e+07
 sigma_tot[gemm] counter=196 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.7e+07
 sigma_tot[gemm] counter=196 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=196 total t=4.5e+00 per=5.1e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=196 t=2.2e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,2.1e-05,1.3e-05,1.1e-06,2.1e-07
    3   0 +    -116.336863937705 -3.984e-07  8.443e-05    3     3  5.077e-01 1.692e-01 1.607e-01
TIMING FOR Davidson : 5.078e-01  T(cal/comm/rest)=4.820e-01,5.520e-07,2.577e-02
decomposed t_rest=2.577e-02
 T(sub)    =1.231e-04 per=4.777e-01
 T(precond)=2.555e-02 per=9.915e+01
 T(ortho)  =1.654e-05 per=6.419e-02
 T(xcopy)  =4.830e-07 per=1.874e-03
 T(xnrm2)  =1.194e-05 per=4.633e-02
 T(other)  =6.770e-05 per=2.627e-01
optimized energies: isweep=0 ibond=31 dots=2 e[0]=-116.336863937705 nmvp=3
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=11 dimAll=40
 (22,2):4 (23,3):6 (23,1):6 (21,1):1 (24,2):9 (25,3):4 (25,1):3 (26,2):1 (24,4):3 (24,0):2 (22,0):1
timing for divide=6.6e-05
timing for compute=1.2e-02
timing for collect=4.7e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.6e-05,1.2e-02,0.0e+00,6.1e-06,4.7e-05 -----
decimation summary: 40->10 dwt=+2.094e-06 SvN=6.273e-01
 qbond: qkept nsym=6 dimAll=10
 (23,1):3 (24,2):3 (25,3):1 (25,1):1 (26,2):1 (24,0):1
----- TIMING for decimation_row(nkr): 1.246e-02 S T(decim/select/formRot)=1.189e-02,3.987e-04,1.662e-04 -----
----- TIMING FOR twodot_decimation: 1.339e-02 S T(wf/decim)=7.042e-04,1.269e-02 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=1072:8.179e-03MB:7.987e-06GB
        per(mem): H:2.05 C:31.3 S:7.84 P:11.2 Q:47.6 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=0.000e+00 change=1.615e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 3.710e-03 S -----
rank=0 GPUmem(GB): used=4.648e-05 (oper)=2.689e-05
rank=0 GPUmem(GB): used=4.689e-05 (oper,site)=2.689e-05,4.098e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=68
 no. of coefficients=1020:7.782e-03MB:7.600e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.482e-03 S -----
rank=0 GPUmem(GB): used=5.449e-05 (oper,site,rinter)=2.689e-05,4.098e-07,7.600e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.870e-02 S size(rtasks)=57 size(Rlst2)=36 T(Rmu/Rlist)=8.151e-04,3.788e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.924e-02 S size(rtasks)=57 size(Rlst)=2006 -----
rank=0 GPUmem(GB): used=5.449e-05 avail=6.176e+00 total=6.176e+00 batch[need]=4.185e-04 blksize=9 blksize0=9 batchsize=2006
rank=0 GPUmem(GB): used=4.730e-04 (oper,site,rinter,batch)=2.689e-05,4.098e-07,7.600e-06,4.185e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.686e-03,2.221e-02,1.015e-02
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=32 t=6.7e-03 per=1.7e+01 cost=6.9e+04 flops=1.0e+07
 renorm[gemm] counter=32 i=0 t=2.7e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=1 t=1.5e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=2 t=7.0e-03 per=1.8e+01 cost=9.5e+03 flops=1.4e+06
 renorm[gemm] counter=32 i=3 t=7.6e-03 per=1.9e+01 cost=2.3e+04 flops=3.0e+06
 renorm[gemm] counter=32 i=4 t=1.6e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=5 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=6 t=7.7e-03 per=2.0e+01 cost=4.4e+04 flops=5.8e+06
 renorm[gemm] counter=32 total t=2.2e-02 per=5.7e+01 cost=7.6e+04 flops=3.4e+06
 renorm[red] counter=32 t=1.0e-02 per=2.6e+01 cost=2.0e+04 flops=2.0e+06
----- TIMING FOR renorm_tot : t_inter=1.8e-01 t_gemm=6.7e-01 t_reduction=3.0e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=32 t=1.8e-01 per=1.6e+01 cost=3.2e+06 flops=1.8e+07
 renorm_tot[gemm] counter=32 i=0 t=5.2e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=1 t=4.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=2 t=9.4e-02 per=8.2e+00 cost=2.1e+05 flops=2.2e+06
 renorm_tot[gemm] counter=32 i=3 t=1.0e-01 per=8.8e+00 cost=5.7e+05 flops=5.7e+06
 renorm_tot[gemm] counter=32 i=4 t=1.3e-01 per=1.1e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=32 i=5 t=1.3e-01 per=1.1e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=32 i=6 t=2.2e-01 per=2.0e+01 cost=1.9e+06 flops=8.6e+06
 renorm_tot[gemm] counter=32 total t=6.7e-01 per=5.9e+01 cost=3.5e+06 flops=5.1e+06
 renorm_tot[red] counter=32 t=3.0e-01 per=2.6e+01 cost=8.5e+05 flops=2.9e+06
qops.to_cpu: size(tot)=1072:8.2e-03MB:8.0e-06GB T(to_cpu)=1.6e-04S speed=4.9e-02GB/S
check ||H-H.dagger||=1.690e-14 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.108 S rank=0 -----
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=1.595e-03 change=5.977e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.029e-03 change=-1.579e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.029e-03 change=-4.604e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 9.509e-01 S #####
 T(local opt: fetch) = 9.477e-03 S  per = 0.997  per(accum) = 0.997
 T(local opt: hdiag) = 1.139e-02 S  per =  1.2  per(accum) = 2.19
 T(local opt: dvdsn) = 8.029e-01 S  per = 84.4  per(accum) = 86.6
 T(local opt: decim) = 1.343e-02 S  per = 1.41  per(accum) = 88
 T(local opt: guess) = 1.482e-03 S  per = 0.156  per(accum) = 88.2
 T(local opt: renrm) = 1.119e-01 S  per = 11.8  per(accum) = 100
 T(local opt: save ) = 3.345e-04 S  per = 0.0352  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.029e-01 S  T(sum) = 8.023e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 3.322e-03 S  per = 0.414  per(accum) = 0.414
 T(local opt: symbolic_formulae           ) = 3.709e-03 S  per = 0.462  per(accum) = 0.876
 T(local opt: hintermediate init          ) = 1.953e-03 S  per = 0.243  per(accum) = 1.12
 T(local opt: preprocess_hformulae_Hxlist ) = 1.171e-01 S  per = 14.6  per(accum) = 15.7
 T(local opt: hmmtasks init               ) = 1.674e-01 S  per = 20.9  per(accum) = 36.6
 T(local opt: initial guess for dvdson    ) = 1.086e-03 S  per = 0.135  per(accum) = 36.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.778e-01 S  per = 59.5  per(accum) = 96.3
 T(local opt: dvdson [cpu-gpu]            ) = 4.200e-03 S  per = 0.524  per(accum) = 96.8
 T(local opt: dvdson [nccl]               ) = 2.502e-05 S  per = 0.00312  per(accum) = 96.8
 T(local opt: dvdson [mpi]                ) = 5.520e-07 S  per = 6.88e-05  per(accum) = 96.8
 T(local opt: dvdson [rest part(linalg)]  ) = 2.577e-02 S  per = 3.21  per(accum) = 100
Detailed decomposition of T(renrm) = 1.119e-01 S  T(sum) = 1.119e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.369e-04 S  per = 0.48  per(accum) = 0.48
 T(local opt: qops init                    ) = 4.723e-03 S  per = 4.22  per(accum) = 4.7
 T(local opt: symbolic_formulae_renorm     ) = 3.725e-03 S  per = 3.33  per(accum) = 8.03
 T(local opt: allocate qops on gpu         ) = 7.817e-05 S  per = 0.0698  per(accum) = 8.1
 T(local opt: site memcpy cpu2gpu          ) = 8.100e-04 S  per = 0.724  per(accum) = 8.82
 T(local opt: rintermediate init           ) = 2.498e-03 S  per = 2.23  per(accum) = 11.1
 T(local opt: preprocess_formulae_Rlist2   ) = 3.934e-02 S  per = 35.1  per(accum) = 46.2
 T(local opt: rmmtasks init                ) = 1.719e-02 S  per = 15.4  per(accum) = 61.6
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 3.75e-05  per(accum) = 61.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.915e-02 S  per =   35  per(accum) = 96.5
 T(local opt: deallocate cpu and gpu memory) = 4.763e-04 S  per = 0.426  per(accum) = 97
 T(local opt: construct opS [ifdists=true] ) = 5.100e-08 S  per = 4.56e-05  per(accum) = 97
 T(local opt: reduction of opS & opH [nccl]) = 4.600e-08 S  per = 4.11e-05  per(accum) = 97
 T(local opt: qops memcpy gpu2cpu          ) = 1.756e-04 S  per = 0.157  per(accum) = 97.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.040e-04 S  per = 0.0929  per(accum) = 97.2
 T(local opt: qops_pool join and erase     ) = 3.098e-03 S  per = 2.77  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.490e-05 S  per = 0.0133  per(accum) = 100
##### sweep opt: 4.302e+01 S #####
 T(sweep opt: fetch) = 4.496e-01 S  per = 1.05  per(accum) = 1.05
 T(sweep opt: hdiag) = 1.525e+01 S  per = 35.5  per(accum) = 36.5
 T(sweep opt: dvdsn) = 2.363e+01 S  per = 54.9  per(accum) = 91.4
 T(sweep opt: decim) = 4.365e-01 S  per = 1.01  per(accum) = 92.4
 T(sweep opt: guess) = 3.946e-02 S  per = 0.0917  per(accum) = 92.5
 T(sweep opt: renrm) = 3.202e+00 S  per = 7.44  per(accum) = 100
 T(sweep opt: save ) = 1.042e-02 S  per = 0.0242  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.363e+01 S  T(sum) = 2.356e+01 S  per = 9.972e+01
 T(sweep opt: preprocess                  ) = 1.712e-01 S  per = 0.727  per(accum) = 0.727
 T(sweep opt: symbolic_formulae           ) = 2.482e-01 S  per = 1.05  per(accum) = 1.78
 T(sweep opt: hintermediate init          ) = 1.263e-02 S  per = 0.0536  per(accum) = 1.83
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.050e+00 S  per = 34.2  per(accum) = 36
 T(sweep opt: hmmtasks init               ) = 3.906e+00 S  per = 16.6  per(accum) = 52.6
 T(sweep opt: initial guess for dvdson    ) = 4.697e-02 S  per = 0.199  per(accum) = 52.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 8.850e+00 S  per = 37.6  per(accum) = 90.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.540e-01 S  per = 1.08  per(accum) = 91.4
 T(sweep opt: dvdson [nccl]               ) = 1.414e-03 S  per = 0.006  per(accum) = 91.4
 T(sweep opt: dvdson [mpi]                ) = 3.330e-05 S  per = 0.000141  per(accum) = 91.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.023e+00 S  per = 8.58  per(accum) = 100
Detailed decomposition of T(renrm) = 3.202e+00 S  T(sum) = 3.202e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.032e-02 S  per = 0.322  per(accum) = 0.322
 T(sweep opt: qops init                    ) = 1.215e-01 S  per =  3.8  per(accum) = 4.12
 T(sweep opt: symbolic_formulae_renorm     ) = 1.298e-01 S  per = 4.05  per(accum) = 8.17
 T(sweep opt: allocate qops on gpu         ) = 2.150e-02 S  per = 0.671  per(accum) = 8.84
 T(sweep opt: site memcpy cpu2gpu          ) = 4.196e-02 S  per = 1.31  per(accum) = 10.2
 T(sweep opt: rintermediate init           ) = 8.267e-02 S  per = 2.58  per(accum) = 12.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.763e-01 S  per = 30.5  per(accum) = 43.2
 T(sweep opt: rmmtasks init                ) = 4.917e-01 S  per = 15.4  per(accum) = 58.6
 T(sweep opt: qops memset on cpu           ) = 1.296e-06 S  per = 4.05e-05  per(accum) = 58.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.153e+00 S  per =   36  per(accum) = 94.6
 T(sweep opt: deallocate cpu and gpu memory) = 4.178e-03 S  per = 0.13  per(accum) = 94.7
 T(sweep opt: construct opS [ifdists=true] ) = 1.675e-06 S  per = 5.23e-05  per(accum) = 94.7
 T(sweep opt: reduction of opS & opH [nccl]) = 1.287e-06 S  per = 4.02e-05  per(accum) = 94.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.968e-03 S  per = 0.124  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.733e-03 S  per = 0.0541  per(accum) = 94.9
 T(sweep opt: qops_pool join and erase     ) = 1.017e-01 S  per = 3.18  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 6.210e-02 S  per = 1.94  per(accum) = 100
##### global opt: 4.302e+01 S #####
 T(global opt: fetch) = 4.496e-01 S  per = 1.05  per(accum) = 1.05
 T(global opt: hdiag) = 1.525e+01 S  per = 35.5  per(accum) = 36.5
 T(global opt: dvdsn) = 2.363e+01 S  per = 54.9  per(accum) = 91.4
 T(global opt: decim) = 4.365e-01 S  per = 1.01  per(accum) = 92.4
 T(global opt: guess) = 3.946e-02 S  per = 0.0917  per(accum) = 92.5
 T(global opt: renrm) = 3.202e+00 S  per = 7.44  per(accum) = 100
 T(global opt: save ) = 1.042e-02 S  per = 0.0242  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.363e+01 S  T(sum) = 2.356e+01 S  per = 9.972e+01
 T(global opt: preprocess                  ) = 1.712e-01 S  per = 0.727  per(accum) = 0.727
 T(global opt: symbolic_formulae           ) = 2.482e-01 S  per = 1.05  per(accum) = 1.78
 T(global opt: hintermediate init          ) = 1.263e-02 S  per = 0.0536  per(accum) = 1.83
 T(global opt: preprocess_hformulae_Hxlist ) = 8.050e+00 S  per = 34.2  per(accum) = 36
 T(global opt: hmmtasks init               ) = 3.906e+00 S  per = 16.6  per(accum) = 52.6
 T(global opt: initial guess for dvdson    ) = 4.697e-02 S  per = 0.199  per(accum) = 52.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 8.850e+00 S  per = 37.6  per(accum) = 90.3
 T(global opt: dvdson [cpu-gpu]            ) = 2.540e-01 S  per = 1.08  per(accum) = 91.4
 T(global opt: dvdson [nccl]               ) = 1.414e-03 S  per = 0.006  per(accum) = 91.4
 T(global opt: dvdson [mpi]                ) = 3.330e-05 S  per = 0.000141  per(accum) = 91.4
 T(global opt: dvdson [rest part(linalg)]  ) = 2.023e+00 S  per = 8.58  per(accum) = 100
Detailed decomposition of T(renrm) = 3.202e+00 S  T(sum) = 3.202e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.032e-02 S  per = 0.322  per(accum) = 0.322
 T(global opt: qops init                    ) = 1.215e-01 S  per =  3.8  per(accum) = 4.12
 T(global opt: symbolic_formulae_renorm     ) = 1.298e-01 S  per = 4.05  per(accum) = 8.17
 T(global opt: allocate qops on gpu         ) = 2.150e-02 S  per = 0.671  per(accum) = 8.84
 T(global opt: site memcpy cpu2gpu          ) = 4.196e-02 S  per = 1.31  per(accum) = 10.2
 T(global opt: rintermediate init           ) = 8.267e-02 S  per = 2.58  per(accum) = 12.7
 T(global opt: preprocess_formulae_Rlist2   ) = 9.763e-01 S  per = 30.5  per(accum) = 43.2
 T(global opt: rmmtasks init                ) = 4.917e-01 S  per = 15.4  per(accum) = 58.6
 T(global opt: qops memset on cpu           ) = 1.296e-06 S  per = 4.05e-05  per(accum) = 58.6
 T(global opt: preprocess_renorm_batchGPU   ) = 1.153e+00 S  per =   36  per(accum) = 94.6
 T(global opt: deallocate cpu and gpu memory) = 4.178e-03 S  per = 0.13  per(accum) = 94.7
 T(global opt: construct opS [ifdists=true] ) = 1.675e-06 S  per = 5.23e-05  per(accum) = 94.7
 T(global opt: reduction of opS & opH [nccl]) = 1.287e-06 S  per = 4.02e-05  per(accum) = 94.7
 T(global opt: qops memcpy gpu2cpu          ) = 3.968e-03 S  per = 0.124  per(accum) = 94.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.733e-03 S  per = 0.0541  per(accum) = 94.9
 T(global opt: qops_pool join and erase     ) = 1.017e-01 S  per = 3.18  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 6.210e-02 S  per = 1.94  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.863e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=32/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=798:6.088e-03MB:5.946e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=825:6.294e-03MB:6.147e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:2 S:18 A:4 B:6 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=31:2.365e-04MB:2.310e-07GB
        per(mem): H:6.45 C:6.45 S:58.1 A:0 B:29 
 rqops: oplist=HCSPQ nops=H:1 C:16 S:4 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=29:0.000221MB size(tot)=1072:0.00818MB:7.99e-06GB
        per(mem): H:2.05 C:31.3 S:7.84 P:11.2 Q:47.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3099:0.0236MB:2.31e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.189e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.788e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,10,3,3) nnz=32:2.441e-04MB
qtensor4: wf4 own=1 _data=0x3a38a000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=6 dimAll=10
 (23,1):3 (24,2):3 (25,3):1 (25,1):1 (26,2):1 (24,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=20 nblocks=161 size=32:2.441e-04MB
### DIAG TIMING: total=1.134e-01 t1=2.844e-05, t2=1.726e-03, t3=2.515e-03, t4=1.091e-01, t5=3.998e-06, t6=1.797e-05, t7=3.790e-06
duration_diagGPU:1.135e-01
duration_diagreduce:6.400e-08
duration_diagtransform:3.350e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 2.657e-03 S -----
rank=0 GPUmem(GB): used=2.309e-05 (oper)=2.309e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=195
 no. of hintermediate operators=73
 no. of coefficients=996:7.599e-03MB:7.421e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.061e-04 S -----
rank=0 GPUmem(GB): used=3.051e-05 (oper,hinter)=2.309e-05,7.421e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.668e-02 S size(H_formulae)=195 size(Hxlst2)=20 T(Hmu/Hxlist)=4.933e-04,6.619e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.744e-02 S size(H_formulae)=195 size(Hxlst)=4048 -----
rank=0 GPUmem(GB): used=3.051e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.768e-07 batch[need]=4.826e-04 blksize=3 blksize0=9 batchsize=4048
rank=0 GPUmem(GB): used=5.135e-04 (oper,hinter,dvdson,batch)=2.309e-05,7.421e-06,4.768e-07,4.826e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=32 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.316e-04,9.856e-03,2.996e-02,1.300e-02,5.345e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=6.182e-04 speed=7.713e-04GB/S T(nccl)=1.340e-05 speed=3.560e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=197 t=9.9e-03 per=1.9e+01 cost=9.6e+04 flops=9.8e+06
 sigma[gemm] counter=197 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=2 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=3 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=4 t=7.5e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=197 i=5 t=7.6e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=197 i=6 t=7.4e-03 per=1.4e+01 cost=3.8e+03 flops=5.1e+05
 sigma[gemm] counter=197 i=7 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=197 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=197 t=1.3e-02 per=2.5e+01 cost=1.3e+04 flops=1.0e+06
----- TIMING FOR sigma_tot : t_inter=2.1e+00 t_gemm=4.5e+00 t_reduction=2.2e+00 tot=8.9e+00 -----
 sigma_tot[inter] counter=197 t=2.1e+00 per=2.4e+01 cost=1.7e+08 flops=8.1e+07
 sigma_tot[gemm] counter=197 i=0 t=4.0e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=1 t=3.4e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=2 t=3.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=3 t=3.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=197 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.8e+07
 sigma_tot[gemm] counter=197 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.6e+07
 sigma_tot[gemm] counter=197 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=197 total t=4.5e+00 per=5.1e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=197 t=2.2e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,6.5e-06,2.0e-06,8.2e-07,2.1e-07
settings: ndim=32 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336862474661 -1.116e+03  1.798e-03    1     1  5.358e-02 5.358e-02 5.355e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.043e-03,9.861e-03,2.968e-02,1.290e-02,5.450e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.037e-03 speed=2.341e-04GB/S T(nccl)=6.121e-06 speed=7.790e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=198 t=9.9e-03 per=1.9e+01 cost=9.6e+04 flops=9.8e+06
 sigma[gemm] counter=198 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=2 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=4 t=7.4e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=198 i=5 t=7.4e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=198 i=6 t=7.5e-03 per=1.4e+01 cost=3.8e+03 flops=5.1e+05
 sigma[gemm] counter=198 i=7 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=198 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=198 t=1.3e-02 per=2.5e+01 cost=1.3e+04 flops=1.0e+06
----- TIMING FOR sigma_tot : t_inter=2.1e+00 t_gemm=4.5e+00 t_reduction=2.3e+00 tot=8.9e+00 -----
 sigma_tot[inter] counter=198 t=2.1e+00 per=2.4e+01 cost=1.7e+08 flops=8.1e+07
 sigma_tot[gemm] counter=198 i=0 t=4.0e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=1 t=3.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=2 t=3.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=3 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=198 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.8e+07
 sigma_tot[gemm] counter=198 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.6e+07
 sigma_tot[gemm] counter=198 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=198 total t=4.5e+00 per=5.1e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=198 t=2.3e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,3.6e-05,3.5e-06,8.8e-07,2.0e-07
    2   0 -    -116.336865861083 -3.386e-06  1.724e-04    2     2  1.211e-01 6.056e-02 5.408e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.575e-04,1.014e-02,3.012e-02,1.278e-02,5.361e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=5.511e-04 speed=8.652e-04GB/S T(nccl)=6.317e-06 speed=7.548e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=199 t=1.0e-02 per=1.9e+01 cost=9.6e+04 flops=9.5e+06
 sigma[gemm] counter=199 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=4 t=7.6e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=199 i=5 t=7.4e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=199 i=6 t=7.6e-03 per=1.4e+01 cost=3.8e+03 flops=5.0e+05
 sigma[gemm] counter=199 i=7 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=199 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.0e+05
 sigma[red] counter=199 t=1.3e-02 per=2.4e+01 cost=1.3e+04 flops=1.0e+06
----- TIMING FOR sigma_tot : t_inter=2.1e+00 t_gemm=4.6e+00 t_reduction=2.3e+00 tot=9.0e+00 -----
 sigma_tot[inter] counter=199 t=2.1e+00 per=2.4e+01 cost=1.7e+08 flops=8.0e+07
 sigma_tot[gemm] counter=199 i=0 t=4.0e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=1 t=3.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=2 t=3.1e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=3 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=199 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.8e+07
 sigma_tot[gemm] counter=199 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.6e+07
 sigma_tot[gemm] counter=199 i=7 t=1.1e+00 per=1.3e+01 cost=3.0e+07 flops=2.6e+07
 sigma_tot[gemm] counter=199 total t=4.6e+00 per=5.1e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=199 t=2.3e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,2.3e-05,1.3e-05,1.0e-06,1.9e-07
    3   0 +    -116.336865909158 -4.807e-08  1.931e-05    3     3  1.872e-01 6.238e-02 5.396e-02
TIMING FOR Davidson : 1.872e-01  T(cal/comm/rest)=1.619e-01,4.340e-07,2.528e-02
decomposed t_rest=2.528e-02
 T(sub)    =1.068e-04 per=4.225e-01
 T(precond)=2.509e-02 per=9.924e+01
 T(ortho)  =1.491e-05 per=5.899e-02
 T(xcopy)  =4.530e-07 per=1.792e-03
 T(xnrm2)  =1.152e-06 per=4.557e-03
 T(other)  =6.931e-05 per=2.742e-01
optimized energies: isweep=0 ibond=32 dots=2 e[0]=-116.336865909158 nmvp=3
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=1.141e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=11 dimAll=39
 (23,1):3 (24,2):6 (25,3):4 (25,1):8 (26,2):6 (24,0):4 (27,3):2 (27,1):2 (28,2):1 (26,0):2 (26,4):1
timing for divide=4.6e-05
timing for compute=1.2e-02
timing for collect=2.2e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=4.6e-05,1.2e-02,0.0e+00,4.8e-06,2.2e-05 -----
decimation summary: 39->7 dwt=+0.000e+00 SvN=6.828e-01
 qbond: qkept nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
----- TIMING for decimation_row(nkr): 1.279e-02 S T(decim/select/formRot)=1.248e-02,2.193e-04,9.252e-05 -----
----- TIMING FOR twodot_decimation: 1.339e-02 S T(wf/decim)=4.804e-04,1.291e-02 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=7,7 size(op)=11:8.392e-05MB size(tot)=390:2.975e-03MB:2.906e-06GB
        per(mem): H:2.82 C:47.9 S:8.46 P:8.46 Q:32.3 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=9.415e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=42 : 2.791e-03 S -----
rank=0 GPUmem(GB): used=3.318e-05 (oper)=1.833e-05
rank=0 GPUmem(GB): used=3.342e-05 (oper,site)=1.833e-05,2.384e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=42
 no. of rintermediate operators=42
 no. of coefficients=672:5.127e-03MB:5.007e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.520e-03 S -----
rank=0 GPUmem(GB): used=3.843e-05 (oper,site,rinter)=1.833e-05,2.384e-07,5.007e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.056e-02 S size(rtasks)=42 size(Rlst2)=25 T(Rmu/Rlist)=4.168e-04,2.014e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.089e-02 S size(rtasks)=42 size(Rlst)=1671 -----
rank=0 GPUmem(GB): used=3.843e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.739e-04 blksize=6 blksize0=9 batchsize=1671
rank=0 GPUmem(GB): used=3.123e-04 (oper,site,rinter,batch)=1.833e-05,2.384e-07,5.007e-06,2.739e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.140e-03,2.259e-02,1.008e-02
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=33 t=6.1e-03 per=1.6e+01 cost=3.3e+04 flops=5.4e+06
 renorm[gemm] counter=33 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=2 t=7.5e-03 per=1.9e+01 cost=3.9e+03 flops=5.3e+05
 renorm[gemm] counter=33 i=3 t=7.6e-03 per=1.9e+01 cost=8.6e+03 flops=1.1e+06
 renorm[gemm] counter=33 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=6 t=7.5e-03 per=1.9e+01 cost=1.3e+04 flops=1.7e+06
 renorm[gemm] counter=33 total t=2.3e-02 per=5.8e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=33 t=1.0e-02 per=2.6e+01 cost=7.5e+03 flops=7.4e+05
----- TIMING FOR renorm_tot : t_inter=1.8e-01 t_gemm=7.0e-01 t_reduction=3.1e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=33 t=1.8e-01 per=1.6e+01 cost=3.2e+06 flops=1.7e+07
 renorm_tot[gemm] counter=33 i=0 t=5.3e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=1 t=4.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=2 t=1.0e-01 per=8.6e+00 cost=2.1e+05 flops=2.1e+06
 renorm_tot[gemm] counter=33 i=3 t=1.1e-01 per=9.1e+00 cost=5.8e+05 flops=5.4e+06
 renorm_tot[gemm] counter=33 i=4 t=1.3e-01 per=1.1e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=33 i=5 t=1.3e-01 per=1.1e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=33 i=6 t=2.3e-01 per=2.0e+01 cost=2.0e+06 flops=8.4e+06
 renorm_tot[gemm] counter=33 total t=7.0e-01 per=5.9e+01 cost=3.5e+06 flops=5.0e+06
 renorm_tot[red] counter=33 t=3.1e-01 per=2.6e+01 cost=8.5e+05 flops=2.8e+06
qops.to_cpu: size(tot)=390:3.0e-03MB:2.9e-06GB T(to_cpu)=5.9e-05S speed=4.9e-02GB/S
check ||H-H.dagger||=1.570e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0791 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=4.822e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.441e-03 change=-1.443e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.441e-03 change=-3.770e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.078e-01 S #####
 T(local opt: fetch) = 1.129e-02 S  per = 2.22  per(accum) = 2.22
 T(local opt: hdiag) = 1.139e-01 S  per = 22.4  per(accum) = 24.7
 T(local opt: dvdsn) = 2.862e-01 S  per = 56.4  per(accum) = 81
 T(local opt: decim) = 1.340e-02 S  per = 2.64  per(accum) = 83.7
 T(local opt: guess) = 8.489e-04 S  per = 0.167  per(accum) = 83.8
 T(local opt: renrm) = 8.185e-02 S  per = 16.1  per(accum) = 100
 T(local opt: save ) = 2.405e-04 S  per = 0.0474  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.862e-01 S  T(sum) = 2.859e-01 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 2.539e-03 S  per = 0.888  per(accum) = 0.888
 T(local opt: symbolic_formulae           ) = 2.669e-03 S  per = 0.934  per(accum) = 1.82
 T(local opt: hintermediate init          ) = 1.248e-04 S  per = 0.0436  per(accum) = 1.87
 T(local opt: preprocess_hformulae_Hxlist ) = 6.760e-02 S  per = 23.6  per(accum) = 25.5
 T(local opt: hmmtasks init               ) = 2.492e-02 S  per = 8.71  per(accum) = 34.2
 T(local opt: initial guess for dvdson    ) = 9.077e-04 S  per = 0.317  per(accum) = 34.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.586e-01 S  per = 55.5  per(accum) = 90
 T(local opt: dvdson [cpu-gpu]            ) = 3.206e-03 S  per = 1.12  per(accum) = 91.1
 T(local opt: dvdson [nccl]               ) = 2.583e-05 S  per = 0.00904  per(accum) = 91.2
 T(local opt: dvdson [mpi]                ) = 4.340e-07 S  per = 0.000152  per(accum) = 91.2
 T(local opt: dvdson [rest part(linalg)]  ) = 2.528e-02 S  per = 8.84  per(accum) = 100
Detailed decomposition of T(renrm) = 8.185e-02 S  T(sum) = 8.185e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.858e-04 S  per = 0.471  per(accum) = 0.471
 T(local opt: qops init                    ) = 1.625e-03 S  per = 1.98  per(accum) = 2.46
 T(local opt: symbolic_formulae_renorm     ) = 2.806e-03 S  per = 3.43  per(accum) = 5.88
 T(local opt: allocate qops on gpu         ) = 6.047e-05 S  per = 0.0739  per(accum) = 5.96
 T(local opt: site memcpy cpu2gpu          ) = 1.824e-03 S  per = 2.23  per(accum) = 8.19
 T(local opt: rintermediate init           ) = 2.532e-03 S  per = 3.09  per(accum) = 11.3
 T(local opt: preprocess_formulae_Rlist2   ) = 2.095e-02 S  per = 25.6  per(accum) = 36.9
 T(local opt: rmmtasks init                ) = 1.022e-02 S  per = 12.5  per(accum) = 49.4
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 5.13e-05  per(accum) = 49.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.891e-02 S  per = 47.5  per(accum) = 96.9
 T(local opt: deallocate cpu and gpu memory) = 7.552e-05 S  per = 0.0923  per(accum) = 97
 T(local opt: construct opS [ifdists=true] ) = 4.400e-08 S  per = 5.38e-05  per(accum) = 97
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 4.76e-05  per(accum) = 97
 T(local opt: qops memcpy gpu2cpu          ) = 6.650e-05 S  per = 0.0812  per(accum) = 97.1
 T(local opt: reduction of opS & opH [mpi] ) = 5.397e-05 S  per = 0.0659  per(accum) = 97.1
 T(local opt: qops_pool join and erase     ) = 2.331e-03 S  per = 2.85  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.004e-05 S  per = 0.0123  per(accum) = 100
##### sweep opt: 4.353e+01 S #####
 T(sweep opt: fetch) = 4.609e-01 S  per = 1.06  per(accum) = 1.06
 T(sweep opt: hdiag) = 1.537e+01 S  per = 35.3  per(accum) = 36.4
 T(sweep opt: dvdsn) = 2.392e+01 S  per = 54.9  per(accum) = 91.3
 T(sweep opt: decim) = 4.499e-01 S  per = 1.03  per(accum) = 92.3
 T(sweep opt: guess) = 4.031e-02 S  per = 0.0926  per(accum) = 92.4
 T(sweep opt: renrm) = 3.284e+00 S  per = 7.54  per(accum) = 100
 T(sweep opt: save ) = 1.066e-02 S  per = 0.0245  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.392e+01 S  T(sum) = 2.385e+01 S  per = 9.972e+01
 T(sweep opt: preprocess                  ) = 1.738e-01 S  per = 0.729  per(accum) = 0.729
 T(sweep opt: symbolic_formulae           ) = 2.509e-01 S  per = 1.05  per(accum) = 1.78
 T(sweep opt: hintermediate init          ) = 1.276e-02 S  per = 0.0535  per(accum) = 1.83
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.118e+00 S  per =   34  per(accum) = 35.9
 T(sweep opt: hmmtasks init               ) = 3.931e+00 S  per = 16.5  per(accum) = 52.4
 T(sweep opt: initial guess for dvdson    ) = 4.788e-02 S  per = 0.201  per(accum) = 52.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 9.009e+00 S  per = 37.8  per(accum) = 90.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.572e-01 S  per = 1.08  per(accum) = 91.4
 T(sweep opt: dvdson [nccl]               ) = 1.440e-03 S  per = 0.00604  per(accum) = 91.4
 T(sweep opt: dvdson [mpi]                ) = 3.373e-05 S  per = 0.000141  per(accum) = 91.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.048e+00 S  per = 8.59  per(accum) = 100
Detailed decomposition of T(renrm) = 3.284e+00 S  T(sum) = 3.284e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.070e-02 S  per = 0.326  per(accum) = 0.326
 T(sweep opt: qops init                    ) = 1.232e-01 S  per = 3.75  per(accum) = 4.08
 T(sweep opt: symbolic_formulae_renorm     ) = 1.326e-01 S  per = 4.04  per(accum) = 8.12
 T(sweep opt: allocate qops on gpu         ) = 2.156e-02 S  per = 0.657  per(accum) = 8.77
 T(sweep opt: site memcpy cpu2gpu          ) = 4.379e-02 S  per = 1.33  per(accum) = 10.1
 T(sweep opt: rintermediate init           ) = 8.520e-02 S  per = 2.59  per(accum) = 12.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.973e-01 S  per = 30.4  per(accum) = 43.1
 T(sweep opt: rmmtasks init                ) = 5.019e-01 S  per = 15.3  per(accum) = 58.4
 T(sweep opt: qops memset on cpu           ) = 1.338e-06 S  per = 4.07e-05  per(accum) = 58.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.191e+00 S  per = 36.3  per(accum) = 94.6
 T(sweep opt: deallocate cpu and gpu memory) = 4.254e-03 S  per = 0.13  per(accum) = 94.8
 T(sweep opt: construct opS [ifdists=true] ) = 1.719e-06 S  per = 5.23e-05  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.326e-06 S  per = 4.04e-05  per(accum) = 94.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.035e-03 S  per = 0.123  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.787e-03 S  per = 0.0544  per(accum) = 94.9
 T(sweep opt: qops_pool join and erase     ) = 1.041e-01 S  per = 3.17  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 6.211e-02 S  per = 1.89  per(accum) = 100
##### global opt: 4.353e+01 S #####
 T(global opt: fetch) = 4.609e-01 S  per = 1.06  per(accum) = 1.06
 T(global opt: hdiag) = 1.537e+01 S  per = 35.3  per(accum) = 36.4
 T(global opt: dvdsn) = 2.392e+01 S  per = 54.9  per(accum) = 91.3
 T(global opt: decim) = 4.499e-01 S  per = 1.03  per(accum) = 92.3
 T(global opt: guess) = 4.031e-02 S  per = 0.0926  per(accum) = 92.4
 T(global opt: renrm) = 3.284e+00 S  per = 7.54  per(accum) = 100
 T(global opt: save ) = 1.066e-02 S  per = 0.0245  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.392e+01 S  T(sum) = 2.385e+01 S  per = 9.972e+01
 T(global opt: preprocess                  ) = 1.738e-01 S  per = 0.729  per(accum) = 0.729
 T(global opt: symbolic_formulae           ) = 2.509e-01 S  per = 1.05  per(accum) = 1.78
 T(global opt: hintermediate init          ) = 1.276e-02 S  per = 0.0535  per(accum) = 1.83
 T(global opt: preprocess_hformulae_Hxlist ) = 8.118e+00 S  per =   34  per(accum) = 35.9
 T(global opt: hmmtasks init               ) = 3.931e+00 S  per = 16.5  per(accum) = 52.4
 T(global opt: initial guess for dvdson    ) = 4.788e-02 S  per = 0.201  per(accum) = 52.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 9.009e+00 S  per = 37.8  per(accum) = 90.3
 T(global opt: dvdson [cpu-gpu]            ) = 2.572e-01 S  per = 1.08  per(accum) = 91.4
 T(global opt: dvdson [nccl]               ) = 1.440e-03 S  per = 0.00604  per(accum) = 91.4
 T(global opt: dvdson [mpi]                ) = 3.373e-05 S  per = 0.000141  per(accum) = 91.4
 T(global opt: dvdson [rest part(linalg)]  ) = 2.048e+00 S  per = 8.59  per(accum) = 100
Detailed decomposition of T(renrm) = 3.284e+00 S  T(sum) = 3.284e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.070e-02 S  per = 0.326  per(accum) = 0.326
 T(global opt: qops init                    ) = 1.232e-01 S  per = 3.75  per(accum) = 4.08
 T(global opt: symbolic_formulae_renorm     ) = 1.326e-01 S  per = 4.04  per(accum) = 8.12
 T(global opt: allocate qops on gpu         ) = 2.156e-02 S  per = 0.657  per(accum) = 8.77
 T(global opt: site memcpy cpu2gpu          ) = 4.379e-02 S  per = 1.33  per(accum) = 10.1
 T(global opt: rintermediate init           ) = 8.520e-02 S  per = 2.59  per(accum) = 12.7
 T(global opt: preprocess_formulae_Rlist2   ) = 9.973e-01 S  per = 30.4  per(accum) = 43.1
 T(global opt: rmmtasks init                ) = 5.019e-01 S  per = 15.3  per(accum) = 58.4
 T(global opt: qops memset on cpu           ) = 1.338e-06 S  per = 4.07e-05  per(accum) = 58.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.191e+00 S  per = 36.3  per(accum) = 94.6
 T(global opt: deallocate cpu and gpu memory) = 4.254e-03 S  per = 0.13  per(accum) = 94.8
 T(global opt: construct opS [ifdists=true] ) = 1.719e-06 S  per = 5.23e-05  per(accum) = 94.8
 T(global opt: reduction of opS & opH [nccl]) = 1.326e-06 S  per = 4.04e-05  per(accum) = 94.8
 T(global opt: qops memcpy gpu2cpu          ) = 4.035e-03 S  per = 0.123  per(accum) = 94.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.787e-03 S  per = 0.0544  per(accum) = 94.9
 T(global opt: qops_pool join and erase     ) = 1.041e-01 S  per = 3.17  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 6.211e-02 S  per = 1.89  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.129e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=33/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=811:6.187e-03MB:6.042e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=11:8.392e-05MB:8.196e-08GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:17 S:3 P:9 Q:12 
        dim(bra,ket)=7,7 size(op)=11:8.39e-05MB size(tot)=390:0.00298MB:2.91e-06GB
        per(mem): H:2.82 C:47.9 S:8.46 P:8.46 Q:32.3 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3384:0.0258MB:2.52e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.589e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-7.451e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(3,7,3,3) nnz=30:2.289e-04MB
qtensor4: wf4 own=1 _data=0x45bac5a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=180 size=30:2.289e-04MB
### DIAG TIMING: total=6.750e-02 t1=4.334e-05, t2=1.865e-03, t3=2.556e-03, t4=6.302e-02, t5=3.435e-06, t6=1.472e-05, t7=5.068e-06
duration_diagGPU:6.752e-02
duration_diagreduce:3.700e-08
duration_diagtransform:4.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=228 : 2.130e-03 S -----
rank=0 GPUmem(GB): used=2.521e-05 (oper)=2.521e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:2.853e-03MB:2.787e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.325e-05 S -----
rank=0 GPUmem(GB): used=2.800e-05 (oper,hinter)=2.521e-05,2.787e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.185e-02 S size(H_formulae)=228 size(Hxlst2)=21 T(Hmu/Hxlist)=5.570e-04,7.130e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.266e-02 S size(H_formulae)=228 size(Hxlst)=4804 -----
rank=0 GPUmem(GB): used=2.800e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.470e-07 batch[need]=3.221e-04 blksize=2 blksize0=4 batchsize=4804
rank=0 GPUmem(GB): used=3.506e-04 (oper,hinter,dvdson,batch)=2.521e-05,2.787e-06,4.470e-07,3.221e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.222e-03,9.898e-03,2.979e-02,1.292e-02,5.484e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.217e-03 speed=2.016e-04GB/S T(nccl)=5.092e-06 speed=8.779e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=200 t=9.9e-03 per=1.9e+01 cost=2.5e+04 flops=2.6e+06
 sigma[gemm] counter=200 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=2 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=3 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=4 t=7.5e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=200 i=5 t=7.4e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=200 i=6 t=7.5e-03 per=1.4e+01 cost=4.3e+03 flops=5.7e+05
 sigma[gemm] counter=200 i=7 t=7.4e-03 per=1.4e+01 cost=4.9e+03 flops=6.6e+05
 sigma[gemm] counter=200 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=200 t=1.3e-02 per=2.5e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=2.1e+00 t_gemm=4.6e+00 t_reduction=2.3e+00 tot=9.0e+00 -----
 sigma_tot[inter] counter=200 t=2.1e+00 per=2.4e+01 cost=1.7e+08 flops=8.0e+07
 sigma_tot[gemm] counter=200 i=0 t=4.1e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=1 t=3.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=2 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=3 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=200 i=5 t=1.1e+00 per=1.3e+01 cost=3.2e+07 flops=2.8e+07
 sigma_tot[gemm] counter=200 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.6e+07
 sigma_tot[gemm] counter=200 i=7 t=1.2e+00 per=1.3e+01 cost=3.0e+07 flops=2.6e+07
 sigma_tot[gemm] counter=200 total t=4.6e+00 per=5.1e+01 cost=1.2e+08 flops=2.7e+07
 sigma_tot[red] counter=200 t=2.3e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.2e-06,2.1e-06,7.3e-07,1.9e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336865909158 -1.116e+03  1.855e-02    1     1  5.497e-02 5.497e-02 5.495e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.508e-04,9.877e-03,2.995e-02,1.300e-02,5.310e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.445e-04 speed=1.828e-03GB/S T(nccl)=6.274e-06 speed=7.125e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=201 t=9.9e-03 per=1.9e+01 cost=2.5e+04 flops=2.6e+06
 sigma[gemm] counter=201 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=2 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=4 t=7.5e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=201 i=5 t=7.6e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=201 i=6 t=7.4e-03 per=1.4e+01 cost=4.3e+03 flops=5.8e+05
 sigma[gemm] counter=201 i=7 t=7.4e-03 per=1.4e+01 cost=4.9e+03 flops=6.5e+05
 sigma[gemm] counter=201 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=201 t=1.3e-02 per=2.5e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=2.2e+00 t_gemm=4.6e+00 t_reduction=2.3e+00 tot=9.1e+00 -----
 sigma_tot[inter] counter=201 t=2.2e+00 per=2.4e+01 cost=1.7e+08 flops=8.0e+07
 sigma_tot[gemm] counter=201 i=0 t=4.1e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=1 t=3.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=2 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=3 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=201 i=5 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.8e+07
 sigma_tot[gemm] counter=201 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.6e+07
 sigma_tot[gemm] counter=201 i=7 t=1.2e+00 per=1.3e+01 cost=3.0e+07 flops=2.6e+07
 sigma_tot[gemm] counter=201 total t=4.6e+00 per=5.1e+01 cost=1.2e+08 flops=2.6e+07
 sigma_tot[red] counter=201 t=2.3e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.1e-05,3.5e-06,9.0e-07,2.2e-07
    2   0 -    -116.338361861071 -1.496e-03  6.724e-03    2     2  1.228e-01 6.142e-02 5.408e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.785e-04,9.899e-03,2.961e-02,1.282e-02,5.302e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=6.733e-04 speed=6.639e-04GB/S T(nccl)=5.195e-06 speed=8.605e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=202 t=9.9e-03 per=1.9e+01 cost=2.5e+04 flops=2.6e+06
 sigma[gemm] counter=202 i=0 t=1.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=1 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=3 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=4 t=7.4e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=202 i=5 t=7.4e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=202 i=6 t=7.4e-03 per=1.4e+01 cost=4.3e+03 flops=5.8e+05
 sigma[gemm] counter=202 i=7 t=7.4e-03 per=1.4e+01 cost=4.9e+03 flops=6.5e+05
 sigma[gemm] counter=202 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=202 t=1.3e-02 per=2.5e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=2.2e+00 t_gemm=4.7e+00 t_reduction=2.3e+00 tot=9.1e+00 -----
 sigma_tot[inter] counter=202 t=2.2e+00 per=2.4e+01 cost=1.7e+08 flops=7.9e+07
 sigma_tot[gemm] counter=202 i=0 t=4.1e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=1 t=3.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=2 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=3 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=202 i=5 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=202 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.6e+07
 sigma_tot[gemm] counter=202 i=7 t=1.2e+00 per=1.3e+01 cost=3.0e+07 flops=2.6e+07
 sigma_tot[gemm] counter=202 total t=4.7e+00 per=5.1e+01 cost=1.2e+08 flops=2.6e+07
 sigma_tot[red] counter=202 t=2.3e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.8e-05,3.1e-06,9.9e-07,2.1e-07
    3   0 -    -116.338434948552 -7.309e-05  7.110e-04    3     3  1.861e-01 6.203e-02 5.376e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.845e-03,1.013e-02,3.017e-02,1.279e-02,5.495e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.840e-03 speed=2.430e-04GB/S T(nccl)=5.928e-06 speed=7.541e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=203 t=1.0e-02 per=1.9e+01 cost=2.5e+04 flops=2.5e+06
 sigma[gemm] counter=203 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=2 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=3 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=4 t=7.6e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=203 i=5 t=7.5e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=203 i=6 t=7.5e-03 per=1.4e+01 cost=4.3e+03 flops=5.7e+05
 sigma[gemm] counter=203 i=7 t=7.6e-03 per=1.4e+01 cost=4.9e+03 flops=6.4e+05
 sigma[gemm] counter=203 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.0e+05
 sigma[red] counter=203 t=1.3e-02 per=2.4e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=2.2e+00 t_gemm=4.7e+00 t_reduction=2.3e+00 tot=9.2e+00 -----
 sigma_tot[inter] counter=203 t=2.2e+00 per=2.4e+01 cost=1.7e+08 flops=7.9e+07
 sigma_tot[gemm] counter=203 i=0 t=4.1e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=1 t=3.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=2 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=3 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=203 i=5 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=203 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.5e+07
 sigma_tot[gemm] counter=203 i=7 t=1.2e+00 per=1.3e+01 cost=3.0e+07 flops=2.6e+07
 sigma_tot[gemm] counter=203 total t=4.7e+00 per=5.1e+01 cost=1.2e+08 flops=2.6e+07
 sigma_tot[red] counter=203 t=2.3e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.0e-06,1.1e-06,2.1e-07
    4   0 -    -116.338436814483 -1.866e-06  1.919e-04    3     4  2.543e-01 6.356e-02 5.408e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.332e-03,1.006e-02,3.011e-02,1.287e-02,5.438e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.327e-03 speed=3.369e-04GB/S T(nccl)=4.778e-06 speed=9.356e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=204 t=1.0e-02 per=1.9e+01 cost=2.5e+04 flops=2.5e+06
 sigma[gemm] counter=204 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=2 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=3 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=4 t=7.5e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=204 i=5 t=7.5e-03 per=1.4e+01 cost=9.0e+03 flops=1.2e+06
 sigma[gemm] counter=204 i=6 t=7.5e-03 per=1.4e+01 cost=4.3e+03 flops=5.7e+05
 sigma[gemm] counter=204 i=7 t=7.5e-03 per=1.4e+01 cost=4.9e+03 flops=6.4e+05
 sigma[gemm] counter=204 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=204 t=1.3e-02 per=2.4e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=2.2e+00 t_gemm=4.7e+00 t_reduction=2.3e+00 tot=9.2e+00 -----
 sigma_tot[inter] counter=204 t=2.2e+00 per=2.4e+01 cost=1.7e+08 flops=7.8e+07
 sigma_tot[gemm] counter=204 i=0 t=4.1e-04 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=1 t=3.5e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=2 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=3 t=3.2e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=4 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=204 i=5 t=1.2e+00 per=1.3e+01 cost=3.2e+07 flops=2.7e+07
 sigma_tot[gemm] counter=204 i=6 t=1.1e+00 per=1.2e+01 cost=2.9e+07 flops=2.5e+07
 sigma_tot[gemm] counter=204 i=7 t=1.2e+00 per=1.3e+01 cost=3.0e+07 flops=2.6e+07
 sigma_tot[gemm] counter=204 total t=4.7e+00 per=5.1e+01 cost=1.2e+08 flops=2.6e+07
 sigma_tot[red] counter=204 t=2.3e+00 per=2.5e+01 cost=2.9e+07 flops=1.3e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,3.1e-06,8.8e-07,2.1e-07
    5   0 +    -116.338436942700 -1.282e-07  3.305e-05    3     5  3.203e-01 6.405e-02 5.417e-02
TIMING FOR Davidson : 3.203e-01  T(cal/comm/rest)=2.708e-01,6.760e-07,4.945e-02
decomposed t_rest=4.945e-02
 T(sub)    =1.012e-04 per=2.047e-01
 T(precond)=4.919e-02 per=9.947e+01
 T(ortho)  =2.601e-05 per=5.261e-02
 T(xcopy)  =8.270e-07 per=1.672e-03
 T(xnrm2)  =1.165e-05 per=2.356e-02
 T(other)  =1.227e-04 per=2.482e-01
optimized energies: isweep=0 ibond=33 dots=2 e[0]=-116.338436942700 nmvp=5
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=0.000e+00 change=1.297e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=9 dimAll=25
 (25,1):3 (26,0):5 (26,2):3 (24,0):1 (27,1):6 (28,0):3 (28,2):2 (29,1):1 (27,3):1
timing for divide=6.3e-05
timing for compute=1.3e-02
timing for collect=4.2e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=6.3e-05,1.3e-02,0.0e+00,5.4e-06,4.2e-05 -----
decimation summary: 25->8 dwt=+1.110e-16 SvN=6.290e-01
 qbond: qkept nsym=5 dimAll=8
 (28,0):3 (27,1):2 (26,0):1 (28,2):1 (29,1):1
----- TIMING for decimation_row(nkr): 1.315e-02 S T(decim/select/formRot)=1.278e-02,2.219e-04,1.538e-04 -----
----- TIMING FOR twodot_decimation: 1.371e-02 S T(wf/decim)=4.656e-04,1.324e-02 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:18 S:2 P:4 Q:6 
        dim(bra,ket)=8,8 size(op)=16:1.221e-04MB size(tot)=398:3.036e-03MB:2.965e-06GB
        per(mem): H:4.02 C:63.3 S:7.04 P:4.52 Q:21.1 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=0.000e+00 change=6.552e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=31 : 1.079e-03 S -----
rank=0 GPUmem(GB): used=1.609e-05 (oper)=1.331e-05
rank=0 GPUmem(GB): used=1.631e-05 (oper,site)=1.331e-05,2.161e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=31
 no. of rintermediate operators=22
 no. of coefficients=374:2.853e-03MB:2.787e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.442e-03 S -----
rank=0 GPUmem(GB): used=1.910e-05 (oper,site,rinter)=1.331e-05,2.161e-07,2.787e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.140e-02 S size(rtasks)=31 size(Rlst2)=25 T(Rmu/Rlist)=2.235e-04,1.117e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.160e-02 S size(rtasks)=31 size(Rlst)=951 -----
rank=0 GPUmem(GB): used=1.910e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.630e-04 blksize=9 blksize0=4 batchsize=951
rank=0 GPUmem(GB): used=1.821e-04 (oper,site,rinter,batch)=1.331e-05,2.161e-07,2.787e-06,1.630e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.571e-03,2.273e-02,1.009e-02
----- TIMING FOR renorm : t_inter=5.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=34 t=5.6e-03 per=1.5e+01 cost=1.0e+04 flops=1.9e+06
 renorm[gemm] counter=34 i=0 t=1.4e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=1 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=2 t=7.5e-03 per=2.0e+01 cost=2.1e+03 flops=2.8e+05
 renorm[gemm] counter=34 i=3 t=7.5e-03 per=2.0e+01 cost=4.3e+03 flops=5.7e+05
 renorm[gemm] counter=34 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=6 t=7.7e-03 per=2.0e+01 cost=8.9e+03 flops=1.2e+06
 renorm[gemm] counter=34 total t=2.3e-02 per=5.9e+01 cost=1.5e+04 flops=6.7e+05
 renorm[red] counter=34 t=1.0e-02 per=2.6e+01 cost=6.2e+03 flops=6.1e+05
----- TIMING FOR renorm_tot : t_inter=1.9e-01 t_gemm=7.2e-01 t_reduction=3.2e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=34 t=1.9e-01 per=1.6e+01 cost=3.2e+06 flops=1.7e+07
 renorm_tot[gemm] counter=34 i=0 t=5.5e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=1 t=4.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=2 t=1.1e-01 per=8.9e+00 cost=2.1e+05 flops=1.9e+06
 renorm_tot[gemm] counter=34 i=3 t=1.2e-01 per=9.4e+00 cost=5.9e+05 flops=5.1e+06
 renorm_tot[gemm] counter=34 i=4 t=1.3e-01 per=1.0e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=34 i=5 t=1.3e-01 per=1.0e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=34 i=6 t=2.4e-01 per=2.0e+01 cost=2.0e+06 flops=8.2e+06
 renorm_tot[gemm] counter=34 total t=7.2e-01 per=5.9e+01 cost=3.5e+06 flops=4.9e+06
 renorm_tot[red] counter=34 t=3.2e-01 per=2.6e+01 cost=8.6e+05 flops=2.7e+06
qops.to_cpu: size(tot)=398:3.0e-03MB:3.0e-06GB T(to_cpu)=5.0e-05S speed=5.9e-02GB/S
check ||H-H.dagger||=2.230e-14 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0623 S rank=0 -----
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=0.000e+00 change=2.854e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=7.629e-05 change=-2.722e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=8.392e-05 change=-3.159e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.971e-01 S #####
 T(local opt: fetch) = 1.956e-02 S  per = 3.28  per(accum) = 3.28
 T(local opt: hdiag) = 6.791e-02 S  per = 11.4  per(accum) = 14.6
 T(local opt: dvdsn) = 4.283e-01 S  per = 71.7  per(accum) = 86.4
 T(local opt: decim) = 1.372e-02 S  per =  2.3  per(accum) = 88.7
 T(local opt: guess) = 7.546e-04 S  per = 0.126  per(accum) = 88.8
 T(local opt: renrm) = 6.666e-02 S  per = 11.2  per(accum) = 100
 T(local opt: save ) = 2.361e-04 S  per = 0.0395  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.283e-01 S  T(sum) = 4.280e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 2.583e-03 S  per = 0.604  per(accum) = 0.604
 T(local opt: symbolic_formulae           ) = 2.140e-03 S  per =  0.5  per(accum) = 1.1
 T(local opt: hintermediate init          ) = 8.770e-05 S  per = 0.0205  per(accum) = 1.12
 T(local opt: preprocess_hformulae_Hxlist ) = 7.284e-02 S  per =   17  per(accum) = 18.1
 T(local opt: hmmtasks init               ) = 2.924e-02 S  per = 6.83  per(accum) = 25
 T(local opt: initial guess for dvdson    ) = 7.799e-04 S  per = 0.182  per(accum) = 25.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.645e-01 S  per = 61.8  per(accum) = 87
 T(local opt: dvdson [cpu-gpu]            ) = 6.302e-03 S  per = 1.47  per(accum) = 88.4
 T(local opt: dvdson [nccl]               ) = 2.727e-05 S  per = 0.00637  per(accum) = 88.4
 T(local opt: dvdson [mpi]                ) = 6.760e-07 S  per = 0.000158  per(accum) = 88.4
 T(local opt: dvdson [rest part(linalg)]  ) = 4.945e-02 S  per = 11.6  per(accum) = 100
Detailed decomposition of T(renrm) = 6.666e-02 S  T(sum) = 6.666e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.021e-04 S  per = 0.453  per(accum) = 0.453
 T(local opt: qops init                    ) = 1.281e-03 S  per = 1.92  per(accum) = 2.38
 T(local opt: symbolic_formulae_renorm     ) = 1.089e-03 S  per = 1.63  per(accum) = 4.01
 T(local opt: allocate qops on gpu         ) = 5.500e-05 S  per = 0.0825  per(accum) = 4.09
 T(local opt: site memcpy cpu2gpu          ) = 1.619e-03 S  per = 2.43  per(accum) = 6.52
 T(local opt: rintermediate init           ) = 2.452e-03 S  per = 3.68  per(accum) = 10.2
 T(local opt: preprocess_formulae_Rlist2   ) = 1.163e-02 S  per = 17.5  per(accum) = 27.7
 T(local opt: rmmtasks init                ) = 5.485e-03 S  per = 8.23  per(accum) = 35.9
 T(local opt: qops memset on cpu           ) = 4.100e-08 S  per = 6.15e-05  per(accum) = 35.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.848e-02 S  per = 57.7  per(accum) = 93.6
 T(local opt: deallocate cpu and gpu memory) = 5.581e-05 S  per = 0.0837  per(accum) = 93.7
 T(local opt: construct opS [ifdists=true] ) = 4.400e-08 S  per = 6.6e-05  per(accum) = 93.7
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 5.85e-05  per(accum) = 93.7
 T(local opt: qops memcpy gpu2cpu          ) = 5.720e-05 S  per = 0.0858  per(accum) = 93.8
 T(local opt: reduction of opS & opH [mpi] ) = 5.350e-05 S  per = 0.0803  per(accum) = 93.9
 T(local opt: qops_pool join and erase     ) = 4.091e-03 S  per = 6.14  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 6.320e-06 S  per = 0.00948  per(accum) = 100
##### sweep opt: 4.412e+01 S #####
 T(sweep opt: fetch) = 4.805e-01 S  per = 1.09  per(accum) = 1.09
 T(sweep opt: hdiag) = 1.543e+01 S  per =   35  per(accum) = 36.1
 T(sweep opt: dvdsn) = 2.434e+01 S  per = 55.2  per(accum) = 91.2
 T(sweep opt: decim) = 4.637e-01 S  per = 1.05  per(accum) = 92.3
 T(sweep opt: guess) = 4.107e-02 S  per = 0.0931  per(accum) = 92.4
 T(sweep opt: renrm) = 3.351e+00 S  per = 7.59  per(accum) = 100
 T(sweep opt: save ) = 1.089e-02 S  per = 0.0247  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.434e+01 S  T(sum) = 2.428e+01 S  per = 9.973e+01
 T(sweep opt: preprocess                  ) = 1.763e-01 S  per = 0.726  per(accum) = 0.726
 T(sweep opt: symbolic_formulae           ) = 2.530e-01 S  per = 1.04  per(accum) = 1.77
 T(sweep opt: hintermediate init          ) = 1.285e-02 S  per = 0.0529  per(accum) = 1.82
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.191e+00 S  per = 33.7  per(accum) = 35.6
 T(sweep opt: hmmtasks init               ) = 3.960e+00 S  per = 16.3  per(accum) = 51.9
 T(sweep opt: initial guess for dvdson    ) = 4.866e-02 S  per =  0.2  per(accum) = 52.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 9.273e+00 S  per = 38.2  per(accum) = 90.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.635e-01 S  per = 1.09  per(accum) = 91.4
 T(sweep opt: dvdson [nccl]               ) = 1.467e-03 S  per = 0.00604  per(accum) = 91.4
 T(sweep opt: dvdson [mpi]                ) = 3.441e-05 S  per = 0.000142  per(accum) = 91.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.097e+00 S  per = 8.64  per(accum) = 100
Detailed decomposition of T(renrm) = 3.351e+00 S  T(sum) = 3.351e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.101e-02 S  per = 0.329  per(accum) = 0.329
 T(sweep opt: qops init                    ) = 1.244e-01 S  per = 3.71  per(accum) = 4.04
 T(sweep opt: symbolic_formulae_renorm     ) = 1.337e-01 S  per = 3.99  per(accum) = 8.03
 T(sweep opt: allocate qops on gpu         ) = 2.162e-02 S  per = 0.645  per(accum) = 8.68
 T(sweep opt: site memcpy cpu2gpu          ) = 4.541e-02 S  per = 1.36  per(accum) = 10
 T(sweep opt: rintermediate init           ) = 8.765e-02 S  per = 2.62  per(accum) = 12.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.009e+00 S  per = 30.1  per(accum) = 42.8
 T(sweep opt: rmmtasks init                ) = 5.074e-01 S  per = 15.1  per(accum) = 57.9
 T(sweep opt: qops memset on cpu           ) = 1.379e-06 S  per = 4.12e-05  per(accum) = 57.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.230e+00 S  per = 36.7  per(accum) = 94.6
 T(sweep opt: deallocate cpu and gpu memory) = 4.310e-03 S  per = 0.129  per(accum) = 94.7
 T(sweep opt: construct opS [ifdists=true] ) = 1.763e-06 S  per = 5.26e-05  per(accum) = 94.7
 T(sweep opt: reduction of opS & opH [nccl]) = 1.365e-06 S  per = 4.07e-05  per(accum) = 94.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.092e-03 S  per = 0.122  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.841e-03 S  per = 0.0549  per(accum) = 94.9
 T(sweep opt: qops_pool join and erase     ) = 1.082e-01 S  per = 3.23  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 6.211e-02 S  per = 1.85  per(accum) = 100
##### global opt: 4.412e+01 S #####
 T(global opt: fetch) = 4.805e-01 S  per = 1.09  per(accum) = 1.09
 T(global opt: hdiag) = 1.543e+01 S  per =   35  per(accum) = 36.1
 T(global opt: dvdsn) = 2.434e+01 S  per = 55.2  per(accum) = 91.2
 T(global opt: decim) = 4.637e-01 S  per = 1.05  per(accum) = 92.3
 T(global opt: guess) = 4.107e-02 S  per = 0.0931  per(accum) = 92.4
 T(global opt: renrm) = 3.351e+00 S  per = 7.59  per(accum) = 100
 T(global opt: save ) = 1.089e-02 S  per = 0.0247  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.434e+01 S  T(sum) = 2.428e+01 S  per = 9.973e+01
 T(global opt: preprocess                  ) = 1.763e-01 S  per = 0.726  per(accum) = 0.726
 T(global opt: symbolic_formulae           ) = 2.530e-01 S  per = 1.04  per(accum) = 1.77
 T(global opt: hintermediate init          ) = 1.285e-02 S  per = 0.0529  per(accum) = 1.82
 T(global opt: preprocess_hformulae_Hxlist ) = 8.191e+00 S  per = 33.7  per(accum) = 35.6
 T(global opt: hmmtasks init               ) = 3.960e+00 S  per = 16.3  per(accum) = 51.9
 T(global opt: initial guess for dvdson    ) = 4.866e-02 S  per =  0.2  per(accum) = 52.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 9.273e+00 S  per = 38.2  per(accum) = 90.3
 T(global opt: dvdson [cpu-gpu]            ) = 2.635e-01 S  per = 1.09  per(accum) = 91.4
 T(global opt: dvdson [nccl]               ) = 1.467e-03 S  per = 0.00604  per(accum) = 91.4
 T(global opt: dvdson [mpi]                ) = 3.441e-05 S  per = 0.000142  per(accum) = 91.4
 T(global opt: dvdson [rest part(linalg)]  ) = 2.097e+00 S  per = 8.64  per(accum) = 100
Detailed decomposition of T(renrm) = 3.351e+00 S  T(sum) = 3.351e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.101e-02 S  per = 0.329  per(accum) = 0.329
 T(global opt: qops init                    ) = 1.244e-01 S  per = 3.71  per(accum) = 4.04
 T(global opt: symbolic_formulae_renorm     ) = 1.337e-01 S  per = 3.99  per(accum) = 8.03
 T(global opt: allocate qops on gpu         ) = 2.162e-02 S  per = 0.645  per(accum) = 8.68
 T(global opt: site memcpy cpu2gpu          ) = 4.541e-02 S  per = 1.36  per(accum) = 10
 T(global opt: rintermediate init           ) = 8.765e-02 S  per = 2.62  per(accum) = 12.6
 T(global opt: preprocess_formulae_Rlist2   ) = 1.009e+00 S  per = 30.1  per(accum) = 42.8
 T(global opt: rmmtasks init                ) = 5.074e-01 S  per = 15.1  per(accum) = 57.9
 T(global opt: qops memset on cpu           ) = 1.379e-06 S  per = 4.12e-05  per(accum) = 57.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.230e+00 S  per = 36.7  per(accum) = 94.6
 T(global opt: deallocate cpu and gpu memory) = 4.310e-03 S  per = 0.129  per(accum) = 94.7
 T(global opt: construct opS [ifdists=true] ) = 1.763e-06 S  per = 5.26e-05  per(accum) = 94.7
 T(global opt: reduction of opS & opH [nccl]) = 1.365e-06 S  per = 4.07e-05  per(accum) = 94.7
 T(global opt: qops memcpy gpu2cpu          ) = 4.092e-03 S  per = 0.122  per(accum) = 94.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.841e-03 S  per = 0.0549  per(accum) = 94.9
 T(global opt: qops_pool join and erase     ) = 1.082e-01 S  per = 3.23  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 6.211e-02 S  per = 1.85  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.286e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

======================================================================
sweep_data::summary isweep=0 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=1.000e-04 noise=0.000e+00
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=2 dwt=+0.000e+00 nmvp=3 e[0]=-116.177526452453 t=0.388
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=6 e[0]=-116.200295182409 t=0.639
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=7 dwt=+0.000e+00 nmvp=7 e[0]=-116.215792300366 t=0.777
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=10 dwt=+1.070e-06 nmvp=6 e[0]=-116.216235822396 t=0.988
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=10 dwt=+1.978e-04 nmvp=7 e[0]=-116.217372098439 t=1.525
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=10 dwt=+5.145e-02 nmvp=8 e[0]=-116.234506198197 t=1.763
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=10 dwt=+2.363e-04 nmvp=7 e[0]=-116.238044195480 t=1.635
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=10 dwt=+5.960e-04 nmvp=7 e[0]=-116.248994471347 t=2.170
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=10 dwt=+4.871e-03 nmvp=6 e[0]=-116.250773542643 t=2.455
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=10 dwt=+1.232e-03 nmvp=7 e[0]=-116.266701220275 t=2.074
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=10 dwt=+7.393e-07 nmvp=7 e[0]=-116.284967260831 t=1.665
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=9 dwt=-2.220e-16 nmvp=6 e[0]=-116.291464685952 t=1.343
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=7 dwt=+2.220e-16 nmvp=6 e[0]=-116.298821391660 t=1.099
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=10 dwt=+7.605e-09 nmvp=6 e[0]=-116.301456582762 t=0.948
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=10 dwt=+6.494e-06 nmvp=7 e[0]=-116.307302820366 t=0.961
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=10 dwt=+5.064e-08 nmvp=6 e[0]=-116.311487752567 t=0.750
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=9 dwt=+1.110e-16 nmvp=6 e[0]=-116.316728679445 t=0.691
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=9 dwt=+0.000e+00 nmvp=1 e[0]=-116.316728679445 t=0.333
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=10 dwt=+2.861e-05 nmvp=5 e[0]=-116.316765976237 t=0.773
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=10 dwt=+3.341e-04 nmvp=6 e[0]=-116.317231466819 t=1.186
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=10 dwt=+6.719e-05 nmvp=6 e[0]=-116.317295830466 t=1.136
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=10 dwt=+4.290e-04 nmvp=7 e[0]=-116.323389329774 t=1.350
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=10 dwt=+7.384e-04 nmvp=7 e[0]=-116.327525813352 t=1.443
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=10 dwt=+3.719e-03 nmvp=7 e[0]=-116.329980164893 t=1.897
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=10 dwt=+3.623e-03 nmvp=7 e[0]=-116.331017307255 t=2.259
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=10 dwt=+4.776e-03 nmvp=7 e[0]=-116.332572672318 t=2.724
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=10 dwt=+1.635e-04 nmvp=6 e[0]=-116.332392700332 t=2.499
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=10 dwt=+0.000e+00 nmvp=6 e[0]=-116.335549867109 t=1.508
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=10 dwt=+8.624e-03 nmvp=7 e[0]=-116.339671899742 t=1.062
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=10 dwt=+1.424e-04 nmvp=6 e[0]=-116.336697017628 t=1.130
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=10 dwt=+5.309e-06 nmvp=7 e[0]=-116.336855132062 t=0.896
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=10 dwt=+2.094e-06 nmvp=3 e[0]=-116.336863937705 t=0.951
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=3 e[0]=-116.336865909158 t=0.508
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=8 dwt=+1.110e-16 nmvp=5 e[0]=-116.338436942700 t=0.597
 eav_max=-116.177526452453 [ibond=0]  dwt_min=-2.220e-16 [ibond=11]
 eav_min=-116.339671899742 [ibond=28]  dwt_max=5.145e-02 [ibond=5]
 eav_diff=0.162145447289
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+8.624e-03 e[0]=-116.339671899742
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 204 | 4.421e+01 | 4.421e+01 | 2.372e+00 5.441e+00 2.649e+00 1.046e+01 23.7
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +8.624e-03 e[0]=-116.339671899742 (0.000e+00)
======================================================================
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.451e-09 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0_su2
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=4 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=9 dimAll=28
 (28,0):6 (27,1):3 (26,0):1 (28,2):3 (29,1):7 (30,0):4 (30,2):2 (31,1):1 (29,3):1
timing for divide=2.449e-05
timing for compute=1.377e-02
timing for collect=1.632e-05
----- TMING FOR decimation_genbasis(su2): 1.381e-02 S T(divide/compute[cpu/gpu/rest]/collect)=2.449e-05,1.376e-02,0.000e+00,4.594e-06,1.632e-05 -----
decimation summary: 28->3 dwt=-2.220e-16 SvN=4.721e-01
 qbond: qkept nsym=3 dimAll=3
 (28,0):1 (29,1):1 (30,0):1
----- TIMING for decimation_row(nkr): 1.407e-02 S T(decim/select/formRot)=1.386e-02,1.641e-04,5.174e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=6 dimAll=10
 (28,0):1 (29,1):2 (30,0):3 (31,1):2 (32,0):1 (30,2):1
timing for divide=1.022e-05
timing for compute=2.304e-02
timing for collect=2.484e-05
----- TMING FOR decimation_genbasis(su2): 2.308e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.022e-05,2.304e-02,0.000e+00,5.635e-06,2.484e-05 -----
decimation summary: 10->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 2.332e-02 S T(decim/select/formRot)=2.312e-02,1.700e-04,2.399e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0_su2 T(save)=8.91e-04S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=9 maxdiff=3.156e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=6.348e-16 deviate=0
 idx=3 node=(16,0) Drow=10 maxdiff=5.829e-16 deviate=0
 idx=4 node=(15,0) Drow=10 maxdiff=1.750e-15 deviate=0
 idx=5 node=(14,0) Drow=10 maxdiff=1.021e-15 deviate=0
 idx=6 node=(13,0) Drow=10 maxdiff=7.065e-16 deviate=0
 idx=7 node=(12,0) Drow=10 maxdiff=1.028e-15 deviate=0
 idx=8 node=(11,0) Drow=10 maxdiff=1.993e-15 deviate=0
 idx=9 node=(10,0) Drow=10 maxdiff=7.319e-16 deviate=0
 idx=10 node=(9,0) Drow=10 maxdiff=1.240e-15 deviate=0
 idx=11 node=(8,0) Drow=10 maxdiff=1.685e-15 deviate=0
 idx=12 node=(7,0) Drow=10 maxdiff=2.036e-15 deviate=0
 idx=13 node=(6,0) Drow=10 maxdiff=1.493e-15 deviate=0
 idx=14 node=(5,0) Drow=10 maxdiff=1.030e-15 deviate=0
 idx=15 node=(4,0) Drow=10 maxdiff=1.919e-15 deviate=0
 idx=16 node=(3,0) Drow=7 maxdiff=4.441e-16 deviate=0
 idx=17 node=(2,0) Drow=8 maxdiff=7.410e-16 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=1.110e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x45b9e270
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x45b9e270
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 5.342e-03 S -----
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=848:0.00647MB:6.32e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=852:0.0065MB:6.35e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-8.270e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:18 S:2 P:4 Q:6 
        dim(bra,ket)=8,8 size(op)=16:0.000122MB size(tot)=398:0.00304MB:2.97e-06GB
        per(mem): H:4.02 C:63.3 S:7.04 P:4.52 Q:21.1 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:19 S:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=48:0.000366MB:3.58e-07GB
        per(mem): H:6.25 C:79.2 S:4.17 P:2.08 Q:8.33 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.214e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 4.891e-04 S -----
rank=0 GPUmem(GB): used=1.076e-05 (oper)=1.076e-05
rank=0 GPUmem(GB): used=1.089e-05 (oper,site)=1.076e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=24
 no. of rintermediate operators=8
 no. of coefficients=144:1.099e-03MB:1.073e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.560e-03 S -----
rank=0 GPUmem(GB): used=1.196e-05 (oper,site,rinter)=1.076e-05,1.267e-07,1.073e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.361e-03 S size(rtasks)=24 size(Rlst2)=9 T(Rmu/Rlist)=1.330e-04,5.228e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.461e-03 S size(rtasks)=24 size(Rlst)=543 -----
rank=0 GPUmem(GB): used=1.196e-05 avail=6.176e+00 total=6.176e+00 batch[need]=5.259e-05 blksize=3 blksize0=6 batchsize=543
rank=0 GPUmem(GB): used=6.455e-05 (oper,site,rinter,batch)=1.076e-05,1.267e-07,1.073e-06,5.259e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.748e-03,2.264e-02,1.016e-02
----- TIMING FOR renorm : t_inter=5.7e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=35 t=5.7e-03 per=1.5e+01 cost=4.3e+03 flops=7.5e+05
 renorm[gemm] counter=35 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=2 t=7.6e-03 per=2.0e+01 cost=1.2e+03 flops=1.6e+05
 renorm[gemm] counter=35 i=3 t=7.5e-03 per=2.0e+01 cost=2.2e+03 flops=2.9e+05
 renorm[gemm] counter=35 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=6 t=7.5e-03 per=2.0e+01 cost=2.0e+03 flops=2.6e+05
 renorm[gemm] counter=35 total t=2.3e-02 per=5.9e+01 cost=5.4e+03 flops=2.4e+05
 renorm[red] counter=35 t=1.0e-02 per=2.6e+01 cost=1.1e+03 flops=1.1e+05
----- TIMING FOR renorm_tot : t_inter=2.0e-01 t_gemm=7.4e-01 t_reduction=3.3e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=35 t=2.0e-01 per=1.5e+01 cost=3.2e+06 flops=1.6e+07
 renorm_tot[gemm] counter=35 i=0 t=5.6e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=1 t=4.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=2 t=1.2e-01 per=9.2e+00 cost=2.1e+05 flops=1.8e+06
 renorm_tot[gemm] counter=35 i=3 t=1.2e-01 per=9.7e+00 cost=5.9e+05 flops=4.8e+06
 renorm_tot[gemm] counter=35 i=4 t=1.3e-01 per=1.0e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=35 i=5 t=1.3e-01 per=1.0e+01 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=35 i=6 t=2.5e-01 per=2.0e+01 cost=2.0e+06 flops=7.9e+06
 renorm_tot[gemm] counter=35 total t=7.4e-01 per=5.9e+01 cost=3.5e+06 flops=4.7e+06
 renorm_tot[red] counter=35 t=3.3e-01 per=2.6e+01 cost=8.6e+05 flops=2.6e+06
qops.to_cpu: size(tot)=48:3.7e-04MB:3.6e-07GB T(to_cpu)=3.7e-05S speed=9.7e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0518 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.665e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

coord=(0,0)
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:19 S:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=48:0.000366MB:3.58e-07GB
        per(mem): H:6.25 C:79.2 S:4.17 P:2.08 Q:8.33 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:20 S:0 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-2.131e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=21 : 2.326e-04 S -----
rank=0 GPUmem(GB): used=7.801e-06 (oper)=7.801e-06
rank=0 GPUmem(GB): used=7.823e-06 (oper,site)=7.801e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=7.823e-06 (oper,site,rinter)=7.801e-06,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 8.616e-04 S size(rtasks)=21 size(Rlst2)=1 T(Rmu/Rlist)=8.440e-05,7.771e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.782e-04 S size(rtasks)=21 size(Rlst)=98 -----
rank=0 GPUmem(GB): used=7.823e-06 avail=6.176e+00 total=6.176e+00 batch[need]=2.190e-06 blksize=1 blksize0=0 batchsize=98
rank=0 GPUmem(GB): used=1.001e-05 (oper,site,rinter,batch)=7.801e-06,2.235e-08,0.000e+00,2.190e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.028e-03,2.245e-02,9.976e-03
----- TIMING FOR renorm : t_inter=1.0e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.3e-02 -----
 renorm[inter] counter=36 t=1.0e-03 per=3.1e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=0 t=1.6e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=1 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=2 t=7.5e-03 per=2.2e+01 cost=9.4e+01 flops=1.3e+04
 renorm[gemm] counter=36 i=3 t=7.5e-03 per=2.2e+01 cost=9.4e+01 flops=1.3e+04
 renorm[gemm] counter=36 i=4 t=1.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=5 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=6 t=7.5e-03 per=2.2e+01 cost=2.0e+02 flops=2.6e+04
 renorm[gemm] counter=36 total t=2.2e-02 per=6.7e+01 cost=3.8e+02 flops=1.7e+04
 renorm[red] counter=36 t=1.0e-02 per=3.0e+01 cost=2.0e+02 flops=2.0e+04
----- TIMING FOR renorm_tot : t_inter=2.0e-01 t_gemm=7.7e-01 t_reduction=3.4e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=36 t=2.0e-01 per=1.5e+01 cost=3.2e+06 flops=1.6e+07
 renorm_tot[gemm] counter=36 i=0 t=5.8e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=1 t=4.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=2 t=1.2e-01 per=9.6e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=36 i=3 t=1.3e-01 per=1.0e+01 cost=5.9e+05 flops=4.5e+06
 renorm_tot[gemm] counter=36 i=4 t=1.3e-01 per=9.8e+00 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=36 i=5 t=1.3e-01 per=9.9e+00 cost=5.4e+05 flops=4.2e+06
 renorm_tot[gemm] counter=36 i=6 t=2.6e-01 per=2.0e+01 cost=2.0e+06 flops=7.7e+06
 renorm_tot[gemm] counter=36 total t=7.7e-01 per=5.9e+01 cost=3.5e+06 flops=4.6e+06
 renorm_tot[red] counter=36 t=3.4e-01 per=2.6e+01 cost=8.6e+05 flops=2.6e+06
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=2.9e-05S speed=2.5e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0371 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=4.023e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

matrix: Hmat_isweep0 size=(1,1)
     -1.163384369427e+02 

----- TIMING FOR sweep_opt: isweep=0 : 4.436e+01 S -----

----- TIMING FOR ctns::sweep_opt : 4.437e+01 S -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-8.731e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

Congrats! SADMRG calculation finishes successfully. Sun Jan 12 11:10:51 2025

