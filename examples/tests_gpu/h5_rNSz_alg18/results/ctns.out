
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Fri Apr  7 18:01:40 2023

GIT_HASH = 27a35aada33af79d6cc064ed30b3aa59886d6866

mpisize = 1 maxthreads = 112

input file = results/input.dat

schedule::read fname = results/input.dat
----------------------------------------------------------------------
dtype 0
nelec 5
twoms 1
integral_file moleinfo/fmole.info 
scratch ./scratch

$sci
dets 
0 1 2 3 4 
end
nroots 4
eps0 1.e-6
schedule
0 1.e-2
end
maxiter 6
$end

$ctns
verbose 1
qkind rNSz
nroots 2
maxdets 500 #000
topology_file topology/topo0
thresh_ortho 1.e-8
thresh_proj 1.e-14
schedule
# (n-th, dot, Dcut, dvdson, noise)
0 2 10 1.e-4 1.e-4
1 2 20 1.e-4 0.0
2 2 20 1.e-4 0.0
end
maxsweep 6
task_dmrg
alg_hvec 18
alg_hinter 2
alg_renorm 18
alg_rinter 2
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
nelec = 5
twoms = 1
integral_file = moleinfo/fmole.info

===== params_sci::print =====
nroots = 4
no. of unique seeds = 1
0-th det: 0 1 2 3 4 
flip = 0
eps0 = 1e-06
miniter = 0
maxiter = 6
schedule: iter eps1
0 0.01
1 0.01
2 0.01
3 0.01
4 0.01
5 0.01
convergence parameters
deltaE = 1e-10
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
load = 0
ci_file = ci.info
cthrd = 0.01

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo0
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
restart_sweep = 0
restart_bond = 0
maxdets = 500
thresh_proj = 1.000000e-14
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
nroots = 2
guess = 1
dbranch = 0
maxsweep = 6
maxbond = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 1.000000e-04
1 2 20 1.000000e-04 0.000000e+00
2 2 20 1.000000e-04 0.000000e+00
3 2 20 1.000000e-04 0.000000e+00
4 2 20 1.000000e-04 0.000000e+00
5 2 20 1.000000e-04 0.000000e+00
alg_hvec = 18
alg_hinter = 2
alg_renorm = 18
alg_rinter = 2
ifdist1 = 0
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
mmorder = 0
batchsize = 1000000000
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
rcanon_load = 0
rcanon_file = rcanon_ci.info
iomode = 0
ioasync = 0
iroot = 0
nsample = 100000
ndetprt = 10

io::create_scratch scratch=./scratch
rank=0 num_gpus=2 device_id=0 magma_queue=0x2db0540 allocated GPUmem(GB)=3.793683e+01

ctns::topology::read fname=topology/topo0
0
1
2
3
4

ctns::topology::print ntotal=5 nphysical=5 nbackbone=5
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
rcoord:
 idx=0 coord=(4,0) node: pindex=4 type=0 center=(-1,-1) left=(3,0) right=(-2,-2)
 idx=1 coord=(3,0) node: pindex=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=2 coord=(2,0) node: pindex=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=3 coord=(1,0) node: pindex=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=4 coord=(0,0) node: pindex=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(4,0) rsupport: 4 ; lsupport: 0 1 2 3 
 idx=1 coord=(3,0) rsupport: 3 4 ; lsupport: 0 1 2 
 idx=2 coord=(2,0) rsupport: 2 3 4 ; lsupport: 0 1 
 idx=3 coord=(1,0) rsupport: 1 2 3 4 ; lsupport: 0 
 idx=4 coord=(0,0) rsupport: 0 1 2 3 4 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(4,0) corbs: 4 ; rorbs: ; lorbs: 0 1 2 3 
 idx=1 coord=(3,0) corbs: 3 ; rorbs: 4 ; lorbs: 0 1 2 
 idx=2 coord=(2,0) corbs: 2 ; rorbs: 3 4 ; lorbs: 0 1 
 idx=3 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 ; lorbs: 0 
 idx=4 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9

fci::ci_load fname=./scratch/ci.info

fci::ci_truncate maxdets=500 ifortho=1
 reduction from 52 to 52 dets
 iroot=0 ova=1.000000000000e+00
 iroot=1 ova=1.000000000000e+00
 iroot=2 ova=1.000000000000e+00
 iroot=3 ova=1.000000000000e+00

ctns::rcanon_init qkind=rNSz

ctns::init_rbases rdm_svd=1.50e+00 thresh_proj=1.00e-14

idx=
idx=
idx=2
idx=1 node= node=((302 node=(,0) node=(14,30) type=1 rsupport=1, 0 type=)1 rsupport=2 23, 3 4 0 type=)
1 rsupport= 4 
ctns::right_projection<Km> thresh_proj=
idx=ctns::right_projection<Km> thresh_proj=4 node=(0,0) type=1.00e-14
0 type=0 rsupport=4 
3 4 
ctns::right_projection<Km> thresh_proj= rsupport=0 1 2 3 4 
1.00e-14
ctns::right_projection<Km> thresh_proj=1.00e-14
 qr=(1,1) dimB,dimBi=2,2 popBi=2.74e-01 popBc=2.74e-01 1-popBc=7.26e-01
 qr=(0,0) dimB,dimBi=1,1 popBi=4.36e-01 popBc=4.36e-01 1-popBc=5.64e-01
 qr=(5,1) dimB,dimBi=52,4 popBi=1.00e+00 popBc=1.00e+00 1-popBc=-2.22e-16
 qr=(2,0) dimB,dimBi=9,8 popBi=5.64e-01 popBc=8.38e-01 1-popBc=1.62e-01
dim(space,lspace,rspace)=52,1,52 dimBc=4 popBc=1.00e+00 SvN=2.00e+00
----- TIMING FOR ctns::right_projection<Km> : 7.699e-04 S -----
 qr= qr=(2,2) dimB,dimBi=(1,-1)3 dimB,dimBi=2,,32 popBi= popBi=0.114 popBc=0.952 1-popBc=0.2120.0478 popBc=
 qr=(3,-1) dimB,dimBi=5,4 popBi=0.00962 popBc=0.962 1-popBc=0.0382
0.648 1-popBc=0.352
 qr=(1,1) dimB,dimBi=2,2 popBi=0.309 popBc=0.958 1-popBc=0.0424
 qr=(3,1) dimB,dimBi=9,9 popBi=0.0321 popBc=0.994 1-popBc=0.00605
 qr=(2,-2) dimB,dimBi=1,1 popBi=0.00083 popBc=0.958 1-popBc=0.0415
 qr=(3,3) dimB,dimBi=1,1 popBi=0.000357 popBc=0.994 1-popBc=0.00569
 qr=(2,0) dimB,dimBi=4,4 popBi=0.0341 popBc=0.993 1-popBc=0.00739
 qr=(4,0) dimB,dimBi=9,8 popBi=0.005 popBc=0.999 1-popBc=0.000688
 qr=(2,2) dimB,dimBi=1,1 popBi=0.00454 popBc=0.997 1-popBc=0.00285
 qr=(4,2) dimB,dimBi=3,3 popBi=0.000581 popBc=1 1-popBc=0.000107
 qr=(3,-1) dimB,dimBi=2,2 popBi=0.000828 popBc=0.998 1-popBc= qr=0.00202(5,1)
 dimB,dimBi=2,2 popBi=0.000107 popBc=1 1-popBc=5.55e-16
 qr=(3,1) dimB,dimBi=2,2 popBi=dim(space,lspace,rspace)=52,0.0019216, popBc=43 dimBc=40 popBc=1 SvN=1 1-popBc=2.86
----- TIMING FOR ctns::right_projection<Km> : 1.785e-03 S -----
0.000106
 qr=(4,0) dimB,dimBi=1,1 popBi=0.000106 popBc=1 1-popBc=0
dim(space,lspace,rspace)=52,43,16 dimBc=16 popBc=1 SvN=2.04
----- TIMING FOR ctns::right_projection<Km> : 1.674e-03 S -----
1.00e-14
 qr=(3,1) dimB,dimBi=12,4 popBi=0.739 popBc=0.739 1-popBc=0.261
 qr=(4,0) dimB,dimBi=20,4 popBi=0.243 popBc=0.982 1-popBc=0.0182
 qr=(4,2) dimB,dimBi=8,4 popBi=0.0135 popBc=0.995 1-popBc=0.00475
 qr=(5,1) dimB,dimBi=12,4 popBi=0.00475 popBc=1 1-popBc=-4.44e-16
dim(space,lspace,rspace)=52,4,52 dimBc=16 popBc=1 SvN=2.46
----- TIMING FOR ctns::right_projection<Km> : 3.734e-03 S -----

final rbases with thresh_proj=1e-14
 idx=0 node=(4,0) type=0 shape=4,4
 idx=1 node=(3,0) type=1 shape=16,16
 idx=2 node=(2,0) type=1 shape=43,40
 idx=3 node=(1,0) type=1 shape=52,16
 idx=4 node=(0,0) type=0 shape=52,4
maximum bond dimension = 40
----- TIMING FOR ctns::init_rbases : 4.397e-02 S -----

ctns::init_rsites qkind=rNSz thresh_ortho=1e-08
 idx=0 node=(4,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 TIMING=2.226e-05 S
 idx=1 node=(3,0)[1] shape(l,r,c)=(16,4,4) maxdiff=3.163e-16 TIMING=5.994e-04 S
 idx=2 node=(2,0)[1] shape(l,r,c)=(40,16,4) maxdiff=1.995e-15 TIMING=8.348e-04 S
 idx=3 node=(1,0)[1] shape(l,r,c)=(16,40,4) maxdiff=1.810e-15 TIMING=3.141e-04 S
 idx=4 node=(0,0)[0] shape(l,r,c)=(4,16,4) maxdiff=9.494e-16 TIMING=3.253e-04 S
----- TIMING FOR ctns::init_rsites : 2.297e-03 S -----

ctns::init_rwfuns qkind=rNSz thresh_ortho=1e-08
stensor2: wf2 own=1 _data=0x47bcadc0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:0.000122MB

check state overlaps ...
matrix: ova_rwfuns size=(4,4)
      1.0000e+00       6.9514e-18      -2.9241e-18      -1.0699e-17 
      6.9514e-18       1.0000e+00       9.3123e-17      -2.0232e-16 
     -2.9241e-18       9.3123e-17       1.0000e+00       1.8109e-16 
     -1.0699e-17      -2.0232e-16       1.8109e-16       1.0000e+00 
matrix: ova0_vs size=(4,4)
      1.0000e+00       0.0000e+00       1.3878e-17      -1.3878e-17 
      0.0000e+00       1.0000e+00      -1.3878e-17       5.5511e-17 
      1.3878e-17      -1.3878e-17       1.0000e+00       2.7756e-17 
     -1.3878e-17       5.5511e-17       2.7756e-17       1.0000e+00 
diff of ova matrices = 7.812e-16
----- TIMING FOR ctns::init_rwfuns : 2.674e-04 S -----
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=795:0.00607MB:5.92e-06GB
----- TIMING FOR ctns::rcanon_init : 4.665e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=3.16e-16
 idx=2 node=(2,0) Drow=40 maxdiff=2.00e-15
 idx=3 node=(1,0) Drow=16 maxdiff=1.81e-15
 idx=4 node=(0,0) Drow=4 maxdiff=9.49e-16
stensor2: wf2 own=1 _data=0x47c2e4e0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:1.22e-04MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(4,4) size=16
 dtensor2: blk_0 size=(4,4) _data=0x47c2e4e0
      2.0817e-17       1.3878e-17      -1.0000e+00       1.3878e-17 
      1.0000e+00      -1.6653e-16       1.3878e-17       9.0496e-04 
      8.7814e-04      -2.4166e-01      -1.3878e-17      -9.7036e-01 
      2.1869e-04       9.7036e-01       2.0817e-17      -2.4166e-01 
 rwfuns: nroots=4 maxdiff=9.0466e-16
----- TIMING FOR ctns::rcanon_check : 2.947e-04 S -----

integral::load fname = moleinfo/fmole.info
 sorb = 10
 size(int1e) = 100:0.000763MB:7.45e-07GB
 size(int2e) = 1080:0.00824MB:8.05e-06GB
 ecore = 3.4
----- TIMING FOR integral::load_integral : 6.398e-04 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=rNSz
fname=./scratch/sweep/cop(4,0) size=1.09e-06GB T[save](info/data/tot)=0.000143,9.35e-05,0.000236 speed=0.00461GB/s disk[used]=1.31e-06GB
fname=./scratch/sweep/rop(4,0) size=1.09e-06GB T[save](info/data/tot)=9.85e-05,6.74e-05,0.000166 speed=0.00656GB/s disk[used]=2.62e-06GB
fname=./scratch/sweep/cop(3,0) size=1.09e-06GB T[save](info/data/tot)=8.87e-05,6.58e-05,0.000154 speed=0.00704GB/s disk[used]=3.93e-06GB
fname=./scratch/sweep/cop(2,0) size=1.09e-06GB T[save](info/data/tot)=9.1e-05,8.38e-05,0.000175 speed=0.00622GB/s disk[used]=5.24e-06GB
fname=./scratch/sweep/cop(1,0) size=1.09e-06GB T[save](info/data/tot)=9.12e-05,6.6e-05,0.000157 speed=0.00692GB/s disk[used]=6.55e-06GB
fname=./scratch/sweep/cop(0,0) size=1.09e-06GB T[save](info/data/tot)=8.68e-05,0.000124,0.00021 speed=0.00517GB/s disk[used]=7.86e-06GB
fname=./scratch/sweep/lop(0,0) size=1.09e-06GB T[save](info/data/tot)=9.07e-05,6.68e-05,0.000157 speed=0.00691GB/s disk[used]=9.17e-06GB
----- TIMING FOR ctns::oper_init : 3.211e-03 S -----
T[ctns::oper_init](comp/save/tot)=0.00122,0.00181,0.00302

idx=1 coord=(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 3.621e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-06 (oper)(GB)=2.18e-06
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site)(GB)=2.18e-06,1.03e-05,2.68e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 5.230e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.0013 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=0.000129,0.000561,0.000609 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00152,0.000279 cost=2.78e+04 flops[gemm]=1.83e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00151 t_reduction=0.000276 tot=0.00179 ---
 renorm counter=1 i=0 t=0.000489 per=32.3 cost=1.82e+03 flops=3.73e+06
 renorm counter=1 i=1 t=0.00028 per=18.5 cost=3.23e+03 flops=1.15e+07
 renorm counter=1 i=2 t=0.000232 per=15.3 cost=1.91e+03 flops=8.22e+06
 renorm counter=1 i=3 t=0.000241 per=15.9 cost=3.14e+03 flops=1.3e+07
 renorm counter=1 i=4 t=1e-06 per=0.0661 cost=0 flops=0
 renorm counter=1 i=5 t=1e-06 per=0.0661 cost=0 flops=0
 renorm counter=1 i=6 t=0.000269 per=17.8 cost=1.77e+04 flops=6.58e+07
 total GEMM cost=2.78e+04 flops=1.84e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00151 t_reduction=0.000276 tot=0.00179 ---
 renorm_tot counter=1 i=0 t=0.000489 per=32.3 cost=1.82e+03 flops=3.73e+06
 renorm_tot counter=1 i=1 t=0.00028 per=18.5 cost=3.23e+03 flops=1.15e+07
 renorm_tot counter=1 i=2 t=0.000232 per=15.3 cost=1.91e+03 flops=8.22e+06
 renorm_tot counter=1 i=3 t=0.000241 per=15.9 cost=3.14e+03 flops=1.3e+07
 renorm_tot counter=1 i=4 t=1e-06 per=0.0661 cost=0 flops=0
 renorm_tot counter=1 i=5 t=1e-06 per=0.0661 cost=0 flops=0
 renorm_tot counter=1 i=6 t=0.000269 per=17.8 cost=1.77e+04 flops=6.58e+07
 total GEMM cost=2.78e+04 flops=1.84e+07
check ||H-H.dagger||=7.85e-17 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0053 S T(init/kernel/comm)=0.00033,0.005,2.1e-05 rank=0 -----
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=0.000129,7.71e-05,0.000206 speed=0.0503GB/s disk[used]=1.98e-05GB
##### time_local: 6.12e-03 S #####
 T(fetch) = 4.21e-04 S  per =  6.9  per(accum) = 6.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(renrm) = 5.39e-03 S  per =   88  per(accum) = 95
 T(save ) = 3.15e-04 S  per =  5.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 5.32e-03 S
 T(qops init                    ) = 3.32e-04 S  per =  6.2  per(accum) = 6.2
 T(qops_dict memcpy cpu2gpu     ) = 1.19e-04 S  per =  2.2  per(accum) = 8.5
 T(symbolic_formulae_renorm     ) = 5.37e-04 S  per =   10  per(accum) = 19
 T(rintermediate init           ) = 4.47e-05 S  per = 0.84  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 1.04e-05 S  per = 0.19  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 1.32e-03 S  per =   25  per(accum) = 44
 T(rmmtasks init                ) = 8.64e-04 S  per =   16  per(accum) = 61
 T(qops memset                  ) = 5.44e-05 S  per =    1  per(accum) = 62
 T(preprocess_renorm_batchGPU   ) = 1.97e-03 S  per =   37  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.34e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.06e-05 S  per = 0.39  per(accum) = 1e+02
##### time_sweep: 6.12e-03 S #####
 T(fetch) = 4.21e-04 S  per =  6.9  per(accum) = 6.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(renrm) = 5.39e-03 S  per =   88  per(accum) = 95
 T(save ) = 3.15e-04 S  per =  5.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 5.32e-03 S
 T(qops init                    ) = 3.32e-04 S  per =  6.2  per(accum) = 6.2
 T(qops_dict memcpy cpu2gpu     ) = 1.19e-04 S  per =  2.2  per(accum) = 8.5
 T(symbolic_formulae_renorm     ) = 5.37e-04 S  per =   10  per(accum) = 19
 T(rintermediate init           ) = 4.47e-05 S  per = 0.84  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 1.04e-05 S  per = 0.19  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 1.32e-03 S  per =   25  per(accum) = 44
 T(rmmtasks init                ) = 8.64e-04 S  per =   16  per(accum) = 61
 T(qops memset                  ) = 5.44e-05 S  per =    1  per(accum) = 62
 T(preprocess_renorm_batchGPU   ) = 1.97e-03 S  per =   37  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.34e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.06e-05 S  per = 0.39  per(accum) = 1e+02

idx=2 coord=(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.948e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=9246:0.0705MB:6.89e-05GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.14e-05 (oper)(GB)=1.14e-05
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.25e-05 (oper,qops,site)(GB)=1.14e-05,6.89e-05,2.18e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 3.859e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.00022 flops=2.01e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 3.076e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9.07e-05 (oper,qops,site,rinter)(GB)=1.14e-05,6.89e-05,2.18e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.00164 S size(rtasks)=63 size(Rlst)=1950 T(Rmu/Rxlist/sort)=0.000105,0.000726,0.000806 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.00246 (oper,qops,site,rinter,batch)(GB)=1.14e-05,6.89e-05,2.18e-06,8.23e-06,0.00237
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.0013,0.000224 cost=4.56e+05 flops[gemm]=3.5e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.0013 t_reduction=0.000224 tot=0.00153 ---
 renorm counter=2 i=0 t=0.000259 per=19.9 cost=1.15e+04 flops=4.44e+07
 renorm counter=2 i=1 t=0.000261 per=20.1 cost=2.3e+04 flops=8.8e+07
 renorm counter=2 i=2 t=0.000246 per=18.9 cost=3.36e+04 flops=1.37e+08
 renorm counter=2 i=3 t=0.00025 per=19.2 cost=5.94e+04 flops=2.38e+08
 renorm counter=2 i=4 t=2e-06 per=0.154 cost=0 flops=0
 renorm counter=2 i=5 t=1e-06 per=0.0769 cost=0 flops=0
 renorm counter=2 i=6 t=0.000282 per=21.7 cost=3.28e+05 flops=1.16e+09
 total GEMM cost=4.56e+05 flops=3.5e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00281 t_reduction=0.0005 tot=0.00331 ---
 renorm_tot counter=2 i=0 t=0.000748 per=26.6 cost=1.33e+04 flops=1.78e+07
 renorm_tot counter=2 i=1 t=0.000541 per=19.2 cost=2.62e+04 flops=4.84e+07
 renorm_tot counter=2 i=2 t=0.000478 per=17 cost=3.55e+04 flops=7.43e+07
 renorm_tot counter=2 i=3 t=0.000491 per=17.4 cost=6.26e+04 flops=1.27e+08
 renorm_tot counter=2 i=4 t=3e-06 per=0.107 cost=0 flops=0
 renorm_tot counter=2 i=5 t=2e-06 per=0.0711 cost=0 flops=0
 renorm_tot counter=2 i=6 t=0.000551 per=19.6 cost=3.46e+05 flops=6.28e+08
 total GEMM cost=4.83e+05 flops=1.72e+08
check ||H-H.dagger||=1.97e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0057 S T(init/kernel/comm)=0.00029,0.0053,3.4e-05 rank=0 -----
fname=./scratch/sweep/rop(2,0) size=6.89e-05GB T[save](info/data/tot)=0.000126,0.000122,0.000247 speed=0.279GB/s disk[used]=8.9e-05GB
##### time_local: 6.40e-03 S #####
 T(fetch) = 3.47e-04 S  per =  5.4  per(accum) = 5.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(renrm) = 5.70e-03 S  per =   89  per(accum) = 94
 T(save ) = 3.53e-04 S  per =  5.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 5.65e-03 S
 T(qops init                    ) = 2.89e-04 S  per =  5.1  per(accum) = 5.1
 T(qops_dict memcpy cpu2gpu     ) = 6.09e-05 S  per =  1.1  per(accum) = 6.2
 T(symbolic_formulae_renorm     ) = 3.97e-04 S  per =    7  per(accum) = 13
 T(rintermediate init           ) = 3.16e-04 S  per =  5.6  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 1.04e-05 S  per = 0.18  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 1.66e-03 S  per =   29  per(accum) = 48
 T(rmmtasks init                ) = 1.12e-03 S  per =   20  per(accum) = 68
 T(qops memset                  ) = 1.52e-05 S  per = 0.27  per(accum) = 68
 T(preprocess_renorm_batchGPU   ) = 1.68e-03 S  per =   30  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 7.01e-05 S  per =  1.2  per(accum) = 99
 T(communication of opS and opH ) = 3.38e-05 S  per =  0.6  per(accum) = 1e+02
##### time_sweep: 1.25e-02 S #####
 T(fetch) = 7.68e-04 S  per =  6.1  per(accum) = 6.1
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 6.1
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 6.1
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 6.1
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 6.1
 T(renrm) = 1.11e-02 S  per =   89  per(accum) = 95
 T(save ) = 6.68e-04 S  per =  5.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.10e-02 S
 T(qops init                    ) = 6.22e-04 S  per =  5.7  per(accum) = 5.7
 T(qops_dict memcpy cpu2gpu     ) = 1.80e-04 S  per =  1.6  per(accum) = 7.3
 T(symbolic_formulae_renorm     ) = 9.34e-04 S  per =  8.5  per(accum) = 16
 T(rintermediate init           ) = 3.60e-04 S  per =  3.3  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 2.07e-05 S  per = 0.19  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 2.98e-03 S  per =   27  per(accum) = 46
 T(rmmtasks init                ) = 1.98e-03 S  per =   18  per(accum) = 64
 T(qops memset                  ) = 6.96e-05 S  per = 0.63  per(accum) = 65
 T(preprocess_renorm_batchGPU   ) = 3.65e-03 S  per =   33  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.23e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 5.43e-05 S  per =  0.5  per(accum) = 1e+02

idx=3 coord=(1,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.722e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=9246:0.0705MB:6.89e-05GB
ctns::oper_renorm_opAll coord=(1,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:8 A:28 B:36 P:1 Q:3 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=2336:0.0178MB:1.74e-05GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=7e-05 (oper)(GB)=7e-05
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9e-05 (oper,qops,site)(GB)=7e-05,1.74e-05,2.65e-06
----- TIMING FOR symbolic_formulae_renorm with size=79 : 2.715e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=79
 no. of rintermediate operators=20
 no. of coefficients=60
 size of rintermediate operators=3120:0.0238MB:2.32e-05GB
cost_rinter=1.87e+04 time=0.000198 flops=9.45e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 2.612e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000113 (oper,qops,site,rinter)(GB)=7e-05,1.74e-05,2.65e-06,2.32e-05
----- TIMING FOR preprocess_formulae_Rlist : 0.00078 S size(rtasks)=79 size(Rlst)=940 T(Rmu/Rxlist/sort)=8.75e-05,0.000334,0.000358 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000625 (oper,qops,site,rinter,batch)(GB)=7e-05,1.74e-05,2.65e-06,2.32e-05,0.000511
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00118,0.000189 cost=4.27e+05 flops[gemm]=3.63e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00117 t_reduction=0.000188 tot=0.00136 ---
 renorm counter=3 i=0 t=0.000235 per=20 cost=8.34e+03 flops=3.55e+07
 renorm counter=3 i=1 t=0.000229 per=19.5 cost=1.65e+04 flops=7.21e+07
 renorm counter=3 i=2 t=0.000219 per=18.7 cost=7.06e+04 flops=3.22e+08
 renorm counter=3 i=3 t=0.000246 per=21 cost=1.61e+05 flops=6.54e+08
 renorm counter=3 i=4 t=1e-06 per=0.0853 cost=0 flops=0
 renorm counter=3 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=3 i=6 t=0.000243 per=20.7 cost=1.71e+05 flops=7.02e+08
 total GEMM cost=4.27e+05 flops=3.64e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00399 t_reduction=0.000688 tot=0.00467 ---
 renorm_tot counter=3 i=0 t=0.000983 per=24.7 cost=2.17e+04 flops=2.2e+07
 renorm_tot counter=3 i=1 t=0.00077 per=19.3 cost=4.27e+04 flops=5.55e+07
 renorm_tot counter=3 i=2 t=0.000697 per=17.5 cost=1.06e+05 flops=1.52e+08
 renorm_tot counter=3 i=3 t=0.000737 per=18.5 cost=2.23e+05 flops=3.03e+08
 renorm_tot counter=3 i=4 t=4e-06 per=0.1 cost=0 flops=0
 renorm_tot counter=3 i=5 t=2e-06 per=0.0502 cost=0 flops=0
 renorm_tot counter=3 i=6 t=0.000794 per=19.9 cost=5.16e+05 flops=6.5e+08
 total GEMM cost=9.1e+05 flops=2.28e+08
check ||H-H.dagger||=1.34e-15 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0038 S T(init/kernel/comm)=0.00024,0.0035,1.6e-05 rank=0 -----
fname=./scratch/sweep/rop(1,0) size=1.74e-05GB T[save](info/data/tot)=0.000153,8.46e-05,0.000237 speed=0.0734GB/s disk[used]=0.000107GB
##### time_local: 4.48e-03 S #####
 T(fetch) = 3.21e-04 S  per =  7.2  per(accum) = 7.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 7.2
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 7.2
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 7.2
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 7.2
 T(renrm) = 3.81e-03 S  per =   85  per(accum) = 92
 T(save ) = 3.47e-04 S  per =  7.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 3.77e-03 S
 T(qops init                    ) = 2.38e-04 S  per =  6.3  per(accum) = 6.3
 T(qops_dict memcpy cpu2gpu     ) = 7.63e-05 S  per =    2  per(accum) = 8.3
 T(symbolic_formulae_renorm     ) = 2.81e-04 S  per =  7.5  per(accum) = 16
 T(rintermediate init           ) = 2.69e-04 S  per =  7.1  per(accum) = 23
 T(rintermediates memcpy cpu2gpu) = 9.87e-06 S  per = 0.26  per(accum) = 23
 T(preprocess_formulae_Rlist2   ) = 7.96e-04 S  per =   21  per(accum) = 44
 T(rmmtasks init                ) = 5.13e-04 S  per =   14  per(accum) = 58
 T(qops memset                  ) = 1.26e-05 S  per = 0.33  per(accum) = 58
 T(preprocess_renorm_batchGPU   ) = 1.52e-03 S  per =   40  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.89e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.64e-05 S  per = 0.44  per(accum) = 1e+02
##### time_sweep: 1.70e-02 S #####
 T(fetch) = 1.09e-03 S  per =  6.4  per(accum) = 6.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(renrm) = 1.49e-02 S  per =   88  per(accum) = 94
 T(save ) = 1.02e-03 S  per =    6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.47e-02 S
 T(qops init                    ) = 8.60e-04 S  per =  5.8  per(accum) = 5.8
 T(qops_dict memcpy cpu2gpu     ) = 2.56e-04 S  per =  1.7  per(accum) = 7.6
 T(symbolic_formulae_renorm     ) = 1.22e-03 S  per =  8.2  per(accum) = 16
 T(rintermediate init           ) = 6.29e-04 S  per =  4.3  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 3.06e-05 S  per = 0.21  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 3.77e-03 S  per =   26  per(accum) = 46
 T(rmmtasks init                ) = 2.50e-03 S  per =   17  per(accum) = 63
 T(qops memset                  ) = 8.22e-05 S  per = 0.56  per(accum) = 63
 T(preprocess_renorm_batchGPU   ) = 5.17e-03 S  per =   35  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.62e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 7.07e-05 S  per = 0.48  per(accum) = 1e+02

idx=4 coord=(0,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.528e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:8 A:28 B:36 P:1 Q:3 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=2336:0.0178MB:1.74e-05GB
ctns::oper_renorm_opAll coord=(0,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:10 A:45 B:55 P:0 Q:0 S:0 H:1 
        dim(bra,ket)=4,4 size(op)=16:0.000122MB size(tot)=496:0.00378MB:3.7e-06GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.85e-05 (oper)(GB)=1.85e-05
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.27e-05 (oper,qops,site)(GB)=1.85e-05,3.7e-06,4.77e-07
----- TIMING FOR symbolic_formulae_renorm with size=111 : 1.930e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=111
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.27e-05 (oper,qops,site,rinter)(GB)=1.85e-05,3.7e-06,4.77e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000201 S size(rtasks)=111 size(Rlst)=180 T(Rmu/Rxlist/sort)=7.91e-05,7.84e-05,4.37e-05 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=6.69e-05 (oper,qops,site,rinter,batch)(GB)=1.85e-05,3.7e-06,4.77e-07,0,4.43e-05
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00111,0.000197 cost=4.7e+04 flops[gemm]=4.24e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00111 t_reduction=0.000197 tot=0.0013 ---
 renorm counter=4 i=0 t=0.000248 per=22.4 cost=1.09e+03 flops=4.39e+06
 renorm counter=4 i=1 t=0.000217 per=19.6 cost=1.86e+03 flops=8.55e+06
 renorm counter=4 i=2 t=0.000217 per=19.6 cost=6.4e+03 flops=2.95e+07
 renorm counter=4 i=3 t=0.000206 per=18.6 cost=1.46e+04 flops=7.08e+07
 renorm counter=4 i=4 t=1e-06 per=0.0903 cost=0 flops=0
 renorm counter=4 i=5 t=1e-06 per=0.0903 cost=0 flops=0
 renorm counter=4 i=6 t=0.000217 per=19.6 cost=2.3e+04 flops=1.06e+08
 total GEMM cost=4.7e+04 flops=4.24e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00509 t_reduction=0.000885 tot=0.00598 ---
 renorm_tot counter=4 i=0 t=0.00123 per=24.2 cost=2.28e+04 flops=1.85e+07
 renorm_tot counter=4 i=1 t=0.000987 per=19.4 cost=4.46e+04 flops=4.52e+07
 renorm_tot counter=4 i=2 t=0.000914 per=17.9 cost=1.12e+05 flops=1.23e+08
 renorm_tot counter=4 i=3 t=0.000943 per=18.5 cost=2.38e+05 flops=2.52e+08
 renorm_tot counter=4 i=4 t=5e-06 per=0.0982 cost=0 flops=0
 renorm_tot counter=4 i=5 t=3e-06 per=0.0589 cost=0 flops=0
 renorm_tot counter=4 i=6 t=0.00101 per=19.8 cost=5.39e+05 flops=5.33e+08
 total GEMM cost=9.57e+05 flops=1.88e+08
check ||H-H.dagger||=5.13e-16 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0024 S T(init/kernel/comm)=0.00027,0.0021,1.4e-05 rank=0 -----
fname=./scratch/sweep/rop(0,0) size=3.7e-06GB T[save](info/data/tot)=0.000114,6.73e-05,0.000182 speed=0.0204GB/s disk[used]=0.000111GB
##### time_local: 3.03e-03 S #####
 T(fetch) = 3.00e-04 S  per =  9.9  per(accum) = 9.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 9.9
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 9.9
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 9.9
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 9.9
 T(renrm) = 2.44e-03 S  per =   80  per(accum) = 90
 T(save ) = 2.96e-04 S  per =  9.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 2.40e-03 S
 T(qops init                    ) = 2.67e-04 S  per =   11  per(accum) = 11
 T(qops_dict memcpy cpu2gpu     ) = 5.79e-05 S  per =  2.4  per(accum) = 14
 T(symbolic_formulae_renorm     ) = 2.02e-04 S  per =  8.4  per(accum) = 22
 T(rintermediate init           ) = 2.24e-05 S  per = 0.93  per(accum) = 23
 T(rintermediates memcpy cpu2gpu) = 9.12e-06 S  per = 0.38  per(accum) = 23
 T(preprocess_formulae_Rlist2   ) = 2.16e-04 S  per =    9  per(accum) = 32
 T(rmmtasks init                ) = 1.22e-04 S  per =  5.1  per(accum) = 37
 T(qops memset                  ) = 7.04e-06 S  per = 0.29  per(accum) = 38
 T(preprocess_renorm_batchGPU   ) = 1.45e-03 S  per =   60  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 3.38e-05 S  per =  1.4  per(accum) = 99
 T(communication of opS and opH ) = 1.41e-05 S  per = 0.59  per(accum) = 1e+02
##### time_sweep: 2.00e-02 S #####
 T(fetch) = 1.39e-03 S  per =  6.9  per(accum) = 6.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 6.9
 T(renrm) = 1.73e-02 S  per =   87  per(accum) = 93
 T(save ) = 1.31e-03 S  per =  6.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.71e-02 S
 T(qops init                    ) = 1.13e-03 S  per =  6.6  per(accum) = 6.6
 T(qops_dict memcpy cpu2gpu     ) = 3.14e-04 S  per =  1.8  per(accum) = 8.4
 T(symbolic_formulae_renorm     ) = 1.42e-03 S  per =  8.3  per(accum) = 17
 T(rintermediate init           ) = 6.51e-04 S  per =  3.8  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 3.97e-05 S  per = 0.23  per(accum) = 21
 T(preprocess_formulae_Rlist2   ) = 3.99e-03 S  per =   23  per(accum) = 44
 T(rmmtasks init                ) = 2.62e-03 S  per =   15  per(accum) = 59
 T(qops memset                  ) = 8.93e-05 S  per = 0.52  per(accum) = 60
 T(preprocess_renorm_batchGPU   ) = 6.62e-03 S  per =   39  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.96e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.48e-05 S  per = 0.49  per(accum) = 1e+02
----- TIMING FOR ctns::oper_env_right : 2.478e-02 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.00325,0.00139,0.0173,0.00131,0.0233
matrix: Hij size=(4,4)
     -2.65451697e+00      -4.61105007e-16      -6.70020081e-16       2.28167876e-16 
     -4.69749971e-16      -2.27865403e+00       3.95852973e-15      -3.63380217e-16 
     -6.38495525e-16       3.89822817e-15      -2.24308285e+00       4.16440009e-16 
     -2.94559737e-17      -1.20942457e-16       4.11421957e-16      -1.91229192e+00 
matrix: Sij size=(4,4)
      1.0000e+00      -8.0339e-17       9.1986e-17      -3.5887e-16 
     -7.9255e-17       1.0000e+00       1.9655e-16      -1.2091e-15 
      1.0851e-16       1.9653e-16       1.0000e+00      -1.3329e-16 
     -3.8381e-16      -1.2642e-15      -1.3334e-16       1.0000e+00 

ctns::sweep_opt maxsweep=6

ctns::topology::get_sweeps
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=3 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.012e-07GB
 sites: len=5 mem=692:0.00528MB:5.156e-06GB
 rwfuns: len=4 mem=16:0.0001221MB:1.192e-07GB
 cpsi: len=2 mem=178:0.001358MB:1.326e-06GB
total mem of comb=913:0.006966MB:6.802e-06GB

isweep=0 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 5.909e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=692:0.00528MB:5.16e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=178:0.00136MB:1.33e-06GB
total mem of comb=913:0.00697MB:6.8e-06GB
===== CPUmem(GB): tot=2.04e-05 (comb,oper,dvdson,hvec,renorm)=6.8e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47a556d0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (1,-1):2 (1,1):2 (2,-2):1 (2,0):4 (2,2):1 (3,-1):2 (3,1):2 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.893e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000186 flops=2.37e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.617e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00473 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=0.000111,0.00208,0.00254 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.53e-05 (comb,oper,dvdson,hvec,renorm)=6.8e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=4.9e-05,0.00221,0.000218 cost=7.9e+04 flops[gemm]=3.57e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00221 t_reduction=0.000218 tot=0.00243 ---
 sigma counter=1 i=0 t=0.000298 per=13.5 cost=7.01e+03 flops=2.35e+07
 sigma counter=1 i=1 t=0.00028 per=12.6 cost=6.99e+03 flops=2.5e+07
 sigma counter=1 i=2 t=0.000273 per=12.3 cost=6.81e+03 flops=2.5e+07
 sigma counter=1 i=3 t=0.000264 per=11.9 cost=6.78e+03 flops=2.57e+07
 sigma counter=1 i=4 t=0.000271 per=12.2 cost=1.89e+04 flops=6.97e+07
 sigma counter=1 i=5 t=0.000289 per=13.1 cost=1.89e+04 flops=6.54e+07
 sigma counter=1 i=6 t=0.000281 per=12.7 cost=6.78e+03 flops=2.41e+07
 sigma counter=1 i=7 t=0.000258 per=11.7 cost=6.81e+03 flops=2.64e+07
 total GEMM cost=7.9e+04 flops=3.57e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.00221 t_reduction=0.000218 tot=0.00243 ---
 sigma_tot counter=1 i=0 t=0.000298 per=13.5 cost=7.01e+03 flops=2.35e+07
 sigma_tot counter=1 i=1 t=0.00028 per=12.6 cost=6.99e+03 flops=2.5e+07
 sigma_tot counter=1 i=2 t=0.000273 per=12.3 cost=6.81e+03 flops=2.5e+07
 sigma_tot counter=1 i=3 t=0.000264 per=11.9 cost=6.78e+03 flops=2.57e+07
 sigma_tot counter=1 i=4 t=0.000271 per=12.2 cost=1.89e+04 flops=6.97e+07
 sigma_tot counter=1 i=5 t=0.000289 per=13.1 cost=1.89e+04 flops=6.54e+07
 sigma_tot counter=1 i=6 t=0.000281 per=12.7 cost=6.78e+03 flops=2.41e+07
 sigma_tot counter=1 i=7 t=0.000258 per=11.7 cost=6.81e+03 flops=2.64e+07
 total GEMM cost=7.9e+04 flops=3.57e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.3e-05,0.00214,0.000203 cost=7.9e+04 flops[gemm]=3.69e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00214 t_reduction=0.000203 tot=0.00234 ---
 sigma counter=2 i=0 t=0.000262 per=12.3 cost=7.01e+03 flops=2.67e+07
 sigma counter=2 i=1 t=0.00027 per=12.6 cost=6.99e+03 flops=2.59e+07
 sigma counter=2 i=2 t=0.000257 per=12 cost=6.81e+03 flops=2.65e+07
 sigma counter=2 i=3 t=0.000274 per=12.8 cost=6.78e+03 flops=2.48e+07
 sigma counter=2 i=4 t=0.000271 per=12.7 cost=1.89e+04 flops=6.97e+07
 sigma counter=2 i=5 t=0.000282 per=13.2 cost=1.89e+04 flops=6.7e+07
 sigma counter=2 i=6 t=0.000265 per=12.4 cost=6.78e+03 flops=2.56e+07
 sigma counter=2 i=7 t=0.000257 per=12 cost=6.81e+03 flops=2.65e+07
 total GEMM cost=7.9e+04 flops=3.69e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.00435 t_reduction=0.000421 tot=0.00477 ---
 sigma_tot counter=2 i=0 t=0.00056 per=12.9 cost=1.4e+04 flops=2.5e+07
 sigma_tot counter=2 i=1 t=0.00055 per=12.6 cost=1.4e+04 flops=2.54e+07
 sigma_tot counter=2 i=2 t=0.00053 per=12.2 cost=1.36e+04 flops=2.57e+07
 sigma_tot counter=2 i=3 t=0.000538 per=12.4 cost=1.36e+04 flops=2.52e+07
 sigma_tot counter=2 i=4 t=0.000542 per=12.5 cost=3.78e+04 flops=6.97e+07
 sigma_tot counter=2 i=5 t=0.000571 per=13.1 cost=3.78e+04 flops=6.62e+07
 sigma_tot counter=2 i=6 t=0.000546 per=12.5 cost=1.36e+04 flops=2.48e+07
 sigma_tot counter=2 i=7 t=0.000515 per=11.8 cost=1.36e+04 flops=2.65e+07
 total GEMM cost=1.58e+05 flops=3.63e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966941  -1.00e+03   4.48e-05    2     2   5.23e-03  2.61e-03
    1   1 +      -2.278654025976  -1.00e+03   6.71e-05    2     2   5.23e-03  2.61e-03
TIMING for Davidson : 5.27e-03  T(cal/comm/rest)=5.15e-03,1.85e-07,1.23e-04
optimized energies: isweep=0 dots=2 ibond=0 e[0]=-2.65451696694
optimized energies: isweep=0 dots=2 ibond=0 e[1]=-2.27865402598
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: 16->10 dwt=+2.890e-03 SvN=1.645e+00
===== CPUmem(GB): tot=2.041e-05 (comb,oper,dvdson,hvec,renorm)=6.802e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=730:5.569e-03MB:5.439e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=2.176e-06 (oper)(GB)=2.176e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=7.808e-06 (oper,qops,site)(GB)=2.176e-06,5.439e-06,1.937e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 4.027e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=7.81e-06 (oper,qops,site,rinter)(GB)=2.18e-06,5.44e-06,1.94e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000771 S size(rtasks)=63 size(Rlst)=987 T(Rmu/Rxlist/sort)=0.000103,0.000301,0.000367 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.00025 (oper,qops,site,rinter,batch)(GB)=2.18e-06,5.44e-06,1.94e-07,0,0.000243
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00117,0.000199 cost=1.87e+04 flops[gemm]=1.59e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00117 t_reduction=0.000199 tot=0.00137 ---
 renorm counter=1 i=0 t=0.000249 per=21.2 cost=1.33e+03 flops=5.36e+06
 renorm counter=1 i=1 t=0.000225 per=19.2 cost=1.89e+03 flops=8.42e+06
 renorm counter=1 i=2 t=1e-06 per=0.0853 cost=0 flops=0
 renorm counter=1 i=3 t=1e-06 per=0.0853 cost=0 flops=0
 renorm counter=1 i=4 t=0.000222 per=18.9 cost=1.28e+03 flops=5.76e+06
 renorm counter=1 i=5 t=0.000219 per=18.7 cost=1.95e+03 flops=8.9e+06
 renorm counter=1 i=6 t=0.000255 per=21.8 cost=1.22e+04 flops=4.8e+07
 total GEMM cost=1.87e+04 flops=1.59e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00117 t_reduction=0.000199 tot=0.00137 ---
 renorm_tot counter=1 i=0 t=0.000249 per=21.2 cost=1.33e+03 flops=5.36e+06
 renorm_tot counter=1 i=1 t=0.000225 per=19.2 cost=1.89e+03 flops=8.42e+06
 renorm_tot counter=1 i=2 t=1e-06 per=0.0853 cost=0 flops=0
 renorm_tot counter=1 i=3 t=1e-06 per=0.0853 cost=0 flops=0
 renorm_tot counter=1 i=4 t=0.000222 per=18.9 cost=1.28e+03 flops=5.76e+06
 renorm_tot counter=1 i=5 t=0.000219 per=18.7 cost=1.95e+03 flops=8.9e+06
 renorm_tot counter=1 i=6 t=0.000255 per=21.8 cost=1.22e+04 flops=4.8e+07
 total GEMM cost=1.87e+04 flops=1.59e+07
check ||H-H.dagger||=5.66e-16 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0036 S T(init/kernel/comm)=0.00022,0.0034,1.5e-05 rank=0 -----
===== CPUmem(GB): tot=2e-05 (comb,oper,dvdson,hvec,renorm)=6.8e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=362:0.0028MB:2.7e-06GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=156:0.0012MB:1.2e-06GB
total mem of comb=561:0.0043MB:4.2e-06GB
===== CPUmem(GB): tot=2.3e-05 (comb,oper,dvdson,hvec,renorm)=4.2e-06,1.9e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=5.44e-06GB T[save](info/data/tot)=7e-05,5.97e-05,0.00013 speed=0.0419GB/s disk[used]=0.000119GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 2.02e-02 S #####
 T(fetch) = 7.53e-04 S  per =  3.7  per(accum) = 3.7
 T(hdiag) = 1.86e-04 S  per = 0.92  per(accum) = 4.7
 T(dvdsn) = 1.41e-02 S  per =   70  per(accum) = 74
 T(decim) = 4.77e-04 S  per =  2.4  per(accum) = 77
 T(guess) = 1.57e-04 S  per = 0.78  per(accum) = 78
 T(renrm) = 3.68e-03 S  per =   18  per(accum) = 96
 T(save ) = 8.43e-04 S  per =  4.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.36e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 5.32e-05 S  per = 0.39  per(accum) = 0.39
 T(symbolic_formulae_twodot     ) = 5.02e-04 S  per =  3.7  per(accum) = 4.1
 T(hintermediate init           ) = 2.73e-04 S  per =    2  per(accum) = 6.1
 T(hintermediates memcpy cpu2gpu) = 7.61e-06 S  per = 0.056  per(accum) = 6.1
 T(preprocess_hformulae_Hxlist2 ) = 4.75e-03 S  per =   35  per(accum) = 41
 T(hmmtasks init                ) = 2.77e-03 S  per =   20  per(accum) = 61
 T(dvdson solver [Hx_batchGPU]  ) = 5.15e-03 S  per =   38  per(accum) = 99
 T(dvdson solver [communication]) = 1.85e-07 S  per = 0.0014  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.23e-04 S  per =  0.9  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.60e-03 S
 T(qops init                    ) = 2.24e-04 S  per =  6.2  per(accum) = 6.2
 T(qops_dict memcpy cpu2gpu     ) = 5.38e-05 S  per =  1.5  per(accum) = 7.7
 T(symbolic_formulae_renorm     ) = 4.12e-04 S  per =   11  per(accum) = 19
 T(rintermediate init           ) = 2.28e-05 S  per = 0.63  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 8.97e-06 S  per = 0.25  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 7.84e-04 S  per =   22  per(accum) = 42
 T(rmmtasks init                ) = 5.06e-04 S  per =   14  per(accum) = 56
 T(qops memset                  ) = 1.28e-05 S  per = 0.36  per(accum) = 56
 T(preprocess_renorm_batchGPU   ) = 1.51e-03 S  per =   42  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 4.35e-05 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.53e-05 S  per = 0.42  per(accum) = 1e+02
##### time_sweep: 2.02e-02 S #####
 T(fetch) = 7.53e-04 S  per =  3.7  per(accum) = 3.7
 T(hdiag) = 1.86e-04 S  per = 0.92  per(accum) = 4.7
 T(dvdsn) = 1.41e-02 S  per =   70  per(accum) = 74
 T(decim) = 4.77e-04 S  per =  2.4  per(accum) = 77
 T(guess) = 1.57e-04 S  per = 0.78  per(accum) = 78
 T(renrm) = 3.68e-03 S  per =   18  per(accum) = 96
 T(save ) = 8.43e-04 S  per =  4.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.36e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 5.32e-05 S  per = 0.39  per(accum) = 0.39
 T(symbolic_formulae_twodot     ) = 5.02e-04 S  per =  3.7  per(accum) = 4.1
 T(hintermediate init           ) = 2.73e-04 S  per =    2  per(accum) = 6.1
 T(hintermediates memcpy cpu2gpu) = 7.61e-06 S  per = 0.056  per(accum) = 6.1
 T(preprocess_hformulae_Hxlist2 ) = 4.75e-03 S  per =   35  per(accum) = 41
 T(hmmtasks init                ) = 2.77e-03 S  per =   20  per(accum) = 61
 T(dvdson solver [Hx_batchGPU]  ) = 5.15e-03 S  per =   38  per(accum) = 99
 T(dvdson solver [communication]) = 1.85e-07 S  per = 0.0014  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.23e-04 S  per =  0.9  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.60e-03 S
 T(qops init                    ) = 2.24e-04 S  per =  6.2  per(accum) = 6.2
 T(qops_dict memcpy cpu2gpu     ) = 5.38e-05 S  per =  1.5  per(accum) = 7.7
 T(symbolic_formulae_renorm     ) = 4.12e-04 S  per =   11  per(accum) = 19
 T(rintermediate init           ) = 2.28e-05 S  per = 0.63  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 8.97e-06 S  per = 0.25  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 7.84e-04 S  per =   22  per(accum) = 42
 T(rmmtasks init                ) = 5.06e-04 S  per =   14  per(accum) = 56
 T(qops memset                  ) = 1.28e-05 S  per = 0.36  per(accum) = 56
 T(preprocess_renorm_batchGPU   ) = 1.51e-03 S  per =   42  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 4.35e-05 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.53e-05 S  per = 0.42  per(accum) = 1e+02
##### time_global: 2.02e-02 S #####
 T(fetch) = 7.53e-04 S  per =  3.7  per(accum) = 3.7
 T(hdiag) = 1.86e-04 S  per = 0.92  per(accum) = 4.7
 T(dvdsn) = 1.41e-02 S  per =   70  per(accum) = 74
 T(decim) = 4.77e-04 S  per =  2.4  per(accum) = 77
 T(guess) = 1.57e-04 S  per = 0.78  per(accum) = 78
 T(renrm) = 3.68e-03 S  per =   18  per(accum) = 96
 T(save ) = 8.43e-04 S  per =  4.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.36e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 5.32e-05 S  per = 0.39  per(accum) = 0.39
 T(symbolic_formulae_twodot     ) = 5.02e-04 S  per =  3.7  per(accum) = 4.1
 T(hintermediate init           ) = 2.73e-04 S  per =    2  per(accum) = 6.1
 T(hintermediates memcpy cpu2gpu) = 7.61e-06 S  per = 0.056  per(accum) = 6.1
 T(preprocess_hformulae_Hxlist2 ) = 4.75e-03 S  per =   35  per(accum) = 41
 T(hmmtasks init                ) = 2.77e-03 S  per =   20  per(accum) = 61
 T(dvdson solver [Hx_batchGPU]  ) = 5.15e-03 S  per =   38  per(accum) = 99
 T(dvdson solver [communication]) = 1.85e-07 S  per = 0.0014  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.23e-04 S  per =  0.9  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.60e-03 S
 T(qops init                    ) = 2.24e-04 S  per =  6.2  per(accum) = 6.2
 T(qops_dict memcpy cpu2gpu     ) = 5.38e-05 S  per =  1.5  per(accum) = 7.7
 T(symbolic_formulae_renorm     ) = 4.12e-04 S  per =   11  per(accum) = 19
 T(rintermediate init           ) = 2.28e-05 S  per = 0.63  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 8.97e-06 S  per = 0.25  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 7.84e-04 S  per =   22  per(accum) = 42
 T(rmmtasks init                ) = 5.06e-04 S  per =   14  per(accum) = 56
 T(qops memset                  ) = 1.28e-05 S  per = 0.36  per(accum) = 56
 T(preprocess_renorm_batchGPU   ) = 1.51e-03 S  per =   42  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 4.35e-05 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.53e-05 S  per = 0.42  per(accum) = 1e+02

isweep=0 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 3.913e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=362:0.00276MB:2.7e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=156:0.00119MB:1.16e-06GB
total mem of comb=561:0.00428MB:4.18e-06GB
===== CPUmem(GB): tot=1.29e-05 (comb,oper,dvdson,hvec,renorm)=4.18e-06,8.7e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x479bfe50
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (4,0):1 (2,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.7e-06 (oper)(GB)=8.7e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.198e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=506:0.00386MB:3.77e-06GB
cost_hinter=2.02e+03 time=0.000211 flops=9.59e+06
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.796e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.25e-05 (oper,hinter)(GB)=8.7e-06,3.77e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00336 S size(H_formulae)=188 size(Hxlst)=4522 T(Hmu/Hxlist/sort)=0.000101,0.00153,0.00172 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000317 (oper,hinter,dvdson,batch)(GB)=8.7e-06,3.77e-06,1.16e-06,0.000303
===== CPUmem(GB): tot=2.45e-05 (comb,oper,dvdson,hvec,renorm)=4.18e-06,8.7e-06,1.16e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=78 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=3.5e-05,0.00206,0.000198 cost=5.42e+04 flops[gemm]=2.63e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00206 t_reduction=0.000198 tot=0.00226 ---
 sigma counter=3 i=0 t=0.000264 per=12.8 cost=5.06e+03 flops=1.92e+07
 sigma counter=3 i=1 t=0.00026 per=12.6 cost=5.01e+03 flops=1.93e+07
 sigma counter=3 i=2 t=0.000257 per=12.5 cost=5.18e+03 flops=2.01e+07
 sigma counter=3 i=3 t=0.000246 per=12 cost=5.15e+03 flops=2.09e+07
 sigma counter=3 i=4 t=0.000252 per=12.2 cost=5.06e+03 flops=2.01e+07
 sigma counter=3 i=5 t=0.000253 per=12.3 cost=5.01e+03 flops=1.98e+07
 sigma counter=3 i=6 t=0.000269 per=13.1 cost=1.18e+04 flops=4.4e+07
 sigma counter=3 i=7 t=0.000257 per=12.5 cost=1.18e+04 flops=4.61e+07
 total GEMM cost=5.42e+04 flops=2.63e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.00641 t_reduction=0.000619 tot=0.00703 ---
 sigma_tot counter=3 i=0 t=0.000824 per=12.9 cost=1.91e+04 flops=2.31e+07
 sigma_tot counter=3 i=1 t=0.00081 per=12.6 cost=1.9e+04 flops=2.34e+07
 sigma_tot counter=3 i=2 t=0.000787 per=12.3 cost=1.88e+04 flops=2.39e+07
 sigma_tot counter=3 i=3 t=0.000784 per=12.2 cost=1.87e+04 flops=2.39e+07
 sigma_tot counter=3 i=4 t=0.000794 per=12.4 cost=4.28e+04 flops=5.4e+07
 sigma_tot counter=3 i=5 t=0.000824 per=12.9 cost=4.28e+04 flops=5.19e+07
 sigma_tot counter=3 i=6 t=0.000815 per=12.7 cost=2.54e+04 flops=3.12e+07
 sigma_tot counter=3 i=7 t=0.000772 per=12 cost=2.55e+04 flops=3.3e+07
 total GEMM cost=2.12e+05 flops=3.31e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.3e-05,0.00204,0.000193 cost=5.42e+04 flops[gemm]=2.65e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00204 t_reduction=0.000193 tot=0.00223 ---
 sigma counter=4 i=0 t=0.000249 per=12.2 cost=5.06e+03 flops=2.03e+07
 sigma counter=4 i=1 t=0.000276 per=13.5 cost=5.01e+03 flops=1.82e+07
 sigma counter=4 i=2 t=0.000242 per=11.9 cost=5.18e+03 flops=2.14e+07
 sigma counter=4 i=3 t=0.000255 per=12.5 cost=5.15e+03 flops=2.02e+07
 sigma counter=4 i=4 t=0.000246 per=12.1 cost=5.06e+03 flops=2.06e+07
 sigma counter=4 i=5 t=0.000248 per=12.2 cost=5.01e+03 flops=2.02e+07
 sigma counter=4 i=6 t=0.000257 per=12.6 cost=1.18e+04 flops=4.61e+07
 sigma counter=4 i=7 t=0.000266 per=13 cost=1.18e+04 flops=4.45e+07
 total GEMM cost=5.42e+04 flops=2.66e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.00845 t_reduction=0.000812 tot=0.00926 ---
 sigma_tot counter=4 i=0 t=0.00107 per=12.7 cost=2.41e+04 flops=2.25e+07
 sigma_tot counter=4 i=1 t=0.00109 per=12.9 cost=2.4e+04 flops=2.21e+07
 sigma_tot counter=4 i=2 t=0.00103 per=12.2 cost=2.4e+04 flops=2.33e+07
 sigma_tot counter=4 i=3 t=0.00104 per=12.3 cost=2.39e+04 flops=2.3e+07
 sigma_tot counter=4 i=4 t=0.00104 per=12.3 cost=4.79e+04 flops=4.61e+07
 sigma_tot counter=4 i=5 t=0.00107 per=12.7 cost=4.78e+04 flops=4.46e+07
 sigma_tot counter=4 i=6 t=0.00107 per=12.7 cost=3.73e+04 flops=3.48e+07
 sigma_tot counter=4 i=7 t=0.00104 per=12.3 cost=3.73e+04 flops=3.6e+07
 total GEMM cost=2.66e+05 flops=3.15e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.650929828670  -1.00e+03   1.40e-02    2     2   4.90e-03  2.45e-03
    1   1 -      -2.272369772185  -1.00e+03   1.99e-02    2     2   4.90e-03  2.45e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.20e-05,2.00e-03,1.97e-04 cost=5.42e+04 flops[gemm]=2.70e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.00e-03 t_reduction=1.97e-04 tot=2.20e-03 ---
 sigma counter=5 i=0 t=2.50e-04 per=1.25e+01 cost=5.06e+03 flops=2.02e+07
 sigma counter=5 i=1 t=2.52e-04 per=1.26e+01 cost=5.01e+03 flops=1.99e+07
 sigma counter=5 i=2 t=2.54e-04 per=1.27e+01 cost=5.18e+03 flops=2.04e+07
 sigma counter=5 i=3 t=2.45e-04 per=1.22e+01 cost=5.15e+03 flops=2.10e+07
 sigma counter=5 i=4 t=2.39e-04 per=1.19e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=5 i=5 t=2.51e-04 per=1.25e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=5 i=6 t=2.67e-04 per=1.33e+01 cost=1.18e+04 flops=4.44e+07
 sigma counter=5 i=7 t=2.46e-04 per=1.23e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.70e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.05e-02 t_reduction=1.01e-03 tot=1.15e-02 ---
 sigma_tot counter=5 i=0 t=1.32e-03 per=1.27e+01 cost=2.92e+04 flops=2.21e+07
 sigma_tot counter=5 i=1 t=1.34e-03 per=1.28e+01 cost=2.90e+04 flops=2.17e+07
 sigma_tot counter=5 i=2 t=1.28e-03 per=1.23e+01 cost=2.92e+04 flops=2.27e+07
 sigma_tot counter=5 i=3 t=1.28e-03 per=1.23e+01 cost=2.90e+04 flops=2.26e+07
 sigma_tot counter=5 i=4 t=1.28e-03 per=1.22e+01 cost=5.30e+04 flops=4.14e+07
 sigma_tot counter=5 i=5 t=1.32e-03 per=1.27e+01 cost=5.28e+04 flops=3.99e+07
 sigma_tot counter=5 i=6 t=1.34e-03 per=1.28e+01 cost=4.91e+04 flops=3.67e+07
 sigma_tot counter=5 i=7 t=1.28e-03 per=1.23e+01 cost=4.92e+04 flops=3.83e+07
 total GEMM cost=3.20e+05 flops=3.07e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.10e-05,2.05e-03,1.93e-04 cost=5.42e+04 flops[gemm]=2.64e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.05e-03 t_reduction=1.93e-04 tot=2.24e-03 ---
 sigma counter=6 i=0 t=2.58e-04 per=1.26e+01 cost=5.06e+03 flops=1.96e+07
 sigma counter=6 i=1 t=2.44e-04 per=1.19e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=6 i=2 t=2.59e-04 per=1.26e+01 cost=5.18e+03 flops=2.00e+07
 sigma counter=6 i=3 t=2.50e-04 per=1.22e+01 cost=5.15e+03 flops=2.06e+07
 sigma counter=6 i=4 t=2.55e-04 per=1.24e+01 cost=5.06e+03 flops=1.98e+07
 sigma counter=6 i=5 t=2.49e-04 per=1.21e+01 cost=5.01e+03 flops=2.01e+07
 sigma counter=6 i=6 t=2.68e-04 per=1.31e+01 cost=1.18e+04 flops=4.42e+07
 sigma counter=6 i=7 t=2.67e-04 per=1.30e+01 cost=1.18e+04 flops=4.44e+07
 total GEMM cost=5.42e+04 flops=2.64e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.25e-02 t_reduction=1.20e-03 tot=1.37e-02 ---
 sigma_tot counter=6 i=0 t=1.58e-03 per=1.26e+01 cost=3.42e+04 flops=2.17e+07
 sigma_tot counter=6 i=1 t=1.58e-03 per=1.27e+01 cost=3.40e+04 flops=2.15e+07
 sigma_tot counter=6 i=2 t=1.54e-03 per=1.23e+01 cost=3.43e+04 flops=2.23e+07
 sigma_tot counter=6 i=3 t=1.53e-03 per=1.23e+01 cost=3.42e+04 flops=2.23e+07
 sigma_tot counter=6 i=4 t=1.53e-03 per=1.23e+01 cost=5.80e+04 flops=3.78e+07
 sigma_tot counter=6 i=5 t=1.57e-03 per=1.26e+01 cost=5.78e+04 flops=3.68e+07
 sigma_tot counter=6 i=6 t=1.61e-03 per=1.29e+01 cost=6.10e+04 flops=3.79e+07
 sigma_tot counter=6 i=7 t=1.55e-03 per=1.24e+01 cost=6.10e+04 flops=3.93e+07
 total GEMM cost=3.75e+05 flops=3.00e+07
    2   0 -      -2.651065954409  -1.36e-04   5.04e-03    4     4   9.77e-03  2.44e-03
    2   1 -      -2.272592285910  -2.23e-04   5.21e-03    4     4   9.77e-03  2.44e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.30e-05,2.01e-03,1.91e-04 cost=5.42e+04 flops[gemm]=2.70e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.01e-03 t_reduction=1.91e-04 tot=2.20e-03 ---
 sigma counter=7 i=0 t=2.47e-04 per=1.23e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=7 i=1 t=2.45e-04 per=1.22e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=7 i=2 t=2.66e-04 per=1.32e+01 cost=5.18e+03 flops=1.95e+07
 sigma counter=7 i=3 t=2.45e-04 per=1.22e+01 cost=5.15e+03 flops=2.10e+07
 sigma counter=7 i=4 t=2.39e-04 per=1.19e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=7 i=5 t=2.44e-04 per=1.22e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=7 i=6 t=2.65e-04 per=1.32e+01 cost=1.18e+04 flops=4.47e+07
 sigma counter=7 i=7 t=2.57e-04 per=1.28e+01 cost=1.18e+04 flops=4.61e+07
 total GEMM cost=5.42e+04 flops=2.70e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.45e-02 t_reduction=1.39e-03 tot=1.59e-02 ---
 sigma_tot counter=7 i=0 t=1.83e-03 per=1.26e+01 cost=3.93e+04 flops=2.15e+07
 sigma_tot counter=7 i=1 t=1.83e-03 per=1.26e+01 cost=3.90e+04 flops=2.14e+07
 sigma_tot counter=7 i=2 t=1.81e-03 per=1.25e+01 cost=3.95e+04 flops=2.19e+07
 sigma_tot counter=7 i=3 t=1.78e-03 per=1.23e+01 cost=3.93e+04 flops=2.21e+07
 sigma_tot counter=7 i=4 t=1.77e-03 per=1.22e+01 cost=6.31e+04 flops=3.56e+07
 sigma_tot counter=7 i=5 t=1.82e-03 per=1.25e+01 cost=6.29e+04 flops=3.46e+07
 sigma_tot counter=7 i=6 t=1.87e-03 per=1.29e+01 cost=7.28e+04 flops=3.89e+07
 sigma_tot counter=7 i=7 t=1.81e-03 per=1.25e+01 cost=7.29e+04 flops=4.03e+07
 total GEMM cost=4.29e+05 flops=2.95e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.80e-05,2.00e-03,1.93e-04 cost=5.42e+04 flops[gemm]=2.71e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.00e-03 t_reduction=1.93e-04 tot=2.19e-03 ---
 sigma counter=8 i=0 t=2.51e-04 per=1.25e+01 cost=5.06e+03 flops=2.01e+07
 sigma counter=8 i=1 t=2.43e-04 per=1.22e+01 cost=5.01e+03 flops=2.06e+07
 sigma counter=8 i=2 t=2.50e-04 per=1.25e+01 cost=5.18e+03 flops=2.07e+07
 sigma counter=8 i=3 t=2.41e-04 per=1.20e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=8 i=4 t=2.51e-04 per=1.25e+01 cost=5.06e+03 flops=2.01e+07
 sigma counter=8 i=5 t=2.51e-04 per=1.25e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=8 i=6 t=2.62e-04 per=1.31e+01 cost=1.18e+04 flops=4.52e+07
 sigma counter=8 i=7 t=2.51e-04 per=1.25e+01 cost=1.18e+04 flops=4.72e+07
 total GEMM cost=5.42e+04 flops=2.71e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.65e-02 t_reduction=1.59e-03 tot=1.81e-02 ---
 sigma_tot counter=8 i=0 t=2.08e-03 per=1.26e+01 cost=4.43e+04 flops=2.13e+07
 sigma_tot counter=8 i=1 t=2.07e-03 per=1.25e+01 cost=4.40e+04 flops=2.13e+07
 sigma_tot counter=8 i=2 t=2.06e-03 per=1.25e+01 cost=4.47e+04 flops=2.17e+07
 sigma_tot counter=8 i=3 t=2.02e-03 per=1.22e+01 cost=4.45e+04 flops=2.20e+07
 sigma_tot counter=8 i=4 t=2.02e-03 per=1.23e+01 cost=6.81e+04 flops=3.37e+07
 sigma_tot counter=8 i=5 t=2.07e-03 per=1.25e+01 cost=6.79e+04 flops=3.28e+07
 sigma_tot counter=8 i=6 t=2.13e-03 per=1.29e+01 cost=8.47e+04 flops=3.97e+07
 sigma_tot counter=8 i=7 t=2.06e-03 per=1.25e+01 cost=8.47e+04 flops=4.11e+07
 total GEMM cost=4.83e+05 flops=2.92e+07
    3   0 -      -2.651089358155  -2.34e-05   2.26e-03    6     6   1.46e-02  2.43e-03
    3   1 -      -2.272613090414  -2.08e-05   1.99e-03    6     6   1.46e-02  2.43e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.20e-05,1.99e-03,1.94e-04 cost=5.42e+04 flops[gemm]=2.72e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.99e-03 t_reduction=1.94e-04 tot=2.18e-03 ---
 sigma counter=9 i=0 t=2.48e-04 per=1.25e+01 cost=5.06e+03 flops=2.04e+07
 sigma counter=9 i=1 t=2.49e-04 per=1.25e+01 cost=5.01e+03 flops=2.01e+07
 sigma counter=9 i=2 t=2.40e-04 per=1.21e+01 cost=5.18e+03 flops=2.16e+07
 sigma counter=9 i=3 t=2.52e-04 per=1.27e+01 cost=5.15e+03 flops=2.04e+07
 sigma counter=9 i=4 t=2.47e-04 per=1.24e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=9 i=5 t=2.48e-04 per=1.25e+01 cost=5.01e+03 flops=2.02e+07
 sigma counter=9 i=6 t=2.54e-04 per=1.28e+01 cost=1.18e+04 flops=4.66e+07
 sigma counter=9 i=7 t=2.50e-04 per=1.26e+01 cost=1.18e+04 flops=4.74e+07
 total GEMM cost=5.42e+04 flops=2.72e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.85e-02 t_reduction=1.78e-03 tot=2.03e-02 ---
 sigma_tot counter=9 i=0 t=2.33e-03 per=1.26e+01 cost=4.94e+04 flops=2.12e+07
 sigma_tot counter=9 i=1 t=2.32e-03 per=1.25e+01 cost=4.91e+04 flops=2.12e+07
 sigma_tot counter=9 i=2 t=2.30e-03 per=1.24e+01 cost=4.99e+04 flops=2.17e+07
 sigma_tot counter=9 i=3 t=2.27e-03 per=1.23e+01 cost=4.96e+04 flops=2.18e+07
 sigma_tot counter=9 i=4 t=2.27e-03 per=1.23e+01 cost=7.32e+04 flops=3.22e+07
 sigma_tot counter=9 i=5 t=2.32e-03 per=1.25e+01 cost=7.29e+04 flops=3.15e+07
 sigma_tot counter=9 i=6 t=2.39e-03 per=1.29e+01 cost=9.65e+04 flops=4.04e+07
 sigma_tot counter=9 i=7 t=2.31e-03 per=1.25e+01 cost=9.66e+04 flops=4.18e+07
 total GEMM cost=5.37e+05 flops=2.90e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,2.00e-03,1.94e-04 cost=5.42e+04 flops[gemm]=2.70e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.00e-03 t_reduction=1.94e-04 tot=2.20e-03 ---
 sigma counter=10 i=0 t=2.47e-04 per=1.23e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=10 i=1 t=2.51e-04 per=1.25e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=10 i=2 t=2.57e-04 per=1.28e+01 cost=5.18e+03 flops=2.01e+07
 sigma counter=10 i=3 t=2.48e-04 per=1.24e+01 cost=5.15e+03 flops=2.08e+07
 sigma counter=10 i=4 t=2.45e-04 per=1.22e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=10 i=5 t=2.50e-04 per=1.25e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=10 i=6 t=2.54e-04 per=1.27e+01 cost=1.18e+04 flops=4.66e+07
 sigma counter=10 i=7 t=2.52e-04 per=1.26e+01 cost=1.18e+04 flops=4.70e+07
 total GEMM cost=5.42e+04 flops=2.70e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.05e-02 t_reduction=1.97e-03 tot=2.25e-02 ---
 sigma_tot counter=10 i=0 t=2.57e-03 per=1.26e+01 cost=5.45e+04 flops=2.12e+07
 sigma_tot counter=10 i=1 t=2.57e-03 per=1.25e+01 cost=5.41e+04 flops=2.10e+07
 sigma_tot counter=10 i=2 t=2.56e-03 per=1.25e+01 cost=5.50e+04 flops=2.15e+07
 sigma_tot counter=10 i=3 t=2.52e-03 per=1.23e+01 cost=5.48e+04 flops=2.17e+07
 sigma_tot counter=10 i=4 t=2.52e-03 per=1.23e+01 cost=7.82e+04 flops=3.11e+07
 sigma_tot counter=10 i=5 t=2.57e-03 per=1.25e+01 cost=7.79e+04 flops=3.04e+07
 sigma_tot counter=10 i=6 t=2.64e-03 per=1.29e+01 cost=1.08e+05 flops=4.10e+07
 sigma_tot counter=10 i=7 t=2.56e-03 per=1.25e+01 cost=1.08e+05 flops=4.23e+07
 total GEMM cost=5.91e+05 flops=2.88e+07
    4   0 -      -2.651092508944  -3.15e-06   6.33e-04    6     8   1.93e-02  2.41e-03
    4   1 -      -2.281843638883  -9.23e-03   2.82e-01    6     8   1.93e-02  2.41e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.10e-05,2.00e-03,1.97e-04 cost=5.42e+04 flops[gemm]=2.71e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.00e-03 t_reduction=1.97e-04 tot=2.20e-03 ---
 sigma counter=11 i=0 t=2.55e-04 per=1.28e+01 cost=5.06e+03 flops=1.98e+07
 sigma counter=11 i=1 t=2.48e-04 per=1.24e+01 cost=5.01e+03 flops=2.02e+07
 sigma counter=11 i=2 t=2.55e-04 per=1.28e+01 cost=5.18e+03 flops=2.03e+07
 sigma counter=11 i=3 t=2.48e-04 per=1.24e+01 cost=5.15e+03 flops=2.08e+07
 sigma counter=11 i=4 t=2.47e-04 per=1.23e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=11 i=5 t=2.40e-04 per=1.20e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=11 i=6 t=2.63e-04 per=1.32e+01 cost=1.18e+04 flops=4.50e+07
 sigma counter=11 i=7 t=2.44e-04 per=1.22e+01 cost=1.18e+04 flops=4.86e+07
 total GEMM cost=5.42e+04 flops=2.71e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.25e-02 t_reduction=2.17e-03 tot=2.47e-02 ---
 sigma_tot counter=11 i=0 t=2.83e-03 per=1.26e+01 cost=5.95e+04 flops=2.10e+07
 sigma_tot counter=11 i=1 t=2.82e-03 per=1.25e+01 cost=5.91e+04 flops=2.10e+07
 sigma_tot counter=11 i=2 t=2.81e-03 per=1.25e+01 cost=6.02e+04 flops=2.14e+07
 sigma_tot counter=11 i=3 t=2.77e-03 per=1.23e+01 cost=5.99e+04 flops=2.16e+07
 sigma_tot counter=11 i=4 t=2.76e-03 per=1.23e+01 cost=8.33e+04 flops=3.01e+07
 sigma_tot counter=11 i=5 t=2.81e-03 per=1.25e+01 cost=8.29e+04 flops=2.96e+07
 sigma_tot counter=11 i=6 t=2.90e-03 per=1.29e+01 cost=1.20e+05 flops=4.14e+07
 sigma_tot counter=11 i=7 t=2.81e-03 per=1.25e+01 cost=1.20e+05 flops=4.29e+07
 total GEMM cost=6.45e+05 flops=2.87e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,2.01e-03,1.91e-04 cost=5.42e+04 flops[gemm]=2.70e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.01e-03 t_reduction=1.91e-04 tot=2.20e-03 ---
 sigma counter=12 i=0 t=2.42e-04 per=1.21e+01 cost=5.06e+03 flops=2.09e+07
 sigma counter=12 i=1 t=2.49e-04 per=1.24e+01 cost=5.01e+03 flops=2.01e+07
 sigma counter=12 i=2 t=2.63e-04 per=1.31e+01 cost=5.18e+03 flops=1.97e+07
 sigma counter=12 i=3 t=2.47e-04 per=1.23e+01 cost=5.15e+03 flops=2.08e+07
 sigma counter=12 i=4 t=2.45e-04 per=1.22e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=12 i=5 t=2.40e-04 per=1.20e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=12 i=6 t=2.73e-04 per=1.36e+01 cost=1.18e+04 flops=4.34e+07
 sigma counter=12 i=7 t=2.49e-04 per=1.24e+01 cost=1.18e+04 flops=4.76e+07
 total GEMM cost=5.42e+04 flops=2.70e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.45e-02 t_reduction=2.36e-03 tot=2.69e-02 ---
 sigma_tot counter=12 i=0 t=3.07e-03 per=1.25e+01 cost=6.46e+04 flops=2.10e+07
 sigma_tot counter=12 i=1 t=3.07e-03 per=1.25e+01 cost=6.41e+04 flops=2.09e+07
 sigma_tot counter=12 i=2 t=3.07e-03 per=1.25e+01 cost=6.54e+04 flops=2.13e+07
 sigma_tot counter=12 i=3 t=3.01e-03 per=1.23e+01 cost=6.50e+04 flops=2.16e+07
 sigma_tot counter=12 i=4 t=3.01e-03 per=1.23e+01 cost=8.84e+04 flops=2.94e+07
 sigma_tot counter=12 i=5 t=3.05e-03 per=1.24e+01 cost=8.79e+04 flops=2.89e+07
 sigma_tot counter=12 i=6 t=3.18e-03 per=1.30e+01 cost=1.32e+05 flops=4.16e+07
 sigma_tot counter=12 i=7 t=3.05e-03 per=1.25e+01 cost=1.32e+05 flops=4.33e+07
 total GEMM cost=7.00e+05 flops=2.85e+07
    5   0 -      -2.651092802413  -2.93e-07   2.04e-04    6    10   2.41e-02  2.41e-03
    5   1 -      -2.392715775374  -1.11e-01   2.01e-01    6    10   2.41e-02  2.41e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.99e-03,1.93e-04 cost=5.42e+04 flops[gemm]=2.72e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.99e-03 t_reduction=1.93e-04 tot=2.18e-03 ---
 sigma counter=13 i=0 t=2.43e-04 per=1.22e+01 cost=5.06e+03 flops=2.08e+07
 sigma counter=13 i=1 t=2.68e-04 per=1.35e+01 cost=5.01e+03 flops=1.87e+07
 sigma counter=13 i=2 t=2.50e-04 per=1.26e+01 cost=5.18e+03 flops=2.07e+07
 sigma counter=13 i=3 t=2.34e-04 per=1.18e+01 cost=5.15e+03 flops=2.20e+07
 sigma counter=13 i=4 t=2.39e-04 per=1.20e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=13 i=5 t=2.51e-04 per=1.26e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=13 i=6 t=2.58e-04 per=1.30e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=13 i=7 t=2.46e-04 per=1.24e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.72e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.65e-02 t_reduction=2.56e-03 tot=2.91e-02 ---
 sigma_tot counter=13 i=0 t=3.31e-03 per=1.25e+01 cost=6.96e+04 flops=2.10e+07
 sigma_tot counter=13 i=1 t=3.34e-03 per=1.26e+01 cost=6.91e+04 flops=2.07e+07
 sigma_tot counter=13 i=2 t=3.32e-03 per=1.25e+01 cost=7.06e+04 flops=2.12e+07
 sigma_tot counter=13 i=3 t=3.25e-03 per=1.23e+01 cost=7.02e+04 flops=2.16e+07
 sigma_tot counter=13 i=4 t=3.25e-03 per=1.23e+01 cost=9.34e+04 flops=2.88e+07
 sigma_tot counter=13 i=5 t=3.30e-03 per=1.24e+01 cost=9.29e+04 flops=2.82e+07
 sigma_tot counter=13 i=6 t=3.44e-03 per=1.30e+01 cost=1.44e+05 flops=4.19e+07
 sigma_tot counter=13 i=7 t=3.30e-03 per=1.25e+01 cost=1.44e+05 flops=4.36e+07
 total GEMM cost=7.54e+05 flops=2.84e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.97e-03,1.91e-04 cost=5.42e+04 flops[gemm]=2.76e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=1.91e-04 tot=2.15e-03 ---
 sigma counter=14 i=0 t=2.36e-04 per=1.20e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=14 i=1 t=2.40e-04 per=1.22e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=14 i=2 t=2.50e-04 per=1.27e+01 cost=5.18e+03 flops=2.07e+07
 sigma counter=14 i=3 t=2.52e-04 per=1.28e+01 cost=5.15e+03 flops=2.04e+07
 sigma counter=14 i=4 t=2.40e-04 per=1.22e+01 cost=5.06e+03 flops=2.11e+07
 sigma counter=14 i=5 t=2.41e-04 per=1.23e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=14 i=6 t=2.57e-04 per=1.31e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=14 i=7 t=2.47e-04 per=1.26e+01 cost=1.18e+04 flops=4.80e+07
 total GEMM cost=5.42e+04 flops=2.76e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.85e-02 t_reduction=2.75e-03 tot=3.12e-02 ---
 sigma_tot counter=14 i=0 t=3.55e-03 per=1.25e+01 cost=7.47e+04 flops=2.10e+07
 sigma_tot counter=14 i=1 t=3.58e-03 per=1.26e+01 cost=7.41e+04 flops=2.07e+07
 sigma_tot counter=14 i=2 t=3.57e-03 per=1.26e+01 cost=7.57e+04 flops=2.12e+07
 sigma_tot counter=14 i=3 t=3.50e-03 per=1.23e+01 cost=7.53e+04 flops=2.15e+07
 sigma_tot counter=14 i=4 t=3.49e-03 per=1.23e+01 cost=9.85e+04 flops=2.82e+07
 sigma_tot counter=14 i=5 t=3.54e-03 per=1.24e+01 cost=9.79e+04 flops=2.77e+07
 sigma_tot counter=14 i=6 t=3.69e-03 per=1.30e+01 cost=1.56e+05 flops=4.22e+07
 sigma_tot counter=14 i=7 t=3.55e-03 per=1.25e+01 cost=1.56e+05 flops=4.39e+07
 total GEMM cost=8.08e+05 flops=2.84e+07
    6   0 +      -2.651092830126  -2.77e-08   5.87e-05    6    12   2.88e-02  2.40e-03
    6   1 -      -2.424170523007  -3.15e-02   6.79e-02    6    12   2.88e-02  2.40e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.97e-03,1.89e-04 cost=5.42e+04 flops[gemm]=2.75e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.97e-03 t_reduction=1.89e-04 tot=2.16e-03 ---
 sigma counter=15 i=0 t=2.38e-04 per=1.21e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=15 i=1 t=2.42e-04 per=1.23e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=15 i=2 t=2.63e-04 per=1.34e+01 cost=5.18e+03 flops=1.97e+07
 sigma counter=15 i=3 t=2.43e-04 per=1.23e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=15 i=4 t=2.39e-04 per=1.21e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=15 i=5 t=2.41e-04 per=1.22e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=15 i=6 t=2.57e-04 per=1.31e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=15 i=7 t=2.45e-04 per=1.24e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.75e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.04e-02 t_reduction=2.94e-03 tot=3.34e-02 ---
 sigma_tot counter=15 i=0 t=3.79e-03 per=1.24e+01 cost=7.97e+04 flops=2.11e+07
 sigma_tot counter=15 i=1 t=3.82e-03 per=1.25e+01 cost=7.91e+04 flops=2.07e+07
 sigma_tot counter=15 i=2 t=3.84e-03 per=1.26e+01 cost=8.09e+04 flops=2.11e+07
 sigma_tot counter=15 i=3 t=3.74e-03 per=1.23e+01 cost=8.05e+04 flops=2.15e+07
 sigma_tot counter=15 i=4 t=3.73e-03 per=1.22e+01 cost=1.04e+05 flops=2.78e+07
 sigma_tot counter=15 i=5 t=3.78e-03 per=1.24e+01 cost=1.03e+05 flops=2.72e+07
 sigma_tot counter=15 i=6 t=3.95e-03 per=1.30e+01 cost=1.68e+05 flops=4.24e+07
 sigma_tot counter=15 i=7 t=3.79e-03 per=1.25e+01 cost=1.68e+05 flops=4.42e+07
 total GEMM cost=8.62e+05 flops=2.83e+07
    7   0 +      -2.651092830133  -6.90e-12   5.85e-05    5    13   3.12e-02  2.40e-03
    7   1 -      -2.427293692446  -3.12e-03   1.87e-02    5    13   3.12e-02  2.40e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.97e-03,1.93e-04 cost=5.42e+04 flops[gemm]=2.76e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.97e-03 t_reduction=1.93e-04 tot=2.16e-03 ---
 sigma counter=16 i=0 t=2.39e-04 per=1.22e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=16 i=1 t=2.45e-04 per=1.25e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=16 i=2 t=2.44e-04 per=1.24e+01 cost=5.18e+03 flops=2.12e+07
 sigma counter=16 i=3 t=2.42e-04 per=1.23e+01 cost=5.15e+03 flops=2.13e+07
 sigma counter=16 i=4 t=2.47e-04 per=1.26e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=16 i=5 t=2.41e-04 per=1.23e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=16 i=6 t=2.59e-04 per=1.32e+01 cost=1.18e+04 flops=4.57e+07
 sigma counter=16 i=7 t=2.48e-04 per=1.26e+01 cost=1.18e+04 flops=4.78e+07
 total GEMM cost=5.42e+04 flops=2.76e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.24e-02 t_reduction=3.13e-03 tot=3.55e-02 ---
 sigma_tot counter=16 i=0 t=4.03e-03 per=1.24e+01 cost=8.48e+04 flops=2.11e+07
 sigma_tot counter=16 i=1 t=4.06e-03 per=1.25e+01 cost=8.41e+04 flops=2.07e+07
 sigma_tot counter=16 i=2 t=4.08e-03 per=1.26e+01 cost=8.61e+04 flops=2.11e+07
 sigma_tot counter=16 i=3 t=3.99e-03 per=1.23e+01 cost=8.56e+04 flops=2.15e+07
 sigma_tot counter=16 i=4 t=3.97e-03 per=1.23e+01 cost=1.09e+05 flops=2.73e+07
 sigma_tot counter=16 i=5 t=4.02e-03 per=1.24e+01 cost=1.08e+05 flops=2.69e+07
 sigma_tot counter=16 i=6 t=4.21e-03 per=1.30e+01 cost=1.79e+05 flops=4.26e+07
 sigma_tot counter=16 i=7 t=4.04e-03 per=1.25e+01 cost=1.80e+05 flops=4.44e+07
 total GEMM cost=9.16e+05 flops=2.83e+07
    8   0 +      -2.651092830134  -1.15e-12   5.86e-05    4    14   3.35e-02  2.39e-03
    8   1 -      -2.427585633457  -2.92e-04   8.38e-03    4    14   3.35e-02  2.39e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.96e-03,2.04e-04 cost=5.42e+04 flops[gemm]=2.77e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=2.04e-04 tot=2.16e-03 ---
 sigma counter=17 i=0 t=2.37e-04 per=1.21e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=17 i=1 t=2.41e-04 per=1.23e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=17 i=2 t=2.40e-04 per=1.23e+01 cost=5.18e+03 flops=2.16e+07
 sigma counter=17 i=3 t=2.55e-04 per=1.30e+01 cost=5.15e+03 flops=2.02e+07
 sigma counter=17 i=4 t=2.34e-04 per=1.20e+01 cost=5.06e+03 flops=2.16e+07
 sigma counter=17 i=5 t=2.42e-04 per=1.24e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=17 i=6 t=2.56e-04 per=1.31e+01 cost=1.18e+04 flops=4.63e+07
 sigma counter=17 i=7 t=2.51e-04 per=1.28e+01 cost=1.18e+04 flops=4.72e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.44e-02 t_reduction=3.33e-03 tot=3.77e-02 ---
 sigma_tot counter=17 i=0 t=4.26e-03 per=1.24e+01 cost=8.99e+04 flops=2.11e+07
 sigma_tot counter=17 i=1 t=4.30e-03 per=1.25e+01 cost=8.92e+04 flops=2.07e+07
 sigma_tot counter=17 i=2 t=4.32e-03 per=1.26e+01 cost=9.13e+04 flops=2.11e+07
 sigma_tot counter=17 i=3 t=4.24e-03 per=1.23e+01 cost=9.08e+04 flops=2.14e+07
 sigma_tot counter=17 i=4 t=4.21e-03 per=1.22e+01 cost=1.14e+05 flops=2.70e+07
 sigma_tot counter=17 i=5 t=4.26e-03 per=1.24e+01 cost=1.13e+05 flops=2.65e+07
 sigma_tot counter=17 i=6 t=4.46e-03 per=1.30e+01 cost=1.91e+05 flops=4.28e+07
 sigma_tot counter=17 i=7 t=4.29e-03 per=1.25e+01 cost=1.91e+05 flops=4.46e+07
 total GEMM cost=9.70e+05 flops=2.82e+07
    9   0 +      -2.651092830134  -6.37e-13   5.85e-05    4    15   3.59e-02  2.39e-03
    9   1 -      -2.427634221137  -4.86e-05   3.09e-03    4    15   3.59e-02  2.39e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=3.10e-05,1.96e-03,1.85e-04 cost=5.42e+04 flops[gemm]=2.77e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=1.85e-04 tot=2.14e-03 ---
 sigma counter=18 i=0 t=2.38e-04 per=1.22e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=18 i=1 t=2.46e-04 per=1.26e+01 cost=5.01e+03 flops=2.04e+07
 sigma counter=18 i=2 t=2.48e-04 per=1.27e+01 cost=5.18e+03 flops=2.09e+07
 sigma counter=18 i=3 t=2.41e-04 per=1.23e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=18 i=4 t=2.36e-04 per=1.21e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=18 i=5 t=2.40e-04 per=1.23e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=18 i=6 t=2.63e-04 per=1.35e+01 cost=1.18e+04 flops=4.50e+07
 sigma counter=18 i=7 t=2.43e-04 per=1.24e+01 cost=1.18e+04 flops=4.88e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.63e-02 t_reduction=3.52e-03 tot=3.98e-02 ---
 sigma_tot counter=18 i=0 t=4.50e-03 per=1.24e+01 cost=9.49e+04 flops=2.11e+07
 sigma_tot counter=18 i=1 t=4.55e-03 per=1.25e+01 cost=9.42e+04 flops=2.07e+07
 sigma_tot counter=18 i=2 t=4.57e-03 per=1.26e+01 cost=9.64e+04 flops=2.11e+07
 sigma_tot counter=18 i=3 t=4.48e-03 per=1.23e+01 cost=9.59e+04 flops=2.14e+07
 sigma_tot counter=18 i=4 t=4.44e-03 per=1.22e+01 cost=1.19e+05 flops=2.67e+07
 sigma_tot counter=18 i=5 t=4.50e-03 per=1.24e+01 cost=1.18e+05 flops=2.62e+07
 sigma_tot counter=18 i=6 t=4.73e-03 per=1.30e+01 cost=2.03e+05 flops=4.30e+07
 sigma_tot counter=18 i=7 t=4.53e-03 per=1.25e+01 cost=2.03e+05 flops=4.48e+07
 total GEMM cost=1.02e+06 flops=2.82e+07
   10   0 +      -2.651092830150  -1.53e-11   5.86e-05    4    16   3.82e-02  2.39e-03
   10   1 -      -2.427641420031  -7.20e-06   1.36e-03    4    16   3.82e-02  2.39e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.94e-03,2.02e-04 cost=5.42e+04 flops[gemm]=2.79e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=2.02e-04 tot=2.14e-03 ---
 sigma counter=19 i=0 t=2.40e-04 per=1.24e+01 cost=5.06e+03 flops=2.11e+07
 sigma counter=19 i=1 t=2.30e-04 per=1.19e+01 cost=5.01e+03 flops=2.18e+07
 sigma counter=19 i=2 t=2.46e-04 per=1.27e+01 cost=5.18e+03 flops=2.10e+07
 sigma counter=19 i=3 t=2.41e-04 per=1.24e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=19 i=4 t=2.45e-04 per=1.26e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=19 i=5 t=2.39e-04 per=1.23e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=19 i=6 t=2.54e-04 per=1.31e+01 cost=1.18e+04 flops=4.66e+07
 sigma counter=19 i=7 t=2.44e-04 per=1.26e+01 cost=1.18e+04 flops=4.86e+07
 total GEMM cost=5.42e+04 flops=2.79e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.82e-02 t_reduction=3.72e-03 tot=4.20e-02 ---
 sigma_tot counter=19 i=0 t=4.74e-03 per=1.24e+01 cost=1.00e+05 flops=2.11e+07
 sigma_tot counter=19 i=1 t=4.78e-03 per=1.25e+01 cost=9.92e+04 flops=2.08e+07
 sigma_tot counter=19 i=2 t=4.81e-03 per=1.26e+01 cost=1.02e+05 flops=2.11e+07
 sigma_tot counter=19 i=3 t=4.72e-03 per=1.23e+01 cost=1.01e+05 flops=2.14e+07
 sigma_tot counter=19 i=4 t=4.69e-03 per=1.23e+01 cost=1.24e+05 flops=2.64e+07
 sigma_tot counter=19 i=5 t=4.74e-03 per=1.24e+01 cost=1.23e+05 flops=2.59e+07
 sigma_tot counter=19 i=6 t=4.98e-03 per=1.30e+01 cost=2.15e+05 flops=4.32e+07
 sigma_tot counter=19 i=7 t=4.78e-03 per=1.25e+01 cost=2.15e+05 flops=4.50e+07
 total GEMM cost=1.08e+06 flops=2.82e+07
   11   0 +      -2.651092830200  -5.06e-11   5.84e-05    4    17   4.06e-02  2.39e-03
   11   1 -      -2.427642854019  -1.43e-06   5.04e-04    4    17   4.06e-02  2.39e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.95e-03,1.85e-04 cost=5.42e+04 flops[gemm]=2.77e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.85e-04 tot=2.14e-03 ---
 sigma counter=20 i=0 t=2.31e-04 per=1.18e+01 cost=5.06e+03 flops=2.19e+07
 sigma counter=20 i=1 t=2.38e-04 per=1.22e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=20 i=2 t=2.51e-04 per=1.29e+01 cost=5.18e+03 flops=2.06e+07
 sigma counter=20 i=3 t=2.51e-04 per=1.29e+01 cost=5.15e+03 flops=2.05e+07
 sigma counter=20 i=4 t=2.35e-04 per=1.20e+01 cost=5.06e+03 flops=2.15e+07
 sigma counter=20 i=5 t=2.39e-04 per=1.22e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=20 i=6 t=2.54e-04 per=1.30e+01 cost=1.18e+04 flops=4.66e+07
 sigma counter=20 i=7 t=2.53e-04 per=1.30e+01 cost=1.18e+04 flops=4.68e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.02e-02 t_reduction=3.90e-03 tot=4.41e-02 ---
 sigma_tot counter=20 i=0 t=4.97e-03 per=1.24e+01 cost=1.05e+05 flops=2.11e+07
 sigma_tot counter=20 i=1 t=5.02e-03 per=1.25e+01 cost=1.04e+05 flops=2.08e+07
 sigma_tot counter=20 i=2 t=5.07e-03 per=1.26e+01 cost=1.07e+05 flops=2.11e+07
 sigma_tot counter=20 i=3 t=4.97e-03 per=1.24e+01 cost=1.06e+05 flops=2.14e+07
 sigma_tot counter=20 i=4 t=4.92e-03 per=1.22e+01 cost=1.29e+05 flops=2.62e+07
 sigma_tot counter=20 i=5 t=4.98e-03 per=1.24e+01 cost=1.28e+05 flops=2.57e+07
 sigma_tot counter=20 i=6 t=5.24e-03 per=1.30e+01 cost=2.27e+05 flops=4.33e+07
 sigma_tot counter=20 i=7 t=5.03e-03 per=1.25e+01 cost=2.27e+05 flops=4.51e+07
 total GEMM cost=1.13e+06 flops=2.82e+07
   12   0 +      -2.651092830232  -3.17e-11   5.81e-05    4    18   4.29e-02  2.38e-03
   12   1 -      -2.427643127214  -2.73e-07   2.10e-04    4    18   4.29e-02  2.38e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.95e-03,1.87e-04 cost=5.42e+04 flops[gemm]=2.78e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.13e-03 ---
 sigma counter=21 i=0 t=2.35e-04 per=1.21e+01 cost=5.06e+03 flops=2.15e+07
 sigma counter=21 i=1 t=2.51e-04 per=1.29e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=21 i=2 t=2.44e-04 per=1.25e+01 cost=5.18e+03 flops=2.12e+07
 sigma counter=21 i=3 t=2.40e-04 per=1.23e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=21 i=4 t=2.33e-04 per=1.20e+01 cost=5.06e+03 flops=2.17e+07
 sigma counter=21 i=5 t=2.45e-04 per=1.26e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=21 i=6 t=2.54e-04 per=1.30e+01 cost=1.18e+04 flops=4.66e+07
 sigma counter=21 i=7 t=2.45e-04 per=1.26e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.78e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.21e-02 t_reduction=4.09e-03 tot=4.62e-02 ---
 sigma_tot counter=21 i=0 t=5.21e-03 per=1.24e+01 cost=1.10e+05 flops=2.11e+07
 sigma_tot counter=21 i=1 t=5.27e-03 per=1.25e+01 cost=1.09e+05 flops=2.07e+07
 sigma_tot counter=21 i=2 t=5.31e-03 per=1.26e+01 cost=1.12e+05 flops=2.11e+07
 sigma_tot counter=21 i=3 t=5.21e-03 per=1.24e+01 cost=1.11e+05 flops=2.14e+07
 sigma_tot counter=21 i=4 t=5.16e-03 per=1.22e+01 cost=1.34e+05 flops=2.60e+07
 sigma_tot counter=21 i=5 t=5.22e-03 per=1.24e+01 cost=1.33e+05 flops=2.55e+07
 sigma_tot counter=21 i=6 t=5.49e-03 per=1.30e+01 cost=2.39e+05 flops=4.35e+07
 sigma_tot counter=21 i=7 t=5.28e-03 per=1.25e+01 cost=2.39e+05 flops=4.53e+07
 total GEMM cost=1.19e+06 flops=2.82e+07
   13   0 +      -2.651092830362  -1.30e-10   5.68e-05    4    19   4.52e-02  2.38e-03
   13   1 -      -2.427643172033  -4.48e-08   1.24e-04    4    19   4.52e-02  2.38e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.95e-03,1.94e-04 cost=5.42e+04 flops[gemm]=2.78e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.94e-04 tot=2.14e-03 ---
 sigma counter=22 i=0 t=2.47e-04 per=1.27e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=22 i=1 t=2.40e-04 per=1.23e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=22 i=2 t=2.41e-04 per=1.24e+01 cost=5.18e+03 flops=2.15e+07
 sigma counter=22 i=3 t=2.38e-04 per=1.22e+01 cost=5.15e+03 flops=2.16e+07
 sigma counter=22 i=4 t=2.36e-04 per=1.21e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=22 i=5 t=2.48e-04 per=1.27e+01 cost=5.01e+03 flops=2.02e+07
 sigma counter=22 i=6 t=2.54e-04 per=1.30e+01 cost=1.18e+04 flops=4.66e+07
 sigma counter=22 i=7 t=2.43e-04 per=1.25e+01 cost=1.18e+04 flops=4.88e+07
 total GEMM cost=5.42e+04 flops=2.78e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.41e-02 t_reduction=4.28e-03 tot=4.84e-02 ---
 sigma_tot counter=22 i=0 t=5.46e-03 per=1.24e+01 cost=1.15e+05 flops=2.11e+07
 sigma_tot counter=22 i=1 t=5.51e-03 per=1.25e+01 cost=1.14e+05 flops=2.07e+07
 sigma_tot counter=22 i=2 t=5.55e-03 per=1.26e+01 cost=1.17e+05 flops=2.11e+07
 sigma_tot counter=22 i=3 t=5.45e-03 per=1.24e+01 cost=1.17e+05 flops=2.14e+07
 sigma_tot counter=22 i=4 t=5.39e-03 per=1.22e+01 cost=1.39e+05 flops=2.58e+07
 sigma_tot counter=22 i=5 t=5.47e-03 per=1.24e+01 cost=1.38e+05 flops=2.52e+07
 sigma_tot counter=22 i=6 t=5.74e-03 per=1.30e+01 cost=2.51e+05 flops=4.36e+07
 sigma_tot counter=22 i=7 t=5.52e-03 per=1.25e+01 cost=2.51e+05 flops=4.54e+07
 total GEMM cost=1.24e+06 flops=2.81e+07
   14   0 +      -2.651092830379  -1.64e-11   5.70e-05    4    20   4.76e-02  2.38e-03
   14   1 +      -2.427643183354  -1.13e-08   4.12e-05    4    20   4.76e-02  2.38e-03
TIMING for Davidson : 4.76e-02  T(cal/comm/rest)=4.68e-02,1.24e-06,7.98e-04
optimized energies: isweep=0 dots=2 ibond=1 e[0]=-2.65109283038
optimized energies: isweep=0 dots=2 ibond=1 e[1]=-2.42764318335
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=12 dimAll=40
 (4,0):8 (3,1):8 (2,0):5 (3,-1):5 (5,1):3 (4,2):3 (2,2):2 (5,-1):2 (1,1):1 (4,-2):1 (6,0):1 (3,3):1
decimation summary: 40->10 dwt=+9.637e-03 SvN=1.843e+00
===== CPUmem(GB): tot=1.288e-05 (comb,oper,dvdson,hvec,renorm)=4.180e-06,8.702e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=775:5.913e-03MB:5.774e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=6.527e-06 (oper)(GB)=6.527e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.275e-05 (oper,qops,site)(GB)=6.527e-06,5.774e-06,4.470e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.709e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=506:0.00386MB:3.77e-06GB
cost_rinter=2.02e+03 time=0.000175 flops=1.16e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 2.272e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.65e-05 (oper,qops,site,rinter)(GB)=6.53e-06,5.77e-06,4.47e-07,3.77e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000434 S size(rtasks)=63 size(Rlst)=777 T(Rmu/Rxlist/sort)=6.7e-05,0.000192,0.000175 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000161 (oper,qops,site,rinter,batch)(GB)=6.53e-06,5.77e-06,4.47e-07,3.77e-06,0.000145
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00107,0.000179 cost=4.06e+04 flops[gemm]=3.79e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00107 t_reduction=0.000179 tot=0.00125 ---
 renorm counter=2 i=0 t=0.000212 per=19.8 cost=2.63e+03 flops=1.24e+07
 renorm counter=2 i=1 t=0.000207 per=19.3 cost=2.79e+03 flops=1.35e+07
 renorm counter=2 i=2 t=1e-06 per=0.0934 cost=0 flops=0
 renorm counter=2 i=3 t=1e-06 per=0.0934 cost=0 flops=0
 renorm counter=2 i=4 t=0.000207 per=19.3 cost=4.43e+03 flops=2.14e+07
 renorm counter=2 i=5 t=0.000219 per=20.4 cost=8.63e+03 flops=3.94e+07
 renorm counter=2 i=6 t=0.000224 per=20.9 cost=2.21e+04 flops=9.88e+07
 total GEMM cost=4.06e+04 flops=3.79e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00224 t_reduction=0.000378 tot=0.00262 ---
 renorm_tot counter=2 i=0 t=0.000461 per=20.6 cost=3.96e+03 flops=8.59e+06
 renorm_tot counter=2 i=1 t=0.000432 per=19.3 cost=4.69e+03 flops=1.09e+07
 renorm_tot counter=2 i=2 t=2e-06 per=0.0892 cost=0 flops=0
 renorm_tot counter=2 i=3 t=2e-06 per=0.0892 cost=0 flops=0
 renorm_tot counter=2 i=4 t=0.000429 per=19.1 cost=5.71e+03 flops=1.33e+07
 renorm_tot counter=2 i=5 t=0.000438 per=19.5 cost=1.06e+04 flops=2.42e+07
 renorm_tot counter=2 i=6 t=0.000479 per=21.4 cost=3.44e+04 flops=7.18e+07
 total GEMM cost=5.93e+04 flops=2.64e+07
check ||H-H.dagger||=8.01e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0029 S T(init/kernel/comm)=0.00019,0.0027,1.1e-05 rank=0 -----
===== CPUmem(GB): tot=1.3e-05 (comb,oper,dvdson,hvec,renorm)=4.2e-06,8.7e-06,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=130:0.00099MB:9.7e-07GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=48:0.00037MB:3.6e-07GB
total mem of comb=221:0.0017MB:1.6e-06GB
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.4e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=5.77e-06GB T[save](info/data/tot)=5.58e-05,5.01e-05,0.000106 speed=0.0545GB/s disk[used]=5.85e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 5.88e-02 S #####
 T(fetch) = 5.44e-04 S  per = 0.92  per(accum) = 0.92
 T(hdiag) = 1.20e-04 S  per =  0.2  per(accum) = 1.1
 T(dvdsn) = 5.40e-02 S  per =   92  per(accum) = 93
 T(decim) = 3.78e-04 S  per = 0.64  per(accum) = 94
 T(guess) = 8.42e-05 S  per = 0.14  per(accum) = 94
 T(renrm) = 2.97e-03 S  per =  5.1  per(accum) = 99
 T(save ) = 6.75e-04 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.37e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.73e-05 S  per = 0.088  per(accum) = 0.088
 T(symbolic_formulae_twodot     ) = 4.28e-04 S  per =  0.8  per(accum) = 0.89
 T(hintermediate init           ) = 2.86e-04 S  per = 0.53  per(accum) = 1.4
 T(hintermediates memcpy cpu2gpu) = 7.32e-06 S  per = 0.014  per(accum) = 1.4
 T(preprocess_hformulae_Hxlist2 ) = 3.37e-03 S  per =  6.3  per(accum) = 7.7
 T(hmmtasks init                ) = 1.99e-03 S  per =  3.7  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 4.68e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 1.24e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.98e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.91e-03 S
 T(qops init                    ) = 1.91e-04 S  per =  6.6  per(accum) = 6.6
 T(qops_dict memcpy cpu2gpu     ) = 4.17e-05 S  per =  1.4  per(accum) = 8
 T(symbolic_formulae_renorm     ) = 2.78e-04 S  per =  9.5  per(accum) = 18
 T(rintermediate init           ) = 2.32e-04 S  per =    8  per(accum) = 26
 T(rintermediates memcpy cpu2gpu) = 6.75e-06 S  per = 0.23  per(accum) = 26
 T(preprocess_formulae_Rlist2   ) = 4.44e-04 S  per =   15  per(accum) = 41
 T(rmmtasks init                ) = 3.12e-04 S  per =   11  per(accum) = 52
 T(qops memset                  ) = 9.24e-06 S  per = 0.32  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.36e-03 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.16e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.11e-05 S  per = 0.38  per(accum) = 1e+02
##### time_sweep: 7.90e-02 S #####
 T(fetch) = 1.30e-03 S  per =  1.6  per(accum) = 1.6
 T(hdiag) = 3.06e-04 S  per = 0.39  per(accum) = 2
 T(dvdsn) = 6.81e-02 S  per =   86  per(accum) = 88
 T(decim) = 8.55e-04 S  per =  1.1  per(accum) = 89
 T(guess) = 2.41e-04 S  per = 0.31  per(accum) = 90
 T(renrm) = 6.65e-03 S  per =  8.4  per(accum) = 98
 T(save ) = 1.52e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 6.73e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.01e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 9.31e-04 S  per =  1.4  per(accum) = 1.5
 T(hintermediate init           ) = 5.60e-04 S  per = 0.83  per(accum) = 2.4
 T(hintermediates memcpy cpu2gpu) = 1.49e-05 S  per = 0.022  per(accum) = 2.4
 T(preprocess_hformulae_Hxlist2 ) = 8.12e-03 S  per =   12  per(accum) = 14
 T(hmmtasks init                ) = 4.76e-03 S  per =  7.1  per(accum) = 22
 T(dvdson solver [Hx_batchGPU]  ) = 5.19e-02 S  per =   77  per(accum) = 99
 T(dvdson solver [communication]) = 1.42e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 9.22e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.51e-03 S
 T(qops init                    ) = 4.15e-04 S  per =  6.4  per(accum) = 6.4
 T(qops_dict memcpy cpu2gpu     ) = 9.55e-05 S  per =  1.5  per(accum) = 7.8
 T(symbolic_formulae_renorm     ) = 6.90e-04 S  per =   11  per(accum) = 18
 T(rintermediate init           ) = 2.55e-04 S  per =  3.9  per(accum) = 22
 T(rintermediates memcpy cpu2gpu) = 1.57e-05 S  per = 0.24  per(accum) = 23
 T(preprocess_formulae_Rlist2   ) = 1.23e-03 S  per =   19  per(accum) = 41
 T(rmmtasks init                ) = 8.18e-04 S  per =   13  per(accum) = 54
 T(qops memset                  ) = 2.21e-05 S  per = 0.34  per(accum) = 54
 T(preprocess_renorm_batchGPU   ) = 2.87e-03 S  per =   44  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 7.51e-05 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.64e-05 S  per =  0.4  per(accum) = 1e+02
##### time_global: 7.90e-02 S #####
 T(fetch) = 1.30e-03 S  per =  1.6  per(accum) = 1.6
 T(hdiag) = 3.06e-04 S  per = 0.39  per(accum) = 2
 T(dvdsn) = 6.81e-02 S  per =   86  per(accum) = 88
 T(decim) = 8.55e-04 S  per =  1.1  per(accum) = 89
 T(guess) = 2.41e-04 S  per = 0.31  per(accum) = 90
 T(renrm) = 6.65e-03 S  per =  8.4  per(accum) = 98
 T(save ) = 1.52e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 6.73e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.01e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 9.31e-04 S  per =  1.4  per(accum) = 1.5
 T(hintermediate init           ) = 5.60e-04 S  per = 0.83  per(accum) = 2.4
 T(hintermediates memcpy cpu2gpu) = 1.49e-05 S  per = 0.022  per(accum) = 2.4
 T(preprocess_hformulae_Hxlist2 ) = 8.12e-03 S  per =   12  per(accum) = 14
 T(hmmtasks init                ) = 4.76e-03 S  per =  7.1  per(accum) = 22
 T(dvdson solver [Hx_batchGPU]  ) = 5.19e-02 S  per =   77  per(accum) = 99
 T(dvdson solver [communication]) = 1.42e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 9.22e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.51e-03 S
 T(qops init                    ) = 4.15e-04 S  per =  6.4  per(accum) = 6.4
 T(qops_dict memcpy cpu2gpu     ) = 9.55e-05 S  per =  1.5  per(accum) = 7.8
 T(symbolic_formulae_renorm     ) = 6.90e-04 S  per =   11  per(accum) = 18
 T(rintermediate init           ) = 2.55e-04 S  per =  3.9  per(accum) = 22
 T(rintermediates memcpy cpu2gpu) = 1.57e-05 S  per = 0.24  per(accum) = 23
 T(preprocess_formulae_Rlist2   ) = 1.23e-03 S  per =   19  per(accum) = 41
 T(rmmtasks init                ) = 8.18e-04 S  per =   13  per(accum) = 54
 T(qops memset                  ) = 2.21e-05 S  per = 0.34  per(accum) = 54
 T(preprocess_renorm_batchGPU   ) = 2.87e-03 S  per =   44  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 7.51e-05 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.64e-05 S  per =  0.4  per(accum) = 1e+02

isweep=0 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.686e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=130:0.000992MB:9.69e-07GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=221:0.00169MB:1.65e-06GB
===== CPUmem(GB): tot=1.61e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.45e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x4846c1f0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (4,0):1 (2,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.7e-06 (oper)(GB)=8.7e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.406e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=506:0.00386MB:3.77e-06GB
cost_hinter=2.02e+03 time=0.00017 flops=1.19e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.254e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.25e-05 (oper,hinter)(GB)=8.7e-06,3.77e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00271 S size(H_formulae)=188 size(Hxlst)=4522 T(Hmu/Hxlist/sort)=7.95e-05,0.00126,0.00137 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000317 (oper,hinter,dvdson,batch)(GB)=8.7e-06,3.77e-06,1.16e-06,0.000303
===== CPUmem(GB): tot=2.77e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.45e-05,1.16e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=78 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.8e-05,0.00194,0.000185 cost=5.42e+04 flops[gemm]=2.79e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00194 t_reduction=0.000185 tot=0.00212 ---
 sigma counter=23 i=0 t=0.000247 per=12.8 cost=5.06e+03 flops=2.05e+07
 sigma counter=23 i=1 t=0.000239 per=12.3 cost=5.01e+03 flops=2.1e+07
 sigma counter=23 i=2 t=0.000232 per=12 cost=5.18e+03 flops=2.23e+07
 sigma counter=23 i=3 t=0.000246 per=12.7 cost=5.15e+03 flops=2.09e+07
 sigma counter=23 i=4 t=0.000235 per=12.1 cost=5.06e+03 flops=2.15e+07
 sigma counter=23 i=5 t=0.000236 per=12.2 cost=5.01e+03 flops=2.12e+07
 sigma counter=23 i=6 t=0.00025 per=12.9 cost=1.18e+04 flops=4.74e+07
 sigma counter=23 i=7 t=0.000252 per=13 cost=1.18e+04 flops=4.7e+07
 total GEMM cost=5.42e+04 flops=2.8e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.046 t_reduction=0.00447 tot=0.0505 ---
 sigma_tot counter=23 i=0 t=0.0057 per=12.4 cost=1.2e+05 flops=2.11e+07
 sigma_tot counter=23 i=1 t=0.00575 per=12.5 cost=1.19e+05 flops=2.07e+07
 sigma_tot counter=23 i=2 t=0.00578 per=12.6 cost=1.22e+05 flops=2.12e+07
 sigma_tot counter=23 i=3 t=0.0057 per=12.4 cost=1.22e+05 flops=2.14e+07
 sigma_tot counter=23 i=4 t=0.00563 per=12.2 cost=1.44e+05 flops=2.56e+07
 sigma_tot counter=23 i=5 t=0.00571 per=12.4 cost=1.43e+05 flops=2.51e+07
 sigma_tot counter=23 i=6 t=0.00599 per=13 cost=2.62e+05 flops=4.38e+07
 sigma_tot counter=23 i=7 t=0.00577 per=12.5 cost=2.62e+05 flops=4.55e+07
 total GEMM cost=1.3e+06 flops=2.81e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.9e-05,0.00191,0.00019 cost=5.42e+04 flops[gemm]=2.83e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00191 t_reduction=0.00019 tot=0.0021 ---
 sigma counter=24 i=0 t=0.000241 per=12.6 cost=5.06e+03 flops=2.1e+07
 sigma counter=24 i=1 t=0.000236 per=12.4 cost=5.01e+03 flops=2.12e+07
 sigma counter=24 i=2 t=0.000238 per=12.5 cost=5.18e+03 flops=2.17e+07
 sigma counter=24 i=3 t=0.000236 per=12.4 cost=5.15e+03 flops=2.18e+07
 sigma counter=24 i=4 t=0.00023 per=12 cost=5.06e+03 flops=2.2e+07
 sigma counter=24 i=5 t=0.000235 per=12.3 cost=5.01e+03 flops=2.13e+07
 sigma counter=24 i=6 t=0.000256 per=13.4 cost=1.18e+04 flops=4.63e+07
 sigma counter=24 i=7 t=0.000238 per=12.5 cost=1.18e+04 flops=4.98e+07
 total GEMM cost=5.42e+04 flops=2.84e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.0479 t_reduction=0.00466 tot=0.0526 ---
 sigma_tot counter=24 i=0 t=0.00594 per=12.4 cost=1.25e+05 flops=2.11e+07
 sigma_tot counter=24 i=1 t=0.00598 per=12.5 cost=1.24e+05 flops=2.08e+07
 sigma_tot counter=24 i=2 t=0.00602 per=12.6 cost=1.28e+05 flops=2.12e+07
 sigma_tot counter=24 i=3 t=0.00593 per=12.4 cost=1.27e+05 flops=2.14e+07
 sigma_tot counter=24 i=4 t=0.00586 per=12.2 cost=1.49e+05 flops=2.54e+07
 sigma_tot counter=24 i=5 t=0.00594 per=12.4 cost=1.48e+05 flops=2.49e+07
 sigma_tot counter=24 i=6 t=0.00625 per=13 cost=2.74e+05 flops=4.39e+07
 sigma_tot counter=24 i=7 t=0.00601 per=12.5 cost=2.74e+05 flops=4.56e+07
 total GEMM cost=1.35e+06 flops=2.81e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.640915766574  -1.00e+03   1.43e-01    2     2   4.52e-03  2.26e-03
    1   1 -      -2.405171106796  -1.00e+03   1.99e-01    2     2   4.52e-03  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.93e-03,1.91e-04 cost=5.42e+04 flops[gemm]=2.81e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.91e-04 tot=2.12e-03 ---
 sigma counter=25 i=0 t=2.42e-04 per=1.26e+01 cost=5.06e+03 flops=2.09e+07
 sigma counter=25 i=1 t=2.38e-04 per=1.24e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=25 i=2 t=2.49e-04 per=1.29e+01 cost=5.18e+03 flops=2.08e+07
 sigma counter=25 i=3 t=2.34e-04 per=1.22e+01 cost=5.15e+03 flops=2.20e+07
 sigma counter=25 i=4 t=2.32e-04 per=1.21e+01 cost=5.06e+03 flops=2.18e+07
 sigma counter=25 i=5 t=2.39e-04 per=1.24e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=25 i=6 t=2.50e-04 per=1.30e+01 cost=1.18e+04 flops=4.74e+07
 sigma counter=25 i=7 t=2.41e-04 per=1.25e+01 cost=1.18e+04 flops=4.92e+07
 total GEMM cost=5.42e+04 flops=2.81e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.99e-02 t_reduction=4.85e-03 tot=5.47e-02 ---
 sigma_tot counter=25 i=0 t=6.19e-03 per=1.24e+01 cost=1.30e+05 flops=2.11e+07
 sigma_tot counter=25 i=1 t=6.22e-03 per=1.25e+01 cost=1.29e+05 flops=2.08e+07
 sigma_tot counter=25 i=2 t=6.27e-03 per=1.26e+01 cost=1.33e+05 flops=2.12e+07
 sigma_tot counter=25 i=3 t=6.17e-03 per=1.24e+01 cost=1.32e+05 flops=2.14e+07
 sigma_tot counter=25 i=4 t=6.09e-03 per=1.22e+01 cost=1.54e+05 flops=2.53e+07
 sigma_tot counter=25 i=5 t=6.18e-03 per=1.24e+01 cost=1.53e+05 flops=2.48e+07
 sigma_tot counter=25 i=6 t=6.50e-03 per=1.30e+01 cost=2.86e+05 flops=4.40e+07
 sigma_tot counter=25 i=7 t=6.25e-03 per=1.25e+01 cost=2.86e+05 flops=4.58e+07
 total GEMM cost=1.40e+06 flops=2.81e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.90e-03,1.99e-04 cost=5.42e+04 flops[gemm]=2.85e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.90e-03 t_reduction=1.99e-04 tot=2.10e-03 ---
 sigma counter=26 i=0 t=2.37e-04 per=1.25e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=26 i=1 t=2.35e-04 per=1.24e+01 cost=5.01e+03 flops=2.13e+07
 sigma counter=26 i=2 t=2.32e-04 per=1.22e+01 cost=5.18e+03 flops=2.23e+07
 sigma counter=26 i=3 t=2.33e-04 per=1.23e+01 cost=5.15e+03 flops=2.21e+07
 sigma counter=26 i=4 t=2.40e-04 per=1.26e+01 cost=5.06e+03 flops=2.11e+07
 sigma counter=26 i=5 t=2.35e-04 per=1.24e+01 cost=5.01e+03 flops=2.13e+07
 sigma counter=26 i=6 t=2.53e-04 per=1.33e+01 cost=1.18e+04 flops=4.68e+07
 sigma counter=26 i=7 t=2.36e-04 per=1.24e+01 cost=1.18e+04 flops=5.02e+07
 total GEMM cost=5.42e+04 flops=2.85e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=5.18e-02 t_reduction=5.05e-03 tot=5.68e-02 ---
 sigma_tot counter=26 i=0 t=6.42e-03 per=1.24e+01 cost=1.35e+05 flops=2.11e+07
 sigma_tot counter=26 i=1 t=6.46e-03 per=1.25e+01 cost=1.34e+05 flops=2.08e+07
 sigma_tot counter=26 i=2 t=6.50e-03 per=1.26e+01 cost=1.38e+05 flops=2.12e+07
 sigma_tot counter=26 i=3 t=6.40e-03 per=1.24e+01 cost=1.37e+05 flops=2.14e+07
 sigma_tot counter=26 i=4 t=6.33e-03 per=1.22e+01 cost=1.59e+05 flops=2.51e+07
 sigma_tot counter=26 i=5 t=6.42e-03 per=1.24e+01 cost=1.58e+05 flops=2.46e+07
 sigma_tot counter=26 i=6 t=6.75e-03 per=1.30e+01 cost=2.98e+05 flops=4.41e+07
 sigma_tot counter=26 i=7 t=6.49e-03 per=1.25e+01 cost=2.98e+05 flops=4.59e+07
 total GEMM cost=1.46e+06 flops=2.82e+07
    2   0 -      -2.650499349704  -9.58e-03   3.19e-02    4     4   9.07e-03  2.27e-03
    2   1 -      -2.425166040136  -2.00e-02   5.86e-02    4     4   9.07e-03  2.27e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.94e-03,1.91e-04 cost=5.42e+04 flops[gemm]=2.79e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.91e-04 tot=2.13e-03 ---
 sigma counter=27 i=0 t=2.32e-04 per=1.20e+01 cost=5.06e+03 flops=2.18e+07
 sigma counter=27 i=1 t=2.40e-04 per=1.24e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=27 i=2 t=2.59e-04 per=1.34e+01 cost=5.18e+03 flops=2.00e+07
 sigma counter=27 i=3 t=2.36e-04 per=1.22e+01 cost=5.15e+03 flops=2.18e+07
 sigma counter=27 i=4 t=2.34e-04 per=1.21e+01 cost=5.06e+03 flops=2.16e+07
 sigma counter=27 i=5 t=2.35e-04 per=1.21e+01 cost=5.01e+03 flops=2.13e+07
 sigma counter=27 i=6 t=2.62e-04 per=1.35e+01 cost=1.18e+04 flops=4.52e+07
 sigma counter=27 i=7 t=2.39e-04 per=1.23e+01 cost=1.18e+04 flops=4.96e+07
 total GEMM cost=5.42e+04 flops=2.80e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=5.37e-02 t_reduction=5.24e-03 tot=5.89e-02 ---
 sigma_tot counter=27 i=0 t=6.65e-03 per=1.24e+01 cost=1.40e+05 flops=2.11e+07
 sigma_tot counter=27 i=1 t=6.70e-03 per=1.25e+01 cost=1.39e+05 flops=2.08e+07
 sigma_tot counter=27 i=2 t=6.76e-03 per=1.26e+01 cost=1.43e+05 flops=2.12e+07
 sigma_tot counter=27 i=3 t=6.64e-03 per=1.24e+01 cost=1.42e+05 flops=2.14e+07
 sigma_tot counter=27 i=4 t=6.56e-03 per=1.22e+01 cost=1.64e+05 flops=2.50e+07
 sigma_tot counter=27 i=5 t=6.65e-03 per=1.24e+01 cost=1.63e+05 flops=2.45e+07
 sigma_tot counter=27 i=6 t=7.01e-03 per=1.31e+01 cost=3.10e+05 flops=4.42e+07
 sigma_tot counter=27 i=7 t=6.73e-03 per=1.25e+01 cost=3.10e+05 flops=4.61e+07
 total GEMM cost=1.51e+06 flops=2.82e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.92e-03,1.81e-04 cost=5.42e+04 flops[gemm]=2.82e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.92e-03 t_reduction=1.81e-04 tot=2.10e-03 ---
 sigma counter=28 i=0 t=2.37e-04 per=1.24e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=28 i=1 t=2.47e-04 per=1.29e+01 cost=5.01e+03 flops=2.03e+07
 sigma counter=28 i=2 t=2.34e-04 per=1.22e+01 cost=5.18e+03 flops=2.21e+07
 sigma counter=28 i=3 t=2.35e-04 per=1.23e+01 cost=5.15e+03 flops=2.19e+07
 sigma counter=28 i=4 t=2.32e-04 per=1.21e+01 cost=5.06e+03 flops=2.18e+07
 sigma counter=28 i=5 t=2.36e-04 per=1.23e+01 cost=5.01e+03 flops=2.12e+07
 sigma counter=28 i=6 t=2.56e-04 per=1.34e+01 cost=1.18e+04 flops=4.63e+07
 sigma counter=28 i=7 t=2.40e-04 per=1.25e+01 cost=1.18e+04 flops=4.94e+07
 total GEMM cost=5.42e+04 flops=2.83e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=5.56e-02 t_reduction=5.42e-03 tot=6.10e-02 ---
 sigma_tot counter=28 i=0 t=6.89e-03 per=1.24e+01 cost=1.45e+05 flops=2.11e+07
 sigma_tot counter=28 i=1 t=6.94e-03 per=1.25e+01 cost=1.44e+05 flops=2.08e+07
 sigma_tot counter=28 i=2 t=6.99e-03 per=1.26e+01 cost=1.48e+05 flops=2.12e+07
 sigma_tot counter=28 i=3 t=6.87e-03 per=1.24e+01 cost=1.47e+05 flops=2.15e+07
 sigma_tot counter=28 i=4 t=6.79e-03 per=1.22e+01 cost=1.69e+05 flops=2.49e+07
 sigma_tot counter=28 i=5 t=6.89e-03 per=1.24e+01 cost=1.68e+05 flops=2.44e+07
 sigma_tot counter=28 i=6 t=7.27e-03 per=1.31e+01 cost=3.22e+05 flops=4.42e+07
 sigma_tot counter=28 i=7 t=6.97e-03 per=1.25e+01 cost=3.22e+05 flops=4.62e+07
 total GEMM cost=1.57e+06 flops=2.82e+07
    3   0 -      -2.651051792159  -5.52e-04   6.68e-03    6     6   1.36e-02  2.27e-03
    3   1 -      -2.427538409660  -2.37e-03   1.15e-02    6     6   1.36e-02  2.27e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.93e-03,1.99e-04 cost=5.42e+04 flops[gemm]=2.81e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.99e-04 tot=2.12e-03 ---
 sigma counter=29 i=0 t=2.42e-04 per=1.26e+01 cost=5.06e+03 flops=2.09e+07
 sigma counter=29 i=1 t=2.38e-04 per=1.24e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=29 i=2 t=2.32e-04 per=1.20e+01 cost=5.18e+03 flops=2.23e+07
 sigma counter=29 i=3 t=2.36e-04 per=1.23e+01 cost=5.15e+03 flops=2.18e+07
 sigma counter=29 i=4 t=2.41e-04 per=1.25e+01 cost=5.06e+03 flops=2.10e+07
 sigma counter=29 i=5 t=2.40e-04 per=1.25e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=29 i=6 t=2.56e-04 per=1.33e+01 cost=1.18e+04 flops=4.63e+07
 sigma counter=29 i=7 t=2.41e-04 per=1.25e+01 cost=1.18e+04 flops=4.92e+07
 total GEMM cost=5.42e+04 flops=2.81e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=5.75e-02 t_reduction=5.62e-03 tot=6.32e-02 ---
 sigma_tot counter=29 i=0 t=7.13e-03 per=1.24e+01 cost=1.51e+05 flops=2.11e+07
 sigma_tot counter=29 i=1 t=7.18e-03 per=1.25e+01 cost=1.49e+05 flops=2.08e+07
 sigma_tot counter=29 i=2 t=7.23e-03 per=1.26e+01 cost=1.53e+05 flops=2.12e+07
 sigma_tot counter=29 i=3 t=7.11e-03 per=1.24e+01 cost=1.53e+05 flops=2.15e+07
 sigma_tot counter=29 i=4 t=7.04e-03 per=1.22e+01 cost=1.74e+05 flops=2.48e+07
 sigma_tot counter=29 i=5 t=7.13e-03 per=1.24e+01 cost=1.73e+05 flops=2.43e+07
 sigma_tot counter=29 i=6 t=7.53e-03 per=1.31e+01 cost=3.33e+05 flops=4.43e+07
 sigma_tot counter=29 i=7 t=7.21e-03 per=1.25e+01 cost=3.34e+05 flops=4.63e+07
 total GEMM cost=1.62e+06 flops=2.82e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.93e-03,1.89e-04 cost=5.42e+04 flops[gemm]=2.81e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.89e-04 tot=2.12e-03 ---
 sigma counter=30 i=0 t=2.32e-04 per=1.20e+01 cost=5.06e+03 flops=2.18e+07
 sigma counter=30 i=1 t=2.39e-04 per=1.24e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=30 i=2 t=2.38e-04 per=1.23e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=30 i=3 t=2.48e-04 per=1.29e+01 cost=5.15e+03 flops=2.08e+07
 sigma counter=30 i=4 t=2.37e-04 per=1.23e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=30 i=5 t=2.38e-04 per=1.23e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=30 i=6 t=2.49e-04 per=1.29e+01 cost=1.18e+04 flops=4.76e+07
 sigma counter=30 i=7 t=2.47e-04 per=1.28e+01 cost=1.18e+04 flops=4.80e+07
 total GEMM cost=5.42e+04 flops=2.81e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=5.95e-02 t_reduction=5.81e-03 tot=6.53e-02 ---
 sigma_tot counter=30 i=0 t=7.37e-03 per=1.24e+01 cost=1.56e+05 flops=2.11e+07
 sigma_tot counter=30 i=1 t=7.42e-03 per=1.25e+01 cost=1.54e+05 flops=2.08e+07
 sigma_tot counter=30 i=2 t=7.46e-03 per=1.26e+01 cost=1.59e+05 flops=2.12e+07
 sigma_tot counter=30 i=3 t=7.36e-03 per=1.24e+01 cost=1.58e+05 flops=2.14e+07
 sigma_tot counter=30 i=4 t=7.27e-03 per=1.22e+01 cost=1.79e+05 flops=2.47e+07
 sigma_tot counter=30 i=5 t=7.37e-03 per=1.24e+01 cost=1.78e+05 flops=2.42e+07
 sigma_tot counter=30 i=6 t=7.78e-03 per=1.31e+01 cost=3.45e+05 flops=4.44e+07
 sigma_tot counter=30 i=7 t=7.45e-03 per=1.25e+01 cost=3.45e+05 flops=4.63e+07
 total GEMM cost=1.67e+06 flops=2.82e+07
    4   0 -      -2.651086709263  -3.49e-05   2.38e-03    6     8   1.82e-02  2.27e-03
    4   1 -      -2.427625986194  -8.76e-05   4.41e-03    6     8   1.82e-02  2.27e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.93e-03,1.89e-04 cost=5.42e+04 flops[gemm]=2.81e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.89e-04 tot=2.12e-03 ---
 sigma counter=31 i=0 t=2.33e-04 per=1.21e+01 cost=5.06e+03 flops=2.17e+07
 sigma counter=31 i=1 t=2.38e-04 per=1.24e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=31 i=2 t=2.59e-04 per=1.34e+01 cost=5.18e+03 flops=2.00e+07
 sigma counter=31 i=3 t=2.36e-04 per=1.22e+01 cost=5.15e+03 flops=2.18e+07
 sigma counter=31 i=4 t=2.30e-04 per=1.19e+01 cost=5.06e+03 flops=2.20e+07
 sigma counter=31 i=5 t=2.35e-04 per=1.22e+01 cost=5.01e+03 flops=2.13e+07
 sigma counter=31 i=6 t=2.54e-04 per=1.32e+01 cost=1.18e+04 flops=4.66e+07
 sigma counter=31 i=7 t=2.42e-04 per=1.26e+01 cost=1.18e+04 flops=4.90e+07
 total GEMM cost=5.42e+04 flops=2.81e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=6.14e-02 t_reduction=6.00e-03 tot=6.74e-02 ---
 sigma_tot counter=31 i=0 t=7.60e-03 per=1.24e+01 cost=1.61e+05 flops=2.11e+07
 sigma_tot counter=31 i=1 t=7.66e-03 per=1.25e+01 cost=1.59e+05 flops=2.08e+07
 sigma_tot counter=31 i=2 t=7.72e-03 per=1.26e+01 cost=1.64e+05 flops=2.12e+07
 sigma_tot counter=31 i=3 t=7.59e-03 per=1.24e+01 cost=1.63e+05 flops=2.15e+07
 sigma_tot counter=31 i=4 t=7.50e-03 per=1.22e+01 cost=1.84e+05 flops=2.46e+07
 sigma_tot counter=31 i=5 t=7.60e-03 per=1.24e+01 cost=1.83e+05 flops=2.41e+07
 sigma_tot counter=31 i=6 t=8.03e-03 per=1.31e+01 cost=3.57e+05 flops=4.45e+07
 sigma_tot counter=31 i=7 t=7.70e-03 per=1.25e+01 cost=3.57e+05 flops=4.64e+07
 total GEMM cost=1.73e+06 flops=2.82e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.10e-05,1.90e-03,1.81e-04 cost=5.42e+04 flops[gemm]=2.84e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.90e-03 t_reduction=1.81e-04 tot=2.08e-03 ---
 sigma counter=32 i=0 t=2.37e-04 per=1.25e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=32 i=1 t=2.38e-04 per=1.25e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=32 i=2 t=2.30e-04 per=1.21e+01 cost=5.18e+03 flops=2.25e+07
 sigma counter=32 i=3 t=2.35e-04 per=1.24e+01 cost=5.15e+03 flops=2.19e+07
 sigma counter=32 i=4 t=2.33e-04 per=1.23e+01 cost=5.06e+03 flops=2.17e+07
 sigma counter=32 i=5 t=2.38e-04 per=1.25e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=32 i=6 t=2.52e-04 per=1.32e+01 cost=1.18e+04 flops=4.70e+07
 sigma counter=32 i=7 t=2.39e-04 per=1.26e+01 cost=1.18e+04 flops=4.96e+07
 total GEMM cost=5.42e+04 flops=2.85e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=6.33e-02 t_reduction=6.18e-03 tot=6.95e-02 ---
 sigma_tot counter=32 i=0 t=7.83e-03 per=1.24e+01 cost=1.66e+05 flops=2.11e+07
 sigma_tot counter=32 i=1 t=7.90e-03 per=1.25e+01 cost=1.64e+05 flops=2.08e+07
 sigma_tot counter=32 i=2 t=7.95e-03 per=1.26e+01 cost=1.69e+05 flops=2.12e+07
 sigma_tot counter=32 i=3 t=7.83e-03 per=1.24e+01 cost=1.68e+05 flops=2.15e+07
 sigma_tot counter=32 i=4 t=7.74e-03 per=1.22e+01 cost=1.89e+05 flops=2.45e+07
 sigma_tot counter=32 i=5 t=7.84e-03 per=1.24e+01 cost=1.88e+05 flops=2.40e+07
 sigma_tot counter=32 i=6 t=8.28e-03 per=1.31e+01 cost=3.69e+05 flops=4.46e+07
 sigma_tot counter=32 i=7 t=7.93e-03 per=1.25e+01 cost=3.69e+05 flops=4.65e+07
 total GEMM cost=1.78e+06 flops=2.82e+07
    5   0 -      -2.651091761462  -5.05e-06   1.21e-03    6    10   2.27e-02  2.27e-03
    5   1 -      -2.427640489990  -1.45e-05   1.74e-03    6    10   2.27e-02  2.27e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.93e-03,1.90e-04 cost=5.42e+04 flops[gemm]=2.80e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.90e-04 tot=2.12e-03 ---
 sigma counter=33 i=0 t=2.41e-04 per=1.25e+01 cost=5.06e+03 flops=2.10e+07
 sigma counter=33 i=1 t=2.40e-04 per=1.24e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=33 i=2 t=2.44e-04 per=1.26e+01 cost=5.18e+03 flops=2.12e+07
 sigma counter=33 i=3 t=2.35e-04 per=1.22e+01 cost=5.15e+03 flops=2.19e+07
 sigma counter=33 i=4 t=2.43e-04 per=1.26e+01 cost=5.06e+03 flops=2.08e+07
 sigma counter=33 i=5 t=2.35e-04 per=1.22e+01 cost=5.01e+03 flops=2.13e+07
 sigma counter=33 i=6 t=2.50e-04 per=1.29e+01 cost=1.18e+04 flops=4.74e+07
 sigma counter=33 i=7 t=2.43e-04 per=1.26e+01 cost=1.18e+04 flops=4.88e+07
 total GEMM cost=5.42e+04 flops=2.80e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=6.52e-02 t_reduction=6.37e-03 tot=7.16e-02 ---
 sigma_tot counter=33 i=0 t=8.08e-03 per=1.24e+01 cost=1.71e+05 flops=2.11e+07
 sigma_tot counter=33 i=1 t=8.14e-03 per=1.25e+01 cost=1.69e+05 flops=2.08e+07
 sigma_tot counter=33 i=2 t=8.20e-03 per=1.26e+01 cost=1.74e+05 flops=2.12e+07
 sigma_tot counter=33 i=3 t=8.06e-03 per=1.24e+01 cost=1.73e+05 flops=2.15e+07
 sigma_tot counter=33 i=4 t=7.98e-03 per=1.22e+01 cost=1.95e+05 flops=2.44e+07
 sigma_tot counter=33 i=5 t=8.07e-03 per=1.24e+01 cost=1.93e+05 flops=2.39e+07
 sigma_tot counter=33 i=6 t=8.53e-03 per=1.31e+01 cost=3.81e+05 flops=4.46e+07
 sigma_tot counter=33 i=7 t=8.18e-03 per=1.25e+01 cost=3.81e+05 flops=4.66e+07
 total GEMM cost=1.84e+06 flops=2.82e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.91e-03,1.84e-04 cost=5.42e+04 flops[gemm]=2.84e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.91e-03 t_reduction=1.84e-04 tot=2.09e-03 ---
 sigma counter=34 i=0 t=2.35e-04 per=1.23e+01 cost=5.06e+03 flops=2.15e+07
 sigma counter=34 i=1 t=2.37e-04 per=1.24e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=34 i=2 t=2.32e-04 per=1.22e+01 cost=5.18e+03 flops=2.23e+07
 sigma counter=34 i=3 t=2.37e-04 per=1.24e+01 cost=5.15e+03 flops=2.17e+07
 sigma counter=34 i=4 t=2.31e-04 per=1.21e+01 cost=5.06e+03 flops=2.19e+07
 sigma counter=34 i=5 t=2.36e-04 per=1.24e+01 cost=5.01e+03 flops=2.12e+07
 sigma counter=34 i=6 t=2.52e-04 per=1.32e+01 cost=1.18e+04 flops=4.70e+07
 sigma counter=34 i=7 t=2.49e-04 per=1.30e+01 cost=1.18e+04 flops=4.76e+07
 total GEMM cost=5.42e+04 flops=2.84e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=6.71e-02 t_reduction=6.55e-03 tot=7.37e-02 ---
 sigma_tot counter=34 i=0 t=8.31e-03 per=1.24e+01 cost=1.76e+05 flops=2.12e+07
 sigma_tot counter=34 i=1 t=8.37e-03 per=1.25e+01 cost=1.74e+05 flops=2.08e+07
 sigma_tot counter=34 i=2 t=8.43e-03 per=1.26e+01 cost=1.79e+05 flops=2.13e+07
 sigma_tot counter=34 i=3 t=8.30e-03 per=1.24e+01 cost=1.78e+05 flops=2.15e+07
 sigma_tot counter=34 i=4 t=8.21e-03 per=1.22e+01 cost=2.00e+05 flops=2.43e+07
 sigma_tot counter=34 i=5 t=8.31e-03 per=1.24e+01 cost=1.98e+05 flops=2.38e+07
 sigma_tot counter=34 i=6 t=8.78e-03 per=1.31e+01 cost=3.93e+05 flops=4.47e+07
 sigma_tot counter=34 i=7 t=8.43e-03 per=1.25e+01 cost=3.93e+05 flops=4.66e+07
 total GEMM cost=1.89e+06 flops=2.82e+07
    6   0 -      -2.651092751482  -9.90e-07   3.54e-04    6    12   2.72e-02  2.27e-03
    6   1 -      -2.427643024586  -2.53e-06   4.45e-04    6    12   2.72e-02  2.27e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.10e-05,1.93e-03,1.94e-04 cost=5.42e+04 flops[gemm]=2.81e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.94e-04 tot=2.12e-03 ---
 sigma counter=35 i=0 t=2.34e-04 per=1.22e+01 cost=5.06e+03 flops=2.16e+07
 sigma counter=35 i=1 t=2.38e-04 per=1.24e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=35 i=2 t=2.52e-04 per=1.31e+01 cost=5.18e+03 flops=2.05e+07
 sigma counter=35 i=3 t=2.35e-04 per=1.22e+01 cost=5.15e+03 flops=2.19e+07
 sigma counter=35 i=4 t=2.31e-04 per=1.20e+01 cost=5.06e+03 flops=2.19e+07
 sigma counter=35 i=5 t=2.36e-04 per=1.23e+01 cost=5.01e+03 flops=2.12e+07
 sigma counter=35 i=6 t=2.59e-04 per=1.35e+01 cost=1.18e+04 flops=4.57e+07
 sigma counter=35 i=7 t=2.40e-04 per=1.25e+01 cost=1.18e+04 flops=4.94e+07
 total GEMM cost=5.42e+04 flops=2.81e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=6.91e-02 t_reduction=6.75e-03 tot=7.58e-02 ---
 sigma_tot counter=35 i=0 t=8.55e-03 per=1.24e+01 cost=1.81e+05 flops=2.12e+07
 sigma_tot counter=35 i=1 t=8.61e-03 per=1.25e+01 cost=1.79e+05 flops=2.08e+07
 sigma_tot counter=35 i=2 t=8.68e-03 per=1.26e+01 cost=1.84e+05 flops=2.12e+07
 sigma_tot counter=35 i=3 t=8.53e-03 per=1.24e+01 cost=1.83e+05 flops=2.15e+07
 sigma_tot counter=35 i=4 t=8.44e-03 per=1.22e+01 cost=2.05e+05 flops=2.42e+07
 sigma_tot counter=35 i=5 t=8.55e-03 per=1.24e+01 cost=2.03e+05 flops=2.38e+07
 sigma_tot counter=35 i=6 t=9.04e-03 per=1.31e+01 cost=4.05e+05 flops=4.47e+07
 sigma_tot counter=35 i=7 t=8.67e-03 per=1.25e+01 cost=4.05e+05 flops=4.67e+07
 total GEMM cost=1.95e+06 flops=2.82e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.92e-03,1.83e-04 cost=5.42e+04 flops[gemm]=2.83e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.91e-03 t_reduction=1.83e-04 tot=2.10e-03 ---
 sigma counter=36 i=0 t=2.38e-04 per=1.24e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=36 i=1 t=2.44e-04 per=1.27e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=36 i=2 t=2.33e-04 per=1.22e+01 cost=5.18e+03 flops=2.22e+07
 sigma counter=36 i=3 t=2.33e-04 per=1.22e+01 cost=5.15e+03 flops=2.21e+07
 sigma counter=36 i=4 t=2.32e-04 per=1.21e+01 cost=5.06e+03 flops=2.18e+07
 sigma counter=36 i=5 t=2.45e-04 per=1.28e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=36 i=6 t=2.48e-04 per=1.30e+01 cost=1.18e+04 flops=4.78e+07
 sigma counter=36 i=7 t=2.41e-04 per=1.26e+01 cost=1.18e+04 flops=4.92e+07
 total GEMM cost=5.42e+04 flops=2.83e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=7.10e-02 t_reduction=6.93e-03 tot=7.79e-02 ---
 sigma_tot counter=36 i=0 t=8.78e-03 per=1.24e+01 cost=1.86e+05 flops=2.12e+07
 sigma_tot counter=36 i=1 t=8.86e-03 per=1.25e+01 cost=1.84e+05 flops=2.08e+07
 sigma_tot counter=36 i=2 t=8.91e-03 per=1.26e+01 cost=1.90e+05 flops=2.13e+07
 sigma_tot counter=36 i=3 t=8.77e-03 per=1.24e+01 cost=1.89e+05 flops=2.15e+07
 sigma_tot counter=36 i=4 t=8.67e-03 per=1.22e+01 cost=2.10e+05 flops=2.42e+07
 sigma_tot counter=36 i=5 t=8.79e-03 per=1.24e+01 cost=2.08e+05 flops=2.37e+07
 sigma_tot counter=36 i=6 t=9.29e-03 per=1.31e+01 cost=4.16e+05 flops=4.48e+07
 sigma_tot counter=36 i=7 t=8.91e-03 per=1.25e+01 cost=4.16e+05 flops=4.68e+07
 total GEMM cost=2.00e+06 flops=2.82e+07
    7   0 +      -2.651092827334  -7.59e-08   9.15e-05    6    14   3.18e-02  2.27e-03
    7   1 -      -2.427643167055  -1.42e-07   1.33e-04    6    14   3.18e-02  2.27e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=3.00e-05,1.91e-03,2.01e-04 cost=5.42e+04 flops[gemm]=2.83e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.91e-03 t_reduction=2.01e-04 tot=2.11e-03 ---
 sigma counter=37 i=0 t=2.33e-04 per=1.22e+01 cost=5.06e+03 flops=2.17e+07
 sigma counter=37 i=1 t=2.35e-04 per=1.23e+01 cost=5.01e+03 flops=2.13e+07
 sigma counter=37 i=2 t=2.47e-04 per=1.29e+01 cost=5.18e+03 flops=2.10e+07
 sigma counter=37 i=3 t=2.34e-04 per=1.22e+01 cost=5.15e+03 flops=2.20e+07
 sigma counter=37 i=4 t=2.41e-04 per=1.26e+01 cost=5.06e+03 flops=2.10e+07
 sigma counter=37 i=5 t=2.36e-04 per=1.23e+01 cost=5.01e+03 flops=2.12e+07
 sigma counter=37 i=6 t=2.50e-04 per=1.31e+01 cost=1.18e+04 flops=4.74e+07
 sigma counter=37 i=7 t=2.37e-04 per=1.24e+01 cost=1.18e+04 flops=5.00e+07
 total GEMM cost=5.42e+04 flops=2.83e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=7.29e-02 t_reduction=7.13e-03 tot=8.00e-02 ---
 sigma_tot counter=37 i=0 t=9.02e-03 per=1.24e+01 cost=1.91e+05 flops=2.12e+07
 sigma_tot counter=37 i=1 t=9.09e-03 per=1.25e+01 cost=1.89e+05 flops=2.08e+07
 sigma_tot counter=37 i=2 t=9.16e-03 per=1.26e+01 cost=1.95e+05 flops=2.13e+07
 sigma_tot counter=37 i=3 t=9.00e-03 per=1.23e+01 cost=1.94e+05 flops=2.15e+07
 sigma_tot counter=37 i=4 t=8.91e-03 per=1.22e+01 cost=2.15e+05 flops=2.41e+07
 sigma_tot counter=37 i=5 t=9.03e-03 per=1.24e+01 cost=2.13e+05 flops=2.36e+07
 sigma_tot counter=37 i=6 t=9.54e-03 per=1.31e+01 cost=4.28e+05 flops=4.49e+07
 sigma_tot counter=37 i=7 t=9.14e-03 per=1.25e+01 cost=4.28e+05 flops=4.68e+07
 total GEMM cost=2.05e+06 flops=2.82e+07
    8   0 +      -2.651092827334  -3.75e-13   9.15e-05    5    15   3.41e-02  2.27e-03
    8   1 +      -2.427643182575  -1.55e-08   5.44e-05    5    15   3.41e-02  2.27e-03
TIMING for Davidson : 3.41e-02  T(cal/comm/rest)=3.36e-02,7.52e-07,5.07e-04
optimized energies: isweep=0 dots=2 ibond=2 e[0]=-2.65109282733
optimized energies: isweep=0 dots=2 ibond=2 e[1]=-2.42764318258
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: 16->10 dwt=+1.379e-03 SvN=1.072e+00
===== CPUmem(GB): tot=1.612e-05 (comb,oper,dvdson,hvec,renorm)=1.647e-06,1.448e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=764:5.829e-03MB:5.692e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=2.176e-06 (oper)(GB)=2.176e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=8.062e-06 (oper,qops,site)(GB)=2.176e-06,5.692e-06,1.937e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.955e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.06e-06 (oper,qops,site,rinter)(GB)=2.18e-06,5.69e-06,1.94e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000441 S size(rtasks)=63 size(Rlst)=784 T(Rmu/Rxlist/sort)=7.6e-05,0.000195,0.00017 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000201 (oper,qops,site,rinter,batch)(GB)=2.18e-06,5.69e-06,1.94e-07,0,0.000193
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00105,0.000182 cost=1.92e+04 flops[gemm]=1.83e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00105 t_reduction=0.000182 tot=0.00123 ---
 renorm counter=3 i=0 t=0.000213 per=20.2 cost=1.18e+03 flops=5.52e+06
 renorm counter=3 i=1 t=0.000209 per=19.9 cost=2.13e+03 flops=1.02e+07
 renorm counter=3 i=2 t=0.000203 per=19.3 cost=1.23e+03 flops=6.08e+06
 renorm counter=3 i=3 t=0.000208 per=19.8 cost=2.07e+03 flops=9.94e+06
 renorm counter=3 i=4 t=1e-06 per=0.0951 cost=0 flops=0
 renorm counter=3 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=3 i=6 t=0.000218 per=20.7 cost=1.26e+04 flops=5.79e+07
 total GEMM cost=1.92e+04 flops=1.83e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0033 t_reduction=0.00056 tot=0.00385 ---
 renorm_tot counter=3 i=0 t=0.000674 per=20.5 cost=5.14e+03 flops=7.62e+06
 renorm_tot counter=3 i=1 t=0.000641 per=19.5 cost=6.81e+03 flops=1.06e+07
 renorm_tot counter=3 i=2 t=0.000205 per=6.22 cost=1.23e+03 flops=6.02e+06
 renorm_tot counter=3 i=3 t=0.00021 per=6.37 cost=2.07e+03 flops=9.85e+06
 renorm_tot counter=3 i=4 t=0.00043 per=13.1 cost=5.71e+03 flops=1.33e+07
 renorm_tot counter=3 i=5 t=0.000438 per=13.3 cost=1.06e+04 flops=2.42e+07
 renorm_tot counter=3 i=6 t=0.000697 per=21.2 cost=4.7e+04 flops=6.74e+07
 total GEMM cost=7.85e+04 flops=2.38e+07
check ||H-H.dagger||=3.14e-16 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=0.00019,0.0025,1.1e-05 rank=0 -----
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=120:0.00092MB:8.9e-07GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=124:0.00095MB:9.2e-07GB
total mem of comb=287:0.0022MB:2.1e-06GB
===== CPUmem(GB): tot=2.2e-05 (comb,oper,dvdson,hvec,renorm)=2.1e-06,2e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=5.69e-06GB T[save](info/data/tot)=4.65e-05,4.07e-05,8.73e-05 speed=0.0652GB/s disk[used]=5.66e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 4.33e-02 S #####
 T(fetch) = 1.11e-04 S  per = 0.26  per(accum) = 0.26
 T(hdiag) = 1.08e-04 S  per = 0.25  per(accum) = 0.5
 T(dvdsn) = 3.93e-02 S  per =   91  per(accum) = 91
 T(decim) = 3.19e-04 S  per = 0.74  per(accum) = 92
 T(guess) = 9.49e-05 S  per = 0.22  per(accum) = 92
 T(renrm) = 2.75e-03 S  per =  6.3  per(accum) = 99
 T(save ) = 6.34e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.90e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.39e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 3.48e-04 S  per = 0.89  per(accum) = 1
 T(hintermediate init           ) = 2.31e-04 S  per = 0.59  per(accum) = 1.6
 T(hintermediates memcpy cpu2gpu) = 5.54e-06 S  per = 0.014  per(accum) = 1.6
 T(preprocess_hformulae_Hxlist2 ) = 2.72e-03 S  per =    7  per(accum) = 8.6
 T(hmmtasks init                ) = 1.60e-03 S  per =  4.1  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 3.36e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 7.52e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.07e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.70e-03 S
 T(qops init                    ) = 1.95e-04 S  per =  7.2  per(accum) = 7.2
 T(qops_dict memcpy cpu2gpu     ) = 5.05e-05 S  per =  1.9  per(accum) = 9.1
 T(symbolic_formulae_renorm     ) = 3.02e-04 S  per =   11  per(accum) = 20
 T(rintermediate init           ) = 1.65e-05 S  per = 0.61  per(accum) = 21
 T(rintermediates memcpy cpu2gpu) = 6.68e-06 S  per = 0.25  per(accum) = 21
 T(preprocess_formulae_Rlist2   ) = 4.51e-04 S  per =   17  per(accum) = 38
 T(rmmtasks init                ) = 2.90e-04 S  per =   11  per(accum) = 49
 T(qops memset                  ) = 1.02e-05 S  per = 0.38  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.33e-03 S  per =   49  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 3.49e-05 S  per =  1.3  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.11e-05 S  per = 0.41  per(accum) = 1e+02
##### time_sweep: 1.22e-01 S #####
 T(fetch) = 1.41e-03 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 4.13e-04 S  per = 0.34  per(accum) = 1.5
 T(dvdsn) = 1.07e-01 S  per =   88  per(accum) = 89
 T(decim) = 1.17e-03 S  per = 0.96  per(accum) = 90
 T(guess) = 3.36e-04 S  per = 0.27  per(accum) = 91
 T(renrm) = 9.40e-03 S  per =  7.7  per(accum) = 98
 T(save ) = 2.15e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.06e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.44e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 1.28e-03 S  per =  1.2  per(accum) = 1.3
 T(hintermediate init           ) = 7.90e-04 S  per = 0.74  per(accum) = 2.1
 T(hintermediates memcpy cpu2gpu) = 2.05e-05 S  per = 0.019  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 1.08e-02 S  per =   10  per(accum) = 12
 T(hmmtasks init                ) = 6.35e-03 S  per =    6  per(accum) = 18
 T(dvdson solver [Hx_batchGPU]  ) = 8.55e-02 S  per =   80  per(accum) = 99
 T(dvdson solver [communication]) = 2.17e-06 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.43e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 9.21e-03 S
 T(qops init                    ) = 6.10e-04 S  per =  6.6  per(accum) = 6.6
 T(qops_dict memcpy cpu2gpu     ) = 1.46e-04 S  per =  1.6  per(accum) = 8.2
 T(symbolic_formulae_renorm     ) = 9.92e-04 S  per =   11  per(accum) = 19
 T(rintermediate init           ) = 2.72e-04 S  per =  2.9  per(accum) = 22
 T(rintermediates memcpy cpu2gpu) = 2.24e-05 S  per = 0.24  per(accum) = 22
 T(preprocess_formulae_Rlist2   ) = 1.68e-03 S  per =   18  per(accum) = 40
 T(rmmtasks init                ) = 1.11e-03 S  per =   12  per(accum) = 52
 T(qops memset                  ) = 3.23e-05 S  per = 0.35  per(accum) = 53
 T(preprocess_renorm_batchGPU   ) = 4.20e-03 S  per =   46  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.10e-04 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.74e-05 S  per = 0.41  per(accum) = 1e+02
##### time_global: 1.22e-01 S #####
 T(fetch) = 1.41e-03 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 4.13e-04 S  per = 0.34  per(accum) = 1.5
 T(dvdsn) = 1.07e-01 S  per =   88  per(accum) = 89
 T(decim) = 1.17e-03 S  per = 0.96  per(accum) = 90
 T(guess) = 3.36e-04 S  per = 0.27  per(accum) = 91
 T(renrm) = 9.40e-03 S  per =  7.7  per(accum) = 98
 T(save ) = 2.15e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.06e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.44e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 1.28e-03 S  per =  1.2  per(accum) = 1.3
 T(hintermediate init           ) = 7.90e-04 S  per = 0.74  per(accum) = 2.1
 T(hintermediates memcpy cpu2gpu) = 2.05e-05 S  per = 0.019  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 1.08e-02 S  per =   10  per(accum) = 12
 T(hmmtasks init                ) = 6.35e-03 S  per =    6  per(accum) = 18
 T(dvdson solver [Hx_batchGPU]  ) = 8.55e-02 S  per =   80  per(accum) = 99
 T(dvdson solver [communication]) = 2.17e-06 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.43e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 9.21e-03 S
 T(qops init                    ) = 6.10e-04 S  per =  6.6  per(accum) = 6.6
 T(qops_dict memcpy cpu2gpu     ) = 1.46e-04 S  per =  1.6  per(accum) = 8.2
 T(symbolic_formulae_renorm     ) = 9.92e-04 S  per =   11  per(accum) = 19
 T(rintermediate init           ) = 2.72e-04 S  per =  2.9  per(accum) = 22
 T(rintermediates memcpy cpu2gpu) = 2.24e-05 S  per = 0.24  per(accum) = 22
 T(preprocess_formulae_Rlist2   ) = 1.68e-03 S  per =   18  per(accum) = 40
 T(rmmtasks init                ) = 1.11e-03 S  per =   12  per(accum) = 52
 T(qops memset                  ) = 3.23e-05 S  per = 0.35  per(accum) = 53
 T(preprocess_renorm_batchGPU   ) = 4.20e-03 S  per =   46  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.10e-04 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.74e-05 S  per = 0.41  per(accum) = 1e+02

isweep=0 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 3.396e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=120:0.000916MB:8.94e-07GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=124:0.000946MB:9.24e-07GB
total mem of comb=287:0.00219MB:2.14e-06GB
===== CPUmem(GB): tot=1.11e-05 (comb,oper,dvdson,hvec,renorm)=2.14e-06,8.96e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x47c89d30
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,1):2 (1,-1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.96e-06 (oper)(GB)=8.96e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.263e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=506:0.00386MB:3.77e-06GB
cost_hinter=2.02e+03 time=0.00017 flops=1.19e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.219e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.27e-05 (oper,hinter)(GB)=8.96e-06,3.77e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00172 S size(H_formulae)=188 size(Hxlst)=3136 T(Hmu/Hxlist/sort)=7.87e-05,0.000844,0.000795 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000224 (oper,hinter,dvdson,batch)(GB)=8.96e-06,3.77e-06,1.07e-06,0.00021
===== CPUmem(GB): tot=2.18e-05 (comb,oper,dvdson,hvec,renorm)=2.14e-06,8.96e-06,1.07e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=72 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.9e-05,0.00183,0.000183 cost=4.52e+04 flops[gemm]=2.47e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00183 t_reduction=0.000183 tot=0.00201 ---
 sigma counter=38 i=0 t=0.000233 per=12.7 cost=3.82e+03 flops=1.64e+07
 sigma counter=38 i=1 t=0.000233 per=12.7 cost=4.32e+03 flops=1.85e+07
 sigma counter=38 i=2 t=0.000224 per=12.2 cost=3.83e+03 flops=1.71e+07
 sigma counter=38 i=3 t=0.000222 per=12.1 cost=4.12e+03 flops=1.86e+07
 sigma counter=38 i=4 t=0.000226 per=12.3 cost=1.06e+04 flops=4.68e+07
 sigma counter=38 i=5 t=0.000238 per=13 cost=1.06e+04 flops=4.44e+07
 sigma counter=38 i=6 t=0.000226 per=12.3 cost=4.12e+03 flops=1.82e+07
 sigma counter=38 i=7 t=0.000228 per=12.5 cost=3.83e+03 flops=1.68e+07
 total GEMM cost=4.52e+04 flops=2.47e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.0747 t_reduction=0.00732 tot=0.082 ---
 sigma_tot counter=38 i=0 t=0.00925 per=12.4 cost=1.95e+05 flops=2.11e+07
 sigma_tot counter=38 i=1 t=0.00932 per=12.5 cost=1.94e+05 flops=2.08e+07
 sigma_tot counter=38 i=2 t=0.00939 per=12.6 cost=1.99e+05 flops=2.12e+07
 sigma_tot counter=38 i=3 t=0.00922 per=12.3 cost=1.98e+05 flops=2.15e+07
 sigma_tot counter=38 i=4 t=0.00914 per=12.2 cost=2.25e+05 flops=2.47e+07
 sigma_tot counter=38 i=5 t=0.00927 per=12.4 cost=2.24e+05 flops=2.42e+07
 sigma_tot counter=38 i=6 t=0.00977 per=13.1 cost=4.32e+05 flops=4.43e+07
 sigma_tot counter=38 i=7 t=0.00937 per=12.5 cost=4.32e+05 flops=4.61e+07
 total GEMM cost=2.1e+06 flops=2.81e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.9e-05,0.00178,0.000184 cost=4.52e+04 flops[gemm]=2.53e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00178 t_reduction=0.000184 tot=0.00197 ---
 sigma counter=39 i=0 t=0.000236 per=13.2 cost=3.82e+03 flops=1.62e+07
 sigma counter=39 i=1 t=0.000218 per=12.2 cost=4.32e+03 flops=1.98e+07
 sigma counter=39 i=2 t=0.00022 per=12.3 cost=3.83e+03 flops=1.74e+07
 sigma counter=39 i=3 t=0.000216 per=12.1 cost=4.12e+03 flops=1.91e+07
 sigma counter=39 i=4 t=0.00022 per=12.3 cost=1.06e+04 flops=4.8e+07
 sigma counter=39 i=5 t=0.000235 per=13.2 cost=1.06e+04 flops=4.5e+07
 sigma counter=39 i=6 t=0.000222 per=12.4 cost=4.12e+03 flops=1.86e+07
 sigma counter=39 i=7 t=0.000218 per=12.2 cost=3.83e+03 flops=1.76e+07
 total GEMM cost=4.52e+04 flops=2.53e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.0765 t_reduction=0.0075 tot=0.084 ---
 sigma_tot counter=39 i=0 t=0.00949 per=12.4 cost=1.99e+05 flops=2.09e+07
 sigma_tot counter=39 i=1 t=0.00954 per=12.5 cost=1.98e+05 flops=2.08e+07
 sigma_tot counter=39 i=2 t=0.00961 per=12.6 cost=2.02e+05 flops=2.11e+07
 sigma_tot counter=39 i=3 t=0.00944 per=12.3 cost=2.02e+05 flops=2.14e+07
 sigma_tot counter=39 i=4 t=0.00936 per=12.2 cost=2.36e+05 flops=2.52e+07
 sigma_tot counter=39 i=5 t=0.0095 per=12.4 cost=2.34e+05 flops=2.47e+07
 sigma_tot counter=39 i=6 t=0.00999 per=13.1 cost=4.36e+05 flops=4.37e+07
 sigma_tot counter=39 i=7 t=0.00959 per=12.5 cost=4.36e+05 flops=4.55e+07
 total GEMM cost=2.14e+06 flops=2.8e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.649584713313  -1.00e+03   5.61e-02    2     2   4.27e-03  2.14e-03
    1   1 -      -2.422873629958  -1.00e+03   1.13e-01    2     2   4.27e-03  2.14e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=3.00e-05,1.79e-03,1.83e-04 cost=4.52e+04 flops[gemm]=2.52e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.79e-03 t_reduction=1.83e-04 tot=1.98e-03 ---
 sigma counter=40 i=0 t=2.35e-04 per=1.31e+01 cost=3.82e+03 flops=1.63e+07
 sigma counter=40 i=1 t=2.23e-04 per=1.24e+01 cost=4.32e+03 flops=1.94e+07
 sigma counter=40 i=2 t=2.27e-04 per=1.27e+01 cost=3.83e+03 flops=1.69e+07
 sigma counter=40 i=3 t=2.17e-04 per=1.21e+01 cost=4.12e+03 flops=1.90e+07
 sigma counter=40 i=4 t=2.26e-04 per=1.26e+01 cost=1.06e+04 flops=4.68e+07
 sigma counter=40 i=5 t=2.23e-04 per=1.24e+01 cost=1.06e+04 flops=4.74e+07
 sigma counter=40 i=6 t=2.25e-04 per=1.25e+01 cost=4.12e+03 flops=1.83e+07
 sigma counter=40 i=7 t=2.18e-04 per=1.22e+01 cost=3.83e+03 flops=1.76e+07
 total GEMM cost=4.52e+04 flops=2.52e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=7.83e-02 t_reduction=7.68e-03 tot=8.60e-02 ---
 sigma_tot counter=40 i=0 t=9.72e-03 per=1.24e+01 cost=2.02e+05 flops=2.08e+07
 sigma_tot counter=40 i=1 t=9.76e-03 per=1.25e+01 cost=2.02e+05 flops=2.07e+07
 sigma_tot counter=40 i=2 t=9.83e-03 per=1.26e+01 cost=2.06e+05 flops=2.10e+07
 sigma_tot counter=40 i=3 t=9.66e-03 per=1.23e+01 cost=2.06e+05 flops=2.13e+07
 sigma_tot counter=40 i=4 t=9.59e-03 per=1.22e+01 cost=2.46e+05 flops=2.57e+07
 sigma_tot counter=40 i=5 t=9.72e-03 per=1.24e+01 cost=2.45e+05 flops=2.52e+07
 sigma_tot counter=40 i=6 t=1.02e-02 per=1.30e+01 cost=4.41e+05 flops=4.31e+07
 sigma_tot counter=40 i=7 t=9.81e-03 per=1.25e+01 cost=4.40e+05 flops=4.48e+07
 total GEMM cost=2.19e+06 flops=2.80e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.77e-03,1.83e-04 cost=4.52e+04 flops[gemm]=2.56e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.77e-03 t_reduction=1.83e-04 tot=1.95e-03 ---
 sigma counter=41 i=0 t=2.25e-04 per=1.27e+01 cost=3.82e+03 flops=1.70e+07
 sigma counter=41 i=1 t=2.18e-04 per=1.23e+01 cost=4.32e+03 flops=1.98e+07
 sigma counter=41 i=2 t=2.18e-04 per=1.23e+01 cost=3.83e+03 flops=1.76e+07
 sigma counter=41 i=3 t=2.23e-04 per=1.26e+01 cost=4.12e+03 flops=1.85e+07
 sigma counter=41 i=4 t=2.22e-04 per=1.26e+01 cost=1.06e+04 flops=4.76e+07
 sigma counter=41 i=5 t=2.21e-04 per=1.25e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=41 i=6 t=2.23e-04 per=1.26e+01 cost=4.12e+03 flops=1.85e+07
 sigma counter=41 i=7 t=2.18e-04 per=1.23e+01 cost=3.83e+03 flops=1.76e+07
 total GEMM cost=4.52e+04 flops=2.56e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=8.01e-02 t_reduction=7.87e-03 tot=8.79e-02 ---
 sigma_tot counter=41 i=0 t=9.95e-03 per=1.24e+01 cost=2.06e+05 flops=2.07e+07
 sigma_tot counter=41 i=1 t=9.98e-03 per=1.25e+01 cost=2.07e+05 flops=2.07e+07
 sigma_tot counter=41 i=2 t=1.01e-02 per=1.26e+01 cost=2.10e+05 flops=2.09e+07
 sigma_tot counter=41 i=3 t=9.88e-03 per=1.23e+01 cost=2.10e+05 flops=2.13e+07
 sigma_tot counter=41 i=4 t=9.81e-03 per=1.22e+01 cost=2.57e+05 flops=2.62e+07
 sigma_tot counter=41 i=5 t=9.94e-03 per=1.24e+01 cost=2.55e+05 flops=2.57e+07
 sigma_tot counter=41 i=6 t=1.04e-02 per=1.30e+01 cost=4.45e+05 flops=4.26e+07
 sigma_tot counter=41 i=7 t=1.00e-02 per=1.25e+01 cost=4.44e+05 flops=4.42e+07
 total GEMM cost=2.23e+06 flops=2.79e+07
    2   0 -      -2.651942776194  -2.36e-03   1.27e-02    4     4   8.52e-03  2.13e-03
    2   1 -      -2.430205342757  -7.33e-03   2.58e-02    4     4   8.52e-03  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.79e-03,1.84e-04 cost=4.52e+04 flops[gemm]=2.53e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.79e-03 t_reduction=1.84e-04 tot=1.97e-03 ---
 sigma counter=42 i=0 t=2.24e-04 per=1.25e+01 cost=3.82e+03 flops=1.71e+07
 sigma counter=42 i=1 t=2.27e-04 per=1.27e+01 cost=4.32e+03 flops=1.90e+07
 sigma counter=42 i=2 t=2.15e-04 per=1.20e+01 cost=3.83e+03 flops=1.78e+07
 sigma counter=42 i=3 t=2.37e-04 per=1.33e+01 cost=4.12e+03 flops=1.74e+07
 sigma counter=42 i=4 t=2.20e-04 per=1.23e+01 cost=1.06e+04 flops=4.80e+07
 sigma counter=42 i=5 t=2.23e-04 per=1.25e+01 cost=1.06e+04 flops=4.74e+07
 sigma counter=42 i=6 t=2.22e-04 per=1.24e+01 cost=4.12e+03 flops=1.86e+07
 sigma counter=42 i=7 t=2.19e-04 per=1.23e+01 cost=3.83e+03 flops=1.75e+07
 total GEMM cost=4.52e+04 flops=2.53e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=8.19e-02 t_reduction=8.05e-03 tot=8.99e-02 ---
 sigma_tot counter=42 i=0 t=1.02e-02 per=1.24e+01 cost=2.10e+05 flops=2.07e+07
 sigma_tot counter=42 i=1 t=1.02e-02 per=1.25e+01 cost=2.11e+05 flops=2.07e+07
 sigma_tot counter=42 i=2 t=1.03e-02 per=1.25e+01 cost=2.14e+05 flops=2.08e+07
 sigma_tot counter=42 i=3 t=1.01e-02 per=1.24e+01 cost=2.14e+05 flops=2.12e+07
 sigma_tot counter=42 i=4 t=1.00e-02 per=1.23e+01 cost=2.68e+05 flops=2.67e+07
 sigma_tot counter=42 i=5 t=1.02e-02 per=1.24e+01 cost=2.66e+05 flops=2.62e+07
 sigma_tot counter=42 i=6 t=1.07e-02 per=1.30e+01 cost=4.49e+05 flops=4.21e+07
 sigma_tot counter=42 i=7 t=1.02e-02 per=1.25e+01 cost=4.47e+05 flops=4.37e+07
 total GEMM cost=2.28e+06 flops=2.78e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.79e-03,1.84e-04 cost=4.52e+04 flops[gemm]=2.53e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.79e-03 t_reduction=1.84e-04 tot=1.97e-03 ---
 sigma counter=43 i=0 t=2.26e-04 per=1.26e+01 cost=3.82e+03 flops=1.69e+07
 sigma counter=43 i=1 t=2.21e-04 per=1.24e+01 cost=4.32e+03 flops=1.95e+07
 sigma counter=43 i=2 t=2.28e-04 per=1.28e+01 cost=3.83e+03 flops=1.68e+07
 sigma counter=43 i=3 t=2.19e-04 per=1.23e+01 cost=4.12e+03 flops=1.88e+07
 sigma counter=43 i=4 t=2.21e-04 per=1.24e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=43 i=5 t=2.23e-04 per=1.25e+01 cost=1.06e+04 flops=4.74e+07
 sigma counter=43 i=6 t=2.22e-04 per=1.24e+01 cost=4.12e+03 flops=1.86e+07
 sigma counter=43 i=7 t=2.27e-04 per=1.27e+01 cost=3.83e+03 flops=1.69e+07
 total GEMM cost=4.52e+04 flops=2.53e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=8.36e-02 t_reduction=8.23e-03 tot=9.19e-02 ---
 sigma_tot counter=43 i=0 t=1.04e-02 per=1.24e+01 cost=2.14e+05 flops=2.06e+07
 sigma_tot counter=43 i=1 t=1.04e-02 per=1.25e+01 cost=2.15e+05 flops=2.06e+07
 sigma_tot counter=43 i=2 t=1.05e-02 per=1.25e+01 cost=2.18e+05 flops=2.08e+07
 sigma_tot counter=43 i=3 t=1.03e-02 per=1.24e+01 cost=2.18e+05 flops=2.11e+07
 sigma_tot counter=43 i=4 t=1.02e-02 per=1.23e+01 cost=2.78e+05 flops=2.71e+07
 sigma_tot counter=43 i=5 t=1.04e-02 per=1.24e+01 cost=2.77e+05 flops=2.66e+07
 sigma_tot counter=43 i=6 t=1.09e-02 per=1.30e+01 cost=4.53e+05 flops=4.16e+07
 sigma_tot counter=43 i=7 t=1.05e-02 per=1.25e+01 cost=4.51e+05 flops=4.31e+07
 total GEMM cost=2.32e+06 flops=2.78e+07
    3   0 -      -2.652054181748  -1.11e-04   5.06e-03    6     6   1.28e-02  2.13e-03
    3   1 -      -2.430611176914  -4.06e-04   9.32e-03    6     6   1.28e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.10e-05,1.81e-03,1.79e-04 cost=4.52e+04 flops[gemm]=2.49e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.79e-04 tot=1.99e-03 ---
 sigma counter=44 i=0 t=2.24e-04 per=1.24e+01 cost=3.82e+03 flops=1.71e+07
 sigma counter=44 i=1 t=2.29e-04 per=1.26e+01 cost=4.32e+03 flops=1.89e+07
 sigma counter=44 i=2 t=2.42e-04 per=1.33e+01 cost=3.83e+03 flops=1.58e+07
 sigma counter=44 i=3 t=2.20e-04 per=1.21e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=44 i=4 t=2.22e-04 per=1.22e+01 cost=1.06e+04 flops=4.76e+07
 sigma counter=44 i=5 t=2.26e-04 per=1.25e+01 cost=1.06e+04 flops=4.68e+07
 sigma counter=44 i=6 t=2.31e-04 per=1.27e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=44 i=7 t=2.19e-04 per=1.21e+01 cost=3.83e+03 flops=1.75e+07
 total GEMM cost=4.52e+04 flops=2.49e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=8.55e-02 t_reduction=8.41e-03 tot=9.39e-02 ---
 sigma_tot counter=44 i=0 t=1.06e-02 per=1.24e+01 cost=2.18e+05 flops=2.05e+07
 sigma_tot counter=44 i=1 t=1.07e-02 per=1.25e+01 cost=2.20e+05 flops=2.06e+07
 sigma_tot counter=44 i=2 t=1.07e-02 per=1.26e+01 cost=2.22e+05 flops=2.06e+07
 sigma_tot counter=44 i=3 t=1.06e-02 per=1.24e+01 cost=2.23e+05 flops=2.11e+07
 sigma_tot counter=44 i=4 t=1.05e-02 per=1.23e+01 cost=2.89e+05 flops=2.76e+07
 sigma_tot counter=44 i=5 t=1.06e-02 per=1.24e+01 cost=2.87e+05 flops=2.71e+07
 sigma_tot counter=44 i=6 t=1.11e-02 per=1.30e+01 cost=4.57e+05 flops=4.11e+07
 sigma_tot counter=44 i=7 t=1.07e-02 per=1.25e+01 cost=4.55e+05 flops=4.26e+07
 total GEMM cost=2.37e+06 flops=2.77e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.78e-03,1.76e-04 cost=4.52e+04 flops[gemm]=2.54e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.78e-03 t_reduction=1.76e-04 tot=1.96e-03 ---
 sigma counter=45 i=0 t=2.21e-04 per=1.24e+01 cost=3.82e+03 flops=1.73e+07
 sigma counter=45 i=1 t=2.27e-04 per=1.28e+01 cost=4.32e+03 flops=1.90e+07
 sigma counter=45 i=2 t=2.18e-04 per=1.23e+01 cost=3.83e+03 flops=1.76e+07
 sigma counter=45 i=3 t=2.16e-04 per=1.21e+01 cost=4.12e+03 flops=1.91e+07
 sigma counter=45 i=4 t=2.23e-04 per=1.25e+01 cost=1.06e+04 flops=4.74e+07
 sigma counter=45 i=5 t=2.24e-04 per=1.26e+01 cost=1.06e+04 flops=4.72e+07
 sigma counter=45 i=6 t=2.32e-04 per=1.30e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=45 i=7 t=2.18e-04 per=1.23e+01 cost=3.83e+03 flops=1.76e+07
 total GEMM cost=4.52e+04 flops=2.54e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=8.72e-02 t_reduction=8.59e-03 tot=9.58e-02 ---
 sigma_tot counter=45 i=0 t=1.08e-02 per=1.24e+01 cost=2.22e+05 flops=2.04e+07
 sigma_tot counter=45 i=1 t=1.09e-02 per=1.25e+01 cost=2.24e+05 flops=2.06e+07
 sigma_tot counter=45 i=2 t=1.10e-02 per=1.26e+01 cost=2.25e+05 flops=2.06e+07
 sigma_tot counter=45 i=3 t=1.08e-02 per=1.23e+01 cost=2.27e+05 flops=2.10e+07
 sigma_tot counter=45 i=4 t=1.07e-02 per=1.23e+01 cost=2.99e+05 flops=2.80e+07
 sigma_tot counter=45 i=5 t=1.08e-02 per=1.24e+01 cost=2.98e+05 flops=2.75e+07
 sigma_tot counter=45 i=6 t=1.13e-02 per=1.30e+01 cost=4.61e+05 flops=4.07e+07
 sigma_tot counter=45 i=7 t=1.09e-02 per=1.25e+01 cost=4.59e+05 flops=4.21e+07
 total GEMM cost=2.41e+06 flops=2.77e+07
    4   0 -      -2.652078566392  -2.44e-05   1.91e-03    6     8   1.70e-02  2.13e-03
    4   1 -      -2.430673358958  -6.22e-05   4.16e-03    6     8   1.70e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.80e-03,1.78e-04 cost=4.52e+04 flops[gemm]=2.51e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.80e-03 t_reduction=1.77e-04 tot=1.98e-03 ---
 sigma counter=46 i=0 t=2.22e-04 per=1.23e+01 cost=3.82e+03 flops=1.72e+07
 sigma counter=46 i=1 t=2.25e-04 per=1.25e+01 cost=4.32e+03 flops=1.92e+07
 sigma counter=46 i=2 t=2.25e-04 per=1.25e+01 cost=3.83e+03 flops=1.70e+07
 sigma counter=46 i=3 t=2.31e-04 per=1.28e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=46 i=4 t=2.20e-04 per=1.22e+01 cost=1.06e+04 flops=4.80e+07
 sigma counter=46 i=5 t=2.34e-04 per=1.30e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=46 i=6 t=2.25e-04 per=1.25e+01 cost=4.12e+03 flops=1.83e+07
 sigma counter=46 i=7 t=2.18e-04 per=1.21e+01 cost=3.83e+03 flops=1.76e+07
 total GEMM cost=4.52e+04 flops=2.51e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=8.90e-02 t_reduction=8.77e-03 tot=9.78e-02 ---
 sigma_tot counter=46 i=0 t=1.11e-02 per=1.24e+01 cost=2.25e+05 flops=2.04e+07
 sigma_tot counter=46 i=1 t=1.11e-02 per=1.25e+01 cost=2.28e+05 flops=2.05e+07
 sigma_tot counter=46 i=2 t=1.12e-02 per=1.26e+01 cost=2.29e+05 flops=2.05e+07
 sigma_tot counter=46 i=3 t=1.10e-02 per=1.24e+01 cost=2.31e+05 flops=2.10e+07
 sigma_tot counter=46 i=4 t=1.09e-02 per=1.23e+01 cost=3.10e+05 flops=2.84e+07
 sigma_tot counter=46 i=5 t=1.11e-02 per=1.24e+01 cost=3.08e+05 flops=2.78e+07
 sigma_tot counter=46 i=6 t=1.16e-02 per=1.30e+01 cost=4.65e+05 flops=4.02e+07
 sigma_tot counter=46 i=7 t=1.11e-02 per=1.25e+01 cost=4.63e+05 flops=4.16e+07
 total GEMM cost=2.46e+06 flops=2.76e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.78e-03,1.77e-04 cost=4.52e+04 flops[gemm]=2.54e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.78e-03 t_reduction=1.77e-04 tot=1.96e-03 ---
 sigma counter=47 i=0 t=2.31e-04 per=1.30e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=47 i=1 t=2.20e-04 per=1.24e+01 cost=4.32e+03 flops=1.96e+07
 sigma counter=47 i=2 t=2.18e-04 per=1.22e+01 cost=3.83e+03 flops=1.76e+07
 sigma counter=47 i=3 t=2.19e-04 per=1.23e+01 cost=4.12e+03 flops=1.88e+07
 sigma counter=47 i=4 t=2.22e-04 per=1.25e+01 cost=1.06e+04 flops=4.76e+07
 sigma counter=47 i=5 t=2.30e-04 per=1.29e+01 cost=1.06e+04 flops=4.59e+07
 sigma counter=47 i=6 t=2.22e-04 per=1.25e+01 cost=4.12e+03 flops=1.86e+07
 sigma counter=47 i=7 t=2.18e-04 per=1.22e+01 cost=3.83e+03 flops=1.76e+07
 total GEMM cost=4.52e+04 flops=2.54e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=9.08e-02 t_reduction=8.94e-03 tot=9.98e-02 ---
 sigma_tot counter=47 i=0 t=1.13e-02 per=1.24e+01 cost=2.29e+05 flops=2.03e+07
 sigma_tot counter=47 i=1 t=1.13e-02 per=1.25e+01 cost=2.33e+05 flops=2.05e+07
 sigma_tot counter=47 i=2 t=1.14e-02 per=1.25e+01 cost=2.33e+05 flops=2.05e+07
 sigma_tot counter=47 i=3 t=1.12e-02 per=1.24e+01 cost=2.35e+05 flops=2.09e+07
 sigma_tot counter=47 i=4 t=1.11e-02 per=1.23e+01 cost=3.20e+05 flops=2.88e+07
 sigma_tot counter=47 i=5 t=1.13e-02 per=1.24e+01 cost=3.19e+05 flops=2.82e+07
 sigma_tot counter=47 i=6 t=1.18e-02 per=1.30e+01 cost=4.69e+05 flops=3.98e+07
 sigma_tot counter=47 i=7 t=1.13e-02 per=1.25e+01 cost=4.67e+05 flops=4.11e+07
 total GEMM cost=2.51e+06 flops=2.76e+07
    5   0 -      -2.652080842743  -2.28e-06   5.13e-04    6    10   2.13e-02  2.13e-03
    5   1 -      -2.430687478263  -1.41e-05   1.80e-03    6    10   2.13e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.80e-03,1.78e-04 cost=4.52e+04 flops[gemm]=2.50e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.80e-03 t_reduction=1.77e-04 tot=1.98e-03 ---
 sigma counter=48 i=0 t=2.34e-04 per=1.30e+01 cost=3.82e+03 flops=1.63e+07
 sigma counter=48 i=1 t=2.21e-04 per=1.23e+01 cost=4.32e+03 flops=1.95e+07
 sigma counter=48 i=2 t=2.35e-04 per=1.30e+01 cost=3.83e+03 flops=1.63e+07
 sigma counter=48 i=3 t=2.20e-04 per=1.22e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=48 i=4 t=2.29e-04 per=1.27e+01 cost=1.06e+04 flops=4.61e+07
 sigma counter=48 i=5 t=2.24e-04 per=1.24e+01 cost=1.06e+04 flops=4.72e+07
 sigma counter=48 i=6 t=2.24e-04 per=1.24e+01 cost=4.12e+03 flops=1.84e+07
 sigma counter=48 i=7 t=2.17e-04 per=1.20e+01 cost=3.83e+03 flops=1.77e+07
 total GEMM cost=4.52e+04 flops=2.50e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=9.26e-02 t_reduction=9.12e-03 tot=1.02e-01 ---
 sigma_tot counter=48 i=0 t=1.15e-02 per=1.24e+01 cost=2.33e+05 flops=2.02e+07
 sigma_tot counter=48 i=1 t=1.16e-02 per=1.25e+01 cost=2.37e+05 flops=2.05e+07
 sigma_tot counter=48 i=2 t=1.16e-02 per=1.26e+01 cost=2.37e+05 flops=2.04e+07
 sigma_tot counter=48 i=3 t=1.14e-02 per=1.24e+01 cost=2.39e+05 flops=2.09e+07
 sigma_tot counter=48 i=4 t=1.14e-02 per=1.23e+01 cost=3.31e+05 flops=2.91e+07
 sigma_tot counter=48 i=5 t=1.15e-02 per=1.24e+01 cost=3.29e+05 flops=2.86e+07
 sigma_tot counter=48 i=6 t=1.20e-02 per=1.30e+01 cost=4.74e+05 flops=3.94e+07
 sigma_tot counter=48 i=7 t=1.16e-02 per=1.25e+01 cost=4.70e+05 flops=4.07e+07
 total GEMM cost=2.55e+06 flops=2.75e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.76e-03,1.77e-04 cost=4.52e+04 flops[gemm]=2.56e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.76e-03 t_reduction=1.77e-04 tot=1.94e-03 ---
 sigma counter=49 i=0 t=2.22e-04 per=1.26e+01 cost=3.82e+03 flops=1.72e+07
 sigma counter=49 i=1 t=2.20e-04 per=1.25e+01 cost=4.32e+03 flops=1.96e+07
 sigma counter=49 i=2 t=2.16e-04 per=1.23e+01 cost=3.83e+03 flops=1.78e+07
 sigma counter=49 i=3 t=2.18e-04 per=1.24e+01 cost=4.12e+03 flops=1.89e+07
 sigma counter=49 i=4 t=2.27e-04 per=1.29e+01 cost=1.06e+04 flops=4.66e+07
 sigma counter=49 i=5 t=2.23e-04 per=1.26e+01 cost=1.06e+04 flops=4.74e+07
 sigma counter=49 i=6 t=2.20e-04 per=1.25e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=49 i=7 t=2.17e-04 per=1.23e+01 cost=3.83e+03 flops=1.77e+07
 total GEMM cost=4.52e+04 flops=2.56e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=9.44e-02 t_reduction=9.30e-03 tot=1.04e-01 ---
 sigma_tot counter=49 i=0 t=1.17e-02 per=1.24e+01 cost=2.37e+05 flops=2.02e+07
 sigma_tot counter=49 i=1 t=1.18e-02 per=1.25e+01 cost=2.41e+05 flops=2.05e+07
 sigma_tot counter=49 i=2 t=1.18e-02 per=1.26e+01 cost=2.41e+05 flops=2.03e+07
 sigma_tot counter=49 i=3 t=1.17e-02 per=1.24e+01 cost=2.43e+05 flops=2.09e+07
 sigma_tot counter=49 i=4 t=1.16e-02 per=1.23e+01 cost=3.42e+05 flops=2.95e+07
 sigma_tot counter=49 i=5 t=1.18e-02 per=1.25e+01 cost=3.40e+05 flops=2.89e+07
 sigma_tot counter=49 i=6 t=1.22e-02 per=1.30e+01 cost=4.78e+05 flops=3.90e+07
 sigma_tot counter=49 i=7 t=1.18e-02 per=1.25e+01 cost=4.74e+05 flops=4.03e+07
 total GEMM cost=2.60e+06 flops=2.75e+07
    6   0 -      -2.652081069574  -2.27e-07   1.76e-04    6    12   2.55e-02  2.12e-03
    6   1 -      -2.430689675153  -2.20e-06   5.57e-04    6    12   2.55e-02  2.12e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.78e-03,1.77e-04 cost=4.52e+04 flops[gemm]=2.53e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.78e-03 t_reduction=1.77e-04 tot=1.96e-03 ---
 sigma counter=50 i=0 t=2.21e-04 per=1.24e+01 cost=3.82e+03 flops=1.73e+07
 sigma counter=50 i=1 t=2.23e-04 per=1.25e+01 cost=4.32e+03 flops=1.94e+07
 sigma counter=50 i=2 t=2.20e-04 per=1.23e+01 cost=3.83e+03 flops=1.74e+07
 sigma counter=50 i=3 t=2.33e-04 per=1.31e+01 cost=4.12e+03 flops=1.77e+07
 sigma counter=50 i=4 t=2.22e-04 per=1.24e+01 cost=1.06e+04 flops=4.76e+07
 sigma counter=50 i=5 t=2.23e-04 per=1.25e+01 cost=1.06e+04 flops=4.74e+07
 sigma counter=50 i=6 t=2.24e-04 per=1.25e+01 cost=4.12e+03 flops=1.84e+07
 sigma counter=50 i=7 t=2.19e-04 per=1.23e+01 cost=3.83e+03 flops=1.75e+07
 total GEMM cost=4.52e+04 flops=2.53e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=9.62e-02 t_reduction=9.47e-03 tot=1.06e-01 ---
 sigma_tot counter=50 i=0 t=1.20e-02 per=1.24e+01 cost=2.41e+05 flops=2.01e+07
 sigma_tot counter=50 i=1 t=1.20e-02 per=1.25e+01 cost=2.46e+05 flops=2.05e+07
 sigma_tot counter=50 i=2 t=1.21e-02 per=1.25e+01 cost=2.45e+05 flops=2.03e+07
 sigma_tot counter=50 i=3 t=1.19e-02 per=1.24e+01 cost=2.47e+05 flops=2.08e+07
 sigma_tot counter=50 i=4 t=1.18e-02 per=1.23e+01 cost=3.52e+05 flops=2.98e+07
 sigma_tot counter=50 i=5 t=1.20e-02 per=1.25e+01 cost=3.51e+05 flops=2.93e+07
 sigma_tot counter=50 i=6 t=1.25e-02 per=1.30e+01 cost=4.82e+05 flops=3.87e+07
 sigma_tot counter=50 i=7 t=1.20e-02 per=1.25e+01 cost=4.78e+05 flops=3.99e+07
 total GEMM cost=2.64e+06 flops=2.75e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.77e-03,1.76e-04 cost=4.52e+04 flops[gemm]=2.55e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.77e-03 t_reduction=1.76e-04 tot=1.95e-03 ---
 sigma counter=51 i=0 t=2.24e-04 per=1.26e+01 cost=3.82e+03 flops=1.71e+07
 sigma counter=51 i=1 t=2.21e-04 per=1.25e+01 cost=4.32e+03 flops=1.95e+07
 sigma counter=51 i=2 t=2.18e-04 per=1.23e+01 cost=3.83e+03 flops=1.76e+07
 sigma counter=51 i=3 t=2.22e-04 per=1.25e+01 cost=4.12e+03 flops=1.86e+07
 sigma counter=51 i=4 t=2.22e-04 per=1.25e+01 cost=1.06e+04 flops=4.76e+07
 sigma counter=51 i=5 t=2.24e-04 per=1.26e+01 cost=1.06e+04 flops=4.72e+07
 sigma counter=51 i=6 t=2.22e-04 per=1.25e+01 cost=4.12e+03 flops=1.86e+07
 sigma counter=51 i=7 t=2.19e-04 per=1.24e+01 cost=3.83e+03 flops=1.75e+07
 total GEMM cost=4.52e+04 flops=2.55e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=9.79e-02 t_reduction=9.65e-03 tot=1.08e-01 ---
 sigma_tot counter=51 i=0 t=1.22e-02 per=1.25e+01 cost=2.44e+05 flops=2.00e+07
 sigma_tot counter=51 i=1 t=1.22e-02 per=1.25e+01 cost=2.50e+05 flops=2.05e+07
 sigma_tot counter=51 i=2 t=1.23e-02 per=1.25e+01 cost=2.48e+05 flops=2.02e+07
 sigma_tot counter=51 i=3 t=1.21e-02 per=1.24e+01 cost=2.51e+05 flops=2.08e+07
 sigma_tot counter=51 i=4 t=1.20e-02 per=1.23e+01 cost=3.63e+05 flops=3.01e+07
 sigma_tot counter=51 i=5 t=1.22e-02 per=1.25e+01 cost=3.61e+05 flops=2.96e+07
 sigma_tot counter=51 i=6 t=1.27e-02 per=1.29e+01 cost=4.86e+05 flops=3.83e+07
 sigma_tot counter=51 i=7 t=1.22e-02 per=1.25e+01 cost=4.82e+05 flops=3.95e+07
 total GEMM cost=2.69e+06 flops=2.74e+07
    7   0 +      -2.652081089524  -1.99e-08   6.38e-05    6    14   2.97e-02  2.12e-03
    7   1 -      -2.430689869830  -1.95e-07   1.13e-04    6    14   2.97e-02  2.12e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.78e-03,1.85e-04 cost=4.52e+04 flops[gemm]=2.54e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.78e-03 t_reduction=1.85e-04 tot=1.96e-03 ---
 sigma counter=52 i=0 t=2.25e-04 per=1.27e+01 cost=3.82e+03 flops=1.70e+07
 sigma counter=52 i=1 t=2.17e-04 per=1.22e+01 cost=4.32e+03 flops=1.99e+07
 sigma counter=52 i=2 t=2.22e-04 per=1.25e+01 cost=3.83e+03 flops=1.73e+07
 sigma counter=52 i=3 t=2.28e-04 per=1.28e+01 cost=4.12e+03 flops=1.81e+07
 sigma counter=52 i=4 t=2.21e-04 per=1.25e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=52 i=5 t=2.21e-04 per=1.25e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=52 i=6 t=2.23e-04 per=1.26e+01 cost=4.12e+03 flops=1.85e+07
 sigma counter=52 i=7 t=2.18e-04 per=1.23e+01 cost=3.83e+03 flops=1.76e+07
 total GEMM cost=4.52e+04 flops=2.55e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=9.97e-02 t_reduction=9.83e-03 tot=1.10e-01 ---
 sigma_tot counter=52 i=0 t=1.24e-02 per=1.25e+01 cost=2.48e+05 flops=2.00e+07
 sigma_tot counter=52 i=1 t=1.24e-02 per=1.25e+01 cost=2.54e+05 flops=2.04e+07
 sigma_tot counter=52 i=2 t=1.25e-02 per=1.25e+01 cost=2.52e+05 flops=2.02e+07
 sigma_tot counter=52 i=3 t=1.23e-02 per=1.24e+01 cost=2.56e+05 flops=2.07e+07
 sigma_tot counter=52 i=4 t=1.23e-02 per=1.23e+01 cost=3.73e+05 flops=3.05e+07
 sigma_tot counter=52 i=5 t=1.24e-02 per=1.25e+01 cost=3.72e+05 flops=2.99e+07
 sigma_tot counter=52 i=6 t=1.29e-02 per=1.29e+01 cost=4.90e+05 flops=3.80e+07
 sigma_tot counter=52 i=7 t=1.24e-02 per=1.25e+01 cost=4.86e+05 flops=3.91e+07
 total GEMM cost=2.73e+06 flops=2.74e+07
    8   0 +      -2.652081089524  -6.66e-15   6.38e-05    5    15   3.18e-02  2.12e-03
    8   1 +      -2.430689878738  -8.91e-09   3.44e-05    5    15   3.18e-02  2.12e-03
TIMING for Davidson : 3.19e-02  T(cal/comm/rest)=3.14e-02,8.71e-07,4.95e-04
optimized energies: isweep=0 dots=2 ibond=3 e[0]=-2.65208108952
optimized energies: isweep=0 dots=2 ibond=3 e[1]=-2.43068987874
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=11 dimAll=40
 (2,0):9 (3,1):7 (3,-1):6 (4,0):4 (1,1):3 (1,-1):3 (2,2):3 (2,-2):2 (0,0):1 (4,2):1 (3,3):1
decimation summary: 40->10 dwt=+9.505e-03 SvN=1.828e+00
===== CPUmem(GB): tot=1.109e-05 (comb,oper,dvdson,hvec,renorm)=2.138e-06,8.956e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=775:5.913e-03MB:5.774e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=6.780e-06 (oper)(GB)=6.780e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.300e-05 (oper,qops,site)(GB)=6.780e-06,5.774e-06,4.470e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.373e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=506:0.00386MB:3.77e-06GB
cost_rinter=2.02e+03 time=0.000168 flops=1.2e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 2.165e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.68e-05 (oper,qops,site,rinter)(GB)=6.78e-06,5.77e-06,4.47e-07,3.77e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000371 S size(rtasks)=63 size(Rlst)=677 T(Rmu/Rxlist/sort)=6.27e-05,0.000169,0.00014 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000143 (oper,qops,site,rinter,batch)(GB)=6.78e-06,5.77e-06,4.47e-07,3.77e-06,0.000126
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00103,0.000187 cost=3.91e+04 flops[gemm]=3.79e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00103 t_reduction=0.000187 tot=0.00122 ---
 renorm counter=4 i=0 t=0.000205 per=19.9 cost=1.67e+03 flops=8.16e+06
 renorm counter=4 i=1 t=0.000205 per=19.9 cost=3.78e+03 flops=1.84e+07
 renorm counter=4 i=2 t=0.0002 per=19.4 cost=4.76e+03 flops=2.38e+07
 renorm counter=4 i=3 t=0.000208 per=20.2 cost=8.83e+03 flops=4.24e+07
 renorm counter=4 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=4 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=4 i=6 t=0.000212 per=20.6 cost=2.01e+04 flops=9.48e+07
 total GEMM cost=3.91e+04 flops=3.8e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00432 t_reduction=0.000747 tot=0.00507 ---
 renorm_tot counter=4 i=0 t=0.000879 per=20.3 cost=6.81e+03 flops=7.75e+06
 renorm_tot counter=4 i=1 t=0.000846 per=19.6 cost=1.06e+04 flops=1.25e+07
 renorm_tot counter=4 i=2 t=0.000405 per=9.36 cost=5.99e+03 flops=1.48e+07
 renorm_tot counter=4 i=3 t=0.000418 per=9.66 cost=1.09e+04 flops=2.61e+07
 renorm_tot counter=4 i=4 t=0.00043 per=9.94 cost=5.71e+03 flops=1.33e+07
 renorm_tot counter=4 i=5 t=0.000438 per=10.1 cost=1.06e+04 flops=2.42e+07
 renorm_tot counter=4 i=6 t=0.000909 per=21 cost=6.71e+04 flops=7.38e+07
 total GEMM cost=1.18e+05 flops=2.72e+07
check ||H-H.dagger||=4.78e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=9.8e-05,0.0025,1e-05 rank=0 -----
===== CPUmem(GB): tot=1.1e-05 (comb,oper,dvdson,hvec,renorm)=2.1e-06,9e-06,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=120:0.00092MB:8.9e-07GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=48:0.00037MB:3.6e-07GB
total mem of comb=211:0.0016MB:1.6e-06GB
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.5e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=5.77e-06GB T[save](info/data/tot)=9.76e-05,4.44e-05,0.000142 speed=0.0407GB/s disk[used]=5.89e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 3.98e-02 S #####
 T(fetch) = 4.49e-04 S  per =  1.1  per(accum) = 1.1
 T(hdiag) = 9.59e-05 S  per = 0.24  per(accum) = 1.4
 T(dvdsn) = 3.55e-02 S  per =   89  per(accum) = 91
 T(decim) = 3.40e-04 S  per = 0.86  per(accum) = 91
 T(guess) = 7.76e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.65e-03 S  per =  6.7  per(accum) = 98
 T(save ) = 6.56e-04 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.52e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.25e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 3.33e-04 S  per = 0.94  per(accum) = 1.1
 T(hintermediate init           ) = 2.27e-04 S  per = 0.64  per(accum) = 1.7
 T(hintermediates memcpy cpu2gpu) = 5.26e-06 S  per = 0.015  per(accum) = 1.7
 T(preprocess_hformulae_Hxlist2 ) = 1.73e-03 S  per =  4.9  per(accum) = 6.6
 T(hmmtasks init                ) = 1.04e-03 S  per =    3  per(accum) = 9.6
 T(dvdson solver [Hx_batchGPU]  ) = 3.14e-02 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 8.71e-07 S  per = 0.0025  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.95e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.59e-03 S
 T(qops init                    ) = 9.78e-05 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 3.86e-05 S  per =  1.5  per(accum) = 5.3
 T(symbolic_formulae_renorm     ) = 2.43e-04 S  per =  9.4  per(accum) = 15
 T(rintermediate init           ) = 2.21e-04 S  per =  8.5  per(accum) = 23
 T(rintermediates memcpy cpu2gpu) = 6.18e-06 S  per = 0.24  per(accum) = 23
 T(preprocess_formulae_Rlist2   ) = 3.90e-04 S  per =   15  per(accum) = 38
 T(rmmtasks init                ) = 2.38e-04 S  per =  9.2  per(accum) = 48
 T(qops memset                  ) = 9.34e-06 S  per = 0.36  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.31e-03 S  per =   50  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 3.05e-05 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.00e-05 S  per = 0.39  per(accum) = 1e+02
##### time_sweep: 1.62e-01 S #####
 T(fetch) = 1.86e-03 S  per =  1.1  per(accum) = 1.1
 T(hdiag) = 5.09e-04 S  per = 0.31  per(accum) = 1.5
 T(dvdsn) = 1.43e-01 S  per =   88  per(accum) = 90
 T(decim) = 1.51e-03 S  per = 0.93  per(accum) = 91
 T(guess) = 4.14e-04 S  per = 0.26  per(accum) = 91
 T(renrm) = 1.20e-02 S  per =  7.4  per(accum) = 98
 T(save ) = 2.81e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.42e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.87e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 1.61e-03 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 1.02e-03 S  per = 0.72  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 2.57e-05 S  per = 0.018  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 1.26e-02 S  per =  8.9  per(accum) = 11
 T(hmmtasks init                ) = 7.40e-03 S  per =  5.2  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 1.17e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 3.04e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.92e-03 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.18e-02 S
 T(qops init                    ) = 7.08e-04 S  per =    6  per(accum) = 6
 T(qops_dict memcpy cpu2gpu     ) = 1.85e-04 S  per =  1.6  per(accum) = 7.6
 T(symbolic_formulae_renorm     ) = 1.24e-03 S  per =   10  per(accum) = 18
 T(rintermediate init           ) = 4.93e-04 S  per =  4.2  per(accum) = 22
 T(rintermediates memcpy cpu2gpu) = 2.86e-05 S  per = 0.24  per(accum) = 22
 T(preprocess_formulae_Rlist2   ) = 2.07e-03 S  per =   18  per(accum) = 40
 T(rmmtasks init                ) = 1.35e-03 S  per =   11  per(accum) = 51
 T(qops memset                  ) = 4.16e-05 S  per = 0.35  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 5.51e-03 S  per =   47  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.40e-04 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 4.74e-05 S  per =  0.4  per(accum) = 1e+02
##### time_global: 1.62e-01 S #####
 T(fetch) = 1.86e-03 S  per =  1.1  per(accum) = 1.1
 T(hdiag) = 5.09e-04 S  per = 0.31  per(accum) = 1.5
 T(dvdsn) = 1.43e-01 S  per =   88  per(accum) = 90
 T(decim) = 1.51e-03 S  per = 0.93  per(accum) = 91
 T(guess) = 4.14e-04 S  per = 0.26  per(accum) = 91
 T(renrm) = 1.20e-02 S  per =  7.4  per(accum) = 98
 T(save ) = 2.81e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.42e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.87e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 1.61e-03 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 1.02e-03 S  per = 0.72  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 2.57e-05 S  per = 0.018  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 1.26e-02 S  per =  8.9  per(accum) = 11
 T(hmmtasks init                ) = 7.40e-03 S  per =  5.2  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 1.17e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 3.04e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.92e-03 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.18e-02 S
 T(qops init                    ) = 7.08e-04 S  per =    6  per(accum) = 6
 T(qops_dict memcpy cpu2gpu     ) = 1.85e-04 S  per =  1.6  per(accum) = 7.6
 T(symbolic_formulae_renorm     ) = 1.24e-03 S  per =   10  per(accum) = 18
 T(rintermediate init           ) = 4.93e-04 S  per =  4.2  per(accum) = 22
 T(rintermediates memcpy cpu2gpu) = 2.86e-05 S  per = 0.24  per(accum) = 22
 T(preprocess_formulae_Rlist2   ) = 2.07e-03 S  per =   18  per(accum) = 40
 T(rmmtasks init                ) = 1.35e-03 S  per =   11  per(accum) = 51
 T(qops memset                  ) = 4.16e-05 S  per = 0.35  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 5.51e-03 S  per =   47  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.40e-04 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 4.74e-05 S  per =  0.4  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=0
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+2.890e-03 nmvp=2 e[0]=-2.65451696694 e[1]=-2.27865402598 t=0.02
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+9.637e-03 nmvp=20 e[0]=-2.65109283038 e[1]=-2.42764318335 t=0.059
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.379e-03 nmvp=15 e[0]=-2.65109282733 e[1]=-2.42764318258 t=0.043
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+9.505e-03 nmvp=15 e[0]=-2.65208108952 e[1]=-2.43068987874 t=0.04
 eav_max=-2.46658549646 [ibond=0]  dwt_min=1.379e-03 [ibond=2]
 eav_min=-2.54138548413 [ibond=3]  dwt_max=9.637e-03 [ibond=1]
 eav_diff=0.0747999876727
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[0]=-2.65208108952
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[1]=-2.43068987874
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.64e-01 | 1.64e-01 | 0.00e+00 1.04e-01 1.06e-02 1.15e-01 69.9
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (0.00e+00) e[1]=-2.43068987874 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=9 dimAll=40
 (3,1):10 (4,0):6 (2,0):5 (4,2):5 (2,2):4 (5,1):3 (3,-1):3 (1,1):2 (3,3):2
decimation summary: 40->8 dwt=+0.000e+00 SvN=1.265e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep0.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=10 maxdiff=1.16e-15
 idx=2 node=(2,0) Drow=10 maxdiff=1.48e-15
 idx=3 node=(1,0) Drow=8 maxdiff=1.01e-15
 idx=4 node=(0,0) Drow=2 maxdiff=4.97e-16
stensor2: wf2 own=1 _data=0x481b7180
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x481b7180
      1.0000e+00      -1.5995e-17 
     -4.5427e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=8.0529e-16
----- TIMING FOR ctns::rcanon_check : 9.935e-05 S -----
..... end of isweep = 0 .....

======================================================================
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=142:0.00108MB:1.06e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=221:0.00169MB:1.65e-06GB

isweep=1 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.409e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=142:0.00108MB:1.06e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=221:0.00169MB:1.65e-06GB
===== CPUmem(GB): tot=1.64e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.47e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x48467a40
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,1):2 (1,-1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.96e-06 (oper)(GB)=8.96e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.132e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=506:0.00386MB:3.77e-06GB
cost_hinter=2.02e+03 time=0.000167 flops=1.21e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.142e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.27e-05 (oper,hinter)(GB)=8.96e-06,3.77e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00158 S size(H_formulae)=188 size(Hxlst)=3136 T(Hmu/Hxlist/sort)=7.45e-05,0.00078,0.000727 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000224 (oper,hinter,dvdson,batch)(GB)=8.96e-06,3.77e-06,1.07e-06,0.00021
===== CPUmem(GB): tot=2.71e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.47e-05,1.07e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=72 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.8e-05,0.00176,0.000173 cost=4.52e+04 flops[gemm]=2.56e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00176 t_reduction=0.000173 tot=0.00194 ---
 sigma counter=53 i=0 t=0.00023 per=13.1 cost=3.82e+03 flops=1.66e+07
 sigma counter=53 i=1 t=0.000219 per=12.4 cost=4.32e+03 flops=1.97e+07
 sigma counter=53 i=2 t=0.000215 per=12.2 cost=3.83e+03 flops=1.78e+07
 sigma counter=53 i=3 t=0.000215 per=12.2 cost=4.12e+03 flops=1.92e+07
 sigma counter=53 i=4 t=0.000226 per=12.8 cost=1.06e+04 flops=4.68e+07
 sigma counter=53 i=5 t=0.000221 per=12.5 cost=1.06e+04 flops=4.78e+07
 sigma counter=53 i=6 t=0.00022 per=12.5 cost=4.12e+03 flops=1.87e+07
 sigma counter=53 i=7 t=0.000216 per=12.3 cost=3.83e+03 flops=1.78e+07
 total GEMM cost=4.52e+04 flops=2.56e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.101 t_reduction=0.01 tot=0.111 ---
 sigma_tot counter=53 i=0 t=0.0126 per=12.5 cost=2.52e+05 flops=1.99e+07
 sigma_tot counter=53 i=1 t=0.0127 per=12.5 cost=2.59e+05 flops=2.04e+07
 sigma_tot counter=53 i=2 t=0.0127 per=12.5 cost=2.56e+05 flops=2.01e+07
 sigma_tot counter=53 i=3 t=0.0126 per=12.4 cost=2.6e+05 flops=2.07e+07
 sigma_tot counter=53 i=4 t=0.0125 per=12.3 cost=3.84e+05 flops=3.07e+07
 sigma_tot counter=53 i=5 t=0.0126 per=12.5 cost=3.82e+05 flops=3.02e+07
 sigma_tot counter=53 i=6 t=0.0131 per=12.9 cost=4.94e+05 flops=3.77e+07
 sigma_tot counter=53 i=7 t=0.0127 per=12.5 cost=4.9e+05 flops=3.87e+07
 total GEMM cost=2.78e+06 flops=2.74e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.9e-05,0.00174,0.000185 cost=4.52e+04 flops[gemm]=2.6e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00174 t_reduction=0.000185 tot=0.00192 ---
 sigma counter=54 i=0 t=0.000218 per=12.5 cost=3.82e+03 flops=1.75e+07
 sigma counter=54 i=1 t=0.000216 per=12.4 cost=4.32e+03 flops=2e+07
 sigma counter=54 i=2 t=0.000213 per=12.3 cost=3.83e+03 flops=1.8e+07
 sigma counter=54 i=3 t=0.000216 per=12.4 cost=4.12e+03 flops=1.91e+07
 sigma counter=54 i=4 t=0.000219 per=12.6 cost=1.06e+04 flops=4.83e+07
 sigma counter=54 i=5 t=0.000221 per=12.7 cost=1.06e+04 flops=4.78e+07
 sigma counter=54 i=6 t=0.000221 per=12.7 cost=4.12e+03 flops=1.87e+07
 sigma counter=54 i=7 t=0.000214 per=12.3 cost=3.83e+03 flops=1.79e+07
 total GEMM cost=4.52e+04 flops=2.6e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.103 t_reduction=0.0102 tot=0.113 ---
 sigma_tot counter=54 i=0 t=0.0129 per=12.5 cost=2.56e+05 flops=1.99e+07
 sigma_tot counter=54 i=1 t=0.0129 per=12.5 cost=2.63e+05 flops=2.04e+07
 sigma_tot counter=54 i=2 t=0.0129 per=12.5 cost=2.6e+05 flops=2.01e+07
 sigma_tot counter=54 i=3 t=0.0128 per=12.4 cost=2.64e+05 flops=2.07e+07
 sigma_tot counter=54 i=4 t=0.0127 per=12.3 cost=3.94e+05 flops=3.11e+07
 sigma_tot counter=54 i=5 t=0.0129 per=12.5 cost=3.93e+05 flops=3.05e+07
 sigma_tot counter=54 i=6 t=0.0133 per=12.9 cost=4.98e+05 flops=3.73e+07
 sigma_tot counter=54 i=7 t=0.0129 per=12.5 cost=4.93e+05 flops=3.84e+07
 total GEMM cost=2.82e+06 flops=2.73e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.641998458071  -1.00e+03   1.43e-01    2     2   4.14e-03  2.07e-03
    1   1 -      -2.409549170479  -1.00e+03   1.87e-01    2     2   4.14e-03  2.07e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.76e-03,1.06e-03 cost=4.52e+04 flops[gemm]=2.56e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.76e-03 t_reduction=1.06e-03 tot=2.83e-03 ---
 sigma counter=55 i=0 t=2.25e-04 per=1.28e+01 cost=3.82e+03 flops=1.70e+07
 sigma counter=55 i=1 t=2.16e-04 per=1.23e+01 cost=4.32e+03 flops=2.00e+07
 sigma counter=55 i=2 t=2.14e-04 per=1.21e+01 cost=3.83e+03 flops=1.79e+07
 sigma counter=55 i=3 t=2.17e-04 per=1.23e+01 cost=4.12e+03 flops=1.90e+07
 sigma counter=55 i=4 t=2.24e-04 per=1.27e+01 cost=1.06e+04 flops=4.72e+07
 sigma counter=55 i=5 t=2.21e-04 per=1.25e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=55 i=6 t=2.31e-04 per=1.31e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=55 i=7 t=2.15e-04 per=1.22e+01 cost=3.83e+03 flops=1.78e+07
 total GEMM cost=4.52e+04 flops=2.56e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.05e-01 t_reduction=1.13e-02 tot=1.16e-01 ---
 sigma_tot counter=55 i=0 t=1.31e-02 per=1.25e+01 cost=2.60e+05 flops=1.98e+07
 sigma_tot counter=55 i=1 t=1.31e-02 per=1.25e+01 cost=2.67e+05 flops=2.04e+07
 sigma_tot counter=55 i=2 t=1.31e-02 per=1.25e+01 cost=2.64e+05 flops=2.01e+07
 sigma_tot counter=55 i=3 t=1.30e-02 per=1.24e+01 cost=2.68e+05 flops=2.06e+07
 sigma_tot counter=55 i=4 t=1.29e-02 per=1.23e+01 cost=4.05e+05 flops=3.13e+07
 sigma_tot counter=55 i=5 t=1.31e-02 per=1.25e+01 cost=4.03e+05 flops=3.08e+07
 sigma_tot counter=55 i=6 t=1.36e-02 per=1.29e+01 cost=5.02e+05 flops=3.70e+07
 sigma_tot counter=55 i=7 t=1.31e-02 per=1.25e+01 cost=4.97e+05 flops=3.80e+07
 total GEMM cost=2.87e+06 flops=2.73e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.50e-05,1.77e-03,1.81e-04 cost=4.52e+04 flops[gemm]=2.56e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.76e-03 t_reduction=1.81e-04 tot=1.95e-03 ---
 sigma counter=56 i=0 t=2.28e-04 per=1.29e+01 cost=3.82e+03 flops=1.68e+07
 sigma counter=56 i=1 t=2.18e-04 per=1.24e+01 cost=4.32e+03 flops=1.98e+07
 sigma counter=56 i=2 t=2.17e-04 per=1.23e+01 cost=3.83e+03 flops=1.77e+07
 sigma counter=56 i=3 t=2.17e-04 per=1.23e+01 cost=4.12e+03 flops=1.90e+07
 sigma counter=56 i=4 t=2.21e-04 per=1.25e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=56 i=5 t=2.24e-04 per=1.27e+01 cost=1.06e+04 flops=4.72e+07
 sigma counter=56 i=6 t=2.23e-04 per=1.26e+01 cost=4.12e+03 flops=1.85e+07
 sigma counter=56 i=7 t=2.17e-04 per=1.23e+01 cost=3.83e+03 flops=1.77e+07
 total GEMM cost=4.52e+04 flops=2.56e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.07e-01 t_reduction=1.14e-02 tot=1.18e-01 ---
 sigma_tot counter=56 i=0 t=1.33e-02 per=1.25e+01 cost=2.64e+05 flops=1.98e+07
 sigma_tot counter=56 i=1 t=1.33e-02 per=1.25e+01 cost=2.71e+05 flops=2.04e+07
 sigma_tot counter=56 i=2 t=1.34e-02 per=1.25e+01 cost=2.68e+05 flops=2.00e+07
 sigma_tot counter=56 i=3 t=1.32e-02 per=1.24e+01 cost=2.72e+05 flops=2.06e+07
 sigma_tot counter=56 i=4 t=1.31e-02 per=1.23e+01 cost=4.16e+05 flops=3.16e+07
 sigma_tot counter=56 i=5 t=1.33e-02 per=1.25e+01 cost=4.14e+05 flops=3.11e+07
 sigma_tot counter=56 i=6 t=1.38e-02 per=1.29e+01 cost=5.07e+05 flops=3.67e+07
 sigma_tot counter=56 i=7 t=1.33e-02 per=1.25e+01 cost=5.01e+05 flops=3.77e+07
 total GEMM cost=2.91e+06 flops=2.73e+07
    2   0 -      -2.651381055680  -9.38e-03   3.40e-02    4     4   9.24e-03  2.31e-03
    2   1 -      -2.428926260058  -1.94e-02   5.14e-02    4     4   9.24e-03  2.31e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.76e-03,1.84e-04 cost=4.52e+04 flops[gemm]=2.56e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.76e-03 t_reduction=1.84e-04 tot=1.95e-03 ---
 sigma counter=57 i=0 t=2.20e-04 per=1.25e+01 cost=3.82e+03 flops=1.74e+07
 sigma counter=57 i=1 t=2.19e-04 per=1.24e+01 cost=4.32e+03 flops=1.97e+07
 sigma counter=57 i=2 t=2.17e-04 per=1.23e+01 cost=3.83e+03 flops=1.77e+07
 sigma counter=57 i=3 t=2.18e-04 per=1.24e+01 cost=4.12e+03 flops=1.89e+07
 sigma counter=57 i=4 t=2.21e-04 per=1.25e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=57 i=5 t=2.24e-04 per=1.27e+01 cost=1.06e+04 flops=4.72e+07
 sigma counter=57 i=6 t=2.24e-04 per=1.27e+01 cost=4.12e+03 flops=1.84e+07
 sigma counter=57 i=7 t=2.19e-04 per=1.24e+01 cost=3.83e+03 flops=1.75e+07
 total GEMM cost=4.52e+04 flops=2.56e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.09e-01 t_reduction=1.16e-02 tot=1.20e-01 ---
 sigma_tot counter=57 i=0 t=1.35e-02 per=1.25e+01 cost=2.67e+05 flops=1.97e+07
 sigma_tot counter=57 i=1 t=1.35e-02 per=1.25e+01 cost=2.76e+05 flops=2.04e+07
 sigma_tot counter=57 i=2 t=1.36e-02 per=1.25e+01 cost=2.71e+05 flops=2.00e+07
 sigma_tot counter=57 i=3 t=1.34e-02 per=1.24e+01 cost=2.76e+05 flops=2.06e+07
 sigma_tot counter=57 i=4 t=1.34e-02 per=1.23e+01 cost=4.26e+05 flops=3.19e+07
 sigma_tot counter=57 i=5 t=1.35e-02 per=1.25e+01 cost=4.25e+05 flops=3.14e+07
 sigma_tot counter=57 i=6 t=1.40e-02 per=1.29e+01 cost=5.11e+05 flops=3.64e+07
 sigma_tot counter=57 i=7 t=1.35e-02 per=1.25e+01 cost=5.05e+05 flops=3.74e+07
 total GEMM cost=2.96e+06 flops=2.73e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.77e-03,1.81e-04 cost=4.52e+04 flops[gemm]=2.55e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.77e-03 t_reduction=1.81e-04 tot=1.96e-03 ---
 sigma counter=58 i=0 t=2.23e-04 per=1.26e+01 cost=3.82e+03 flops=1.71e+07
 sigma counter=58 i=1 t=2.20e-04 per=1.24e+01 cost=4.32e+03 flops=1.96e+07
 sigma counter=58 i=2 t=2.18e-04 per=1.23e+01 cost=3.83e+03 flops=1.76e+07
 sigma counter=58 i=3 t=2.24e-04 per=1.26e+01 cost=4.12e+03 flops=1.84e+07
 sigma counter=58 i=4 t=2.21e-04 per=1.25e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=58 i=5 t=2.25e-04 per=1.27e+01 cost=1.06e+04 flops=4.70e+07
 sigma counter=58 i=6 t=2.22e-04 per=1.25e+01 cost=4.12e+03 flops=1.86e+07
 sigma counter=58 i=7 t=2.21e-04 per=1.25e+01 cost=3.83e+03 flops=1.73e+07
 total GEMM cost=4.52e+04 flops=2.55e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.10e-01 t_reduction=1.18e-02 tot=1.22e-01 ---
 sigma_tot counter=58 i=0 t=1.38e-02 per=1.25e+01 cost=2.71e+05 flops=1.97e+07
 sigma_tot counter=58 i=1 t=1.37e-02 per=1.25e+01 cost=2.80e+05 flops=2.04e+07
 sigma_tot counter=58 i=2 t=1.38e-02 per=1.25e+01 cost=2.75e+05 flops=1.99e+07
 sigma_tot counter=58 i=3 t=1.36e-02 per=1.24e+01 cost=2.80e+05 flops=2.05e+07
 sigma_tot counter=58 i=4 t=1.36e-02 per=1.23e+01 cost=4.37e+05 flops=3.21e+07
 sigma_tot counter=58 i=5 t=1.38e-02 per=1.25e+01 cost=4.35e+05 flops=3.16e+07
 sigma_tot counter=58 i=6 t=1.42e-02 per=1.29e+01 cost=5.15e+05 flops=3.61e+07
 sigma_tot counter=58 i=7 t=1.37e-02 per=1.25e+01 cost=5.09e+05 flops=3.70e+07
 total GEMM cost=3.00e+06 flops=2.72e+07
    3   0 -      -2.652042676037  -6.62e-04   6.55e-03    6     6   1.34e-02  2.24e-03
    3   1 -      -2.430569433550  -1.64e-03   1.22e-02    6     6   1.34e-02  2.24e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.76e-03,1.80e-04 cost=4.52e+04 flops[gemm]=2.57e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.76e-03 t_reduction=1.80e-04 tot=1.94e-03 ---
 sigma counter=59 i=0 t=2.20e-04 per=1.25e+01 cost=3.82e+03 flops=1.74e+07
 sigma counter=59 i=1 t=2.15e-04 per=1.22e+01 cost=4.32e+03 flops=2.01e+07
 sigma counter=59 i=2 t=2.20e-04 per=1.25e+01 cost=3.83e+03 flops=1.74e+07
 sigma counter=59 i=3 t=2.20e-04 per=1.25e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=59 i=4 t=2.19e-04 per=1.25e+01 cost=1.06e+04 flops=4.83e+07
 sigma counter=59 i=5 t=2.22e-04 per=1.26e+01 cost=1.06e+04 flops=4.76e+07
 sigma counter=59 i=6 t=2.21e-04 per=1.26e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=59 i=7 t=2.22e-04 per=1.26e+01 cost=3.83e+03 flops=1.73e+07
 total GEMM cost=4.52e+04 flops=2.57e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.12e-01 t_reduction=1.20e-02 tot=1.24e-01 ---
 sigma_tot counter=59 i=0 t=1.40e-02 per=1.25e+01 cost=2.75e+05 flops=1.97e+07
 sigma_tot counter=59 i=1 t=1.40e-02 per=1.25e+01 cost=2.84e+05 flops=2.04e+07
 sigma_tot counter=59 i=2 t=1.40e-02 per=1.25e+01 cost=2.79e+05 flops=1.99e+07
 sigma_tot counter=59 i=3 t=1.39e-02 per=1.24e+01 cost=2.84e+05 flops=2.05e+07
 sigma_tot counter=59 i=4 t=1.38e-02 per=1.23e+01 cost=4.47e+05 flops=3.24e+07
 sigma_tot counter=59 i=5 t=1.40e-02 per=1.25e+01 cost=4.46e+05 flops=3.19e+07
 sigma_tot counter=59 i=6 t=1.45e-02 per=1.29e+01 cost=5.19e+05 flops=3.59e+07
 sigma_tot counter=59 i=7 t=1.40e-02 per=1.25e+01 cost=5.13e+05 flops=3.67e+07
 total GEMM cost=3.05e+06 flops=2.72e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.77e-03,1.80e-04 cost=4.52e+04 flops[gemm]=2.55e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.77e-03 t_reduction=1.80e-04 tot=1.95e-03 ---
 sigma counter=60 i=0 t=2.22e-04 per=1.25e+01 cost=3.82e+03 flops=1.72e+07
 sigma counter=60 i=1 t=2.21e-04 per=1.25e+01 cost=4.32e+03 flops=1.95e+07
 sigma counter=60 i=2 t=2.20e-04 per=1.24e+01 cost=3.83e+03 flops=1.74e+07
 sigma counter=60 i=3 t=2.23e-04 per=1.26e+01 cost=4.12e+03 flops=1.85e+07
 sigma counter=60 i=4 t=2.26e-04 per=1.28e+01 cost=1.06e+04 flops=4.68e+07
 sigma counter=60 i=5 t=2.25e-04 per=1.27e+01 cost=1.06e+04 flops=4.70e+07
 sigma counter=60 i=6 t=2.19e-04 per=1.24e+01 cost=4.12e+03 flops=1.88e+07
 sigma counter=60 i=7 t=2.13e-04 per=1.20e+01 cost=3.83e+03 flops=1.80e+07
 total GEMM cost=4.52e+04 flops=2.55e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.14e-01 t_reduction=1.22e-02 tot=1.26e-01 ---
 sigma_tot counter=60 i=0 t=1.42e-02 per=1.25e+01 cost=2.79e+05 flops=1.96e+07
 sigma_tot counter=60 i=1 t=1.42e-02 per=1.25e+01 cost=2.89e+05 flops=2.04e+07
 sigma_tot counter=60 i=2 t=1.42e-02 per=1.25e+01 cost=2.83e+05 flops=1.99e+07
 sigma_tot counter=60 i=3 t=1.41e-02 per=1.24e+01 cost=2.89e+05 flops=2.05e+07
 sigma_tot counter=60 i=4 t=1.40e-02 per=1.23e+01 cost=4.58e+05 flops=3.26e+07
 sigma_tot counter=60 i=5 t=1.42e-02 per=1.25e+01 cost=4.56e+05 flops=3.21e+07
 sigma_tot counter=60 i=6 t=1.47e-02 per=1.29e+01 cost=5.23e+05 flops=3.56e+07
 sigma_tot counter=60 i=7 t=1.42e-02 per=1.25e+01 cost=5.16e+05 flops=3.64e+07
 total GEMM cost=3.09e+06 flops=2.72e+07
    4   0 -      -2.652077167029  -3.45e-05   1.94e-03    6     8   1.76e-02  2.20e-03
    4   1 -      -2.430677272750  -1.08e-04   3.53e-03    6     8   1.76e-02  2.20e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.74e-03,1.81e-04 cost=4.52e+04 flops[gemm]=2.60e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.74e-03 t_reduction=1.81e-04 tot=1.92e-03 ---
 sigma counter=61 i=0 t=2.22e-04 per=1.28e+01 cost=3.82e+03 flops=1.72e+07
 sigma counter=61 i=1 t=2.16e-04 per=1.24e+01 cost=4.32e+03 flops=2.00e+07
 sigma counter=61 i=2 t=2.15e-04 per=1.24e+01 cost=3.83e+03 flops=1.78e+07
 sigma counter=61 i=3 t=2.15e-04 per=1.24e+01 cost=4.12e+03 flops=1.92e+07
 sigma counter=61 i=4 t=2.18e-04 per=1.26e+01 cost=1.06e+04 flops=4.85e+07
 sigma counter=61 i=5 t=2.19e-04 per=1.26e+01 cost=1.06e+04 flops=4.83e+07
 sigma counter=61 i=6 t=2.18e-04 per=1.26e+01 cost=4.12e+03 flops=1.89e+07
 sigma counter=61 i=7 t=2.14e-04 per=1.23e+01 cost=3.83e+03 flops=1.79e+07
 total GEMM cost=4.52e+04 flops=2.60e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.16e-01 t_reduction=1.23e-02 tot=1.28e-01 ---
 sigma_tot counter=61 i=0 t=1.44e-02 per=1.25e+01 cost=2.83e+05 flops=1.96e+07
 sigma_tot counter=61 i=1 t=1.44e-02 per=1.25e+01 cost=2.93e+05 flops=2.04e+07
 sigma_tot counter=61 i=2 t=1.45e-02 per=1.25e+01 cost=2.87e+05 flops=1.98e+07
 sigma_tot counter=61 i=3 t=1.43e-02 per=1.24e+01 cost=2.93e+05 flops=2.05e+07
 sigma_tot counter=61 i=4 t=1.43e-02 per=1.23e+01 cost=4.68e+05 flops=3.29e+07
 sigma_tot counter=61 i=5 t=1.44e-02 per=1.25e+01 cost=4.67e+05 flops=3.24e+07
 sigma_tot counter=61 i=6 t=1.49e-02 per=1.29e+01 cost=5.27e+05 flops=3.54e+07
 sigma_tot counter=61 i=7 t=1.44e-02 per=1.25e+01 cost=5.20e+05 flops=3.62e+07
 total GEMM cost=3.14e+06 flops=2.72e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.73e-03,1.81e-04 cost=4.52e+04 flops[gemm]=2.62e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.73e-03 t_reduction=1.81e-04 tot=1.91e-03 ---
 sigma counter=62 i=0 t=2.16e-04 per=1.25e+01 cost=3.82e+03 flops=1.77e+07
 sigma counter=62 i=1 t=2.16e-04 per=1.25e+01 cost=4.32e+03 flops=2.00e+07
 sigma counter=62 i=2 t=2.12e-04 per=1.23e+01 cost=3.83e+03 flops=1.81e+07
 sigma counter=62 i=3 t=2.12e-04 per=1.23e+01 cost=4.12e+03 flops=1.94e+07
 sigma counter=62 i=4 t=2.16e-04 per=1.25e+01 cost=1.06e+04 flops=4.89e+07
 sigma counter=62 i=5 t=2.18e-04 per=1.26e+01 cost=1.06e+04 flops=4.85e+07
 sigma counter=62 i=6 t=2.21e-04 per=1.28e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=62 i=7 t=2.15e-04 per=1.25e+01 cost=3.83e+03 flops=1.78e+07
 total GEMM cost=4.52e+04 flops=2.62e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.17e-01 t_reduction=1.25e-02 tot=1.30e-01 ---
 sigma_tot counter=62 i=0 t=1.46e-02 per=1.25e+01 cost=2.87e+05 flops=1.96e+07
 sigma_tot counter=62 i=1 t=1.46e-02 per=1.25e+01 cost=2.97e+05 flops=2.04e+07
 sigma_tot counter=62 i=2 t=1.47e-02 per=1.25e+01 cost=2.91e+05 flops=1.98e+07
 sigma_tot counter=62 i=3 t=1.45e-02 per=1.24e+01 cost=2.97e+05 flops=2.04e+07
 sigma_tot counter=62 i=4 t=1.45e-02 per=1.23e+01 cost=4.79e+05 flops=3.31e+07
 sigma_tot counter=62 i=5 t=1.46e-02 per=1.25e+01 cost=4.77e+05 flops=3.26e+07
 sigma_tot counter=62 i=6 t=1.51e-02 per=1.29e+01 cost=5.31e+05 flops=3.51e+07
 sigma_tot counter=62 i=7 t=1.46e-02 per=1.25e+01 cost=5.24e+05 flops=3.59e+07
 total GEMM cost=3.18e+06 flops=2.71e+07
    5   0 -      -2.652080298591  -3.13e-06   9.85e-04    6    10   2.17e-02  2.17e-03
    5   1 -      -2.430686752248  -9.48e-06   1.83e-03    6    10   2.17e-02  2.17e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.75e-03,1.81e-04 cost=4.52e+04 flops[gemm]=2.59e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.75e-03 t_reduction=1.81e-04 tot=1.93e-03 ---
 sigma counter=63 i=0 t=2.15e-04 per=1.23e+01 cost=3.82e+03 flops=1.78e+07
 sigma counter=63 i=1 t=2.20e-04 per=1.26e+01 cost=4.32e+03 flops=1.96e+07
 sigma counter=63 i=2 t=2.14e-04 per=1.23e+01 cost=3.83e+03 flops=1.79e+07
 sigma counter=63 i=3 t=2.25e-04 per=1.29e+01 cost=4.12e+03 flops=1.83e+07
 sigma counter=63 i=4 t=2.17e-04 per=1.24e+01 cost=1.06e+04 flops=4.87e+07
 sigma counter=63 i=5 t=2.21e-04 per=1.27e+01 cost=1.06e+04 flops=4.78e+07
 sigma counter=63 i=6 t=2.20e-04 per=1.26e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=63 i=7 t=2.14e-04 per=1.23e+01 cost=3.83e+03 flops=1.79e+07
 total GEMM cost=4.52e+04 flops=2.59e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.19e-01 t_reduction=1.27e-02 tot=1.32e-01 ---
 sigma_tot counter=63 i=0 t=1.49e-02 per=1.25e+01 cost=2.90e+05 flops=1.95e+07
 sigma_tot counter=63 i=1 t=1.48e-02 per=1.25e+01 cost=3.02e+05 flops=2.03e+07
 sigma_tot counter=63 i=2 t=1.49e-02 per=1.25e+01 cost=2.94e+05 flops=1.98e+07
 sigma_tot counter=63 i=3 t=1.47e-02 per=1.24e+01 cost=3.01e+05 flops=2.04e+07
 sigma_tot counter=63 i=4 t=1.47e-02 per=1.23e+01 cost=4.90e+05 flops=3.33e+07
 sigma_tot counter=63 i=5 t=1.49e-02 per=1.25e+01 cost=4.88e+05 flops=3.28e+07
 sigma_tot counter=63 i=6 t=1.53e-02 per=1.29e+01 cost=5.35e+05 flops=3.49e+07
 sigma_tot counter=63 i=7 t=1.48e-02 per=1.24e+01 cost=5.28e+05 flops=3.56e+07
 total GEMM cost=3.23e+06 flops=2.71e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.75e-03,1.81e-04 cost=4.52e+04 flops[gemm]=2.58e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.75e-03 t_reduction=1.81e-04 tot=1.93e-03 ---
 sigma counter=64 i=0 t=2.20e-04 per=1.26e+01 cost=3.82e+03 flops=1.74e+07
 sigma counter=64 i=1 t=2.18e-04 per=1.25e+01 cost=4.32e+03 flops=1.98e+07
 sigma counter=64 i=2 t=2.26e-04 per=1.29e+01 cost=3.83e+03 flops=1.70e+07
 sigma counter=64 i=3 t=2.15e-04 per=1.23e+01 cost=4.12e+03 flops=1.92e+07
 sigma counter=64 i=4 t=2.17e-04 per=1.24e+01 cost=1.06e+04 flops=4.87e+07
 sigma counter=64 i=5 t=2.19e-04 per=1.25e+01 cost=1.06e+04 flops=4.83e+07
 sigma counter=64 i=6 t=2.20e-04 per=1.26e+01 cost=4.12e+03 flops=1.87e+07
 sigma counter=64 i=7 t=2.16e-04 per=1.23e+01 cost=3.83e+03 flops=1.78e+07
 total GEMM cost=4.52e+04 flops=2.58e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.21e-01 t_reduction=1.29e-02 tot=1.34e-01 ---
 sigma_tot counter=64 i=0 t=1.51e-02 per=1.25e+01 cost=2.94e+05 flops=1.95e+07
 sigma_tot counter=64 i=1 t=1.50e-02 per=1.25e+01 cost=3.06e+05 flops=2.03e+07
 sigma_tot counter=64 i=2 t=1.51e-02 per=1.25e+01 cost=2.98e+05 flops=1.97e+07
 sigma_tot counter=64 i=3 t=1.50e-02 per=1.24e+01 cost=3.05e+05 flops=2.04e+07
 sigma_tot counter=64 i=4 t=1.49e-02 per=1.23e+01 cost=5.00e+05 flops=3.36e+07
 sigma_tot counter=64 i=5 t=1.51e-02 per=1.25e+01 cost=4.99e+05 flops=3.31e+07
 sigma_tot counter=64 i=6 t=1.56e-02 per=1.29e+01 cost=5.40e+05 flops=3.47e+07
 sigma_tot counter=64 i=7 t=1.50e-02 per=1.24e+01 cost=5.32e+05 flops=3.54e+07
 total GEMM cost=3.27e+06 flops=2.71e+07
    6   0 -      -2.652081027011  -7.28e-07   3.12e-04    6    12   2.59e-02  2.16e-03
    6   1 -      -2.430689426190  -2.67e-06   7.42e-04    6    12   2.59e-02  2.16e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.75e-03,1.79e-04 cost=4.52e+04 flops[gemm]=2.59e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.75e-03 t_reduction=1.79e-04 tot=1.92e-03 ---
 sigma counter=65 i=0 t=2.26e-04 per=1.30e+01 cost=3.82e+03 flops=1.69e+07
 sigma counter=65 i=1 t=2.16e-04 per=1.24e+01 cost=4.32e+03 flops=2.00e+07
 sigma counter=65 i=2 t=2.14e-04 per=1.23e+01 cost=3.83e+03 flops=1.79e+07
 sigma counter=65 i=3 t=2.24e-04 per=1.28e+01 cost=4.12e+03 flops=1.84e+07
 sigma counter=65 i=4 t=2.17e-04 per=1.24e+01 cost=1.06e+04 flops=4.87e+07
 sigma counter=65 i=5 t=2.22e-04 per=1.27e+01 cost=1.06e+04 flops=4.76e+07
 sigma counter=65 i=6 t=2.16e-04 per=1.24e+01 cost=4.12e+03 flops=1.91e+07
 sigma counter=65 i=7 t=2.10e-04 per=1.20e+01 cost=3.83e+03 flops=1.83e+07
 total GEMM cost=4.52e+04 flops=2.59e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.23e-01 t_reduction=1.31e-02 tot=1.36e-01 ---
 sigma_tot counter=65 i=0 t=1.53e-02 per=1.25e+01 cost=2.98e+05 flops=1.95e+07
 sigma_tot counter=65 i=1 t=1.53e-02 per=1.25e+01 cost=3.10e+05 flops=2.03e+07
 sigma_tot counter=65 i=2 t=1.53e-02 per=1.25e+01 cost=3.02e+05 flops=1.97e+07
 sigma_tot counter=65 i=3 t=1.52e-02 per=1.24e+01 cost=3.09e+05 flops=2.04e+07
 sigma_tot counter=65 i=4 t=1.51e-02 per=1.23e+01 cost=5.11e+05 flops=3.38e+07
 sigma_tot counter=65 i=5 t=1.53e-02 per=1.25e+01 cost=5.09e+05 flops=3.33e+07
 sigma_tot counter=65 i=6 t=1.58e-02 per=1.29e+01 cost=5.44e+05 flops=3.45e+07
 sigma_tot counter=65 i=7 t=1.52e-02 per=1.24e+01 cost=5.36e+05 flops=3.51e+07
 total GEMM cost=3.32e+06 flops=2.71e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.73e-03,1.81e-04 cost=4.52e+04 flops[gemm]=2.62e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.73e-03 t_reduction=1.81e-04 tot=1.91e-03 ---
 sigma counter=66 i=0 t=2.20e-04 per=1.27e+01 cost=3.82e+03 flops=1.74e+07
 sigma counter=66 i=1 t=2.14e-04 per=1.24e+01 cost=4.32e+03 flops=2.02e+07
 sigma counter=66 i=2 t=2.24e-04 per=1.30e+01 cost=3.83e+03 flops=1.71e+07
 sigma counter=66 i=3 t=2.12e-04 per=1.23e+01 cost=4.12e+03 flops=1.94e+07
 sigma counter=66 i=4 t=2.15e-04 per=1.24e+01 cost=1.06e+04 flops=4.92e+07
 sigma counter=66 i=5 t=2.17e-04 per=1.26e+01 cost=1.06e+04 flops=4.87e+07
 sigma counter=66 i=6 t=2.16e-04 per=1.25e+01 cost=4.12e+03 flops=1.91e+07
 sigma counter=66 i=7 t=2.09e-04 per=1.21e+01 cost=3.83e+03 flops=1.83e+07
 total GEMM cost=4.52e+04 flops=2.62e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.24e-01 t_reduction=1.32e-02 tot=1.37e-01 ---
 sigma_tot counter=66 i=0 t=1.55e-02 per=1.25e+01 cost=3.02e+05 flops=1.94e+07
 sigma_tot counter=66 i=1 t=1.55e-02 per=1.25e+01 cost=3.15e+05 flops=2.03e+07
 sigma_tot counter=66 i=2 t=1.55e-02 per=1.25e+01 cost=3.06e+05 flops=1.97e+07
 sigma_tot counter=66 i=3 t=1.54e-02 per=1.24e+01 cost=3.13e+05 flops=2.03e+07
 sigma_tot counter=66 i=4 t=1.53e-02 per=1.23e+01 cost=5.21e+05 flops=3.40e+07
 sigma_tot counter=66 i=5 t=1.55e-02 per=1.25e+01 cost=5.20e+05 flops=3.35e+07
 sigma_tot counter=66 i=6 t=1.60e-02 per=1.29e+01 cost=5.48e+05 flops=3.42e+07
 sigma_tot counter=66 i=7 t=1.55e-02 per=1.24e+01 cost=5.39e+05 flops=3.49e+07
 total GEMM cost=3.36e+06 flops=2.71e+07
    7   0 +      -2.652081087251  -6.02e-08   8.25e-05    6    14   3.00e-02  2.14e-03
    7   1 -      -2.430689830982  -4.05e-07   2.50e-04    6    14   3.00e-02  2.14e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.72e-03,1.78e-04 cost=4.52e+04 flops[gemm]=2.62e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.72e-03 t_reduction=1.78e-04 tot=1.90e-03 ---
 sigma counter=67 i=0 t=2.22e-04 per=1.29e+01 cost=3.82e+03 flops=1.72e+07
 sigma counter=67 i=1 t=2.12e-04 per=1.23e+01 cost=4.32e+03 flops=2.04e+07
 sigma counter=67 i=2 t=2.10e-04 per=1.22e+01 cost=3.83e+03 flops=1.83e+07
 sigma counter=67 i=3 t=2.22e-04 per=1.29e+01 cost=4.12e+03 flops=1.86e+07
 sigma counter=67 i=4 t=2.15e-04 per=1.25e+01 cost=1.06e+04 flops=4.92e+07
 sigma counter=67 i=5 t=2.17e-04 per=1.26e+01 cost=1.06e+04 flops=4.87e+07
 sigma counter=67 i=6 t=2.15e-04 per=1.25e+01 cost=4.12e+03 flops=1.92e+07
 sigma counter=67 i=7 t=2.10e-04 per=1.22e+01 cost=3.83e+03 flops=1.83e+07
 total GEMM cost=4.52e+04 flops=2.62e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.26e-01 t_reduction=1.34e-02 tot=1.39e-01 ---
 sigma_tot counter=67 i=0 t=1.57e-02 per=1.25e+01 cost=3.06e+05 flops=1.94e+07
 sigma_tot counter=67 i=1 t=1.57e-02 per=1.25e+01 cost=3.19e+05 flops=2.03e+07
 sigma_tot counter=67 i=2 t=1.58e-02 per=1.25e+01 cost=3.10e+05 flops=1.97e+07
 sigma_tot counter=67 i=3 t=1.56e-02 per=1.24e+01 cost=3.17e+05 flops=2.03e+07
 sigma_tot counter=67 i=4 t=1.55e-02 per=1.23e+01 cost=5.32e+05 flops=3.42e+07
 sigma_tot counter=67 i=5 t=1.57e-02 per=1.25e+01 cost=5.30e+05 flops=3.37e+07
 sigma_tot counter=67 i=6 t=1.62e-02 per=1.29e+01 cost=5.52e+05 flops=3.40e+07
 sigma_tot counter=67 i=7 t=1.57e-02 per=1.24e+01 cost=5.43e+05 flops=3.47e+07
 total GEMM cost=3.41e+06 flops=2.71e+07
    8   0 +      -2.652081087251   8.88e-16   8.25e-05    5    15   3.20e-02  2.14e-03
    8   1 +      -2.430689876389  -4.54e-08   6.80e-05    5    15   3.20e-02  2.14e-03
TIMING for Davidson : 3.20e-02  T(cal/comm/rest)=3.17e-02,8.01e-07,3.92e-04
optimized energies: isweep=1 dots=2 ibond=0 e[0]=-2.65208108725
optimized energies: isweep=1 dots=2 ibond=0 e[1]=-2.43068987639
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.5e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.377e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000654 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=6.74e-05,0.000267,0.00032 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00106,0.000189 cost=2.78e+04 flops[gemm]=2.62e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00106 t_reduction=0.000189 tot=0.00125 ---
 renorm counter=5 i=0 t=0.000207 per=19.5 cost=2.19e+03 flops=1.06e+07
 renorm counter=5 i=1 t=0.000206 per=19.4 cost=2.85e+03 flops=1.39e+07
 renorm counter=5 i=2 t=1e-06 per=0.0943 cost=0 flops=0
 renorm counter=5 i=3 t=1e-06 per=0.0943 cost=0 flops=0
 renorm counter=5 i=4 t=0.000205 per=19.3 cost=2.11e+03 flops=1.03e+07
 renorm counter=5 i=5 t=0.000204 per=19.2 cost=2.94e+03 flops=1.44e+07
 renorm counter=5 i=6 t=0.000236 per=22.3 cost=1.77e+04 flops=7.5e+07
 total GEMM cost=2.78e+04 flops=2.62e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00539 t_reduction=0.000936 tot=0.00632 ---
 renorm_tot counter=5 i=0 t=0.00109 per=20.2 cost=9e+03 flops=8.29e+06
 renorm_tot counter=5 i=1 t=0.00105 per=19.5 cost=1.34e+04 flops=1.28e+07
 renorm_tot counter=5 i=2 t=0.000406 per=7.54 cost=5.99e+03 flops=1.48e+07
 renorm_tot counter=5 i=3 t=0.000419 per=7.78 cost=1.09e+04 flops=2.6e+07
 renorm_tot counter=5 i=4 t=0.000635 per=11.8 cost=7.82e+03 flops=1.23e+07
 renorm_tot counter=5 i=5 t=0.000642 per=11.9 cost=1.35e+04 flops=2.11e+07
 renorm_tot counter=5 i=6 t=0.00115 per=21.3 cost=8.48e+04 flops=7.41e+07
 total GEMM cost=1.45e+05 flops=2.7e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0029 S T(init/kernel/comm)=0.00011,0.0028,1.5e-05 rank=0 -----
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.5e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=130:0.00099MB:9.7e-07GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=144:0.0011MB:1.1e-06GB
total mem of comb=305:0.0023MB:2.3e-06GB
===== CPUmem(GB): tot=2.7e-05 (comb,oper,dvdson,hvec,renorm)=2.3e-06,2.5e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=6.18e-05,4.09e-05,0.000103 speed=0.101GB/s disk[used]=6.51e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.92e-02 S #####
 T(fetch) = 9.71e-05 S  per = 0.25  per(accum) = 0.25
 T(hdiag) = 7.88e-05 S  per =  0.2  per(accum) = 0.45
 T(dvdsn) = 3.54e-02 S  per =   90  per(accum) = 91
 T(decim) = 8.41e-05 S  per = 0.21  per(accum) = 91
 T(guess) = 7.25e-05 S  per = 0.18  per(accum) = 91
 T(renrm) = 2.93e-03 S  per =  7.5  per(accum) = 98
 T(save ) = 6.11e-04 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.52e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.05e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 3.20e-04 S  per = 0.91  per(accum) = 1
 T(hintermediate init           ) = 2.19e-04 S  per = 0.62  per(accum) = 1.6
 T(hintermediates memcpy cpu2gpu) = 5.07e-06 S  per = 0.014  per(accum) = 1.7
 T(preprocess_hformulae_Hxlist2 ) = 1.59e-03 S  per =  4.5  per(accum) = 6.2
 T(hmmtasks init                ) = 9.68e-04 S  per =  2.8  per(accum) = 8.9
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   90  per(accum) = 99
 T(dvdson solver [communication]) = 8.01e-07 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.92e-04 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.87e-03 S
 T(qops init                    ) = 1.08e-04 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 3.05e-05 S  per =  1.1  per(accum) = 4.8
 T(symbolic_formulae_renorm     ) = 2.43e-04 S  per =  8.5  per(accum) = 13
 T(rintermediate init           ) = 1.37e-05 S  per = 0.48  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 5.58e-06 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 6.65e-04 S  per =   23  per(accum) = 37
 T(rmmtasks init                ) = 4.19e-04 S  per =   15  per(accum) = 52
 T(qops memset                  ) = 9.38e-06 S  per = 0.33  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.33e-03 S  per =   46  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 3.15e-05 S  per =  1.1  per(accum) = 99
 T(communication of opS and opH ) = 1.46e-05 S  per = 0.51  per(accum) = 1e+02
##### time_sweep: 3.92e-02 S #####
 T(fetch) = 9.71e-05 S  per = 0.25  per(accum) = 0.25
 T(hdiag) = 7.88e-05 S  per =  0.2  per(accum) = 0.45
 T(dvdsn) = 3.54e-02 S  per =   90  per(accum) = 91
 T(decim) = 8.41e-05 S  per = 0.21  per(accum) = 91
 T(guess) = 7.25e-05 S  per = 0.18  per(accum) = 91
 T(renrm) = 2.93e-03 S  per =  7.5  per(accum) = 98
 T(save ) = 6.11e-04 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.52e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.05e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 3.20e-04 S  per = 0.91  per(accum) = 1
 T(hintermediate init           ) = 2.19e-04 S  per = 0.62  per(accum) = 1.6
 T(hintermediates memcpy cpu2gpu) = 5.07e-06 S  per = 0.014  per(accum) = 1.7
 T(preprocess_hformulae_Hxlist2 ) = 1.59e-03 S  per =  4.5  per(accum) = 6.2
 T(hmmtasks init                ) = 9.68e-04 S  per =  2.8  per(accum) = 8.9
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   90  per(accum) = 99
 T(dvdson solver [communication]) = 8.01e-07 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.92e-04 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.87e-03 S
 T(qops init                    ) = 1.08e-04 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 3.05e-05 S  per =  1.1  per(accum) = 4.8
 T(symbolic_formulae_renorm     ) = 2.43e-04 S  per =  8.5  per(accum) = 13
 T(rintermediate init           ) = 1.37e-05 S  per = 0.48  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 5.58e-06 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 6.65e-04 S  per =   23  per(accum) = 37
 T(rmmtasks init                ) = 4.19e-04 S  per =   15  per(accum) = 52
 T(qops memset                  ) = 9.38e-06 S  per = 0.33  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.33e-03 S  per =   46  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 3.15e-05 S  per =  1.1  per(accum) = 99
 T(communication of opS and opH ) = 1.46e-05 S  per = 0.51  per(accum) = 1e+02
##### time_global: 2.01e-01 S #####
 T(fetch) = 1.95e-03 S  per = 0.97  per(accum) = 0.97
 T(hdiag) = 5.88e-04 S  per = 0.29  per(accum) = 1.3
 T(dvdsn) = 1.78e-01 S  per =   89  per(accum) = 90
 T(decim) = 1.60e-03 S  per = 0.79  per(accum) = 91
 T(guess) = 4.86e-04 S  per = 0.24  per(accum) = 91
 T(renrm) = 1.50e-02 S  per =  7.4  per(accum) = 98
 T(save ) = 3.42e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.77e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 2.27e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 1.93e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 1.24e-03 S  per =  0.7  per(accum) = 1.9
 T(hintermediates memcpy cpu2gpu) = 3.08e-05 S  per = 0.017  per(accum) = 1.9
 T(preprocess_hformulae_Hxlist2 ) = 1.42e-02 S  per =    8  per(accum) = 9.9
 T(hmmtasks init                ) = 8.37e-03 S  per =  4.7  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 1.49e-01 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 3.85e-06 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.32e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.47e-02 S
 T(qops init                    ) = 8.16e-04 S  per =  5.6  per(accum) = 5.6
 T(qops_dict memcpy cpu2gpu     ) = 2.15e-04 S  per =  1.5  per(accum) = 7
 T(symbolic_formulae_renorm     ) = 1.48e-03 S  per =   10  per(accum) = 17
 T(rintermediate init           ) = 5.07e-04 S  per =  3.5  per(accum) = 21
 T(rintermediates memcpy cpu2gpu) = 3.42e-05 S  per = 0.23  per(accum) = 21
 T(preprocess_formulae_Rlist2   ) = 2.73e-03 S  per =   19  per(accum) = 39
 T(rmmtasks init                ) = 1.76e-03 S  per =   12  per(accum) = 51
 T(qops memset                  ) = 5.10e-05 S  per = 0.35  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 6.85e-03 S  per =   47  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 1.72e-04 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 6.21e-05 S  per = 0.42  per(accum) = 1e+02

isweep=1 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.899e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=130:0.000992MB:9.69e-07GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=144:0.0011MB:1.07e-06GB
total mem of comb=305:0.00233MB:2.27e-06GB
===== CPUmem(GB): tot=1.59e-05 (comb,oper,dvdson,hvec,renorm)=2.27e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x4846dd70
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.733e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000167 flops=2.64e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.152e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00272 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=6.47e-05,0.00119,0.00146 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.08e-05 (comb,oper,dvdson,hvec,renorm)=2.27e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.7e-05,0.0019,0.000187 cost=7.9e+04 flops[gemm]=4.15e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.0019 t_reduction=0.000187 tot=0.00209 ---
 sigma counter=68 i=0 t=0.000236 per=12.4 cost=6.81e+03 flops=2.89e+07
 sigma counter=68 i=1 t=0.000235 per=12.4 cost=6.78e+03 flops=2.89e+07
 sigma counter=68 i=2 t=0.000242 per=12.7 cost=7.01e+03 flops=2.9e+07
 sigma counter=68 i=3 t=0.000233 per=12.3 cost=6.99e+03 flops=3e+07
 sigma counter=68 i=4 t=0.000227 per=11.9 cost=6.81e+03 flops=3e+07
 sigma counter=68 i=5 t=0.000229 per=12 cost=6.78e+03 flops=2.96e+07
 sigma counter=68 i=6 t=0.000258 per=13.6 cost=1.89e+04 flops=7.32e+07
 sigma counter=68 i=7 t=0.000242 per=12.7 cost=1.89e+04 flops=7.81e+07
 total GEMM cost=7.9e+04 flops=4.15e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.128 t_reduction=0.0136 tot=0.141 ---
 sigma_tot counter=68 i=0 t=0.016 per=12.5 cost=3.12e+05 flops=1.95e+07
 sigma_tot counter=68 i=1 t=0.0159 per=12.5 cost=3.26e+05 flops=2.05e+07
 sigma_tot counter=68 i=2 t=0.016 per=12.5 cost=3.17e+05 flops=1.98e+07
 sigma_tot counter=68 i=3 t=0.0158 per=12.4 cost=3.24e+05 flops=2.05e+07
 sigma_tot counter=68 i=4 t=0.0158 per=12.3 cost=5.39e+05 flops=3.41e+07
 sigma_tot counter=68 i=5 t=0.016 per=12.5 cost=5.37e+05 flops=3.36e+07
 sigma_tot counter=68 i=6 t=0.0165 per=12.9 cost=5.71e+05 flops=3.47e+07
 sigma_tot counter=68 i=7 t=0.0159 per=12.4 cost=5.62e+05 flops=3.54e+07
 total GEMM cost=3.49e+06 flops=2.73e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00189,0.000187 cost=7.9e+04 flops[gemm]=4.17e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00189 t_reduction=0.000187 tot=0.00208 ---
 sigma counter=69 i=0 t=0.000231 per=12.2 cost=6.81e+03 flops=2.95e+07
 sigma counter=69 i=1 t=0.000237 per=12.5 cost=6.78e+03 flops=2.86e+07
 sigma counter=69 i=2 t=0.000241 per=12.7 cost=7.01e+03 flops=2.91e+07
 sigma counter=69 i=3 t=0.000232 per=12.2 cost=6.99e+03 flops=3.01e+07
 sigma counter=69 i=4 t=0.000224 per=11.8 cost=6.81e+03 flops=3.04e+07
 sigma counter=69 i=5 t=0.000233 per=12.3 cost=6.78e+03 flops=2.91e+07
 sigma counter=69 i=6 t=0.000253 per=13.4 cost=1.89e+04 flops=7.47e+07
 sigma counter=69 i=7 t=0.000243 per=12.8 cost=1.89e+04 flops=7.78e+07
 total GEMM cost=7.9e+04 flops=4.17e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.13 t_reduction=0.0138 tot=0.144 ---
 sigma_tot counter=69 i=0 t=0.0162 per=12.5 cost=3.19e+05 flops=1.97e+07
 sigma_tot counter=69 i=1 t=0.0162 per=12.5 cost=3.33e+05 flops=2.06e+07
 sigma_tot counter=69 i=2 t=0.0162 per=12.5 cost=3.24e+05 flops=1.99e+07
 sigma_tot counter=69 i=3 t=0.0161 per=12.4 cost=3.31e+05 flops=2.06e+07
 sigma_tot counter=69 i=4 t=0.016 per=12.3 cost=5.45e+05 flops=3.41e+07
 sigma_tot counter=69 i=5 t=0.0162 per=12.5 cost=5.44e+05 flops=3.36e+07
 sigma_tot counter=69 i=6 t=0.0167 per=12.9 cost=5.9e+05 flops=3.53e+07
 sigma_tot counter=69 i=7 t=0.0161 per=12.4 cost=5.81e+05 flops=3.6e+07
 total GEMM cost=3.57e+06 flops=2.75e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652081087251  -1.00e+03   7.61e-02    2     2   4.45e-03  2.22e-03
    1   1 -      -2.430689876389  -1.00e+03   1.16e-01    2     2   4.45e-03  2.22e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.30e-05,1.89e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.17e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.89e-03 t_reduction=1.89e-04 tot=2.08e-03 ---
 sigma counter=70 i=0 t=2.35e-04 per=1.24e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=70 i=1 t=2.30e-04 per=1.22e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=70 i=2 t=2.40e-04 per=1.27e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=70 i=3 t=2.33e-04 per=1.23e+01 cost=6.99e+03 flops=3.00e+07
 sigma counter=70 i=4 t=2.28e-04 per=1.21e+01 cost=6.81e+03 flops=2.99e+07
 sigma counter=70 i=5 t=2.35e-04 per=1.24e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=70 i=6 t=2.53e-04 per=1.34e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=70 i=7 t=2.38e-04 per=1.26e+01 cost=1.89e+04 flops=7.94e+07
 total GEMM cost=7.90e+04 flops=4.17e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.32e-01 t_reduction=1.40e-02 tot=1.46e-01 ---
 sigma_tot counter=70 i=0 t=1.64e-02 per=1.25e+01 cost=3.26e+05 flops=1.98e+07
 sigma_tot counter=70 i=1 t=1.64e-02 per=1.25e+01 cost=3.39e+05 flops=2.07e+07
 sigma_tot counter=70 i=2 t=1.65e-02 per=1.25e+01 cost=3.31e+05 flops=2.01e+07
 sigma_tot counter=70 i=3 t=1.63e-02 per=1.24e+01 cost=3.38e+05 flops=2.07e+07
 sigma_tot counter=70 i=4 t=1.62e-02 per=1.23e+01 cost=5.52e+05 flops=3.40e+07
 sigma_tot counter=70 i=5 t=1.64e-02 per=1.25e+01 cost=5.51e+05 flops=3.35e+07
 sigma_tot counter=70 i=6 t=1.70e-02 per=1.29e+01 cost=6.09e+05 flops=3.59e+07
 sigma_tot counter=70 i=7 t=1.64e-02 per=1.24e+01 cost=6.00e+05 flops=3.66e+07
 total GEMM cost=3.65e+06 flops=2.77e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.89e-03,1.83e-04 cost=7.90e+04 flops[gemm]=4.17e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.89e-03 t_reduction=1.83e-04 tot=2.08e-03 ---
 sigma counter=71 i=0 t=2.31e-04 per=1.22e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=71 i=1 t=2.32e-04 per=1.23e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=71 i=2 t=2.32e-04 per=1.23e+01 cost=7.01e+03 flops=3.02e+07
 sigma counter=71 i=3 t=2.41e-04 per=1.27e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=71 i=4 t=2.29e-04 per=1.21e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=71 i=5 t=2.39e-04 per=1.26e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=71 i=6 t=2.48e-04 per=1.31e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=71 i=7 t=2.40e-04 per=1.27e+01 cost=1.89e+04 flops=7.87e+07
 total GEMM cost=7.90e+04 flops=4.17e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.34e-01 t_reduction=1.42e-02 tot=1.48e-01 ---
 sigma_tot counter=71 i=0 t=1.67e-02 per=1.25e+01 cost=3.33e+05 flops=2.00e+07
 sigma_tot counter=71 i=1 t=1.66e-02 per=1.24e+01 cost=3.46e+05 flops=2.08e+07
 sigma_tot counter=71 i=2 t=1.67e-02 per=1.25e+01 cost=3.38e+05 flops=2.02e+07
 sigma_tot counter=71 i=3 t=1.66e-02 per=1.24e+01 cost=3.45e+05 flops=2.09e+07
 sigma_tot counter=71 i=4 t=1.65e-02 per=1.23e+01 cost=5.59e+05 flops=3.40e+07
 sigma_tot counter=71 i=5 t=1.67e-02 per=1.25e+01 cost=5.57e+05 flops=3.34e+07
 sigma_tot counter=71 i=6 t=1.72e-02 per=1.29e+01 cost=6.27e+05 flops=3.64e+07
 sigma_tot counter=71 i=7 t=1.66e-02 per=1.24e+01 cost=6.19e+05 flops=3.72e+07
 total GEMM cost=3.73e+06 flops=2.79e+07
    2   0 -      -2.654436755680  -2.36e-03   1.10e-02    4     4   8.90e-03  2.22e-03
    2   1 -      -2.436722360481  -6.03e-03   1.83e-02    4     4   8.90e-03  2.22e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.89e-03,1.83e-04 cost=7.90e+04 flops[gemm]=4.19e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.88e-03 t_reduction=1.82e-04 tot=2.07e-03 ---
 sigma counter=72 i=0 t=2.35e-04 per=1.25e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=72 i=1 t=2.31e-04 per=1.23e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=72 i=2 t=2.37e-04 per=1.26e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=72 i=3 t=2.35e-04 per=1.25e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=72 i=4 t=2.25e-04 per=1.19e+01 cost=6.81e+03 flops=3.03e+07
 sigma counter=72 i=5 t=2.29e-04 per=1.22e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=72 i=6 t=2.56e-04 per=1.36e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=72 i=7 t=2.36e-04 per=1.25e+01 cost=1.89e+04 flops=8.01e+07
 total GEMM cost=7.90e+04 flops=4.19e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.35e-01 t_reduction=1.44e-02 tot=1.50e-01 ---
 sigma_tot counter=72 i=0 t=1.69e-02 per=1.25e+01 cost=3.40e+05 flops=2.01e+07
 sigma_tot counter=72 i=1 t=1.69e-02 per=1.24e+01 cost=3.53e+05 flops=2.09e+07
 sigma_tot counter=72 i=2 t=1.69e-02 per=1.25e+01 cost=3.45e+05 flops=2.03e+07
 sigma_tot counter=72 i=3 t=1.68e-02 per=1.24e+01 cost=3.52e+05 flops=2.10e+07
 sigma_tot counter=72 i=4 t=1.67e-02 per=1.23e+01 cost=5.66e+05 flops=3.39e+07
 sigma_tot counter=72 i=5 t=1.69e-02 per=1.25e+01 cost=5.64e+05 flops=3.34e+07
 sigma_tot counter=72 i=6 t=1.75e-02 per=1.29e+01 cost=6.46e+05 flops=3.70e+07
 sigma_tot counter=72 i=7 t=1.69e-02 per=1.24e+01 cost=6.38e+05 flops=3.78e+07
 total GEMM cost=3.80e+06 flops=2.81e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.88e-03,1.81e-04 cost=7.90e+04 flops[gemm]=4.20e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.88e-03 t_reduction=1.81e-04 tot=2.06e-03 ---
 sigma counter=73 i=0 t=2.30e-04 per=1.22e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=73 i=1 t=2.34e-04 per=1.25e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=73 i=2 t=2.26e-04 per=1.20e+01 cost=7.01e+03 flops=3.10e+07
 sigma counter=73 i=3 t=2.33e-04 per=1.24e+01 cost=6.99e+03 flops=3.00e+07
 sigma counter=73 i=4 t=2.32e-04 per=1.24e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=73 i=5 t=2.31e-04 per=1.23e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=73 i=6 t=2.52e-04 per=1.34e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=73 i=7 t=2.40e-04 per=1.28e+01 cost=1.89e+04 flops=7.87e+07
 total GEMM cost=7.90e+04 flops=4.21e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.37e-01 t_reduction=1.45e-02 tot=1.52e-01 ---
 sigma_tot counter=73 i=0 t=1.71e-02 per=1.25e+01 cost=3.47e+05 flops=2.02e+07
 sigma_tot counter=73 i=1 t=1.71e-02 per=1.24e+01 cost=3.60e+05 flops=2.10e+07
 sigma_tot counter=73 i=2 t=1.72e-02 per=1.25e+01 cost=3.52e+05 flops=2.05e+07
 sigma_tot counter=73 i=3 t=1.70e-02 per=1.24e+01 cost=3.59e+05 flops=2.11e+07
 sigma_tot counter=73 i=4 t=1.69e-02 per=1.23e+01 cost=5.73e+05 flops=3.39e+07
 sigma_tot counter=73 i=5 t=1.71e-02 per=1.25e+01 cost=5.71e+05 flops=3.33e+07
 sigma_tot counter=73 i=6 t=1.77e-02 per=1.29e+01 cost=6.65e+05 flops=3.75e+07
 sigma_tot counter=73 i=7 t=1.71e-02 per=1.25e+01 cost=6.57e+05 flops=3.84e+07
 total GEMM cost=3.88e+06 flops=2.83e+07
    3   0 -      -2.654509457874  -7.27e-05   3.58e-03    6     6   1.33e-02  2.22e-03
    3   1 -      -2.436951014557  -2.29e-04   5.90e-03    6     6   1.33e-02  2.22e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.88e-03,1.83e-04 cost=7.90e+04 flops[gemm]=4.21e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.88e-03 t_reduction=1.83e-04 tot=2.06e-03 ---
 sigma counter=74 i=0 t=2.35e-04 per=1.25e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=74 i=1 t=2.32e-04 per=1.24e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=74 i=2 t=2.35e-04 per=1.25e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=74 i=3 t=2.30e-04 per=1.23e+01 cost=6.99e+03 flops=3.04e+07
 sigma counter=74 i=4 t=2.24e-04 per=1.19e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=74 i=5 t=2.34e-04 per=1.25e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=74 i=6 t=2.51e-04 per=1.34e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=74 i=7 t=2.35e-04 per=1.25e+01 cost=1.89e+04 flops=8.04e+07
 total GEMM cost=7.90e+04 flops=4.21e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.39e-01 t_reduction=1.47e-02 tot=1.54e-01 ---
 sigma_tot counter=74 i=0 t=1.74e-02 per=1.25e+01 cost=3.53e+05 flops=2.03e+07
 sigma_tot counter=74 i=1 t=1.73e-02 per=1.24e+01 cost=3.66e+05 flops=2.12e+07
 sigma_tot counter=74 i=2 t=1.74e-02 per=1.25e+01 cost=3.59e+05 flops=2.06e+07
 sigma_tot counter=74 i=3 t=1.73e-02 per=1.24e+01 cost=3.66e+05 flops=2.12e+07
 sigma_tot counter=74 i=4 t=1.71e-02 per=1.23e+01 cost=5.79e+05 flops=3.38e+07
 sigma_tot counter=74 i=5 t=1.74e-02 per=1.25e+01 cost=5.78e+05 flops=3.33e+07
 sigma_tot counter=74 i=6 t=1.80e-02 per=1.29e+01 cost=6.84e+05 flops=3.80e+07
 sigma_tot counter=74 i=7 t=1.73e-02 per=1.25e+01 cost=6.76e+05 flops=3.90e+07
 total GEMM cost=3.96e+06 flops=2.85e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.86e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.24e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.86e-03 t_reduction=1.90e-04 tot=2.05e-03 ---
 sigma counter=75 i=0 t=2.33e-04 per=1.25e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=75 i=1 t=2.31e-04 per=1.24e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=75 i=2 t=2.27e-04 per=1.22e+01 cost=7.01e+03 flops=3.09e+07
 sigma counter=75 i=3 t=2.30e-04 per=1.24e+01 cost=6.99e+03 flops=3.04e+07
 sigma counter=75 i=4 t=2.26e-04 per=1.21e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=75 i=5 t=2.32e-04 per=1.25e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=75 i=6 t=2.49e-04 per=1.34e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=75 i=7 t=2.34e-04 per=1.26e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.24e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.41e-01 t_reduction=1.49e-02 tot=1.56e-01 ---
 sigma_tot counter=75 i=0 t=1.76e-02 per=1.25e+01 cost=3.60e+05 flops=2.04e+07
 sigma_tot counter=75 i=1 t=1.76e-02 per=1.24e+01 cost=3.73e+05 flops=2.13e+07
 sigma_tot counter=75 i=2 t=1.76e-02 per=1.25e+01 cost=3.66e+05 flops=2.07e+07
 sigma_tot counter=75 i=3 t=1.75e-02 per=1.24e+01 cost=3.73e+05 flops=2.14e+07
 sigma_tot counter=75 i=4 t=1.74e-02 per=1.23e+01 cost=5.86e+05 flops=3.38e+07
 sigma_tot counter=75 i=5 t=1.76e-02 per=1.25e+01 cost=5.85e+05 flops=3.32e+07
 sigma_tot counter=75 i=6 t=1.82e-02 per=1.29e+01 cost=7.03e+05 flops=3.86e+07
 sigma_tot counter=75 i=7 t=1.76e-02 per=1.25e+01 cost=6.94e+05 flops=3.95e+07
 total GEMM cost=4.04e+06 flops=2.87e+07
    4   0 -      -2.654516214560  -6.76e-06   1.01e-03    6     8   1.77e-02  2.21e-03
    4   1 -      -2.436975310129  -2.43e-05   1.78e-03    6     8   1.77e-02  2.21e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.86e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.26e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.85e-03 t_reduction=1.82e-04 tot=2.04e-03 ---
 sigma counter=76 i=0 t=2.32e-04 per=1.25e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=76 i=1 t=2.29e-04 per=1.23e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=76 i=2 t=2.26e-04 per=1.22e+01 cost=7.01e+03 flops=3.10e+07
 sigma counter=76 i=3 t=2.33e-04 per=1.26e+01 cost=6.99e+03 flops=3.00e+07
 sigma counter=76 i=4 t=2.23e-04 per=1.20e+01 cost=6.81e+03 flops=3.06e+07
 sigma counter=76 i=5 t=2.25e-04 per=1.21e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=76 i=6 t=2.49e-04 per=1.34e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=76 i=7 t=2.38e-04 per=1.28e+01 cost=1.89e+04 flops=7.94e+07
 total GEMM cost=7.90e+04 flops=4.26e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.43e-01 t_reduction=1.51e-02 tot=1.58e-01 ---
 sigma_tot counter=76 i=0 t=1.78e-02 per=1.25e+01 cost=3.67e+05 flops=2.06e+07
 sigma_tot counter=76 i=1 t=1.78e-02 per=1.24e+01 cost=3.80e+05 flops=2.14e+07
 sigma_tot counter=76 i=2 t=1.79e-02 per=1.25e+01 cost=3.73e+05 flops=2.09e+07
 sigma_tot counter=76 i=3 t=1.77e-02 per=1.24e+01 cost=3.80e+05 flops=2.15e+07
 sigma_tot counter=76 i=4 t=1.76e-02 per=1.23e+01 cost=5.93e+05 flops=3.37e+07
 sigma_tot counter=76 i=5 t=1.78e-02 per=1.25e+01 cost=5.91e+05 flops=3.32e+07
 sigma_tot counter=76 i=6 t=1.85e-02 per=1.29e+01 cost=7.22e+05 flops=3.91e+07
 sigma_tot counter=76 i=7 t=1.78e-02 per=1.25e+01 cost=7.13e+05 flops=4.01e+07
 total GEMM cost=4.12e+06 flops=2.88e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.85e-03,1.81e-04 cost=7.90e+04 flops[gemm]=4.26e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.85e-03 t_reduction=1.81e-04 tot=2.03e-03 ---
 sigma counter=77 i=0 t=2.27e-04 per=1.23e+01 cost=6.81e+03 flops=3.00e+07
 sigma counter=77 i=1 t=2.27e-04 per=1.23e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=77 i=2 t=2.34e-04 per=1.26e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=77 i=3 t=2.29e-04 per=1.24e+01 cost=6.99e+03 flops=3.05e+07
 sigma counter=77 i=4 t=2.22e-04 per=1.20e+01 cost=6.81e+03 flops=3.07e+07
 sigma counter=77 i=5 t=2.26e-04 per=1.22e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=77 i=6 t=2.47e-04 per=1.34e+01 cost=1.89e+04 flops=7.65e+07
 sigma counter=77 i=7 t=2.38e-04 per=1.29e+01 cost=1.89e+04 flops=7.94e+07
 total GEMM cost=7.90e+04 flops=4.27e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.45e-01 t_reduction=1.53e-02 tot=1.60e-01 ---
 sigma_tot counter=77 i=0 t=1.81e-02 per=1.25e+01 cost=3.74e+05 flops=2.07e+07
 sigma_tot counter=77 i=1 t=1.80e-02 per=1.24e+01 cost=3.87e+05 flops=2.15e+07
 sigma_tot counter=77 i=2 t=1.81e-02 per=1.25e+01 cost=3.80e+05 flops=2.10e+07
 sigma_tot counter=77 i=3 t=1.79e-02 per=1.24e+01 cost=3.87e+05 flops=2.16e+07
 sigma_tot counter=77 i=4 t=1.78e-02 per=1.23e+01 cost=6.00e+05 flops=3.37e+07
 sigma_tot counter=77 i=5 t=1.80e-02 per=1.25e+01 cost=5.98e+05 flops=3.31e+07
 sigma_tot counter=77 i=6 t=1.87e-02 per=1.29e+01 cost=7.41e+05 flops=3.96e+07
 sigma_tot counter=77 i=7 t=1.80e-02 per=1.25e+01 cost=7.32e+05 flops=4.06e+07
 total GEMM cost=4.20e+06 flops=2.90e+07
    5   0 -      -2.654516839742  -6.25e-07   4.21e-04    6    10   2.20e-02  2.20e-03
    5   1 -      -2.436977310239  -2.00e-06   4.24e-04    6    10   2.20e-02  2.20e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.85e-03,1.81e-04 cost=7.90e+04 flops[gemm]=4.27e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.85e-03 t_reduction=1.81e-04 tot=2.03e-03 ---
 sigma counter=78 i=0 t=2.29e-04 per=1.24e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=78 i=1 t=2.27e-04 per=1.23e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=78 i=2 t=2.31e-04 per=1.25e+01 cost=7.01e+03 flops=3.03e+07
 sigma counter=78 i=3 t=2.28e-04 per=1.23e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=78 i=4 t=2.21e-04 per=1.19e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=78 i=5 t=2.27e-04 per=1.23e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=78 i=6 t=2.51e-04 per=1.36e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=78 i=7 t=2.36e-04 per=1.28e+01 cost=1.89e+04 flops=8.01e+07
 total GEMM cost=7.90e+04 flops=4.27e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.47e-01 t_reduction=1.55e-02 tot=1.62e-01 ---
 sigma_tot counter=78 i=0 t=1.83e-02 per=1.25e+01 cost=3.81e+05 flops=2.08e+07
 sigma_tot counter=78 i=1 t=1.82e-02 per=1.24e+01 cost=3.94e+05 flops=2.16e+07
 sigma_tot counter=78 i=2 t=1.83e-02 per=1.25e+01 cost=3.87e+05 flops=2.11e+07
 sigma_tot counter=78 i=3 t=1.82e-02 per=1.24e+01 cost=3.94e+05 flops=2.17e+07
 sigma_tot counter=78 i=4 t=1.80e-02 per=1.23e+01 cost=6.07e+05 flops=3.37e+07
 sigma_tot counter=78 i=5 t=1.83e-02 per=1.25e+01 cost=6.05e+05 flops=3.31e+07
 sigma_tot counter=78 i=6 t=1.90e-02 per=1.29e+01 cost=7.60e+05 flops=4.00e+07
 sigma_tot counter=78 i=7 t=1.83e-02 per=1.25e+01 cost=7.51e+05 flops=4.11e+07
 total GEMM cost=4.28e+06 flops=2.92e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.86e-03,1.83e-04 cost=7.90e+04 flops[gemm]=4.24e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.86e-03 t_reduction=1.83e-04 tot=2.04e-03 ---
 sigma counter=79 i=0 t=2.24e-04 per=1.20e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=79 i=1 t=2.28e-04 per=1.23e+01 cost=6.78e+03 flops=2.98e+07
 sigma counter=79 i=2 t=2.37e-04 per=1.27e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=79 i=3 t=2.30e-04 per=1.24e+01 cost=6.99e+03 flops=3.04e+07
 sigma counter=79 i=4 t=2.21e-04 per=1.19e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=79 i=5 t=2.30e-04 per=1.24e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=79 i=6 t=2.52e-04 per=1.35e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=79 i=7 t=2.38e-04 per=1.28e+01 cost=1.89e+04 flops=7.94e+07
 total GEMM cost=7.90e+04 flops=4.25e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.48e-01 t_reduction=1.56e-02 tot=1.64e-01 ---
 sigma_tot counter=79 i=0 t=1.85e-02 per=1.25e+01 cost=3.87e+05 flops=2.09e+07
 sigma_tot counter=79 i=1 t=1.85e-02 per=1.24e+01 cost=4.00e+05 flops=2.17e+07
 sigma_tot counter=79 i=2 t=1.86e-02 per=1.25e+01 cost=3.94e+05 flops=2.12e+07
 sigma_tot counter=79 i=3 t=1.84e-02 per=1.24e+01 cost=4.01e+05 flops=2.18e+07
 sigma_tot counter=79 i=4 t=1.83e-02 per=1.23e+01 cost=6.14e+05 flops=3.36e+07
 sigma_tot counter=79 i=5 t=1.85e-02 per=1.25e+01 cost=6.12e+05 flops=3.31e+07
 sigma_tot counter=79 i=6 t=1.92e-02 per=1.30e+01 cost=7.79e+05 flops=4.05e+07
 sigma_tot counter=79 i=7 t=1.85e-02 per=1.25e+01 cost=7.70e+05 flops=4.16e+07
 total GEMM cost=4.36e+06 flops=2.93e+07
    6   0 -      -2.654516957904  -1.18e-07   1.26e-04    6    12   2.64e-02  2.20e-03
    6   1 -      -2.436977427914  -1.18e-07   1.80e-04    6    12   2.64e-02  2.20e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.85e-03,1.81e-04 cost=7.90e+04 flops[gemm]=4.27e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.85e-03 t_reduction=1.81e-04 tot=2.03e-03 ---
 sigma counter=80 i=0 t=2.34e-04 per=1.26e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=80 i=1 t=2.27e-04 per=1.23e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=80 i=2 t=2.26e-04 per=1.22e+01 cost=7.01e+03 flops=3.10e+07
 sigma counter=80 i=3 t=2.28e-04 per=1.23e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=80 i=4 t=2.21e-04 per=1.19e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=80 i=5 t=2.27e-04 per=1.23e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=80 i=6 t=2.49e-04 per=1.35e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=80 i=7 t=2.38e-04 per=1.29e+01 cost=1.89e+04 flops=7.94e+07
 total GEMM cost=7.90e+04 flops=4.27e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.50e-01 t_reduction=1.58e-02 tot=1.66e-01 ---
 sigma_tot counter=80 i=0 t=1.88e-02 per=1.25e+01 cost=3.94e+05 flops=2.10e+07
 sigma_tot counter=80 i=1 t=1.87e-02 per=1.24e+01 cost=4.07e+05 flops=2.18e+07
 sigma_tot counter=80 i=2 t=1.88e-02 per=1.25e+01 cost=4.01e+05 flops=2.13e+07
 sigma_tot counter=80 i=3 t=1.86e-02 per=1.24e+01 cost=4.08e+05 flops=2.19e+07
 sigma_tot counter=80 i=4 t=1.85e-02 per=1.23e+01 cost=6.20e+05 flops=3.36e+07
 sigma_tot counter=80 i=5 t=1.87e-02 per=1.25e+01 cost=6.18e+05 flops=3.30e+07
 sigma_tot counter=80 i=6 t=1.95e-02 per=1.30e+01 cost=7.98e+05 flops=4.09e+07
 sigma_tot counter=80 i=7 t=1.88e-02 per=1.25e+01 cost=7.89e+05 flops=4.21e+07
 total GEMM cost=4.44e+06 flops=2.95e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.86e-03,1.86e-04 cost=7.90e+04 flops[gemm]=4.25e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.86e-03 t_reduction=1.85e-04 tot=2.04e-03 ---
 sigma counter=81 i=0 t=2.28e-04 per=1.23e+01 cost=6.81e+03 flops=2.99e+07
 sigma counter=81 i=1 t=2.27e-04 per=1.22e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=81 i=2 t=2.30e-04 per=1.24e+01 cost=7.01e+03 flops=3.05e+07
 sigma counter=81 i=3 t=2.29e-04 per=1.23e+01 cost=6.99e+03 flops=3.05e+07
 sigma counter=81 i=4 t=2.24e-04 per=1.21e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=81 i=5 t=2.30e-04 per=1.24e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=81 i=6 t=2.55e-04 per=1.37e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=81 i=7 t=2.33e-04 per=1.26e+01 cost=1.89e+04 flops=8.11e+07
 total GEMM cost=7.90e+04 flops=4.26e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.52e-01 t_reduction=1.60e-02 tot=1.68e-01 ---
 sigma_tot counter=81 i=0 t=1.90e-02 per=1.25e+01 cost=4.01e+05 flops=2.11e+07
 sigma_tot counter=81 i=1 t=1.89e-02 per=1.24e+01 cost=4.14e+05 flops=2.19e+07
 sigma_tot counter=81 i=2 t=1.90e-02 per=1.25e+01 cost=4.08e+05 flops=2.14e+07
 sigma_tot counter=81 i=3 t=1.89e-02 per=1.24e+01 cost=4.15e+05 flops=2.20e+07
 sigma_tot counter=81 i=4 t=1.87e-02 per=1.23e+01 cost=6.27e+05 flops=3.35e+07
 sigma_tot counter=81 i=5 t=1.90e-02 per=1.25e+01 cost=6.25e+05 flops=3.30e+07
 sigma_tot counter=81 i=6 t=1.97e-02 per=1.30e+01 cost=8.16e+05 flops=4.14e+07
 sigma_tot counter=81 i=7 t=1.90e-02 per=1.25e+01 cost=8.08e+05 flops=4.25e+07
 total GEMM cost=4.51e+06 flops=2.97e+07
    7   0 +      -2.654516967213  -9.31e-09   3.92e-05    6    14   3.07e-02  2.19e-03
    7   1 +      -2.436977447783  -1.99e-08   6.16e-05    6    14   3.07e-02  2.19e-03
TIMING for Davidson : 3.07e-02  T(cal/comm/rest)=3.04e-02,6.61e-07,3.14e-04
optimized energies: isweep=1 dots=2 ibond=1 e[0]=-2.65451696721
optimized energies: isweep=1 dots=2 ibond=1 e[1]=-2.43697744778
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.588e-05 (comb,oper,dvdson,hvec,renorm)=2.272e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.754e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000161 flops=2.74e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 2.010e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000586 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=5.11e-05,0.000247,0.000288 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00104,0.000187 cost=1.55e+05 flops[gemm]=1.49e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00104 t_reduction=0.000187 tot=0.00123 ---
 renorm counter=6 i=0 t=0.000213 per=20.4 cost=8.1e+03 flops=3.8e+07
 renorm counter=6 i=1 t=0.000199 per=19.1 cost=8.36e+03 flops=4.2e+07
 renorm counter=6 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=6 i=3 t=1e-06 per=0.0959 cost=0 flops=0
 renorm counter=6 i=4 t=0.000196 per=18.8 cost=1.65e+04 flops=8.41e+07
 renorm counter=6 i=5 t=0.000203 per=19.5 cost=2.89e+04 flops=1.43e+08
 renorm counter=6 i=6 t=0.000231 per=22.1 cost=9.32e+04 flops=4.03e+08
 total GEMM cost=1.55e+05 flops=1.49e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00643 t_reduction=0.00112 tot=0.00755 ---
 renorm_tot counter=6 i=0 t=0.0013 per=20.2 cost=1.71e+04 flops=1.32e+07
 renorm_tot counter=6 i=1 t=0.00125 per=19.5 cost=2.18e+04 flops=1.74e+07
 renorm_tot counter=6 i=2 t=0.000406 per=6.32 cost=5.99e+03 flops=1.48e+07
 renorm_tot counter=6 i=3 t=0.00042 per=6.53 cost=1.09e+04 flops=2.59e+07
 renorm_tot counter=6 i=4 t=0.000831 per=12.9 cost=2.43e+04 flops=2.92e+07
 renorm_tot counter=6 i=5 t=0.000845 per=13.1 cost=4.24e+04 flops=5.02e+07
 renorm_tot counter=6 i=6 t=0.00138 per=21.4 cost=1.78e+05 flops=1.29e+08
 total GEMM cost=3.01e+05 flops=4.67e+07
check ||H-H.dagger||=8.79e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.9e-05,0.0028,9.6e-06 rank=0 -----
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=2.3e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=220:0.0017MB:1.6e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=347:0.0026MB:2.6e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.6e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=5.59e-05,4.41e-05,0.0001 speed=0.193GB/s disk[used]=8.12e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 4.00e-02 S #####
 T(fetch) = 3.82e-04 S  per = 0.95  per(accum) = 0.95
 T(hdiag) = 8.51e-05 S  per = 0.21  per(accum) = 1.2
 T(dvdsn) = 3.57e-02 S  per =   89  per(accum) = 90
 T(decim) = 3.25e-04 S  per = 0.81  per(accum) = 91
 T(guess) = 7.73e-05 S  per = 0.19  per(accum) = 91
 T(renrm) = 2.89e-03 S  per =  7.2  per(accum) = 99
 T(save ) = 5.68e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.55e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.00e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.79e-04 S  per = 0.79  per(accum) = 0.9
 T(hintermediate init           ) = 2.20e-04 S  per = 0.62  per(accum) = 1.5
 T(hintermediates memcpy cpu2gpu) = 4.40e-06 S  per = 0.012  per(accum) = 1.5
 T(preprocess_hformulae_Hxlist2 ) = 2.73e-03 S  per =  7.7  per(accum) = 9.2
 T(hmmtasks init                ) = 1.55e-03 S  per =  4.4  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 3.04e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 6.61e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.14e-04 S  per = 0.88  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.84e-03 S
 T(qops init                    ) = 7.88e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.49e-05 S  per =  1.2  per(accum) = 4
 T(symbolic_formulae_renorm     ) = 1.80e-04 S  per =  6.3  per(accum) = 10
 T(rintermediate init           ) = 2.05e-04 S  per =  7.2  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.74e-06 S  per = 0.17  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.95e-04 S  per =   21  per(accum) = 39
 T(rmmtasks init                ) = 3.93e-04 S  per =   14  per(accum) = 52
 T(qops memset                  ) = 8.42e-06 S  per =  0.3  per(accum) = 53
 T(preprocess_renorm_batchGPU   ) = 1.31e-03 S  per =   46  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.82e-05 S  per = 0.99  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.60e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 7.93e-02 S #####
 T(fetch) = 4.79e-04 S  per =  0.6  per(accum) = 0.6
 T(hdiag) = 1.64e-04 S  per = 0.21  per(accum) = 0.81
 T(dvdsn) = 7.11e-02 S  per =   90  per(accum) = 90
 T(decim) = 4.09e-04 S  per = 0.52  per(accum) = 91
 T(guess) = 1.50e-04 S  per = 0.19  per(accum) = 91
 T(renrm) = 5.82e-03 S  per =  7.3  per(accum) = 99
 T(save ) = 1.18e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 7.07e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 8.05e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 5.99e-04 S  per = 0.85  per(accum) = 0.96
 T(hintermediate init           ) = 4.38e-04 S  per = 0.62  per(accum) = 1.6
 T(hintermediates memcpy cpu2gpu) = 9.47e-06 S  per = 0.013  per(accum) = 1.6
 T(preprocess_hformulae_Hxlist2 ) = 4.32e-03 S  per =  6.1  per(accum) = 7.7
 T(hmmtasks init                ) = 2.52e-03 S  per =  3.6  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 6.20e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 1.46e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.05e-04 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.72e-03 S
 T(qops init                    ) = 1.87e-04 S  per =  3.3  per(accum) = 3.3
 T(qops_dict memcpy cpu2gpu     ) = 6.54e-05 S  per =  1.1  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 4.23e-04 S  per =  7.4  per(accum) = 12
 T(rintermediate init           ) = 2.19e-04 S  per =  3.8  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 1.03e-05 S  per = 0.18  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 1.26e-03 S  per =   22  per(accum) = 38
 T(rmmtasks init                ) = 8.12e-04 S  per =   14  per(accum) = 52
 T(qops memset                  ) = 1.78e-05 S  per = 0.31  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 2.64e-03 S  per =   46  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.97e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.42e-05 S  per = 0.42  per(accum) = 1e+02
##### time_global: 2.41e-01 S #####
 T(fetch) = 2.33e-03 S  per = 0.97  per(accum) = 0.97
 T(hdiag) = 6.73e-04 S  per = 0.28  per(accum) = 1.2
 T(dvdsn) = 2.14e-01 S  per =   89  per(accum) = 90
 T(decim) = 1.92e-03 S  per =  0.8  per(accum) = 91
 T(guess) = 5.63e-04 S  per = 0.23  per(accum) = 91
 T(renrm) = 1.79e-02 S  per =  7.4  per(accum) = 98
 T(save ) = 3.99e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.12e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 2.67e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 2.21e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 1.46e-03 S  per = 0.69  per(accum) = 1.9
 T(hintermediates memcpy cpu2gpu) = 3.52e-05 S  per = 0.017  per(accum) = 1.9
 T(preprocess_hformulae_Hxlist2 ) = 1.69e-02 S  per =    8  per(accum) = 9.8
 T(hmmtasks init                ) = 9.92e-03 S  per =  4.7  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 1.79e-01 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 4.51e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.63e-03 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.75e-02 S
 T(qops init                    ) = 8.95e-04 S  per =  5.1  per(accum) = 5.1
 T(qops_dict memcpy cpu2gpu     ) = 2.50e-04 S  per =  1.4  per(accum) = 6.5
 T(symbolic_formulae_renorm     ) = 1.66e-03 S  per =  9.5  per(accum) = 16
 T(rintermediate init           ) = 7.11e-04 S  per =  4.1  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 3.89e-05 S  per = 0.22  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 3.33e-03 S  per =   19  per(accum) = 39
 T(rmmtasks init                ) = 2.16e-03 S  per =   12  per(accum) = 52
 T(qops memset                  ) = 5.94e-05 S  per = 0.34  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 8.15e-03 S  per =   47  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 2.00e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 7.17e-05 S  per = 0.41  per(accum) = 1e+02

isweep=1 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.205e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=220:0.00168MB:1.64e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=347:0.00265MB:2.59e-06GB
===== CPUmem(GB): tot=3.55e-05 (comb,oper,dvdson,hvec,renorm)=2.59e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47cfd990
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.432e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000161 flops=2.74e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.014e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00247 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.72e-05,0.00107,0.00134 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.04e-05 (comb,oper,dvdson,hvec,renorm)=2.59e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.6e-05,0.00187,0.000181 cost=7.9e+04 flops[gemm]=4.23e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00187 t_reduction=0.000181 tot=0.00205 ---
 sigma counter=82 i=0 t=0.000231 per=12.4 cost=6.81e+03 flops=2.95e+07
 sigma counter=82 i=1 t=0.00024 per=12.9 cost=6.78e+03 flops=2.83e+07
 sigma counter=82 i=2 t=0.000222 per=11.9 cost=7.01e+03 flops=3.16e+07
 sigma counter=82 i=3 t=0.000237 per=12.7 cost=6.99e+03 flops=2.95e+07
 sigma counter=82 i=4 t=0.000225 per=12.1 cost=6.81e+03 flops=3.03e+07
 sigma counter=82 i=5 t=0.000227 per=12.2 cost=6.78e+03 flops=2.99e+07
 sigma counter=82 i=6 t=0.000249 per=13.3 cost=1.89e+04 flops=7.59e+07
 sigma counter=82 i=7 t=0.000235 per=12.6 cost=1.89e+04 flops=8.04e+07
 total GEMM cost=7.9e+04 flops=4.23e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.154 t_reduction=0.0162 tot=0.17 ---
 sigma_tot counter=82 i=0 t=0.0192 per=12.5 cost=4.08e+05 flops=2.12e+07
 sigma_tot counter=82 i=1 t=0.0192 per=12.4 cost=4.21e+05 flops=2.2e+07
 sigma_tot counter=82 i=2 t=0.0192 per=12.5 cost=4.15e+05 flops=2.16e+07
 sigma_tot counter=82 i=3 t=0.0191 per=12.4 cost=4.22e+05 flops=2.21e+07
 sigma_tot counter=82 i=4 t=0.0189 per=12.3 cost=6.34e+05 flops=3.35e+07
 sigma_tot counter=82 i=5 t=0.0192 per=12.5 cost=6.32e+05 flops=3.29e+07
 sigma_tot counter=82 i=6 t=0.02 per=13 cost=8.35e+05 flops=4.18e+07
 sigma_tot counter=82 i=7 t=0.0192 per=12.5 cost=8.27e+05 flops=4.3e+07
 total GEMM cost=4.59e+06 flops=2.98e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00184,0.000178 cost=7.9e+04 flops[gemm]=4.3e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00184 t_reduction=0.000178 tot=0.00201 ---
 sigma counter=83 i=0 t=0.000225 per=12.3 cost=6.81e+03 flops=3.03e+07
 sigma counter=83 i=1 t=0.000228 per=12.4 cost=6.78e+03 flops=2.98e+07
 sigma counter=83 i=2 t=0.000222 per=12.1 cost=7.01e+03 flops=3.16e+07
 sigma counter=83 i=3 t=0.000228 per=12.4 cost=6.99e+03 flops=3.06e+07
 sigma counter=83 i=4 t=0.000223 per=12.1 cost=6.81e+03 flops=3.06e+07
 sigma counter=83 i=5 t=0.000225 per=12.3 cost=6.78e+03 flops=3.02e+07
 sigma counter=83 i=6 t=0.000246 per=13.4 cost=1.89e+04 flops=7.68e+07
 sigma counter=83 i=7 t=0.000239 per=13 cost=1.89e+04 flops=7.91e+07
 total GEMM cost=7.9e+04 flops=4.3e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.156 t_reduction=0.0164 tot=0.172 ---
 sigma_tot counter=83 i=0 t=0.0194 per=12.5 cost=4.15e+05 flops=2.13e+07
 sigma_tot counter=83 i=1 t=0.0194 per=12.4 cost=4.28e+05 flops=2.21e+07
 sigma_tot counter=83 i=2 t=0.0195 per=12.5 cost=4.22e+05 flops=2.17e+07
 sigma_tot counter=83 i=3 t=0.0193 per=12.4 cost=4.29e+05 flops=2.22e+07
 sigma_tot counter=83 i=4 t=0.0191 per=12.3 cost=6.41e+05 flops=3.35e+07
 sigma_tot counter=83 i=5 t=0.0194 per=12.5 cost=6.39e+05 flops=3.29e+07
 sigma_tot counter=83 i=6 t=0.0202 per=13 cost=8.54e+05 flops=4.22e+07
 sigma_tot counter=83 i=7 t=0.0195 per=12.5 cost=8.46e+05 flops=4.34e+07
 total GEMM cost=4.67e+06 flops=3e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588771076  -1.00e+03   7.01e-02    2     2   4.29e-03  2.15e-03
    1   1 -      -2.436093960617  -1.00e+03   4.92e-02    2     2   4.29e-03  2.15e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.85e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.27e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.85e-03 t_reduction=1.79e-04 tot=2.03e-03 ---
 sigma counter=84 i=0 t=2.29e-04 per=1.24e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=84 i=1 t=2.29e-04 per=1.24e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=84 i=2 t=2.28e-04 per=1.23e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=84 i=3 t=2.28e-04 per=1.23e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=84 i=4 t=2.23e-04 per=1.21e+01 cost=6.81e+03 flops=3.06e+07
 sigma counter=84 i=5 t=2.27e-04 per=1.23e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=84 i=6 t=2.48e-04 per=1.34e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=84 i=7 t=2.36e-04 per=1.28e+01 cost=1.89e+04 flops=8.01e+07
 total GEMM cost=7.90e+04 flops=4.27e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.58e-01 t_reduction=1.65e-02 tot=1.74e-01 ---
 sigma_tot counter=84 i=0 t=1.97e-02 per=1.25e+01 cost=4.21e+05 flops=2.14e+07
 sigma_tot counter=84 i=1 t=1.96e-02 per=1.24e+01 cost=4.34e+05 flops=2.21e+07
 sigma_tot counter=84 i=2 t=1.97e-02 per=1.25e+01 cost=4.29e+05 flops=2.18e+07
 sigma_tot counter=84 i=3 t=1.96e-02 per=1.24e+01 cost=4.36e+05 flops=2.23e+07
 sigma_tot counter=84 i=4 t=1.94e-02 per=1.23e+01 cost=6.48e+05 flops=3.34e+07
 sigma_tot counter=84 i=5 t=1.96e-02 per=1.25e+01 cost=6.46e+05 flops=3.29e+07
 sigma_tot counter=84 i=6 t=2.05e-02 per=1.30e+01 cost=8.73e+05 flops=4.26e+07
 sigma_tot counter=84 i=7 t=1.97e-02 per=1.25e+01 cost=8.65e+05 flops=4.39e+07
 total GEMM cost=4.75e+06 flops=3.01e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.84e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.29e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.84e-03 t_reduction=1.79e-04 tot=2.02e-03 ---
 sigma counter=85 i=0 t=2.25e-04 per=1.22e+01 cost=6.81e+03 flops=3.03e+07
 sigma counter=85 i=1 t=2.29e-04 per=1.25e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=85 i=2 t=2.23e-04 per=1.21e+01 cost=7.01e+03 flops=3.14e+07
 sigma counter=85 i=3 t=2.29e-04 per=1.25e+01 cost=6.99e+03 flops=3.05e+07
 sigma counter=85 i=4 t=2.20e-04 per=1.20e+01 cost=6.81e+03 flops=3.10e+07
 sigma counter=85 i=5 t=2.26e-04 per=1.23e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=85 i=6 t=2.51e-04 per=1.37e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=85 i=7 t=2.34e-04 per=1.27e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.30e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.60e-01 t_reduction=1.67e-02 tot=1.76e-01 ---
 sigma_tot counter=85 i=0 t=1.99e-02 per=1.25e+01 cost=4.28e+05 flops=2.15e+07
 sigma_tot counter=85 i=1 t=1.98e-02 per=1.24e+01 cost=4.41e+05 flops=2.22e+07
 sigma_tot counter=85 i=2 t=1.99e-02 per=1.25e+01 cost=4.36e+05 flops=2.19e+07
 sigma_tot counter=85 i=3 t=1.98e-02 per=1.24e+01 cost=4.43e+05 flops=2.24e+07
 sigma_tot counter=85 i=4 t=1.96e-02 per=1.23e+01 cost=6.54e+05 flops=3.34e+07
 sigma_tot counter=85 i=5 t=1.99e-02 per=1.25e+01 cost=6.52e+05 flops=3.28e+07
 sigma_tot counter=85 i=6 t=2.07e-02 per=1.30e+01 cost=8.92e+05 flops=4.30e+07
 sigma_tot counter=85 i=7 t=1.99e-02 per=1.25e+01 cost=8.83e+05 flops=4.43e+07
 total GEMM cost=4.83e+06 flops=3.03e+07
    2   0 -      -2.654426819280  -1.84e-03   1.26e-02    4     4   8.58e-03  2.14e-03
    2   1 -      -2.436959163109  -8.65e-04   5.19e-03    4     4   8.58e-03  2.14e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.85e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.28e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.85e-03 t_reduction=1.77e-04 tot=2.02e-03 ---
 sigma counter=86 i=0 t=2.30e-04 per=1.25e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=86 i=1 t=2.30e-04 per=1.25e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=86 i=2 t=2.25e-04 per=1.22e+01 cost=7.01e+03 flops=3.11e+07
 sigma counter=86 i=3 t=2.27e-04 per=1.23e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=86 i=4 t=2.22e-04 per=1.20e+01 cost=6.81e+03 flops=3.07e+07
 sigma counter=86 i=5 t=2.30e-04 per=1.25e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=86 i=6 t=2.47e-04 per=1.34e+01 cost=1.89e+04 flops=7.65e+07
 sigma counter=86 i=7 t=2.34e-04 per=1.27e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.28e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.61e-01 t_reduction=1.69e-02 tot=1.78e-01 ---
 sigma_tot counter=86 i=0 t=2.01e-02 per=1.25e+01 cost=4.35e+05 flops=2.16e+07
 sigma_tot counter=86 i=1 t=2.01e-02 per=1.24e+01 cost=4.48e+05 flops=2.23e+07
 sigma_tot counter=86 i=2 t=2.01e-02 per=1.25e+01 cost=4.43e+05 flops=2.20e+07
 sigma_tot counter=86 i=3 t=2.00e-02 per=1.24e+01 cost=4.50e+05 flops=2.25e+07
 sigma_tot counter=86 i=4 t=1.98e-02 per=1.23e+01 cost=6.61e+05 flops=3.34e+07
 sigma_tot counter=86 i=5 t=2.01e-02 per=1.25e+01 cost=6.59e+05 flops=3.28e+07
 sigma_tot counter=86 i=6 t=2.10e-02 per=1.30e+01 cost=9.11e+05 flops=4.34e+07
 sigma_tot counter=86 i=7 t=2.02e-02 per=1.25e+01 cost=9.02e+05 flops=4.47e+07
 total GEMM cost=4.91e+06 flops=3.04e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.50e-05,1.83e-03,1.76e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.76e-04 tot=2.00e-03 ---
 sigma counter=87 i=0 t=2.29e-04 per=1.25e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=87 i=1 t=2.26e-04 per=1.24e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=87 i=2 t=2.23e-04 per=1.22e+01 cost=7.01e+03 flops=3.14e+07
 sigma counter=87 i=3 t=2.27e-04 per=1.24e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=87 i=4 t=2.19e-04 per=1.20e+01 cost=6.81e+03 flops=3.11e+07
 sigma counter=87 i=5 t=2.25e-04 per=1.23e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=87 i=6 t=2.44e-04 per=1.34e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=87 i=7 t=2.33e-04 per=1.28e+01 cost=1.89e+04 flops=8.11e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.63e-01 t_reduction=1.71e-02 tot=1.80e-01 ---
 sigma_tot counter=87 i=0 t=2.04e-02 per=1.25e+01 cost=4.42e+05 flops=2.17e+07
 sigma_tot counter=87 i=1 t=2.03e-02 per=1.24e+01 cost=4.55e+05 flops=2.24e+07
 sigma_tot counter=87 i=2 t=2.04e-02 per=1.25e+01 cost=4.50e+05 flops=2.21e+07
 sigma_tot counter=87 i=3 t=2.02e-02 per=1.24e+01 cost=4.57e+05 flops=2.26e+07
 sigma_tot counter=87 i=4 t=2.00e-02 per=1.23e+01 cost=6.68e+05 flops=3.34e+07
 sigma_tot counter=87 i=5 t=2.03e-02 per=1.25e+01 cost=6.66e+05 flops=3.28e+07
 sigma_tot counter=87 i=6 t=2.12e-02 per=1.30e+01 cost=9.30e+05 flops=4.38e+07
 sigma_tot counter=87 i=7 t=2.04e-02 per=1.25e+01 cost=9.21e+05 flops=4.52e+07
 total GEMM cost=4.99e+06 flops=3.06e+07
    3   0 -      -2.654508896837  -8.21e-05   3.56e-03    6     6   1.28e-02  2.14e-03
    3   1 -      -2.436975274429  -1.61e-05   1.59e-03    6     6   1.28e-02  2.14e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.81e-04 cost=7.90e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.81e-04 tot=2.01e-03 ---
 sigma counter=88 i=0 t=2.30e-04 per=1.26e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=88 i=1 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=88 i=2 t=2.24e-04 per=1.23e+01 cost=7.01e+03 flops=3.13e+07
 sigma counter=88 i=3 t=2.25e-04 per=1.23e+01 cost=6.99e+03 flops=3.11e+07
 sigma counter=88 i=4 t=2.23e-04 per=1.22e+01 cost=6.81e+03 flops=3.06e+07
 sigma counter=88 i=5 t=2.24e-04 per=1.23e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=88 i=6 t=2.43e-04 per=1.33e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=88 i=7 t=2.34e-04 per=1.28e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.65e-01 t_reduction=1.73e-02 tot=1.82e-01 ---
 sigma_tot counter=88 i=0 t=2.06e-02 per=1.25e+01 cost=4.49e+05 flops=2.18e+07
 sigma_tot counter=88 i=1 t=2.05e-02 per=1.24e+01 cost=4.61e+05 flops=2.25e+07
 sigma_tot counter=88 i=2 t=2.06e-02 per=1.25e+01 cost=4.57e+05 flops=2.22e+07
 sigma_tot counter=88 i=3 t=2.05e-02 per=1.24e+01 cost=4.64e+05 flops=2.27e+07
 sigma_tot counter=88 i=4 t=2.03e-02 per=1.23e+01 cost=6.75e+05 flops=3.33e+07
 sigma_tot counter=88 i=5 t=2.05e-02 per=1.24e+01 cost=6.73e+05 flops=3.27e+07
 sigma_tot counter=88 i=6 t=2.15e-02 per=1.30e+01 cost=9.49e+05 flops=4.42e+07
 sigma_tot counter=88 i=7 t=2.06e-02 per=1.25e+01 cost=9.40e+05 flops=4.56e+07
 total GEMM cost=5.07e+06 flops=3.07e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.81e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.36e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.82e-04 tot=1.99e-03 ---
 sigma counter=89 i=0 t=2.23e-04 per=1.23e+01 cost=6.81e+03 flops=3.06e+07
 sigma counter=89 i=1 t=2.23e-04 per=1.23e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=89 i=2 t=2.21e-04 per=1.22e+01 cost=7.01e+03 flops=3.17e+07
 sigma counter=89 i=3 t=2.23e-04 per=1.23e+01 cost=6.99e+03 flops=3.13e+07
 sigma counter=89 i=4 t=2.23e-04 per=1.23e+01 cost=6.81e+03 flops=3.06e+07
 sigma counter=89 i=5 t=2.22e-04 per=1.23e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=89 i=6 t=2.44e-04 per=1.35e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=89 i=7 t=2.31e-04 per=1.28e+01 cost=1.89e+04 flops=8.18e+07
 total GEMM cost=7.90e+04 flops=4.36e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.67e-01 t_reduction=1.74e-02 tot=1.84e-01 ---
 sigma_tot counter=89 i=0 t=2.08e-02 per=1.25e+01 cost=4.56e+05 flops=2.19e+07
 sigma_tot counter=89 i=1 t=2.07e-02 per=1.24e+01 cost=4.68e+05 flops=2.26e+07
 sigma_tot counter=89 i=2 t=2.08e-02 per=1.25e+01 cost=4.64e+05 flops=2.23e+07
 sigma_tot counter=89 i=3 t=2.07e-02 per=1.24e+01 cost=4.71e+05 flops=2.28e+07
 sigma_tot counter=89 i=4 t=2.05e-02 per=1.23e+01 cost=6.82e+05 flops=3.33e+07
 sigma_tot counter=89 i=5 t=2.08e-02 per=1.24e+01 cost=6.80e+05 flops=3.27e+07
 sigma_tot counter=89 i=6 t=2.17e-02 per=1.30e+01 cost=9.68e+05 flops=4.46e+07
 sigma_tot counter=89 i=7 t=2.09e-02 per=1.25e+01 cost=9.59e+05 flops=4.60e+07
 total GEMM cost=5.15e+06 flops=3.08e+07
    4   0 -      -2.654515664927  -6.77e-06   1.29e-03    6     8   1.71e-02  2.13e-03
    4   1 -      -2.436977078524  -1.80e-06   5.94e-04    6     8   1.71e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.34e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.77e-04 tot=2.00e-03 ---
 sigma counter=90 i=0 t=2.26e-04 per=1.24e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=90 i=1 t=2.25e-04 per=1.24e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=90 i=2 t=2.20e-04 per=1.21e+01 cost=7.01e+03 flops=3.18e+07
 sigma counter=90 i=3 t=2.28e-04 per=1.25e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=90 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=90 i=5 t=2.22e-04 per=1.22e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=90 i=6 t=2.42e-04 per=1.33e+01 cost=1.89e+04 flops=7.81e+07
 sigma counter=90 i=7 t=2.37e-04 per=1.30e+01 cost=1.89e+04 flops=7.97e+07
 total GEMM cost=7.90e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.69e-01 t_reduction=1.76e-02 tot=1.86e-01 ---
 sigma_tot counter=90 i=0 t=2.10e-02 per=1.25e+01 cost=4.62e+05 flops=2.20e+07
 sigma_tot counter=90 i=1 t=2.10e-02 per=1.24e+01 cost=4.75e+05 flops=2.27e+07
 sigma_tot counter=90 i=2 t=2.10e-02 per=1.25e+01 cost=4.71e+05 flops=2.24e+07
 sigma_tot counter=90 i=3 t=2.09e-02 per=1.24e+01 cost=4.78e+05 flops=2.29e+07
 sigma_tot counter=90 i=4 t=2.07e-02 per=1.23e+01 cost=6.89e+05 flops=3.33e+07
 sigma_tot counter=90 i=5 t=2.10e-02 per=1.24e+01 cost=6.86e+05 flops=3.27e+07
 sigma_tot counter=90 i=6 t=2.19e-02 per=1.30e+01 cost=9.87e+05 flops=4.49e+07
 sigma_tot counter=90 i=7 t=2.11e-02 per=1.25e+01 cost=9.78e+05 flops=4.63e+07
 total GEMM cost=5.23e+06 flops=3.10e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.50e-05,1.81e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.35e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.79e-04 tot=1.99e-03 ---
 sigma counter=91 i=0 t=2.26e-04 per=1.25e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=91 i=1 t=2.23e-04 per=1.23e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=91 i=2 t=2.20e-04 per=1.21e+01 cost=7.01e+03 flops=3.18e+07
 sigma counter=91 i=3 t=2.27e-04 per=1.25e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=91 i=4 t=2.17e-04 per=1.20e+01 cost=6.81e+03 flops=3.14e+07
 sigma counter=91 i=5 t=2.23e-04 per=1.23e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=91 i=6 t=2.43e-04 per=1.34e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=91 i=7 t=2.34e-04 per=1.29e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.36e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.70e-01 t_reduction=1.78e-02 tot=1.88e-01 ---
 sigma_tot counter=91 i=0 t=2.13e-02 per=1.25e+01 cost=4.69e+05 flops=2.21e+07
 sigma_tot counter=91 i=1 t=2.12e-02 per=1.24e+01 cost=4.82e+05 flops=2.27e+07
 sigma_tot counter=91 i=2 t=2.12e-02 per=1.25e+01 cost=4.78e+05 flops=2.25e+07
 sigma_tot counter=91 i=3 t=2.11e-02 per=1.24e+01 cost=4.85e+05 flops=2.29e+07
 sigma_tot counter=91 i=4 t=2.09e-02 per=1.23e+01 cost=6.95e+05 flops=3.33e+07
 sigma_tot counter=91 i=5 t=2.12e-02 per=1.24e+01 cost=6.93e+05 flops=3.27e+07
 sigma_tot counter=91 i=6 t=2.22e-02 per=1.30e+01 cost=1.01e+06 flops=4.53e+07
 sigma_tot counter=91 i=7 t=2.13e-02 per=1.25e+01 cost=9.97e+05 flops=4.67e+07
 total GEMM cost=5.30e+06 flops=3.11e+07
    5   0 -      -2.654516771391  -1.11e-06   5.13e-04    6    10   2.13e-02  2.13e-03
    5   1 -      -2.436977369938  -2.91e-07   2.87e-04    6    10   2.13e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.77e-04 tot=2.00e-03 ---
 sigma counter=92 i=0 t=2.26e-04 per=1.24e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=92 i=1 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=92 i=2 t=2.26e-04 per=1.24e+01 cost=7.01e+03 flops=3.10e+07
 sigma counter=92 i=3 t=2.35e-04 per=1.29e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=92 i=4 t=2.16e-04 per=1.18e+01 cost=6.81e+03 flops=3.15e+07
 sigma counter=92 i=5 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=92 i=6 t=2.43e-04 per=1.33e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=92 i=7 t=2.31e-04 per=1.27e+01 cost=1.89e+04 flops=8.18e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.72e-01 t_reduction=1.80e-02 tot=1.90e-01 ---
 sigma_tot counter=92 i=0 t=2.15e-02 per=1.25e+01 cost=4.76e+05 flops=2.22e+07
 sigma_tot counter=92 i=1 t=2.14e-02 per=1.24e+01 cost=4.89e+05 flops=2.28e+07
 sigma_tot counter=92 i=2 t=2.15e-02 per=1.25e+01 cost=4.85e+05 flops=2.26e+07
 sigma_tot counter=92 i=3 t=2.14e-02 per=1.24e+01 cost=4.92e+05 flops=2.30e+07
 sigma_tot counter=92 i=4 t=2.11e-02 per=1.23e+01 cost=7.02e+05 flops=3.32e+07
 sigma_tot counter=92 i=5 t=2.14e-02 per=1.24e+01 cost=7.00e+05 flops=3.26e+07
 sigma_tot counter=92 i=6 t=2.24e-02 per=1.30e+01 cost=1.02e+06 flops=4.57e+07
 sigma_tot counter=92 i=7 t=2.16e-02 per=1.25e+01 cost=1.02e+06 flops=4.71e+07
 total GEMM cost=5.38e+06 flops=3.12e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.50e-05,1.81e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.35e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.77e-04 tot=1.99e-03 ---
 sigma counter=93 i=0 t=2.22e-04 per=1.22e+01 cost=6.81e+03 flops=3.07e+07
 sigma counter=93 i=1 t=2.21e-04 per=1.22e+01 cost=6.78e+03 flops=3.07e+07
 sigma counter=93 i=2 t=2.25e-04 per=1.24e+01 cost=7.01e+03 flops=3.11e+07
 sigma counter=93 i=3 t=2.24e-04 per=1.23e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=93 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=93 i=5 t=2.22e-04 per=1.22e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=93 i=6 t=2.48e-04 per=1.37e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=93 i=7 t=2.34e-04 per=1.29e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.35e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.74e-01 t_reduction=1.81e-02 tot=1.92e-01 ---
 sigma_tot counter=93 i=0 t=2.17e-02 per=1.25e+01 cost=4.83e+05 flops=2.22e+07
 sigma_tot counter=93 i=1 t=2.16e-02 per=1.24e+01 cost=4.95e+05 flops=2.29e+07
 sigma_tot counter=93 i=2 t=2.17e-02 per=1.25e+01 cost=4.92e+05 flops=2.27e+07
 sigma_tot counter=93 i=3 t=2.16e-02 per=1.24e+01 cost=4.99e+05 flops=2.31e+07
 sigma_tot counter=93 i=4 t=2.13e-02 per=1.23e+01 cost=7.09e+05 flops=3.32e+07
 sigma_tot counter=93 i=5 t=2.17e-02 per=1.24e+01 cost=7.07e+05 flops=3.26e+07
 sigma_tot counter=93 i=6 t=2.27e-02 per=1.30e+01 cost=1.04e+06 flops=4.60e+07
 sigma_tot counter=93 i=7 t=2.18e-02 per=1.25e+01 cost=1.03e+06 flops=4.75e+07
 total GEMM cost=5.46e+06 flops=3.14e+07
    6   0 -      -2.654516945145  -1.74e-07   1.83e-04    6    12   2.55e-02  2.12e-03
    6   1 -      -2.436977443895  -7.40e-08   1.16e-04    6    12   2.55e-02  2.12e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.83e-03,1.76e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.76e-04 tot=2.00e-03 ---
 sigma counter=94 i=0 t=2.25e-04 per=1.23e+01 cost=6.81e+03 flops=3.03e+07
 sigma counter=94 i=1 t=2.24e-04 per=1.23e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=94 i=2 t=2.22e-04 per=1.22e+01 cost=7.01e+03 flops=3.16e+07
 sigma counter=94 i=3 t=2.33e-04 per=1.28e+01 cost=6.99e+03 flops=3.00e+07
 sigma counter=94 i=4 t=2.18e-04 per=1.19e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=94 i=5 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=94 i=6 t=2.46e-04 per=1.35e+01 cost=1.89e+04 flops=7.68e+07
 sigma counter=94 i=7 t=2.34e-04 per=1.28e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.76e-01 t_reduction=1.83e-02 tot=1.94e-01 ---
 sigma_tot counter=94 i=0 t=2.19e-02 per=1.25e+01 cost=4.90e+05 flops=2.23e+07
 sigma_tot counter=94 i=1 t=2.19e-02 per=1.24e+01 cost=5.02e+05 flops=2.30e+07
 sigma_tot counter=94 i=2 t=2.19e-02 per=1.25e+01 cost=4.99e+05 flops=2.28e+07
 sigma_tot counter=94 i=3 t=2.18e-02 per=1.24e+01 cost=5.06e+05 flops=2.32e+07
 sigma_tot counter=94 i=4 t=2.16e-02 per=1.23e+01 cost=7.16e+05 flops=3.32e+07
 sigma_tot counter=94 i=5 t=2.19e-02 per=1.24e+01 cost=7.13e+05 flops=3.26e+07
 sigma_tot counter=94 i=6 t=2.29e-02 per=1.30e+01 cost=1.06e+06 flops=4.63e+07
 sigma_tot counter=94 i=7 t=2.20e-02 per=1.25e+01 cost=1.05e+06 flops=4.78e+07
 total GEMM cost=5.54e+06 flops=3.15e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.35e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.77e-04 tot=1.99e-03 ---
 sigma counter=95 i=0 t=2.20e-04 per=1.21e+01 cost=6.81e+03 flops=3.10e+07
 sigma counter=95 i=1 t=2.31e-04 per=1.27e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=95 i=2 t=2.21e-04 per=1.22e+01 cost=7.01e+03 flops=3.17e+07
 sigma counter=95 i=3 t=2.23e-04 per=1.23e+01 cost=6.99e+03 flops=3.13e+07
 sigma counter=95 i=4 t=2.17e-04 per=1.19e+01 cost=6.81e+03 flops=3.14e+07
 sigma counter=95 i=5 t=2.27e-04 per=1.25e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=95 i=6 t=2.47e-04 per=1.36e+01 cost=1.89e+04 flops=7.65e+07
 sigma counter=95 i=7 t=2.31e-04 per=1.27e+01 cost=1.89e+04 flops=8.18e+07
 total GEMM cost=7.90e+04 flops=4.35e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.78e-01 t_reduction=1.85e-02 tot=1.96e-01 ---
 sigma_tot counter=95 i=0 t=2.22e-02 per=1.25e+01 cost=4.96e+05 flops=2.24e+07
 sigma_tot counter=95 i=1 t=2.21e-02 per=1.24e+01 cost=5.09e+05 flops=2.30e+07
 sigma_tot counter=95 i=2 t=2.21e-02 per=1.25e+01 cost=5.06e+05 flops=2.29e+07
 sigma_tot counter=95 i=3 t=2.21e-02 per=1.24e+01 cost=5.13e+05 flops=2.33e+07
 sigma_tot counter=95 i=4 t=2.18e-02 per=1.23e+01 cost=7.23e+05 flops=3.32e+07
 sigma_tot counter=95 i=5 t=2.21e-02 per=1.24e+01 cost=7.20e+05 flops=3.26e+07
 sigma_tot counter=95 i=6 t=2.32e-02 per=1.30e+01 cost=1.08e+06 flops=4.66e+07
 sigma_tot counter=95 i=7 t=2.23e-02 per=1.25e+01 cost=1.07e+06 flops=4.82e+07
 total GEMM cost=5.62e+06 flops=3.16e+07
    7   0 +      -2.654516966639  -2.15e-08   4.64e-05    6    14   2.97e-02  2.12e-03
    7   1 +      -2.436977450693  -6.80e-09   2.69e-05    6    14   2.97e-02  2.12e-03
TIMING for Davidson : 2.97e-02  T(cal/comm/rest)=2.94e-02,5.17e-07,3.02e-04
optimized energies: isweep=1 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.6e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.994e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000548 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.42e-05,0.000241,0.000253 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.000998,0.000173 cost=2.78e+04 flops[gemm]=2.78e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.000997 t_reduction=0.000173 tot=0.00117 ---
 renorm counter=7 i=0 t=0.000197 per=19.8 cost=1.82e+03 flops=9.25e+06
 renorm counter=7 i=1 t=0.000197 per=19.8 cost=3.23e+03 flops=1.64e+07
 renorm counter=7 i=2 t=0.000188 per=18.9 cost=1.91e+03 flops=1.01e+07
 renorm counter=7 i=3 t=0.000198 per=19.9 cost=3.14e+03 flops=1.59e+07
 renorm counter=7 i=4 t=1e-06 per=0.1 cost=0 flops=0
 renorm counter=7 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=7 i=6 t=0.000216 per=21.7 cost=1.77e+04 flops=8.19e+07
 total GEMM cost=2.78e+04 flops=2.79e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00742 t_reduction=0.0013 tot=0.00872 ---
 renorm_tot counter=7 i=0 t=0.0015 per=20.1 cost=1.89e+04 flops=1.26e+07
 renorm_tot counter=7 i=1 t=0.00145 per=19.5 cost=2.5e+04 flops=1.73e+07
 renorm_tot counter=7 i=2 t=0.000594 per=8 cost=7.9e+03 flops=1.33e+07
 renorm_tot counter=7 i=3 t=0.000618 per=8.32 cost=1.4e+04 flops=2.27e+07
 renorm_tot counter=7 i=4 t=0.000832 per=11.2 cost=2.43e+04 flops=2.92e+07
 renorm_tot counter=7 i=5 t=0.000845 per=11.4 cost=4.24e+04 flops=5.02e+07
 renorm_tot counter=7 i=6 t=0.00159 per=21.4 cost=1.96e+05 flops=1.23e+08
 total GEMM cost=3.28e+05 flops=4.42e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0025 S T(init/kernel/comm)=9.2e-05,0.0024,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.6e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=5.31e-05,3.14e-05,8.45e-05 speed=0.122GB/s disk[used]=8.68e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 3.77e-02 S #####
 T(fetch) = 8.14e-05 S  per = 0.22  per(accum) = 0.22
 T(hdiag) = 8.70e-05 S  per = 0.23  per(accum) = 0.45
 T(dvdsn) = 3.43e-02 S  per =   91  per(accum) = 91
 T(decim) = 8.40e-05 S  per = 0.22  per(accum) = 92
 T(guess) = 9.21e-05 S  per = 0.24  per(accum) = 92
 T(renrm) = 2.56e-03 S  per =  6.8  per(accum) = 99
 T(save ) = 5.28e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.41e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.91e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.49e-04 S  per = 0.73  per(accum) = 0.84
 T(hintermediate init           ) = 2.05e-04 S  per =  0.6  per(accum) = 1.4
 T(hintermediates memcpy cpu2gpu) = 3.83e-06 S  per = 0.011  per(accum) = 1.5
 T(preprocess_hformulae_Hxlist2 ) = 2.48e-03 S  per =  7.3  per(accum) = 8.7
 T(hmmtasks init                ) = 1.42e-03 S  per =  4.2  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 2.94e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 5.17e-07 S  per = 0.0015  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.02e-04 S  per = 0.89  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.52e-03 S
 T(qops init                    ) = 9.18e-05 S  per =  3.6  per(accum) = 3.6
 T(qops_dict memcpy cpu2gpu     ) = 2.79e-05 S  per =  1.1  per(accum) = 4.7
 T(symbolic_formulae_renorm     ) = 2.04e-04 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.16e-05 S  per = 0.46  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.72e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.57e-04 S  per =   22  per(accum) = 36
 T(rmmtasks init                ) = 3.42e-04 S  per =   14  per(accum) = 49
 T(qops memset                  ) = 8.71e-06 S  per = 0.34  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.24e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.77e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.63e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 1.17e-01 S #####
 T(fetch) = 5.60e-04 S  per = 0.48  per(accum) = 0.48
 T(hdiag) = 2.51e-04 S  per = 0.21  per(accum) = 0.69
 T(dvdsn) = 1.05e-01 S  per =   90  per(accum) = 91
 T(decim) = 4.93e-04 S  per = 0.42  per(accum) = 91
 T(guess) = 2.42e-04 S  per = 0.21  per(accum) = 91
 T(renrm) = 8.38e-03 S  per =  7.2  per(accum) = 99
 T(save ) = 1.71e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.05e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.20e-04 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 8.48e-04 S  per = 0.81  per(accum) = 0.92
 T(hintermediate init           ) = 6.43e-04 S  per = 0.61  per(accum) = 1.5
 T(hintermediates memcpy cpu2gpu) = 1.33e-05 S  per = 0.013  per(accum) = 1.5
 T(preprocess_hformulae_Hxlist2 ) = 6.79e-03 S  per =  6.5  per(accum) = 8
 T(hmmtasks init                ) = 3.94e-03 S  per =  3.8  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 9.15e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 1.98e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.01e-03 S  per = 0.96  per(accum) = 1e+02
Detailed decomposition of T(renrm): 8.24e-03 S
 T(qops init                    ) = 2.79e-04 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 9.32e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 6.27e-04 S  per =  7.6  per(accum) = 12
 T(rintermediate init           ) = 2.30e-04 S  per =  2.8  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.50e-05 S  per = 0.18  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 1.82e-03 S  per =   22  per(accum) = 37
 T(rmmtasks init                ) = 1.15e-03 S  per =   14  per(accum) = 51
 T(qops memset                  ) = 2.65e-05 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 3.88e-03 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.74e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.29e-05 S  per =  0.4  per(accum) = 1e+02
##### time_global: 2.79e-01 S #####
 T(fetch) = 2.42e-03 S  per = 0.87  per(accum) = 0.87
 T(hdiag) = 7.60e-04 S  per = 0.27  per(accum) = 1.1
 T(dvdsn) = 2.48e-01 S  per =   89  per(accum) = 90
 T(decim) = 2.01e-03 S  per = 0.72  per(accum) = 91
 T(guess) = 6.56e-04 S  per = 0.23  per(accum) = 91
 T(renrm) = 2.04e-02 S  per =  7.3  per(accum) = 98
 T(save ) = 4.51e-03 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.46e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 3.07e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.46e-03 S  per =    1  per(accum) = 1.1
 T(hintermediate init           ) = 1.66e-03 S  per = 0.67  per(accum) = 1.8
 T(hintermediates memcpy cpu2gpu) = 3.90e-05 S  per = 0.016  per(accum) = 1.8
 T(preprocess_hformulae_Hxlist2 ) = 1.94e-02 S  per =  7.9  per(accum) = 9.7
 T(hmmtasks init                ) = 1.13e-02 S  per =  4.6  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 2.08e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 5.02e-06 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.93e-03 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.00e-02 S
 T(qops init                    ) = 9.86e-04 S  per =  4.9  per(accum) = 4.9
 T(qops_dict memcpy cpu2gpu     ) = 2.78e-04 S  per =  1.4  per(accum) = 6.3
 T(symbolic_formulae_renorm     ) = 1.86e-03 S  per =  9.3  per(accum) = 16
 T(rintermediate init           ) = 7.23e-04 S  per =  3.6  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 4.36e-05 S  per = 0.22  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 3.89e-03 S  per =   19  per(accum) = 39
 T(rmmtasks init                ) = 2.50e-03 S  per =   12  per(accum) = 51
 T(qops memset                  ) = 6.82e-05 S  per = 0.34  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 9.39e-03 S  per =   47  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 2.28e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.03e-05 S  per =  0.4  per(accum) = 1e+02

isweep=1 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.335e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47a56b50
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.246e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000154 flops=2.87e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.886e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.37e-05,0.000954,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.7e-05,0.00184,0.000185 cost=7.9e+04 flops[gemm]=4.29e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00184 t_reduction=0.000185 tot=0.00203 ---
 sigma counter=96 i=0 t=0.000232 per=12.6 cost=7.01e+03 flops=3.02e+07
 sigma counter=96 i=1 t=0.000227 per=12.3 cost=6.99e+03 flops=3.08e+07
 sigma counter=96 i=2 t=0.000218 per=11.8 cost=6.81e+03 flops=3.13e+07
 sigma counter=96 i=3 t=0.000225 per=12.2 cost=6.78e+03 flops=3.02e+07
 sigma counter=96 i=4 t=0.000236 per=12.8 cost=1.89e+04 flops=8.01e+07
 sigma counter=96 i=5 t=0.000242 per=13.2 cost=1.89e+04 flops=7.81e+07
 sigma counter=96 i=6 t=0.000236 per=12.8 cost=6.78e+03 flops=2.87e+07
 sigma counter=96 i=7 t=0.000224 per=12.2 cost=6.81e+03 flops=3.04e+07
 total GEMM cost=7.9e+04 flops=4.29e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.18 t_reduction=0.0187 tot=0.198 ---
 sigma_tot counter=96 i=0 t=0.0224 per=12.5 cost=5.03e+05 flops=2.25e+07
 sigma_tot counter=96 i=1 t=0.0223 per=12.4 cost=5.16e+05 flops=2.31e+07
 sigma_tot counter=96 i=2 t=0.0224 per=12.4 cost=5.13e+05 flops=2.29e+07
 sigma_tot counter=96 i=3 t=0.0223 per=12.4 cost=5.2e+05 flops=2.33e+07
 sigma_tot counter=96 i=4 t=0.022 per=12.3 cost=7.41e+05 flops=3.37e+07
 sigma_tot counter=96 i=5 t=0.0224 per=12.4 cost=7.39e+05 flops=3.31e+07
 sigma_tot counter=96 i=6 t=0.0234 per=13 cost=1.09e+06 flops=4.65e+07
 sigma_tot counter=96 i=7 t=0.0225 per=12.5 cost=1.08e+06 flops=4.8e+07
 total GEMM cost=5.7e+06 flops=3.17e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.6e-05,0.00182,0.000178 cost=7.9e+04 flops[gemm]=4.35e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00182 t_reduction=0.000178 tot=0.00199 ---
 sigma counter=97 i=0 t=0.000225 per=12.4 cost=7.01e+03 flops=3.11e+07
 sigma counter=97 i=1 t=0.000225 per=12.4 cost=6.99e+03 flops=3.11e+07
 sigma counter=97 i=2 t=0.000224 per=12.3 cost=6.81e+03 flops=3.04e+07
 sigma counter=97 i=3 t=0.000226 per=12.4 cost=6.78e+03 flops=3e+07
 sigma counter=97 i=4 t=0.000231 per=12.7 cost=1.89e+04 flops=8.18e+07
 sigma counter=97 i=5 t=0.000235 per=12.9 cost=1.89e+04 flops=8.04e+07
 sigma counter=97 i=6 t=0.00023 per=12.7 cost=6.78e+03 flops=2.95e+07
 sigma counter=97 i=7 t=0.00022 per=12.1 cost=6.81e+03 flops=3.1e+07
 total GEMM cost=7.9e+04 flops=4.35e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.181 t_reduction=0.0189 tot=0.2 ---
 sigma_tot counter=97 i=0 t=0.0226 per=12.5 cost=5.1e+05 flops=2.26e+07
 sigma_tot counter=97 i=1 t=0.0225 per=12.4 cost=5.23e+05 flops=2.32e+07
 sigma_tot counter=97 i=2 t=0.0226 per=12.4 cost=5.2e+05 flops=2.3e+07
 sigma_tot counter=97 i=3 t=0.0225 per=12.4 cost=5.27e+05 flops=2.34e+07
 sigma_tot counter=97 i=4 t=0.0222 per=12.3 cost=7.6e+05 flops=3.42e+07
 sigma_tot counter=97 i=5 t=0.0226 per=12.4 cost=7.58e+05 flops=3.36e+07
 sigma_tot counter=97 i=6 t=0.0236 per=13 cost=1.09e+06 flops=4.63e+07
 sigma_tot counter=97 i=7 t=0.0227 per=12.5 cost=1.09e+06 flops=4.78e+07
 total GEMM cost=5.78e+06 flops=3.19e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966639  -1.00e+03   4.64e-05    2     2   4.26e-03  2.13e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.26e-03  2.13e-03
TIMING for Davidson : 4.28e-03  T(cal/comm/rest)=4.24e-03,8.30e-08,4.27e-05
optimized energies: isweep=1 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.646e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.00015 flops=2.94e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 1.922e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.00055 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.72e-05,0.000253,0.00025 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00101,0.00017 cost=1.55e+05 flops[gemm]=1.54e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.001 t_reduction=0.00017 tot=0.00117 ---
 renorm counter=8 i=0 t=0.000201 per=20 cost=5.64e+03 flops=2.81e+07
 renorm counter=8 i=1 t=0.000196 per=19.5 cost=1.13e+04 flops=5.75e+07
 renorm counter=8 i=2 t=0.000186 per=18.5 cost=1.66e+04 flops=8.9e+07
 renorm counter=8 i=3 t=0.000199 per=19.8 cost=2.89e+04 flops=1.45e+08
 renorm counter=8 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=8 i=5 t=1e-06 per=0.0996 cost=0 flops=0
 renorm counter=8 i=6 t=0.000221 per=22 cost=9.22e+04 flops=4.17e+08
 total GEMM cost=1.55e+05 flops=1.54e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00843 t_reduction=0.00147 tot=0.00989 ---
 renorm_tot counter=8 i=0 t=0.0017 per=20.1 cost=2.46e+04 flops=1.45e+07
 renorm_tot counter=8 i=1 t=0.00164 per=19.5 cost=3.63e+04 flops=2.21e+07
 renorm_tot counter=8 i=2 t=0.00078 per=9.25 cost=2.45e+04 flops=3.14e+07
 renorm_tot counter=8 i=3 t=0.000817 per=9.69 cost=4.29e+04 flops=5.26e+07
 renorm_tot counter=8 i=4 t=0.000832 per=9.87 cost=2.43e+04 flops=2.92e+07
 renorm_tot counter=8 i=5 t=0.000846 per=10 cost=4.24e+04 flops=5.02e+07
 renorm_tot counter=8 i=6 t=0.00181 per=21.5 cost=2.88e+05 flops=1.59e+08
 total GEMM cost=4.83e+05 flops=5.73e+07
check ||H-H.dagger||=8.59e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=7.5e-05,0.0026,8.5e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=5.04e-05,4.07e-05,9.1e-05 speed=0.213GB/s disk[used]=8.93e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.25e-02 S #####
 T(fetch) = 3.08e-04 S  per =  2.5  per(accum) = 2.5
 T(hdiag) = 7.11e-05 S  per = 0.57  per(accum) = 3
 T(dvdsn) = 8.46e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.24e-04 S  per =  2.6  per(accum) = 73
 T(guess) = 7.84e-05 S  per = 0.63  per(accum) = 74
 T(renrm) = 2.73e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.28e-04 S  per =  4.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.28e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.83e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.30e-04 S  per =  2.8  per(accum) = 3.2
 T(hintermediate init           ) = 1.92e-04 S  per =  2.3  per(accum) = 5.6
 T(hintermediates memcpy cpu2gpu) = 3.47e-06 S  per = 0.042  per(accum) = 5.6
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =   27  per(accum) = 33
 T(hmmtasks init                ) = 1.29e-03 S  per =   16  per(accum) = 48
 T(dvdson solver [Hx_batchGPU]  ) = 4.24e-03 S  per =   51  per(accum) = 99
 T(dvdson solver [communication]) = 8.30e-08 S  per = 0.001  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.27e-05 S  per = 0.52  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.67e-03 S
 T(qops init                    ) = 7.48e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.50e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.69e-04 S  per =  6.3  per(accum) = 10
 T(rintermediate init           ) = 1.96e-04 S  per =  7.3  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.64e-06 S  per = 0.17  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.58e-04 S  per =   21  per(accum) = 39
 T(rmmtasks init                ) = 3.47e-04 S  per =   13  per(accum) = 52
 T(qops memset                  ) = 7.68e-06 S  per = 0.29  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.25e-03 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.65e-05 S  per = 0.99  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.46e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 1.29e-01 S #####
 T(fetch) = 8.68e-04 S  per = 0.67  per(accum) = 0.67
 T(hdiag) = 3.22e-04 S  per = 0.25  per(accum) = 0.92
 T(dvdsn) = 1.14e-01 S  per =   88  per(accum) = 89
 T(decim) = 8.17e-04 S  per = 0.63  per(accum) = 89
 T(guess) = 3.20e-04 S  per = 0.25  per(accum) = 90
 T(renrm) = 1.11e-02 S  per =  8.6  per(accum) = 98
 T(save ) = 2.23e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.13e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.58e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 1.08e-03 S  per = 0.95  per(accum) = 1.1
 T(hintermediate init           ) = 8.35e-04 S  per = 0.74  per(accum) = 1.8
 T(hintermediates memcpy cpu2gpu) = 1.68e-05 S  per = 0.015  per(accum) = 1.8
 T(preprocess_hformulae_Hxlist2 ) = 9.04e-03 S  per =    8  per(accum) = 9.8
 T(hmmtasks init                ) = 5.23e-03 S  per =  4.6  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 9.57e-02 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 2.06e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.05e-03 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.09e-02 S
 T(qops init                    ) = 3.53e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 1.28e-04 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 7.96e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 4.26e-04 S  per =  3.9  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 1.97e-05 S  per = 0.18  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 2.38e-03 S  per =   22  per(accum) = 38
 T(rmmtasks init                ) = 1.50e-03 S  per =   14  per(accum) = 51
 T(qops memset                  ) = 3.42e-05 S  per = 0.31  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 5.12e-03 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.14e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 4.13e-05 S  per = 0.38  per(accum) = 1e+02
##### time_global: 2.92e-01 S #####
 T(fetch) = 2.72e-03 S  per = 0.93  per(accum) = 0.93
 T(hdiag) = 8.31e-04 S  per = 0.29  per(accum) = 1.2
 T(dvdsn) = 2.57e-01 S  per =   88  per(accum) = 89
 T(decim) = 2.33e-03 S  per =  0.8  per(accum) = 90
 T(guess) = 7.34e-04 S  per = 0.25  per(accum) = 90
 T(renrm) = 2.31e-02 S  per =  7.9  per(accum) = 98
 T(save ) = 5.04e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.55e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 3.45e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 2.69e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 1.85e-03 S  per = 0.73  per(accum) = 1.9
 T(hintermediates memcpy cpu2gpu) = 4.25e-05 S  per = 0.017  per(accum) = 1.9
 T(preprocess_hformulae_Hxlist2 ) = 2.16e-02 S  per =  8.5  per(accum) = 10
 T(hmmtasks init                ) = 1.26e-02 S  per =    5  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 2.13e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 5.11e-06 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.97e-03 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.27e-02 S
 T(qops init                    ) = 1.06e-03 S  per =  4.7  per(accum) = 4.7
 T(qops_dict memcpy cpu2gpu     ) = 3.13e-04 S  per =  1.4  per(accum) = 6
 T(symbolic_formulae_renorm     ) = 2.03e-03 S  per =  8.9  per(accum) = 15
 T(rintermediate init           ) = 9.19e-04 S  per =    4  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 4.83e-05 S  per = 0.21  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 4.44e-03 S  per =   20  per(accum) = 39
 T(rmmtasks init                ) = 2.85e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 7.58e-05 S  per = 0.33  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.06e-02 S  per =   47  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 2.54e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.88e-05 S  per = 0.39  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=1
----------------------------------------------------------------------
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=15 e[0]=-2.65208108725 e[1]=-2.43068987639 t=0.039
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=14 e[0]=-2.65451696721 e[1]=-2.43697744778 t=0.04
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.038
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.012
 eav_max=-2.54138548182 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=0.00436172684617
 sweep energies: isweep=1 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=1 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=1
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.64e-01 | 1.64e-01 | 0.00e+00 1.04e-01 1.06e-02 1.15e-01 69.9
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.31e-01 | 2.95e-01 | 0.00e+00 1.90e-01 2.03e-02 2.10e-01 71.3
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep1.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep1.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=3.27e-15
 idx=3 node=(1,0) Drow=8 maxdiff=8.01e-16
 idx=4 node=(0,0) Drow=2 maxdiff=1.58e-16
stensor2: wf2 own=1 _data=0x48140e90
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x48140e90
     -1.0000e+00       4.5134e-19 
      1.1299e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=7.0233e-16
----- TIMING FOR ctns::rcanon_check : 8.178e-05 S -----
..... end of isweep = 1 .....

======================================================================
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=2 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.088e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x479b83b0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.282e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000158 flops=2.79e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.932e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00222 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.61e-05,0.000948,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.5e-05,0.00181,0.000178 cost=7.9e+04 flops[gemm]=4.36e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00181 t_reduction=0.000178 tot=0.00199 ---
 sigma counter=98 i=0 t=0.000229 per=12.6 cost=7.01e+03 flops=3.06e+07
 sigma counter=98 i=1 t=0.000225 per=12.4 cost=6.99e+03 flops=3.11e+07
 sigma counter=98 i=2 t=0.000224 per=12.4 cost=6.81e+03 flops=3.04e+07
 sigma counter=98 i=3 t=0.000221 per=12.2 cost=6.78e+03 flops=3.07e+07
 sigma counter=98 i=4 t=0.00023 per=12.7 cost=1.89e+04 flops=8.22e+07
 sigma counter=98 i=5 t=0.000235 per=13 cost=1.89e+04 flops=8.04e+07
 sigma counter=98 i=6 t=0.00023 per=12.7 cost=6.78e+03 flops=2.95e+07
 sigma counter=98 i=7 t=0.000219 per=12.1 cost=6.81e+03 flops=3.11e+07
 total GEMM cost=7.9e+04 flops=4.36e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.183 t_reduction=0.019 tot=0.202 ---
 sigma_tot counter=98 i=0 t=0.0228 per=12.5 cost=5.17e+05 flops=2.27e+07
 sigma_tot counter=98 i=1 t=0.0228 per=12.4 cost=5.3e+05 flops=2.33e+07
 sigma_tot counter=98 i=2 t=0.0228 per=12.4 cost=5.26e+05 flops=2.31e+07
 sigma_tot counter=98 i=3 t=0.0227 per=12.4 cost=5.33e+05 flops=2.35e+07
 sigma_tot counter=98 i=4 t=0.0225 per=12.3 cost=7.79e+05 flops=3.47e+07
 sigma_tot counter=98 i=5 t=0.0228 per=12.5 cost=7.77e+05 flops=3.4e+07
 sigma_tot counter=98 i=6 t=0.0239 per=13 cost=1.1e+06 flops=4.61e+07
 sigma_tot counter=98 i=7 t=0.0229 per=12.5 cost=1.09e+06 flops=4.77e+07
 total GEMM cost=5.86e+06 flops=3.2e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.8e-05,0.00184,0.00018 cost=7.9e+04 flops[gemm]=4.3e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00183 t_reduction=0.00018 tot=0.00201 ---
 sigma counter=99 i=0 t=0.000225 per=12.3 cost=7.01e+03 flops=3.11e+07
 sigma counter=99 i=1 t=0.000223 per=12.2 cost=6.99e+03 flops=3.13e+07
 sigma counter=99 i=2 t=0.000225 per=12.3 cost=6.81e+03 flops=3.03e+07
 sigma counter=99 i=3 t=0.000228 per=12.4 cost=6.78e+03 flops=2.98e+07
 sigma counter=99 i=4 t=0.000236 per=12.9 cost=1.89e+04 flops=8.01e+07
 sigma counter=99 i=5 t=0.000241 per=13.1 cost=1.89e+04 flops=7.84e+07
 sigma counter=99 i=6 t=0.000234 per=12.8 cost=6.78e+03 flops=2.9e+07
 sigma counter=99 i=7 t=0.000222 per=12.1 cost=6.81e+03 flops=3.07e+07
 total GEMM cost=7.9e+04 flops=4.31e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.185 t_reduction=0.0192 tot=0.204 ---
 sigma_tot counter=99 i=0 t=0.0231 per=12.5 cost=5.24e+05 flops=2.27e+07
 sigma_tot counter=99 i=1 t=0.023 per=12.4 cost=5.37e+05 flops=2.34e+07
 sigma_tot counter=99 i=2 t=0.023 per=12.4 cost=5.33e+05 flops=2.32e+07
 sigma_tot counter=99 i=3 t=0.023 per=12.4 cost=5.4e+05 flops=2.35e+07
 sigma_tot counter=99 i=4 t=0.0227 per=12.3 cost=7.98e+05 flops=3.51e+07
 sigma_tot counter=99 i=5 t=0.0231 per=12.5 cost=7.96e+05 flops=3.45e+07
 sigma_tot counter=99 i=6 t=0.0241 per=13 cost=1.11e+06 flops=4.6e+07
 sigma_tot counter=99 i=7 t=0.0232 per=12.5 cost=1.1e+06 flops=4.75e+07
 total GEMM cost=5.94e+06 flops=3.21e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701465761  -1.00e+03   6.88e-02    2     2   4.25e-03  2.13e-03
    1   1 -      -2.436233901586  -1.00e+03   4.38e-02    2     2   4.25e-03  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.70e-05,1.81e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.36e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.77e-04 tot=1.99e-03 ---
 sigma counter=100 i=0 t=2.27e-04 per=1.25e+01 cost=7.01e+03 flops=3.09e+07
 sigma counter=100 i=1 t=2.24e-04 per=1.24e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=100 i=2 t=2.26e-04 per=1.25e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=100 i=3 t=2.22e-04 per=1.23e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=100 i=4 t=2.29e-04 per=1.27e+01 cost=1.89e+04 flops=8.25e+07
 sigma counter=100 i=5 t=2.34e-04 per=1.29e+01 cost=1.89e+04 flops=8.08e+07
 sigma counter=100 i=6 t=2.27e-04 per=1.25e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=100 i=7 t=2.20e-04 per=1.22e+01 cost=6.81e+03 flops=3.10e+07
 total GEMM cost=7.90e+04 flops=4.37e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.87e-01 t_reduction=1.94e-02 tot=2.06e-01 ---
 sigma_tot counter=100 i=0 t=2.33e-02 per=1.25e+01 cost=5.31e+05 flops=2.28e+07
 sigma_tot counter=100 i=1 t=2.32e-02 per=1.24e+01 cost=5.44e+05 flops=2.34e+07
 sigma_tot counter=100 i=2 t=2.33e-02 per=1.24e+01 cost=5.40e+05 flops=2.32e+07
 sigma_tot counter=100 i=3 t=2.32e-02 per=1.24e+01 cost=5.47e+05 flops=2.36e+07
 sigma_tot counter=100 i=4 t=2.29e-02 per=1.23e+01 cost=8.17e+05 flops=3.56e+07
 sigma_tot counter=100 i=5 t=2.33e-02 per=1.25e+01 cost=8.15e+05 flops=3.50e+07
 sigma_tot counter=100 i=6 t=2.43e-02 per=1.30e+01 cost=1.11e+06 flops=4.58e+07
 sigma_tot counter=100 i=7 t=2.34e-02 per=1.25e+01 cost=1.11e+06 flops=4.73e+07
 total GEMM cost=6.02e+06 flops=3.22e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.81e-03,1.81e-04 cost=7.90e+04 flops[gemm]=4.36e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.81e-04 tot=1.99e-03 ---
 sigma counter=101 i=0 t=2.23e-04 per=1.23e+01 cost=7.01e+03 flops=3.14e+07
 sigma counter=101 i=1 t=2.24e-04 per=1.24e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=101 i=2 t=2.23e-04 per=1.23e+01 cost=6.81e+03 flops=3.06e+07
 sigma counter=101 i=3 t=2.21e-04 per=1.22e+01 cost=6.78e+03 flops=3.07e+07
 sigma counter=101 i=4 t=2.31e-04 per=1.28e+01 cost=1.89e+04 flops=8.18e+07
 sigma counter=101 i=5 t=2.35e-04 per=1.30e+01 cost=1.89e+04 flops=8.04e+07
 sigma counter=101 i=6 t=2.32e-04 per=1.28e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=101 i=7 t=2.21e-04 per=1.22e+01 cost=6.81e+03 flops=3.08e+07
 total GEMM cost=7.90e+04 flops=4.36e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.89e-01 t_reduction=1.96e-02 tot=2.08e-01 ---
 sigma_tot counter=101 i=0 t=2.35e-02 per=1.25e+01 cost=5.38e+05 flops=2.29e+07
 sigma_tot counter=101 i=1 t=2.34e-02 per=1.24e+01 cost=5.51e+05 flops=2.35e+07
 sigma_tot counter=101 i=2 t=2.35e-02 per=1.24e+01 cost=5.47e+05 flops=2.33e+07
 sigma_tot counter=101 i=3 t=2.34e-02 per=1.24e+01 cost=5.54e+05 flops=2.37e+07
 sigma_tot counter=101 i=4 t=2.32e-02 per=1.23e+01 cost=8.36e+05 flops=3.61e+07
 sigma_tot counter=101 i=5 t=2.35e-02 per=1.25e+01 cost=8.34e+05 flops=3.54e+07
 sigma_tot counter=101 i=6 t=2.46e-02 per=1.30e+01 cost=1.12e+06 flops=4.57e+07
 sigma_tot counter=101 i=7 t=2.36e-02 per=1.25e+01 cost=1.11e+06 flops=4.72e+07
 total GEMM cost=6.09e+06 flops=3.23e+07
    2   0 -      -2.654428675224  -1.73e-03   1.26e-02    4     4   8.49e-03  2.12e-03
    2   1 -      -2.436964455562  -7.31e-04   4.22e-03    4     4   8.49e-03  2.12e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.78e-04 tot=2.00e-03 ---
 sigma counter=102 i=0 t=2.26e-04 per=1.24e+01 cost=7.01e+03 flops=3.10e+07
 sigma counter=102 i=1 t=2.27e-04 per=1.24e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=102 i=2 t=2.19e-04 per=1.20e+01 cost=6.81e+03 flops=3.11e+07
 sigma counter=102 i=3 t=2.33e-04 per=1.28e+01 cost=6.78e+03 flops=2.91e+07
 sigma counter=102 i=4 t=2.32e-04 per=1.27e+01 cost=1.89e+04 flops=8.14e+07
 sigma counter=102 i=5 t=2.38e-04 per=1.30e+01 cost=1.89e+04 flops=7.94e+07
 sigma counter=102 i=6 t=2.30e-04 per=1.26e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=102 i=7 t=2.19e-04 per=1.20e+01 cost=6.81e+03 flops=3.11e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.91e-01 t_reduction=1.98e-02 tot=2.10e-01 ---
 sigma_tot counter=102 i=0 t=2.37e-02 per=1.25e+01 cost=5.45e+05 flops=2.30e+07
 sigma_tot counter=102 i=1 t=2.37e-02 per=1.24e+01 cost=5.58e+05 flops=2.36e+07
 sigma_tot counter=102 i=2 t=2.37e-02 per=1.24e+01 cost=5.54e+05 flops=2.34e+07
 sigma_tot counter=102 i=3 t=2.36e-02 per=1.24e+01 cost=5.61e+05 flops=2.37e+07
 sigma_tot counter=102 i=4 t=2.34e-02 per=1.23e+01 cost=8.55e+05 flops=3.65e+07
 sigma_tot counter=102 i=5 t=2.38e-02 per=1.25e+01 cost=8.52e+05 flops=3.59e+07
 sigma_tot counter=102 i=6 t=2.48e-02 per=1.30e+01 cost=1.13e+06 flops=4.55e+07
 sigma_tot counter=102 i=7 t=2.38e-02 per=1.25e+01 cost=1.12e+06 flops=4.70e+07
 total GEMM cost=6.17e+06 flops=3.24e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.83e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.78e-04 tot=2.00e-03 ---
 sigma counter=103 i=0 t=2.24e-04 per=1.23e+01 cost=7.01e+03 flops=3.13e+07
 sigma counter=103 i=1 t=2.30e-04 per=1.26e+01 cost=6.99e+03 flops=3.04e+07
 sigma counter=103 i=2 t=2.27e-04 per=1.24e+01 cost=6.81e+03 flops=3.00e+07
 sigma counter=103 i=3 t=2.22e-04 per=1.22e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=103 i=4 t=2.32e-04 per=1.27e+01 cost=1.89e+04 flops=8.14e+07
 sigma counter=103 i=5 t=2.40e-04 per=1.32e+01 cost=1.89e+04 flops=7.87e+07
 sigma counter=103 i=6 t=2.29e-04 per=1.25e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=103 i=7 t=2.21e-04 per=1.21e+01 cost=6.81e+03 flops=3.08e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.92e-01 t_reduction=1.99e-02 tot=2.12e-01 ---
 sigma_tot counter=103 i=0 t=2.40e-02 per=1.25e+01 cost=5.52e+05 flops=2.31e+07
 sigma_tot counter=103 i=1 t=2.39e-02 per=1.24e+01 cost=5.65e+05 flops=2.36e+07
 sigma_tot counter=103 i=2 t=2.39e-02 per=1.24e+01 cost=5.60e+05 flops=2.34e+07
 sigma_tot counter=103 i=3 t=2.39e-02 per=1.24e+01 cost=5.67e+05 flops=2.38e+07
 sigma_tot counter=103 i=4 t=2.36e-02 per=1.23e+01 cost=8.74e+05 flops=3.70e+07
 sigma_tot counter=103 i=5 t=2.40e-02 per=1.25e+01 cost=8.71e+05 flops=3.63e+07
 sigma_tot counter=103 i=6 t=2.50e-02 per=1.30e+01 cost=1.14e+06 flops=4.54e+07
 sigma_tot counter=103 i=7 t=2.40e-02 per=1.25e+01 cost=1.13e+06 flops=4.69e+07
 total GEMM cost=6.25e+06 flops=3.25e+07
    3   0 -      -2.654509664616  -8.10e-05   3.66e-03    6     6   1.27e-02  2.12e-03
    3   1 -      -2.436976459235  -1.20e-05   1.11e-03    6     6   1.27e-02  2.12e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.83e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.31e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.79e-04 tot=2.01e-03 ---
 sigma counter=104 i=0 t=2.33e-04 per=1.27e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=104 i=1 t=2.25e-04 per=1.23e+01 cost=6.99e+03 flops=3.11e+07
 sigma counter=104 i=2 t=2.25e-04 per=1.23e+01 cost=6.81e+03 flops=3.03e+07
 sigma counter=104 i=3 t=2.24e-04 per=1.22e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=104 i=4 t=2.36e-04 per=1.29e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=104 i=5 t=2.36e-04 per=1.29e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=104 i=6 t=2.31e-04 per=1.26e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=104 i=7 t=2.20e-04 per=1.20e+01 cost=6.81e+03 flops=3.10e+07
 total GEMM cost=7.90e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.94e-01 t_reduction=2.01e-02 tot=2.14e-01 ---
 sigma_tot counter=104 i=0 t=2.42e-02 per=1.25e+01 cost=5.59e+05 flops=2.31e+07
 sigma_tot counter=104 i=1 t=2.41e-02 per=1.24e+01 cost=5.72e+05 flops=2.37e+07
 sigma_tot counter=104 i=2 t=2.42e-02 per=1.24e+01 cost=5.67e+05 flops=2.35e+07
 sigma_tot counter=104 i=3 t=2.41e-02 per=1.24e+01 cost=5.74e+05 flops=2.38e+07
 sigma_tot counter=104 i=4 t=2.39e-02 per=1.23e+01 cost=8.93e+05 flops=3.74e+07
 sigma_tot counter=104 i=5 t=2.42e-02 per=1.25e+01 cost=8.90e+05 flops=3.67e+07
 sigma_tot counter=104 i=6 t=2.53e-02 per=1.30e+01 cost=1.14e+06 flops=4.52e+07
 sigma_tot counter=104 i=7 t=2.43e-02 per=1.25e+01 cost=1.13e+06 flops=4.67e+07
 total GEMM cost=6.33e+06 flops=3.26e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.77e-04 tot=2.00e-03 ---
 sigma counter=105 i=0 t=2.25e-04 per=1.23e+01 cost=7.01e+03 flops=3.11e+07
 sigma counter=105 i=1 t=2.26e-04 per=1.24e+01 cost=6.99e+03 flops=3.09e+07
 sigma counter=105 i=2 t=2.29e-04 per=1.26e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=105 i=3 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=105 i=4 t=2.35e-04 per=1.29e+01 cost=1.89e+04 flops=8.04e+07
 sigma counter=105 i=5 t=2.37e-04 per=1.30e+01 cost=1.89e+04 flops=7.97e+07
 sigma counter=105 i=6 t=2.30e-04 per=1.26e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=105 i=7 t=2.19e-04 per=1.20e+01 cost=6.81e+03 flops=3.11e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.96e-01 t_reduction=2.03e-02 tot=2.16e-01 ---
 sigma_tot counter=105 i=0 t=2.44e-02 per=1.25e+01 cost=5.66e+05 flops=2.32e+07
 sigma_tot counter=105 i=1 t=2.43e-02 per=1.24e+01 cost=5.79e+05 flops=2.38e+07
 sigma_tot counter=105 i=2 t=2.44e-02 per=1.24e+01 cost=5.74e+05 flops=2.35e+07
 sigma_tot counter=105 i=3 t=2.43e-02 per=1.24e+01 cost=5.81e+05 flops=2.39e+07
 sigma_tot counter=105 i=4 t=2.41e-02 per=1.23e+01 cost=9.12e+05 flops=3.78e+07
 sigma_tot counter=105 i=5 t=2.45e-02 per=1.25e+01 cost=9.09e+05 flops=3.71e+07
 sigma_tot counter=105 i=6 t=2.55e-02 per=1.30e+01 cost=1.15e+06 flops=4.51e+07
 sigma_tot counter=105 i=7 t=2.45e-02 per=1.25e+01 cost=1.14e+06 flops=4.66e+07
 total GEMM cost=6.41e+06 flops=3.27e+07
    4   0 -      -2.654516020750  -6.36e-06   1.14e-03    6     8   1.70e-02  2.13e-03
    4   1 -      -2.436977285929  -8.27e-07   4.03e-04    6     8   1.70e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.84e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.29e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.84e-03 t_reduction=1.80e-04 tot=2.02e-03 ---
 sigma counter=106 i=0 t=2.28e-04 per=1.24e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=106 i=1 t=2.27e-04 per=1.23e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=106 i=2 t=2.30e-04 per=1.25e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=106 i=3 t=2.31e-04 per=1.26e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=106 i=4 t=2.33e-04 per=1.27e+01 cost=1.89e+04 flops=8.11e+07
 sigma counter=106 i=5 t=2.37e-04 per=1.29e+01 cost=1.89e+04 flops=7.97e+07
 sigma counter=106 i=6 t=2.29e-04 per=1.24e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=106 i=7 t=2.25e-04 per=1.22e+01 cost=6.81e+03 flops=3.03e+07
 total GEMM cost=7.90e+04 flops=4.29e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=1.98e-01 t_reduction=2.05e-02 tot=2.18e-01 ---
 sigma_tot counter=106 i=0 t=2.47e-02 per=1.25e+01 cost=5.73e+05 flops=2.33e+07
 sigma_tot counter=106 i=1 t=2.46e-02 per=1.24e+01 cost=5.86e+05 flops=2.38e+07
 sigma_tot counter=106 i=2 t=2.46e-02 per=1.24e+01 cost=5.81e+05 flops=2.36e+07
 sigma_tot counter=106 i=3 t=2.45e-02 per=1.24e+01 cost=5.88e+05 flops=2.40e+07
 sigma_tot counter=106 i=4 t=2.43e-02 per=1.23e+01 cost=9.30e+05 flops=3.82e+07
 sigma_tot counter=106 i=5 t=2.47e-02 per=1.25e+01 cost=9.28e+05 flops=3.75e+07
 sigma_tot counter=106 i=6 t=2.57e-02 per=1.30e+01 cost=1.16e+06 flops=4.49e+07
 sigma_tot counter=106 i=7 t=2.47e-02 per=1.25e+01 cost=1.15e+06 flops=4.65e+07
 total GEMM cost=6.49e+06 flops=3.28e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.80e-04 tot=2.00e-03 ---
 sigma counter=107 i=0 t=2.24e-04 per=1.23e+01 cost=7.01e+03 flops=3.13e+07
 sigma counter=107 i=1 t=2.24e-04 per=1.23e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=107 i=2 t=2.29e-04 per=1.26e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=107 i=3 t=2.26e-04 per=1.24e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=107 i=4 t=2.31e-04 per=1.27e+01 cost=1.89e+04 flops=8.18e+07
 sigma counter=107 i=5 t=2.37e-04 per=1.30e+01 cost=1.89e+04 flops=7.97e+07
 sigma counter=107 i=6 t=2.30e-04 per=1.26e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=107 i=7 t=2.23e-04 per=1.22e+01 cost=6.81e+03 flops=3.06e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.00e-01 t_reduction=2.06e-02 tot=2.20e-01 ---
 sigma_tot counter=107 i=0 t=2.49e-02 per=1.25e+01 cost=5.80e+05 flops=2.33e+07
 sigma_tot counter=107 i=1 t=2.48e-02 per=1.24e+01 cost=5.93e+05 flops=2.39e+07
 sigma_tot counter=107 i=2 t=2.48e-02 per=1.24e+01 cost=5.88e+05 flops=2.37e+07
 sigma_tot counter=107 i=3 t=2.48e-02 per=1.24e+01 cost=5.94e+05 flops=2.40e+07
 sigma_tot counter=107 i=4 t=2.46e-02 per=1.23e+01 cost=9.49e+05 flops=3.86e+07
 sigma_tot counter=107 i=5 t=2.50e-02 per=1.25e+01 cost=9.47e+05 flops=3.79e+07
 sigma_tot counter=107 i=6 t=2.59e-02 per=1.30e+01 cost=1.16e+06 flops=4.48e+07
 sigma_tot counter=107 i=7 t=2.49e-02 per=1.25e+01 cost=1.15e+06 flops=4.63e+07
 total GEMM cost=6.57e+06 flops=3.29e+07
    5   0 -      -2.654516818919  -7.98e-07   4.45e-04    6    10   2.13e-02  2.13e-03
    5   1 -      -2.436977409924  -1.24e-07   2.05e-04    6    10   2.13e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.84e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.29e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.84e-03 t_reduction=1.82e-04 tot=2.02e-03 ---
 sigma counter=108 i=0 t=2.25e-04 per=1.22e+01 cost=7.01e+03 flops=3.11e+07
 sigma counter=108 i=1 t=2.28e-04 per=1.24e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=108 i=2 t=2.33e-04 per=1.26e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=108 i=3 t=2.23e-04 per=1.21e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=108 i=4 t=2.33e-04 per=1.26e+01 cost=1.89e+04 flops=8.11e+07
 sigma counter=108 i=5 t=2.39e-04 per=1.30e+01 cost=1.89e+04 flops=7.91e+07
 sigma counter=108 i=6 t=2.39e-04 per=1.30e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=108 i=7 t=2.22e-04 per=1.21e+01 cost=6.81e+03 flops=3.07e+07
 total GEMM cost=7.90e+04 flops=4.29e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.01e-01 t_reduction=2.08e-02 tot=2.22e-01 ---
 sigma_tot counter=108 i=0 t=2.51e-02 per=1.25e+01 cost=5.88e+05 flops=2.34e+07
 sigma_tot counter=108 i=1 t=2.50e-02 per=1.24e+01 cost=6.00e+05 flops=2.40e+07
 sigma_tot counter=108 i=2 t=2.51e-02 per=1.24e+01 cost=5.95e+05 flops=2.37e+07
 sigma_tot counter=108 i=3 t=2.50e-02 per=1.24e+01 cost=6.01e+05 flops=2.41e+07
 sigma_tot counter=108 i=4 t=2.48e-02 per=1.23e+01 cost=9.68e+05 flops=3.90e+07
 sigma_tot counter=108 i=5 t=2.52e-02 per=1.25e+01 cost=9.66e+05 flops=3.83e+07
 sigma_tot counter=108 i=6 t=2.62e-02 per=1.30e+01 cost=1.17e+06 flops=4.47e+07
 sigma_tot counter=108 i=7 t=2.51e-02 per=1.25e+01 cost=1.16e+06 flops=4.62e+07
 total GEMM cost=6.65e+06 flops=3.30e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.77e-04 tot=2.00e-03 ---
 sigma counter=109 i=0 t=2.28e-04 per=1.25e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=109 i=1 t=2.33e-04 per=1.28e+01 cost=6.99e+03 flops=3.00e+07
 sigma counter=109 i=2 t=2.29e-04 per=1.25e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=109 i=3 t=2.21e-04 per=1.21e+01 cost=6.78e+03 flops=3.07e+07
 sigma counter=109 i=4 t=2.31e-04 per=1.27e+01 cost=1.89e+04 flops=8.18e+07
 sigma counter=109 i=5 t=2.36e-04 per=1.29e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=109 i=6 t=2.29e-04 per=1.25e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=109 i=7 t=2.18e-04 per=1.19e+01 cost=6.81e+03 flops=3.13e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.03e-01 t_reduction=2.10e-02 tot=2.24e-01 ---
 sigma_tot counter=109 i=0 t=2.53e-02 per=1.25e+01 cost=5.95e+05 flops=2.35e+07
 sigma_tot counter=109 i=1 t=2.53e-02 per=1.24e+01 cost=6.07e+05 flops=2.40e+07
 sigma_tot counter=109 i=2 t=2.53e-02 per=1.24e+01 cost=6.01e+05 flops=2.38e+07
 sigma_tot counter=109 i=3 t=2.52e-02 per=1.24e+01 cost=6.08e+05 flops=2.41e+07
 sigma_tot counter=109 i=4 t=2.50e-02 per=1.23e+01 cost=9.87e+05 flops=3.94e+07
 sigma_tot counter=109 i=5 t=2.54e-02 per=1.25e+01 cost=9.85e+05 flops=3.87e+07
 sigma_tot counter=109 i=6 t=2.64e-02 per=1.30e+01 cost=1.18e+06 flops=4.45e+07
 sigma_tot counter=109 i=7 t=2.54e-02 per=1.25e+01 cost=1.17e+06 flops=4.61e+07
 total GEMM cost=6.73e+06 flops=3.31e+07
    6   0 -      -2.654516950785  -1.32e-07   1.57e-04    6    12   2.56e-02  2.13e-03
    6   1 +      -2.436977447170  -3.72e-08   7.42e-05    6    12   2.56e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.79e-04 tot=2.00e-03 ---
 sigma counter=110 i=0 t=2.27e-04 per=1.25e+01 cost=7.01e+03 flops=3.09e+07
 sigma counter=110 i=1 t=2.29e-04 per=1.26e+01 cost=6.99e+03 flops=3.05e+07
 sigma counter=110 i=2 t=2.19e-04 per=1.20e+01 cost=6.81e+03 flops=3.11e+07
 sigma counter=110 i=3 t=2.32e-04 per=1.27e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=110 i=4 t=2.31e-04 per=1.27e+01 cost=1.89e+04 flops=8.18e+07
 sigma counter=110 i=5 t=2.36e-04 per=1.30e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=110 i=6 t=2.30e-04 per=1.26e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=110 i=7 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.05e-01 t_reduction=2.12e-02 tot=2.26e-01 ---
 sigma_tot counter=110 i=0 t=2.56e-02 per=1.25e+01 cost=6.02e+05 flops=2.35e+07
 sigma_tot counter=110 i=1 t=2.55e-02 per=1.24e+01 cost=6.14e+05 flops=2.41e+07
 sigma_tot counter=110 i=2 t=2.55e-02 per=1.24e+01 cost=6.08e+05 flops=2.38e+07
 sigma_tot counter=110 i=3 t=2.54e-02 per=1.24e+01 cost=6.15e+05 flops=2.42e+07
 sigma_tot counter=110 i=4 t=2.53e-02 per=1.23e+01 cost=1.01e+06 flops=3.98e+07
 sigma_tot counter=110 i=5 t=2.57e-02 per=1.25e+01 cost=1.00e+06 flops=3.91e+07
 sigma_tot counter=110 i=6 t=2.66e-02 per=1.30e+01 cost=1.18e+06 flops=4.44e+07
 sigma_tot counter=110 i=7 t=2.56e-02 per=1.25e+01 cost=1.17e+06 flops=4.59e+07
 total GEMM cost=6.81e+06 flops=3.32e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   2.77e-02  2.13e-03
    7   1 +      -2.436977447170   4.44e-16   7.42e-05    5    13   2.77e-02  2.13e-03
TIMING for Davidson : 2.77e-02  T(cal/comm/rest)=2.74e-02,5.26e-07,3.30e-04
optimized energies: isweep=2 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.996e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000546 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.74e-05,0.000218,0.00027 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.001,0.000173 cost=2.78e+04 flops[gemm]=2.78e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.001 t_reduction=0.000173 tot=0.00117 ---
 renorm counter=9 i=0 t=0.000198 per=19.8 cost=2.19e+03 flops=1.11e+07
 renorm counter=9 i=1 t=0.000195 per=19.5 cost=2.85e+03 flops=1.46e+07
 renorm counter=9 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=9 i=3 t=1e-06 per=0.1 cost=0 flops=0
 renorm counter=9 i=4 t=0.000189 per=18.9 cost=2.11e+03 flops=1.12e+07
 renorm counter=9 i=5 t=0.000194 per=19.4 cost=2.94e+03 flops=1.51e+07
 renorm counter=9 i=6 t=0.000223 per=22.3 cost=1.77e+04 flops=7.94e+07
 total GEMM cost=2.78e+04 flops=2.78e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.00943 t_reduction=0.00164 tot=0.0111 ---
 renorm_tot counter=9 i=0 t=0.00189 per=20.1 cost=2.68e+04 flops=1.41e+07
 renorm_tot counter=9 i=1 t=0.00184 per=19.5 cost=3.92e+04 flops=2.13e+07
 renorm_tot counter=9 i=2 t=0.00078 per=8.27 cost=2.45e+04 flops=3.14e+07
 renorm_tot counter=9 i=3 t=0.000818 per=8.68 cost=4.29e+04 flops=5.25e+07
 renorm_tot counter=9 i=4 t=0.00102 per=10.8 cost=2.64e+04 flops=2.59e+07
 renorm_tot counter=9 i=5 t=0.00104 per=11 cost=4.54e+04 flops=4.36e+07
 renorm_tot counter=9 i=6 t=0.00204 per=21.6 cost=3.06e+05 flops=1.5e+08
 total GEMM cost=5.11e+05 flops=5.42e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0025 S T(init/kernel/comm)=9.1e-05,0.0024,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=5.35e-05,3.58e-05,8.93e-05 speed=0.116GB/s disk[used]=9.09e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.53e-02 S #####
 T(fetch) = 7.37e-05 S  per = 0.21  per(accum) = 0.21
 T(hdiag) = 7.15e-05 S  per =  0.2  per(accum) = 0.41
 T(dvdsn) = 3.19e-02 S  per =   90  per(accum) = 91
 T(decim) = 8.18e-05 S  per = 0.23  per(accum) = 91
 T(guess) = 8.47e-05 S  per = 0.24  per(accum) = 91
 T(renrm) = 2.56e-03 S  per =  7.3  per(accum) = 98
 T(save ) = 5.44e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.17e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.88e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.33e-04 S  per = 0.73  per(accum) = 0.86
 T(hintermediate init           ) = 1.96e-04 S  per = 0.62  per(accum) = 1.5
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.011  per(accum) = 1.5
 T(preprocess_hformulae_Hxlist2 ) = 2.23e-03 S  per =    7  per(accum) = 8.5
 T(hmmtasks init                ) = 1.29e-03 S  per =  4.1  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 2.74e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 5.26e-07 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.30e-04 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.52e-03 S
 T(qops init                    ) = 9.07e-05 S  per =  3.6  per(accum) = 3.6
 T(qops_dict memcpy cpu2gpu     ) = 2.79e-05 S  per =  1.1  per(accum) = 4.7
 T(symbolic_formulae_renorm     ) = 2.04e-04 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.15e-05 S  per = 0.46  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.76e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.55e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.39e-04 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 8.39e-06 S  per = 0.33  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.24e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.70e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.63e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 3.53e-02 S #####
 T(fetch) = 7.37e-05 S  per = 0.21  per(accum) = 0.21
 T(hdiag) = 7.15e-05 S  per =  0.2  per(accum) = 0.41
 T(dvdsn) = 3.19e-02 S  per =   90  per(accum) = 91
 T(decim) = 8.18e-05 S  per = 0.23  per(accum) = 91
 T(guess) = 8.47e-05 S  per = 0.24  per(accum) = 91
 T(renrm) = 2.56e-03 S  per =  7.3  per(accum) = 98
 T(save ) = 5.44e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.17e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.88e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.33e-04 S  per = 0.73  per(accum) = 0.86
 T(hintermediate init           ) = 1.96e-04 S  per = 0.62  per(accum) = 1.5
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.011  per(accum) = 1.5
 T(preprocess_hformulae_Hxlist2 ) = 2.23e-03 S  per =    7  per(accum) = 8.5
 T(hmmtasks init                ) = 1.29e-03 S  per =  4.1  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 2.74e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 5.26e-07 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.30e-04 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.52e-03 S
 T(qops init                    ) = 9.07e-05 S  per =  3.6  per(accum) = 3.6
 T(qops_dict memcpy cpu2gpu     ) = 2.79e-05 S  per =  1.1  per(accum) = 4.7
 T(symbolic_formulae_renorm     ) = 2.04e-04 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.15e-05 S  per = 0.46  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.76e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.55e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.39e-04 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 8.39e-06 S  per = 0.33  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.24e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.70e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.63e-06 S  per = 0.34  per(accum) = 1e+02
##### time_global: 3.27e-01 S #####
 T(fetch) = 2.80e-03 S  per = 0.86  per(accum) = 0.86
 T(hdiag) = 9.03e-04 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 2.89e-01 S  per =   88  per(accum) = 89
 T(decim) = 2.41e-03 S  per = 0.74  per(accum) = 90
 T(guess) = 8.19e-04 S  per = 0.25  per(accum) = 90
 T(renrm) = 2.57e-02 S  per =  7.9  per(accum) = 98
 T(save ) = 5.59e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.86e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 3.84e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 2.92e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 2.05e-03 S  per = 0.72  per(accum) = 1.9
 T(hintermediates memcpy cpu2gpu) = 4.60e-05 S  per = 0.016  per(accum) = 1.9
 T(preprocess_hformulae_Hxlist2 ) = 2.38e-02 S  per =  8.3  per(accum) = 10
 T(hmmtasks init                ) = 1.39e-02 S  per =  4.9  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 2.40e-01 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 5.63e-06 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.30e-03 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.52e-02 S
 T(qops init                    ) = 1.15e-03 S  per =  4.6  per(accum) = 4.6
 T(qops_dict memcpy cpu2gpu     ) = 3.41e-04 S  per =  1.4  per(accum) = 5.9
 T(symbolic_formulae_renorm     ) = 2.24e-03 S  per =  8.9  per(accum) = 15
 T(rintermediate init           ) = 9.30e-04 S  per =  3.7  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.30e-05 S  per = 0.21  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 5.00e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.18e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 8.42e-05 S  per = 0.33  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.19e-02 S  per =   47  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 2.81e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.74e-05 S  per = 0.39  per(accum) = 1e+02

isweep=2 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.350e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47c87ea0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.241e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000152 flops=2.91e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.886e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.18e-05,0.000957,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=3.4e-05,0.00181,0.000178 cost=7.9e+04 flops[gemm]=4.37e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00181 t_reduction=0.000178 tot=0.00199 ---
 sigma counter=111 i=0 t=0.000223 per=12.3 cost=6.81e+03 flops=3.06e+07
 sigma counter=111 i=1 t=0.000224 per=12.4 cost=6.78e+03 flops=3.03e+07
 sigma counter=111 i=2 t=0.000219 per=12.1 cost=7.01e+03 flops=3.2e+07
 sigma counter=111 i=3 t=0.000225 per=12.4 cost=6.99e+03 flops=3.11e+07
 sigma counter=111 i=4 t=0.000223 per=12.3 cost=6.81e+03 flops=3.06e+07
 sigma counter=111 i=5 t=0.000222 per=12.3 cost=6.78e+03 flops=3.06e+07
 sigma counter=111 i=6 t=0.000241 per=13.3 cost=1.89e+04 flops=7.84e+07
 sigma counter=111 i=7 t=0.000231 per=12.8 cost=1.89e+04 flops=8.18e+07
 total GEMM cost=7.9e+04 flops=4.37e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.207 t_reduction=0.0214 tot=0.228 ---
 sigma_tot counter=111 i=0 t=0.0258 per=12.5 cost=6.08e+05 flops=2.36e+07
 sigma_tot counter=111 i=1 t=0.0257 per=12.4 cost=6.21e+05 flops=2.41e+07
 sigma_tot counter=111 i=2 t=0.0257 per=12.4 cost=6.15e+05 flops=2.39e+07
 sigma_tot counter=111 i=3 t=0.0257 per=12.4 cost=6.22e+05 flops=2.42e+07
 sigma_tot counter=111 i=4 t=0.0255 per=12.3 cost=1.01e+06 flops=3.97e+07
 sigma_tot counter=111 i=5 t=0.0259 per=12.5 cost=1.01e+06 flops=3.9e+07
 sigma_tot counter=111 i=6 t=0.0269 per=13 cost=1.2e+06 flops=4.47e+07
 sigma_tot counter=111 i=7 t=0.0258 per=12.5 cost=1.19e+06 flops=4.62e+07
 total GEMM cost=6.88e+06 flops=3.33e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00181,0.000183 cost=7.9e+04 flops[gemm]=4.35e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00181 t_reduction=0.000183 tot=0.002 ---
 sigma counter=112 i=0 t=0.000225 per=12.4 cost=6.81e+03 flops=3.03e+07
 sigma counter=112 i=1 t=0.000223 per=12.3 cost=6.78e+03 flops=3.04e+07
 sigma counter=112 i=2 t=0.000227 per=12.5 cost=7.01e+03 flops=3.09e+07
 sigma counter=112 i=3 t=0.000224 per=12.3 cost=6.99e+03 flops=3.12e+07
 sigma counter=112 i=4 t=0.000217 per=12 cost=6.81e+03 flops=3.14e+07
 sigma counter=112 i=5 t=0.00022 per=12.1 cost=6.78e+03 flops=3.08e+07
 sigma counter=112 i=6 t=0.000244 per=13.5 cost=1.89e+04 flops=7.74e+07
 sigma counter=112 i=7 t=0.000234 per=12.9 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.9e+04 flops=4.35e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.209 t_reduction=0.0215 tot=0.23 ---
 sigma_tot counter=112 i=0 t=0.026 per=12.5 cost=6.15e+05 flops=2.37e+07
 sigma_tot counter=112 i=1 t=0.0259 per=12.4 cost=6.27e+05 flops=2.42e+07
 sigma_tot counter=112 i=2 t=0.026 per=12.4 cost=6.22e+05 flops=2.4e+07
 sigma_tot counter=112 i=3 t=0.0259 per=12.4 cost=6.29e+05 flops=2.43e+07
 sigma_tot counter=112 i=4 t=0.0257 per=12.3 cost=1.02e+06 flops=3.97e+07
 sigma_tot counter=112 i=5 t=0.0261 per=12.5 cost=1.02e+06 flops=3.9e+07
 sigma_tot counter=112 i=6 t=0.0271 per=13 cost=1.22e+06 flops=4.5e+07
 sigma_tot counter=112 i=7 t=0.026 per=12.5 cost=1.21e+06 flops=4.66e+07
 total GEMM cost=6.96e+06 flops=3.34e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.23e-03  2.12e-03
    1   1 +      -2.436977447170  -1.00e+03   7.42e-05    2     2   4.23e-03  2.12e-03
TIMING for Davidson : 4.25e-03  T(cal/comm/rest)=4.21e-03,1.18e-07,4.18e-05
optimized energies: isweep=2 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.671e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000163 flops=2.71e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 1.994e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000527 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.52e-05,0.000223,0.000259 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00101,0.000179 cost=1.55e+05 flops[gemm]=1.53e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00101 t_reduction=0.000179 tot=0.00119 ---
 renorm counter=10 i=0 t=0.000204 per=20.2 cost=8.1e+03 flops=3.97e+07
 renorm counter=10 i=1 t=0.000191 per=18.9 cost=8.36e+03 flops=4.38e+07
 renorm counter=10 i=2 t=1e-06 per=0.0988 cost=0 flops=0
 renorm counter=10 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=10 i=4 t=0.000191 per=18.9 cost=1.65e+04 flops=8.63e+07
 renorm counter=10 i=5 t=0.000197 per=19.5 cost=2.89e+04 flops=1.47e+08
 renorm counter=10 i=6 t=0.000228 per=22.5 cost=9.32e+04 flops=4.09e+08
 total GEMM cost=1.55e+05 flops=1.53e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0104 t_reduction=0.00182 tot=0.0123 ---
 renorm_tot counter=10 i=0 t=0.0021 per=20.1 cost=3.49e+04 flops=1.66e+07
 renorm_tot counter=10 i=1 t=0.00203 per=19.4 cost=4.75e+04 flops=2.34e+07
 renorm_tot counter=10 i=2 t=0.000781 per=7.48 cost=2.45e+04 flops=3.13e+07
 renorm_tot counter=10 i=3 t=0.000818 per=7.83 cost=4.29e+04 flops=5.25e+07
 renorm_tot counter=10 i=4 t=0.00121 per=11.6 cost=4.29e+04 flops=3.54e+07
 renorm_tot counter=10 i=5 t=0.00124 per=11.8 cost=7.43e+04 flops=6.01e+07
 renorm_tot counter=10 i=6 t=0.00226 per=21.7 cost=3.99e+05 flops=1.76e+08
 total GEMM cost=6.66e+05 flops=6.38e+07
check ||H-H.dagger||=1.03e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=7.6e-05,0.0026,8.7e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=4.99e-05,4.06e-05,9.06e-05 speed=0.214GB/s disk[used]=9.23e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.25e-02 S #####
 T(fetch) = 3.09e-04 S  per =  2.5  per(accum) = 2.5
 T(hdiag) = 6.76e-05 S  per = 0.54  per(accum) = 3
 T(dvdsn) = 8.43e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.11e-04 S  per =  2.5  per(accum) = 73
 T(guess) = 7.25e-05 S  per = 0.58  per(accum) = 74
 T(renrm) = 2.73e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.39e-04 S  per =  4.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.25e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.78e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.29e-04 S  per =  2.8  per(accum) = 3.2
 T(hintermediate init           ) = 1.92e-04 S  per =  2.3  per(accum) = 5.6
 T(hintermediates memcpy cpu2gpu) = 3.60e-06 S  per = 0.044  per(accum) = 5.6
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =   27  per(accum) = 33
 T(hmmtasks init                ) = 1.29e-03 S  per =   16  per(accum) = 48
 T(dvdson solver [Hx_batchGPU]  ) = 4.21e-03 S  per =   51  per(accum) = 99
 T(dvdson solver [communication]) = 1.18e-07 S  per = 0.0014  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.18e-05 S  per = 0.51  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.68e-03 S
 T(qops init                    ) = 7.63e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.36e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.72e-04 S  per =  6.4  per(accum) = 11
 T(rintermediate init           ) = 2.03e-04 S  per =  7.6  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.32e-06 S  per = 0.16  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.36e-04 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.53e-04 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 7.52e-06 S  per = 0.28  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.26e-03 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.66e-05 S  per = 0.99  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.66e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 4.78e-02 S #####
 T(fetch) = 3.83e-04 S  per =  0.8  per(accum) = 0.8
 T(hdiag) = 1.39e-04 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 4.03e-02 S  per =   84  per(accum) = 85
 T(decim) = 3.93e-04 S  per = 0.82  per(accum) = 86
 T(guess) = 1.57e-04 S  per = 0.33  per(accum) = 87
 T(renrm) = 5.30e-03 S  per =   11  per(accum) = 98
 T(save ) = 1.08e-03 S  per =  2.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.00e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 7.66e-05 S  per = 0.19  per(accum) = 0.19
 T(symbolic_formulae_twodot     ) = 4.62e-04 S  per =  1.2  per(accum) = 1.3
 T(hintermediate init           ) = 3.88e-04 S  per = 0.97  per(accum) = 2.3
 T(hintermediates memcpy cpu2gpu) = 7.13e-06 S  per = 0.018  per(accum) = 2.3
 T(preprocess_hformulae_Hxlist2 ) = 4.48e-03 S  per =   11  per(accum) = 14
 T(hmmtasks init                ) = 2.58e-03 S  per =  6.5  per(accum) = 20
 T(dvdson solver [Hx_batchGPU]  ) = 3.16e-02 S  per =   79  per(accum) = 99
 T(dvdson solver [communication]) = 6.44e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.72e-04 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.20e-03 S
 T(qops init                    ) = 1.67e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 6.15e-05 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 3.76e-04 S  per =  7.2  per(accum) = 12
 T(rintermediate init           ) = 2.14e-04 S  per =  4.1  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 9.08e-06 S  per = 0.17  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 1.09e-03 S  per =   21  per(accum) = 37
 T(rmmtasks init                ) = 6.92e-04 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.59e-05 S  per = 0.31  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 2.50e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.36e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.73e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 3.39e-01 S #####
 T(fetch) = 3.11e-03 S  per = 0.92  per(accum) = 0.92
 T(hdiag) = 9.71e-04 S  per = 0.29  per(accum) = 1.2
 T(dvdsn) = 2.97e-01 S  per =   88  per(accum) = 89
 T(decim) = 2.72e-03 S  per =  0.8  per(accum) = 90
 T(guess) = 8.91e-04 S  per = 0.26  per(accum) = 90
 T(renrm) = 2.84e-02 S  per =  8.4  per(accum) = 98
 T(save ) = 6.12e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.95e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 4.21e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 3.15e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 2.24e-03 S  per = 0.76  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 4.96e-05 S  per = 0.017  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 2.61e-02 S  per =  8.9  per(accum) = 11
 T(hmmtasks init                ) = 1.52e-02 S  per =  5.2  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 2.44e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 5.75e-06 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.35e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.79e-02 S
 T(qops init                    ) = 1.23e-03 S  per =  4.4  per(accum) = 4.4
 T(qops_dict memcpy cpu2gpu     ) = 3.74e-04 S  per =  1.3  per(accum) = 5.7
 T(symbolic_formulae_renorm     ) = 2.41e-03 S  per =  8.6  per(accum) = 14
 T(rintermediate init           ) = 1.13e-03 S  per =  4.1  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.73e-05 S  per = 0.21  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 5.53e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.54e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 9.17e-05 S  per = 0.33  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.31e-02 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.08e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.06e-04 S  per = 0.38  per(accum) = 1e+02

isweep=2 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.081e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x48141a60
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.191e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.00015 flops=2.94e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.860e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00225 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.23e-05,0.000959,0.00124 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.5e-05,0.00182,0.000178 cost=7.9e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00182 t_reduction=0.000178 tot=0.002 ---
 sigma counter=113 i=0 t=0.000226 per=12.4 cost=6.81e+03 flops=3.02e+07
 sigma counter=113 i=1 t=0.000224 per=12.3 cost=6.78e+03 flops=3.03e+07
 sigma counter=113 i=2 t=0.000228 per=12.5 cost=7.01e+03 flops=3.07e+07
 sigma counter=113 i=3 t=0.000223 per=12.2 cost=6.99e+03 flops=3.13e+07
 sigma counter=113 i=4 t=0.000219 per=12 cost=6.81e+03 flops=3.11e+07
 sigma counter=113 i=5 t=0.000222 per=12.2 cost=6.78e+03 flops=3.06e+07
 sigma counter=113 i=6 t=0.000249 per=13.7 cost=1.89e+04 flops=7.59e+07
 sigma counter=113 i=7 t=0.000232 per=12.7 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.9e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.211 t_reduction=0.0217 tot=0.232 ---
 sigma_tot counter=113 i=0 t=0.0262 per=12.5 cost=6.22e+05 flops=2.37e+07
 sigma_tot counter=113 i=1 t=0.0262 per=12.4 cost=6.34e+05 flops=2.42e+07
 sigma_tot counter=113 i=2 t=0.0262 per=12.4 cost=6.29e+05 flops=2.4e+07
 sigma_tot counter=113 i=3 t=0.0261 per=12.4 cost=6.36e+05 flops=2.44e+07
 sigma_tot counter=113 i=4 t=0.0259 per=12.3 cost=1.03e+06 flops=3.96e+07
 sigma_tot counter=113 i=5 t=0.0263 per=12.5 cost=1.02e+06 flops=3.89e+07
 sigma_tot counter=113 i=6 t=0.0274 per=13 cost=1.24e+06 flops=4.53e+07
 sigma_tot counter=113 i=7 t=0.0263 per=12.5 cost=1.23e+06 flops=4.69e+07
 total GEMM cost=7.04e+06 flops=3.34e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.6e-05,0.00182,0.000179 cost=7.9e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00182 t_reduction=0.000179 tot=0.002 ---
 sigma counter=114 i=0 t=0.000221 per=12.1 cost=6.81e+03 flops=3.08e+07
 sigma counter=114 i=1 t=0.000229 per=12.6 cost=6.78e+03 flops=2.96e+07
 sigma counter=114 i=2 t=0.000225 per=12.3 cost=7.01e+03 flops=3.11e+07
 sigma counter=114 i=3 t=0.000224 per=12.3 cost=6.99e+03 flops=3.12e+07
 sigma counter=114 i=4 t=0.000218 per=12 cost=6.81e+03 flops=3.13e+07
 sigma counter=114 i=5 t=0.000225 per=12.3 cost=6.78e+03 flops=3.02e+07
 sigma counter=114 i=6 t=0.000247 per=13.6 cost=1.89e+04 flops=7.65e+07
 sigma counter=114 i=7 t=0.000233 per=12.8 cost=1.89e+04 flops=8.11e+07
 total GEMM cost=7.9e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.212 t_reduction=0.0219 tot=0.234 ---
 sigma_tot counter=114 i=0 t=0.0264 per=12.5 cost=6.29e+05 flops=2.38e+07
 sigma_tot counter=114 i=1 t=0.0264 per=12.4 cost=6.41e+05 flops=2.43e+07
 sigma_tot counter=114 i=2 t=0.0264 per=12.4 cost=6.36e+05 flops=2.41e+07
 sigma_tot counter=114 i=3 t=0.0263 per=12.4 cost=6.43e+05 flops=2.44e+07
 sigma_tot counter=114 i=4 t=0.0261 per=12.3 cost=1.03e+06 flops=3.95e+07
 sigma_tot counter=114 i=5 t=0.0266 per=12.5 cost=1.03e+06 flops=3.88e+07
 sigma_tot counter=114 i=6 t=0.0276 per=13 cost=1.26e+06 flops=4.56e+07
 sigma_tot counter=114 i=7 t=0.0265 per=12.5 cost=1.25e+06 flops=4.72e+07
 total GEMM cost=7.12e+06 flops=3.35e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819590  -1.00e+03   7.01e-02    2     2   4.24e-03  2.12e-03
    1   1 -      -2.436094100139  -1.00e+03   4.92e-02    2     2   4.24e-03  2.12e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.83e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.80e-04 tot=2.01e-03 ---
 sigma counter=115 i=0 t=2.30e-04 per=1.26e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=115 i=1 t=2.26e-04 per=1.24e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=115 i=2 t=2.28e-04 per=1.25e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=115 i=3 t=2.24e-04 per=1.22e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=115 i=4 t=2.18e-04 per=1.19e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=115 i=5 t=2.28e-04 per=1.25e+01 cost=6.78e+03 flops=2.98e+07
 sigma counter=115 i=6 t=2.43e-04 per=1.33e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=115 i=7 t=2.32e-04 per=1.27e+01 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.90e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.14e-01 t_reduction=2.21e-02 tot=2.36e-01 ---
 sigma_tot counter=115 i=0 t=2.67e-02 per=1.25e+01 cost=6.36e+05 flops=2.38e+07
 sigma_tot counter=115 i=1 t=2.66e-02 per=1.24e+01 cost=6.48e+05 flops=2.43e+07
 sigma_tot counter=115 i=2 t=2.66e-02 per=1.24e+01 cost=6.43e+05 flops=2.41e+07
 sigma_tot counter=115 i=3 t=2.66e-02 per=1.24e+01 cost=6.50e+05 flops=2.45e+07
 sigma_tot counter=115 i=4 t=2.64e-02 per=1.23e+01 cost=1.04e+06 flops=3.95e+07
 sigma_tot counter=115 i=5 t=2.68e-02 per=1.25e+01 cost=1.04e+06 flops=3.87e+07
 sigma_tot counter=115 i=6 t=2.79e-02 per=1.30e+01 cost=1.28e+06 flops=4.58e+07
 sigma_tot counter=115 i=7 t=2.67e-02 per=1.25e+01 cost=1.27e+06 flops=4.75e+07
 total GEMM cost=7.20e+06 flops=3.36e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.50e-05,1.83e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.78e-04 tot=2.01e-03 ---
 sigma counter=116 i=0 t=2.27e-04 per=1.24e+01 cost=6.81e+03 flops=3.00e+07
 sigma counter=116 i=1 t=2.25e-04 per=1.23e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=116 i=2 t=2.26e-04 per=1.23e+01 cost=7.01e+03 flops=3.10e+07
 sigma counter=116 i=3 t=2.26e-04 per=1.23e+01 cost=6.99e+03 flops=3.09e+07
 sigma counter=116 i=4 t=2.24e-04 per=1.22e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=116 i=5 t=2.26e-04 per=1.23e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=116 i=6 t=2.44e-04 per=1.33e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=116 i=7 t=2.32e-04 per=1.27e+01 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.90e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.16e-01 t_reduction=2.23e-02 tot=2.38e-01 ---
 sigma_tot counter=116 i=0 t=2.69e-02 per=1.25e+01 cost=6.42e+05 flops=2.39e+07
 sigma_tot counter=116 i=1 t=2.68e-02 per=1.24e+01 cost=6.54e+05 flops=2.44e+07
 sigma_tot counter=116 i=2 t=2.69e-02 per=1.24e+01 cost=6.50e+05 flops=2.42e+07
 sigma_tot counter=116 i=3 t=2.68e-02 per=1.24e+01 cost=6.57e+05 flops=2.45e+07
 sigma_tot counter=116 i=4 t=2.66e-02 per=1.23e+01 cost=1.05e+06 flops=3.94e+07
 sigma_tot counter=116 i=5 t=2.70e-02 per=1.25e+01 cost=1.04e+06 flops=3.87e+07
 sigma_tot counter=116 i=6 t=2.81e-02 per=1.30e+01 cost=1.30e+06 flops=4.61e+07
 sigma_tot counter=116 i=7 t=2.70e-02 per=1.25e+01 cost=1.29e+06 flops=4.78e+07
 total GEMM cost=7.28e+06 flops=3.37e+07
    2   0 -      -2.654426863106  -1.84e-03   1.26e-02    4     4   8.52e-03  2.13e-03
    2   1 -      -2.436959129206  -8.65e-04   5.19e-03    4     4   8.52e-03  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.34e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.78e-04 tot=2.00e-03 ---
 sigma counter=117 i=0 t=2.28e-04 per=1.25e+01 cost=6.81e+03 flops=2.99e+07
 sigma counter=117 i=1 t=2.24e-04 per=1.23e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=117 i=2 t=2.19e-04 per=1.20e+01 cost=7.01e+03 flops=3.20e+07
 sigma counter=117 i=3 t=2.27e-04 per=1.25e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=117 i=4 t=2.21e-04 per=1.21e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=117 i=5 t=2.24e-04 per=1.23e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=117 i=6 t=2.46e-04 per=1.35e+01 cost=1.89e+04 flops=7.68e+07
 sigma counter=117 i=7 t=2.31e-04 per=1.27e+01 cost=1.89e+04 flops=8.18e+07
 total GEMM cost=7.90e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.18e-01 t_reduction=2.24e-02 tot=2.40e-01 ---
 sigma_tot counter=117 i=0 t=2.71e-02 per=1.25e+01 cost=6.49e+05 flops=2.39e+07
 sigma_tot counter=117 i=1 t=2.71e-02 per=1.24e+01 cost=6.61e+05 flops=2.44e+07
 sigma_tot counter=117 i=2 t=2.71e-02 per=1.24e+01 cost=6.57e+05 flops=2.43e+07
 sigma_tot counter=117 i=3 t=2.70e-02 per=1.24e+01 cost=6.64e+05 flops=2.46e+07
 sigma_tot counter=117 i=4 t=2.68e-02 per=1.23e+01 cost=1.05e+06 flops=3.93e+07
 sigma_tot counter=117 i=5 t=2.72e-02 per=1.25e+01 cost=1.05e+06 flops=3.86e+07
 sigma_tot counter=117 i=6 t=2.84e-02 per=1.30e+01 cost=1.32e+06 flops=4.64e+07
 sigma_tot counter=117 i=7 t=2.72e-02 per=1.25e+01 cost=1.31e+06 flops=4.80e+07
 total GEMM cost=7.36e+06 flops=3.38e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.83e-04 cost=7.90e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.83e-04 tot=2.01e-03 ---
 sigma counter=118 i=0 t=2.24e-04 per=1.22e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=118 i=1 t=2.25e-04 per=1.23e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=118 i=2 t=2.24e-04 per=1.22e+01 cost=7.01e+03 flops=3.13e+07
 sigma counter=118 i=3 t=2.27e-04 per=1.24e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=118 i=4 t=2.20e-04 per=1.20e+01 cost=6.81e+03 flops=3.10e+07
 sigma counter=118 i=5 t=2.32e-04 per=1.27e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=118 i=6 t=2.44e-04 per=1.33e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=118 i=7 t=2.33e-04 per=1.27e+01 cost=1.89e+04 flops=8.11e+07
 total GEMM cost=7.90e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.20e-01 t_reduction=2.26e-02 tot=2.42e-01 ---
 sigma_tot counter=118 i=0 t=2.74e-02 per=1.25e+01 cost=6.56e+05 flops=2.40e+07
 sigma_tot counter=118 i=1 t=2.73e-02 per=1.24e+01 cost=6.68e+05 flops=2.45e+07
 sigma_tot counter=118 i=2 t=2.73e-02 per=1.24e+01 cost=6.64e+05 flops=2.43e+07
 sigma_tot counter=118 i=3 t=2.72e-02 per=1.24e+01 cost=6.71e+05 flops=2.46e+07
 sigma_tot counter=118 i=4 t=2.70e-02 per=1.23e+01 cost=1.06e+06 flops=3.92e+07
 sigma_tot counter=118 i=5 t=2.75e-02 per=1.25e+01 cost=1.06e+06 flops=3.85e+07
 sigma_tot counter=118 i=6 t=2.86e-02 per=1.30e+01 cost=1.33e+06 flops=4.66e+07
 sigma_tot counter=118 i=7 t=2.74e-02 per=1.25e+01 cost=1.33e+06 flops=4.83e+07
 total GEMM cost=7.44e+06 flops=3.38e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.28e-02  2.13e-03
    3   1 -      -2.436975259479  -1.61e-05   1.59e-03    6     6   1.28e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.84e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.29e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.84e-03 t_reduction=1.82e-04 tot=2.02e-03 ---
 sigma counter=119 i=0 t=2.28e-04 per=1.24e+01 cost=6.81e+03 flops=2.99e+07
 sigma counter=119 i=1 t=2.24e-04 per=1.22e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=119 i=2 t=2.35e-04 per=1.28e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=119 i=3 t=2.26e-04 per=1.23e+01 cost=6.99e+03 flops=3.09e+07
 sigma counter=119 i=4 t=2.21e-04 per=1.20e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=119 i=5 t=2.26e-04 per=1.23e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=119 i=6 t=2.44e-04 per=1.33e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=119 i=7 t=2.37e-04 per=1.29e+01 cost=1.89e+04 flops=7.97e+07
 total GEMM cost=7.90e+04 flops=4.29e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.22e-01 t_reduction=2.28e-02 tot=2.44e-01 ---
 sigma_tot counter=119 i=0 t=2.76e-02 per=1.25e+01 cost=6.63e+05 flops=2.40e+07
 sigma_tot counter=119 i=1 t=2.75e-02 per=1.24e+01 cost=6.75e+05 flops=2.45e+07
 sigma_tot counter=119 i=2 t=2.76e-02 per=1.24e+01 cost=6.71e+05 flops=2.44e+07
 sigma_tot counter=119 i=3 t=2.75e-02 per=1.24e+01 cost=6.78e+05 flops=2.47e+07
 sigma_tot counter=119 i=4 t=2.72e-02 per=1.23e+01 cost=1.07e+06 flops=3.92e+07
 sigma_tot counter=119 i=5 t=2.77e-02 per=1.25e+01 cost=1.06e+06 flops=3.84e+07
 sigma_tot counter=119 i=6 t=2.88e-02 per=1.30e+01 cost=1.35e+06 flops=4.69e+07
 sigma_tot counter=119 i=7 t=2.77e-02 per=1.25e+01 cost=1.34e+06 flops=4.86e+07
 total GEMM cost=7.52e+06 flops=3.39e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.84e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.29e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.84e-03 t_reduction=1.79e-04 tot=2.02e-03 ---
 sigma counter=120 i=0 t=2.27e-04 per=1.23e+01 cost=6.81e+03 flops=3.00e+07
 sigma counter=120 i=1 t=2.30e-04 per=1.25e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=120 i=2 t=2.37e-04 per=1.29e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=120 i=3 t=2.28e-04 per=1.24e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=120 i=4 t=2.21e-04 per=1.20e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=120 i=5 t=2.22e-04 per=1.21e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=120 i=6 t=2.44e-04 per=1.32e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=120 i=7 t=2.33e-04 per=1.26e+01 cost=1.89e+04 flops=8.11e+07
 total GEMM cost=7.90e+04 flops=4.29e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.23e-01 t_reduction=2.30e-02 tot=2.46e-01 ---
 sigma_tot counter=120 i=0 t=2.78e-02 per=1.24e+01 cost=6.70e+05 flops=2.41e+07
 sigma_tot counter=120 i=1 t=2.77e-02 per=1.24e+01 cost=6.82e+05 flops=2.46e+07
 sigma_tot counter=120 i=2 t=2.78e-02 per=1.24e+01 cost=6.78e+05 flops=2.44e+07
 sigma_tot counter=120 i=3 t=2.77e-02 per=1.24e+01 cost=6.85e+05 flops=2.47e+07
 sigma_tot counter=120 i=4 t=2.75e-02 per=1.23e+01 cost=1.07e+06 flops=3.91e+07
 sigma_tot counter=120 i=5 t=2.79e-02 per=1.25e+01 cost=1.07e+06 flops=3.84e+07
 sigma_tot counter=120 i=6 t=2.91e-02 per=1.30e+01 cost=1.37e+06 flops=4.72e+07
 sigma_tot counter=120 i=7 t=2.79e-02 per=1.25e+01 cost=1.36e+06 flops=4.89e+07
 total GEMM cost=7.60e+06 flops=3.40e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.71e-02  2.13e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.71e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.79e-04 tot=2.00e-03 ---
 sigma counter=121 i=0 t=2.28e-04 per=1.25e+01 cost=6.81e+03 flops=2.99e+07
 sigma counter=121 i=1 t=2.28e-04 per=1.25e+01 cost=6.78e+03 flops=2.98e+07
 sigma counter=121 i=2 t=2.29e-04 per=1.26e+01 cost=7.01e+03 flops=3.06e+07
 sigma counter=121 i=3 t=2.23e-04 per=1.22e+01 cost=6.99e+03 flops=3.13e+07
 sigma counter=121 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=121 i=5 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=121 i=6 t=2.44e-04 per=1.34e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=121 i=7 t=2.30e-04 per=1.26e+01 cost=1.89e+04 flops=8.22e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.25e-01 t_reduction=2.32e-02 tot=2.48e-01 ---
 sigma_tot counter=121 i=0 t=2.80e-02 per=1.25e+01 cost=6.76e+05 flops=2.41e+07
 sigma_tot counter=121 i=1 t=2.80e-02 per=1.24e+01 cost=6.88e+05 flops=2.46e+07
 sigma_tot counter=121 i=2 t=2.80e-02 per=1.24e+01 cost=6.85e+05 flops=2.45e+07
 sigma_tot counter=121 i=3 t=2.79e-02 per=1.24e+01 cost=6.92e+05 flops=2.48e+07
 sigma_tot counter=121 i=4 t=2.77e-02 per=1.23e+01 cost=1.08e+06 flops=3.90e+07
 sigma_tot counter=121 i=5 t=2.81e-02 per=1.25e+01 cost=1.08e+06 flops=3.83e+07
 sigma_tot counter=121 i=6 t=2.93e-02 per=1.30e+01 cost=1.39e+06 flops=4.74e+07
 sigma_tot counter=121 i=7 t=2.81e-02 per=1.25e+01 cost=1.38e+06 flops=4.91e+07
 total GEMM cost=7.67e+06 flops=3.41e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.78e-04 tot=2.00e-03 ---
 sigma counter=122 i=0 t=2.20e-04 per=1.21e+01 cost=6.81e+03 flops=3.10e+07
 sigma counter=122 i=1 t=2.29e-04 per=1.26e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=122 i=2 t=2.31e-04 per=1.27e+01 cost=7.01e+03 flops=3.03e+07
 sigma counter=122 i=3 t=2.24e-04 per=1.23e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=122 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=122 i=5 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=122 i=6 t=2.46e-04 per=1.35e+01 cost=1.89e+04 flops=7.68e+07
 sigma counter=122 i=7 t=2.30e-04 per=1.26e+01 cost=1.89e+04 flops=8.22e+07
 total GEMM cost=7.90e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.27e-01 t_reduction=2.33e-02 tot=2.50e-01 ---
 sigma_tot counter=122 i=0 t=2.83e-02 per=1.24e+01 cost=6.83e+05 flops=2.42e+07
 sigma_tot counter=122 i=1 t=2.82e-02 per=1.24e+01 cost=6.95e+05 flops=2.47e+07
 sigma_tot counter=122 i=2 t=2.83e-02 per=1.24e+01 cost=6.92e+05 flops=2.45e+07
 sigma_tot counter=122 i=3 t=2.81e-02 per=1.24e+01 cost=6.99e+05 flops=2.48e+07
 sigma_tot counter=122 i=4 t=2.79e-02 per=1.23e+01 cost=1.09e+06 flops=3.90e+07
 sigma_tot counter=122 i=5 t=2.84e-02 per=1.25e+01 cost=1.09e+06 flops=3.83e+07
 sigma_tot counter=122 i=6 t=2.96e-02 per=1.30e+01 cost=1.41e+06 flops=4.77e+07
 sigma_tot counter=122 i=7 t=2.84e-02 per=1.25e+01 cost=1.40e+06 flops=4.94e+07
 total GEMM cost=7.75e+06 flops=3.41e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.13e-02  2.13e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.13e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.83e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.31e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.80e-04 tot=2.01e-03 ---
 sigma counter=123 i=0 t=2.33e-04 per=1.27e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=123 i=1 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=123 i=2 t=2.28e-04 per=1.24e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=123 i=3 t=2.24e-04 per=1.22e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=123 i=4 t=2.18e-04 per=1.19e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=123 i=5 t=2.28e-04 per=1.24e+01 cost=6.78e+03 flops=2.98e+07
 sigma counter=123 i=6 t=2.45e-04 per=1.34e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=123 i=7 t=2.34e-04 per=1.28e+01 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.90e+04 flops=4.31e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.29e-01 t_reduction=2.35e-02 tot=2.52e-01 ---
 sigma_tot counter=123 i=0 t=2.85e-02 per=1.24e+01 cost=6.90e+05 flops=2.42e+07
 sigma_tot counter=123 i=1 t=2.84e-02 per=1.24e+01 cost=7.02e+05 flops=2.47e+07
 sigma_tot counter=123 i=2 t=2.85e-02 per=1.24e+01 cost=6.99e+05 flops=2.46e+07
 sigma_tot counter=123 i=3 t=2.84e-02 per=1.24e+01 cost=7.06e+05 flops=2.49e+07
 sigma_tot counter=123 i=4 t=2.81e-02 per=1.23e+01 cost=1.09e+06 flops=3.89e+07
 sigma_tot counter=123 i=5 t=2.86e-02 per=1.25e+01 cost=1.09e+06 flops=3.82e+07
 sigma_tot counter=123 i=6 t=2.98e-02 per=1.30e+01 cost=1.43e+06 flops=4.79e+07
 sigma_tot counter=123 i=7 t=2.86e-02 per=1.25e+01 cost=1.42e+06 flops=4.97e+07
 total GEMM cost=7.83e+06 flops=3.42e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.34e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.78e-04 tot=2.00e-03 ---
 sigma counter=124 i=0 t=2.26e-04 per=1.24e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=124 i=1 t=2.22e-04 per=1.22e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=124 i=2 t=2.30e-04 per=1.26e+01 cost=7.01e+03 flops=3.05e+07
 sigma counter=124 i=3 t=2.26e-04 per=1.24e+01 cost=6.99e+03 flops=3.09e+07
 sigma counter=124 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=124 i=5 t=2.25e-04 per=1.24e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=124 i=6 t=2.43e-04 per=1.34e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=124 i=7 t=2.30e-04 per=1.26e+01 cost=1.89e+04 flops=8.22e+07
 total GEMM cost=7.90e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.31e-01 t_reduction=2.37e-02 tot=2.54e-01 ---
 sigma_tot counter=124 i=0 t=2.87e-02 per=1.24e+01 cost=6.97e+05 flops=2.43e+07
 sigma_tot counter=124 i=1 t=2.86e-02 per=1.24e+01 cost=7.09e+05 flops=2.47e+07
 sigma_tot counter=124 i=2 t=2.87e-02 per=1.24e+01 cost=7.06e+05 flops=2.46e+07
 sigma_tot counter=124 i=3 t=2.86e-02 per=1.24e+01 cost=7.13e+05 flops=2.49e+07
 sigma_tot counter=124 i=4 t=2.83e-02 per=1.23e+01 cost=1.10e+06 flops=3.89e+07
 sigma_tot counter=124 i=5 t=2.88e-02 per=1.25e+01 cost=1.10e+06 flops=3.81e+07
 sigma_tot counter=124 i=6 t=3.01e-02 per=1.30e+01 cost=1.45e+06 flops=4.81e+07
 sigma_tot counter=124 i=7 t=2.88e-02 per=1.25e+01 cost=1.44e+06 flops=4.99e+07
 total GEMM cost=7.91e+06 flops=3.43e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   2.56e-02  2.13e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   2.56e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.83e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.82e-04 tot=2.01e-03 ---
 sigma counter=125 i=0 t=2.27e-04 per=1.24e+01 cost=6.81e+03 flops=3.00e+07
 sigma counter=125 i=1 t=2.25e-04 per=1.23e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=125 i=2 t=2.22e-04 per=1.22e+01 cost=7.01e+03 flops=3.16e+07
 sigma counter=125 i=3 t=2.37e-04 per=1.30e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=125 i=4 t=2.18e-04 per=1.19e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=125 i=5 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=125 i=6 t=2.43e-04 per=1.33e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=125 i=7 t=2.30e-04 per=1.26e+01 cost=1.89e+04 flops=8.22e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.33e-01 t_reduction=2.39e-02 tot=2.56e-01 ---
 sigma_tot counter=125 i=0 t=2.89e-02 per=1.24e+01 cost=7.04e+05 flops=2.43e+07
 sigma_tot counter=125 i=1 t=2.89e-02 per=1.24e+01 cost=7.16e+05 flops=2.48e+07
 sigma_tot counter=125 i=2 t=2.89e-02 per=1.24e+01 cost=7.13e+05 flops=2.47e+07
 sigma_tot counter=125 i=3 t=2.88e-02 per=1.24e+01 cost=7.20e+05 flops=2.50e+07
 sigma_tot counter=125 i=4 t=2.86e-02 per=1.23e+01 cost=1.11e+06 flops=3.88e+07
 sigma_tot counter=125 i=5 t=2.90e-02 per=1.25e+01 cost=1.11e+06 flops=3.81e+07
 sigma_tot counter=125 i=6 t=3.03e-02 per=1.30e+01 cost=1.47e+06 flops=4.84e+07
 sigma_tot counter=125 i=7 t=2.91e-02 per=1.25e+01 cost=1.46e+06 flops=5.02e+07
 total GEMM cost=7.99e+06 flops=3.44e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.81e-03,1.86e-04 cost=7.90e+04 flops[gemm]=4.37e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.86e-04 tot=1.99e-03 ---
 sigma counter=126 i=0 t=2.22e-04 per=1.23e+01 cost=6.81e+03 flops=3.07e+07
 sigma counter=126 i=1 t=2.22e-04 per=1.23e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=126 i=2 t=2.21e-04 per=1.22e+01 cost=7.01e+03 flops=3.17e+07
 sigma counter=126 i=3 t=2.27e-04 per=1.26e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=126 i=4 t=2.17e-04 per=1.20e+01 cost=6.81e+03 flops=3.14e+07
 sigma counter=126 i=5 t=2.23e-04 per=1.23e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=126 i=6 t=2.44e-04 per=1.35e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=126 i=7 t=2.32e-04 per=1.28e+01 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.90e+04 flops=4.37e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.34e-01 t_reduction=2.41e-02 tot=2.58e-01 ---
 sigma_tot counter=126 i=0 t=2.92e-02 per=1.24e+01 cost=7.11e+05 flops=2.44e+07
 sigma_tot counter=126 i=1 t=2.91e-02 per=1.24e+01 cost=7.22e+05 flops=2.48e+07
 sigma_tot counter=126 i=2 t=2.92e-02 per=1.24e+01 cost=7.20e+05 flops=2.47e+07
 sigma_tot counter=126 i=3 t=2.90e-02 per=1.24e+01 cost=7.27e+05 flops=2.50e+07
 sigma_tot counter=126 i=4 t=2.88e-02 per=1.23e+01 cost=1.12e+06 flops=3.88e+07
 sigma_tot counter=126 i=5 t=2.93e-02 per=1.25e+01 cost=1.11e+06 flops=3.80e+07
 sigma_tot counter=126 i=6 t=3.06e-02 per=1.30e+01 cost=1.49e+06 flops=4.86e+07
 sigma_tot counter=126 i=7 t=2.93e-02 per=1.25e+01 cost=1.48e+06 flops=5.04e+07
 total GEMM cost=8.07e+06 flops=3.44e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   2.98e-02  2.13e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   2.98e-02  2.13e-03
TIMING for Davidson : 2.99e-02  T(cal/comm/rest)=2.95e-02,5.29e-07,3.46e-04
optimized energies: isweep=2 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.995e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000549 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.6e-05,0.000246,0.000246 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.000995,0.000172 cost=2.78e+04 flops[gemm]=2.79e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.000994 t_reduction=0.000172 tot=0.00117 ---
 renorm counter=11 i=0 t=0.000196 per=19.7 cost=1.82e+03 flops=9.3e+06
 renorm counter=11 i=1 t=0.000198 per=19.9 cost=3.23e+03 flops=1.63e+07
 renorm counter=11 i=2 t=0.000187 per=18.8 cost=1.91e+03 flops=1.02e+07
 renorm counter=11 i=3 t=0.000194 per=19.5 cost=3.14e+03 flops=1.62e+07
 renorm counter=11 i=4 t=1e-06 per=0.101 cost=0 flops=0
 renorm counter=11 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=11 i=6 t=0.000218 per=21.9 cost=1.77e+04 flops=8.12e+07
 total GEMM cost=2.78e+04 flops=2.8e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0114 t_reduction=0.00199 tot=0.0134 ---
 renorm_tot counter=11 i=0 t=0.0023 per=20.1 cost=3.67e+04 flops=1.6e+07
 renorm_tot counter=11 i=1 t=0.00223 per=19.5 cost=5.08e+04 flops=2.28e+07
 renorm_tot counter=11 i=2 t=0.000968 per=8.47 cost=2.64e+04 flops=2.72e+07
 renorm_tot counter=11 i=3 t=0.00101 per=8.85 cost=4.61e+04 flops=4.55e+07
 renorm_tot counter=11 i=4 t=0.00121 per=10.6 cost=4.29e+04 flops=3.54e+07
 renorm_tot counter=11 i=5 t=0.00124 per=10.8 cost=7.43e+04 flops=6.01e+07
 renorm_tot counter=11 i=6 t=0.00248 per=21.7 cost=4.16e+05 flops=1.68e+08
 total GEMM cost=6.93e+05 flops=6.06e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0025 S T(init/kernel/comm)=9.2e-05,0.0024,8.7e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=5.02e-05,3.2e-05,8.22e-05 speed=0.126GB/s disk[used]=9.23e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 3.74e-02 S #####
 T(fetch) = 7.38e-05 S  per =  0.2  per(accum) = 0.2
 T(hdiag) = 7.70e-05 S  per = 0.21  per(accum) = 0.4
 T(dvdsn) = 3.40e-02 S  per =   91  per(accum) = 91
 T(decim) = 8.33e-05 S  per = 0.22  per(accum) = 92
 T(guess) = 7.96e-05 S  per = 0.21  per(accum) = 92
 T(renrm) = 2.55e-03 S  per =  6.8  per(accum) = 99
 T(save ) = 5.36e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.39e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.01e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.24e-04 S  per = 0.66  per(accum) = 0.78
 T(hintermediate init           ) = 1.89e-04 S  per = 0.56  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.01  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 2.26e-03 S  per =  6.7  per(accum) = 8
 T(hmmtasks init                ) = 1.29e-03 S  per =  3.8  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 2.95e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 5.29e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.46e-04 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.51e-03 S
 T(qops init                    ) = 9.16e-05 S  per =  3.7  per(accum) = 3.7
 T(qops_dict memcpy cpu2gpu     ) = 2.76e-05 S  per =  1.1  per(accum) = 4.8
 T(symbolic_formulae_renorm     ) = 2.04e-04 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.16e-05 S  per = 0.46  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.63e-06 S  per = 0.18  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 5.58e-04 S  per =   22  per(accum) = 36
 T(rmmtasks init                ) = 3.29e-04 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 8.49e-06 S  per = 0.34  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.24e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.69e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.71e-06 S  per = 0.35  per(accum) = 1e+02
##### time_sweep: 8.52e-02 S #####
 T(fetch) = 4.56e-04 S  per = 0.54  per(accum) = 0.54
 T(hdiag) = 2.16e-04 S  per = 0.25  per(accum) = 0.79
 T(dvdsn) = 7.43e-02 S  per =   87  per(accum) = 88
 T(decim) = 4.76e-04 S  per = 0.56  per(accum) = 89
 T(guess) = 2.37e-04 S  per = 0.28  per(accum) = 89
 T(renrm) = 7.85e-03 S  per =  9.2  per(accum) = 98
 T(save ) = 1.62e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 7.38e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.17e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 6.86e-04 S  per = 0.93  per(accum) = 1.1
 T(hintermediate init           ) = 5.78e-04 S  per = 0.78  per(accum) = 1.9
 T(hintermediates memcpy cpu2gpu) = 1.07e-05 S  per = 0.014  per(accum) = 1.9
 T(preprocess_hformulae_Hxlist2 ) = 6.74e-03 S  per =  9.1  per(accum) = 11
 T(hmmtasks init                ) = 3.87e-03 S  per =  5.2  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 6.11e-02 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 1.17e-06 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.18e-04 S  per = 0.97  per(accum) = 1e+02
Detailed decomposition of T(renrm): 7.71e-03 S
 T(qops init                    ) = 2.59e-04 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 8.91e-05 S  per =  1.2  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 5.80e-04 S  per =  7.5  per(accum) = 12
 T(rintermediate init           ) = 2.26e-04 S  per =  2.9  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.37e-05 S  per = 0.18  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 1.65e-03 S  per =   21  per(accum) = 37
 T(rmmtasks init                ) = 1.02e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 2.44e-05 S  per = 0.32  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 3.74e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.05e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.60e-05 S  per = 0.34  per(accum) = 1e+02
##### time_global: 3.77e-01 S #####
 T(fetch) = 3.18e-03 S  per = 0.84  per(accum) = 0.84
 T(hdiag) = 1.05e-03 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 3.31e-01 S  per =   88  per(accum) = 89
 T(decim) = 2.81e-03 S  per = 0.74  per(accum) = 90
 T(guess) = 9.71e-04 S  per = 0.26  per(accum) = 90
 T(renrm) = 3.10e-02 S  per =  8.2  per(accum) = 98
 T(save ) = 6.66e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.29e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 4.62e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 3.37e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 2.43e-03 S  per = 0.74  per(accum) = 1.9
 T(hintermediates memcpy cpu2gpu) = 5.32e-05 S  per = 0.016  per(accum) = 1.9
 T(preprocess_hformulae_Hxlist2 ) = 2.83e-02 S  per =  8.6  per(accum) = 11
 T(hmmtasks init                ) = 1.65e-02 S  per =    5  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 2.74e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 6.28e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.69e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.04e-02 S
 T(qops init                    ) = 1.32e-03 S  per =  4.3  per(accum) = 4.3
 T(qops_dict memcpy cpu2gpu     ) = 4.02e-04 S  per =  1.3  per(accum) = 5.7
 T(symbolic_formulae_renorm     ) = 2.61e-03 S  per =  8.6  per(accum) = 14
 T(rintermediate init           ) = 1.14e-03 S  per =  3.8  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 6.20e-05 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 6.09e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.87e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 1.00e-04 S  per = 0.33  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.44e-02 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.35e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.15e-04 S  per = 0.38  per(accum) = 1e+02

isweep=2 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.426e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47c76690
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.194e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000154 flops=2.87e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.888e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.4e-05,0.000951,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.4e-05,0.00184,0.000177 cost=7.9e+04 flops[gemm]=4.29e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00184 t_reduction=0.000177 tot=0.00202 ---
 sigma counter=127 i=0 t=0.000227 per=12.3 cost=7.01e+03 flops=3.09e+07
 sigma counter=127 i=1 t=0.00024 per=13 cost=6.99e+03 flops=2.91e+07
 sigma counter=127 i=2 t=0.000228 per=12.4 cost=6.81e+03 flops=2.99e+07
 sigma counter=127 i=3 t=0.000224 per=12.2 cost=6.78e+03 flops=3.03e+07
 sigma counter=127 i=4 t=0.000231 per=12.6 cost=1.89e+04 flops=8.18e+07
 sigma counter=127 i=5 t=0.000237 per=12.9 cost=1.89e+04 flops=7.97e+07
 sigma counter=127 i=6 t=0.000233 per=12.7 cost=6.78e+03 flops=2.91e+07
 sigma counter=127 i=7 t=0.00022 per=12 cost=6.81e+03 flops=3.1e+07
 total GEMM cost=7.9e+04 flops=4.29e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.236 t_reduction=0.0242 tot=0.26 ---
 sigma_tot counter=127 i=0 t=0.0294 per=12.4 cost=7.18e+05 flops=2.44e+07
 sigma_tot counter=127 i=1 t=0.0293 per=12.4 cost=7.29e+05 flops=2.49e+07
 sigma_tot counter=127 i=2 t=0.0294 per=12.4 cost=7.27e+05 flops=2.47e+07
 sigma_tot counter=127 i=3 t=0.0293 per=12.4 cost=7.33e+05 flops=2.51e+07
 sigma_tot counter=127 i=4 t=0.029 per=12.3 cost=1.13e+06 flops=3.91e+07
 sigma_tot counter=127 i=5 t=0.0295 per=12.5 cost=1.13e+06 flops=3.83e+07
 sigma_tot counter=127 i=6 t=0.0308 per=13 cost=1.49e+06 flops=4.85e+07
 sigma_tot counter=127 i=7 t=0.0295 per=12.5 cost=1.48e+06 flops=5.03e+07
 total GEMM cost=8.15e+06 flops=3.45e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.6e-05,0.00185,0.000179 cost=7.9e+04 flops[gemm]=4.28e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00185 t_reduction=0.000179 tot=0.00203 ---
 sigma counter=128 i=0 t=0.000226 per=12.2 cost=7.01e+03 flops=3.1e+07
 sigma counter=128 i=1 t=0.000238 per=12.9 cost=6.99e+03 flops=2.94e+07
 sigma counter=128 i=2 t=0.000229 per=12.4 cost=6.81e+03 flops=2.98e+07
 sigma counter=128 i=3 t=0.00023 per=12.5 cost=6.78e+03 flops=2.95e+07
 sigma counter=128 i=4 t=0.000237 per=12.8 cost=1.89e+04 flops=7.97e+07
 sigma counter=128 i=5 t=0.000237 per=12.8 cost=1.89e+04 flops=7.97e+07
 sigma counter=128 i=6 t=0.000229 per=12.4 cost=6.78e+03 flops=2.96e+07
 sigma counter=128 i=7 t=0.000221 per=12 cost=6.81e+03 flops=3.08e+07
 total GEMM cost=7.9e+04 flops=4.28e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.238 t_reduction=0.0244 tot=0.262 ---
 sigma_tot counter=128 i=0 t=0.0296 per=12.4 cost=7.25e+05 flops=2.45e+07
 sigma_tot counter=128 i=1 t=0.0296 per=12.4 cost=7.36e+05 flops=2.49e+07
 sigma_tot counter=128 i=2 t=0.0296 per=12.4 cost=7.34e+05 flops=2.48e+07
 sigma_tot counter=128 i=3 t=0.0295 per=12.4 cost=7.4e+05 flops=2.51e+07
 sigma_tot counter=128 i=4 t=0.0292 per=12.3 cost=1.15e+06 flops=3.94e+07
 sigma_tot counter=128 i=5 t=0.0297 per=12.5 cost=1.15e+06 flops=3.87e+07
 sigma_tot counter=128 i=6 t=0.031 per=13 cost=1.5e+06 flops=4.83e+07
 sigma_tot counter=128 i=7 t=0.0297 per=12.5 cost=1.49e+06 flops=5.01e+07
 total GEMM cost=8.23e+06 flops=3.46e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.29e-03  2.14e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.29e-03  2.14e-03
TIMING for Davidson : 4.30e-03  T(cal/comm/rest)=4.26e-03,8.50e-08,4.25e-05
optimized energies: isweep=2 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.731e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000151 flops=2.92e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 1.864e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000536 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.49e-05,0.000237,0.000255 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00101,0.000172 cost=1.55e+05 flops[gemm]=1.53e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00101 t_reduction=0.000172 tot=0.00118 ---
 renorm counter=12 i=0 t=0.000194 per=19.2 cost=5.64e+03 flops=2.91e+07
 renorm counter=12 i=1 t=0.000199 per=19.7 cost=1.13e+04 flops=5.66e+07
 renorm counter=12 i=2 t=0.000193 per=19.1 cost=1.66e+04 flops=8.58e+07
 renorm counter=12 i=3 t=0.000203 per=20.1 cost=2.89e+04 flops=1.42e+08
 renorm counter=12 i=4 t=1e-06 per=0.099 cost=0 flops=0
 renorm counter=12 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=12 i=6 t=0.00022 per=21.8 cost=9.22e+04 flops=4.19e+08
 total GEMM cost=1.55e+05 flops=1.53e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0124 t_reduction=0.00216 tot=0.0146 ---
 renorm_tot counter=12 i=0 t=0.00249 per=20 cost=4.23e+04 flops=1.7e+07
 renorm_tot counter=12 i=1 t=0.00243 per=19.5 cost=6.2e+04 flops=2.56e+07
 renorm_tot counter=12 i=2 t=0.00116 per=9.33 cost=4.29e+04 flops=3.7e+07
 renorm_tot counter=12 i=3 t=0.00122 per=9.76 cost=7.5e+04 flops=6.17e+07
 renorm_tot counter=12 i=4 t=0.00121 per=9.75 cost=4.29e+04 flops=3.53e+07
 renorm_tot counter=12 i=5 t=0.00124 per=9.94 cost=7.43e+04 flops=6.01e+07
 renorm_tot counter=12 i=6 t=0.0027 per=21.7 cost=5.09e+05 flops=1.88e+08
 total GEMM cost=8.48e+05 flops=6.81e+07
check ||H-H.dagger||=5.62e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=7.5e-05,0.0026,8.2e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=5.04e-05,4.09e-05,9.12e-05 speed=0.212GB/s disk[used]=9.37e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.25e-02 S #####
 T(fetch) = 3.17e-04 S  per =  2.5  per(accum) = 2.5
 T(hdiag) = 7.11e-05 S  per = 0.57  per(accum) = 3.1
 T(dvdsn) = 8.47e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.29e-04 S  per =  2.6  per(accum) = 73
 T(guess) = 7.60e-05 S  per = 0.61  per(accum) = 74
 T(renrm) = 2.72e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.44e-04 S  per =  4.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.28e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.82e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.24e-04 S  per =  2.7  per(accum) = 3.2
 T(hintermediate init           ) = 1.92e-04 S  per =  2.3  per(accum) = 5.5
 T(hintermediates memcpy cpu2gpu) = 3.58e-06 S  per = 0.043  per(accum) = 5.5
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =   27  per(accum) = 33
 T(hmmtasks init                ) = 1.28e-03 S  per =   15  per(accum) = 48
 T(dvdson solver [Hx_batchGPU]  ) = 4.26e-03 S  per =   51  per(accum) = 99
 T(dvdson solver [communication]) = 8.50e-08 S  per = 0.001  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.25e-05 S  per = 0.51  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.67e-03 S
 T(qops init                    ) = 7.47e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.40e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.77e-04 S  per =  6.6  per(accum) = 11
 T(rintermediate init           ) = 1.90e-04 S  per =  7.1  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.30e-06 S  per = 0.16  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.46e-04 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.47e-04 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 7.85e-06 S  per = 0.29  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.25e-03 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.62e-05 S  per = 0.98  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.24e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 9.77e-02 S #####
 T(fetch) = 7.74e-04 S  per = 0.79  per(accum) = 0.79
 T(hdiag) = 2.87e-04 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 8.28e-02 S  per =   85  per(accum) = 86
 T(decim) = 8.05e-04 S  per = 0.82  per(accum) = 87
 T(guess) = 3.13e-04 S  per = 0.32  per(accum) = 87
 T(renrm) = 1.06e-02 S  per =   11  per(accum) = 98
 T(save ) = 2.16e-03 S  per =  2.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.21e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.55e-04 S  per = 0.19  per(accum) = 0.19
 T(symbolic_formulae_twodot     ) = 9.10e-04 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 7.70e-04 S  per = 0.94  per(accum) = 2.2
 T(hintermediates memcpy cpu2gpu) = 1.42e-05 S  per = 0.017  per(accum) = 2.3
 T(preprocess_hformulae_Hxlist2 ) = 8.98e-03 S  per =   11  per(accum) = 13
 T(hmmtasks init                ) = 5.15e-03 S  per =  6.3  per(accum) = 19
 T(dvdson solver [Hx_batchGPU]  ) = 6.54e-02 S  per =   80  per(accum) = 99
 T(dvdson solver [communication]) = 1.26e-06 S  per = 0.0015  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.60e-04 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.04e-02 S
 T(qops init                    ) = 3.33e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 1.23e-04 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 7.58e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 4.16e-04 S  per =    4  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 1.80e-05 S  per = 0.17  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 2.19e-03 S  per =   21  per(accum) = 37
 T(rmmtasks init                ) = 1.37e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 3.22e-05 S  per = 0.31  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 4.99e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.07e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.42e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 3.89e-01 S #####
 T(fetch) = 3.50e-03 S  per =  0.9  per(accum) = 0.9
 T(hdiag) = 1.12e-03 S  per = 0.29  per(accum) = 1.2
 T(dvdsn) = 3.40e-01 S  per =   87  per(accum) = 88
 T(decim) = 3.14e-03 S  per = 0.81  per(accum) = 89
 T(guess) = 1.05e-03 S  per = 0.27  per(accum) = 89
 T(renrm) = 3.37e-02 S  per =  8.7  per(accum) = 98
 T(save ) = 7.20e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.37e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 5.00e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 3.60e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 2.62e-03 S  per = 0.78  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 5.67e-05 S  per = 0.017  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 3.06e-02 S  per =  9.1  per(accum) = 11
 T(hmmtasks init                ) = 1.78e-02 S  per =  5.3  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 2.78e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 6.36e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.73e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.31e-02 S
 T(qops init                    ) = 1.39e-03 S  per =  4.2  per(accum) = 4.2
 T(qops_dict memcpy cpu2gpu     ) = 4.36e-04 S  per =  1.3  per(accum) = 5.5
 T(symbolic_formulae_renorm     ) = 2.79e-03 S  per =  8.4  per(accum) = 14
 T(rintermediate init           ) = 1.33e-03 S  per =    4  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 6.63e-05 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 6.64e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 4.21e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 1.08e-04 S  per = 0.33  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.56e-02 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.61e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.23e-04 S  per = 0.37  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=2
----------------------------------------------------------------------
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.035
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.012
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.037
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60478874633e-09
 sweep energies: isweep=2 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=2 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.64e-01 | 1.64e-01 | 0.00e+00 1.04e-01 1.06e-02 1.15e-01 69.9
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.31e-01 | 2.95e-01 | 0.00e+00 1.90e-01 2.03e-02 2.10e-01 71.3
            2  2      20 1.00e-04 0.00e+00 | 31 | 9.89e-02 | 3.94e-01 | 0.00e+00 2.50e-01 2.66e-02 2.77e-01 70.4
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.63e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep2.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=+0.000e+00 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep2.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.71e-15
 idx=3 node=(1,0) Drow=8 maxdiff=6.31e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.03e-16
stensor2: wf2 own=1 _data=0x483dc7b0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x483dc7b0
     -1.0000e+00      -2.6438e-17 
      3.3408e-17      -1.0000e+00 
 rwfuns: nroots=2 maxdiff=9.8580e-18
----- TIMING FOR ctns::rcanon_check : 8.052e-05 S -----
..... end of isweep = 2 .....

======================================================================
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=3 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.051e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x48466550
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.265e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000164 flops=2.69e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.002e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.59e-05,0.000947,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.6e-05,0.00182,0.000179 cost=7.9e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00182 t_reduction=0.000179 tot=0.002 ---
 sigma counter=129 i=0 t=0.000226 per=12.4 cost=7.01e+03 flops=3.1e+07
 sigma counter=129 i=1 t=0.000232 per=12.7 cost=6.99e+03 flops=3.01e+07
 sigma counter=129 i=2 t=0.000219 per=12 cost=6.81e+03 flops=3.11e+07
 sigma counter=129 i=3 t=0.000224 per=12.3 cost=6.78e+03 flops=3.03e+07
 sigma counter=129 i=4 t=0.000233 per=12.8 cost=1.89e+04 flops=8.11e+07
 sigma counter=129 i=5 t=0.000237 per=13 cost=1.89e+04 flops=7.97e+07
 sigma counter=129 i=6 t=0.000231 per=12.7 cost=6.78e+03 flops=2.94e+07
 sigma counter=129 i=7 t=0.000221 per=12.1 cost=6.81e+03 flops=3.08e+07
 total GEMM cost=7.9e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.24 t_reduction=0.0246 tot=0.264 ---
 sigma_tot counter=129 i=0 t=0.0298 per=12.4 cost=7.32e+05 flops=2.45e+07
 sigma_tot counter=129 i=1 t=0.0298 per=12.4 cost=7.43e+05 flops=2.49e+07
 sigma_tot counter=129 i=2 t=0.0298 per=12.4 cost=7.41e+05 flops=2.48e+07
 sigma_tot counter=129 i=3 t=0.0297 per=12.4 cost=7.47e+05 flops=2.51e+07
 sigma_tot counter=129 i=4 t=0.0295 per=12.3 cost=1.17e+06 flops=3.98e+07
 sigma_tot counter=129 i=5 t=0.03 per=12.5 cost=1.17e+06 flops=3.9e+07
 sigma_tot counter=129 i=6 t=0.0312 per=13 cost=1.51e+06 flops=4.82e+07
 sigma_tot counter=129 i=7 t=0.03 per=12.5 cost=1.5e+06 flops=5e+07
 total GEMM cost=8.31e+06 flops=3.46e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.6e-05,0.00183,0.000181 cost=7.9e+04 flops[gemm]=4.31e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00183 t_reduction=0.000181 tot=0.00202 ---
 sigma counter=130 i=0 t=0.000226 per=12.3 cost=7.01e+03 flops=3.1e+07
 sigma counter=130 i=1 t=0.000228 per=12.4 cost=6.99e+03 flops=3.06e+07
 sigma counter=130 i=2 t=0.000227 per=12.4 cost=6.81e+03 flops=3e+07
 sigma counter=130 i=3 t=0.000222 per=12.1 cost=6.78e+03 flops=3.06e+07
 sigma counter=130 i=4 t=0.000232 per=12.6 cost=1.89e+04 flops=8.14e+07
 sigma counter=130 i=5 t=0.000242 per=13.2 cost=1.89e+04 flops=7.81e+07
 sigma counter=130 i=6 t=0.000231 per=12.6 cost=6.78e+03 flops=2.94e+07
 sigma counter=130 i=7 t=0.000226 per=12.3 cost=6.81e+03 flops=3.02e+07
 total GEMM cost=7.9e+04 flops=4.31e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.242 t_reduction=0.0248 tot=0.266 ---
 sigma_tot counter=130 i=0 t=0.0301 per=12.4 cost=7.39e+05 flops=2.46e+07
 sigma_tot counter=130 i=1 t=0.03 per=12.4 cost=7.5e+05 flops=2.5e+07
 sigma_tot counter=130 i=2 t=0.0301 per=12.4 cost=7.48e+05 flops=2.49e+07
 sigma_tot counter=130 i=3 t=0.0299 per=12.4 cost=7.54e+05 flops=2.52e+07
 sigma_tot counter=130 i=4 t=0.0297 per=12.3 cost=1.19e+06 flops=4.01e+07
 sigma_tot counter=130 i=5 t=0.0302 per=12.5 cost=1.19e+06 flops=3.93e+07
 sigma_tot counter=130 i=6 t=0.0315 per=13 cost=1.51e+06 flops=4.8e+07
 sigma_tot counter=130 i=7 t=0.0302 per=12.5 cost=1.5e+06 flops=4.98e+07
 total GEMM cost=8.38e+06 flops=3.47e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   4.26e-03  2.13e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   4.26e-03  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.70e-05,1.84e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.30e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.84e-03 t_reduction=1.78e-04 tot=2.01e-03 ---
 sigma counter=131 i=0 t=2.30e-04 per=1.25e+01 cost=7.01e+03 flops=3.05e+07
 sigma counter=131 i=1 t=2.25e-04 per=1.22e+01 cost=6.99e+03 flops=3.11e+07
 sigma counter=131 i=2 t=2.26e-04 per=1.23e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=131 i=3 t=2.27e-04 per=1.24e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=131 i=4 t=2.40e-04 per=1.31e+01 cost=1.89e+04 flops=7.87e+07
 sigma counter=131 i=5 t=2.38e-04 per=1.30e+01 cost=1.89e+04 flops=7.94e+07
 sigma counter=131 i=6 t=2.31e-04 per=1.26e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=131 i=7 t=2.20e-04 per=1.20e+01 cost=6.81e+03 flops=3.10e+07
 total GEMM cost=7.90e+04 flops=4.30e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.44e-01 t_reduction=2.50e-02 tot=2.68e-01 ---
 sigma_tot counter=131 i=0 t=3.03e-02 per=1.24e+01 cost=7.46e+05 flops=2.46e+07
 sigma_tot counter=131 i=1 t=3.03e-02 per=1.24e+01 cost=7.57e+05 flops=2.50e+07
 sigma_tot counter=131 i=2 t=3.03e-02 per=1.24e+01 cost=7.54e+05 flops=2.49e+07
 sigma_tot counter=131 i=3 t=3.02e-02 per=1.24e+01 cost=7.61e+05 flops=2.52e+07
 sigma_tot counter=131 i=4 t=2.99e-02 per=1.23e+01 cost=1.21e+06 flops=4.04e+07
 sigma_tot counter=131 i=5 t=3.04e-02 per=1.25e+01 cost=1.21e+06 flops=3.96e+07
 sigma_tot counter=131 i=6 t=3.17e-02 per=1.30e+01 cost=1.52e+06 flops=4.79e+07
 sigma_tot counter=131 i=7 t=3.04e-02 per=1.25e+01 cost=1.51e+06 flops=4.97e+07
 total GEMM cost=8.46e+06 flops=3.48e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.81e-04 tot=2.01e-03 ---
 sigma counter=132 i=0 t=2.27e-04 per=1.24e+01 cost=7.01e+03 flops=3.09e+07
 sigma counter=132 i=1 t=2.25e-04 per=1.23e+01 cost=6.99e+03 flops=3.11e+07
 sigma counter=132 i=2 t=2.21e-04 per=1.21e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=132 i=3 t=2.22e-04 per=1.21e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=132 i=4 t=2.38e-04 per=1.30e+01 cost=1.89e+04 flops=7.94e+07
 sigma counter=132 i=5 t=2.46e-04 per=1.34e+01 cost=1.89e+04 flops=7.68e+07
 sigma counter=132 i=6 t=2.32e-04 per=1.27e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=132 i=7 t=2.19e-04 per=1.20e+01 cost=6.81e+03 flops=3.11e+07
 total GEMM cost=7.90e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.45e-01 t_reduction=2.51e-02 tot=2.70e-01 ---
 sigma_tot counter=132 i=0 t=3.05e-02 per=1.24e+01 cost=7.53e+05 flops=2.46e+07
 sigma_tot counter=132 i=1 t=3.05e-02 per=1.24e+01 cost=7.64e+05 flops=2.51e+07
 sigma_tot counter=132 i=2 t=3.05e-02 per=1.24e+01 cost=7.61e+05 flops=2.50e+07
 sigma_tot counter=132 i=3 t=3.04e-02 per=1.24e+01 cost=7.67e+05 flops=2.52e+07
 sigma_tot counter=132 i=4 t=3.02e-02 per=1.23e+01 cost=1.23e+06 flops=4.07e+07
 sigma_tot counter=132 i=5 t=3.07e-02 per=1.25e+01 cost=1.23e+06 flops=3.99e+07
 sigma_tot counter=132 i=6 t=3.19e-02 per=1.30e+01 cost=1.53e+06 flops=4.78e+07
 sigma_tot counter=132 i=7 t=3.06e-02 per=1.25e+01 cost=1.52e+06 flops=4.96e+07
 total GEMM cost=8.54e+06 flops=3.48e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   8.54e-03  2.14e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   8.54e-03  2.14e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.83e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.31e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.78e-04 tot=2.01e-03 ---
 sigma counter=133 i=0 t=2.29e-04 per=1.25e+01 cost=7.01e+03 flops=3.06e+07
 sigma counter=133 i=1 t=2.24e-04 per=1.22e+01 cost=6.99e+03 flops=3.12e+07
 sigma counter=133 i=2 t=2.30e-04 per=1.26e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=133 i=3 t=2.26e-04 per=1.23e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=133 i=4 t=2.34e-04 per=1.28e+01 cost=1.89e+04 flops=8.08e+07
 sigma counter=133 i=5 t=2.35e-04 per=1.28e+01 cost=1.89e+04 flops=8.04e+07
 sigma counter=133 i=6 t=2.28e-04 per=1.25e+01 cost=6.78e+03 flops=2.98e+07
 sigma counter=133 i=7 t=2.25e-04 per=1.23e+01 cost=6.81e+03 flops=3.03e+07
 total GEMM cost=7.90e+04 flops=4.31e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.47e-01 t_reduction=2.53e-02 tot=2.72e-01 ---
 sigma_tot counter=133 i=0 t=3.08e-02 per=1.24e+01 cost=7.60e+05 flops=2.47e+07
 sigma_tot counter=133 i=1 t=3.07e-02 per=1.24e+01 cost=7.71e+05 flops=2.51e+07
 sigma_tot counter=133 i=2 t=3.07e-02 per=1.24e+01 cost=7.68e+05 flops=2.50e+07
 sigma_tot counter=133 i=3 t=3.06e-02 per=1.24e+01 cost=7.74e+05 flops=2.53e+07
 sigma_tot counter=133 i=4 t=3.04e-02 per=1.23e+01 cost=1.25e+06 flops=4.10e+07
 sigma_tot counter=133 i=5 t=3.09e-02 per=1.25e+01 cost=1.24e+06 flops=4.02e+07
 sigma_tot counter=133 i=6 t=3.22e-02 per=1.30e+01 cost=1.53e+06 flops=4.76e+07
 sigma_tot counter=133 i=7 t=3.08e-02 per=1.25e+01 cost=1.52e+06 flops=4.94e+07
 total GEMM cost=8.62e+06 flops=3.49e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.50e-05,1.81e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.36e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.76e-04 tot=1.99e-03 ---
 sigma counter=134 i=0 t=2.24e-04 per=1.24e+01 cost=7.01e+03 flops=3.13e+07
 sigma counter=134 i=1 t=2.22e-04 per=1.23e+01 cost=6.99e+03 flops=3.15e+07
 sigma counter=134 i=2 t=2.27e-04 per=1.25e+01 cost=6.81e+03 flops=3.00e+07
 sigma counter=134 i=3 t=2.21e-04 per=1.22e+01 cost=6.78e+03 flops=3.07e+07
 sigma counter=134 i=4 t=2.30e-04 per=1.27e+01 cost=1.89e+04 flops=8.22e+07
 sigma counter=134 i=5 t=2.35e-04 per=1.30e+01 cost=1.89e+04 flops=8.04e+07
 sigma counter=134 i=6 t=2.29e-04 per=1.26e+01 cost=6.78e+03 flops=2.96e+07
 sigma counter=134 i=7 t=2.23e-04 per=1.23e+01 cost=6.81e+03 flops=3.06e+07
 total GEMM cost=7.90e+04 flops=4.36e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.49e-01 t_reduction=2.55e-02 tot=2.74e-01 ---
 sigma_tot counter=134 i=0 t=3.10e-02 per=1.24e+01 cost=7.67e+05 flops=2.47e+07
 sigma_tot counter=134 i=1 t=3.09e-02 per=1.24e+01 cost=7.78e+05 flops=2.52e+07
 sigma_tot counter=134 i=2 t=3.10e-02 per=1.24e+01 cost=7.75e+05 flops=2.50e+07
 sigma_tot counter=134 i=3 t=3.08e-02 per=1.24e+01 cost=7.81e+05 flops=2.53e+07
 sigma_tot counter=134 i=4 t=3.06e-02 per=1.23e+01 cost=1.27e+06 flops=4.13e+07
 sigma_tot counter=134 i=5 t=3.12e-02 per=1.25e+01 cost=1.26e+06 flops=4.05e+07
 sigma_tot counter=134 i=6 t=3.24e-02 per=1.30e+01 cost=1.54e+06 flops=4.75e+07
 sigma_tot counter=134 i=7 t=3.11e-02 per=1.25e+01 cost=1.53e+06 flops=4.93e+07
 total GEMM cost=8.70e+06 flops=3.49e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   1.28e-02  2.13e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   1.28e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.80e-04 tot=2.00e-03 ---
 sigma counter=135 i=0 t=2.30e-04 per=1.26e+01 cost=7.01e+03 flops=3.05e+07
 sigma counter=135 i=1 t=2.28e-04 per=1.25e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=135 i=2 t=2.27e-04 per=1.25e+01 cost=6.81e+03 flops=3.00e+07
 sigma counter=135 i=3 t=2.22e-04 per=1.22e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=135 i=4 t=2.32e-04 per=1.27e+01 cost=1.89e+04 flops=8.14e+07
 sigma counter=135 i=5 t=2.36e-04 per=1.30e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=135 i=6 t=2.31e-04 per=1.27e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=135 i=7 t=2.16e-04 per=1.19e+01 cost=6.81e+03 flops=3.15e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.51e-01 t_reduction=2.57e-02 tot=2.76e-01 ---
 sigma_tot counter=135 i=0 t=3.12e-02 per=1.24e+01 cost=7.74e+05 flops=2.48e+07
 sigma_tot counter=135 i=1 t=3.12e-02 per=1.24e+01 cost=7.85e+05 flops=2.52e+07
 sigma_tot counter=135 i=2 t=3.12e-02 per=1.24e+01 cost=7.82e+05 flops=2.51e+07
 sigma_tot counter=135 i=3 t=3.11e-02 per=1.24e+01 cost=7.88e+05 flops=2.54e+07
 sigma_tot counter=135 i=4 t=3.09e-02 per=1.23e+01 cost=1.29e+06 flops=4.16e+07
 sigma_tot counter=135 i=5 t=3.14e-02 per=1.25e+01 cost=1.28e+06 flops=4.08e+07
 sigma_tot counter=135 i=6 t=3.26e-02 per=1.30e+01 cost=1.55e+06 flops=4.74e+07
 sigma_tot counter=135 i=7 t=3.13e-02 per=1.25e+01 cost=1.54e+06 flops=4.92e+07
 total GEMM cost=8.78e+06 flops=3.50e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.78e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.78e-04 tot=2.00e-03 ---
 sigma counter=136 i=0 t=2.25e-04 per=1.23e+01 cost=7.01e+03 flops=3.11e+07
 sigma counter=136 i=1 t=2.28e-04 per=1.25e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=136 i=2 t=2.28e-04 per=1.25e+01 cost=6.81e+03 flops=2.99e+07
 sigma counter=136 i=3 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=136 i=4 t=2.33e-04 per=1.28e+01 cost=1.89e+04 flops=8.11e+07
 sigma counter=136 i=5 t=2.35e-04 per=1.29e+01 cost=1.89e+04 flops=8.04e+07
 sigma counter=136 i=6 t=2.35e-04 per=1.29e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=136 i=7 t=2.18e-04 per=1.19e+01 cost=6.81e+03 flops=3.13e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.53e-01 t_reduction=2.59e-02 tot=2.78e-01 ---
 sigma_tot counter=136 i=0 t=3.14e-02 per=1.24e+01 cost=7.81e+05 flops=2.48e+07
 sigma_tot counter=136 i=1 t=3.14e-02 per=1.24e+01 cost=7.92e+05 flops=2.52e+07
 sigma_tot counter=136 i=2 t=3.14e-02 per=1.24e+01 cost=7.88e+05 flops=2.51e+07
 sigma_tot counter=136 i=3 t=3.13e-02 per=1.24e+01 cost=7.94e+05 flops=2.54e+07
 sigma_tot counter=136 i=4 t=3.11e-02 per=1.23e+01 cost=1.30e+06 flops=4.19e+07
 sigma_tot counter=136 i=5 t=3.16e-02 per=1.25e+01 cost=1.30e+06 flops=4.11e+07
 sigma_tot counter=136 i=6 t=3.29e-02 per=1.30e+01 cost=1.55e+06 flops=4.73e+07
 sigma_tot counter=136 i=7 t=3.15e-02 per=1.25e+01 cost=1.55e+06 flops=4.91e+07
 total GEMM cost=8.86e+06 flops=3.51e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.70e-02  2.13e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.70e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.80e-04 tot=2.00e-03 ---
 sigma counter=137 i=0 t=2.28e-04 per=1.25e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=137 i=1 t=2.27e-04 per=1.24e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=137 i=2 t=2.29e-04 per=1.25e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=137 i=3 t=2.24e-04 per=1.23e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=137 i=4 t=2.32e-04 per=1.27e+01 cost=1.89e+04 flops=8.14e+07
 sigma counter=137 i=5 t=2.37e-04 per=1.30e+01 cost=1.89e+04 flops=7.97e+07
 sigma counter=137 i=6 t=2.31e-04 per=1.27e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=137 i=7 t=2.17e-04 per=1.19e+01 cost=6.81e+03 flops=3.14e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.54e-01 t_reduction=2.60e-02 tot=2.80e-01 ---
 sigma_tot counter=137 i=0 t=3.17e-02 per=1.24e+01 cost=7.88e+05 flops=2.49e+07
 sigma_tot counter=137 i=1 t=3.16e-02 per=1.24e+01 cost=7.99e+05 flops=2.53e+07
 sigma_tot counter=137 i=2 t=3.16e-02 per=1.24e+01 cost=7.95e+05 flops=2.51e+07
 sigma_tot counter=137 i=3 t=3.15e-02 per=1.24e+01 cost=8.01e+05 flops=2.54e+07
 sigma_tot counter=137 i=4 t=3.13e-02 per=1.23e+01 cost=1.32e+06 flops=4.22e+07
 sigma_tot counter=137 i=5 t=3.19e-02 per=1.25e+01 cost=1.32e+06 flops=4.14e+07
 sigma_tot counter=137 i=6 t=3.31e-02 per=1.30e+01 cost=1.56e+06 flops=4.71e+07
 sigma_tot counter=137 i=7 t=3.17e-02 per=1.25e+01 cost=1.55e+06 flops=4.89e+07
 total GEMM cost=8.94e+06 flops=3.51e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.75e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.75e-04 tot=2.00e-03 ---
 sigma counter=138 i=0 t=2.30e-04 per=1.26e+01 cost=7.01e+03 flops=3.05e+07
 sigma counter=138 i=1 t=2.23e-04 per=1.22e+01 cost=6.99e+03 flops=3.13e+07
 sigma counter=138 i=2 t=2.24e-04 per=1.23e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=138 i=3 t=2.24e-04 per=1.23e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=138 i=4 t=2.34e-04 per=1.28e+01 cost=1.89e+04 flops=8.08e+07
 sigma counter=138 i=5 t=2.36e-04 per=1.29e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=138 i=6 t=2.30e-04 per=1.26e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=138 i=7 t=2.22e-04 per=1.22e+01 cost=6.81e+03 flops=3.07e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.56e-01 t_reduction=2.62e-02 tot=2.82e-01 ---
 sigma_tot counter=138 i=0 t=3.19e-02 per=1.24e+01 cost=7.95e+05 flops=2.49e+07
 sigma_tot counter=138 i=1 t=3.18e-02 per=1.24e+01 cost=8.06e+05 flops=2.53e+07
 sigma_tot counter=138 i=2 t=3.19e-02 per=1.24e+01 cost=8.02e+05 flops=2.52e+07
 sigma_tot counter=138 i=3 t=3.17e-02 per=1.24e+01 cost=8.08e+05 flops=2.55e+07
 sigma_tot counter=138 i=4 t=3.16e-02 per=1.23e+01 cost=1.34e+06 flops=4.25e+07
 sigma_tot counter=138 i=5 t=3.21e-02 per=1.25e+01 cost=1.34e+06 flops=4.17e+07
 sigma_tot counter=138 i=6 t=3.33e-02 per=1.30e+01 cost=1.57e+06 flops=4.70e+07
 sigma_tot counter=138 i=7 t=3.19e-02 per=1.25e+01 cost=1.56e+06 flops=4.88e+07
 total GEMM cost=9.02e+06 flops=3.52e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   2.13e-02  2.13e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   2.13e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.83e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.82e-04 tot=2.01e-03 ---
 sigma counter=139 i=0 t=2.28e-04 per=1.25e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=139 i=1 t=2.25e-04 per=1.23e+01 cost=6.99e+03 flops=3.11e+07
 sigma counter=139 i=2 t=2.20e-04 per=1.20e+01 cost=6.81e+03 flops=3.10e+07
 sigma counter=139 i=3 t=2.31e-04 per=1.26e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=139 i=4 t=2.36e-04 per=1.29e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=139 i=5 t=2.36e-04 per=1.29e+01 cost=1.89e+04 flops=8.01e+07
 sigma counter=139 i=6 t=2.30e-04 per=1.26e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=139 i=7 t=2.21e-04 per=1.21e+01 cost=6.81e+03 flops=3.08e+07
 total GEMM cost=7.90e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.58e-01 t_reduction=2.64e-02 tot=2.84e-01 ---
 sigma_tot counter=139 i=0 t=3.21e-02 per=1.24e+01 cost=8.02e+05 flops=2.50e+07
 sigma_tot counter=139 i=1 t=3.21e-02 per=1.24e+01 cost=8.13e+05 flops=2.54e+07
 sigma_tot counter=139 i=2 t=3.21e-02 per=1.24e+01 cost=8.09e+05 flops=2.52e+07
 sigma_tot counter=139 i=3 t=3.20e-02 per=1.24e+01 cost=8.15e+05 flops=2.55e+07
 sigma_tot counter=139 i=4 t=3.18e-02 per=1.23e+01 cost=1.36e+06 flops=4.28e+07
 sigma_tot counter=139 i=5 t=3.23e-02 per=1.25e+01 cost=1.36e+06 flops=4.20e+07
 sigma_tot counter=139 i=6 t=3.36e-02 per=1.30e+01 cost=1.57e+06 flops=4.69e+07
 sigma_tot counter=139 i=7 t=3.22e-02 per=1.25e+01 cost=1.57e+06 flops=4.87e+07
 total GEMM cost=9.10e+06 flops=3.52e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.50e-05,1.83e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.89e-04 tot=2.01e-03 ---
 sigma counter=140 i=0 t=2.26e-04 per=1.24e+01 cost=7.01e+03 flops=3.10e+07
 sigma counter=140 i=1 t=2.28e-04 per=1.25e+01 cost=6.99e+03 flops=3.06e+07
 sigma counter=140 i=2 t=2.24e-04 per=1.23e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=140 i=3 t=2.26e-04 per=1.24e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=140 i=4 t=2.33e-04 per=1.28e+01 cost=1.89e+04 flops=8.11e+07
 sigma counter=140 i=5 t=2.33e-04 per=1.28e+01 cost=1.89e+04 flops=8.11e+07
 sigma counter=140 i=6 t=2.31e-04 per=1.27e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=140 i=7 t=2.25e-04 per=1.23e+01 cost=6.81e+03 flops=3.03e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.60e-01 t_reduction=2.66e-02 tot=2.87e-01 ---
 sigma_tot counter=140 i=0 t=3.24e-02 per=1.24e+01 cost=8.09e+05 flops=2.50e+07
 sigma_tot counter=140 i=1 t=3.23e-02 per=1.24e+01 cost=8.20e+05 flops=2.54e+07
 sigma_tot counter=140 i=2 t=3.23e-02 per=1.24e+01 cost=8.16e+05 flops=2.52e+07
 sigma_tot counter=140 i=3 t=3.22e-02 per=1.24e+01 cost=8.22e+05 flops=2.55e+07
 sigma_tot counter=140 i=4 t=3.20e-02 per=1.23e+01 cost=1.38e+06 flops=4.30e+07
 sigma_tot counter=140 i=5 t=3.26e-02 per=1.25e+01 cost=1.38e+06 flops=4.23e+07
 sigma_tot counter=140 i=6 t=3.38e-02 per=1.30e+01 cost=1.58e+06 flops=4.68e+07
 sigma_tot counter=140 i=7 t=3.24e-02 per=1.25e+01 cost=1.57e+06 flops=4.86e+07
 total GEMM cost=9.17e+06 flops=3.53e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   2.56e-02  2.13e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   2.56e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.34e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.79e-04 tot=2.00e-03 ---
 sigma counter=141 i=0 t=2.24e-04 per=1.23e+01 cost=7.01e+03 flops=3.13e+07
 sigma counter=141 i=1 t=2.27e-04 per=1.25e+01 cost=6.99e+03 flops=3.08e+07
 sigma counter=141 i=2 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=141 i=3 t=2.33e-04 per=1.28e+01 cost=6.78e+03 flops=2.91e+07
 sigma counter=141 i=4 t=2.30e-04 per=1.26e+01 cost=1.89e+04 flops=8.22e+07
 sigma counter=141 i=5 t=2.34e-04 per=1.29e+01 cost=1.89e+04 flops=8.08e+07
 sigma counter=141 i=6 t=2.32e-04 per=1.28e+01 cost=6.78e+03 flops=2.92e+07
 sigma counter=141 i=7 t=2.21e-04 per=1.21e+01 cost=6.81e+03 flops=3.08e+07
 total GEMM cost=7.90e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.62e-01 t_reduction=2.68e-02 tot=2.89e-01 ---
 sigma_tot counter=141 i=0 t=3.26e-02 per=1.24e+01 cost=8.16e+05 flops=2.50e+07
 sigma_tot counter=141 i=1 t=3.25e-02 per=1.24e+01 cost=8.27e+05 flops=2.54e+07
 sigma_tot counter=141 i=2 t=3.25e-02 per=1.24e+01 cost=8.22e+05 flops=2.53e+07
 sigma_tot counter=141 i=3 t=3.24e-02 per=1.24e+01 cost=8.28e+05 flops=2.55e+07
 sigma_tot counter=141 i=4 t=3.23e-02 per=1.23e+01 cost=1.40e+06 flops=4.33e+07
 sigma_tot counter=141 i=5 t=3.28e-02 per=1.25e+01 cost=1.40e+06 flops=4.25e+07
 sigma_tot counter=141 i=6 t=3.40e-02 per=1.30e+01 cost=1.59e+06 flops=4.67e+07
 sigma_tot counter=141 i=7 t=3.26e-02 per=1.25e+01 cost=1.58e+06 flops=4.84e+07
 total GEMM cost=9.25e+06 flops=3.54e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   2.77e-02  2.13e-03
    7   1 +      -2.436977447171  -3.11e-15   7.42e-05    5    13   2.77e-02  2.13e-03
TIMING for Davidson : 2.77e-02  T(cal/comm/rest)=2.74e-02,5.64e-07,3.35e-04
optimized energies: isweep=3 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.985e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000551 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.72e-05,0.000225,0.000269 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.001,0.000175 cost=2.78e+04 flops[gemm]=2.77e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.001 t_reduction=0.000175 tot=0.00118 ---
 renorm counter=13 i=0 t=0.000199 per=19.8 cost=2.19e+03 flops=1.1e+07
 renorm counter=13 i=1 t=0.000195 per=19.4 cost=2.85e+03 flops=1.46e+07
 renorm counter=13 i=2 t=1e-06 per=0.0997 cost=0 flops=0
 renorm counter=13 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=13 i=4 t=0.000192 per=19.1 cost=2.11e+03 flops=1.1e+07
 renorm counter=13 i=5 t=0.000194 per=19.3 cost=2.94e+03 flops=1.51e+07
 renorm counter=13 i=6 t=0.000222 per=22.1 cost=1.77e+04 flops=7.97e+07
 total GEMM cost=2.78e+04 flops=2.77e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0134 t_reduction=0.00234 tot=0.0158 ---
 renorm_tot counter=13 i=0 t=0.00269 per=20 cost=4.45e+04 flops=1.66e+07
 renorm_tot counter=13 i=1 t=0.00262 per=19.5 cost=6.49e+04 flops=2.47e+07
 renorm_tot counter=13 i=2 t=0.00116 per=8.64 cost=4.29e+04 flops=3.69e+07
 renorm_tot counter=13 i=3 t=0.00122 per=9.03 cost=7.5e+04 flops=6.17e+07
 renorm_tot counter=13 i=4 t=0.00141 per=10.5 cost=4.5e+04 flops=3.2e+07
 renorm_tot counter=13 i=5 t=0.00143 per=10.6 cost=7.72e+04 flops=5.4e+07
 renorm_tot counter=13 i=6 t=0.00292 per=21.7 cost=5.26e+05 flops=1.8e+08
 total GEMM cost=8.76e+05 flops=6.51e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0025 S T(init/kernel/comm)=9.1e-05,0.0024,8.5e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=5.24e-05,3.45e-05,8.69e-05 speed=0.119GB/s disk[used]=9.48e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.53e-02 S #####
 T(fetch) = 7.32e-05 S  per = 0.21  per(accum) = 0.21
 T(hdiag) = 7.12e-05 S  per =  0.2  per(accum) = 0.41
 T(dvdsn) = 3.19e-02 S  per =   90  per(accum) = 91
 T(decim) = 9.16e-05 S  per = 0.26  per(accum) = 91
 T(guess) = 7.92e-05 S  per = 0.22  per(accum) = 91
 T(renrm) = 2.57e-03 S  per =  7.3  per(accum) = 98
 T(save ) = 5.36e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.17e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.85e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.31e-04 S  per = 0.73  per(accum) = 0.85
 T(hintermediate init           ) = 2.04e-04 S  per = 0.64  per(accum) = 1.5
 T(hintermediates memcpy cpu2gpu) = 3.55e-06 S  per = 0.011  per(accum) = 1.5
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =  7.1  per(accum) = 8.6
 T(hmmtasks init                ) = 1.29e-03 S  per =  4.1  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 2.74e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 5.64e-07 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.35e-04 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.52e-03 S
 T(qops init                    ) = 9.05e-05 S  per =  3.6  per(accum) = 3.6
 T(qops_dict memcpy cpu2gpu     ) = 2.69e-05 S  per =  1.1  per(accum) = 4.7
 T(symbolic_formulae_renorm     ) = 2.03e-04 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.16e-05 S  per = 0.46  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.72e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.60e-04 S  per =   22  per(accum) = 36
 T(rmmtasks init                ) = 3.32e-04 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 8.69e-06 S  per = 0.34  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.25e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.80e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.52e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 3.53e-02 S #####
 T(fetch) = 7.32e-05 S  per = 0.21  per(accum) = 0.21
 T(hdiag) = 7.12e-05 S  per =  0.2  per(accum) = 0.41
 T(dvdsn) = 3.19e-02 S  per =   90  per(accum) = 91
 T(decim) = 9.16e-05 S  per = 0.26  per(accum) = 91
 T(guess) = 7.92e-05 S  per = 0.22  per(accum) = 91
 T(renrm) = 2.57e-03 S  per =  7.3  per(accum) = 98
 T(save ) = 5.36e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.17e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.85e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.31e-04 S  per = 0.73  per(accum) = 0.85
 T(hintermediate init           ) = 2.04e-04 S  per = 0.64  per(accum) = 1.5
 T(hintermediates memcpy cpu2gpu) = 3.55e-06 S  per = 0.011  per(accum) = 1.5
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =  7.1  per(accum) = 8.6
 T(hmmtasks init                ) = 1.29e-03 S  per =  4.1  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 2.74e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 5.64e-07 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.35e-04 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.52e-03 S
 T(qops init                    ) = 9.05e-05 S  per =  3.6  per(accum) = 3.6
 T(qops_dict memcpy cpu2gpu     ) = 2.69e-05 S  per =  1.1  per(accum) = 4.7
 T(symbolic_formulae_renorm     ) = 2.03e-04 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.16e-05 S  per = 0.46  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.72e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.60e-04 S  per =   22  per(accum) = 36
 T(rmmtasks init                ) = 3.32e-04 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 8.69e-06 S  per = 0.34  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.25e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.80e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.52e-06 S  per = 0.34  per(accum) = 1e+02
##### time_global: 4.25e-01 S #####
 T(fetch) = 3.57e-03 S  per = 0.84  per(accum) = 0.84
 T(hdiag) = 1.19e-03 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 3.71e-01 S  per =   87  per(accum) = 89
 T(decim) = 3.23e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.13e-03 S  per = 0.27  per(accum) = 90
 T(renrm) = 3.63e-02 S  per =  8.5  per(accum) = 98
 T(save ) = 7.74e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.69e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 5.38e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 3.83e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 2.83e-03 S  per = 0.77  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 6.03e-05 S  per = 0.016  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 3.28e-02 S  per =  8.9  per(accum) = 11
 T(hmmtasks init                ) = 1.91e-02 S  per =  5.2  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 3.05e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 6.93e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.07e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.56e-02 S
 T(qops init                    ) = 1.48e-03 S  per =  4.2  per(accum) = 4.2
 T(qops_dict memcpy cpu2gpu     ) = 4.63e-04 S  per =  1.3  per(accum) = 5.5
 T(symbolic_formulae_renorm     ) = 2.99e-03 S  per =  8.4  per(accum) = 14
 T(rintermediate init           ) = 1.35e-03 S  per =  3.8  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 7.10e-05 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 7.20e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 4.55e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 1.17e-04 S  per = 0.33  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.69e-02 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.89e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.32e-04 S  per = 0.37  per(accum) = 1e+02

isweep=3 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.359e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47c88ab0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.182e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000153 flops=2.89e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.916e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.19e-05,0.00096,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.4e-05,0.00183,0.000178 cost=7.9e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00183 t_reduction=0.000178 tot=0.00201 ---
 sigma counter=142 i=0 t=0.000225 per=12.3 cost=6.81e+03 flops=3.03e+07
 sigma counter=142 i=1 t=0.000228 per=12.5 cost=6.78e+03 flops=2.98e+07
 sigma counter=142 i=2 t=0.000224 per=12.2 cost=7.01e+03 flops=3.13e+07
 sigma counter=142 i=3 t=0.000224 per=12.2 cost=6.99e+03 flops=3.12e+07
 sigma counter=142 i=4 t=0.000223 per=12.2 cost=6.81e+03 flops=3.06e+07
 sigma counter=142 i=5 t=0.000223 per=12.2 cost=6.78e+03 flops=3.04e+07
 sigma counter=142 i=6 t=0.000249 per=13.6 cost=1.89e+04 flops=7.59e+07
 sigma counter=142 i=7 t=0.000234 per=12.8 cost=1.89e+04 flops=8.08e+07
 total GEMM cost=7.9e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.264 t_reduction=0.0269 tot=0.291 ---
 sigma_tot counter=142 i=0 t=0.0328 per=12.4 cost=8.22e+05 flops=2.51e+07
 sigma_tot counter=142 i=1 t=0.0327 per=12.4 cost=8.34e+05 flops=2.55e+07
 sigma_tot counter=142 i=2 t=0.0328 per=12.4 cost=8.29e+05 flops=2.53e+07
 sigma_tot counter=142 i=3 t=0.0327 per=12.4 cost=8.35e+05 flops=2.56e+07
 sigma_tot counter=142 i=4 t=0.0325 per=12.3 cost=1.41e+06 flops=4.32e+07
 sigma_tot counter=142 i=5 t=0.033 per=12.5 cost=1.4e+06 flops=4.25e+07
 sigma_tot counter=142 i=6 t=0.0343 per=13 cost=1.61e+06 flops=4.69e+07
 sigma_tot counter=142 i=7 t=0.0328 per=12.5 cost=1.6e+06 flops=4.87e+07
 total GEMM cost=9.33e+06 flops=3.54e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00183,0.000177 cost=7.9e+04 flops[gemm]=4.32e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00183 t_reduction=0.000177 tot=0.00201 ---
 sigma counter=143 i=0 t=0.000223 per=12.2 cost=6.81e+03 flops=3.06e+07
 sigma counter=143 i=1 t=0.000229 per=12.5 cost=6.78e+03 flops=2.96e+07
 sigma counter=143 i=2 t=0.00023 per=12.6 cost=7.01e+03 flops=3.05e+07
 sigma counter=143 i=3 t=0.000226 per=12.4 cost=6.99e+03 flops=3.09e+07
 sigma counter=143 i=4 t=0.000218 per=11.9 cost=6.81e+03 flops=3.13e+07
 sigma counter=143 i=5 t=0.000228 per=12.5 cost=6.78e+03 flops=2.98e+07
 sigma counter=143 i=6 t=0.000245 per=13.4 cost=1.89e+04 flops=7.71e+07
 sigma counter=143 i=7 t=0.00023 per=12.6 cost=1.89e+04 flops=8.22e+07
 total GEMM cost=7.9e+04 flops=4.32e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.265 t_reduction=0.0271 tot=0.293 ---
 sigma_tot counter=143 i=0 t=0.033 per=12.4 cost=8.29e+05 flops=2.51e+07
 sigma_tot counter=143 i=1 t=0.033 per=12.4 cost=8.41e+05 flops=2.55e+07
 sigma_tot counter=143 i=2 t=0.033 per=12.4 cost=8.37e+05 flops=2.54e+07
 sigma_tot counter=143 i=3 t=0.0329 per=12.4 cost=8.42e+05 flops=2.56e+07
 sigma_tot counter=143 i=4 t=0.0327 per=12.3 cost=1.41e+06 flops=4.32e+07
 sigma_tot counter=143 i=5 t=0.0333 per=12.5 cost=1.41e+06 flops=4.24e+07
 sigma_tot counter=143 i=6 t=0.0345 per=13 cost=1.62e+06 flops=4.71e+07
 sigma_tot counter=143 i=7 t=0.0331 per=12.5 cost=1.62e+06 flops=4.89e+07
 total GEMM cost=9.41e+06 flops=3.55e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.25e-03  2.13e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   4.25e-03  2.13e-03
TIMING for Davidson : 4.27e-03  T(cal/comm/rest)=4.23e-03,8.40e-08,4.19e-05
optimized energies: isweep=3 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.733e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000151 flops=2.92e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 1.860e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000532 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.56e-05,0.000222,0.000265 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00101,0.000173 cost=1.55e+05 flops[gemm]=1.53e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00101 t_reduction=0.000173 tot=0.00118 ---
 renorm counter=14 i=0 t=0.000195 per=19.3 cost=8.1e+03 flops=4.15e+07
 renorm counter=14 i=1 t=0.000195 per=19.3 cost=8.36e+03 flops=4.29e+07
 renorm counter=14 i=2 t=1e-06 per=0.0989 cost=0 flops=0
 renorm counter=14 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=14 i=4 t=0.000193 per=19.1 cost=1.65e+04 flops=8.54e+07
 renorm counter=14 i=5 t=0.000199 per=19.7 cost=2.89e+04 flops=1.45e+08
 renorm counter=14 i=6 t=0.000228 per=22.6 cost=9.32e+04 flops=4.09e+08
 total GEMM cost=1.55e+05 flops=1.53e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0145 t_reduction=0.00251 tot=0.017 ---
 renorm_tot counter=14 i=0 t=0.00288 per=19.9 cost=5.26e+04 flops=1.82e+07
 renorm_tot counter=14 i=1 t=0.00282 per=19.5 cost=7.32e+04 flops=2.6e+07
 renorm_tot counter=14 i=2 t=0.00116 per=8.04 cost=4.29e+04 flops=3.69e+07
 renorm_tot counter=14 i=3 t=0.00122 per=8.4 cost=7.5e+04 flops=6.17e+07
 renorm_tot counter=14 i=4 t=0.0016 per=11.1 cost=6.15e+04 flops=3.85e+07
 renorm_tot counter=14 i=5 t=0.00163 per=11.3 cost=1.06e+05 flops=6.51e+07
 renorm_tot counter=14 i=6 t=0.00315 per=21.8 cost=6.19e+05 flops=1.97e+08
 total GEMM cost=1.03e+06 flops=7.13e+07
check ||H-H.dagger||=1.07e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=7.5e-05,0.0026,8.9e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=4.98e-05,3.99e-05,8.97e-05 speed=0.216GB/s disk[used]=9.62e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.25e-02 S #####
 T(fetch) = 3.19e-04 S  per =  2.6  per(accum) = 2.6
 T(hdiag) = 6.82e-05 S  per = 0.55  per(accum) = 3.1
 T(dvdsn) = 8.44e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.17e-04 S  per =  2.5  per(accum) = 73
 T(guess) = 7.69e-05 S  per = 0.62  per(accum) = 74
 T(renrm) = 2.72e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.46e-04 S  per =  4.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.26e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.79e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.23e-04 S  per =  2.7  per(accum) = 3.2
 T(hintermediate init           ) = 1.95e-04 S  per =  2.4  per(accum) = 5.5
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.043  per(accum) = 5.6
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =   27  per(accum) = 33
 T(hmmtasks init                ) = 1.29e-03 S  per =   16  per(accum) = 48
 T(dvdson solver [Hx_batchGPU]  ) = 4.23e-03 S  per =   51  per(accum) = 99
 T(dvdson solver [communication]) = 8.40e-08 S  per = 0.001  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.19e-05 S  per = 0.51  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.67e-03 S
 T(qops init                    ) = 7.49e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.44e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.78e-04 S  per =  6.7  per(accum) = 11
 T(rintermediate init           ) = 1.89e-04 S  per =  7.1  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.36e-06 S  per = 0.16  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.42e-04 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.49e-04 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 7.65e-06 S  per = 0.29  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.25e-03 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.73e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.94e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 4.78e-02 S #####
 T(fetch) = 3.92e-04 S  per = 0.82  per(accum) = 0.82
 T(hdiag) = 1.39e-04 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 4.03e-02 S  per =   84  per(accum) = 85
 T(decim) = 4.09e-04 S  per = 0.86  per(accum) = 86
 T(guess) = 1.56e-04 S  per = 0.33  per(accum) = 87
 T(renrm) = 5.29e-03 S  per =   11  per(accum) = 98
 T(save ) = 1.08e-03 S  per =  2.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.00e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 7.64e-05 S  per = 0.19  per(accum) = 0.19
 T(symbolic_formulae_twodot     ) = 4.54e-04 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 3.99e-04 S  per =    1  per(accum) = 2.3
 T(hintermediates memcpy cpu2gpu) = 7.09e-06 S  per = 0.018  per(accum) = 2.3
 T(preprocess_hformulae_Hxlist2 ) = 4.48e-03 S  per =   11  per(accum) = 14
 T(hmmtasks init                ) = 2.58e-03 S  per =  6.4  per(accum) = 20
 T(dvdson solver [Hx_batchGPU]  ) = 3.16e-02 S  per =   79  per(accum) = 99
 T(dvdson solver [communication]) = 6.48e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.77e-04 S  per = 0.94  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.19e-03 S
 T(qops init                    ) = 1.65e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 6.13e-05 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 3.81e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 2.01e-04 S  per =  3.9  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 9.08e-06 S  per = 0.17  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 1.10e-03 S  per =   21  per(accum) = 37
 T(rmmtasks init                ) = 6.81e-04 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.63e-05 S  per = 0.31  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 2.50e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.53e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.75e-05 S  per = 0.34  per(accum) = 1e+02
##### time_global: 4.37e-01 S #####
 T(fetch) = 3.89e-03 S  per = 0.89  per(accum) = 0.89
 T(hdiag) = 1.26e-03 S  per = 0.29  per(accum) = 1.2
 T(dvdsn) = 3.80e-01 S  per =   87  per(accum) = 88
 T(decim) = 3.54e-03 S  per = 0.81  per(accum) = 89
 T(guess) = 1.20e-03 S  per = 0.28  per(accum) = 89
 T(renrm) = 3.90e-02 S  per =  8.9  per(accum) = 98
 T(save ) = 8.29e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.77e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 5.76e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 4.05e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 3.02e-03 S  per =  0.8  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 6.38e-05 S  per = 0.017  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 3.51e-02 S  per =  9.3  per(accum) = 11
 T(hmmtasks init                ) = 2.04e-02 S  per =  5.4  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 3.10e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 7.01e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.11e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.83e-02 S
 T(qops init                    ) = 1.56e-03 S  per =  4.1  per(accum) = 4.1
 T(qops_dict memcpy cpu2gpu     ) = 4.97e-04 S  per =  1.3  per(accum) = 5.4
 T(symbolic_formulae_renorm     ) = 3.17e-03 S  per =  8.3  per(accum) = 14
 T(rintermediate init           ) = 1.54e-03 S  per =    4  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 7.54e-05 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 7.74e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 4.89e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 1.24e-04 S  per = 0.33  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.81e-02 S  per =   47  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 4.16e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.40e-04 S  per = 0.37  per(accum) = 1e+02

isweep=3 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.125e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47a4a000
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.201e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000152 flops=2.91e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.882e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.26e-05,0.000958,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.6e-05,0.00182,0.000182 cost=7.9e+04 flops[gemm]=4.34e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00182 t_reduction=0.000182 tot=0.002 ---
 sigma counter=144 i=0 t=0.000225 per=12.4 cost=6.81e+03 flops=3.03e+07
 sigma counter=144 i=1 t=0.000223 per=12.3 cost=6.78e+03 flops=3.04e+07
 sigma counter=144 i=2 t=0.000229 per=12.6 cost=7.01e+03 flops=3.06e+07
 sigma counter=144 i=3 t=0.000225 per=12.4 cost=6.99e+03 flops=3.11e+07
 sigma counter=144 i=4 t=0.00022 per=12.1 cost=6.81e+03 flops=3.1e+07
 sigma counter=144 i=5 t=0.000221 per=12.2 cost=6.78e+03 flops=3.07e+07
 sigma counter=144 i=6 t=0.000243 per=13.4 cost=1.89e+04 flops=7.78e+07
 sigma counter=144 i=7 t=0.000232 per=12.8 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.9e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.267 t_reduction=0.0273 tot=0.295 ---
 sigma_tot counter=144 i=0 t=0.0332 per=12.4 cost=8.36e+05 flops=2.51e+07
 sigma_tot counter=144 i=1 t=0.0332 per=12.4 cost=8.47e+05 flops=2.55e+07
 sigma_tot counter=144 i=2 t=0.0332 per=12.4 cost=8.44e+05 flops=2.54e+07
 sigma_tot counter=144 i=3 t=0.0331 per=12.4 cost=8.49e+05 flops=2.57e+07
 sigma_tot counter=144 i=4 t=0.0329 per=12.3 cost=1.42e+06 flops=4.31e+07
 sigma_tot counter=144 i=5 t=0.0335 per=12.5 cost=1.42e+06 flops=4.23e+07
 sigma_tot counter=144 i=6 t=0.0348 per=13 cost=1.64e+06 flops=4.73e+07
 sigma_tot counter=144 i=7 t=0.0333 per=12.5 cost=1.64e+06 flops=4.91e+07
 total GEMM cost=9.49e+06 flops=3.55e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.6e-05,0.00183,0.000179 cost=7.9e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00183 t_reduction=0.000179 tot=0.002 ---
 sigma counter=145 i=0 t=0.000222 per=12.2 cost=6.81e+03 flops=3.07e+07
 sigma counter=145 i=1 t=0.000224 per=12.3 cost=6.78e+03 flops=3.03e+07
 sigma counter=145 i=2 t=0.000228 per=12.5 cost=7.01e+03 flops=3.07e+07
 sigma counter=145 i=3 t=0.000226 per=12.4 cost=6.99e+03 flops=3.09e+07
 sigma counter=145 i=4 t=0.00022 per=12.1 cost=6.81e+03 flops=3.1e+07
 sigma counter=145 i=5 t=0.000224 per=12.3 cost=6.78e+03 flops=3.03e+07
 sigma counter=145 i=6 t=0.000244 per=13.4 cost=1.89e+04 flops=7.74e+07
 sigma counter=145 i=7 t=0.000237 per=13 cost=1.89e+04 flops=7.97e+07
 total GEMM cost=7.9e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.269 t_reduction=0.0275 tot=0.297 ---
 sigma_tot counter=145 i=0 t=0.0335 per=12.4 cost=8.43e+05 flops=2.52e+07
 sigma_tot counter=145 i=1 t=0.0334 per=12.4 cost=8.54e+05 flops=2.56e+07
 sigma_tot counter=145 i=2 t=0.0334 per=12.4 cost=8.51e+05 flops=2.54e+07
 sigma_tot counter=145 i=3 t=0.0333 per=12.4 cost=8.56e+05 flops=2.57e+07
 sigma_tot counter=145 i=4 t=0.0332 per=12.3 cost=1.43e+06 flops=4.3e+07
 sigma_tot counter=145 i=5 t=0.0337 per=12.5 cost=1.42e+06 flops=4.22e+07
 sigma_tot counter=145 i=6 t=0.035 per=13 cost=1.66e+06 flops=4.75e+07
 sigma_tot counter=145 i=7 t=0.0335 per=12.5 cost=1.65e+06 flops=4.93e+07
 total GEMM cost=9.57e+06 flops=3.56e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   4.24e-03  2.12e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   4.24e-03  2.12e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.70e-05,1.82e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.33e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.88e-04 tot=2.01e-03 ---
 sigma counter=146 i=0 t=2.24e-04 per=1.23e+01 cost=6.81e+03 flops=3.04e+07
 sigma counter=146 i=1 t=2.25e-04 per=1.23e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=146 i=2 t=2.25e-04 per=1.23e+01 cost=7.01e+03 flops=3.11e+07
 sigma counter=146 i=3 t=2.25e-04 per=1.23e+01 cost=6.99e+03 flops=3.11e+07
 sigma counter=146 i=4 t=2.19e-04 per=1.20e+01 cost=6.81e+03 flops=3.11e+07
 sigma counter=146 i=5 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=146 i=6 t=2.48e-04 per=1.36e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=146 i=7 t=2.33e-04 per=1.28e+01 cost=1.89e+04 flops=8.11e+07
 total GEMM cost=7.90e+04 flops=4.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.71e-01 t_reduction=2.77e-02 tot=2.99e-01 ---
 sigma_tot counter=146 i=0 t=3.37e-02 per=1.24e+01 cost=8.50e+05 flops=2.52e+07
 sigma_tot counter=146 i=1 t=3.36e-02 per=1.24e+01 cost=8.61e+05 flops=2.56e+07
 sigma_tot counter=146 i=2 t=3.37e-02 per=1.24e+01 cost=8.58e+05 flops=2.55e+07
 sigma_tot counter=146 i=3 t=3.36e-02 per=1.24e+01 cost=8.63e+05 flops=2.57e+07
 sigma_tot counter=146 i=4 t=3.34e-02 per=1.23e+01 cost=1.43e+06 flops=4.29e+07
 sigma_tot counter=146 i=5 t=3.39e-02 per=1.25e+01 cost=1.43e+06 flops=4.21e+07
 sigma_tot counter=146 i=6 t=3.52e-02 per=1.30e+01 cost=1.68e+06 flops=4.77e+07
 sigma_tot counter=146 i=7 t=3.38e-02 per=1.25e+01 cost=1.67e+06 flops=4.96e+07
 total GEMM cost=9.65e+06 flops=3.56e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.79e-04 cost=7.90e+04 flops[gemm]=4.34e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.79e-04 tot=2.00e-03 ---
 sigma counter=147 i=0 t=2.21e-04 per=1.21e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=147 i=1 t=2.24e-04 per=1.23e+01 cost=6.78e+03 flops=3.03e+07
 sigma counter=147 i=2 t=2.34e-04 per=1.29e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=147 i=3 t=2.25e-04 per=1.24e+01 cost=6.99e+03 flops=3.11e+07
 sigma counter=147 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=147 i=5 t=2.23e-04 per=1.22e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=147 i=6 t=2.44e-04 per=1.34e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=147 i=7 t=2.32e-04 per=1.27e+01 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.90e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.73e-01 t_reduction=2.78e-02 tot=3.01e-01 ---
 sigma_tot counter=147 i=0 t=3.39e-02 per=1.24e+01 cost=8.57e+05 flops=2.53e+07
 sigma_tot counter=147 i=1 t=3.39e-02 per=1.24e+01 cost=8.68e+05 flops=2.56e+07
 sigma_tot counter=147 i=2 t=3.39e-02 per=1.24e+01 cost=8.65e+05 flops=2.55e+07
 sigma_tot counter=147 i=3 t=3.38e-02 per=1.24e+01 cost=8.70e+05 flops=2.58e+07
 sigma_tot counter=147 i=4 t=3.36e-02 per=1.23e+01 cost=1.44e+06 flops=4.28e+07
 sigma_tot counter=147 i=5 t=3.42e-02 per=1.25e+01 cost=1.44e+06 flops=4.21e+07
 sigma_tot counter=147 i=6 t=3.55e-02 per=1.30e+01 cost=1.70e+06 flops=4.79e+07
 sigma_tot counter=147 i=7 t=3.40e-02 per=1.25e+01 cost=1.69e+06 flops=4.98e+07
 total GEMM cost=9.73e+06 flops=3.57e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   8.51e-03  2.13e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   8.51e-03  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.82e-03,1.83e-04 cost=7.90e+04 flops[gemm]=4.35e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.83e-04 tot=2.00e-03 ---
 sigma counter=148 i=0 t=2.26e-04 per=1.25e+01 cost=6.81e+03 flops=3.02e+07
 sigma counter=148 i=1 t=2.25e-04 per=1.24e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=148 i=2 t=2.18e-04 per=1.20e+01 cost=7.01e+03 flops=3.21e+07
 sigma counter=148 i=3 t=2.23e-04 per=1.23e+01 cost=6.99e+03 flops=3.13e+07
 sigma counter=148 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=148 i=5 t=2.23e-04 per=1.23e+01 cost=6.78e+03 flops=3.04e+07
 sigma counter=148 i=6 t=2.50e-04 per=1.38e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=148 i=7 t=2.32e-04 per=1.28e+01 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.90e+04 flops=4.35e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.75e-01 t_reduction=2.80e-02 tot=3.03e-01 ---
 sigma_tot counter=148 i=0 t=3.41e-02 per=1.24e+01 cost=8.63e+05 flops=2.53e+07
 sigma_tot counter=148 i=1 t=3.41e-02 per=1.24e+01 cost=8.75e+05 flops=2.57e+07
 sigma_tot counter=148 i=2 t=3.41e-02 per=1.24e+01 cost=8.72e+05 flops=2.55e+07
 sigma_tot counter=148 i=3 t=3.40e-02 per=1.24e+01 cost=8.77e+05 flops=2.58e+07
 sigma_tot counter=148 i=4 t=3.38e-02 per=1.23e+01 cost=1.45e+06 flops=4.28e+07
 sigma_tot counter=148 i=5 t=3.44e-02 per=1.25e+01 cost=1.44e+06 flops=4.20e+07
 sigma_tot counter=148 i=6 t=3.57e-02 per=1.30e+01 cost=1.72e+06 flops=4.81e+07
 sigma_tot counter=148 i=7 t=3.42e-02 per=1.25e+01 cost=1.71e+06 flops=5.00e+07
 total GEMM cost=9.81e+06 flops=3.57e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.82e-03,1.80e-04 cost=7.90e+04 flops[gemm]=4.34e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.82e-03 t_reduction=1.80e-04 tot=2.00e-03 ---
 sigma counter=149 i=0 t=2.21e-04 per=1.22e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=149 i=1 t=2.26e-04 per=1.24e+01 cost=6.78e+03 flops=3.00e+07
 sigma counter=149 i=2 t=2.29e-04 per=1.26e+01 cost=7.01e+03 flops=3.06e+07
 sigma counter=149 i=3 t=2.26e-04 per=1.24e+01 cost=6.99e+03 flops=3.09e+07
 sigma counter=149 i=4 t=2.18e-04 per=1.20e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=149 i=5 t=2.22e-04 per=1.22e+01 cost=6.78e+03 flops=3.06e+07
 sigma counter=149 i=6 t=2.45e-04 per=1.35e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=149 i=7 t=2.31e-04 per=1.27e+01 cost=1.89e+04 flops=8.18e+07
 total GEMM cost=7.90e+04 flops=4.34e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.76e-01 t_reduction=2.82e-02 tot=3.05e-01 ---
 sigma_tot counter=149 i=0 t=3.44e-02 per=1.24e+01 cost=8.70e+05 flops=2.53e+07
 sigma_tot counter=149 i=1 t=3.43e-02 per=1.24e+01 cost=8.81e+05 flops=2.57e+07
 sigma_tot counter=149 i=2 t=3.43e-02 per=1.24e+01 cost=8.79e+05 flops=2.56e+07
 sigma_tot counter=149 i=3 t=3.42e-02 per=1.24e+01 cost=8.84e+05 flops=2.58e+07
 sigma_tot counter=149 i=4 t=3.40e-02 per=1.23e+01 cost=1.45e+06 flops=4.27e+07
 sigma_tot counter=149 i=5 t=3.46e-02 per=1.25e+01 cost=1.45e+06 flops=4.19e+07
 sigma_tot counter=149 i=6 t=3.60e-02 per=1.30e+01 cost=1.74e+06 flops=4.83e+07
 sigma_tot counter=149 i=7 t=3.45e-02 per=1.25e+01 cost=1.73e+06 flops=5.02e+07
 total GEMM cost=9.89e+06 flops=3.58e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.28e-02  2.13e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   1.28e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.83e-03,1.77e-04 cost=7.90e+04 flops[gemm]=4.31e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.83e-03 t_reduction=1.77e-04 tot=2.01e-03 ---
 sigma counter=150 i=0 t=2.33e-04 per=1.27e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=150 i=1 t=2.25e-04 per=1.23e+01 cost=6.78e+03 flops=3.02e+07
 sigma counter=150 i=2 t=2.28e-04 per=1.24e+01 cost=7.01e+03 flops=3.07e+07
 sigma counter=150 i=3 t=2.22e-04 per=1.21e+01 cost=6.99e+03 flops=3.15e+07
 sigma counter=150 i=4 t=2.22e-04 per=1.21e+01 cost=6.81e+03 flops=3.07e+07
 sigma counter=150 i=5 t=2.27e-04 per=1.24e+01 cost=6.78e+03 flops=2.99e+07
 sigma counter=150 i=6 t=2.43e-04 per=1.33e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=150 i=7 t=2.33e-04 per=1.27e+01 cost=1.89e+04 flops=8.11e+07
 total GEMM cost=7.90e+04 flops=4.31e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.78e-01 t_reduction=2.84e-02 tot=3.07e-01 ---
 sigma_tot counter=150 i=0 t=3.46e-02 per=1.24e+01 cost=8.77e+05 flops=2.53e+07
 sigma_tot counter=150 i=1 t=3.45e-02 per=1.24e+01 cost=8.88e+05 flops=2.57e+07
 sigma_tot counter=150 i=2 t=3.46e-02 per=1.24e+01 cost=8.86e+05 flops=2.56e+07
 sigma_tot counter=150 i=3 t=3.44e-02 per=1.24e+01 cost=8.91e+05 flops=2.59e+07
 sigma_tot counter=150 i=4 t=3.43e-02 per=1.23e+01 cost=1.46e+06 flops=4.26e+07
 sigma_tot counter=150 i=5 t=3.48e-02 per=1.25e+01 cost=1.46e+06 flops=4.18e+07
 sigma_tot counter=150 i=6 t=3.62e-02 per=1.30e+01 cost=1.76e+06 flops=4.85e+07
 sigma_tot counter=150 i=7 t=3.47e-02 per=1.25e+01 cost=1.75e+06 flops=5.04e+07
 total GEMM cost=9.96e+06 flops=3.58e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.81e-03,1.82e-04 cost=7.90e+04 flops[gemm]=4.37e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.81e-03 t_reduction=1.82e-04 tot=1.99e-03 ---
 sigma counter=151 i=0 t=2.21e-04 per=1.22e+01 cost=6.81e+03 flops=3.08e+07
 sigma counter=151 i=1 t=2.20e-04 per=1.22e+01 cost=6.78e+03 flops=3.08e+07
 sigma counter=151 i=2 t=2.27e-04 per=1.26e+01 cost=7.01e+03 flops=3.09e+07
 sigma counter=151 i=3 t=2.26e-04 per=1.25e+01 cost=6.99e+03 flops=3.09e+07
 sigma counter=151 i=4 t=2.18e-04 per=1.21e+01 cost=6.81e+03 flops=3.13e+07
 sigma counter=151 i=5 t=2.21e-04 per=1.22e+01 cost=6.78e+03 flops=3.07e+07
 sigma counter=151 i=6 t=2.41e-04 per=1.33e+01 cost=1.89e+04 flops=7.84e+07
 sigma counter=151 i=7 t=2.32e-04 per=1.28e+01 cost=1.89e+04 flops=8.14e+07
 total GEMM cost=7.90e+04 flops=4.37e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.80e-01 t_reduction=2.86e-02 tot=3.09e-01 ---
 sigma_tot counter=151 i=0 t=3.48e-02 per=1.24e+01 cost=8.84e+05 flops=2.54e+07
 sigma_tot counter=151 i=1 t=3.48e-02 per=1.24e+01 cost=8.95e+05 flops=2.57e+07
 sigma_tot counter=151 i=2 t=3.48e-02 per=1.24e+01 cost=8.93e+05 flops=2.56e+07
 sigma_tot counter=151 i=3 t=3.47e-02 per=1.24e+01 cost=8.98e+05 flops=2.59e+07
 sigma_tot counter=151 i=4 t=3.45e-02 per=1.23e+01 cost=1.47e+06 flops=4.25e+07
 sigma_tot counter=151 i=5 t=3.50e-02 per=1.25e+01 cost=1.46e+06 flops=4.18e+07
 sigma_tot counter=151 i=6 t=3.65e-02 per=1.30e+01 cost=1.78e+06 flops=4.87e+07
 sigma_tot counter=151 i=7 t=3.49e-02 per=1.25e+01 cost=1.77e+06 flops=5.06e+07
 total GEMM cost=1.00e+07 flops=3.59e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.70e-02  2.13e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.70e-02  2.13e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.96e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=1.87e-04 tot=2.15e-03 ---
 sigma counter=152 i=0 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=152 i=1 t=2.50e-04 per=1.28e+01 cost=6.78e+03 flops=2.71e+07
 sigma counter=152 i=2 t=2.35e-04 per=1.20e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=152 i=3 t=2.45e-04 per=1.25e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=152 i=4 t=2.32e-04 per=1.18e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=152 i=5 t=2.39e-04 per=1.22e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=152 i=6 t=2.69e-04 per=1.37e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=152 i=7 t=2.50e-04 per=1.28e+01 cost=1.89e+04 flops=7.56e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.82e-01 t_reduction=2.88e-02 tot=3.11e-01 ---
 sigma_tot counter=152 i=0 t=3.51e-02 per=1.24e+01 cost=8.91e+05 flops=2.54e+07
 sigma_tot counter=152 i=1 t=3.50e-02 per=1.24e+01 cost=9.02e+05 flops=2.58e+07
 sigma_tot counter=152 i=2 t=3.50e-02 per=1.24e+01 cost=9.00e+05 flops=2.57e+07
 sigma_tot counter=152 i=3 t=3.49e-02 per=1.24e+01 cost=9.05e+05 flops=2.59e+07
 sigma_tot counter=152 i=4 t=3.47e-02 per=1.23e+01 cost=1.47e+06 flops=4.25e+07
 sigma_tot counter=152 i=5 t=3.53e-02 per=1.25e+01 cost=1.47e+06 flops=4.17e+07
 sigma_tot counter=152 i=6 t=3.67e-02 per=1.30e+01 cost=1.79e+06 flops=4.89e+07
 sigma_tot counter=152 i=7 t=3.52e-02 per=1.25e+01 cost=1.79e+06 flops=5.08e+07
 total GEMM cost=1.01e+07 flops=3.59e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.88e-04 tot=2.12e-03 ---
 sigma counter=153 i=0 t=2.33e-04 per=1.21e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=153 i=1 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=153 i=2 t=2.43e-04 per=1.26e+01 cost=7.01e+03 flops=2.88e+07
 sigma counter=153 i=3 t=2.36e-04 per=1.22e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=153 i=4 t=2.31e-04 per=1.20e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=153 i=5 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=153 i=6 t=2.67e-04 per=1.38e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=153 i=7 t=2.51e-04 per=1.30e+01 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.84e-01 t_reduction=2.89e-02 tot=3.13e-01 ---
 sigma_tot counter=153 i=0 t=3.53e-02 per=1.24e+01 cost=8.97e+05 flops=2.54e+07
 sigma_tot counter=153 i=1 t=3.52e-02 per=1.24e+01 cost=9.09e+05 flops=2.58e+07
 sigma_tot counter=153 i=2 t=3.53e-02 per=1.24e+01 cost=9.07e+05 flops=2.57e+07
 sigma_tot counter=153 i=3 t=3.52e-02 per=1.24e+01 cost=9.12e+05 flops=2.59e+07
 sigma_tot counter=153 i=4 t=3.49e-02 per=1.23e+01 cost=1.48e+06 flops=4.24e+07
 sigma_tot counter=153 i=5 t=3.55e-02 per=1.25e+01 cost=1.48e+06 flops=4.16e+07
 sigma_tot counter=153 i=6 t=3.70e-02 per=1.30e+01 cost=1.81e+06 flops=4.90e+07
 sigma_tot counter=153 i=7 t=3.54e-02 per=1.25e+01 cost=1.81e+06 flops=5.10e+07
 total GEMM cost=1.02e+07 flops=3.59e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.15e-02  2.15e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.15e-02  2.15e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.70e-05,1.93e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.89e-04 tot=2.12e-03 ---
 sigma counter=154 i=0 t=2.41e-04 per=1.25e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=154 i=1 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=154 i=2 t=2.40e-04 per=1.24e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=154 i=3 t=2.35e-04 per=1.22e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=154 i=4 t=2.33e-04 per=1.21e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=154 i=5 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=154 i=6 t=2.60e-04 per=1.35e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=154 i=7 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.86e-01 t_reduction=2.91e-02 tot=3.15e-01 ---
 sigma_tot counter=154 i=0 t=3.55e-02 per=1.24e+01 cost=9.04e+05 flops=2.54e+07
 sigma_tot counter=154 i=1 t=3.55e-02 per=1.24e+01 cost=9.15e+05 flops=2.58e+07
 sigma_tot counter=154 i=2 t=3.55e-02 per=1.24e+01 cost=9.14e+05 flops=2.57e+07
 sigma_tot counter=154 i=3 t=3.54e-02 per=1.24e+01 cost=9.19e+05 flops=2.60e+07
 sigma_tot counter=154 i=4 t=3.52e-02 per=1.23e+01 cost=1.49e+06 flops=4.23e+07
 sigma_tot counter=154 i=5 t=3.58e-02 per=1.25e+01 cost=1.48e+06 flops=4.15e+07
 sigma_tot counter=154 i=6 t=3.73e-02 per=1.30e+01 cost=1.83e+06 flops=4.92e+07
 sigma_tot counter=154 i=7 t=3.57e-02 per=1.25e+01 cost=1.82e+06 flops=5.11e+07
 total GEMM cost=1.03e+07 flops=3.60e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.13e-03 ---
 sigma counter=155 i=0 t=2.40e-04 per=1.24e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=155 i=1 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=155 i=2 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=155 i=3 t=2.40e-04 per=1.24e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=155 i=4 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=155 i=5 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=155 i=6 t=2.63e-04 per=1.35e+01 cost=1.89e+04 flops=7.18e+07
 sigma counter=155 i=7 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.88e-01 t_reduction=2.93e-02 tot=3.17e-01 ---
 sigma_tot counter=155 i=0 t=3.58e-02 per=1.24e+01 cost=9.11e+05 flops=2.55e+07
 sigma_tot counter=155 i=1 t=3.57e-02 per=1.24e+01 cost=9.22e+05 flops=2.58e+07
 sigma_tot counter=155 i=2 t=3.58e-02 per=1.24e+01 cost=9.21e+05 flops=2.57e+07
 sigma_tot counter=155 i=3 t=3.56e-02 per=1.24e+01 cost=9.26e+05 flops=2.60e+07
 sigma_tot counter=155 i=4 t=3.54e-02 per=1.23e+01 cost=1.49e+06 flops=4.22e+07
 sigma_tot counter=155 i=5 t=3.60e-02 per=1.25e+01 cost=1.49e+06 flops=4.14e+07
 sigma_tot counter=155 i=6 t=3.75e-02 per=1.30e+01 cost=1.85e+06 flops=4.93e+07
 sigma_tot counter=155 i=7 t=3.59e-02 per=1.25e+01 cost=1.84e+06 flops=5.13e+07
 total GEMM cost=1.04e+07 flops=3.60e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   2.60e-02  2.17e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   2.60e-02  2.17e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.14e-03 ---
 sigma counter=156 i=0 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=156 i=1 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=156 i=2 t=2.38e-04 per=1.22e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=156 i=3 t=2.40e-04 per=1.23e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=156 i=4 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=156 i=5 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=156 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=156 i=7 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.90e-01 t_reduction=2.95e-02 tot=3.19e-01 ---
 sigma_tot counter=156 i=0 t=3.60e-02 per=1.24e+01 cost=9.18e+05 flops=2.55e+07
 sigma_tot counter=156 i=1 t=3.60e-02 per=1.24e+01 cost=9.29e+05 flops=2.58e+07
 sigma_tot counter=156 i=2 t=3.60e-02 per=1.24e+01 cost=9.28e+05 flops=2.58e+07
 sigma_tot counter=156 i=3 t=3.59e-02 per=1.24e+01 cost=9.33e+05 flops=2.60e+07
 sigma_tot counter=156 i=4 t=3.56e-02 per=1.23e+01 cost=1.50e+06 flops=4.21e+07
 sigma_tot counter=156 i=5 t=3.62e-02 per=1.25e+01 cost=1.50e+06 flops=4.13e+07
 sigma_tot counter=156 i=6 t=3.78e-02 per=1.30e+01 cost=1.87e+06 flops=4.95e+07
 sigma_tot counter=156 i=7 t=3.62e-02 per=1.25e+01 cost=1.86e+06 flops=5.15e+07
 total GEMM cost=1.04e+07 flops=3.60e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.14e-03 ---
 sigma counter=157 i=0 t=2.37e-04 per=1.22e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=157 i=1 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=157 i=2 t=2.39e-04 per=1.23e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=157 i=3 t=2.36e-04 per=1.21e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=157 i=4 t=2.42e-04 per=1.24e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=157 i=5 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=157 i=6 t=2.71e-04 per=1.39e+01 cost=1.89e+04 flops=6.97e+07
 sigma counter=157 i=7 t=2.52e-04 per=1.29e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=2.92e-01 t_reduction=2.97e-02 tot=3.21e-01 ---
 sigma_tot counter=157 i=0 t=3.62e-02 per=1.24e+01 cost=9.25e+05 flops=2.55e+07
 sigma_tot counter=157 i=1 t=3.62e-02 per=1.24e+01 cost=9.36e+05 flops=2.59e+07
 sigma_tot counter=157 i=2 t=3.62e-02 per=1.24e+01 cost=9.35e+05 flops=2.58e+07
 sigma_tot counter=157 i=3 t=3.61e-02 per=1.24e+01 cost=9.40e+05 flops=2.60e+07
 sigma_tot counter=157 i=4 t=3.59e-02 per=1.23e+01 cost=1.51e+06 flops=4.20e+07
 sigma_tot counter=157 i=5 t=3.65e-02 per=1.25e+01 cost=1.50e+06 flops=4.13e+07
 sigma_tot counter=157 i=6 t=3.81e-02 per=1.31e+01 cost=1.89e+06 flops=4.96e+07
 sigma_tot counter=157 i=7 t=3.64e-02 per=1.25e+01 cost=1.88e+06 flops=5.16e+07
 total GEMM cost=1.05e+07 flops=3.61e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   3.06e-02  2.18e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   3.06e-02  2.18e-03
TIMING for Davidson : 3.06e-02  T(cal/comm/rest)=3.02e-02,5.69e-07,3.24e-04
optimized energies: isweep=3 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.038e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000551 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.53e-05,0.000239,0.000256 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00106,0.000181 cost=2.78e+04 flops[gemm]=2.62e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00106 t_reduction=0.000181 tot=0.00124 ---
 renorm counter=15 i=0 t=0.000217 per=20.5 cost=1.82e+03 flops=8.4e+06
 renorm counter=15 i=1 t=0.000208 per=19.6 cost=3.23e+03 flops=1.55e+07
 renorm counter=15 i=2 t=0.000196 per=18.5 cost=1.91e+03 flops=9.72e+06
 renorm counter=15 i=3 t=0.000206 per=19.5 cost=3.14e+03 flops=1.53e+07
 renorm counter=15 i=4 t=1e-06 per=0.0944 cost=0 flops=0
 renorm counter=15 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=15 i=6 t=0.000231 per=21.8 cost=1.77e+04 flops=7.66e+07
 total GEMM cost=2.78e+04 flops=2.62e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0155 t_reduction=0.00269 tot=0.0182 ---
 renorm_tot counter=15 i=0 t=0.0031 per=20 cost=5.44e+04 flops=1.76e+07
 renorm_tot counter=15 i=1 t=0.00302 per=19.5 cost=7.65e+04 flops=2.53e+07
 renorm_tot counter=15 i=2 t=0.00136 per=8.76 cost=4.48e+04 flops=3.3e+07
 renorm_tot counter=15 i=3 t=0.00142 per=9.16 cost=7.81e+04 flops=5.5e+07
 renorm_tot counter=15 i=4 t=0.0016 per=10.3 cost=6.15e+04 flops=3.84e+07
 renorm_tot counter=15 i=5 t=0.00163 per=10.5 cost=1.06e+05 flops=6.51e+07
 renorm_tot counter=15 i=6 t=0.00338 per=21.8 cost=6.37e+05 flops=1.88e+08
 total GEMM cost=1.06e+06 flops=6.82e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=9.2e-05,0.0025,8.7e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=4.94e-05,3.13e-05,8.07e-05 speed=0.128GB/s disk[used]=9.62e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 3.82e-02 S #####
 T(fetch) = 7.29e-05 S  per = 0.19  per(accum) = 0.19
 T(hdiag) = 7.80e-05 S  per =  0.2  per(accum) = 0.39
 T(dvdsn) = 3.47e-02 S  per =   91  per(accum) = 91
 T(decim) = 8.21e-05 S  per = 0.21  per(accum) = 91
 T(guess) = 7.86e-05 S  per = 0.21  per(accum) = 92
 T(renrm) = 2.64e-03 S  per =  6.9  per(accum) = 99
 T(save ) = 5.47e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.46e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.35e-05 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 2.25e-04 S  per = 0.65  per(accum) = 0.78
 T(hintermediate init           ) = 1.92e-04 S  per = 0.55  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 3.60e-06 S  per = 0.01  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =  6.5  per(accum) = 7.8
 T(hmmtasks init                ) = 1.29e-03 S  per =  3.7  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 3.02e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 5.69e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.24e-04 S  per = 0.94  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.59e-03 S
 T(qops init                    ) = 9.17e-05 S  per =  3.5  per(accum) = 3.5
 T(qops_dict memcpy cpu2gpu     ) = 2.79e-05 S  per =  1.1  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.09e-04 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.16e-05 S  per = 0.45  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.91e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.60e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.33e-04 S  per =   13  per(accum) = 48
 T(qops memset                  ) = 8.57e-06 S  per = 0.33  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.31e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.80e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.72e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 8.60e-02 S #####
 T(fetch) = 4.65e-04 S  per = 0.54  per(accum) = 0.54
 T(hdiag) = 2.17e-04 S  per = 0.25  per(accum) = 0.79
 T(dvdsn) = 7.51e-02 S  per =   87  per(accum) = 88
 T(decim) = 4.91e-04 S  per = 0.57  per(accum) = 89
 T(guess) = 2.35e-04 S  per = 0.27  per(accum) = 89
 T(renrm) = 7.92e-03 S  per =  9.2  per(accum) = 98
 T(save ) = 1.63e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 7.46e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.20e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 6.79e-04 S  per = 0.91  per(accum) = 1.1
 T(hintermediate init           ) = 5.91e-04 S  per = 0.79  per(accum) = 1.9
 T(hintermediates memcpy cpu2gpu) = 1.07e-05 S  per = 0.014  per(accum) = 1.9
 T(preprocess_hformulae_Hxlist2 ) = 6.72e-03 S  per =    9  per(accum) = 11
 T(hmmtasks init                ) = 3.86e-03 S  per =  5.2  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 6.19e-02 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 1.22e-06 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.01e-04 S  per = 0.94  per(accum) = 1e+02
Detailed decomposition of T(renrm): 7.78e-03 S
 T(qops init                    ) = 2.57e-04 S  per =  3.3  per(accum) = 3.3
 T(qops_dict memcpy cpu2gpu     ) = 8.91e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 5.89e-04 S  per =  7.6  per(accum) = 12
 T(rintermediate init           ) = 2.12e-04 S  per =  2.7  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.40e-05 S  per = 0.18  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 1.66e-03 S  per =   21  per(accum) = 36
 T(rmmtasks init                ) = 1.01e-03 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 2.49e-05 S  per = 0.32  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 3.81e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.33e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.62e-05 S  per = 0.34  per(accum) = 1e+02
##### time_global: 4.75e-01 S #####
 T(fetch) = 3.96e-03 S  per = 0.83  per(accum) = 0.83
 T(hdiag) = 1.34e-03 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 4.15e-01 S  per =   87  per(accum) = 88
 T(decim) = 3.63e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.28e-03 S  per = 0.27  per(accum) = 89
 T(renrm) = 4.16e-02 S  per =  8.8  per(accum) = 98
 T(save ) = 8.83e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.11e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 6.20e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 4.28e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 3.21e-03 S  per = 0.78  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 6.74e-05 S  per = 0.016  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 3.73e-02 S  per =  9.1  per(accum) = 11
 T(hmmtasks init                ) = 2.16e-02 S  per =  5.3  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 3.40e-01 S  per =   83  per(accum) = 99
 T(dvdson solver [communication]) = 7.58e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.43e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.09e-02 S
 T(qops init                    ) = 1.65e-03 S  per =    4  per(accum) = 4
 T(qops_dict memcpy cpu2gpu     ) = 5.25e-04 S  per =  1.3  per(accum) = 5.3
 T(symbolic_formulae_renorm     ) = 3.38e-03 S  per =  8.3  per(accum) = 14
 T(rintermediate init           ) = 1.55e-03 S  per =  3.8  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 8.03e-05 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 8.30e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 5.23e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 1.33e-04 S  per = 0.33  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.94e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 4.44e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.49e-04 S  per = 0.36  per(accum) = 1e+02

isweep=3 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.374e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47b66de0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.244e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000161 flops=2.74e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.973e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00222 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.39e-05,0.000938,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.7e-05,0.00194,0.000189 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00194 t_reduction=0.000189 tot=0.00213 ---
 sigma counter=158 i=0 t=0.000248 per=12.8 cost=7.01e+03 flops=2.82e+07
 sigma counter=158 i=1 t=0.000238 per=12.3 cost=6.99e+03 flops=2.94e+07
 sigma counter=158 i=2 t=0.000231 per=11.9 cost=6.81e+03 flops=2.95e+07
 sigma counter=158 i=3 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=158 i=4 t=0.000247 per=12.7 cost=1.89e+04 flops=7.65e+07
 sigma counter=158 i=5 t=0.000258 per=13.3 cost=1.89e+04 flops=7.32e+07
 sigma counter=158 i=6 t=0.000243 per=12.5 cost=6.78e+03 flops=2.79e+07
 sigma counter=158 i=7 t=0.00024 per=12.4 cost=6.81e+03 flops=2.84e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.294 t_reduction=0.0299 tot=0.323 ---
 sigma_tot counter=158 i=0 t=0.0365 per=12.4 cost=9.32e+05 flops=2.55e+07
 sigma_tot counter=158 i=1 t=0.0364 per=12.4 cost=9.43e+05 flops=2.59e+07
 sigma_tot counter=158 i=2 t=0.0365 per=12.4 cost=9.41e+05 flops=2.58e+07
 sigma_tot counter=158 i=3 t=0.0363 per=12.4 cost=9.47e+05 flops=2.61e+07
 sigma_tot counter=158 i=4 t=0.0361 per=12.3 cost=1.53e+06 flops=4.22e+07
 sigma_tot counter=158 i=5 t=0.0367 per=12.5 cost=1.52e+06 flops=4.15e+07
 sigma_tot counter=158 i=6 t=0.0383 per=13 cost=1.9e+06 flops=4.95e+07
 sigma_tot counter=158 i=7 t=0.0367 per=12.5 cost=1.89e+06 flops=5.15e+07
 total GEMM cost=1.06e+07 flops=3.61e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.002,0.000188 cost=7.9e+04 flops[gemm]=3.96e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.002 t_reduction=0.000188 tot=0.00218 ---
 sigma counter=159 i=0 t=0.00025 per=12.5 cost=7.01e+03 flops=2.8e+07
 sigma counter=159 i=1 t=0.000245 per=12.3 cost=6.99e+03 flops=2.85e+07
 sigma counter=159 i=2 t=0.000247 per=12.4 cost=6.81e+03 flops=2.76e+07
 sigma counter=159 i=3 t=0.000247 per=12.4 cost=6.78e+03 flops=2.75e+07
 sigma counter=159 i=4 t=0.000259 per=13 cost=1.89e+04 flops=7.3e+07
 sigma counter=159 i=5 t=0.000261 per=13.1 cost=1.89e+04 flops=7.24e+07
 sigma counter=159 i=6 t=0.000248 per=12.4 cost=6.78e+03 flops=2.74e+07
 sigma counter=159 i=7 t=0.000239 per=12 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.9e+04 flops=3.96e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.296 t_reduction=0.0301 tot=0.326 ---
 sigma_tot counter=159 i=0 t=0.0367 per=12.4 cost=9.39e+05 flops=2.55e+07
 sigma_tot counter=159 i=1 t=0.0367 per=12.4 cost=9.5e+05 flops=2.59e+07
 sigma_tot counter=159 i=2 t=0.0367 per=12.4 cost=9.48e+05 flops=2.58e+07
 sigma_tot counter=159 i=3 t=0.0366 per=12.4 cost=9.54e+05 flops=2.61e+07
 sigma_tot counter=159 i=4 t=0.0364 per=12.3 cost=1.55e+06 flops=4.25e+07
 sigma_tot counter=159 i=5 t=0.037 per=12.5 cost=1.54e+06 flops=4.17e+07
 sigma_tot counter=159 i=6 t=0.0386 per=13 cost=1.9e+06 flops=4.94e+07
 sigma_tot counter=159 i=7 t=0.0369 per=12.5 cost=1.9e+06 flops=5.13e+07
 total GEMM cost=1.07e+07 flops=3.61e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.56e-03  2.28e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.56e-03  2.28e-03
TIMING for Davidson : 4.58e-03  T(cal/comm/rest)=4.53e-03,1.01e-07,4.28e-05
optimized energies: isweep=3 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.706e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000161 flops=2.74e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 1.978e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000547 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.58e-05,0.000251,0.00025 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00107,0.000181 cost=1.55e+05 flops[gemm]=1.44e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00107 t_reduction=0.000181 tot=0.00125 ---
 renorm counter=16 i=0 t=0.000212 per=19.9 cost=5.64e+03 flops=2.66e+07
 renorm counter=16 i=1 t=0.00021 per=19.7 cost=1.13e+04 flops=5.37e+07
 renorm counter=16 i=2 t=0.000198 per=18.5 cost=1.66e+04 flops=8.36e+07
 renorm counter=16 i=3 t=0.000215 per=20.1 cost=2.89e+04 flops=1.34e+08
 renorm counter=16 i=4 t=1e-06 per=0.0936 cost=0 flops=0
 renorm counter=16 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=16 i=6 t=0.000232 per=21.7 cost=9.22e+04 flops=3.97e+08
 total GEMM cost=1.55e+05 flops=1.45e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0166 t_reduction=0.00287 tot=0.0195 ---
 renorm_tot counter=16 i=0 t=0.00331 per=20 cost=6.01e+04 flops=1.81e+07
 renorm_tot counter=16 i=1 t=0.00323 per=19.5 cost=8.77e+04 flops=2.71e+07
 renorm_tot counter=16 i=2 t=0.00156 per=9.39 cost=6.14e+04 flops=3.94e+07
 renorm_tot counter=16 i=3 t=0.00164 per=9.86 cost=1.07e+05 flops=6.54e+07
 renorm_tot counter=16 i=4 t=0.0016 per=9.65 cost=6.15e+04 flops=3.84e+07
 renorm_tot counter=16 i=5 t=0.00163 per=9.83 cost=1.06e+05 flops=6.51e+07
 renorm_tot counter=16 i=6 t=0.00362 per=21.8 cost=7.29e+05 flops=2.02e+08
 total GEMM cost=1.21e+06 flops=7.32e+07
check ||H-H.dagger||=1.04e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.5e-05,0.0027,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=4.99e-05,4.06e-05,9.04e-05 speed=0.214GB/s disk[used]=9.77e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.29e-02 S #####
 T(fetch) = 3.13e-04 S  per =  2.4  per(accum) = 2.4
 T(hdiag) = 6.96e-05 S  per = 0.54  per(accum) = 3
 T(dvdsn) = 8.75e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.22e-04 S  per =  2.5  per(accum) = 73
 T(guess) = 7.71e-05 S  per =  0.6  per(accum) = 74
 T(renrm) = 2.81e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.53e-04 S  per =  4.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.57e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.90e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.29e-04 S  per =  2.7  per(accum) = 3.1
 T(hintermediate init           ) = 2.01e-04 S  per =  2.3  per(accum) = 5.5
 T(hintermediates memcpy cpu2gpu) = 3.48e-06 S  per = 0.041  per(accum) = 5.5
 T(preprocess_hformulae_Hxlist2 ) = 2.23e-03 S  per =   26  per(accum) = 32
 T(hmmtasks init                ) = 1.29e-03 S  per =   15  per(accum) = 47
 T(dvdson solver [Hx_batchGPU]  ) = 4.53e-03 S  per =   53  per(accum) = 99
 T(dvdson solver [communication]) = 1.01e-07 S  per = 0.0012  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.28e-05 S  per =  0.5  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.76e-03 S
 T(qops init                    ) = 7.47e-05 S  per =  2.7  per(accum) = 2.7
 T(qops_dict memcpy cpu2gpu     ) = 3.54e-05 S  per =  1.3  per(accum) = 4
 T(symbolic_formulae_renorm     ) = 1.75e-04 S  per =  6.3  per(accum) = 10
 T(rintermediate init           ) = 2.01e-04 S  per =  7.3  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.61e-06 S  per = 0.17  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.55e-04 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.50e-04 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 8.05e-06 S  per = 0.29  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.73e-05 S  per = 0.99  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.58e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 9.89e-02 S #####
 T(fetch) = 7.78e-04 S  per = 0.79  per(accum) = 0.79
 T(hdiag) = 2.87e-04 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 8.38e-02 S  per =   85  per(accum) = 86
 T(decim) = 8.13e-04 S  per = 0.82  per(accum) = 87
 T(guess) = 3.12e-04 S  per = 0.32  per(accum) = 87
 T(renrm) = 1.07e-02 S  per =   11  per(accum) = 98
 T(save ) = 2.18e-03 S  per =  2.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.31e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.59e-04 S  per = 0.19  per(accum) = 0.19
 T(symbolic_formulae_twodot     ) = 9.09e-04 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 7.91e-04 S  per = 0.95  per(accum) = 2.2
 T(hintermediates memcpy cpu2gpu) = 1.42e-05 S  per = 0.017  per(accum) = 2.3
 T(preprocess_hformulae_Hxlist2 ) = 8.95e-03 S  per =   11  per(accum) = 13
 T(hmmtasks init                ) = 5.15e-03 S  per =  6.2  per(accum) = 19
 T(dvdson solver [Hx_batchGPU]  ) = 6.64e-02 S  per =   80  per(accum) = 99
 T(dvdson solver [communication]) = 1.32e-06 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.44e-04 S  per = 0.89  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.05e-02 S
 T(qops init                    ) = 3.32e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 1.25e-04 S  per =  1.2  per(accum) = 4.3
 T(symbolic_formulae_renorm     ) = 7.65e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 4.14e-04 S  per =  3.9  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 1.86e-05 S  per = 0.18  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 2.22e-03 S  per =   21  per(accum) = 37
 T(rmmtasks init                ) = 1.36e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 3.30e-05 S  per = 0.31  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 5.13e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.11e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.48e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 4.88e-01 S #####
 T(fetch) = 4.28e-03 S  per = 0.88  per(accum) = 0.88
 T(hdiag) = 1.41e-03 S  per = 0.29  per(accum) = 1.2
 T(dvdsn) = 4.23e-01 S  per =   87  per(accum) = 88
 T(decim) = 3.95e-03 S  per = 0.81  per(accum) = 89
 T(guess) = 1.36e-03 S  per = 0.28  per(accum) = 89
 T(renrm) = 4.45e-02 S  per =  9.1  per(accum) = 98
 T(save ) = 9.39e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.20e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 6.59e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 4.51e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 3.41e-03 S  per = 0.81  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 7.09e-05 S  per = 0.017  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 3.95e-02 S  per =  9.4  per(accum) = 11
 T(hmmtasks init                ) = 2.29e-02 S  per =  5.5  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 3.44e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 7.68e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.48e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.36e-02 S
 T(qops init                    ) = 1.73e-03 S  per =    4  per(accum) = 4
 T(qops_dict memcpy cpu2gpu     ) = 5.60e-04 S  per =  1.3  per(accum) = 5.2
 T(symbolic_formulae_renorm     ) = 3.55e-03 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.75e-03 S  per =    4  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 8.49e-05 S  per = 0.19  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 8.85e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 5.58e-03 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 1.41e-04 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 2.08e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 4.72e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.58e-04 S  per = 0.36  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=3
----------------------------------------------------------------------
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.035
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.012
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.038
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474789013e-09
 sweep energies: isweep=3 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=3 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=3
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.64e-01 | 1.64e-01 | 0.00e+00 1.04e-01 1.06e-02 1.15e-01 69.9
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.31e-01 | 2.95e-01 | 0.00e+00 1.90e-01 2.03e-02 2.10e-01 71.3
            2  2      20 1.00e-04 0.00e+00 | 31 | 9.89e-02 | 3.94e-01 | 0.00e+00 2.50e-01 2.66e-02 2.77e-01 70.4
            3  2      20 1.00e-04 0.00e+00 | 31 | 1.00e-01 | 4.94e-01 | 0.00e+00 3.12e-01 3.29e-02 3.45e-01 69.9
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.68e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (8.88e-16) e[1]=-2.43697745069 (-5.33e-15)
            3      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep3.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=+0.000e+00 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+1.110e-16 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep3.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.53e-15
 idx=3 node=(1,0) Drow=8 maxdiff=5.40e-16
 idx=4 node=(0,0) Drow=2 maxdiff=3.15e-16
stensor2: wf2 own=1 _data=0x4813fd00
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x4813fd00
     -7.0577e-18      -1.0000e+00 
     -1.0000e+00      -3.0850e-17 
 rwfuns: nroots=2 maxdiff=9.1708e-16
----- TIMING FOR ctns::rcanon_check : 8.287e-05 S -----
..... end of isweep = 3 .....

======================================================================
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=4 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 9.740e-07 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x481b7440
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.445e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000163 flops=2.71e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 2.011e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=6.33e-05,0.000949,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.7e-05,0.00194,0.000188 cost=7.9e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00194 t_reduction=0.000188 tot=0.00212 ---
 sigma counter=160 i=0 t=0.000239 per=12.3 cost=7.01e+03 flops=2.93e+07
 sigma counter=160 i=1 t=0.000241 per=12.4 cost=6.99e+03 flops=2.9e+07
 sigma counter=160 i=2 t=0.000233 per=12 cost=6.81e+03 flops=2.92e+07
 sigma counter=160 i=3 t=0.000235 per=12.1 cost=6.78e+03 flops=2.89e+07
 sigma counter=160 i=4 t=0.000252 per=13 cost=1.89e+04 flops=7.5e+07
 sigma counter=160 i=5 t=0.000257 per=13.3 cost=1.89e+04 flops=7.35e+07
 sigma counter=160 i=6 t=0.000247 per=12.8 cost=6.78e+03 flops=2.75e+07
 sigma counter=160 i=7 t=0.000233 per=12 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.9e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.298 t_reduction=0.0303 tot=0.328 ---
 sigma_tot counter=160 i=0 t=0.037 per=12.4 cost=9.46e+05 flops=2.56e+07
 sigma_tot counter=160 i=1 t=0.0369 per=12.4 cost=9.57e+05 flops=2.59e+07
 sigma_tot counter=160 i=2 t=0.0369 per=12.4 cost=9.55e+05 flops=2.59e+07
 sigma_tot counter=160 i=3 t=0.0368 per=12.4 cost=9.61e+05 flops=2.61e+07
 sigma_tot counter=160 i=4 t=0.0366 per=12.3 cost=1.56e+06 flops=4.27e+07
 sigma_tot counter=160 i=5 t=0.0372 per=12.5 cost=1.56e+06 flops=4.19e+07
 sigma_tot counter=160 i=6 t=0.0388 per=13 cost=1.91e+06 flops=4.92e+07
 sigma_tot counter=160 i=7 t=0.0372 per=12.5 cost=1.9e+06 flops=5.12e+07
 total GEMM cost=1.08e+07 flops=3.61e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.6e-05,0.00197,0.00019 cost=7.9e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00197 t_reduction=0.00019 tot=0.00216 ---
 sigma counter=161 i=0 t=0.000239 per=12.2 cost=7.01e+03 flops=2.93e+07
 sigma counter=161 i=1 t=0.000246 per=12.5 cost=6.99e+03 flops=2.84e+07
 sigma counter=161 i=2 t=0.000241 per=12.3 cost=6.81e+03 flops=2.83e+07
 sigma counter=161 i=3 t=0.000234 per=11.9 cost=6.78e+03 flops=2.9e+07
 sigma counter=161 i=4 t=0.000253 per=12.9 cost=1.89e+04 flops=7.47e+07
 sigma counter=161 i=5 t=0.000254 per=12.9 cost=1.89e+04 flops=7.44e+07
 sigma counter=161 i=6 t=0.000255 per=13 cost=6.78e+03 flops=2.66e+07
 sigma counter=161 i=7 t=0.000245 per=12.5 cost=6.81e+03 flops=2.78e+07
 total GEMM cost=7.9e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.299 t_reduction=0.0304 tot=0.33 ---
 sigma_tot counter=161 i=0 t=0.0372 per=12.4 cost=9.53e+05 flops=2.56e+07
 sigma_tot counter=161 i=1 t=0.0372 per=12.4 cost=9.64e+05 flops=2.59e+07
 sigma_tot counter=161 i=2 t=0.0372 per=12.4 cost=9.62e+05 flops=2.59e+07
 sigma_tot counter=161 i=3 t=0.0371 per=12.4 cost=9.67e+05 flops=2.61e+07
 sigma_tot counter=161 i=4 t=0.0369 per=12.3 cost=1.58e+06 flops=4.29e+07
 sigma_tot counter=161 i=5 t=0.0375 per=12.5 cost=1.58e+06 flops=4.21e+07
 sigma_tot counter=161 i=6 t=0.0391 per=13 cost=1.92e+06 flops=4.91e+07
 sigma_tot counter=161 i=7 t=0.0374 per=12.5 cost=1.91e+06 flops=5.1e+07
 total GEMM cost=1.08e+07 flops=3.62e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   4.53e-03  2.26e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   4.53e-03  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.80e-05,1.93e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.93e-04 tot=2.12e-03 ---
 sigma counter=162 i=0 t=2.44e-04 per=1.27e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=162 i=1 t=2.38e-04 per=1.24e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=162 i=2 t=2.31e-04 per=1.20e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=162 i=3 t=2.34e-04 per=1.21e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=162 i=4 t=2.44e-04 per=1.27e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=162 i=5 t=2.54e-04 per=1.32e+01 cost=1.89e+04 flops=7.44e+07
 sigma counter=162 i=6 t=2.47e-04 per=1.28e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=162 i=7 t=2.34e-04 per=1.21e+01 cost=6.81e+03 flops=2.91e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.01e-01 t_reduction=3.06e-02 tot=3.32e-01 ---
 sigma_tot counter=162 i=0 t=3.75e-02 per=1.24e+01 cost=9.60e+05 flops=2.56e+07
 sigma_tot counter=162 i=1 t=3.74e-02 per=1.24e+01 cost=9.71e+05 flops=2.60e+07
 sigma_tot counter=162 i=2 t=3.74e-02 per=1.24e+01 cost=9.69e+05 flops=2.59e+07
 sigma_tot counter=162 i=3 t=3.73e-02 per=1.24e+01 cost=9.74e+05 flops=2.61e+07
 sigma_tot counter=162 i=4 t=3.71e-02 per=1.23e+01 cost=1.60e+06 flops=4.31e+07
 sigma_tot counter=162 i=5 t=3.77e-02 per=1.25e+01 cost=1.60e+06 flops=4.24e+07
 sigma_tot counter=162 i=6 t=3.93e-02 per=1.30e+01 cost=1.92e+06 flops=4.89e+07
 sigma_tot counter=162 i=7 t=3.76e-02 per=1.25e+01 cost=1.92e+06 flops=5.09e+07
 total GEMM cost=1.09e+07 flops=3.62e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.88e-04 tot=2.12e-03 ---
 sigma counter=163 i=0 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=163 i=1 t=2.41e-04 per=1.25e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=163 i=2 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=163 i=3 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=163 i=4 t=2.52e-04 per=1.31e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=163 i=5 t=2.52e-04 per=1.31e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=163 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=163 i=7 t=2.33e-04 per=1.21e+01 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.03e-01 t_reduction=3.08e-02 tot=3.34e-01 ---
 sigma_tot counter=163 i=0 t=3.77e-02 per=1.24e+01 cost=9.67e+05 flops=2.56e+07
 sigma_tot counter=163 i=1 t=3.76e-02 per=1.24e+01 cost=9.78e+05 flops=2.60e+07
 sigma_tot counter=163 i=2 t=3.76e-02 per=1.24e+01 cost=9.75e+05 flops=2.59e+07
 sigma_tot counter=163 i=3 t=3.75e-02 per=1.24e+01 cost=9.81e+05 flops=2.61e+07
 sigma_tot counter=163 i=4 t=3.74e-02 per=1.23e+01 cost=1.62e+06 flops=4.33e+07
 sigma_tot counter=163 i=5 t=3.80e-02 per=1.25e+01 cost=1.62e+06 flops=4.26e+07
 sigma_tot counter=163 i=6 t=3.95e-02 per=1.30e+01 cost=1.93e+06 flops=4.88e+07
 sigma_tot counter=163 i=7 t=3.79e-02 per=1.25e+01 cost=1.92e+06 flops=5.08e+07
 total GEMM cost=1.10e+07 flops=3.62e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   9.03e-03  2.26e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   9.03e-03  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,2.87e-03,1.90e-04 cost=7.90e+04 flops[gemm]=2.75e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=2.87e-03 t_reduction=1.90e-04 tot=3.06e-03 ---
 sigma counter=164 i=0 t=2.40e-04 per=8.37e+00 cost=7.01e+03 flops=2.92e+07
 sigma counter=164 i=1 t=1.16e-03 per=4.05e+01 cost=6.99e+03 flops=6.02e+06
 sigma counter=164 i=2 t=2.36e-04 per=8.23e+00 cost=6.81e+03 flops=2.89e+07
 sigma counter=164 i=3 t=2.44e-04 per=8.51e+00 cost=6.78e+03 flops=2.78e+07
 sigma counter=164 i=4 t=2.52e-04 per=8.79e+00 cost=1.89e+04 flops=7.50e+07
 sigma counter=164 i=5 t=2.56e-04 per=8.93e+00 cost=1.89e+04 flops=7.38e+07
 sigma counter=164 i=6 t=2.44e-04 per=8.51e+00 cost=6.78e+03 flops=2.78e+07
 sigma counter=164 i=7 t=2.33e-04 per=8.13e+00 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.90e+04 flops=2.76e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.06e-01 t_reduction=3.10e-02 tot=3.37e-01 ---
 sigma_tot counter=164 i=0 t=3.79e-02 per=1.24e+01 cost=9.74e+05 flops=2.57e+07
 sigma_tot counter=164 i=1 t=3.88e-02 per=1.27e+01 cost=9.85e+05 flops=2.54e+07
 sigma_tot counter=164 i=2 t=3.79e-02 per=1.24e+01 cost=9.82e+05 flops=2.59e+07
 sigma_tot counter=164 i=3 t=3.78e-02 per=1.23e+01 cost=9.88e+05 flops=2.61e+07
 sigma_tot counter=164 i=4 t=3.77e-02 per=1.23e+01 cost=1.64e+06 flops=4.36e+07
 sigma_tot counter=164 i=5 t=3.83e-02 per=1.25e+01 cost=1.64e+06 flops=4.28e+07
 sigma_tot counter=164 i=6 t=3.98e-02 per=1.30e+01 cost=1.94e+06 flops=4.87e+07
 sigma_tot counter=164 i=7 t=3.81e-02 per=1.24e+01 cost=1.93e+06 flops=5.06e+07
 total GEMM cost=1.11e+07 flops=3.62e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.13e-03 ---
 sigma counter=165 i=0 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=165 i=1 t=2.42e-04 per=1.25e+01 cost=6.99e+03 flops=2.89e+07
 sigma counter=165 i=2 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=165 i=3 t=2.33e-04 per=1.20e+01 cost=6.78e+03 flops=2.91e+07
 sigma counter=165 i=4 t=2.55e-04 per=1.31e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=165 i=5 t=2.58e-04 per=1.33e+01 cost=1.89e+04 flops=7.32e+07
 sigma counter=165 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=165 i=7 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.08e-01 t_reduction=3.12e-02 tot=3.39e-01 ---
 sigma_tot counter=165 i=0 t=3.82e-02 per=1.24e+01 cost=9.81e+05 flops=2.57e+07
 sigma_tot counter=165 i=1 t=3.90e-02 per=1.27e+01 cost=9.92e+05 flops=2.54e+07
 sigma_tot counter=165 i=2 t=3.81e-02 per=1.24e+01 cost=9.89e+05 flops=2.59e+07
 sigma_tot counter=165 i=3 t=3.80e-02 per=1.23e+01 cost=9.94e+05 flops=2.62e+07
 sigma_tot counter=165 i=4 t=3.79e-02 per=1.23e+01 cost=1.66e+06 flops=4.38e+07
 sigma_tot counter=165 i=5 t=3.85e-02 per=1.25e+01 cost=1.66e+06 flops=4.30e+07
 sigma_tot counter=165 i=6 t=4.00e-02 per=1.30e+01 cost=1.94e+06 flops=4.85e+07
 sigma_tot counter=165 i=7 t=3.83e-02 per=1.24e+01 cost=1.94e+06 flops=5.05e+07
 total GEMM cost=1.11e+07 flops=3.62e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   1.45e-02  2.41e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   1.45e-02  2.41e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.13e-03 ---
 sigma counter=166 i=0 t=2.42e-04 per=1.25e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=166 i=1 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=166 i=2 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=166 i=3 t=2.34e-04 per=1.21e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=166 i=4 t=2.55e-04 per=1.32e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=166 i=5 t=2.55e-04 per=1.32e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=166 i=6 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=166 i=7 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.10e-01 t_reduction=3.14e-02 tot=3.41e-01 ---
 sigma_tot counter=166 i=0 t=3.84e-02 per=1.24e+01 cost=9.88e+05 flops=2.57e+07
 sigma_tot counter=166 i=1 t=3.93e-02 per=1.27e+01 cost=9.99e+05 flops=2.54e+07
 sigma_tot counter=166 i=2 t=3.84e-02 per=1.24e+01 cost=9.96e+05 flops=2.60e+07
 sigma_tot counter=166 i=3 t=3.82e-02 per=1.23e+01 cost=1.00e+06 flops=2.62e+07
 sigma_tot counter=166 i=4 t=3.82e-02 per=1.23e+01 cost=1.68e+06 flops=4.40e+07
 sigma_tot counter=166 i=5 t=3.88e-02 per=1.25e+01 cost=1.67e+06 flops=4.32e+07
 sigma_tot counter=166 i=6 t=4.03e-02 per=1.30e+01 cost=1.95e+06 flops=4.84e+07
 sigma_tot counter=166 i=7 t=3.86e-02 per=1.24e+01 cost=1.94e+06 flops=5.04e+07
 total GEMM cost=1.12e+07 flops=3.62e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.94e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.90e-04 tot=2.13e-03 ---
 sigma counter=167 i=0 t=2.42e-04 per=1.24e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=167 i=1 t=2.39e-04 per=1.23e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=167 i=2 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=167 i=3 t=2.42e-04 per=1.24e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=167 i=4 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=167 i=5 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=167 i=6 t=2.51e-04 per=1.29e+01 cost=6.78e+03 flops=2.70e+07
 sigma counter=167 i=7 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.12e-01 t_reduction=3.16e-02 tot=3.44e-01 ---
 sigma_tot counter=167 i=0 t=3.87e-02 per=1.24e+01 cost=9.95e+05 flops=2.57e+07
 sigma_tot counter=167 i=1 t=3.95e-02 per=1.27e+01 cost=1.01e+06 flops=2.54e+07
 sigma_tot counter=167 i=2 t=3.86e-02 per=1.24e+01 cost=1.00e+06 flops=2.60e+07
 sigma_tot counter=167 i=3 t=3.85e-02 per=1.23e+01 cost=1.01e+06 flops=2.62e+07
 sigma_tot counter=167 i=4 t=3.84e-02 per=1.23e+01 cost=1.70e+06 flops=4.42e+07
 sigma_tot counter=167 i=5 t=3.90e-02 per=1.25e+01 cost=1.69e+06 flops=4.34e+07
 sigma_tot counter=167 i=6 t=4.05e-02 per=1.30e+01 cost=1.96e+06 flops=4.83e+07
 sigma_tot counter=167 i=7 t=3.88e-02 per=1.24e+01 cost=1.95e+06 flops=5.02e+07
 total GEMM cost=1.13e+07 flops=3.62e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.90e-02  2.37e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.90e-02  2.37e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.96e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.14e-03 ---
 sigma counter=168 i=0 t=2.39e-04 per=1.22e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=168 i=1 t=2.37e-04 per=1.21e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=168 i=2 t=2.46e-04 per=1.26e+01 cost=6.81e+03 flops=2.77e+07
 sigma counter=168 i=3 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=168 i=4 t=2.53e-04 per=1.29e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=168 i=5 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=168 i=6 t=2.52e-04 per=1.29e+01 cost=6.78e+03 flops=2.69e+07
 sigma counter=168 i=7 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.14e-01 t_reduction=3.18e-02 tot=3.46e-01 ---
 sigma_tot counter=168 i=0 t=3.89e-02 per=1.24e+01 cost=1.00e+06 flops=2.58e+07
 sigma_tot counter=168 i=1 t=3.98e-02 per=1.27e+01 cost=1.01e+06 flops=2.55e+07
 sigma_tot counter=168 i=2 t=3.88e-02 per=1.24e+01 cost=1.01e+06 flops=2.60e+07
 sigma_tot counter=168 i=3 t=3.87e-02 per=1.23e+01 cost=1.01e+06 flops=2.62e+07
 sigma_tot counter=168 i=4 t=3.87e-02 per=1.23e+01 cost=1.72e+06 flops=4.44e+07
 sigma_tot counter=168 i=5 t=3.93e-02 per=1.25e+01 cost=1.71e+06 flops=4.36e+07
 sigma_tot counter=168 i=6 t=4.08e-02 per=1.30e+01 cost=1.96e+06 flops=4.82e+07
 sigma_tot counter=168 i=7 t=3.90e-02 per=1.24e+01 cost=1.96e+06 flops=5.01e+07
 total GEMM cost=1.14e+07 flops=3.63e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.94e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.13e-03 ---
 sigma counter=169 i=0 t=2.39e-04 per=1.23e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=169 i=1 t=2.39e-04 per=1.23e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=169 i=2 t=2.40e-04 per=1.24e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=169 i=3 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=169 i=4 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=169 i=5 t=2.57e-04 per=1.33e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=169 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=169 i=7 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.16e-01 t_reduction=3.20e-02 tot=3.48e-01 ---
 sigma_tot counter=169 i=0 t=3.91e-02 per=1.24e+01 cost=1.01e+06 flops=2.58e+07
 sigma_tot counter=169 i=1 t=4.00e-02 per=1.27e+01 cost=1.02e+06 flops=2.55e+07
 sigma_tot counter=169 i=2 t=3.91e-02 per=1.24e+01 cost=1.02e+06 flops=2.60e+07
 sigma_tot counter=169 i=3 t=3.90e-02 per=1.23e+01 cost=1.02e+06 flops=2.62e+07
 sigma_tot counter=169 i=4 t=3.89e-02 per=1.23e+01 cost=1.73e+06 flops=4.46e+07
 sigma_tot counter=169 i=5 t=3.95e-02 per=1.25e+01 cost=1.73e+06 flops=4.38e+07
 sigma_tot counter=169 i=6 t=4.10e-02 per=1.30e+01 cost=1.97e+06 flops=4.80e+07
 sigma_tot counter=169 i=7 t=3.93e-02 per=1.24e+01 cost=1.96e+06 flops=5.00e+07
 total GEMM cost=1.15e+07 flops=3.63e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   2.35e-02  2.35e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   2.35e-02  2.35e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.95e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.91e-04 tot=2.14e-03 ---
 sigma counter=170 i=0 t=2.42e-04 per=1.24e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=170 i=1 t=2.43e-04 per=1.25e+01 cost=6.99e+03 flops=2.88e+07
 sigma counter=170 i=2 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=170 i=3 t=2.38e-04 per=1.22e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=170 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=170 i=5 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=170 i=6 t=2.47e-04 per=1.27e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=170 i=7 t=2.29e-04 per=1.18e+01 cost=6.81e+03 flops=2.98e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.18e-01 t_reduction=3.22e-02 tot=3.50e-01 ---
 sigma_tot counter=170 i=0 t=3.94e-02 per=1.24e+01 cost=1.02e+06 flops=2.58e+07
 sigma_tot counter=170 i=1 t=4.02e-02 per=1.27e+01 cost=1.03e+06 flops=2.55e+07
 sigma_tot counter=170 i=2 t=3.93e-02 per=1.24e+01 cost=1.02e+06 flops=2.60e+07
 sigma_tot counter=170 i=3 t=3.92e-02 per=1.23e+01 cost=1.03e+06 flops=2.62e+07
 sigma_tot counter=170 i=4 t=3.92e-02 per=1.23e+01 cost=1.75e+06 flops=4.48e+07
 sigma_tot counter=170 i=5 t=3.98e-02 per=1.25e+01 cost=1.75e+06 flops=4.40e+07
 sigma_tot counter=170 i=6 t=4.13e-02 per=1.30e+01 cost=1.98e+06 flops=4.79e+07
 sigma_tot counter=170 i=7 t=3.95e-02 per=1.24e+01 cost=1.97e+06 flops=4.99e+07
 total GEMM cost=1.15e+07 flops=3.63e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.13e-03 ---
 sigma counter=171 i=0 t=2.38e-04 per=1.23e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=171 i=1 t=2.36e-04 per=1.22e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=171 i=2 t=2.37e-04 per=1.22e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=171 i=3 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=171 i=4 t=2.48e-04 per=1.28e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=171 i=5 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=171 i=6 t=2.51e-04 per=1.29e+01 cost=6.78e+03 flops=2.70e+07
 sigma counter=171 i=7 t=2.34e-04 per=1.21e+01 cost=6.81e+03 flops=2.91e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.20e-01 t_reduction=3.23e-02 tot=3.52e-01 ---
 sigma_tot counter=171 i=0 t=3.96e-02 per=1.24e+01 cost=1.02e+06 flops=2.58e+07
 sigma_tot counter=171 i=1 t=4.05e-02 per=1.27e+01 cost=1.03e+06 flops=2.55e+07
 sigma_tot counter=171 i=2 t=3.96e-02 per=1.24e+01 cost=1.03e+06 flops=2.60e+07
 sigma_tot counter=171 i=3 t=3.94e-02 per=1.23e+01 cost=1.04e+06 flops=2.63e+07
 sigma_tot counter=171 i=4 t=3.94e-02 per=1.23e+01 cost=1.77e+06 flops=4.50e+07
 sigma_tot counter=171 i=5 t=4.00e-02 per=1.25e+01 cost=1.77e+06 flops=4.42e+07
 sigma_tot counter=171 i=6 t=4.15e-02 per=1.30e+01 cost=1.98e+06 flops=4.78e+07
 sigma_tot counter=171 i=7 t=3.97e-02 per=1.24e+01 cost=1.98e+06 flops=4.97e+07
 total GEMM cost=1.16e+07 flops=3.63e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   2.80e-02  2.34e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   2.80e-02  2.34e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.94e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.12e-03 ---
 sigma counter=172 i=0 t=2.42e-04 per=1.25e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=172 i=1 t=2.38e-04 per=1.23e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=172 i=2 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=172 i=3 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=172 i=4 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=172 i=5 t=2.55e-04 per=1.32e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=172 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=172 i=7 t=2.29e-04 per=1.18e+01 cost=6.81e+03 flops=2.98e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.22e-01 t_reduction=3.25e-02 tot=3.54e-01 ---
 sigma_tot counter=172 i=0 t=3.99e-02 per=1.24e+01 cost=1.03e+06 flops=2.58e+07
 sigma_tot counter=172 i=1 t=4.07e-02 per=1.27e+01 cost=1.04e+06 flops=2.56e+07
 sigma_tot counter=172 i=2 t=3.98e-02 per=1.24e+01 cost=1.04e+06 flops=2.61e+07
 sigma_tot counter=172 i=3 t=3.97e-02 per=1.23e+01 cost=1.04e+06 flops=2.63e+07
 sigma_tot counter=172 i=4 t=3.97e-02 per=1.23e+01 cost=1.79e+06 flops=4.51e+07
 sigma_tot counter=172 i=5 t=4.03e-02 per=1.25e+01 cost=1.79e+06 flops=4.44e+07
 sigma_tot counter=172 i=6 t=4.18e-02 per=1.30e+01 cost=1.99e+06 flops=4.77e+07
 sigma_tot counter=172 i=7 t=4.00e-02 per=1.24e+01 cost=1.98e+06 flops=4.96e+07
 total GEMM cost=1.17e+07 flops=3.64e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   3.03e-02  2.33e-03
    7   1 +      -2.436977447171  -4.44e-16   7.42e-05    5    13   3.03e-02  2.33e-03
TIMING for Davidson : 3.03e-02  T(cal/comm/rest)=3.00e-02,5.35e-07,3.40e-04
optimized energies: isweep=4 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.999e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000546 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.76e-05,0.000218,0.00027 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00107,0.000184 cost=2.78e+04 flops[gemm]=2.59e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00107 t_reduction=0.000184 tot=0.00126 ---
 renorm counter=17 i=0 t=0.000219 per=20.4 cost=2.19e+03 flops=1e+07
 renorm counter=17 i=1 t=0.000206 per=19.2 cost=2.85e+03 flops=1.39e+07
 renorm counter=17 i=2 t=1e-06 per=0.0934 cost=0 flops=0
 renorm counter=17 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=17 i=4 t=0.000201 per=18.8 cost=2.11e+03 flops=1.05e+07
 renorm counter=17 i=5 t=0.000206 per=19.2 cost=2.94e+03 flops=1.43e+07
 renorm counter=17 i=6 t=0.000238 per=22.2 cost=1.77e+04 flops=7.44e+07
 total GEMM cost=2.78e+04 flops=2.59e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0177 t_reduction=0.00306 tot=0.0207 ---
 renorm_tot counter=17 i=0 t=0.00353 per=20 cost=6.23e+04 flops=1.76e+07
 renorm_tot counter=17 i=1 t=0.00344 per=19.5 cost=9.06e+04 flops=2.63e+07
 renorm_tot counter=17 i=2 t=0.00156 per=8.82 cost=6.14e+04 flops=3.94e+07
 renorm_tot counter=17 i=3 t=0.00164 per=9.27 cost=1.07e+05 flops=6.54e+07
 renorm_tot counter=17 i=4 t=0.0018 per=10.2 cost=6.36e+04 flops=3.53e+07
 renorm_tot counter=17 i=5 t=0.00184 per=10.4 cost=1.09e+05 flops=5.94e+07
 renorm_tot counter=17 i=6 t=0.00385 per=21.8 cost=7.47e+05 flops=1.94e+08
 total GEMM cost=1.24e+06 flops=7.03e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.9e-05,0.0025,8.8e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=5.36e-05,3.43e-05,8.79e-05 speed=0.118GB/s disk[used]=9.88e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.80e-02 S #####
 T(fetch) = 7.55e-05 S  per =  0.2  per(accum) = 0.2
 T(hdiag) = 7.39e-05 S  per = 0.19  per(accum) = 0.39
 T(dvdsn) = 3.45e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.93e-05 S  per = 0.21  per(accum) = 91
 T(guess) = 7.95e-05 S  per = 0.21  per(accum) = 92
 T(renrm) = 2.65e-03 S  per =    7  per(accum) = 99
 T(save ) = 5.59e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.43e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.05e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.49e-04 S  per = 0.73  per(accum) = 0.84
 T(hintermediate init           ) = 2.05e-04 S  per =  0.6  per(accum) = 1.4
 T(hintermediates memcpy cpu2gpu) = 3.73e-06 S  per = 0.011  per(accum) = 1.4
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.5  per(accum) = 8
 T(hmmtasks init                ) = 1.29e-03 S  per =  3.8  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 3.00e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 5.35e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.40e-04 S  per = 0.99  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 8.93e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.83e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.05e-04 S  per =  7.9  per(accum) = 12
 T(rintermediate init           ) = 1.17e-05 S  per = 0.45  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.74e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.54e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.36e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.44e-06 S  per = 0.32  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.81e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.83e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 3.80e-02 S #####
 T(fetch) = 7.55e-05 S  per =  0.2  per(accum) = 0.2
 T(hdiag) = 7.39e-05 S  per = 0.19  per(accum) = 0.39
 T(dvdsn) = 3.45e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.93e-05 S  per = 0.21  per(accum) = 91
 T(guess) = 7.95e-05 S  per = 0.21  per(accum) = 92
 T(renrm) = 2.65e-03 S  per =    7  per(accum) = 99
 T(save ) = 5.59e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.43e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.05e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.49e-04 S  per = 0.73  per(accum) = 0.84
 T(hintermediate init           ) = 2.05e-04 S  per =  0.6  per(accum) = 1.4
 T(hintermediates memcpy cpu2gpu) = 3.73e-06 S  per = 0.011  per(accum) = 1.4
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.5  per(accum) = 8
 T(hmmtasks init                ) = 1.29e-03 S  per =  3.8  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 3.00e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 5.35e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.40e-04 S  per = 0.99  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 8.93e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.83e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.05e-04 S  per =  7.9  per(accum) = 12
 T(rintermediate init           ) = 1.17e-05 S  per = 0.45  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.74e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.54e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.36e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.44e-06 S  per = 0.32  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.81e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.83e-06 S  per = 0.34  per(accum) = 1e+02
##### time_global: 5.26e-01 S #####
 T(fetch) = 4.35e-03 S  per = 0.83  per(accum) = 0.83
 T(hdiag) = 1.48e-03 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 4.58e-01 S  per =   87  per(accum) = 88
 T(decim) = 4.03e-03 S  per = 0.77  per(accum) = 89
 T(guess) = 1.44e-03 S  per = 0.27  per(accum) = 89
 T(renrm) = 4.71e-02 S  per =  8.9  per(accum) = 98
 T(save ) = 9.95e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.54e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 6.99e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 4.76e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 3.62e-03 S  per =  0.8  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 7.46e-05 S  per = 0.016  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 4.18e-02 S  per =  9.2  per(accum) = 11
 T(hmmtasks init                ) = 2.42e-02 S  per =  5.3  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 3.74e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 8.22e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.82e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.62e-02 S
 T(qops init                    ) = 1.82e-03 S  per =  3.9  per(accum) = 3.9
 T(qops_dict memcpy cpu2gpu     ) = 5.89e-04 S  per =  1.3  per(accum) = 5.2
 T(symbolic_formulae_renorm     ) = 3.76e-03 S  per =  8.1  per(accum) = 13
 T(rintermediate init           ) = 1.76e-03 S  per =  3.8  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 8.96e-05 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 9.41e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 5.91e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.49e-04 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 2.21e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.00e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.67e-04 S  per = 0.36  per(accum) = 1e+02

isweep=4 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.535e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47cfba70
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.172e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000161 flops=2.74e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.981e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00225 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.23e-05,0.000964,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.7e-05,0.00194,0.000188 cost=7.9e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00194 t_reduction=0.000188 tot=0.00213 ---
 sigma counter=173 i=0 t=0.000239 per=12.3 cost=6.81e+03 flops=2.85e+07
 sigma counter=173 i=1 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=173 i=2 t=0.000239 per=12.3 cost=7.01e+03 flops=2.93e+07
 sigma counter=173 i=3 t=0.000233 per=12 cost=6.99e+03 flops=3e+07
 sigma counter=173 i=4 t=0.000237 per=12.2 cost=6.81e+03 flops=2.88e+07
 sigma counter=173 i=5 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=173 i=6 t=0.000269 per=13.8 cost=1.89e+04 flops=7.02e+07
 sigma counter=173 i=7 t=0.000253 per=13 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.9e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.324 t_reduction=0.0327 tot=0.356 ---
 sigma_tot counter=173 i=0 t=0.0401 per=12.4 cost=1.04e+06 flops=2.58e+07
 sigma_tot counter=173 i=1 t=0.0409 per=12.7 cost=1.05e+06 flops=2.56e+07
 sigma_tot counter=173 i=2 t=0.04 per=12.4 cost=1.04e+06 flops=2.61e+07
 sigma_tot counter=173 i=3 t=0.0399 per=12.3 cost=1.05e+06 flops=2.63e+07
 sigma_tot counter=173 i=4 t=0.0399 per=12.3 cost=1.8e+06 flops=4.51e+07
 sigma_tot counter=173 i=5 t=0.0405 per=12.5 cost=1.79e+06 flops=4.43e+07
 sigma_tot counter=173 i=6 t=0.042 per=13 cost=2.01e+06 flops=4.78e+07
 sigma_tot counter=173 i=7 t=0.0402 per=12.4 cost=2e+06 flops=4.98e+07
 total GEMM cost=1.18e+07 flops=3.64e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00195,0.00019 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00195 t_reduction=0.00019 tot=0.00214 ---
 sigma counter=174 i=0 t=0.000236 per=12.1 cost=6.81e+03 flops=2.89e+07
 sigma counter=174 i=1 t=0.000239 per=12.3 cost=6.78e+03 flops=2.84e+07
 sigma counter=174 i=2 t=0.000239 per=12.3 cost=7.01e+03 flops=2.93e+07
 sigma counter=174 i=3 t=0.000239 per=12.3 cost=6.99e+03 flops=2.92e+07
 sigma counter=174 i=4 t=0.000232 per=11.9 cost=6.81e+03 flops=2.94e+07
 sigma counter=174 i=5 t=0.000243 per=12.5 cost=6.78e+03 flops=2.79e+07
 sigma counter=174 i=6 t=0.000268 per=13.7 cost=1.89e+04 flops=7.05e+07
 sigma counter=174 i=7 t=0.000254 per=13 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.326 t_reduction=0.0329 tot=0.359 ---
 sigma_tot counter=174 i=0 t=0.0403 per=12.4 cost=1.04e+06 flops=2.59e+07
 sigma_tot counter=174 i=1 t=0.0412 per=12.6 cost=1.05e+06 flops=2.56e+07
 sigma_tot counter=174 i=2 t=0.0403 per=12.4 cost=1.05e+06 flops=2.61e+07
 sigma_tot counter=174 i=3 t=0.0401 per=12.3 cost=1.06e+06 flops=2.63e+07
 sigma_tot counter=174 i=4 t=0.0401 per=12.3 cost=1.8e+06 flops=4.5e+07
 sigma_tot counter=174 i=5 t=0.0408 per=12.5 cost=1.8e+06 flops=4.42e+07
 sigma_tot counter=174 i=6 t=0.0423 per=13 cost=2.03e+06 flops=4.8e+07
 sigma_tot counter=174 i=7 t=0.0405 per=12.4 cost=2.02e+06 flops=4.99e+07
 total GEMM cost=1.19e+07 flops=3.64e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.52e-03  2.26e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   4.52e-03  2.26e-03
TIMING for Davidson : 4.53e-03  T(cal/comm/rest)=4.49e-03,8.70e-08,4.28e-05
optimized energies: isweep=4 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.663e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000173 flops=2.55e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 2.092e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000532 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.57e-05,0.000222,0.000264 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00109,0.000186 cost=1.55e+05 flops[gemm]=1.43e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00109 t_reduction=0.000186 tot=0.00127 ---
 renorm counter=18 i=0 t=0.000223 per=20.5 cost=8.1e+03 flops=3.63e+07
 renorm counter=18 i=1 t=0.000202 per=18.6 cost=8.36e+03 flops=4.14e+07
 renorm counter=18 i=2 t=1e-06 per=0.0921 cost=0 flops=0
 renorm counter=18 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=18 i=4 t=0.000209 per=19.2 cost=1.65e+04 flops=7.89e+07
 renorm counter=18 i=5 t=0.000209 per=19.2 cost=2.89e+04 flops=1.38e+08
 renorm counter=18 i=6 t=0.000242 per=22.3 cost=9.32e+04 flops=3.85e+08
 total GEMM cost=1.55e+05 flops=1.43e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0187 t_reduction=0.00324 tot=0.022 ---
 renorm_tot counter=18 i=0 t=0.00375 per=20 cost=7.04e+04 flops=1.87e+07
 renorm_tot counter=18 i=1 t=0.00364 per=19.4 cost=9.9e+04 flops=2.72e+07
 renorm_tot counter=18 i=2 t=0.00156 per=8.32 cost=6.14e+04 flops=3.94e+07
 renorm_tot counter=18 i=3 t=0.00164 per=8.73 cost=1.07e+05 flops=6.54e+07
 renorm_tot counter=18 i=4 t=0.00201 per=10.7 cost=8.01e+04 flops=3.98e+07
 renorm_tot counter=18 i=5 t=0.00204 per=10.9 cost=1.38e+05 flops=6.75e+07
 renorm_tot counter=18 i=6 t=0.00409 per=21.8 cost=8.4e+05 flops=2.05e+08
 total GEMM cost=1.4e+06 flops=7.45e+07
check ||H-H.dagger||=9.16e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.5e-05,0.0027,8.9e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=5.02e-05,4.13e-05,9.15e-05 speed=0.212GB/s disk[used]=0.0001GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.29e-02 S #####
 T(fetch) = 3.27e-04 S  per =  2.5  per(accum) = 2.5
 T(hdiag) = 7.30e-05 S  per = 0.57  per(accum) = 3.1
 T(dvdsn) = 8.74e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.09e-04 S  per =  2.4  per(accum) = 73
 T(guess) = 7.77e-05 S  per =  0.6  per(accum) = 74
 T(renrm) = 2.82e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.64e-04 S  per =  4.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.55e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 4.55e-05 S  per = 0.53  per(accum) = 0.53
 T(symbolic_formulae_twodot     ) = 2.22e-04 S  per =  2.6  per(accum) = 3.1
 T(hintermediate init           ) = 2.01e-04 S  per =  2.4  per(accum) = 5.5
 T(hintermediates memcpy cpu2gpu) = 3.50e-06 S  per = 0.041  per(accum) = 5.5
 T(preprocess_hformulae_Hxlist2 ) = 2.26e-03 S  per =   26  per(accum) = 32
 T(hmmtasks init                ) = 1.28e-03 S  per =   15  per(accum) = 47
 T(dvdson solver [Hx_batchGPU]  ) = 4.49e-03 S  per =   53  per(accum) = 99
 T(dvdson solver [communication]) = 8.70e-08 S  per = 0.001  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.28e-05 S  per =  0.5  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.77e-03 S
 T(qops init                    ) = 7.54e-05 S  per =  2.7  per(accum) = 2.7
 T(qops_dict memcpy cpu2gpu     ) = 3.51e-05 S  per =  1.3  per(accum) = 4
 T(symbolic_formulae_renorm     ) = 1.71e-04 S  per =  6.2  per(accum) = 10
 T(rintermediate init           ) = 2.12e-04 S  per =  7.7  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.24e-06 S  per = 0.15  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.41e-04 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 3.49e-04 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 7.80e-06 S  per = 0.28  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 1.34e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.72e-05 S  per = 0.98  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.88e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 5.10e-02 S #####
 T(fetch) = 4.02e-04 S  per = 0.79  per(accum) = 0.79
 T(hdiag) = 1.47e-04 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 4.33e-02 S  per =   85  per(accum) = 86
 T(decim) = 3.89e-04 S  per = 0.76  per(accum) = 87
 T(guess) = 1.57e-04 S  per = 0.31  per(accum) = 87
 T(renrm) = 5.47e-03 S  per =   11  per(accum) = 98
 T(save ) = 1.12e-03 S  per =  2.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.29e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 8.60e-05 S  per =  0.2  per(accum) = 0.2
 T(symbolic_formulae_twodot     ) = 4.71e-04 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 4.06e-04 S  per = 0.95  per(accum) = 2.2
 T(hintermediates memcpy cpu2gpu) = 7.24e-06 S  per = 0.017  per(accum) = 2.3
 T(preprocess_hformulae_Hxlist2 ) = 4.50e-03 S  per =   10  per(accum) = 13
 T(hmmtasks init                ) = 2.57e-03 S  per =    6  per(accum) = 19
 T(dvdson solver [Hx_batchGPU]  ) = 3.45e-02 S  per =   80  per(accum) = 99
 T(dvdson solver [communication]) = 6.22e-07 S  per = 0.0015  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.83e-04 S  per = 0.89  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.37e-03 S
 T(qops init                    ) = 1.65e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 6.34e-05 S  per =  1.2  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 3.76e-04 S  per =    7  per(accum) = 11
 T(rintermediate init           ) = 2.24e-04 S  per =  4.2  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 8.98e-06 S  per = 0.17  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 1.10e-03 S  per =   20  per(accum) = 36
 T(rmmtasks init                ) = 6.85e-04 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 1.62e-05 S  per =  0.3  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 2.66e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.53e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.77e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 5.39e-01 S #####
 T(fetch) = 4.68e-03 S  per = 0.87  per(accum) = 0.87
 T(hdiag) = 1.55e-03 S  per = 0.29  per(accum) = 1.2
 T(dvdsn) = 4.67e-01 S  per =   87  per(accum) = 88
 T(decim) = 4.34e-03 S  per =  0.8  per(accum) = 89
 T(guess) = 1.52e-03 S  per = 0.28  per(accum) = 89
 T(renrm) = 4.99e-02 S  per =  9.3  per(accum) = 98
 T(save ) = 1.05e-02 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.63e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 7.45e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 4.98e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 3.82e-03 S  per = 0.83  per(accum) = 2.1
 T(hintermediates memcpy cpu2gpu) = 7.81e-05 S  per = 0.017  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 4.40e-02 S  per =  9.5  per(accum) = 12
 T(hmmtasks init                ) = 2.55e-02 S  per =  5.5  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 3.79e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 8.30e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.86e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.90e-02 S
 T(qops init                    ) = 1.89e-03 S  per =  3.9  per(accum) = 3.9
 T(qops_dict memcpy cpu2gpu     ) = 6.24e-04 S  per =  1.3  per(accum) = 5.1
 T(symbolic_formulae_renorm     ) = 3.93e-03 S  per =    8  per(accum) = 13
 T(rintermediate init           ) = 1.97e-03 S  per =    4  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 9.38e-05 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 9.95e-03 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 6.26e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.57e-04 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 2.34e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.27e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.75e-04 S  per = 0.36  per(accum) = 1e+02

isweep=4 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.148e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47cfdb20
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.250e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000159 flops=2.78e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.955e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00225 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.27e-05,0.000964,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.5e-05,0.00193,0.00019 cost=7.9e+04 flops[gemm]=4.1e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00193 t_reduction=0.00019 tot=0.00212 ---
 sigma counter=175 i=0 t=0.000242 per=12.6 cost=6.81e+03 flops=2.82e+07
 sigma counter=175 i=1 t=0.000238 per=12.4 cost=6.78e+03 flops=2.85e+07
 sigma counter=175 i=2 t=0.000235 per=12.2 cost=7.01e+03 flops=2.98e+07
 sigma counter=175 i=3 t=0.000237 per=12.3 cost=6.99e+03 flops=2.95e+07
 sigma counter=175 i=4 t=0.000231 per=12 cost=6.81e+03 flops=2.95e+07
 sigma counter=175 i=5 t=0.000235 per=12.2 cost=6.78e+03 flops=2.89e+07
 sigma counter=175 i=6 t=0.000265 per=13.8 cost=1.89e+04 flops=7.13e+07
 sigma counter=175 i=7 t=0.000244 per=12.7 cost=1.89e+04 flops=7.74e+07
 total GEMM cost=7.9e+04 flops=4.1e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.328 t_reduction=0.0331 tot=0.361 ---
 sigma_tot counter=175 i=0 t=0.0406 per=12.4 cost=1.05e+06 flops=2.59e+07
 sigma_tot counter=175 i=1 t=0.0414 per=12.6 cost=1.06e+06 flops=2.56e+07
 sigma_tot counter=175 i=2 t=0.0405 per=12.4 cost=1.06e+06 flops=2.61e+07
 sigma_tot counter=175 i=3 t=0.0404 per=12.3 cost=1.06e+06 flops=2.63e+07
 sigma_tot counter=175 i=4 t=0.0404 per=12.3 cost=1.81e+06 flops=4.49e+07
 sigma_tot counter=175 i=5 t=0.041 per=12.5 cost=1.81e+06 flops=4.41e+07
 sigma_tot counter=175 i=6 t=0.0426 per=13 cost=2.05e+06 flops=4.81e+07
 sigma_tot counter=175 i=7 t=0.0407 per=12.4 cost=2.04e+06 flops=5.01e+07
 total GEMM cost=1.19e+07 flops=3.64e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00195,0.000188 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00195 t_reduction=0.000188 tot=0.00214 ---
 sigma counter=176 i=0 t=0.000237 per=12.2 cost=6.81e+03 flops=2.88e+07
 sigma counter=176 i=1 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=176 i=2 t=0.000233 per=12 cost=7.01e+03 flops=3.01e+07
 sigma counter=176 i=3 t=0.000246 per=12.6 cost=6.99e+03 flops=2.84e+07
 sigma counter=176 i=4 t=0.000232 per=11.9 cost=6.81e+03 flops=2.94e+07
 sigma counter=176 i=5 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=176 i=6 t=0.000267 per=13.7 cost=1.89e+04 flops=7.08e+07
 sigma counter=176 i=7 t=0.000259 per=13.3 cost=1.89e+04 flops=7.3e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.33 t_reduction=0.0333 tot=0.363 ---
 sigma_tot counter=176 i=0 t=0.0408 per=12.4 cost=1.06e+06 flops=2.59e+07
 sigma_tot counter=176 i=1 t=0.0417 per=12.6 cost=1.07e+06 flops=2.56e+07
 sigma_tot counter=176 i=2 t=0.0407 per=12.4 cost=1.06e+06 flops=2.61e+07
 sigma_tot counter=176 i=3 t=0.0406 per=12.3 cost=1.07e+06 flops=2.63e+07
 sigma_tot counter=176 i=4 t=0.0406 per=12.3 cost=1.82e+06 flops=4.48e+07
 sigma_tot counter=176 i=5 t=0.0413 per=12.5 cost=1.81e+06 flops=4.4e+07
 sigma_tot counter=176 i=6 t=0.0428 per=13 cost=2.07e+06 flops=4.82e+07
 sigma_tot counter=176 i=7 t=0.041 per=12.4 cost=2.06e+06 flops=5.03e+07
 total GEMM cost=1.2e+07 flops=3.65e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   4.49e-03  2.25e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   4.49e-03  2.25e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.80e-05,1.93e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.87e-04 tot=2.12e-03 ---
 sigma counter=177 i=0 t=2.39e-04 per=1.24e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=177 i=1 t=2.43e-04 per=1.26e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=177 i=2 t=2.34e-04 per=1.21e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=177 i=3 t=2.37e-04 per=1.23e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=177 i=4 t=2.31e-04 per=1.20e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=177 i=5 t=2.41e-04 per=1.25e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=177 i=6 t=2.59e-04 per=1.34e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=177 i=7 t=2.45e-04 per=1.27e+01 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.31e-01 t_reduction=3.35e-02 tot=3.65e-01 ---
 sigma_tot counter=177 i=0 t=4.11e-02 per=1.24e+01 cost=1.06e+06 flops=2.59e+07
 sigma_tot counter=177 i=1 t=4.19e-02 per=1.26e+01 cost=1.07e+06 flops=2.56e+07
 sigma_tot counter=177 i=2 t=4.10e-02 per=1.24e+01 cost=1.07e+06 flops=2.62e+07
 sigma_tot counter=177 i=3 t=4.09e-02 per=1.23e+01 cost=1.08e+06 flops=2.64e+07
 sigma_tot counter=177 i=4 t=4.08e-02 per=1.23e+01 cost=1.83e+06 flops=4.47e+07
 sigma_tot counter=177 i=5 t=4.15e-02 per=1.25e+01 cost=1.82e+06 flops=4.39e+07
 sigma_tot counter=177 i=6 t=4.31e-02 per=1.30e+01 cost=2.09e+06 flops=4.84e+07
 sigma_tot counter=177 i=7 t=4.12e-02 per=1.24e+01 cost=2.08e+06 flops=5.04e+07
 total GEMM cost=1.21e+07 flops=3.65e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.13e-03 ---
 sigma counter=178 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=178 i=1 t=2.39e-04 per=1.23e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=178 i=2 t=2.42e-04 per=1.24e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=178 i=3 t=2.46e-04 per=1.26e+01 cost=6.99e+03 flops=2.84e+07
 sigma counter=178 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=178 i=5 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=178 i=6 t=2.68e-04 per=1.38e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=178 i=7 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.33e-01 t_reduction=3.37e-02 tot=3.67e-01 ---
 sigma_tot counter=178 i=0 t=4.13e-02 per=1.24e+01 cost=1.07e+06 flops=2.59e+07
 sigma_tot counter=178 i=1 t=4.21e-02 per=1.26e+01 cost=1.08e+06 flops=2.57e+07
 sigma_tot counter=178 i=2 t=4.12e-02 per=1.24e+01 cost=1.08e+06 flops=2.62e+07
 sigma_tot counter=178 i=3 t=4.11e-02 per=1.23e+01 cost=1.08e+06 flops=2.64e+07
 sigma_tot counter=178 i=4 t=4.11e-02 per=1.23e+01 cost=1.83e+06 flops=4.46e+07
 sigma_tot counter=178 i=5 t=4.17e-02 per=1.25e+01 cost=1.83e+06 flops=4.38e+07
 sigma_tot counter=178 i=6 t=4.34e-02 per=1.30e+01 cost=2.10e+06 flops=4.85e+07
 sigma_tot counter=178 i=7 t=4.15e-02 per=1.24e+01 cost=2.10e+06 flops=5.06e+07
 total GEMM cost=1.22e+07 flops=3.65e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   9.01e-03  2.25e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   9.01e-03  2.25e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.14e-03 ---
 sigma counter=179 i=0 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=179 i=1 t=2.38e-04 per=1.22e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=179 i=2 t=2.43e-04 per=1.24e+01 cost=7.01e+03 flops=2.88e+07
 sigma counter=179 i=3 t=2.43e-04 per=1.24e+01 cost=6.99e+03 flops=2.88e+07
 sigma counter=179 i=4 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=179 i=5 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=179 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=179 i=7 t=2.55e-04 per=1.31e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.35e-01 t_reduction=3.38e-02 tot=3.69e-01 ---
 sigma_tot counter=179 i=0 t=4.15e-02 per=1.24e+01 cost=1.08e+06 flops=2.59e+07
 sigma_tot counter=179 i=1 t=4.24e-02 per=1.26e+01 cost=1.09e+06 flops=2.57e+07
 sigma_tot counter=179 i=2 t=4.15e-02 per=1.24e+01 cost=1.09e+06 flops=2.62e+07
 sigma_tot counter=179 i=3 t=4.13e-02 per=1.23e+01 cost=1.09e+06 flops=2.64e+07
 sigma_tot counter=179 i=4 t=4.13e-02 per=1.23e+01 cost=1.84e+06 flops=4.45e+07
 sigma_tot counter=179 i=5 t=4.20e-02 per=1.25e+01 cost=1.84e+06 flops=4.37e+07
 sigma_tot counter=179 i=6 t=4.36e-02 per=1.30e+01 cost=2.12e+06 flops=4.87e+07
 sigma_tot counter=179 i=7 t=4.17e-02 per=1.24e+01 cost=2.12e+06 flops=5.07e+07
 total GEMM cost=1.23e+07 flops=3.65e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.13e-03 ---
 sigma counter=180 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=180 i=1 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=180 i=2 t=2.40e-04 per=1.23e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=180 i=3 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=180 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=180 i=5 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=180 i=6 t=2.70e-04 per=1.39e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=180 i=7 t=2.48e-04 per=1.28e+01 cost=1.89e+04 flops=7.62e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.37e-01 t_reduction=3.40e-02 tot=3.71e-01 ---
 sigma_tot counter=180 i=0 t=4.18e-02 per=1.24e+01 cost=1.08e+06 flops=2.60e+07
 sigma_tot counter=180 i=1 t=4.26e-02 per=1.26e+01 cost=1.09e+06 flops=2.57e+07
 sigma_tot counter=180 i=2 t=4.17e-02 per=1.24e+01 cost=1.09e+06 flops=2.62e+07
 sigma_tot counter=180 i=3 t=4.16e-02 per=1.23e+01 cost=1.10e+06 flops=2.64e+07
 sigma_tot counter=180 i=4 t=4.15e-02 per=1.23e+01 cost=1.85e+06 flops=4.44e+07
 sigma_tot counter=180 i=5 t=4.22e-02 per=1.25e+01 cost=1.84e+06 flops=4.36e+07
 sigma_tot counter=180 i=6 t=4.39e-02 per=1.30e+01 cost=2.14e+06 flops=4.88e+07
 sigma_tot counter=180 i=7 t=4.20e-02 per=1.24e+01 cost=2.13e+06 flops=5.09e+07
 total GEMM cost=1.23e+07 flops=3.66e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.35e-02  2.26e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   1.35e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.14e-03 ---
 sigma counter=181 i=0 t=2.44e-04 per=1.25e+01 cost=6.81e+03 flops=2.79e+07
 sigma counter=181 i=1 t=2.48e-04 per=1.27e+01 cost=6.78e+03 flops=2.74e+07
 sigma counter=181 i=2 t=2.33e-04 per=1.19e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=181 i=3 t=2.35e-04 per=1.20e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=181 i=4 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=181 i=5 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=181 i=6 t=2.61e-04 per=1.34e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=181 i=7 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.39e-01 t_reduction=3.42e-02 tot=3.73e-01 ---
 sigma_tot counter=181 i=0 t=4.20e-02 per=1.24e+01 cost=1.09e+06 flops=2.60e+07
 sigma_tot counter=181 i=1 t=4.29e-02 per=1.26e+01 cost=1.10e+06 flops=2.57e+07
 sigma_tot counter=181 i=2 t=4.19e-02 per=1.24e+01 cost=1.10e+06 flops=2.62e+07
 sigma_tot counter=181 i=3 t=4.18e-02 per=1.23e+01 cost=1.10e+06 flops=2.64e+07
 sigma_tot counter=181 i=4 t=4.18e-02 per=1.23e+01 cost=1.85e+06 flops=4.44e+07
 sigma_tot counter=181 i=5 t=4.24e-02 per=1.25e+01 cost=1.85e+06 flops=4.36e+07
 sigma_tot counter=181 i=6 t=4.42e-02 per=1.30e+01 cost=2.16e+06 flops=4.89e+07
 sigma_tot counter=181 i=7 t=4.22e-02 per=1.24e+01 cost=2.15e+06 flops=5.10e+07
 total GEMM cost=1.24e+07 flops=3.66e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.97e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.01e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.97e-03 t_reduction=1.90e-04 tot=2.16e-03 ---
 sigma counter=182 i=0 t=2.38e-04 per=1.21e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=182 i=1 t=2.44e-04 per=1.24e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=182 i=2 t=2.45e-04 per=1.24e+01 cost=7.01e+03 flops=2.86e+07
 sigma counter=182 i=3 t=2.43e-04 per=1.23e+01 cost=6.99e+03 flops=2.88e+07
 sigma counter=182 i=4 t=2.41e-04 per=1.22e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=182 i=5 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=182 i=6 t=2.67e-04 per=1.35e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=182 i=7 t=2.51e-04 per=1.27e+01 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.90e+04 flops=4.01e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.41e-01 t_reduction=3.44e-02 tot=3.76e-01 ---
 sigma_tot counter=182 i=0 t=4.22e-02 per=1.24e+01 cost=1.10e+06 flops=2.60e+07
 sigma_tot counter=182 i=1 t=4.31e-02 per=1.26e+01 cost=1.11e+06 flops=2.57e+07
 sigma_tot counter=182 i=2 t=4.22e-02 per=1.24e+01 cost=1.11e+06 flops=2.62e+07
 sigma_tot counter=182 i=3 t=4.21e-02 per=1.23e+01 cost=1.11e+06 flops=2.64e+07
 sigma_tot counter=182 i=4 t=4.20e-02 per=1.23e+01 cost=1.86e+06 flops=4.43e+07
 sigma_tot counter=182 i=5 t=4.27e-02 per=1.25e+01 cost=1.86e+06 flops=4.35e+07
 sigma_tot counter=182 i=6 t=4.44e-02 per=1.30e+01 cost=2.18e+06 flops=4.91e+07
 sigma_tot counter=182 i=7 t=4.25e-02 per=1.24e+01 cost=2.17e+06 flops=5.11e+07
 total GEMM cost=1.25e+07 flops=3.66e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.81e-02  2.26e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.81e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.13e-03 ---
 sigma counter=183 i=0 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=183 i=1 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=183 i=2 t=2.40e-04 per=1.23e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=183 i=3 t=2.45e-04 per=1.26e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=183 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=183 i=5 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=183 i=6 t=2.59e-04 per=1.33e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=183 i=7 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.43e-01 t_reduction=3.46e-02 tot=3.78e-01 ---
 sigma_tot counter=183 i=0 t=4.25e-02 per=1.24e+01 cost=1.10e+06 flops=2.60e+07
 sigma_tot counter=183 i=1 t=4.33e-02 per=1.26e+01 cost=1.12e+06 flops=2.57e+07
 sigma_tot counter=183 i=2 t=4.24e-02 per=1.24e+01 cost=1.11e+06 flops=2.63e+07
 sigma_tot counter=183 i=3 t=4.23e-02 per=1.23e+01 cost=1.12e+06 flops=2.64e+07
 sigma_tot counter=183 i=4 t=4.22e-02 per=1.23e+01 cost=1.87e+06 flops=4.42e+07
 sigma_tot counter=183 i=5 t=4.29e-02 per=1.25e+01 cost=1.86e+06 flops=4.34e+07
 sigma_tot counter=183 i=6 t=4.47e-02 per=1.30e+01 cost=2.20e+06 flops=4.92e+07
 sigma_tot counter=183 i=7 t=4.27e-02 per=1.25e+01 cost=2.19e+06 flops=5.13e+07
 total GEMM cost=1.26e+07 flops=3.66e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.14e-03 ---
 sigma counter=184 i=0 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=184 i=1 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=184 i=2 t=2.40e-04 per=1.23e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=184 i=3 t=2.44e-04 per=1.25e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=184 i=4 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=184 i=5 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=184 i=6 t=2.71e-04 per=1.39e+01 cost=1.89e+04 flops=6.97e+07
 sigma counter=184 i=7 t=2.44e-04 per=1.25e+01 cost=1.89e+04 flops=7.74e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.45e-01 t_reduction=3.48e-02 tot=3.80e-01 ---
 sigma_tot counter=184 i=0 t=4.27e-02 per=1.24e+01 cost=1.11e+06 flops=2.60e+07
 sigma_tot counter=184 i=1 t=4.36e-02 per=1.26e+01 cost=1.12e+06 flops=2.57e+07
 sigma_tot counter=184 i=2 t=4.27e-02 per=1.24e+01 cost=1.12e+06 flops=2.63e+07
 sigma_tot counter=184 i=3 t=4.26e-02 per=1.23e+01 cost=1.13e+06 flops=2.65e+07
 sigma_tot counter=184 i=4 t=4.25e-02 per=1.23e+01 cost=1.87e+06 flops=4.41e+07
 sigma_tot counter=184 i=5 t=4.32e-02 per=1.25e+01 cost=1.87e+06 flops=4.33e+07
 sigma_tot counter=184 i=6 t=4.50e-02 per=1.30e+01 cost=2.22e+06 flops=4.93e+07
 sigma_tot counter=184 i=7 t=4.30e-02 per=1.25e+01 cost=2.21e+06 flops=5.14e+07
 total GEMM cost=1.27e+07 flops=3.67e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.26e-02  2.26e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.26e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.14e-03 ---
 sigma counter=185 i=0 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=185 i=1 t=2.38e-04 per=1.22e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=185 i=2 t=2.43e-04 per=1.25e+01 cost=7.01e+03 flops=2.88e+07
 sigma counter=185 i=3 t=2.45e-04 per=1.26e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=185 i=4 t=2.29e-04 per=1.17e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=185 i=5 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=185 i=6 t=2.65e-04 per=1.36e+01 cost=1.89e+04 flops=7.13e+07
 sigma counter=185 i=7 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.47e-01 t_reduction=3.50e-02 tot=3.82e-01 ---
 sigma_tot counter=185 i=0 t=4.30e-02 per=1.24e+01 cost=1.12e+06 flops=2.60e+07
 sigma_tot counter=185 i=1 t=4.38e-02 per=1.26e+01 cost=1.13e+06 flops=2.58e+07
 sigma_tot counter=185 i=2 t=4.29e-02 per=1.24e+01 cost=1.13e+06 flops=2.63e+07
 sigma_tot counter=185 i=3 t=4.28e-02 per=1.23e+01 cost=1.13e+06 flops=2.65e+07
 sigma_tot counter=185 i=4 t=4.27e-02 per=1.23e+01 cost=1.88e+06 flops=4.40e+07
 sigma_tot counter=185 i=5 t=4.34e-02 per=1.25e+01 cost=1.88e+06 flops=4.32e+07
 sigma_tot counter=185 i=6 t=4.52e-02 per=1.30e+01 cost=2.24e+06 flops=4.95e+07
 sigma_tot counter=185 i=7 t=4.32e-02 per=1.25e+01 cost=2.23e+06 flops=5.16e+07
 total GEMM cost=1.27e+07 flops=3.67e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.14e-03 ---
 sigma counter=186 i=0 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=186 i=1 t=2.37e-04 per=1.21e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=186 i=2 t=2.33e-04 per=1.19e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=186 i=3 t=2.47e-04 per=1.26e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=186 i=4 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=186 i=5 t=2.37e-04 per=1.21e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=186 i=6 t=2.59e-04 per=1.33e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=186 i=7 t=2.63e-04 per=1.35e+01 cost=1.89e+04 flops=7.18e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.49e-01 t_reduction=3.52e-02 tot=3.84e-01 ---
 sigma_tot counter=186 i=0 t=4.32e-02 per=1.24e+01 cost=1.13e+06 flops=2.60e+07
 sigma_tot counter=186 i=1 t=4.41e-02 per=1.26e+01 cost=1.14e+06 flops=2.58e+07
 sigma_tot counter=186 i=2 t=4.31e-02 per=1.24e+01 cost=1.13e+06 flops=2.63e+07
 sigma_tot counter=186 i=3 t=4.30e-02 per=1.23e+01 cost=1.14e+06 flops=2.65e+07
 sigma_tot counter=186 i=4 t=4.29e-02 per=1.23e+01 cost=1.89e+06 flops=4.39e+07
 sigma_tot counter=186 i=5 t=4.37e-02 per=1.25e+01 cost=1.88e+06 flops=4.31e+07
 sigma_tot counter=186 i=6 t=4.55e-02 per=1.30e+01 cost=2.26e+06 flops=4.96e+07
 sigma_tot counter=186 i=7 t=4.35e-02 per=1.25e+01 cost=2.25e+06 flops=5.17e+07
 total GEMM cost=1.28e+07 flops=3.67e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   2.71e-02  2.26e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   2.71e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.13e-03 ---
 sigma counter=187 i=0 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=187 i=1 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=187 i=2 t=2.44e-04 per=1.26e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=187 i=3 t=2.40e-04 per=1.23e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=187 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=187 i=5 t=2.38e-04 per=1.22e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=187 i=6 t=2.60e-04 per=1.34e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=187 i=7 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.51e-01 t_reduction=3.53e-02 tot=3.86e-01 ---
 sigma_tot counter=187 i=0 t=4.34e-02 per=1.24e+01 cost=1.13e+06 flops=2.61e+07
 sigma_tot counter=187 i=1 t=4.43e-02 per=1.26e+01 cost=1.14e+06 flops=2.58e+07
 sigma_tot counter=187 i=2 t=4.34e-02 per=1.24e+01 cost=1.14e+06 flops=2.63e+07
 sigma_tot counter=187 i=3 t=4.33e-02 per=1.23e+01 cost=1.15e+06 flops=2.65e+07
 sigma_tot counter=187 i=4 t=4.32e-02 per=1.23e+01 cost=1.89e+06 flops=4.39e+07
 sigma_tot counter=187 i=5 t=4.39e-02 per=1.25e+01 cost=1.89e+06 flops=4.30e+07
 sigma_tot counter=187 i=6 t=4.57e-02 per=1.30e+01 cost=2.27e+06 flops=4.97e+07
 sigma_tot counter=187 i=7 t=4.37e-02 per=1.25e+01 cost=2.27e+06 flops=5.18e+07
 total GEMM cost=1.29e+07 flops=3.67e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.50e-05,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.89e-04 tot=2.14e-03 ---
 sigma counter=188 i=0 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=188 i=1 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=188 i=2 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=188 i=3 t=2.47e-04 per=1.27e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=188 i=4 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=188 i=5 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=188 i=6 t=2.68e-04 per=1.38e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=188 i=7 t=2.50e-04 per=1.28e+01 cost=1.89e+04 flops=7.56e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.53e-01 t_reduction=3.55e-02 tot=3.88e-01 ---
 sigma_tot counter=188 i=0 t=4.37e-02 per=1.24e+01 cost=1.14e+06 flops=2.61e+07
 sigma_tot counter=188 i=1 t=4.45e-02 per=1.26e+01 cost=1.15e+06 flops=2.58e+07
 sigma_tot counter=188 i=2 t=4.36e-02 per=1.24e+01 cost=1.15e+06 flops=2.63e+07
 sigma_tot counter=188 i=3 t=4.35e-02 per=1.23e+01 cost=1.15e+06 flops=2.65e+07
 sigma_tot counter=188 i=4 t=4.34e-02 per=1.23e+01 cost=1.90e+06 flops=4.38e+07
 sigma_tot counter=188 i=5 t=4.41e-02 per=1.25e+01 cost=1.90e+06 flops=4.30e+07
 sigma_tot counter=188 i=6 t=4.60e-02 per=1.30e+01 cost=2.29e+06 flops=4.98e+07
 sigma_tot counter=188 i=7 t=4.40e-02 per=1.25e+01 cost=2.29e+06 flops=5.20e+07
 total GEMM cost=1.30e+07 flops=3.67e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   3.17e-02  2.26e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   3.17e-02  2.26e-03
TIMING for Davidson : 3.17e-02  T(cal/comm/rest)=3.13e-02,5.35e-07,3.33e-04
optimized energies: isweep=4 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.989e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000549 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.35e-05,0.000239,0.000257 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.0011,0.00018 cost=2.78e+04 flops[gemm]=2.54e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00109 t_reduction=0.00018 tot=0.00127 ---
 renorm counter=19 i=0 t=0.000218 per=19.9 cost=1.82e+03 flops=8.36e+06
 renorm counter=19 i=1 t=0.000216 per=19.7 cost=3.23e+03 flops=1.49e+07
 renorm counter=19 i=2 t=0.000205 per=18.7 cost=1.91e+03 flops=9.3e+06
 renorm counter=19 i=3 t=0.000211 per=19.3 cost=3.14e+03 flops=1.49e+07
 renorm counter=19 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=19 i=5 t=1e-06 per=0.0914 cost=0 flops=0
 renorm counter=19 i=6 t=0.000243 per=22.2 cost=1.77e+04 flops=7.28e+07
 total GEMM cost=2.78e+04 flops=2.54e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0198 t_reduction=0.00342 tot=0.0233 ---
 renorm_tot counter=19 i=0 t=0.00397 per=20 cost=7.22e+04 flops=1.82e+07
 renorm_tot counter=19 i=1 t=0.00386 per=19.5 cost=1.02e+05 flops=2.65e+07
 renorm_tot counter=19 i=2 t=0.00176 per=8.89 cost=6.33e+04 flops=3.59e+07
 renorm_tot counter=19 i=3 t=0.00185 per=9.31 cost=1.1e+05 flops=5.97e+07
 renorm_tot counter=19 i=4 t=0.00201 per=10.1 cost=8.01e+04 flops=3.98e+07
 renorm_tot counter=19 i=5 t=0.00205 per=10.3 cost=1.38e+05 flops=6.75e+07
 renorm_tot counter=19 i=6 t=0.00434 per=21.9 cost=8.58e+05 flops=1.98e+08
 total GEMM cost=1.42e+06 flops=7.18e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=9.4e-05,0.0025,8.7e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=4.9e-05,3.12e-05,8.02e-05 speed=0.129GB/s disk[used]=0.0001GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 3.94e-02 S #####
 T(fetch) = 7.46e-05 S  per = 0.19  per(accum) = 0.19
 T(hdiag) = 7.68e-05 S  per =  0.2  per(accum) = 0.38
 T(dvdsn) = 3.59e-02 S  per =   91  per(accum) = 91
 T(decim) = 8.24e-05 S  per = 0.21  per(accum) = 92
 T(guess) = 7.90e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.67e-03 S  per =  6.8  per(accum) = 99
 T(save ) = 5.48e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.57e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.00e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.30e-04 S  per = 0.64  per(accum) = 0.76
 T(hintermediate init           ) = 1.99e-04 S  per = 0.56  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 3.53e-06 S  per = 0.0099  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 2.26e-03 S  per =  6.3  per(accum) = 7.6
 T(hmmtasks init                ) = 1.28e-03 S  per =  3.6  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.13e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 5.35e-07 S  per = 0.0015  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.33e-04 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.62e-03 S
 T(qops init                    ) = 9.38e-05 S  per =  3.6  per(accum) = 3.6
 T(qops_dict memcpy cpu2gpu     ) = 2.84e-05 S  per =  1.1  per(accum) = 4.7
 T(symbolic_formulae_renorm     ) = 2.04e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 1.16e-05 S  per = 0.44  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.73e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.58e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.33e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.28e-06 S  per = 0.32  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.35e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.84e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.75e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 9.03e-02 S #####
 T(fetch) = 4.77e-04 S  per = 0.53  per(accum) = 0.53
 T(hdiag) = 2.24e-04 S  per = 0.25  per(accum) = 0.78
 T(dvdsn) = 7.91e-02 S  per =   88  per(accum) = 88
 T(decim) = 4.71e-04 S  per = 0.52  per(accum) = 89
 T(guess) = 2.36e-04 S  per = 0.26  per(accum) = 89
 T(renrm) = 8.14e-03 S  per =    9  per(accum) = 98
 T(save ) = 1.67e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 7.86e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.26e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 7.01e-04 S  per = 0.89  per(accum) = 1.1
 T(hintermediate init           ) = 6.05e-04 S  per = 0.77  per(accum) = 1.8
 T(hintermediates memcpy cpu2gpu) = 1.08e-05 S  per = 0.014  per(accum) = 1.8
 T(preprocess_hformulae_Hxlist2 ) = 6.76e-03 S  per =  8.6  per(accum) = 10
 T(hmmtasks init                ) = 3.86e-03 S  per =  4.9  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 6.58e-02 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 1.16e-06 S  per = 0.0015  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.16e-04 S  per = 0.91  per(accum) = 1e+02
Detailed decomposition of T(renrm): 8.00e-03 S
 T(qops init                    ) = 2.58e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 9.18e-05 S  per =  1.1  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 5.79e-04 S  per =  7.2  per(accum) = 12
 T(rintermediate init           ) = 2.36e-04 S  per =  2.9  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.37e-05 S  per = 0.17  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 1.65e-03 S  per =   21  per(accum) = 35
 T(rmmtasks init                ) = 1.02e-03 S  per =   13  per(accum) = 48
 T(qops memset                  ) = 2.45e-05 S  per = 0.31  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 4.01e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.37e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.65e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 5.79e-01 S #####
 T(fetch) = 4.75e-03 S  per = 0.82  per(accum) = 0.82
 T(hdiag) = 1.63e-03 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 5.03e-01 S  per =   87  per(accum) = 88
 T(decim) = 4.42e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.60e-03 S  per = 0.28  per(accum) = 89
 T(renrm) = 5.26e-02 S  per =  9.1  per(accum) = 98
 T(save ) = 1.11e-02 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.99e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 7.85e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 5.21e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 4.02e-03 S  per = 0.81  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 8.17e-05 S  per = 0.016  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 4.63e-02 S  per =  9.3  per(accum) = 11
 T(hmmtasks init                ) = 2.68e-02 S  per =  5.4  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 4.10e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 8.84e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.19e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.16e-02 S
 T(qops init                    ) = 1.98e-03 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 6.52e-04 S  per =  1.3  per(accum) = 5.1
 T(symbolic_formulae_renorm     ) = 4.13e-03 S  per =    8  per(accum) = 13
 T(rintermediate init           ) = 1.98e-03 S  per =  3.8  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 9.86e-05 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 1.05e-02 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 6.59e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.66e-04 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 2.48e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.55e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.84e-04 S  per = 0.36  per(accum) = 1e+02

isweep=4 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.341e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x481b4a40
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.252e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000163 flops=2.71e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.978e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.37e-05,0.00095,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.9e-05,0.00196,0.00019 cost=7.9e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00196 t_reduction=0.00019 tot=0.00215 ---
 sigma counter=189 i=0 t=0.000251 per=12.8 cost=7.01e+03 flops=2.79e+07
 sigma counter=189 i=1 t=0.000241 per=12.3 cost=6.99e+03 flops=2.9e+07
 sigma counter=189 i=2 t=0.00024 per=12.3 cost=6.81e+03 flops=2.84e+07
 sigma counter=189 i=3 t=0.000237 per=12.1 cost=6.78e+03 flops=2.86e+07
 sigma counter=189 i=4 t=0.000253 per=12.9 cost=1.89e+04 flops=7.47e+07
 sigma counter=189 i=5 t=0.00026 per=13.3 cost=1.89e+04 flops=7.27e+07
 sigma counter=189 i=6 t=0.000243 per=12.4 cost=6.78e+03 flops=2.79e+07
 sigma counter=189 i=7 t=0.000232 per=11.9 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.9e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.355 t_reduction=0.0357 tot=0.391 ---
 sigma_tot counter=189 i=0 t=0.0439 per=12.4 cost=1.15e+06 flops=2.61e+07
 sigma_tot counter=189 i=1 t=0.0448 per=12.6 cost=1.16e+06 flops=2.58e+07
 sigma_tot counter=189 i=2 t=0.0439 per=12.4 cost=1.16e+06 flops=2.64e+07
 sigma_tot counter=189 i=3 t=0.0438 per=12.3 cost=1.16e+06 flops=2.65e+07
 sigma_tot counter=189 i=4 t=0.0437 per=12.3 cost=1.92e+06 flops=4.4e+07
 sigma_tot counter=189 i=5 t=0.0444 per=12.5 cost=1.92e+06 flops=4.31e+07
 sigma_tot counter=189 i=6 t=0.0463 per=13 cost=2.3e+06 flops=4.97e+07
 sigma_tot counter=189 i=7 t=0.0442 per=12.5 cost=2.29e+06 flops=5.18e+07
 total GEMM cost=1.3e+07 flops=3.68e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00196,0.000189 cost=7.9e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00196 t_reduction=0.000189 tot=0.00214 ---
 sigma counter=190 i=0 t=0.00024 per=12.3 cost=7.01e+03 flops=2.92e+07
 sigma counter=190 i=1 t=0.000248 per=12.7 cost=6.99e+03 flops=2.82e+07
 sigma counter=190 i=2 t=0.000239 per=12.2 cost=6.81e+03 flops=2.85e+07
 sigma counter=190 i=3 t=0.000241 per=12.3 cost=6.78e+03 flops=2.81e+07
 sigma counter=190 i=4 t=0.000254 per=13 cost=1.89e+04 flops=7.44e+07
 sigma counter=190 i=5 t=0.000249 per=12.7 cost=1.89e+04 flops=7.59e+07
 sigma counter=190 i=6 t=0.00025 per=12.8 cost=6.78e+03 flops=2.71e+07
 sigma counter=190 i=7 t=0.000234 per=12 cost=6.81e+03 flops=2.91e+07
 total GEMM cost=7.9e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.357 t_reduction=0.0359 tot=0.393 ---
 sigma_tot counter=190 i=0 t=0.0442 per=12.4 cost=1.15e+06 flops=2.61e+07
 sigma_tot counter=190 i=1 t=0.045 per=12.6 cost=1.16e+06 flops=2.58e+07
 sigma_tot counter=190 i=2 t=0.0441 per=12.4 cost=1.16e+06 flops=2.64e+07
 sigma_tot counter=190 i=3 t=0.044 per=12.3 cost=1.17e+06 flops=2.65e+07
 sigma_tot counter=190 i=4 t=0.0439 per=12.3 cost=1.94e+06 flops=4.41e+07
 sigma_tot counter=190 i=5 t=0.0446 per=12.5 cost=1.93e+06 flops=4.33e+07
 sigma_tot counter=190 i=6 t=0.0465 per=13 cost=2.31e+06 flops=4.96e+07
 sigma_tot counter=190 i=7 t=0.0445 per=12.5 cost=2.3e+06 flops=5.17e+07
 total GEMM cost=1.31e+07 flops=3.68e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.54e-03  2.27e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.54e-03  2.27e-03
TIMING for Davidson : 4.55e-03  T(cal/comm/rest)=4.51e-03,9.00e-08,4.27e-05
optimized energies: isweep=4 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.654e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.00017 flops=2.6e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 2.059e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000531 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.45e-05,0.000237,0.00025 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00107,0.000181 cost=1.55e+05 flops[gemm]=1.44e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00107 t_reduction=0.000181 tot=0.00125 ---
 renorm counter=20 i=0 t=0.000214 per=20 cost=5.64e+03 flops=2.64e+07
 renorm counter=20 i=1 t=0.000208 per=19.4 cost=1.13e+04 flops=5.42e+07
 renorm counter=20 i=2 t=0.0002 per=18.7 cost=1.66e+04 flops=8.28e+07
 renorm counter=20 i=3 t=0.000215 per=20.1 cost=2.89e+04 flops=1.34e+08
 renorm counter=20 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=20 i=5 t=1e-06 per=0.0935 cost=0 flops=0
 renorm counter=20 i=6 t=0.000232 per=21.7 cost=9.22e+04 flops=3.97e+08
 total GEMM cost=1.55e+05 flops=1.44e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0209 t_reduction=0.0036 tot=0.0245 ---
 renorm_tot counter=20 i=0 t=0.00419 per=20 cost=7.78e+04 flops=1.86e+07
 renorm_tot counter=20 i=1 t=0.00407 per=19.5 cost=1.13e+05 flops=2.79e+07
 renorm_tot counter=20 i=2 t=0.00196 per=9.39 cost=7.99e+04 flops=4.07e+07
 renorm_tot counter=20 i=3 t=0.00206 per=9.86 cost=1.39e+05 flops=6.75e+07
 renorm_tot counter=20 i=4 t=0.00201 per=9.62 cost=8.01e+04 flops=3.98e+07
 renorm_tot counter=20 i=5 t=0.00205 per=9.79 cost=1.38e+05 flops=6.74e+07
 renorm_tot counter=20 i=6 t=0.00457 per=21.9 cost=9.5e+05 flops=2.08e+08
 total GEMM cost=1.58e+06 flops=7.55e+07
check ||H-H.dagger||=1.20e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.8e-05,0.0027,8.5e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=4.97e-05,4.04e-05,9.01e-05 speed=0.215GB/s disk[used]=0.000102GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.29e-02 S #####
 T(fetch) = 3.10e-04 S  per =  2.4  per(accum) = 2.4
 T(hdiag) = 7.00e-05 S  per = 0.54  per(accum) = 2.9
 T(dvdsn) = 8.75e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.24e-04 S  per =  2.5  per(accum) = 73
 T(guess) = 7.65e-05 S  per = 0.59  per(accum) = 74
 T(renrm) = 2.81e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.56e-04 S  per =  4.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.56e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.94e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.30e-04 S  per =  2.7  per(accum) = 3.2
 T(hintermediate init           ) = 2.01e-04 S  per =  2.3  per(accum) = 5.5
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.041  per(accum) = 5.5
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =   26  per(accum) = 32
 T(hmmtasks init                ) = 1.29e-03 S  per =   15  per(accum) = 47
 T(dvdson solver [Hx_batchGPU]  ) = 4.51e-03 S  per =   53  per(accum) = 1e+02
 T(dvdson solver [communication]) = 9.00e-08 S  per = 0.0011  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.27e-05 S  per =  0.5  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.75e-03 S
 T(qops init                    ) = 7.83e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.54e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.70e-04 S  per =  6.2  per(accum) = 10
 T(rintermediate init           ) = 2.09e-04 S  per =  7.6  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.42e-06 S  per = 0.16  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.40e-04 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.50e-04 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 8.06e-06 S  per = 0.29  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.79e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.48e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 1.03e-01 S #####
 T(fetch) = 7.87e-04 S  per = 0.76  per(accum) = 0.76
 T(hdiag) = 2.94e-04 S  per = 0.28  per(accum) = 1
 T(dvdsn) = 8.79e-02 S  per =   85  per(accum) = 86
 T(decim) = 7.95e-04 S  per = 0.77  per(accum) = 87
 T(guess) = 3.13e-04 S  per =  0.3  per(accum) = 87
 T(renrm) = 1.09e-02 S  per =   11  per(accum) = 98
 T(save ) = 2.23e-03 S  per =  2.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.71e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.65e-04 S  per = 0.19  per(accum) = 0.19
 T(symbolic_formulae_twodot     ) = 9.32e-04 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 8.06e-04 S  per = 0.92  per(accum) = 2.2
 T(hintermediates memcpy cpu2gpu) = 1.43e-05 S  per = 0.016  per(accum) = 2.2
 T(preprocess_hformulae_Hxlist2 ) = 9.00e-03 S  per =   10  per(accum) = 13
 T(hmmtasks init                ) = 5.14e-03 S  per =  5.9  per(accum) = 18
 T(dvdson solver [Hx_batchGPU]  ) = 7.03e-02 S  per =   81  per(accum) = 99
 T(dvdson solver [communication]) = 1.25e-06 S  per = 0.0014  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.59e-04 S  per = 0.87  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.07e-02 S
 T(qops init                    ) = 3.37e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 1.27e-04 S  per =  1.2  per(accum) = 4.3
 T(symbolic_formulae_renorm     ) = 7.49e-04 S  per =    7  per(accum) = 11
 T(rintermediate init           ) = 4.45e-04 S  per =  4.1  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.81e-05 S  per = 0.17  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 2.19e-03 S  per =   20  per(accum) = 36
 T(rmmtasks init                ) = 1.37e-03 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 3.26e-05 S  per =  0.3  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 5.33e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.12e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.49e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 5.91e-01 S #####
 T(fetch) = 5.06e-03 S  per = 0.86  per(accum) = 0.86
 T(hdiag) = 1.70e-03 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 5.11e-01 S  per =   86  per(accum) = 88
 T(decim) = 4.74e-03 S  per =  0.8  per(accum) = 88
 T(guess) = 1.67e-03 S  per = 0.28  per(accum) = 89
 T(renrm) = 5.54e-02 S  per =  9.4  per(accum) = 98
 T(save ) = 1.16e-02 S  per =    2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.07e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 8.24e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 5.44e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 4.22e-03 S  per = 0.83  per(accum) = 2.1
 T(hintermediates memcpy cpu2gpu) = 8.52e-05 S  per = 0.017  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 4.85e-02 S  per =  9.6  per(accum) = 12
 T(hmmtasks init                ) = 2.81e-02 S  per =  5.5  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 4.15e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 8.93e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.24e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.44e-02 S
 T(qops init                    ) = 2.06e-03 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 6.88e-04 S  per =  1.3  per(accum) = 5.1
 T(symbolic_formulae_renorm     ) = 4.30e-03 S  per =  7.9  per(accum) = 13
 T(rintermediate init           ) = 2.19e-03 S  per =    4  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 1.03e-04 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 1.10e-02 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 6.94e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.74e-04 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 2.61e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.83e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.93e-04 S  per = 0.35  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=4
----------------------------------------------------------------------
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.038
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.013
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.039
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474789013e-09
 sweep energies: isweep=4 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=4 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=4
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.64e-01 | 1.64e-01 | 0.00e+00 1.04e-01 1.06e-02 1.15e-01 69.9
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.31e-01 | 2.95e-01 | 0.00e+00 1.90e-01 2.03e-02 2.10e-01 71.3
            2  2      20 1.00e-04 0.00e+00 | 31 | 9.89e-02 | 3.94e-01 | 0.00e+00 2.50e-01 2.66e-02 2.77e-01 70.4
            3  2      20 1.00e-04 0.00e+00 | 31 | 1.00e-01 | 4.94e-01 | 0.00e+00 3.12e-01 3.29e-02 3.45e-01 69.9
            4  2      20 1.00e-04 0.00e+00 | 31 | 1.04e-01 | 5.98e-01 | 0.00e+00 3.78e-01 3.95e-02 4.17e-01 69.8
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.65e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (-8.88e-16) e[1]=-2.43697745069 (-2.22e-15)
            3      20 +5.26e-04 e[0]=-2.65451696664 (-1.78e-15) e[1]=-2.43697745069 (3.11e-15)
            4      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep4.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep4.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.76e-15
 idx=3 node=(1,0) Drow=8 maxdiff=7.11e-16
 idx=4 node=(0,0) Drow=2 maxdiff=2.49e-16
stensor2: wf2 own=1 _data=0x4813d5b0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x4813d5b0
      1.2320e-17      -1.0000e+00 
     -1.0000e+00      -2.2806e-17 
 rwfuns: nroots=2 maxdiff=4.4434e-16
----- TIMING FOR ctns::rcanon_check : 8.058e-05 S -----
..... end of isweep = 4 .....

======================================================================
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=5 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.156e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47a4f3c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.285e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000161 flops=2.74e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.967e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00225 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.61e-05,0.000959,0.00124 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.6e-05,0.00197,0.000188 cost=7.9e+04 flops[gemm]=4e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00197 t_reduction=0.000187 tot=0.00216 ---
 sigma counter=191 i=0 t=0.000255 per=12.9 cost=7.01e+03 flops=2.75e+07
 sigma counter=191 i=1 t=0.000248 per=12.6 cost=6.99e+03 flops=2.82e+07
 sigma counter=191 i=2 t=0.000244 per=12.4 cost=6.81e+03 flops=2.79e+07
 sigma counter=191 i=3 t=0.000241 per=12.2 cost=6.78e+03 flops=2.81e+07
 sigma counter=191 i=4 t=0.000253 per=12.8 cost=1.89e+04 flops=7.47e+07
 sigma counter=191 i=5 t=0.00025 per=12.7 cost=1.89e+04 flops=7.56e+07
 sigma counter=191 i=6 t=0.000244 per=12.4 cost=6.78e+03 flops=2.78e+07
 sigma counter=191 i=7 t=0.000239 per=12.1 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.9e+04 flops=4e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.359 t_reduction=0.0361 tot=0.395 ---
 sigma_tot counter=191 i=0 t=0.0444 per=12.4 cost=1.16e+06 flops=2.61e+07
 sigma_tot counter=191 i=1 t=0.0453 per=12.6 cost=1.17e+06 flops=2.58e+07
 sigma_tot counter=191 i=2 t=0.0443 per=12.4 cost=1.17e+06 flops=2.64e+07
 sigma_tot counter=191 i=3 t=0.0442 per=12.3 cost=1.17e+06 flops=2.65e+07
 sigma_tot counter=191 i=4 t=0.0442 per=12.3 cost=1.96e+06 flops=4.43e+07
 sigma_tot counter=191 i=5 t=0.0449 per=12.5 cost=1.95e+06 flops=4.35e+07
 sigma_tot counter=191 i=6 t=0.0467 per=13 cost=2.31e+06 flops=4.95e+07
 sigma_tot counter=191 i=7 t=0.0447 per=12.5 cost=2.31e+06 flops=5.16e+07
 total GEMM cost=1.32e+07 flops=3.68e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.8e-05,0.00196,0.000189 cost=7.9e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00195 t_reduction=0.000189 tot=0.00214 ---
 sigma counter=192 i=0 t=0.000242 per=12.4 cost=7.01e+03 flops=2.9e+07
 sigma counter=192 i=1 t=0.000246 per=12.6 cost=6.99e+03 flops=2.84e+07
 sigma counter=192 i=2 t=0.00024 per=12.3 cost=6.81e+03 flops=2.84e+07
 sigma counter=192 i=3 t=0.000236 per=12.1 cost=6.78e+03 flops=2.87e+07
 sigma counter=192 i=4 t=0.000253 per=12.9 cost=1.89e+04 flops=7.47e+07
 sigma counter=192 i=5 t=0.000255 per=13.1 cost=1.89e+04 flops=7.41e+07
 sigma counter=192 i=6 t=0.000245 per=12.5 cost=6.78e+03 flops=2.77e+07
 sigma counter=192 i=7 t=0.000237 per=12.1 cost=6.81e+03 flops=2.88e+07
 total GEMM cost=7.9e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.361 t_reduction=0.0363 tot=0.397 ---
 sigma_tot counter=192 i=0 t=0.0447 per=12.4 cost=1.17e+06 flops=2.61e+07
 sigma_tot counter=192 i=1 t=0.0455 per=12.6 cost=1.18e+06 flops=2.59e+07
 sigma_tot counter=192 i=2 t=0.0446 per=12.4 cost=1.18e+06 flops=2.64e+07
 sigma_tot counter=192 i=3 t=0.0445 per=12.3 cost=1.18e+06 flops=2.65e+07
 sigma_tot counter=192 i=4 t=0.0444 per=12.3 cost=1.98e+06 flops=4.45e+07
 sigma_tot counter=192 i=5 t=0.0451 per=12.5 cost=1.97e+06 flops=4.37e+07
 sigma_tot counter=192 i=6 t=0.047 per=13 cost=2.32e+06 flops=4.94e+07
 sigma_tot counter=192 i=7 t=0.0449 per=12.5 cost=2.31e+06 flops=5.15e+07
 total GEMM cost=1.33e+07 flops=3.68e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   4.55e-03  2.28e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   4.55e-03  2.28e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.80e-05,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.88e-04 tot=2.12e-03 ---
 sigma counter=193 i=0 t=2.40e-04 per=1.24e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=193 i=1 t=2.38e-04 per=1.23e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=193 i=2 t=2.35e-04 per=1.22e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=193 i=3 t=2.40e-04 per=1.24e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=193 i=4 t=2.45e-04 per=1.27e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=193 i=5 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=193 i=6 t=2.43e-04 per=1.26e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=193 i=7 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.63e-01 t_reduction=3.65e-02 tot=3.99e-01 ---
 sigma_tot counter=193 i=0 t=4.49e-02 per=1.24e+01 cost=1.17e+06 flops=2.61e+07
 sigma_tot counter=193 i=1 t=4.58e-02 per=1.26e+01 cost=1.18e+06 flops=2.59e+07
 sigma_tot counter=193 i=2 t=4.48e-02 per=1.24e+01 cost=1.18e+06 flops=2.64e+07
 sigma_tot counter=193 i=3 t=4.47e-02 per=1.23e+01 cost=1.19e+06 flops=2.66e+07
 sigma_tot counter=193 i=4 t=4.47e-02 per=1.23e+01 cost=1.99e+06 flops=4.47e+07
 sigma_tot counter=193 i=5 t=4.54e-02 per=1.25e+01 cost=1.99e+06 flops=4.38e+07
 sigma_tot counter=193 i=6 t=4.72e-02 per=1.30e+01 cost=2.33e+06 flops=4.93e+07
 sigma_tot counter=193 i=7 t=4.52e-02 per=1.25e+01 cost=2.32e+06 flops=5.14e+07
 total GEMM cost=1.34e+07 flops=3.68e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.13e-03 ---
 sigma counter=194 i=0 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=194 i=1 t=2.44e-04 per=1.25e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=194 i=2 t=2.30e-04 per=1.18e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=194 i=3 t=2.43e-04 per=1.25e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=194 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=194 i=5 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=194 i=6 t=2.45e-04 per=1.26e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=194 i=7 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.65e-01 t_reduction=3.67e-02 tot=4.01e-01 ---
 sigma_tot counter=194 i=0 t=4.51e-02 per=1.24e+01 cost=1.18e+06 flops=2.62e+07
 sigma_tot counter=194 i=1 t=4.60e-02 per=1.26e+01 cost=1.19e+06 flops=2.59e+07
 sigma_tot counter=194 i=2 t=4.50e-02 per=1.24e+01 cost=1.19e+06 flops=2.64e+07
 sigma_tot counter=194 i=3 t=4.50e-02 per=1.23e+01 cost=1.19e+06 flops=2.66e+07
 sigma_tot counter=194 i=4 t=4.49e-02 per=1.23e+01 cost=2.01e+06 flops=4.48e+07
 sigma_tot counter=194 i=5 t=4.57e-02 per=1.25e+01 cost=2.01e+06 flops=4.40e+07
 sigma_tot counter=194 i=6 t=4.75e-02 per=1.30e+01 cost=2.33e+06 flops=4.92e+07
 sigma_tot counter=194 i=7 t=4.54e-02 per=1.25e+01 cost=2.33e+06 flops=5.12e+07
 total GEMM cost=1.34e+07 flops=3.69e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   9.07e-03  2.27e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   9.07e-03  2.27e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.13e-03 ---
 sigma counter=195 i=0 t=2.40e-04 per=1.24e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=195 i=1 t=2.39e-04 per=1.23e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=195 i=2 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=195 i=3 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=195 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=195 i=5 t=2.61e-04 per=1.34e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=195 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=195 i=7 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.67e-01 t_reduction=3.69e-02 tot=4.03e-01 ---
 sigma_tot counter=195 i=0 t=4.54e-02 per=1.24e+01 cost=1.19e+06 flops=2.62e+07
 sigma_tot counter=195 i=1 t=4.62e-02 per=1.26e+01 cost=1.20e+06 flops=2.59e+07
 sigma_tot counter=195 i=2 t=4.53e-02 per=1.24e+01 cost=1.20e+06 flops=2.64e+07
 sigma_tot counter=195 i=3 t=4.52e-02 per=1.23e+01 cost=1.20e+06 flops=2.66e+07
 sigma_tot counter=195 i=4 t=4.52e-02 per=1.23e+01 cost=2.03e+06 flops=4.50e+07
 sigma_tot counter=195 i=5 t=4.59e-02 per=1.25e+01 cost=2.03e+06 flops=4.42e+07
 sigma_tot counter=195 i=6 t=4.77e-02 per=1.30e+01 cost=2.34e+06 flops=4.90e+07
 sigma_tot counter=195 i=7 t=4.56e-02 per=1.25e+01 cost=2.33e+06 flops=5.11e+07
 total GEMM cost=1.35e+07 flops=3.69e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.93e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.89e-04 tot=2.12e-03 ---
 sigma counter=196 i=0 t=2.37e-04 per=1.23e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=196 i=1 t=2.39e-04 per=1.24e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=196 i=2 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=196 i=3 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=196 i=4 t=2.49e-04 per=1.29e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=196 i=5 t=2.56e-04 per=1.33e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=196 i=6 t=2.50e-04 per=1.30e+01 cost=6.78e+03 flops=2.71e+07
 sigma counter=196 i=7 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.68e-01 t_reduction=3.70e-02 tot=4.06e-01 ---
 sigma_tot counter=196 i=0 t=4.56e-02 per=1.24e+01 cost=1.19e+06 flops=2.62e+07
 sigma_tot counter=196 i=1 t=4.65e-02 per=1.26e+01 cost=1.20e+06 flops=2.59e+07
 sigma_tot counter=196 i=2 t=4.55e-02 per=1.24e+01 cost=1.20e+06 flops=2.64e+07
 sigma_tot counter=196 i=3 t=4.54e-02 per=1.23e+01 cost=1.21e+06 flops=2.66e+07
 sigma_tot counter=196 i=4 t=4.54e-02 per=1.23e+01 cost=2.05e+06 flops=4.52e+07
 sigma_tot counter=196 i=5 t=4.62e-02 per=1.25e+01 cost=2.05e+06 flops=4.43e+07
 sigma_tot counter=196 i=6 t=4.80e-02 per=1.30e+01 cost=2.35e+06 flops=4.89e+07
 sigma_tot counter=196 i=7 t=4.59e-02 per=1.24e+01 cost=2.34e+06 flops=5.10e+07
 total GEMM cost=1.36e+07 flops=3.69e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   1.36e-02  2.26e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   1.36e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.94e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.12e-03 ---
 sigma counter=197 i=0 t=2.40e-04 per=1.24e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=197 i=1 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=197 i=2 t=2.34e-04 per=1.21e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=197 i=3 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=197 i=4 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 sigma counter=197 i=5 t=2.58e-04 per=1.33e+01 cost=1.89e+04 flops=7.32e+07
 sigma counter=197 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=197 i=7 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.70e-01 t_reduction=3.72e-02 tot=4.08e-01 ---
 sigma_tot counter=197 i=0 t=4.59e-02 per=1.24e+01 cost=1.20e+06 flops=2.62e+07
 sigma_tot counter=197 i=1 t=4.67e-02 per=1.26e+01 cost=1.21e+06 flops=2.59e+07
 sigma_tot counter=197 i=2 t=4.57e-02 per=1.23e+01 cost=1.21e+06 flops=2.65e+07
 sigma_tot counter=197 i=3 t=4.57e-02 per=1.23e+01 cost=1.21e+06 flops=2.66e+07
 sigma_tot counter=197 i=4 t=4.57e-02 per=1.23e+01 cost=2.07e+06 flops=4.53e+07
 sigma_tot counter=197 i=5 t=4.64e-02 per=1.25e+01 cost=2.07e+06 flops=4.45e+07
 sigma_tot counter=197 i=6 t=4.82e-02 per=1.30e+01 cost=2.35e+06 flops=4.88e+07
 sigma_tot counter=197 i=7 t=4.61e-02 per=1.24e+01 cost=2.35e+06 flops=5.09e+07
 total GEMM cost=1.37e+07 flops=3.69e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.93e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.89e-04 tot=2.12e-03 ---
 sigma counter=198 i=0 t=2.38e-04 per=1.24e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=198 i=1 t=2.37e-04 per=1.23e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=198 i=2 t=2.38e-04 per=1.24e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=198 i=3 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=198 i=4 t=2.45e-04 per=1.27e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=198 i=5 t=2.51e-04 per=1.30e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=198 i=6 t=2.44e-04 per=1.27e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=198 i=7 t=2.38e-04 per=1.24e+01 cost=6.81e+03 flops=2.86e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.72e-01 t_reduction=3.74e-02 tot=4.10e-01 ---
 sigma_tot counter=198 i=0 t=4.61e-02 per=1.24e+01 cost=1.21e+06 flops=2.62e+07
 sigma_tot counter=198 i=1 t=4.70e-02 per=1.26e+01 cost=1.22e+06 flops=2.60e+07
 sigma_tot counter=198 i=2 t=4.60e-02 per=1.23e+01 cost=1.22e+06 flops=2.65e+07
 sigma_tot counter=198 i=3 t=4.59e-02 per=1.23e+01 cost=1.22e+06 flops=2.66e+07
 sigma_tot counter=198 i=4 t=4.59e-02 per=1.23e+01 cost=2.09e+06 flops=4.55e+07
 sigma_tot counter=198 i=5 t=4.67e-02 per=1.25e+01 cost=2.09e+06 flops=4.47e+07
 sigma_tot counter=198 i=6 t=4.85e-02 per=1.30e+01 cost=2.36e+06 flops=4.87e+07
 sigma_tot counter=198 i=7 t=4.63e-02 per=1.24e+01 cost=2.35e+06 flops=5.08e+07
 total GEMM cost=1.38e+07 flops=3.69e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.81e-02  2.26e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.81e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.93e-03,1.97e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.97e-04 tot=2.13e-03 ---
 sigma counter=199 i=0 t=2.43e-04 per=1.26e+01 cost=7.01e+03 flops=2.88e+07
 sigma counter=199 i=1 t=2.36e-04 per=1.22e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=199 i=2 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=199 i=3 t=2.33e-04 per=1.20e+01 cost=6.78e+03 flops=2.91e+07
 sigma counter=199 i=4 t=2.46e-04 per=1.27e+01 cost=1.89e+04 flops=7.68e+07
 sigma counter=199 i=5 t=2.62e-04 per=1.35e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=199 i=6 t=2.48e-04 per=1.28e+01 cost=6.78e+03 flops=2.74e+07
 sigma counter=199 i=7 t=2.35e-04 per=1.22e+01 cost=6.81e+03 flops=2.90e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.74e-01 t_reduction=3.76e-02 tot=4.12e-01 ---
 sigma_tot counter=199 i=0 t=4.63e-02 per=1.24e+01 cost=1.22e+06 flops=2.62e+07
 sigma_tot counter=199 i=1 t=4.72e-02 per=1.26e+01 cost=1.23e+06 flops=2.60e+07
 sigma_tot counter=199 i=2 t=4.62e-02 per=1.23e+01 cost=1.22e+06 flops=2.65e+07
 sigma_tot counter=199 i=3 t=4.61e-02 per=1.23e+01 cost=1.23e+06 flops=2.66e+07
 sigma_tot counter=199 i=4 t=4.62e-02 per=1.23e+01 cost=2.11e+06 flops=4.57e+07
 sigma_tot counter=199 i=5 t=4.69e-02 per=1.25e+01 cost=2.10e+06 flops=4.48e+07
 sigma_tot counter=199 i=6 t=4.87e-02 per=1.30e+01 cost=2.37e+06 flops=4.86e+07
 sigma_tot counter=199 i=7 t=4.66e-02 per=1.24e+01 cost=2.36e+06 flops=5.07e+07
 total GEMM cost=1.38e+07 flops=3.70e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.98e-03,1.92e-04 cost=7.90e+04 flops[gemm]=4.00e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.97e-03 t_reduction=1.92e-04 tot=2.17e-03 ---
 sigma counter=200 i=0 t=2.49e-04 per=1.26e+01 cost=7.01e+03 flops=2.81e+07
 sigma counter=200 i=1 t=2.46e-04 per=1.25e+01 cost=6.99e+03 flops=2.84e+07
 sigma counter=200 i=2 t=2.46e-04 per=1.25e+01 cost=6.81e+03 flops=2.77e+07
 sigma counter=200 i=3 t=2.36e-04 per=1.20e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=200 i=4 t=2.57e-04 per=1.30e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=200 i=5 t=2.58e-04 per=1.31e+01 cost=1.89e+04 flops=7.32e+07
 sigma counter=200 i=6 t=2.43e-04 per=1.23e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=200 i=7 t=2.39e-04 per=1.21e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.00e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.76e-01 t_reduction=3.78e-02 tot=4.14e-01 ---
 sigma_tot counter=200 i=0 t=4.66e-02 per=1.24e+01 cost=1.22e+06 flops=2.62e+07
 sigma_tot counter=200 i=1 t=4.74e-02 per=1.26e+01 cost=1.23e+06 flops=2.60e+07
 sigma_tot counter=200 i=2 t=4.65e-02 per=1.23e+01 cost=1.23e+06 flops=2.65e+07
 sigma_tot counter=200 i=3 t=4.64e-02 per=1.23e+01 cost=1.24e+06 flops=2.66e+07
 sigma_tot counter=200 i=4 t=4.64e-02 per=1.23e+01 cost=2.13e+06 flops=4.58e+07
 sigma_tot counter=200 i=5 t=4.72e-02 per=1.25e+01 cost=2.12e+06 flops=4.50e+07
 sigma_tot counter=200 i=6 t=4.90e-02 per=1.30e+01 cost=2.37e+06 flops=4.85e+07
 sigma_tot counter=200 i=7 t=4.68e-02 per=1.24e+01 cost=2.37e+06 flops=5.06e+07
 total GEMM cost=1.39e+07 flops=3.70e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   2.26e-02  2.26e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   2.26e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.13e-03 ---
 sigma counter=201 i=0 t=2.42e-04 per=1.24e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=201 i=1 t=2.38e-04 per=1.22e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=201 i=2 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=201 i=3 t=2.39e-04 per=1.23e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=201 i=4 t=2.44e-04 per=1.26e+01 cost=1.89e+04 flops=7.74e+07
 sigma counter=201 i=5 t=2.55e-04 per=1.31e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=201 i=6 t=2.54e-04 per=1.31e+01 cost=6.78e+03 flops=2.67e+07
 sigma counter=201 i=7 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.78e-01 t_reduction=3.80e-02 tot=4.16e-01 ---
 sigma_tot counter=201 i=0 t=4.68e-02 per=1.24e+01 cost=1.23e+06 flops=2.63e+07
 sigma_tot counter=201 i=1 t=4.77e-02 per=1.26e+01 cost=1.24e+06 flops=2.60e+07
 sigma_tot counter=201 i=2 t=4.67e-02 per=1.23e+01 cost=1.24e+06 flops=2.65e+07
 sigma_tot counter=201 i=3 t=4.66e-02 per=1.23e+01 cost=1.24e+06 flops=2.66e+07
 sigma_tot counter=201 i=4 t=4.67e-02 per=1.23e+01 cost=2.15e+06 flops=4.60e+07
 sigma_tot counter=201 i=5 t=4.75e-02 per=1.25e+01 cost=2.14e+06 flops=4.51e+07
 sigma_tot counter=201 i=6 t=4.92e-02 per=1.30e+01 cost=2.38e+06 flops=4.84e+07
 sigma_tot counter=201 i=7 t=4.70e-02 per=1.24e+01 cost=2.37e+06 flops=5.05e+07
 total GEMM cost=1.40e+07 flops=3.70e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.88e-04 tot=2.12e-03 ---
 sigma counter=202 i=0 t=2.40e-04 per=1.24e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=202 i=1 t=2.39e-04 per=1.24e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=202 i=2 t=2.35e-04 per=1.22e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=202 i=3 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=202 i=4 t=2.51e-04 per=1.30e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=202 i=5 t=2.52e-04 per=1.31e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=202 i=6 t=2.47e-04 per=1.28e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=202 i=7 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.80e-01 t_reduction=3.82e-02 tot=4.18e-01 ---
 sigma_tot counter=202 i=0 t=4.71e-02 per=1.24e+01 cost=1.24e+06 flops=2.63e+07
 sigma_tot counter=202 i=1 t=4.79e-02 per=1.26e+01 cost=1.25e+06 flops=2.60e+07
 sigma_tot counter=202 i=2 t=4.69e-02 per=1.23e+01 cost=1.24e+06 flops=2.65e+07
 sigma_tot counter=202 i=3 t=4.69e-02 per=1.23e+01 cost=1.25e+06 flops=2.67e+07
 sigma_tot counter=202 i=4 t=4.69e-02 per=1.23e+01 cost=2.16e+06 flops=4.61e+07
 sigma_tot counter=202 i=5 t=4.77e-02 per=1.26e+01 cost=2.16e+06 flops=4.53e+07
 sigma_tot counter=202 i=6 t=4.95e-02 per=1.30e+01 cost=2.39e+06 flops=4.83e+07
 sigma_tot counter=202 i=7 t=4.73e-02 per=1.24e+01 cost=2.38e+06 flops=5.04e+07
 total GEMM cost=1.41e+07 flops=3.70e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   2.71e-02  2.26e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   2.71e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.92e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.12e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.92e-03 t_reduction=1.87e-04 tot=2.10e-03 ---
 sigma counter=203 i=0 t=2.38e-04 per=1.24e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=203 i=1 t=2.40e-04 per=1.25e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=203 i=2 t=2.30e-04 per=1.20e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=203 i=3 t=2.37e-04 per=1.24e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=203 i=4 t=2.45e-04 per=1.28e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=203 i=5 t=2.50e-04 per=1.30e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=203 i=6 t=2.45e-04 per=1.28e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=203 i=7 t=2.31e-04 per=1.21e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.12e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.82e-01 t_reduction=3.84e-02 tot=4.20e-01 ---
 sigma_tot counter=203 i=0 t=4.73e-02 per=1.24e+01 cost=1.24e+06 flops=2.63e+07
 sigma_tot counter=203 i=1 t=4.82e-02 per=1.26e+01 cost=1.25e+06 flops=2.60e+07
 sigma_tot counter=203 i=2 t=4.72e-02 per=1.23e+01 cost=1.25e+06 flops=2.65e+07
 sigma_tot counter=203 i=3 t=4.71e-02 per=1.23e+01 cost=1.26e+06 flops=2.67e+07
 sigma_tot counter=203 i=4 t=4.72e-02 per=1.23e+01 cost=2.18e+06 flops=4.63e+07
 sigma_tot counter=203 i=5 t=4.80e-02 per=1.26e+01 cost=2.18e+06 flops=4.54e+07
 sigma_tot counter=203 i=6 t=4.97e-02 per=1.30e+01 cost=2.40e+06 flops=4.82e+07
 sigma_tot counter=203 i=7 t=4.75e-02 per=1.24e+01 cost=2.39e+06 flops=5.03e+07
 total GEMM cost=1.42e+07 flops=3.70e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   2.94e-02  2.26e-03
    7   1 +      -2.436977447171  -8.88e-16   7.42e-05    5    13   2.94e-02  2.26e-03
TIMING for Davidson : 2.94e-02  T(cal/comm/rest)=2.90e-02,5.37e-07,3.19e-04
optimized energies: isweep=5 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.989e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000544 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.65e-05,0.000219,0.000269 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00107,0.000183 cost=2.78e+04 flops[gemm]=2.59e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00107 t_reduction=0.000183 tot=0.00125 ---
 renorm counter=21 i=0 t=0.000219 per=20.4 cost=2.19e+03 flops=1e+07
 renorm counter=21 i=1 t=0.000204 per=19 cost=2.85e+03 flops=1.4e+07
 renorm counter=21 i=2 t=1e-06 per=0.0934 cost=0 flops=0
 renorm counter=21 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=21 i=4 t=0.000201 per=18.8 cost=2.11e+03 flops=1.05e+07
 renorm counter=21 i=5 t=0.00021 per=19.6 cost=2.94e+03 flops=1.4e+07
 renorm counter=21 i=6 t=0.000236 per=22 cost=1.77e+04 flops=7.5e+07
 total GEMM cost=2.78e+04 flops=2.59e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.022 t_reduction=0.00379 tot=0.0258 ---
 renorm_tot counter=21 i=0 t=0.00441 per=20 cost=8e+04 flops=1.82e+07
 renorm_tot counter=21 i=1 t=0.00427 per=19.4 cost=1.16e+05 flops=2.72e+07
 renorm_tot counter=21 i=2 t=0.00196 per=8.94 cost=7.99e+04 flops=4.06e+07
 renorm_tot counter=21 i=3 t=0.00206 per=9.38 cost=1.39e+05 flops=6.75e+07
 renorm_tot counter=21 i=4 t=0.00221 per=10.1 cost=8.22e+04 flops=3.72e+07
 renorm_tot counter=21 i=5 t=0.00226 per=10.3 cost=1.41e+05 flops=6.25e+07
 renorm_tot counter=21 i=6 t=0.00481 per=21.9 cost=9.68e+05 flops=2.01e+08
 total GEMM cost=1.61e+06 flops=7.31e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=9e-05,0.0025,8.4e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=5.31e-05,3.39e-05,8.7e-05 speed=0.119GB/s disk[used]=0.000103GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.71e-02 S #####
 T(fetch) = 7.13e-05 S  per = 0.19  per(accum) = 0.19
 T(hdiag) = 7.14e-05 S  per = 0.19  per(accum) = 0.38
 T(dvdsn) = 3.35e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.86e-05 S  per = 0.21  per(accum) = 91
 T(guess) = 8.19e-05 S  per = 0.22  per(accum) = 91
 T(renrm) = 2.65e-03 S  per =  7.1  per(accum) = 98
 T(save ) = 5.62e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.34e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.00e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.33e-04 S  per =  0.7  per(accum) = 0.82
 T(hintermediate init           ) = 2.00e-04 S  per =  0.6  per(accum) = 1.4
 T(hintermediates memcpy cpu2gpu) = 3.62e-06 S  per = 0.011  per(accum) = 1.4
 T(preprocess_hformulae_Hxlist2 ) = 2.26e-03 S  per =  6.8  per(accum) = 8.2
 T(hmmtasks init                ) = 1.29e-03 S  per =  3.9  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 2.90e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 5.37e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.19e-04 S  per = 0.95  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 9.04e-05 S  per =  3.5  per(accum) = 3.5
 T(qops_dict memcpy cpu2gpu     ) = 2.91e-05 S  per =  1.1  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.04e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 1.15e-05 S  per = 0.44  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.68e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.53e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.36e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.58e-06 S  per = 0.33  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.82e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.44e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 3.71e-02 S #####
 T(fetch) = 7.13e-05 S  per = 0.19  per(accum) = 0.19
 T(hdiag) = 7.14e-05 S  per = 0.19  per(accum) = 0.38
 T(dvdsn) = 3.35e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.86e-05 S  per = 0.21  per(accum) = 91
 T(guess) = 8.19e-05 S  per = 0.22  per(accum) = 91
 T(renrm) = 2.65e-03 S  per =  7.1  per(accum) = 98
 T(save ) = 5.62e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.34e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.00e-05 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.33e-04 S  per =  0.7  per(accum) = 0.82
 T(hintermediate init           ) = 2.00e-04 S  per =  0.6  per(accum) = 1.4
 T(hintermediates memcpy cpu2gpu) = 3.62e-06 S  per = 0.011  per(accum) = 1.4
 T(preprocess_hformulae_Hxlist2 ) = 2.26e-03 S  per =  6.8  per(accum) = 8.2
 T(hmmtasks init                ) = 1.29e-03 S  per =  3.9  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 2.90e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 5.37e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.19e-04 S  per = 0.95  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 9.04e-05 S  per =  3.5  per(accum) = 3.5
 T(qops_dict memcpy cpu2gpu     ) = 2.91e-05 S  per =  1.1  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.04e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 1.15e-05 S  per = 0.44  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.68e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.53e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.36e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.58e-06 S  per = 0.33  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.82e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.44e-06 S  per = 0.32  per(accum) = 1e+02
##### time_global: 6.29e-01 S #####
 T(fetch) = 5.13e-03 S  per = 0.82  per(accum) = 0.82
 T(hdiag) = 1.77e-03 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 5.45e-01 S  per =   87  per(accum) = 88
 T(decim) = 4.82e-03 S  per = 0.77  per(accum) = 89
 T(guess) = 1.75e-03 S  per = 0.28  per(accum) = 89
 T(renrm) = 5.80e-02 S  per =  9.2  per(accum) = 98
 T(save ) = 1.22e-02 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.40e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 8.64e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 5.67e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 4.42e-03 S  per = 0.82  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 8.88e-05 S  per = 0.016  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 5.08e-02 S  per =  9.4  per(accum) = 11
 T(hmmtasks init                ) = 2.94e-02 S  per =  5.4  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 4.44e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 9.47e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.56e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.70e-02 S
 T(qops init                    ) = 2.15e-03 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 7.17e-04 S  per =  1.3  per(accum) = 5
 T(symbolic_formulae_renorm     ) = 4.51e-03 S  per =  7.9  per(accum) = 13
 T(rintermediate init           ) = 2.20e-03 S  per =  3.9  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 1.08e-04 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 1.16e-02 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 7.28e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.82e-04 S  per = 0.32  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 2.74e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.11e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.01e-04 S  per = 0.35  per(accum) = 1e+02

isweep=5 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.326e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47e85300
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.170e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000162 flops=2.73e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.988e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.2e-05,0.00096,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.6e-05,0.00194,0.000193 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00194 t_reduction=0.000193 tot=0.00213 ---
 sigma counter=204 i=0 t=0.00024 per=12.4 cost=6.81e+03 flops=2.84e+07
 sigma counter=204 i=1 t=0.000235 per=12.1 cost=6.78e+03 flops=2.89e+07
 sigma counter=204 i=2 t=0.000239 per=12.3 cost=7.01e+03 flops=2.93e+07
 sigma counter=204 i=3 t=0.000244 per=12.6 cost=6.99e+03 flops=2.86e+07
 sigma counter=204 i=4 t=0.000229 per=11.8 cost=6.81e+03 flops=2.98e+07
 sigma counter=204 i=5 t=0.000238 per=12.3 cost=6.78e+03 flops=2.85e+07
 sigma counter=204 i=6 t=0.000267 per=13.8 cost=1.89e+04 flops=7.08e+07
 sigma counter=204 i=7 t=0.000247 per=12.7 cost=1.89e+04 flops=7.65e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.384 t_reduction=0.0386 tot=0.423 ---
 sigma_tot counter=204 i=0 t=0.0475 per=12.4 cost=1.25e+06 flops=2.63e+07
 sigma_tot counter=204 i=1 t=0.0484 per=12.6 cost=1.26e+06 flops=2.61e+07
 sigma_tot counter=204 i=2 t=0.0474 per=12.3 cost=1.26e+06 flops=2.65e+07
 sigma_tot counter=204 i=3 t=0.0473 per=12.3 cost=1.26e+06 flops=2.67e+07
 sigma_tot counter=204 i=4 t=0.0474 per=12.3 cost=2.19e+06 flops=4.62e+07
 sigma_tot counter=204 i=5 t=0.0482 per=12.6 cost=2.19e+06 flops=4.54e+07
 sigma_tot counter=204 i=6 t=0.05 per=13 cost=2.41e+06 flops=4.83e+07
 sigma_tot counter=204 i=7 t=0.0478 per=12.4 cost=2.41e+06 flops=5.04e+07
 total GEMM cost=1.42e+07 flops=3.71e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00195,0.000189 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00195 t_reduction=0.000189 tot=0.00214 ---
 sigma counter=205 i=0 t=0.000238 per=12.2 cost=6.81e+03 flops=2.86e+07
 sigma counter=205 i=1 t=0.000237 per=12.1 cost=6.78e+03 flops=2.86e+07
 sigma counter=205 i=2 t=0.00024 per=12.3 cost=7.01e+03 flops=2.92e+07
 sigma counter=205 i=3 t=0.000245 per=12.6 cost=6.99e+03 flops=2.85e+07
 sigma counter=205 i=4 t=0.000242 per=12.4 cost=6.81e+03 flops=2.82e+07
 sigma counter=205 i=5 t=0.000238 per=12.2 cost=6.78e+03 flops=2.85e+07
 sigma counter=205 i=6 t=0.000266 per=13.6 cost=1.89e+04 flops=7.1e+07
 sigma counter=205 i=7 t=0.000246 per=12.6 cost=1.89e+04 flops=7.68e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.386 t_reduction=0.0388 tot=0.425 ---
 sigma_tot counter=205 i=0 t=0.0478 per=12.4 cost=1.26e+06 flops=2.63e+07
 sigma_tot counter=205 i=1 t=0.0486 per=12.6 cost=1.27e+06 flops=2.61e+07
 sigma_tot counter=205 i=2 t=0.0476 per=12.3 cost=1.27e+06 flops=2.66e+07
 sigma_tot counter=205 i=3 t=0.0476 per=12.3 cost=1.27e+06 flops=2.67e+07
 sigma_tot counter=205 i=4 t=0.0476 per=12.3 cost=2.2e+06 flops=4.61e+07
 sigma_tot counter=205 i=5 t=0.0484 per=12.5 cost=2.19e+06 flops=4.53e+07
 sigma_tot counter=205 i=6 t=0.0502 per=13 cost=2.43e+06 flops=4.84e+07
 sigma_tot counter=205 i=7 t=0.048 per=12.4 cost=2.43e+06 flops=5.05e+07
 total GEMM cost=1.43e+07 flops=3.71e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.52e-03  2.26e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   4.52e-03  2.26e-03
TIMING for Davidson : 4.53e-03  T(cal/comm/rest)=4.49e-03,1.01e-07,4.24e-05
optimized energies: isweep=5 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.628e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000161 flops=2.74e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 1.957e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.000546 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.7e-05,0.000235,0.000263 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00109,0.000183 cost=1.55e+05 flops[gemm]=1.43e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00108 t_reduction=0.000183 tot=0.00127 ---
 renorm counter=22 i=0 t=0.000216 per=19.9 cost=8.1e+03 flops=3.75e+07
 renorm counter=22 i=1 t=0.000202 per=18.7 cost=8.36e+03 flops=4.14e+07
 renorm counter=22 i=2 t=1e-06 per=0.0923 cost=0 flops=0
 renorm counter=22 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=22 i=4 t=0.000206 per=19 cost=1.65e+04 flops=8e+07
 renorm counter=22 i=5 t=0.00021 per=19.4 cost=2.89e+04 flops=1.38e+08
 renorm counter=22 i=6 t=0.000248 per=22.9 cost=9.32e+04 flops=3.76e+08
 total GEMM cost=1.55e+05 flops=1.43e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0231 t_reduction=0.00397 tot=0.027 ---
 renorm_tot counter=22 i=0 t=0.00462 per=20 cost=8.81e+04 flops=1.91e+07
 renorm_tot counter=22 i=1 t=0.00447 per=19.4 cost=1.25e+05 flops=2.79e+07
 renorm_tot counter=22 i=2 t=0.00197 per=8.53 cost=7.99e+04 flops=4.06e+07
 renorm_tot counter=22 i=3 t=0.00206 per=8.94 cost=1.39e+05 flops=6.75e+07
 renorm_tot counter=22 i=4 t=0.00242 per=10.5 cost=9.87e+04 flops=4.08e+07
 renorm_tot counter=22 i=5 t=0.00247 per=10.7 cost=1.7e+05 flops=6.89e+07
 renorm_tot counter=22 i=6 t=0.00505 per=21.9 cost=1.06e+06 flops=2.1e+08
 total GEMM cost=1.76e+06 flops=7.64e+07
check ||H-H.dagger||=1.19e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.3e-05,0.0027,8.8e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=5.14e-05,3.98e-05,9.12e-05 speed=0.212GB/s disk[used]=0.000104GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.29e-02 S #####
 T(fetch) = 3.09e-04 S  per =  2.4  per(accum) = 2.4
 T(hdiag) = 6.79e-05 S  per = 0.53  per(accum) = 2.9
 T(dvdsn) = 8.72e-03 S  per =   68  per(accum) = 71
 T(decim) = 2.98e-04 S  per =  2.3  per(accum) = 73
 T(guess) = 7.85e-05 S  per = 0.61  per(accum) = 74
 T(renrm) = 2.81e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.69e-04 S  per =  4.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.54e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.95e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.22e-04 S  per =  2.6  per(accum) = 3.1
 T(hintermediate init           ) = 2.02e-04 S  per =  2.4  per(accum) = 5.4
 T(hintermediates memcpy cpu2gpu) = 3.60e-06 S  per = 0.042  per(accum) = 5.5
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =   26  per(accum) = 32
 T(hmmtasks init                ) = 1.29e-03 S  per =   15  per(accum) = 47
 T(dvdson solver [Hx_batchGPU]  ) = 4.49e-03 S  per =   53  per(accum) = 1e+02
 T(dvdson solver [communication]) = 1.01e-07 S  per = 0.0012  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.24e-05 S  per =  0.5  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.76e-03 S
 T(qops init                    ) = 7.30e-05 S  per =  2.6  per(accum) = 2.6
 T(qops_dict memcpy cpu2gpu     ) = 3.47e-05 S  per =  1.3  per(accum) = 3.9
 T(symbolic_formulae_renorm     ) = 1.67e-04 S  per =  6.1  per(accum) = 10
 T(rintermediate init           ) = 1.99e-04 S  per =  7.2  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 4.42e-06 S  per = 0.16  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 5.55e-04 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 3.45e-04 S  per =   12  per(accum) = 50
 T(qops memset                  ) = 7.87e-06 S  per = 0.28  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 1.34e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.78e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.85e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 4.99e-02 S #####
 T(fetch) = 3.80e-04 S  per = 0.76  per(accum) = 0.76
 T(hdiag) = 1.39e-04 S  per = 0.28  per(accum) = 1
 T(dvdsn) = 4.23e-02 S  per =   85  per(accum) = 86
 T(decim) = 3.76e-04 S  per = 0.75  per(accum) = 86
 T(guess) = 1.60e-04 S  per = 0.32  per(accum) = 87
 T(renrm) = 5.46e-03 S  per =   11  per(accum) = 98
 T(save ) = 1.13e-03 S  per =  2.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.19e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 7.95e-05 S  per = 0.19  per(accum) = 0.19
 T(symbolic_formulae_twodot     ) = 4.55e-04 S  per =  1.1  per(accum) = 1.3
 T(hintermediate init           ) = 4.02e-04 S  per = 0.96  per(accum) = 2.2
 T(hintermediates memcpy cpu2gpu) = 7.22e-06 S  per = 0.017  per(accum) = 2.3
 T(preprocess_hformulae_Hxlist2 ) = 4.51e-03 S  per =   11  per(accum) = 13
 T(hmmtasks init                ) = 2.58e-03 S  per =  6.2  per(accum) = 19
 T(dvdson solver [Hx_batchGPU]  ) = 3.35e-02 S  per =   80  per(accum) = 99
 T(dvdson solver [communication]) = 6.38e-07 S  per = 0.0015  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.61e-04 S  per = 0.86  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.36e-03 S
 T(qops init                    ) = 1.63e-04 S  per =    3  per(accum) = 3
 T(qops_dict memcpy cpu2gpu     ) = 6.38e-05 S  per =  1.2  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 3.71e-04 S  per =  6.9  per(accum) = 11
 T(rintermediate init           ) = 2.11e-04 S  per =  3.9  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 9.10e-06 S  per = 0.17  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 1.11e-03 S  per =   21  per(accum) = 36
 T(rmmtasks init                ) = 6.81e-04 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 1.64e-05 S  per = 0.31  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 2.66e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.60e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.73e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 6.41e-01 S #####
 T(fetch) = 5.44e-03 S  per = 0.85  per(accum) = 0.85
 T(hdiag) = 1.84e-03 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 5.54e-01 S  per =   86  per(accum) = 87
 T(decim) = 5.12e-03 S  per =  0.8  per(accum) = 88
 T(guess) = 1.83e-03 S  per = 0.29  per(accum) = 89
 T(renrm) = 6.09e-02 S  per =  9.5  per(accum) = 98
 T(save ) = 1.27e-02 S  per =    2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.49e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.04e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 5.89e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 4.62e-03 S  per = 0.84  per(accum) = 2.1
 T(hintermediates memcpy cpu2gpu) = 9.24e-05 S  per = 0.017  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 5.30e-02 S  per =  9.7  per(accum) = 12
 T(hmmtasks init                ) = 3.07e-02 S  per =  5.6  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 4.48e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 9.57e-06 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.60e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.97e-02 S
 T(qops init                    ) = 2.23e-03 S  per =  3.7  per(accum) = 3.7
 T(qops_dict memcpy cpu2gpu     ) = 7.51e-04 S  per =  1.3  per(accum) = 5
 T(symbolic_formulae_renorm     ) = 4.67e-03 S  per =  7.8  per(accum) = 13
 T(rintermediate init           ) = 2.40e-03 S  per =    4  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 1.12e-04 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 1.22e-02 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 7.63e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.90e-04 S  per = 0.32  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 2.88e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.39e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.10e-04 S  per = 0.35  per(accum) = 1e+02

isweep=5 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.086e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47c6fcf0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.249e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.00016 flops=2.76e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.962e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00225 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.31e-05,0.000964,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.6e-05,0.00195,0.00019 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00195 t_reduction=0.00019 tot=0.00214 ---
 sigma counter=206 i=0 t=0.00024 per=12.3 cost=6.81e+03 flops=2.84e+07
 sigma counter=206 i=1 t=0.000238 per=12.2 cost=6.78e+03 flops=2.85e+07
 sigma counter=206 i=2 t=0.000236 per=12.1 cost=7.01e+03 flops=2.97e+07
 sigma counter=206 i=3 t=0.000237 per=12.1 cost=6.99e+03 flops=2.95e+07
 sigma counter=206 i=4 t=0.00024 per=12.3 cost=6.81e+03 flops=2.84e+07
 sigma counter=206 i=5 t=0.000237 per=12.1 cost=6.78e+03 flops=2.86e+07
 sigma counter=206 i=6 t=0.000268 per=13.7 cost=1.89e+04 flops=7.05e+07
 sigma counter=206 i=7 t=0.000255 per=13.1 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.388 t_reduction=0.0389 tot=0.427 ---
 sigma_tot counter=206 i=0 t=0.048 per=12.4 cost=1.26e+06 flops=2.63e+07
 sigma_tot counter=206 i=1 t=0.0489 per=12.6 cost=1.27e+06 flops=2.61e+07
 sigma_tot counter=206 i=2 t=0.0479 per=12.3 cost=1.27e+06 flops=2.66e+07
 sigma_tot counter=206 i=3 t=0.0478 per=12.3 cost=1.28e+06 flops=2.67e+07
 sigma_tot counter=206 i=4 t=0.0479 per=12.3 cost=2.2e+06 flops=4.6e+07
 sigma_tot counter=206 i=5 t=0.0487 per=12.5 cost=2.2e+06 flops=4.52e+07
 sigma_tot counter=206 i=6 t=0.0505 per=13 cost=2.45e+06 flops=4.85e+07
 sigma_tot counter=206 i=7 t=0.0483 per=12.4 cost=2.44e+06 flops=5.07e+07
 total GEMM cost=1.44e+07 flops=3.71e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.7e-05,0.00193,0.000187 cost=7.9e+04 flops[gemm]=4.1e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00192 t_reduction=0.000187 tot=0.00211 ---
 sigma counter=207 i=0 t=0.000233 per=12.1 cost=6.81e+03 flops=2.92e+07
 sigma counter=207 i=1 t=0.000236 per=12.3 cost=6.78e+03 flops=2.87e+07
 sigma counter=207 i=2 t=0.000242 per=12.6 cost=7.01e+03 flops=2.9e+07
 sigma counter=207 i=3 t=0.000236 per=12.3 cost=6.99e+03 flops=2.96e+07
 sigma counter=207 i=4 t=0.000232 per=12.1 cost=6.81e+03 flops=2.94e+07
 sigma counter=207 i=5 t=0.000234 per=12.2 cost=6.78e+03 flops=2.9e+07
 sigma counter=207 i=6 t=0.000261 per=13.6 cost=1.89e+04 flops=7.24e+07
 sigma counter=207 i=7 t=0.000249 per=12.9 cost=1.89e+04 flops=7.59e+07
 total GEMM cost=7.9e+04 flops=4.11e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.39 t_reduction=0.0391 tot=0.429 ---
 sigma_tot counter=207 i=0 t=0.0483 per=12.4 cost=1.27e+06 flops=2.63e+07
 sigma_tot counter=207 i=1 t=0.0491 per=12.6 cost=1.28e+06 flops=2.61e+07
 sigma_tot counter=207 i=2 t=0.0481 per=12.3 cost=1.28e+06 flops=2.66e+07
 sigma_tot counter=207 i=3 t=0.0481 per=12.3 cost=1.28e+06 flops=2.67e+07
 sigma_tot counter=207 i=4 t=0.0481 per=12.3 cost=2.21e+06 flops=4.6e+07
 sigma_tot counter=207 i=5 t=0.0489 per=12.5 cost=2.21e+06 flops=4.51e+07
 sigma_tot counter=207 i=6 t=0.0508 per=13 cost=2.47e+06 flops=4.87e+07
 sigma_tot counter=207 i=7 t=0.0485 per=12.4 cost=2.46e+06 flops=5.08e+07
 total GEMM cost=1.45e+07 flops=3.71e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   4.49e-03  2.25e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   4.49e-03  2.25e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.13e-03 ---
 sigma counter=208 i=0 t=2.47e-04 per=1.27e+01 cost=6.81e+03 flops=2.76e+07
 sigma counter=208 i=1 t=2.31e-04 per=1.19e+01 cost=6.78e+03 flops=2.94e+07
 sigma counter=208 i=2 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=208 i=3 t=2.35e-04 per=1.21e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=208 i=4 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=208 i=5 t=2.42e-04 per=1.25e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=208 i=6 t=2.71e-04 per=1.40e+01 cost=1.89e+04 flops=6.97e+07
 sigma counter=208 i=7 t=2.45e-04 per=1.26e+01 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.92e-01 t_reduction=3.93e-02 tot=4.31e-01 ---
 sigma_tot counter=208 i=0 t=4.85e-02 per=1.24e+01 cost=1.28e+06 flops=2.63e+07
 sigma_tot counter=208 i=1 t=4.93e-02 per=1.26e+01 cost=1.29e+06 flops=2.61e+07
 sigma_tot counter=208 i=2 t=4.84e-02 per=1.23e+01 cost=1.29e+06 flops=2.66e+07
 sigma_tot counter=208 i=3 t=4.83e-02 per=1.23e+01 cost=1.29e+06 flops=2.67e+07
 sigma_tot counter=208 i=4 t=4.83e-02 per=1.23e+01 cost=2.22e+06 flops=4.59e+07
 sigma_tot counter=208 i=5 t=4.91e-02 per=1.25e+01 cost=2.21e+06 flops=4.50e+07
 sigma_tot counter=208 i=6 t=5.10e-02 per=1.30e+01 cost=2.49e+06 flops=4.88e+07
 sigma_tot counter=208 i=7 t=4.88e-02 per=1.24e+01 cost=2.48e+06 flops=5.09e+07
 total GEMM cost=1.45e+07 flops=3.71e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.92e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.11e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.92e-03 t_reduction=1.87e-04 tot=2.11e-03 ---
 sigma counter=209 i=0 t=2.38e-04 per=1.24e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=209 i=1 t=2.36e-04 per=1.23e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=209 i=2 t=2.40e-04 per=1.25e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=209 i=3 t=2.37e-04 per=1.23e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=209 i=4 t=2.32e-04 per=1.21e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=209 i=5 t=2.34e-04 per=1.22e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=209 i=6 t=2.60e-04 per=1.35e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=209 i=7 t=2.45e-04 per=1.27e+01 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.90e+04 flops=4.11e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.94e-01 t_reduction=3.95e-02 tot=4.33e-01 ---
 sigma_tot counter=209 i=0 t=4.87e-02 per=1.24e+01 cost=1.28e+06 flops=2.64e+07
 sigma_tot counter=209 i=1 t=4.96e-02 per=1.26e+01 cost=1.29e+06 flops=2.61e+07
 sigma_tot counter=209 i=2 t=4.86e-02 per=1.23e+01 cost=1.29e+06 flops=2.66e+07
 sigma_tot counter=209 i=3 t=4.85e-02 per=1.23e+01 cost=1.30e+06 flops=2.67e+07
 sigma_tot counter=209 i=4 t=4.86e-02 per=1.23e+01 cost=2.22e+06 flops=4.58e+07
 sigma_tot counter=209 i=5 t=4.94e-02 per=1.25e+01 cost=2.22e+06 flops=4.50e+07
 sigma_tot counter=209 i=6 t=5.13e-02 per=1.30e+01 cost=2.51e+06 flops=4.89e+07
 sigma_tot counter=209 i=7 t=4.90e-02 per=1.24e+01 cost=2.50e+06 flops=5.11e+07
 total GEMM cost=1.46e+07 flops=3.71e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   8.98e-03  2.25e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   8.98e-03  2.25e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.90e-05,1.96e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=1.92e-04 tot=2.15e-03 ---
 sigma counter=210 i=0 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=210 i=1 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=210 i=2 t=2.44e-04 per=1.25e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=210 i=3 t=2.43e-04 per=1.24e+01 cost=6.99e+03 flops=2.88e+07
 sigma counter=210 i=4 t=2.34e-04 per=1.19e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=210 i=5 t=2.36e-04 per=1.20e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=210 i=6 t=2.68e-04 per=1.37e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=210 i=7 t=2.60e-04 per=1.33e+01 cost=1.89e+04 flops=7.27e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.96e-01 t_reduction=3.97e-02 tot=4.35e-01 ---
 sigma_tot counter=210 i=0 t=4.90e-02 per=1.24e+01 cost=1.29e+06 flops=2.64e+07
 sigma_tot counter=210 i=1 t=4.98e-02 per=1.26e+01 cost=1.30e+06 flops=2.61e+07
 sigma_tot counter=210 i=2 t=4.88e-02 per=1.23e+01 cost=1.30e+06 flops=2.66e+07
 sigma_tot counter=210 i=3 t=4.88e-02 per=1.23e+01 cost=1.30e+06 flops=2.67e+07
 sigma_tot counter=210 i=4 t=4.88e-02 per=1.23e+01 cost=2.23e+06 flops=4.57e+07
 sigma_tot counter=210 i=5 t=4.96e-02 per=1.25e+01 cost=2.23e+06 flops=4.49e+07
 sigma_tot counter=210 i=6 t=5.16e-02 per=1.30e+01 cost=2.53e+06 flops=4.90e+07
 sigma_tot counter=210 i=7 t=4.93e-02 per=1.24e+01 cost=2.52e+06 flops=5.12e+07
 total GEMM cost=1.47e+07 flops=3.72e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.14e-03 ---
 sigma counter=211 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=211 i=1 t=2.43e-04 per=1.24e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=211 i=2 t=2.35e-04 per=1.20e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=211 i=3 t=2.44e-04 per=1.25e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=211 i=4 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=211 i=5 t=2.42e-04 per=1.24e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=211 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=211 i=7 t=2.55e-04 per=1.31e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=3.98e-01 t_reduction=3.99e-02 tot=4.37e-01 ---
 sigma_tot counter=211 i=0 t=4.92e-02 per=1.24e+01 cost=1.30e+06 flops=2.64e+07
 sigma_tot counter=211 i=1 t=5.00e-02 per=1.26e+01 cost=1.31e+06 flops=2.61e+07
 sigma_tot counter=211 i=2 t=4.91e-02 per=1.23e+01 cost=1.31e+06 flops=2.66e+07
 sigma_tot counter=211 i=3 t=4.90e-02 per=1.23e+01 cost=1.31e+06 flops=2.68e+07
 sigma_tot counter=211 i=4 t=4.90e-02 per=1.23e+01 cost=2.24e+06 flops=4.56e+07
 sigma_tot counter=211 i=5 t=4.99e-02 per=1.25e+01 cost=2.23e+06 flops=4.48e+07
 sigma_tot counter=211 i=6 t=5.18e-02 per=1.30e+01 cost=2.55e+06 flops=4.91e+07
 sigma_tot counter=211 i=7 t=4.95e-02 per=1.25e+01 cost=2.54e+06 flops=5.13e+07
 total GEMM cost=1.48e+07 flops=3.72e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.35e-02  2.25e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   1.35e-02  2.25e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.96e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.14e-03 ---
 sigma counter=212 i=0 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=212 i=1 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=212 i=2 t=2.44e-04 per=1.25e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=212 i=3 t=2.38e-04 per=1.22e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=212 i=4 t=2.30e-04 per=1.18e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=212 i=5 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=212 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=212 i=7 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.00e-01 t_reduction=4.01e-02 tot=4.40e-01 ---
 sigma_tot counter=212 i=0 t=4.95e-02 per=1.24e+01 cost=1.31e+06 flops=2.64e+07
 sigma_tot counter=212 i=1 t=5.03e-02 per=1.26e+01 cost=1.31e+06 flops=2.62e+07
 sigma_tot counter=212 i=2 t=4.93e-02 per=1.23e+01 cost=1.31e+06 flops=2.66e+07
 sigma_tot counter=212 i=3 t=4.92e-02 per=1.23e+01 cost=1.32e+06 flops=2.68e+07
 sigma_tot counter=212 i=4 t=4.93e-02 per=1.23e+01 cost=2.24e+06 flops=4.56e+07
 sigma_tot counter=212 i=5 t=5.01e-02 per=1.25e+01 cost=2.24e+06 flops=4.47e+07
 sigma_tot counter=212 i=6 t=5.21e-02 per=1.30e+01 cost=2.57e+06 flops=4.92e+07
 sigma_tot counter=212 i=7 t=4.98e-02 per=1.25e+01 cost=2.56e+06 flops=5.14e+07
 total GEMM cost=1.49e+07 flops=3.72e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.00e-05,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.14e-03 ---
 sigma counter=213 i=0 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=213 i=1 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=213 i=2 t=2.43e-04 per=1.24e+01 cost=7.01e+03 flops=2.88e+07
 sigma counter=213 i=3 t=2.44e-04 per=1.25e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=213 i=4 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=213 i=5 t=2.37e-04 per=1.21e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=213 i=6 t=2.68e-04 per=1.37e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=213 i=7 t=2.52e-04 per=1.29e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.01e-01 t_reduction=4.03e-02 tot=4.42e-01 ---
 sigma_tot counter=213 i=0 t=4.97e-02 per=1.24e+01 cost=1.31e+06 flops=2.64e+07
 sigma_tot counter=213 i=1 t=5.05e-02 per=1.26e+01 cost=1.32e+06 flops=2.62e+07
 sigma_tot counter=213 i=2 t=4.96e-02 per=1.23e+01 cost=1.32e+06 flops=2.67e+07
 sigma_tot counter=213 i=3 t=4.95e-02 per=1.23e+01 cost=1.33e+06 flops=2.68e+07
 sigma_tot counter=213 i=4 t=4.95e-02 per=1.23e+01 cost=2.25e+06 flops=4.55e+07
 sigma_tot counter=213 i=5 t=5.03e-02 per=1.25e+01 cost=2.25e+06 flops=4.46e+07
 sigma_tot counter=213 i=6 t=5.24e-02 per=1.30e+01 cost=2.58e+06 flops=4.93e+07
 sigma_tot counter=213 i=7 t=5.00e-02 per=1.25e+01 cost=2.58e+06 flops=5.15e+07
 total GEMM cost=1.49e+07 flops=3.72e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.81e-02  2.26e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.81e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.80e-05,1.96e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.14e-03 ---
 sigma counter=214 i=0 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=214 i=1 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=214 i=2 t=2.38e-04 per=1.22e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=214 i=3 t=2.47e-04 per=1.26e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=214 i=4 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=214 i=5 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=214 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=214 i=7 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.03e-01 t_reduction=4.05e-02 tot=4.44e-01 ---
 sigma_tot counter=214 i=0 t=4.99e-02 per=1.24e+01 cost=1.32e+06 flops=2.64e+07
 sigma_tot counter=214 i=1 t=5.08e-02 per=1.26e+01 cost=1.33e+06 flops=2.62e+07
 sigma_tot counter=214 i=2 t=4.98e-02 per=1.23e+01 cost=1.33e+06 flops=2.67e+07
 sigma_tot counter=214 i=3 t=4.97e-02 per=1.23e+01 cost=1.33e+06 flops=2.68e+07
 sigma_tot counter=214 i=4 t=4.97e-02 per=1.23e+01 cost=2.26e+06 flops=4.54e+07
 sigma_tot counter=214 i=5 t=5.06e-02 per=1.25e+01 cost=2.25e+06 flops=4.46e+07
 sigma_tot counter=214 i=6 t=5.26e-02 per=1.30e+01 cost=2.60e+06 flops=4.95e+07
 sigma_tot counter=214 i=7 t=5.03e-02 per=1.25e+01 cost=2.60e+06 flops=5.16e+07
 total GEMM cost=1.50e+07 flops=3.72e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.94e-03,1.86e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.94e-03 t_reduction=1.86e-04 tot=2.13e-03 ---
 sigma counter=215 i=0 t=2.37e-04 per=1.22e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=215 i=1 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=215 i=2 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=215 i=3 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=215 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=215 i=5 t=2.34e-04 per=1.21e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=215 i=6 t=2.68e-04 per=1.38e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=215 i=7 t=2.60e-04 per=1.34e+01 cost=1.89e+04 flops=7.27e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.05e-01 t_reduction=4.06e-02 tot=4.46e-01 ---
 sigma_tot counter=215 i=0 t=5.02e-02 per=1.24e+01 cost=1.33e+06 flops=2.64e+07
 sigma_tot counter=215 i=1 t=5.10e-02 per=1.26e+01 cost=1.34e+06 flops=2.62e+07
 sigma_tot counter=215 i=2 t=5.00e-02 per=1.23e+01 cost=1.34e+06 flops=2.67e+07
 sigma_tot counter=215 i=3 t=5.00e-02 per=1.23e+01 cost=1.34e+06 flops=2.68e+07
 sigma_tot counter=215 i=4 t=5.00e-02 per=1.23e+01 cost=2.27e+06 flops=4.53e+07
 sigma_tot counter=215 i=5 t=5.08e-02 per=1.25e+01 cost=2.26e+06 flops=4.45e+07
 sigma_tot counter=215 i=6 t=5.29e-02 per=1.30e+01 cost=2.62e+06 flops=4.96e+07
 sigma_tot counter=215 i=7 t=5.05e-02 per=1.25e+01 cost=2.62e+06 flops=5.18e+07
 total GEMM cost=1.51e+07 flops=3.72e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.26e-02  2.26e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.26e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.92e-03 t_reduction=1.88e-04 tot=2.11e-03 ---
 sigma counter=216 i=0 t=2.38e-04 per=1.24e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=216 i=1 t=2.37e-04 per=1.23e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=216 i=2 t=2.38e-04 per=1.24e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=216 i=3 t=2.42e-04 per=1.26e+01 cost=6.99e+03 flops=2.89e+07
 sigma counter=216 i=4 t=2.29e-04 per=1.19e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=216 i=5 t=2.38e-04 per=1.24e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=216 i=6 t=2.60e-04 per=1.35e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=216 i=7 t=2.43e-04 per=1.26e+01 cost=1.89e+04 flops=7.78e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.07e-01 t_reduction=4.08e-02 tot=4.48e-01 ---
 sigma_tot counter=216 i=0 t=5.04e-02 per=1.24e+01 cost=1.33e+06 flops=2.64e+07
 sigma_tot counter=216 i=1 t=5.12e-02 per=1.26e+01 cost=1.34e+06 flops=2.62e+07
 sigma_tot counter=216 i=2 t=5.03e-02 per=1.23e+01 cost=1.34e+06 flops=2.67e+07
 sigma_tot counter=216 i=3 t=5.02e-02 per=1.23e+01 cost=1.35e+06 flops=2.68e+07
 sigma_tot counter=216 i=4 t=5.02e-02 per=1.23e+01 cost=2.27e+06 flops=4.53e+07
 sigma_tot counter=216 i=5 t=5.10e-02 per=1.25e+01 cost=2.27e+06 flops=4.44e+07
 sigma_tot counter=216 i=6 t=5.32e-02 per=1.31e+01 cost=2.64e+06 flops=4.97e+07
 sigma_tot counter=216 i=7 t=5.08e-02 per=1.25e+01 cost=2.63e+06 flops=5.19e+07
 total GEMM cost=1.52e+07 flops=3.73e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.93e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.86e-04 tot=2.12e-03 ---
 sigma counter=217 i=0 t=2.38e-04 per=1.23e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=217 i=1 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=217 i=2 t=2.35e-04 per=1.22e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=217 i=3 t=2.38e-04 per=1.23e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=217 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=217 i=5 t=2.43e-04 per=1.26e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=217 i=6 t=2.68e-04 per=1.39e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=217 i=7 t=2.46e-04 per=1.27e+01 cost=1.89e+04 flops=7.68e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.09e-01 t_reduction=4.10e-02 tot=4.50e-01 ---
 sigma_tot counter=217 i=0 t=5.06e-02 per=1.24e+01 cost=1.34e+06 flops=2.64e+07
 sigma_tot counter=217 i=1 t=5.15e-02 per=1.26e+01 cost=1.35e+06 flops=2.62e+07
 sigma_tot counter=217 i=2 t=5.05e-02 per=1.23e+01 cost=1.35e+06 flops=2.67e+07
 sigma_tot counter=217 i=3 t=5.05e-02 per=1.23e+01 cost=1.35e+06 flops=2.68e+07
 sigma_tot counter=217 i=4 t=5.04e-02 per=1.23e+01 cost=2.28e+06 flops=4.52e+07
 sigma_tot counter=217 i=5 t=5.13e-02 per=1.25e+01 cost=2.27e+06 flops=4.43e+07
 sigma_tot counter=217 i=6 t=5.34e-02 per=1.31e+01 cost=2.66e+06 flops=4.98e+07
 sigma_tot counter=217 i=7 t=5.10e-02 per=1.25e+01 cost=2.65e+06 flops=5.20e+07
 total GEMM cost=1.53e+07 flops=3.73e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   2.71e-02  2.26e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   2.71e-02  2.26e-03
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.70e-05,1.93e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.93e-03 t_reduction=1.89e-04 tot=2.12e-03 ---
 sigma counter=218 i=0 t=2.37e-04 per=1.23e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=218 i=1 t=2.37e-04 per=1.23e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=218 i=2 t=2.38e-04 per=1.23e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=218 i=3 t=2.38e-04 per=1.23e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=218 i=4 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=218 i=5 t=2.34e-04 per=1.21e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=218 i=6 t=2.62e-04 per=1.36e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=218 i=7 t=2.52e-04 per=1.31e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.11e-01 t_reduction=4.12e-02 tot=4.52e-01 ---
 sigma_tot counter=218 i=0 t=5.09e-02 per=1.24e+01 cost=1.35e+06 flops=2.65e+07
 sigma_tot counter=218 i=1 t=5.17e-02 per=1.26e+01 cost=1.36e+06 flops=2.62e+07
 sigma_tot counter=218 i=2 t=5.08e-02 per=1.23e+01 cost=1.36e+06 flops=2.67e+07
 sigma_tot counter=218 i=3 t=5.07e-02 per=1.23e+01 cost=1.36e+06 flops=2.68e+07
 sigma_tot counter=218 i=4 t=5.07e-02 per=1.23e+01 cost=2.29e+06 flops=4.51e+07
 sigma_tot counter=218 i=5 t=5.15e-02 per=1.25e+01 cost=2.28e+06 flops=4.43e+07
 sigma_tot counter=218 i=6 t=5.37e-02 per=1.31e+01 cost=2.68e+06 flops=4.99e+07
 sigma_tot counter=218 i=7 t=5.13e-02 per=1.25e+01 cost=2.67e+06 flops=5.21e+07
 total GEMM cost=1.53e+07 flops=3.73e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.60e-05,1.98e-03,1.87e-04 cost=7.90e+04 flops[gemm]=3.99e+07
--- TIMING FOR sigma : t_inter=0.00e+00 t_gemm=1.98e-03 t_reduction=1.87e-04 tot=2.16e-03 ---
 sigma counter=219 i=0 t=2.40e-04 per=1.21e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=219 i=1 t=2.40e-04 per=1.21e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=219 i=2 t=2.43e-04 per=1.23e+01 cost=7.01e+03 flops=2.88e+07
 sigma counter=219 i=3 t=2.52e-04 per=1.27e+01 cost=6.99e+03 flops=2.77e+07
 sigma counter=219 i=4 t=2.35e-04 per=1.19e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=219 i=5 t=2.43e-04 per=1.23e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=219 i=6 t=2.72e-04 per=1.38e+01 cost=1.89e+04 flops=6.95e+07
 sigma counter=219 i=7 t=2.52e-04 per=1.27e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.00e+07
--- TIMING FOR sigma_tot : t_inter=0.00e+00 t_gemm=4.13e-01 t_reduction=4.14e-02 tot=4.55e-01 ---
 sigma_tot counter=219 i=0 t=5.11e-02 per=1.24e+01 cost=1.35e+06 flops=2.65e+07
 sigma_tot counter=219 i=1 t=5.19e-02 per=1.26e+01 cost=1.36e+06 flops=2.62e+07
 sigma_tot counter=219 i=2 t=5.10e-02 per=1.23e+01 cost=1.36e+06 flops=2.67e+07
 sigma_tot counter=219 i=3 t=5.09e-02 per=1.23e+01 cost=1.37e+06 flops=2.68e+07
 sigma_tot counter=219 i=4 t=5.09e-02 per=1.23e+01 cost=2.29e+06 flops=4.50e+07
 sigma_tot counter=219 i=5 t=5.18e-02 per=1.25e+01 cost=2.29e+06 flops=4.42e+07
 sigma_tot counter=219 i=6 t=5.40e-02 per=1.31e+01 cost=2.70e+06 flops=5.00e+07
 sigma_tot counter=219 i=7 t=5.15e-02 per=1.25e+01 cost=2.69e+06 flops=5.22e+07
 total GEMM cost=1.54e+07 flops=3.73e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   3.16e-02  2.26e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   3.16e-02  2.26e-03
TIMING for Davidson : 3.16e-02  T(cal/comm/rest)=3.13e-02,5.94e-07,3.33e-04
optimized energies: isweep=5 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.032e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0
 size of rintermediate operators=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000541 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.5e-05,0.00024,0.000246 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00107,0.000181 cost=2.78e+04 flops[gemm]=2.6e+07
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00107 t_reduction=0.000181 tot=0.00125 ---
 renorm counter=23 i=0 t=0.000216 per=20.2 cost=1.82e+03 flops=8.44e+06
 renorm counter=23 i=1 t=0.000207 per=19.4 cost=3.23e+03 flops=1.56e+07
 renorm counter=23 i=2 t=0.000198 per=18.6 cost=1.91e+03 flops=9.63e+06
 renorm counter=23 i=3 t=0.000203 per=19 cost=3.14e+03 flops=1.55e+07
 renorm counter=23 i=4 t=1e-06 per=0.0937 cost=0 flops=0
 renorm counter=23 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=23 i=6 t=0.000242 per=22.7 cost=1.77e+04 flops=7.31e+07
 total GEMM cost=2.78e+04 flops=2.6e+07
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0241 t_reduction=0.00415 tot=0.0283 ---
 renorm_tot counter=23 i=0 t=0.00484 per=20 cost=8.99e+04 flops=1.86e+07
 renorm_tot counter=23 i=1 t=0.00468 per=19.4 cost=1.28e+05 flops=2.73e+07
 renorm_tot counter=23 i=2 t=0.00216 per=8.97 cost=8.18e+04 flops=3.78e+07
 renorm_tot counter=23 i=3 t=0.00227 per=9.39 cost=1.42e+05 flops=6.28e+07
 renorm_tot counter=23 i=4 t=0.00242 per=10 cost=9.87e+04 flops=4.08e+07
 renorm_tot counter=23 i=5 t=0.00247 per=10.2 cost=1.7e+05 flops=6.89e+07
 renorm_tot counter=23 i=6 t=0.0053 per=21.9 cost=1.08e+06 flops=2.04e+08
 total GEMM cost=1.79e+06 flops=7.42e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=9.2e-05,0.0025,8.8e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=4.94e-05,3.17e-05,8.11e-05 speed=0.128GB/s disk[used]=0.000104GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 3.93e-02 S #####
 T(fetch) = 7.44e-05 S  per = 0.19  per(accum) = 0.19
 T(hdiag) = 7.68e-05 S  per =  0.2  per(accum) = 0.38
 T(dvdsn) = 3.58e-02 S  per =   91  per(accum) = 91
 T(decim) = 8.29e-05 S  per = 0.21  per(accum) = 92
 T(guess) = 7.92e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.63e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.56e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.56e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.97e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.30e-04 S  per = 0.65  per(accum) = 0.76
 T(hintermediate init           ) = 1.99e-04 S  per = 0.56  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 3.61e-06 S  per = 0.01  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 2.26e-03 S  per =  6.3  per(accum) = 7.7
 T(hmmtasks init                ) = 1.29e-03 S  per =  3.6  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.13e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 5.94e-07 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.33e-04 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.59e-03 S
 T(qops init                    ) = 9.16e-05 S  per =  3.5  per(accum) = 3.5
 T(qops_dict memcpy cpu2gpu     ) = 2.75e-05 S  per =  1.1  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.08e-04 S  per =    8  per(accum) = 13
 T(rintermediate init           ) = 1.17e-05 S  per = 0.45  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.70e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.50e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.30e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.43e-06 S  per = 0.33  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.81e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.78e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 8.92e-02 S #####
 T(fetch) = 4.55e-04 S  per = 0.51  per(accum) = 0.51
 T(hdiag) = 2.16e-04 S  per = 0.24  per(accum) = 0.75
 T(dvdsn) = 7.81e-02 S  per =   88  per(accum) = 88
 T(decim) = 4.59e-04 S  per = 0.51  per(accum) = 89
 T(guess) = 2.40e-04 S  per = 0.27  per(accum) = 89
 T(renrm) = 8.09e-03 S  per =  9.1  per(accum) = 98
 T(save ) = 1.69e-03 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 7.76e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.19e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 6.85e-04 S  per = 0.88  per(accum) = 1
 T(hintermediate init           ) = 6.02e-04 S  per = 0.78  per(accum) = 1.8
 T(hintermediates memcpy cpu2gpu) = 1.08e-05 S  per = 0.014  per(accum) = 1.8
 T(preprocess_hformulae_Hxlist2 ) = 6.77e-03 S  per =  8.7  per(accum) = 11
 T(hmmtasks init                ) = 3.87e-03 S  per =    5  per(accum) = 16
 T(dvdson solver [Hx_batchGPU]  ) = 6.48e-02 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 1.23e-06 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 6.94e-04 S  per =  0.9  per(accum) = 1e+02
Detailed decomposition of T(renrm): 7.95e-03 S
 T(qops init                    ) = 2.55e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 9.13e-05 S  per =  1.1  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 5.79e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 2.22e-04 S  per =  2.8  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 1.38e-05 S  per = 0.17  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 1.66e-03 S  per =   21  per(accum) = 35
 T(rmmtasks init                ) = 1.01e-03 S  per =   13  per(accum) = 48
 T(qops memset                  ) = 2.49e-05 S  per = 0.31  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 3.98e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.40e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.61e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 6.81e-01 S #####
 T(fetch) = 5.52e-03 S  per = 0.81  per(accum) = 0.81
 T(hdiag) = 1.92e-03 S  per = 0.28  per(accum) = 1.1
 T(dvdsn) = 5.89e-01 S  per =   87  per(accum) = 88
 T(decim) = 5.20e-03 S  per = 0.76  per(accum) = 88
 T(guess) = 1.91e-03 S  per = 0.28  per(accum) = 89
 T(renrm) = 6.35e-02 S  per =  9.3  per(accum) = 98
 T(save ) = 1.33e-02 S  per =    2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.85e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.43e-04 S  per = 0.16  per(accum) = 0.16
 T(symbolic_formulae_twodot     ) = 6.12e-03 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 4.82e-03 S  per = 0.82  per(accum) = 2
 T(hintermediates memcpy cpu2gpu) = 9.60e-05 S  per = 0.016  per(accum) = 2
 T(preprocess_hformulae_Hxlist2 ) = 5.53e-02 S  per =  9.5  per(accum) = 12
 T(hmmtasks init                ) = 3.19e-02 S  per =  5.5  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 4.79e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 1.02e-05 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.93e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.23e-02 S
 T(qops init                    ) = 2.32e-03 S  per =  3.7  per(accum) = 3.7
 T(qops_dict memcpy cpu2gpu     ) = 7.79e-04 S  per =  1.2  per(accum) = 5
 T(symbolic_formulae_renorm     ) = 4.88e-03 S  per =  7.8  per(accum) = 13
 T(rintermediate init           ) = 2.42e-03 S  per =  3.9  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 1.17e-04 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 1.27e-02 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 7.96e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 1.98e-04 S  per = 0.32  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 3.01e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.67e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.19e-04 S  per = 0.35  per(accum) = 1e+02

isweep=5 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=18 alg_renorm=18 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.353e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47b676f0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.251e-04 S -----
hintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92
 size of hintermediate operators=1104:0.00842MB:8.23e-06GB
cost_hinter=4.42e+03 time=0.000163 flops=2.71e+07
----- TIMING FOR hintermediates<Tm>::init_batch_gpu : 1.971e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-05 (oper,hinter)(GB)=1.36e-05,8.23e-06
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.37e-05,0.00095,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000396 (oper,hinter,dvdson,batch)(GB)=1.36e-05,8.23e-06,1.49e-06,0.000372
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=2.7e-05,0.00194,0.00019 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00194 t_reduction=0.000189 tot=0.00213 ---
 sigma counter=220 i=0 t=0.000245 per=12.6 cost=7.01e+03 flops=2.86e+07
 sigma counter=220 i=1 t=0.000238 per=12.3 cost=6.99e+03 flops=2.94e+07
 sigma counter=220 i=2 t=0.000231 per=11.9 cost=6.81e+03 flops=2.95e+07
 sigma counter=220 i=3 t=0.000244 per=12.6 cost=6.78e+03 flops=2.78e+07
 sigma counter=220 i=4 t=0.00025 per=12.9 cost=1.89e+04 flops=7.56e+07
 sigma counter=220 i=5 t=0.000249 per=12.8 cost=1.89e+04 flops=7.59e+07
 sigma counter=220 i=6 t=0.000251 per=12.9 cost=6.78e+03 flops=2.7e+07
 sigma counter=220 i=7 t=0.000231 per=11.9 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.415 t_reduction=0.0416 tot=0.457 ---
 sigma_tot counter=220 i=0 t=0.0514 per=12.4 cost=1.36e+06 flops=2.65e+07
 sigma_tot counter=220 i=1 t=0.0522 per=12.6 cost=1.37e+06 flops=2.62e+07
 sigma_tot counter=220 i=2 t=0.0512 per=12.3 cost=1.37e+06 flops=2.67e+07
 sigma_tot counter=220 i=3 t=0.0512 per=12.3 cost=1.37e+06 flops=2.68e+07
 sigma_tot counter=220 i=4 t=0.0511 per=12.3 cost=2.31e+06 flops=4.52e+07
 sigma_tot counter=220 i=5 t=0.052 per=12.5 cost=2.31e+06 flops=4.44e+07
 sigma_tot counter=220 i=6 t=0.0542 per=13.1 cost=2.7e+06 flops=4.99e+07
 sigma_tot counter=220 i=7 t=0.0518 per=12.5 cost=2.7e+06 flops=5.21e+07
 total GEMM cost=1.55e+07 flops=3.73e+07
preprocess_Hx_batchGPUSingle: t[copy,gemm,reduction]=1.8e-05,0.00194,0.000188 cost=7.9e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0 t_gemm=0.00194 t_reduction=0.000187 tot=0.00213 ---
 sigma counter=221 i=0 t=0.000239 per=12.3 cost=7.01e+03 flops=2.93e+07
 sigma counter=221 i=1 t=0.000241 per=12.4 cost=6.99e+03 flops=2.9e+07
 sigma counter=221 i=2 t=0.000242 per=12.5 cost=6.81e+03 flops=2.82e+07
 sigma counter=221 i=3 t=0.000241 per=12.4 cost=6.78e+03 flops=2.81e+07
 sigma counter=221 i=4 t=0.000252 per=13 cost=1.89e+04 flops=7.5e+07
 sigma counter=221 i=5 t=0.000248 per=12.8 cost=1.89e+04 flops=7.62e+07
 sigma counter=221 i=6 t=0.000243 per=12.5 cost=6.78e+03 flops=2.79e+07
 sigma counter=221 i=7 t=0.000237 per=12.2 cost=6.81e+03 flops=2.88e+07
 total GEMM cost=7.9e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0 t_gemm=0.417 t_reduction=0.0418 tot=0.459 ---
 sigma_tot counter=221 i=0 t=0.0516 per=12.4 cost=1.37e+06 flops=2.65e+07
 sigma_tot counter=221 i=1 t=0.0524 per=12.6 cost=1.38e+06 flops=2.63e+07
 sigma_tot counter=221 i=2 t=0.0515 per=12.3 cost=1.38e+06 flops=2.68e+07
 sigma_tot counter=221 i=3 t=0.0514 per=12.3 cost=1.38e+06 flops=2.68e+07
 sigma_tot counter=221 i=4 t=0.0514 per=12.3 cost=2.33e+06 flops=4.53e+07
 sigma_tot counter=221 i=5 t=0.0523 per=12.5 cost=2.33e+06 flops=4.45e+07
 sigma_tot counter=221 i=6 t=0.0545 per=13.1 cost=2.71e+06 flops=4.98e+07
 sigma_tot counter=221 i=7 t=0.052 per=12.5 cost=2.7e+06 flops=5.2e+07
 total GEMM cost=1.56e+07 flops=3.73e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.50e-03  2.25e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.50e-03  2.25e-03
TIMING for Davidson : 4.52e-03  T(cal/comm/rest)=4.48e-03,9.30e-08,4.33e-05
optimized energies: isweep=5 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=18 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.704e-04 S -----
rintermediates<Tm>::init_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92
 size of rintermediate operators=1104:0.00842MB:8.23e-06GB
cost_rinter=4.42e+03 time=0.000162 flops=2.73e+07
----- TIMING FOR rintermediates<Tm>::init_batch_gpu : 1.983e-04 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=4.01e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06
----- TIMING FOR preprocess_formulae_Rlist : 0.00055 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.7e-05,0.000254,0.00025 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000851 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,8.23e-06,0.000811
preprocess_renorm_batchGPUSingle: t[gemm,reduction]=0.00106,0.000182 cost=1.55e+05 flops[gemm]=1.46e+08
--- TIMING FOR renorm : t_inter=0 t_gemm=0.00106 t_reduction=0.000182 tot=0.00124 ---
 renorm counter=24 i=0 t=0.000213 per=20.1 cost=5.64e+03 flops=2.65e+07
 renorm counter=24 i=1 t=0.000208 per=19.6 cost=1.13e+04 flops=5.42e+07
 renorm counter=24 i=2 t=0.000198 per=18.7 cost=1.66e+04 flops=8.36e+07
 renorm counter=24 i=3 t=0.000209 per=19.7 cost=2.89e+04 flops=1.38e+08
 renorm counter=24 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=24 i=5 t=1e-06 per=0.0943 cost=0 flops=0
 renorm counter=24 i=6 t=0.000232 per=21.9 cost=9.22e+04 flops=3.97e+08
 total GEMM cost=1.55e+05 flops=1.46e+08
--- TIMING FOR renorm_tot : t_inter=0 t_gemm=0.0252 t_reduction=0.00433 tot=0.0295 ---
 renorm_tot counter=24 i=0 t=0.00505 per=20 cost=9.56e+04 flops=1.89e+07
 renorm_tot counter=24 i=1 t=0.00489 per=19.4 cost=1.39e+05 flops=2.85e+07
 renorm_tot counter=24 i=2 t=0.00236 per=9.38 cost=9.83e+04 flops=4.16e+07
 renorm_tot counter=24 i=3 t=0.00247 per=9.82 cost=1.71e+05 flops=6.92e+07
 renorm_tot counter=24 i=4 t=0.00242 per=9.6 cost=9.87e+04 flops=4.08e+07
 renorm_tot counter=24 i=5 t=0.00247 per=9.8 cost=1.7e+05 flops=6.88e+07
 renorm_tot counter=24 i=6 t=0.00553 per=21.9 cost=1.17e+06 flops=2.12e+08
 total GEMM cost=1.94e+06 flops=7.72e+07
check ||H-H.dagger||=1.04e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.4e-05,0.0027,8.8e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=5.15e-05,4.13e-05,9.29e-05 speed=0.208GB/s disk[used]=0.000106GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.29e-02 S #####
 T(fetch) = 3.11e-04 S  per =  2.4  per(accum) = 2.4
 T(hdiag) = 6.91e-05 S  per = 0.54  per(accum) = 3
 T(dvdsn) = 8.70e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.22e-04 S  per =  2.5  per(accum) = 73
 T(guess) = 7.61e-05 S  per = 0.59  per(accum) = 74
 T(renrm) = 2.81e-03 S  per =   22  per(accum) = 96
 T(save ) = 5.66e-04 S  per =  4.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.52e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.99e-05 S  per = 0.47  per(accum) = 0.47
 T(symbolic_formulae_twodot     ) = 2.30e-04 S  per =  2.7  per(accum) = 3.2
 T(hintermediate init           ) = 2.00e-04 S  per =  2.4  per(accum) = 5.5
 T(hintermediates memcpy cpu2gpu) = 3.56e-06 S  per = 0.042  per(accum) = 5.6
 T(preprocess_hformulae_Hxlist2 ) = 2.23e-03 S  per =   26  per(accum) = 32
 T(hmmtasks init                ) = 1.29e-03 S  per =   15  per(accum) = 47
 T(dvdson solver [Hx_batchGPU]  ) = 4.48e-03 S  per =   53  per(accum) = 99
 T(dvdson solver [communication]) = 9.30e-08 S  per = 0.0011  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.33e-05 S  per = 0.51  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.76e-03 S
 T(qops init                    ) = 7.41e-05 S  per =  2.7  per(accum) = 2.7
 T(qops_dict memcpy cpu2gpu     ) = 3.45e-05 S  per =  1.2  per(accum) = 3.9
 T(symbolic_formulae_renorm     ) = 1.75e-04 S  per =  6.4  per(accum) = 10
 T(rintermediate init           ) = 2.02e-04 S  per =  7.3  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 4.59e-06 S  per = 0.17  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.59e-04 S  per =   20  per(accum) = 38
 T(rmmtasks init                ) = 3.54e-04 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 7.85e-06 S  per = 0.28  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.31e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.70e-05 S  per = 0.98  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.85e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 1.02e-01 S #####
 T(fetch) = 7.66e-04 S  per = 0.75  per(accum) = 0.75
 T(hdiag) = 2.85e-04 S  per = 0.28  per(accum) = 1
 T(dvdsn) = 8.68e-02 S  per =   85  per(accum) = 86
 T(decim) = 7.81e-04 S  per = 0.77  per(accum) = 87
 T(guess) = 3.16e-04 S  per = 0.31  per(accum) = 87
 T(renrm) = 1.09e-02 S  per =   11  per(accum) = 98
 T(save ) = 2.25e-03 S  per =  2.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.61e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.59e-04 S  per = 0.18  per(accum) = 0.18
 T(symbolic_formulae_twodot     ) = 9.15e-04 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 8.02e-04 S  per = 0.93  per(accum) = 2.2
 T(hintermediates memcpy cpu2gpu) = 1.44e-05 S  per = 0.017  per(accum) = 2.2
 T(preprocess_hformulae_Hxlist2 ) = 9.00e-03 S  per =   10  per(accum) = 13
 T(hmmtasks init                ) = 5.15e-03 S  per =    6  per(accum) = 19
 T(dvdson solver [Hx_batchGPU]  ) = 6.93e-02 S  per =   81  per(accum) = 99
 T(dvdson solver [communication]) = 1.33e-06 S  per = 0.0015  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.38e-04 S  per = 0.86  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.07e-02 S
 T(qops init                    ) = 3.29e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 1.26e-04 S  per =  1.2  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 7.54e-04 S  per =    7  per(accum) = 11
 T(rintermediate init           ) = 4.24e-04 S  per =    4  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.84e-05 S  per = 0.17  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 2.22e-03 S  per =   21  per(accum) = 36
 T(rmmtasks init                ) = 1.36e-03 S  per =   13  per(accum) = 49
 T(qops memset                  ) = 3.27e-05 S  per = 0.31  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 5.30e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.11e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.49e-05 S  per = 0.33  per(accum) = 1e+02
##### time_global: 6.94e-01 S #####
 T(fetch) = 5.83e-03 S  per = 0.84  per(accum) = 0.84
 T(hdiag) = 1.98e-03 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 5.98e-01 S  per =   86  per(accum) = 87
 T(decim) = 5.52e-03 S  per =  0.8  per(accum) = 88
 T(guess) = 1.99e-03 S  per = 0.29  per(accum) = 88
 T(renrm) = 6.63e-02 S  per =  9.6  per(accum) = 98
 T(save ) = 1.39e-02 S  per =    2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.93e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.83e-04 S  per = 0.17  per(accum) = 0.17
 T(symbolic_formulae_twodot     ) = 6.35e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 5.02e-03 S  per = 0.85  per(accum) = 2.1
 T(hintermediates memcpy cpu2gpu) = 9.96e-05 S  per = 0.017  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 5.75e-02 S  per =  9.7  per(accum) = 12
 T(hmmtasks init                ) = 3.32e-02 S  per =  5.6  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 4.84e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 1.03e-05 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.97e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.51e-02 S
 T(qops init                    ) = 2.39e-03 S  per =  3.7  per(accum) = 3.7
 T(qops_dict memcpy cpu2gpu     ) = 8.13e-04 S  per =  1.2  per(accum) = 4.9
 T(symbolic_formulae_renorm     ) = 5.06e-03 S  per =  7.8  per(accum) = 13
 T(rintermediate init           ) = 2.62e-03 S  per =    4  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 1.21e-04 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 1.33e-02 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 8.31e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 2.06e-04 S  per = 0.32  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 3.14e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.94e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.28e-04 S  per = 0.35  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=5
----------------------------------------------------------------------
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.037
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.013
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.039
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474877831e-09
 sweep energies: isweep=5 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=5 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=5
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.64e-01 | 1.64e-01 | 0.00e+00 1.04e-01 1.06e-02 1.15e-01 69.9
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.31e-01 | 2.95e-01 | 0.00e+00 1.90e-01 2.03e-02 2.10e-01 71.3
            2  2      20 1.00e-04 0.00e+00 | 31 | 9.89e-02 | 3.94e-01 | 0.00e+00 2.50e-01 2.66e-02 2.77e-01 70.4
            3  2      20 1.00e-04 0.00e+00 | 31 | 1.00e-01 | 4.94e-01 | 0.00e+00 3.12e-01 3.29e-02 3.45e-01 69.9
            4  2      20 1.00e-04 0.00e+00 | 31 | 1.04e-01 | 5.98e-01 | 0.00e+00 3.78e-01 3.95e-02 4.17e-01 69.8
            5  2      20 1.00e-04 0.00e+00 | 31 | 1.03e-01 | 7.01e-01 | 0.00e+00 4.42e-01 4.61e-02 4.88e-01 69.6
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.67e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (-4.44e-16) e[1]=-2.43697745069 (-4.44e-15)
            3      20 +5.26e-04 e[0]=-2.65451696664 (-1.33e-15) e[1]=-2.43697745069 (8.88e-16)
            4      20 +0.00e+00 e[0]=-2.65451696664 (4.44e-16) e[1]=-2.43697745069 (-2.22e-15)
            5      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep5.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep5.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.49e-15
 idx=3 node=(1,0) Drow=8 maxdiff=8.88e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.92e-18
stensor2: wf2 own=1 _data=0x484db2e0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x484db2e0
      1.0000e+00      -3.0102e-18 
     -5.3512e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=4.5123e-16
----- TIMING FOR ctns::rcanon_check : 8.801e-05 S -----
..... end of isweep = 5 .....

----- TIMING FOR ctns::sweep_opt : 7.055e-01 S -----
##### time_global: 6.94e-01 S #####
 T(fetch) = 5.83e-03 S  per = 0.84  per(accum) = 0.84
 T(hdiag) = 1.98e-03 S  per = 0.29  per(accum) = 1.1
 T(dvdsn) = 5.98e-01 S  per =   86  per(accum) = 87
 T(decim) = 5.52e-03 S  per =  0.8  per(accum) = 88
 T(guess) = 1.99e-03 S  per = 0.29  per(accum) = 88
 T(renrm) = 6.63e-02 S  per =  9.6  per(accum) = 98
 T(save ) = 1.39e-02 S  per =    2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.93e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.83e-04 S  per = 0.17  per(accum) = 0.17
 T(symbolic_formulae_twodot     ) = 6.35e-03 S  per =  1.1  per(accum) = 1.2
 T(hintermediate init           ) = 5.02e-03 S  per = 0.85  per(accum) = 2.1
 T(hintermediates memcpy cpu2gpu) = 9.96e-05 S  per = 0.017  per(accum) = 2.1
 T(preprocess_hformulae_Hxlist2 ) = 5.75e-02 S  per =  9.7  per(accum) = 12
 T(hmmtasks init                ) = 3.32e-02 S  per =  5.6  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 4.84e-01 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 1.03e-05 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.97e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.51e-02 S
 T(qops init                    ) = 2.39e-03 S  per =  3.7  per(accum) = 3.7
 T(qops_dict memcpy cpu2gpu     ) = 8.13e-04 S  per =  1.2  per(accum) = 4.9
 T(symbolic_formulae_renorm     ) = 5.06e-03 S  per =  7.8  per(accum) = 13
 T(rintermediate init           ) = 2.62e-03 S  per =    4  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 1.21e-04 S  per = 0.19  per(accum) = 17
 T(preprocess_formulae_Rlist2   ) = 1.33e-02 S  per =   20  per(accum) = 37
 T(rmmtasks init                ) = 8.31e-03 S  per =   13  per(accum) = 50
 T(qops memset                  ) = 2.06e-04 S  per = 0.32  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 3.14e-02 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.94e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.28e-04 S  per = 0.35  per(accum) = 1e+02

Congrats! CTNS calculation finishes successfully. Fri Apr  7 18:01:43 2023

